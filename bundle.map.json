{"version":3,"sources":["../../../../AppData/Roaming/npm/node_modules/browserify/node_modules/browser-pack/_prelude.js","main.js","RequestAnimationFrame.js","rubbable.js","libgif.js","js/Utils.js","js/Game.js","js/ResourceManager.js","js/Globals.js","js/MouseController.js","js/Systems.js","js/SoundController.js","js/PointerLockControls.js","js/EntityFactory.js","node_modules/physijs-browserify/physi.js","node_modules/js-class/class.js","node_modules/hamsterjs/hamster.js","node_modules/three/three.js","js/Components.js","js/threex.rendererstats.js","js/THREEx.KeyboardState.js","b3core.0.1.0.js","js/PickupMethods.js","node_modules/stats.js/src/Stats.js","node_modules/tiny-ecs/index.js","js/components/Position.js","js/components/Identifier.js","js/components/Velocity.js","js/components/Jump.js","js/components/Drawable.js","js/components/CameraFollow.js","js/components/Expirable.js","js/components/ShootDelay.js","js/components/Hurt.js","js/components/OneTimeHit.js","js/components/Health.js","js/components/Bullet.js","js/components/Ai.js","js/components/Steaming.js","js/components/CameraPitch.js","js/components/Shield.js","js/components/Gun.js","js/components/Ammo.js","js/components/DropsPickup.js","js/components/Pickup.js","node_modules/tiny-ecs/lib/EntityManager.js","node_modules/tiny-ecs/lib/Entity.js","node_modules/tiny-ecs/lib/ObjectPool.js","node_modules/tiny-ecs/lib/Vec2.js","node_modules/tiny-ecs/lib/QuadTree.js","node_modules/tiny-ecs/lib/Messanger.js","node_modules/tiny-ecs/lib/Spatial.js","node_modules/tiny-ecs/lib/Event.js","node_modules/tiny-ecs/node_modules/typedef/index.js","node_modules/tiny-ecs/node_modules/typedef/lib/getArguments.js","node_modules/tiny-ecs/node_modules/typedef/lib/extends.js","node_modules/tiny-ecs/node_modules/typedef/lib/mixin.js","node_modules/tiny-ecs/node_modules/typedef/lib/getName.js"],"names":["init","Globals","instance","hudLeftElement","document","getElementById","hudRightElement","healthElement","shieldElement","ammoElement","scoreElement","reloadingElement","reloadImg","SuperGif","gif","load","weaponSelectorElement","weaponNameElement","weaponIconElement","waveElement","overlayElement","gameOptions","container","loadingContainer","blocker","instructions","modelsToPreload","soundsToPreload","texturesToPreload","game","Game","start","global","Class","require","THREE","Physijs","Utils","scripts","worker","ammo","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","root","factory","define","amd","exports","module","RubbableGif","this","options","sup","register_canvas_handers","isvp","x","vp_l","canvas","get_canvas","w","vp_w","width","maxDistance","Math","floor","get_length","startX","startTime","cantouch","aj","last_played","addEventListener","e","preventDefault","get_auto_play","pause","pos","touches","length","layerX","progress","move_to","timeStamp","pageX","play","currentX","currentDistance","abs","currentTime","get_current_frame","move_relative","orig_load","bitsToNum","ba","reduce","s","n","byteToBitArr","bite","a","i","push","Stream","data","len","readByte","Error","Uint8Array","charCodeAt","readBytes","bytes","read","String","fromCharCode","readUnsigned","lzwDecode","minCodeSize","code","last","readCode","size","output","clearCode","eoiCode","codeSize","dict","clear","concat","apply","parseGIF","st","handler","parseCT","entries","ct","readSubBlocks","parseHeader","hdr","sig","ver","height","bits","gctFlag","shift","colorRes","splice","sorted","gctSize","bgColor","pixelAspectRatio","gct","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","iterations","app","NETSCAPE","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","img","deinterlace","pixels","newPixels","Array","rows","cpRow","toRow","fromRow","fromPixels","slice","offsets","steps","pass","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","parseBlock","sentinel","type","eof","toString","parse","opts","vp_t","vp_h","c_w","c_h","is_vp","stream","loadError","loading","transparency","delay","disposalRestoreFromIdx","lastDisposalMethod","frame","lastImg","playing","forward","ctx_scaled","frames","frameOffsets","auto_play","getAttribute","ctx","toolbar","tmpCanvas","onEndListener","hasOwnProperty","on_end","loopDelay","loop_delay","overrideLoopMode","loop_mode","drawWhileLoading","draw_while_loading","showProgressBar","show_progress_bar","doParse","err","doLoadError","setSizes","h","get_canvas_scale","style","minWidth","getContext","setTransform","setFrameOffset","offset","y","doShowProgress","draw","left","mid","top","fillStyle","fillRect","originOfError","drawError","strokeStyle","lineWidth","moveTo","lineTo","stroke","doHdr","_hdr","doGCE","pushFrame","getImageData","doImg","currIdx","putImageData","clearRect","imgData","cdd","forEach","pixel","set","scale","drawImage","player","iterationCount","getNextFrameNo","delta","stepFrame","amount","putFrame","completeLoop","step","stepping","doStep","nextFrameNo","parseInt","globalCompositeOperation","current_frame","frame_idx","doDecodeProgress","doNothing","withProgress","fn","load_callback","parent","parentNode","span","createElement","className","appendChild","insertBefore","removeChild","initialized","max_width","load_setup","get_playing","get_loading","load_url","src","XMLHttpRequest","overrideMimeType","onloadstart","onload","responseText","onprogress","lengthComputable","loaded","total","onerror","open","send","load_raw","arr","set_frame_offset","randomRange","min","max","random","damageShield","entity","damage","difference","shield","currentValue","enabled","timer","changed","health","hp","Stats","THREEx","C","constructor","stats","prevTime","performance","now","renderer","scene","camera","paused","controlsEnabled","controls","systems","postPhysicsSystems","percentModelsLoaded","percentSoundsLoaded","percentTexturesLoaded","systemsDelay","onResize","bind","onkeydown","onKeyDown","onMouseDown","onMouseUp","Hamster","wheel","onMouseWheel","WebGLRenderer","antialias","setSize","innerWidth","innerHeight","domElement","rendererStats","RendererStats","position","bottom","body","setMode","Scene","setGravity","Vector3","aspectRatio","PerspectiveCamera","add","PointerLockControls","getObject","ambientLight","AmbientLight","dirLight","DirectionalLight","setupAudio","loadModels","loadSounds","loadTextures","AudioContext","webkitAudioContext","sound","SoundController","context","following","path","loadSound","soundLoaded","percentPerSound","waitForPreload","makeGame","ResourceManager","loadModel","modelLoaded","model","percentPerModel","loadTexture","textureLoaded","texture","percentPerTexture","modelsDone","soundsDone","texturesDone","donePreloadng","createRequiredEntities","PlayerInputSystem","EntityFactory","entities","AISystem","MovementSystem","ExpirableSystem","CameraPitchSystem","ShootDelaySystem","HurtSystem","ShieldSystem","PlayerHealthSystem","PlayerShieldSystem","HealthBarSystem","DeathSystem","SteamRemovalSystem","SteamUpdateSystem","PhysicsUpdateSystem","CameraFollowSystem","startGame","visibility","display","scrollTop","documentElement","update","initPointerLock","animationFrame","time","dt","system","simulate","waveCheck","MouseController","render","enemies","queryTag","currentWave","TOTAL_WAVES","innerHTML","exitPointerLock","location","href","score","createNextWave","enemyCount","enemyPosition","distanceTo","drawable","mesh","SPAWN_SAFETY_BUBBLE","makeEnemy","rotation","Euler","PI","leashDistance","MIN_LEASH_DISTANCE","enemy","MAX_LEASH_DISTANCE","aiTarget","bulletSpeed","MIN_BULLET_SPEED","MAX_BULLET_SPEED","shootDistance","MIN_SHOOT_DISTANCE","MAX_SHOOT_DISTANCE","MIN_START_HP","MAX_START_HP","color","Color","restartGame","drawables","queryComponents","Drawable","geometry","material","hasComponent","Health","healthBar","remove","dispose","materials","mat","Steaming","steaming","particles","removeAllEntities","makeGround","makeSkyWall","makePlayer","controlsObject","cameraOffset","gunOffset","aspect","updateProjectionMatrix","keyCode","event","which","KEY_CODES","enter","space","button","isDown","right","wasPressed","deltaX","deltaY","canScrollWheel","playerAlive","scrolledUp","gun","TOTAL_GUN_TYPES","BASE_GUN_TYPE","currentAmmo","maxAmmo","GUN_NAMES","GUN_ICONS","havePointerLock","mozExitPointerLock","webkitExitPointerLock","pointerlockchange","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","pointerlockerror","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","test","navigator","userAgent","fullscreenchange","fullscreenElement","mozFullscreenElement","mozFullScreenElement","removeEventListener","requestFullscreen","mozRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","statics","GUN_TYPES","none","potatoCannon","scatterFries",1,2,"Model","clone","loadingManager","LoadingManager","jsonLoader","JSONLoader","textures","models","crossOrigin","DIR","ImageUtils","undefined","console","log","getTexture","MeshFaceMaterial","getModel",{"end":{"file":"?","comments_before":[],"nlb":false,"endpos":2555,"endcol":16,"endline":103,"pos":2547,"col":8,"line":103,"value":"instance","type":"name"},"start":{"file":"?","comments_before":[],"nlb":false,"endpos":2555,"endcol":16,"endline":103,"pos":2547,"col":8,"line":103,"value":"instance","type":"name"},"name":"instance"},"_instance","hudElement","ENTITY_TYPES","ground","obstacle","bullet","pickup","__scrollWheelDelay","SCROLL_WHEEL_DELAY_THRESHOLD","keyboard","KeyboardState","jumped","players","velocity","z","dv","pressed","MOVE_SPEED","jump","canJump","JUMP_FORCE","applyMatrix4","rotationMatrix","shootDelay","canShoot","direction","cameraFollow","getDirection","gunPos","setFromMatrixPosition","matrixWorld","bulletPos","bulletOffset","yMatrix","Matrix4","extractRotation","pitchObject","matrix","multiply","bulletRot","object","makePotato","POTATO_SPEED","owner","getSound","setPosition","setVelocity","setOrientation","baseDirection","basePos","numFries","round","piOver2","bulletDirection","makeFry","FRY_SPEED","moveables","Position","Velocity","doMove","applyCentralImpulse","expirables","Expirable","expirable","age","maxAge","follows","CameraFollow","shooters","ShootDelay","delayTheshold","hurtables","Hurt","hurt","timerThreshold","hurtColor","hasTag","backgroundColor","originalColor","removeComponent","shieldables","Shield","maxValue","rechargeDelay","rechargeRate","clamp","maxHP","percent","percentRounded","getHexString","mortals","DropsPickup","dropsPickup","dropChance","randPickup","dropTypes","pickupToMake","singularities","AI","ai","tree","target","blackboard","tick","particleCount","vertices","particle","verticesNeedUpdate","Bullet","isHot","pitchables","CameraPitch","cameraPitch","getLinearVelocity","Sound","source","createBufferSource","volume","createGain","panner","createPanner","connect","mainVolume","loop","self","request","responseType","decodeAudioData","response","buffer","alert","orientation","setVolume","gain","destination","sounds","setListenerPosition","applyProjection","normalize","up","setListenerOrientation","listener","Object3D","yawObject","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","PI_2","v","copy","applyEuler","EntityManager","b3","PickupMethods","createEntity","addTag","addComponent","Identifier","Jump","Gun","Ammo","CapsuleMesh","createMaterial","MeshBasicMaterial","MASS","_physijs","collision_type","COLLISION_TYPES","collision_masks","enemyBullet","setDamping","setAngularFactor","other_object","relative_velocity","relative_rotation","contact_normal","hitSounds","soundPos","soundVel","soundDir","soundIndex","makeGun","cameraControls","MeshPhongMaterial","playerBullet","Mesh","BoxGeometry","FaceNode","Action","prototype","name","parameters","facing","__Action_initialize","initialize","settings","_manager","FAILURE","parentPos","followingPos","posDif","sub","angle","angleTo","SUCCESS","lookAtMatrix","lookAt","parentRotation","Quaternion","setFromEuler","targetRotation","setFromRotationMatrix","str","slerp","setFromQuaternion","__dirtyRotation","RUNNING","RandomChildNode","Composite","__Composite_initialize","chance","children","status","_execute","FollowNode","distance","subVectors","normal","ShootNode","shootingAt","spawnLocation","spawnOffset","futureFrames","followingVel","multiplyScalar","predictedPos","velOffset","BehaviorTree","Sequence","Blackboard","potato","OneTimeHit","setHex","hitPlayer","hitEnemy","oneTimeHit","alreadyHit","indexOf","uuid","BULLET_DAMAGE","touchedGround","soundForward","vel","Geometry","smokeTexture","smokeMaterial","PointCloudMaterial","map","transparent","depthWrite","blending","AdditiveBlending","PointCloud","sortParticles","Gyroscope","fry","BoxMesh","makeHealthPickup","Pickup","method","heal","healAmount","makeAmmoPickup","increaseAmmo","ammoAmount","mainTex","wrapS","wrapT","RepeatWrapping","diffuseTex","specularTex","displacementMap","specularMap","skyWall","minFilter","LinearMipMapLinearFilter","magFilter","LinearFilter","side","DoubleSide","nothing","SUPPORT_TRANSFERABLE","Eventable","getObjectId","getEulerXYZFromQuaternion","getQuatertionFromEuler","convertWorldPositionToObject","addObjectChildren","_temp1","_temp2","_is_simulating","_Physijs","_temp_vector3_1","_temp_vector3_2","_temp_matrix4_1","_quaternion_1","MESSAGE_TYPES","WORLDREPORT","COLLISIONREPORT","VEHICLEREPORT","CONSTRAINTREPORT","REPORT_ITEMSIZE","COLLISIONREPORT_ITEMSIZE","VEHICLEREPORT_ITEMSIZE","CONSTRAINTREPORT_ITEMSIZE","_eventListeners","event_name","index","dispatchEvent","call","arguments","make","obj","_id","atan2","asin","c1","s1","c2","s2","c3","s3","c1c2","s1s2","cos","sin","identity","makeRotationFromQuaternion","quaternion","getInverse","noConflict","friction","restitution","physijs_material","id","PointConstraint","objecta","objectb","appliedImpulse","positiona","positionb","getDefinition","HingeConstraint","axis","setLimits","low","high","bias_factor","relaxation_factor","execute","constraint","enableAngularMotor","acceleration","disableMotor","SliderConstraint","lin_lower","lin_upper","ang_lower","ang_upper","setRestitution","linear","angular","enableLinearMotor","disableLinearMotor","disableAngularMotor","ConeTwistConstraint","axisa","axisb","setLimit","enableMotor","setMaxMotorImpulse","max_impulse","setMotorTarget","DOFConstraint","setLinearLowerLimit","limit","setLinearUpperLimit","setAngularLowerLimit","setAngularUpperLimit","configureAngularMotor","low_angle","high_angle","max_force","params","_worker","Worker","transferableMessage","webkitPostMessage","postMessage","_materials_ref_counts","_objects","_vehicles","_constraints","ab","ArrayBuffer","byteLength","message","filename","lineno","onmessage","_temp","Float32Array","_updateScene","_updateCollisions","_updateVehicles","_updateConstraints","cmd","debug","dir","fixedTimeStep","rateLimit","num_objects","__dirtyPosition","linearVelocity","angularVelocity","vehicle","wheels","addVectors","j","object2","id1","id2","collisions","normal_offsets","getAngularVelocity","normal_offset","addConstraint","show_marker","marker","SphereGeometry","MeshNormalMaterial","onSimulationResume","removeConstraint","updateMatrix","updateMatrixWorld","position_offset","world","Vehicle","materialId","depth","pop","setFixedTimeStep","gravity","timeStep","maxSubSteps","object_id","quat","mass","boundingBox","computeBoundingBox","__defineGetter__","__defineSetter__","force","applyImpulse","impulse_x","impulse_y","impulse_z","applyTorque","torque_x","torque_y","torque_z","applyCentralForce","applyForce","force_x","force_y","force_z","setAngularVelocity","setLinearVelocity","factor","setLinearFactor","setCcdMotionThreshold","threshold","setCcdSweptSphereRadius","radius","PlaneMesh","faces","HeightfieldMesh","xdiv","ydiv","xsize","ysize","xpts","sqrt","ypts","absMaxHeight","b","points","SphereMesh","boundingSphere","computeBoundingSphere","pow","CylinderMesh","ConeMesh","ConcaveMesh","face","triangles","Face3","c","Face4","d","ConvexMesh","tuning","VehicleTuning","rigidBody","suspension_stiffness","suspension_compression","suspension_damping","max_suspension_travel","friction_slip","max_suspension_force","addWheel","wheel_geometry","wheel_material","connection_point","wheel_direction","wheel_axle","suspension_rest_length","wheel_radius","is_front_wheel","castShadow","receiveShadow","setSteering","steering","setBrake","brake","applyEngineForce","inherit","dest","noParent","Object","getOwnPropertyNames","desc","getOwnPropertyDescriptor","defineProperty","__proto__","findType","meta","implType","implMeta","proto","base","implements","classProto","isArray","implementedType","extend","theClass","value","enumerable","configurable","writable","Checker","typeOf","typeInfo","an","is","VERSION","Instance","SUPPORT","ADD_EVENT","REMOVE_EVENT","PREFIX","READY","normalise","browser","handlers","useCapture","unwheel","original","hamster","eventName","originalHandler","originalEvent","normalised","lookup","lowestDelta","lowestDeltaXY","documentMode","onmousewheel","srcElement","deltaMode","delatZ","returnValue","stopPropagation","cancelBubble","wheelDelta","wheelDeltaX","detail","absDelta","absDeltaXY","wheelDeltaY","REVISION","sign","warn","error","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","NoShading","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearMipMapNearestFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","Projector","projectVector","vector","project","unprojectVector","unproject","pickingRay","CanvasRenderer","setClearColor","setRGB","r","g","setStyle","hex","setHSL","l","hue2rgb","p","q","t","exec","ColorKeywords","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","getHex","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","lerp","alpha","equals","fromArray","array","toArray","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","_x","_y","_z","_w","onChangeCallback","euler","order","setFromAxisAngle","halfAngle","m","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","dot","crossVectors","inverse","conjugate","lengthSq","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","qa","qm","Vector2","setX","setY","setComponent","getComponent","subScalar","divide","divideScalar","scalar","invScalar","clampScalar","minVal","maxVal","ceil","roundToZero","negate","distanceToSquared","dx","dy","setLength","oldLength","lerpVectors","v2","fromAttribute","attribute","itemSize","setZ","multiplyVectors","applyAxisAngle","applyMatrix3","qx","qy","qz","qw","ix","iy","iz","iw","multiplyMatrices","projectionMatrix","transformDirection","lengthManhattan","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","end","line","center","result","distanceSq","at","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","Infinity","setFromPoints","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromObject","scope","traverse","node","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","multiplyVector3Array","applyToVector3Array","determinant","f","throwOnInvertible","det","msg","transpose","tmp","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","eye","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","rotateX","rotateY","rotateZ","rotateByAxis","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","decompose","invSX","invSY","invSZ","makeFrustum","near","far","makePerspective","fov","ymax","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","origin","ray","recast","directionDistance","distanceSqToSegment","segCenter","segDir","diff","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","split","rnd","join","clampBottom","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nextPowerOfTwo","Spline","interpolate","t2","t3","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","Clock","autoStart","oldTime","elapsedTime","running","Date","stop","getElapsedTime","getDelta","newTime","EventDispatcher","hasEventListener","_listeners","listeners","listenerArray","Raycaster","Sprite","LOD","Line","descSort","intersectObject","raycaster","intersects","recursive","raycast","precision","linePrecision","setFromCamera","OrthographicCamera","sort","intersectObjects","objects","Object3DIdCount","DefaultUp","onRotationChange","onQuaternionChange","defineProperties","rotationAutoUpdate","matrixAutoUpdate","matrixWorldNeedsUpdate","visible","frustumCulled","renderOrder","userData","eulerOrder","useQuaternion","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","getChildByName","getObjectByName","getObjectById","getObjectByProperty","child","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","toJSON","metadata","version","generator","geometries","parseGeometry","json","parseMaterial","parseObject","JSON","stringify","intensity","PointLight","decay","SpotLight","exponent","HemisphereLight","groundColor","mode","materialIndex","vertexNormals","vertexColors","vertexTangents","BufferAttribute","needsUpdate","copyAt","index1","index2","setXY","setXYZ","setXYZW","Int8Attribute","Uint8Attribute","Uint8ClampedAttribute","Int16Attribute","Uint16Attribute","Int32Attribute","Uint32Attribute","Float32Attribute","Float64Attribute","DynamicBufferAttribute","updateRange","count","create","GeometryIdCount","attributesKeys","drawcalls","addAttribute","keys","addDrawCall","indexOffset","fromGeometry","faceVertexUvs","hasFaceVertexUv","hasFaceVertexNormals","normals","colors","uvs","i3","na","nb","nc","fc","vca","vcb","vcc","uva","uvb","uvc","bb","isNaN","computeFaceNormals","computeVertexNormals","vA","vB","vC","pA","pB","pC","cb","indices","jl","normalizeNormals","computeTangents","handleTriangle","uvA","uvB","uvC","x1","y1","z1","sdir","tdir","tan1","tan2","handleVertex","n2","tmp2","tangents","uv","nVertices","tangent","iA","iB","iC","computeOffsets","facesCount","sortedIndices","Uint16Array","indexPtr","vertexPtr","duplicatedVertices","newVerticeMaps","faceVertices","Int32Array","vertexMap","revVertexMap","findex","vo","vid","faceMax","new_offset","new_vid","reorderBuffers","merge","key","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","indexBuffer","indexMap","vertexCount","sortedAttributes","attr","sourceArray","attrArray","attrSize","sortedAttr","numItems","sourceAttr","morphTargets","morphColors","morphNormals","skinWeights","skinIndices","lineDistances","hasTangents","dynamic","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","tangentsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","fromBufferGeometry","tempNormals","tempUVs","addFace","drawcall","fl","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","ua","ub","uc","vertexIndex","faceIndex","computeLineDistances","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","uvs2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mergeVertices","verticesMap","unique","changes","precisionPoints","faceIndicesToRemove","dupIndex","idx","setBit","getNormalIndex","hash","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","hasMaterial","hasFaceUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","format","updateCubeMap","generateMipmaps","activeCubeFace","zoom","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","Light","light","AreaLight","constantAttenuation","linearAttenuation","quadraticAttenuation","onlyShadow","shadowCameraNear","shadowCameraFar","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","shadowCascade","shadowCascadeOffset","shadowCascadeCount","shadowCascadeBias","shadowCascadeWidth","shadowCascadeHeight","shadowCascadeNearZ","shadowCascadeFarZ","shadowCascadeArray","shadowMap","shadowMapSize","shadowCamera","shadowMatrix","skyColor","shadowCameraFov","Cache","files","file","get","Loader","showStatus","statusDomElement","addStatusElement","imageLoader","ImageLoader","onLoadStart","onLoadProgress","onLoadComplete","fontSize","textAlign","background","padding","zIndex","updateProgress","toFixed","extractUrlBase","url","parts","initMaterials","texturePath","needsTangents","ShaderMaterial","nearest_pow2","LN2","create_texture","where","sourceFile","repeat","wrap","anisotropy","fullPath","loader","Handlers","Texture","image","wrapMap","mirror","rgb2hex","rgb","mtype","mpars","opacity","lightMap","normalMap","bumpMap","wireframe","shading","toLowerCase","depthTest","flipSided","doubleSided","colorDiffuse","DbgColor","colorSpecular","specular","colorEmissive","emissive","specularCoef","shininess","mapDiffuse","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLight","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapBump","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormal","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecular","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlpha","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","mapBumpScale","bumpScale","mapNormalFactor","normalScale","DbgName","regex","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","itemEnd","itemStart","setResponseType","setCrossOrigin","withCredentials","loadAjaxJSON","callbackProgress","xhr","onreadystatechange","readyState","DONE","LOADING","getResponseHeader","HEADERS_RECEIVED","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","bones","animation","animations","parseMorphing","dstVertices","srcVertices","cl","dstColors","srcColors","BufferGeometryLoader","text","typedArray","MaterialLoader","uniforms","vertexShader","fragmentShader","sizeAttenuation","ObjectLoader","substring","lastIndexOf","setTexturePath","parseGeometries","images","parseImages","parseTextures","parseMaterials","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","depthSegments","CircleGeometry","segments","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","phiStart","phiLength","thetaStart","thetaLength","IcosahedronGeometry","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","alphaMap","envMap","loadImage","getGeometry","getMaterial","Group","TextureLoader","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","texDatas","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","alphaTest","overdraw","_needsUpdate","setValues","values","newValue","Number","MeshLambertMaterial","MeshDepthMaterial","SpriteMaterial","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","combine","reflectivity","refractionRatio","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","wrapAround","wrapRGB","metal","ParticleBasicMaterial","ParticleSystemMaterial","defines","lights","defaultAttributeValues","uv2","index0AttributeName","UniformsUtils","RawShaderMaterial","mapping","TextureIdCount","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","CubeTexture","VideoTexture","video","HAVE_ENOUGH_DATA","inverseMatrix","localThreshold","testPoint","rayPointDistance","intersectPoint","distanceToRay","oi","ol","pointCount","ParticleSystem","LineStrip","LinePieces","precisionSq","vStart","vEnd","interSegment","interRay","distSq","offsetIndex","nbVertices","updateMorphTargets","morphTargetBase","morphTargetForcedOrder","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","intersectionPoint","isFaceMaterial","objectMaterials","morphInfluences","tl","influence","targets","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","bone","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","rotq","scl","normalizeSkinWeights","skeleton","sw","MorphAnimMesh","duration","mirroredLoop","lastKeyframe","currentKeyframe","directionBackwards","setFrameRange","startKeyframe","endKeyframe","setDirectionForward","setDirectionBackward","parseAnimations","firstAnimation","pattern","morph","match","setAnimationLabel","playAnimation","fps","updateAnimation","frameTime","keyframe","mix","interpolateTargets","influences","addLevel","getObjectForDistance","matrixPosition","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","diffuse","offsetRepeat","flipEnvMap","bump","normalmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLightDirection","directionalLightColor","hemisphereLightDirection","hemisphereLightSkyColor","hemisphereLightGroundColor","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDirection","spotLightDistance","spotLightAngleCos","spotLightExponent","spotLightDecay","psColor","shadowmap","ShaderLib","basic","lambert","phong","particle_basic","dashed","totalSize","mNear","mFar","cube","tCube","tFlip","equirect","tEquirect","depthRGBA","createParticleBuffers","__webglVertexBuffer","_gl","createBuffer","__webglColorBuffer","_this","info","memory","createLineBuffers","__webglLineDistanceBuffer","createMeshBuffers","geometryGroup","__webglNormalBuffer","__webglTangentBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","numMorphTargets","__webglMorphTargetsBuffers","numMorphNormals","__webglMorphNormalsBuffers","initCustomAttributes","nvertices","__webglCustomAttributesList","__webglInitialized","createUniqueBuffers","belongsToAttribute","initParticleBuffers","__vertexArray","__colorArray","__webglParticleCount","initLineBuffers","__lineDistanceArray","__webglLineCount","initMeshBuffers","faces3","ntris","nlines","getBufferMaterial","__normalArray","__uvArray","__uv2Array","__tangentArray","__skinIndexArray","__skinWeightArray","UintArray","extensions","Uint32Array","__typeArray","__faceArray","__lineArray","__morphTargetsArrays","__morphNormalsArrays","__webglFaceCount","originalAttribute","property","__original","__inittedArrays","materialNeedsFaceNormals","setParticleBuffers","hint","ca","cal","customAttribute","vertexArray","colorArray","dirtyVertices","dirtyColors","customAttributes","bindBuffer","ARRAY_BUFFER","bufferData","boundTo","setLineBuffers","dl","lineDistanceArray","dirtyLineDistances","setMeshBuffers","faceColor","n1","n3","sw1","sw2","sw3","si1","si2","si3","vn","uvi","uv2i","vk","vkl","vka","nka","chf","needsFaceNormals","offset_uv","offset_uv2","offset_face","offset_normal","offset_tangent","offset_line","offset_color","offset_skin","offset_morphTarget","offset_custom","uvArray","uv2Array","normalArray","tangentArray","skinIndexArray","skinWeightArray","morphTargetsArrays","morphNormalsArrays","faceArray","lineArray","dirtyElements","dirtyUvs","dirtyNormals","dirtyTangents","dirtyMorphTargets","morphTargetsNeedUpdate","chunk_faces3","obj_faces","obj_uvs","obj_uvs2","obj_skinIndices","obj_skinWeights","ELEMENT_ARRAY_BUFFER","pp","setupVertexAttributes","program","startIndex","geometryAttributes","programAttributes","programAttributesKeys","programAttribute","geometryAttribute","state","enableAttribute","vertexAttribPointer","FLOAT","vertexAttrib2fv","vertexAttrib3fv","disableUnusedAttributes","setupMorphTargets","numSupportedMorphTargets","__webglMorphTargetInfluences","activeInfluenceIndices","numericalSort","numSupportedMorphNormals","influenceIndex","uniform1fv","painterSortStable","reversePainterSortStable","projectObject","initObject","sprites","webglObjects","_webglObjects","_frustum","webglObject","unrollBufferMaterial","sortObjects","_vector3","_projScreenMatrix","renderObjects","renderList","setupMatrices","setMaterial","setMaterialFaces","renderBufferDirect","renderBuffer","renderObjectsImmediate","materialType","renderImmediateObject","unrollImmediateBufferMaterial","globject","opaque","transparentObjects","opaqueObjects","__webglInit","_modelViewMatrix","_normalMatrix","onObjectRemoved","onGeometryDispose","initGeometryGroups","__webglActive","addBuffer","geometryGroupsList","geometryGroups","ImmediateRenderObject","immediateRenderCallback","addBufferImmediate","_webglObjectsImmediate","makeGroups","usesFaceMaterial","groupHash","group","maxVerticesInGroup","hash_map","groups","groupsList","counter","geometryGroupCounter","addBuffers","objlist","updateObject","bufferType","DYNAMIC_DRAW","STATIC_DRAW","bufferSubData","BYTES_PER_ELEMENT","subarray","customAttributesDirty","areCustomAttributesDirty","clearCustomAttributes","removeObject","removeInstances","o","initMaterial","onMaterialDispose","shaderID","shaderIDs","shader","__webglShader","maxLightCount","allocateLights","maxShadows","allocateShadows","maxBones","allocateBones","_precision","supportsVertexTextures","_supportsVertexTextures","envMapMode","useFog","fogExp","flatShading","logarithmicDepthBuffer","_logarithmicDepthBuffer","_supportsBoneTextures","maxMorphTargets","maxMorphNormals","maxDirLights","directional","maxPointLights","maxSpotLights","spot","maxHemiLights","hemi","shadowMapEnabled","shadowMapType","shadowMapDebug","shadowMapCascade","pl","_programs","programInfo","usedTimes","WebGLProgram","programs","uniformsList","setBlending","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","setProgram","_usedTextureUnits","deallocateMaterial","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","_currentProgram","useProgram","_currentMaterialId","_currentCamera","uniformMatrix4fv","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","_lightsNeedUpdate","setupLights","refreshUniformsLights","_lights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","refreshUniformsLambert","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","uvScaleMap","_canvas","ambient","distances","decays","directions","anglesCos","exponents","skyColors","groundColors","modelViewMatrix","uniformMatrix3fv","_maxTextures","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform2fv","uniform3fv","uniform4fv","_array","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","_direction","setTextureParameters","textureType","isImagePowerOfTwo","extension","texParameteri","TEXTURE_WRAP_S","paramThreeToGL","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","clampToMaxSize","maxSize","slot","__webglTextureCube","onTextureDispose","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_CUBE_MAP","pixelStorei","UNPACK_FLIP_Y_WEBGL","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","_maxCubemapSize","glFormat","glType","mipmap","getCompressedTextureFormats","compressedTexImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","texImage2D","generateMipmap","__webglTexture","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","updateRenderTargetMipmap","TEXTURE_2D","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","nVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","nVertexMatrices","dirLights","pointLights","spotLights","hemiLights","_context","pixelRatio","_alpha","_depth","_stencil","stencil","_antialias","_premultipliedAlpha","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_clearColor","_clearAlpha","autoClear","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","shadowMapCullFace","calls","_currentFramebuffer","_currentGeometryProgram","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_currentWidth","_currentHeight","resetGLState","setDefaultGLState","WebGLState","getShaderPrecisionFormat","rangeMin","rangeMax","WebGLExtensions","glClearColor","clearColor","clearDepth","clearStencil","enable","DEPTH_TEST","depthFunc","LEQUAL","frontFace","CCW","cullFace","BACK","CULL_FACE","BLEND","blendFunc","viewport","reset","MAX_TEXTURE_IMAGE_UNITS","_maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","_maxTextureSize","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","_vertexShaderPrecisionHighpFloat","VERTEX_SHADER","HIGH_FLOAT","_vertexShaderPrecisionMediumpFloat","MEDIUM_FLOAT","_fragmentShaderPrecisionHighpFloat","FRAGMENT_SHADER","_fragmentShaderPrecisionMediumpFloat","formats","COMPRESSED_TEXTURE_FORMATS","highpAvailable","mediumpAvailable","shadowMapPlugin","ShadowMapPlugin","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","forceContextLoss","loseContext","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","updateStyle","setViewport","setScissor","scissor","enableScissorTest","SCISSOR_TEST","disable","getClearColor","getClearAlpha","setClearAlpha","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearTarget","setRenderTarget","deallocateGeometry","deallocateTexture","onRenderTargetDispose","deallocateRenderTarget","deleteBuffers","buffers","deleteBuffer","deleteTexture","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","deleteProgram","newPrograms","renderBufferImmediate","initAttributes","hasPositions","hasNormals","hasUvs","__webglUvBuffer","hasColors","positionArray","nx","ny","nz","nax","nbx","ncx","nay","nby","ncy","naz","nbz","ncz","drawArrays","TRIANGLES","updateBuffers","wireframeBit","geometryProgram","LINES","drawElements","POINTS","LINE_STRIP","setLineWidth","skinIndex","skinWeight","lineDistance","forceClear","setFaceCulling","frontFaceDirection","CW","FRONT","FRONT_AND_BACK","setDoubleSided","setFlipSided","uploadTexture","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","isCube","isTargetPowerOfTwo","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","WebGLRenderTarget","restore","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","addPrePlugin","addPostPlugin","updateShadowMap","gl","getExtension","programIdCount","generateDefines","chunk","cacheUniformLocations","identifiers","getUniformLocation","cacheAttributeLocations","getAttribLocation","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefix_vertex","prefix_fragment","gammaFactorDefine","customDefines","createProgram","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLogInfo","getProgramInfoLog","getProgramParameter","LINK_STATUS","getError","VALIDATE_STATUS","deleteShader","addLineNumbers","string","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","newAttributes","enabledAttributes","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthTest","currentDepthWrite","currentColorWrite","currentDoubleSided","currentFlipSided","currentLineWidth","currentPolygonOffset","currentPolygonOffsetFactor","currentPolygonOffsetUnits","enableVertexAttribArray","disableVertexAttribArray","blendEquationSeparate","blendFuncSeparate","depthMask","colorMask","polygonoffset","units","POLYGON_OFFSET_FILL","flares","prefix","vertexBuffer","elementBuffer","hasVertexTexture","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","sprite","_renderer","_renderList","createVirtualLight","cascade","virtualLight","isVirtual","pointsWorld","pointsFrustum","nearZ","farZ","updateVirtualLight","updateShadowCamera","_min","_max","getObjectMaterial","_depthMaterial","_depthMaterialMorph","_depthMaterialSkin","_depthMaterialMorphSkin","_matrixPosition","depthShader","depthUniforms","originalCamera","gyro","shadowFilter","pars","cameraHelper","CameraHelper","objectMaterial","useMorphing","useSkinning","customDepthMaterial","clearAlpha","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","oldFogType","sceneFogType","GeometryUtils","geometry1","geometry2","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","getNormalMap","subtract","imageData","createImageData","ly","uy","lx","ux","num_points","generateDataTexture","SceneUtils","createMultiMaterialObject","detach","attach","FontUtils","divisions","getFace","loadFace","family","familyName","ThreeFont","cssFontWeight","cssFontStyle","drawText","resolution","fontPaths","Path","ret","extractGlyphPoints","paths","outline","action","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","pts","glyph","glyphs","_cachedOutline","quadraticCurveTo","Shape","bezierCurveTo","ha","generateShapes","curveSegments","font","shapes","toShapes","namespace","EPSILON","process","contour","verts","vertIndices","nv","snip","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cCROSSap","bCROSScp","aCROSSbp","Triangulate","_typeface_js","typeface_js","Audio","onended","onEnded","autoplay","isPlaying","setLoop","setRefDistance","refDistance","setRolloffFactor","rolloffFactor","AudioListener","positionPrev","Curve","getPointAt","getUtoTmapping","getPoints","getSpacedPoints","lengths","getLengths","cacheArcLengths","current","cache","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","getPointFunc","CurvePath","curves","bends","autoClose","curve","checkConnection","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","maxX","maxY","maxZ","minX","minY","minZ","NEGATIVE_INFINITY","POSITIVE_INFINITY","createPointsGeometry","createGeometry","createSpacedPointsGeometry","addWrapPath","bendpath","getTransformedPoints","oldPts","getWrapPoints","getTransformedSpacedPoints","oldX","oldY","xNorm","bounds","pathPt","translationObject","quaternionObject","scaleObject","translationWorld","quaternionWorld","scaleWorld","actions","fromPoints","PathActions","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","BEZIER_CURVE_TO","CSPLINE_THRU","ARC","ELLIPSE","vectors","vlen","args","lastargs","x0","y0","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","EllipseCurve","lastPoint","closedPath","useSpacedPoints","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","isClockWise","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambigious","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","hole","tmpHoles","holes","extrude","extruded","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","getSpacedPointsHoles","extractAllPoints","shape","extractPoints","extractAllSpacedPoints","triangulateShape","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","nextIdx","intersection","intersectsHoleEdge","ihIdx","chkHole","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","h2","allPointsMap","allpoints","shapeWithoutHoles","b2p0","b2p1","b2p2","b3p0","b3p1","b3p2","b3p3","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","ClosedSplineCurve3","AnimationHandler","CATMULLROM","CATMULLROM_FORWARD","hierarchy","rot","usedMorphTargets","morphTargetName","morphTargetsInfluences","parseRecurseHierarchy","deltaTimeMS","resetBlendWeights","Animation","timeScale","interpolationType","keyTypes","animationCache","positionWeight","quaternionWeight","scaleWeight","prevKey","nextKey","originalMatrix","getNextKeyWith","newVector","newQuat","interpolateCatmullRom","prevXYZ","nextXYZ","proportionalWeight","getPrevKeyWith","currentPoint","forwardPoint","KeyFrameAnimation","isPaused","sids","sid","next","endTime","hasTarget","MorphAnimation","lastFrame","currentFrame","interpolation","buildPlane","udir","vdir","gridX","gridY","width_half","height_half","gridX1","gridY1","segment_width","segment_height","uvd","depth_half","centerUV","segment","CubeGeometry","heightHalf","verticesRow","uvsRow","tanTheta","v4","n4","uv1","uv3","uv4","addShapeList","addShape","scalePt2","pt","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","colinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","layer","flen","f3","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","extrudeMaterial","generateSideWallUV","extrudePts","splineTube","binormal","position2","bevelThickness","bevelSize","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","TubeGeometry","FrenetFrames","shapePoints","reverse","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","radiusStep","thetaSegment","TextGeometry","textShapes","getPos","in_q","in_p","cu","su","quOverP","cs","tz","grid","tang","bitan","ip","jp","closed","taper","NoTaper","numpoints","pos2","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","PolyhedronGeometry","prepare","that","azimuth","inclination","centroid","azi","correctUV","subdivide","cols","bj","DodecahedronGeometry","OctahedronGeometry","TetrahedronGeometry","ParametricGeometry","func","slices","stacks","sliceCount","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","thresholdAngle","thresholdDot","edge","sortFunction","numEdges","vert1","vert2","face1","face2","FaceNormalsHelper","objectVertices","objectFaces","objectWorldMatrix","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","worldMatrix","vertexId","VertexTangentsHelper","WireframeHelper","edges","numTris","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","active","autoCreateAnimations","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","cssText","msDiv","msText","msTexts","nLines","lastTime","webGLRenderer","assert","textContent","keyCodes","modifiers","_onKeyDown","_onKeyChange","_onKeyUp","_onBlur","prop","destroy","MODIFIERS","ALIAS","down","pageup","pagedown","tab","escape","shiftKey","ctrlKey","altKey","metaKey","keyDesc","toUpperCase","eventMatches","aliases","aliasKeys","ERROR","COMPOSITE","DECORATOR","ACTION","CONDITION","createUUID","hexDigits","substr","baseClass","cls","_baseMemory","_treeMemory","_getTreeMemory","treeScope","nodeMemory","openNodes","traversalDepth","traversalCycle","_getNodeMemory","treeMemory","nodeScope","_getMemory","Tick","_openNodes","_nodeCount","_enterNode","_openNode","_tickNode","_closeNode","_exitNode","title","description","properties","names","nodes","spec","EvalError","category","cid","dump","stack","lastOpenNodes","currOpenNodes","_close","BaseNode","_enter","_open","_tick","_exit","close","exit","__BaseNode_initialize","Decorator","Condition","Priority","MemSequence","MemPriority","Inverter","Limiter","maxLoop","__Decorator_initialize","MaxTime","maxTime","getTime","currTime","Repeater","RepeatUntilFailure","RepeatUntilSuccess","Failer","Runner","Succeeder","Wait","milliseconds","currentGun","ms","msMin","msMax","fpsMin","fpsMax","fpsDiv","fpsText","fpsGraph","bar","msGraph","updateGraph","dom","firstChild","begin","Entity","Messanger","ObjectPool","QuadTree","Spatial","Vec2","Ai","messanger","_tags","_entities","_groups","_entityPool","_componentPools","Components","componentPropertyName","Component","getName","charAt","groupKey","T","ENTITY_CREATED","ENTITY_REMOVE","COMPONENT_ADDED","COMPONENT_REMOVE","aquire","_trigger","removeEntitiesByTag","tag","removeEntity","entityRemoveAllComponents","release","entityAddTag","entityRemoveTag","entityAddComponent","_Components","cName","cPool","component","groupName","hasAllComponents","Cs","entityRemoveComponent","loc","propName","_indexGroup","poolStats","used","totalUsed","pool","trigger","TComponent","removeTag","freeList","expand","__init","totalFree","assign","magnitude","smult","rotate","magnitude2","angleBetween","pcopy","fromAngle","pfromAngle","rectIntersect","r1","r2","rectContains","sizeToHwidth","out__position","out__hwidth","level","maxEntities","maxLevels","insert","_getIndex","spatial","absPosition","absHwidth","_splitAndRedistributeIfNeeded","_node","queryArea","hwidth","out__entities","overlapping","reIndex","_combine","tSize","tPos","validateEntity","hw","midX","midY","_split","_redistribute","_factory","_events","fired","handled","Event","listenTo","option","events","fire","_absScale","_absPosition","_absHwidth","COINCIDENT","attachTo","absRotation","pScale","absScale","_name","_callback","Comps","whereComponent","whereComponents","extends","mixin","getArguments","FUNCTION_ARGS","replace","extends_","Child","Parent","Super","Function","makeT","mixin_","FUNCTION_NAME"],"mappings":"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IACN47B,MAAO,MAETuvC,aACEnrE,KAAM,KACN47B,MAAO,GAAI/mC,OAAMw+C,QAAQ,EAAG,KAIhCigC,KAEEqJ,YACE38E,KAAM,IACN47B,MAAO,OAETghD,SACE58E,KAAM,IACN47B,MAAO,GAETihD,QACE78E,KAAM,IACN47B,MAAO,KAETkhD,UACE98E,KAAM,IACN47B,MAAO,GAAI/mC,OAAM8d,MAAM,YAK3B4hE,QAEEwI,mBACE/8E,KAAM,KACN47B,UAGFohD,2BACEh9E,KAAM,KACN47B,UAEFqhD,uBACEj9E,KAAM,KACN47B,UAGFshD,0BACEl9E,KAAM,KACN47B,UAEFuhD,yBACEn9E,KAAM,KACN47B,UAEFwhD,4BACEp9E,KAAM,KACN47B,UAGFyhD,iBACEr9E,KAAM,KACN47B,UAEF0hD,oBACEt9E,KAAM,KACN47B,UAEF2hD,oBACEv9E,KAAM,MACN47B,UAEF4hD,iBACEx9E,KAAM,MACN47B,UAGF6hD,gBACEz9E,KAAM,KACN47B,UAEF8hD,mBACE19E,KAAM,KACN47B,UAEF+hD,oBACE39E,KAAM,KACN47B,UAEFgiD,mBACE59E,KAAM,MACN47B,UAEFiiD,mBACE79E,KAAM,MACN47B,UAEFkiD,mBACE99E,KAAM,MACN47B,UAEFmiD,gBACE/9E,KAAM,MACN47B,WAKJvc,UAEE2+D,SACEh+E,KAAM,IACN47B,MAAO,GAAI/mC,OAAM8d,MAAM,WAEzBq1D,SACEhoE,KAAM,IACN47B,MAAO,GAETnhC,MACEuF,KAAM,IACN47B,MAAO,GAET32B,OACEjF,KAAM,IACN47B,MAAO,GAET5S,KACEhpB,KAAM,IACN47B,MAAO,MAET2gD,cACEv8E,KAAM,KACN47B,MAAO,GAAI/mC,OAAM0iD,QAAQ,EAAG,EAAG,EAAG,IAGpColC,YACE38E,KAAM,IACN47B,MAAO,OAETghD,SACE58E,KAAM,IACN47B,MAAO,GAETihD,QACE78E,KAAM,IACN47B,MAAO,KAETkhD,UACE98E,KAAM,IACN47B,MAAO,GAAI/mC,OAAM8d,MAAM,YAK3BsrE,WAEErZ,WACE5kE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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","global.Class = require('js-class');\r\nglobal.THREE = require('three');\r\nglobal.Physijs = require('physijs-browserify')(THREE);\r\n\r\nrequire('hamsterjs');\r\n\r\nrequire('./RequestAnimationFrame.js');\r\nrequire('./rubbable.js');\r\nvar SuperGif = require('./libgif.js');\r\n\r\nvar Utils = require('./js/Utils.js');\r\n\r\nrequire('./js/Game.js');\r\nrequire('./js/Globals.js');\r\nrequire('./js/ResourceManager.js');\r\nrequire('./js/PointerLockControls.js');\r\nrequire('./js/EntityFactory.js');\r\nrequire('./js/Systems.js');\r\nrequire('./js/MouseController.js');\r\nrequire('./js/SoundController.js');\r\n\r\nPhysijs.scripts.worker = './libs/physijsWorker.js';\r\nPhysijs.scripts.ammo = './ammo.js';\r\n\r\n// purpose: function as a basic FPS game using an ECS (entity-component system) pattern and behavior trees for AI\r\n//\r\n// requires: RequestAnimationFrame.js, three.js, three-pointerlockcontrols.js, stats.js, js-class.js, physijs, tiny-ecs, Hamster.js\r\n//           ./js/*, /js/components/*\r\n//\r\n// author: Cornell Daly\r\n//\r\n// date: November 3, 2015\r\n//\r\n// additional notes: code is separated into multiple files/folders\r\n\r\nvar game = null;\r\n\r\nfunction init() {\r\n  Globals.instance.hudLeftElement = document.getElementById(\"hudLeft\");\r\n  Globals.instance.hudRightElement = document.getElementById(\"hudRight\");\r\n\r\n  Globals.instance.healthElement = document.getElementById(\"health\");\r\n  Globals.instance.shieldElement = document.getElementById(\"shield\");\r\n  Globals.instance.ammoElement = document.getElementById(\"ammo\");\r\n\r\n  Globals.instance.scoreElement = document.getElementById(\"score\");\r\n\r\n  Globals.instance.reloadingElement = document.getElementById(\"reloading\");\r\n  Globals.instance.reloadImg = new SuperGif({\r\n    gif: document.getElementById(\"reloadImg\")\r\n  });\r\n  Globals.instance.reloadImg.load();\r\n\r\n  Globals.instance.weaponSelectorElement = document.getElementById(\"weaponSelector\");\r\n  Globals.instance.weaponNameElement = document.getElementById(\"weaponName\");\r\n  Globals.instance.weaponIconElement = document.getElementById(\"weaponIcon\");\r\n\r\n  Globals.instance.waveElement = document.getElementById(\"wave\");\r\n\r\n  Globals.instance.overlayElement = document.getElementById(\"overlay\");\r\n\r\n  var gameOptions = {\r\n    container: document.getElementById(\"container\"),\r\n    loadingContainer: document.getElementById(\"loadingContainer\"),\r\n    blocker: document.getElementById(\"blocker\"),\r\n    instructions: document.getElementById(\"instructions\"),\r\n    modelsToPreload: [\r\n      \"models/potato.json\",\r\n      \"models/potatoCannon.json\",\r\n      \"models/character.json\",\r\n      \"models/fry.json\",\r\n      \"models/pickupBox.json\"\r\n    ],\r\n    soundsToPreload: [\r\n      \"sfx/arrowlessBow.mp3\",\r\n      \"sfx/hitSplat.wav\",\r\n      \"sfx/hurt1.mp3\",\r\n      \"sfx/hurt2.mp3\",\r\n      \"sfx/hurt3.mp3\"\r\n    ],\r\n    texturesToPreload: [\r\n      'gfx/brick-floor-tileable_COLOR.jpg',\r\n      'gfx/brick-floor-tileable_DISP.jpg',\r\n      'gfx/brick-floor-tileable_SPEC.jpg',\r\n      'gfx/smoketex.jpg',\r\n      'gfx/potatoIcon.png',\r\n      'gfx/frenchFriesIcon.png',\r\n      'gfx/skyTex2.jpg'\r\n    ]\r\n  };\r\n  game = new Game(gameOptions);\r\n\r\n  game.start();\r\n}\r\n\r\ninit();\r\n\r\n","/**\n * Provides requestAnimationFrame in a cross browser way.\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\n\nif ( !window.requestAnimationFrame ) {\n\n\twindow.requestAnimationFrame = ( function() {\n\n\t\treturn window.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\twindow.oRequestAnimationFrame ||\n\t\twindow.msRequestAnimationFrame ||\n\t\tfunction( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {\n\n\t\t\twindow.setTimeout( callback, 1000 / 60 );\n\n\t\t};\n\n\t} )();\n\n}\n","/*\n\tRubbableGif\n\n\tExample usage:\n\n\t\t<img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n\t\t<script type=\"text/javascript\">\n\t\t\t$$('img').each(function (img_tag) {\n\t\t\t\tif (/.*\\.gif/.test(img_tag.src)) {\n\t\t\t\t\tvar rub = new RubbableGif({ gif: img_tag } );\n\t\t\t\t\trub.load();\n\t\t\t\t}\n\t\t\t});\n\t\t</script>\n\n\tImage tag attributes:\n\n\t\trel:animated_src -\tIf this url is specified, it's loaded into the player instead of src.\n\t\t\t\t\t\t\tThis allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n\t\trel:auto_play -\t\tDefaults to 1 if not specified. If set to zero, the gif will be rubbable but will not \n\t\t\t\t\t\t\tanimate unless the user is rubbing it.\n\n\tConstructor options args\n\n\t\tgif \t\t\t\tRequired. The DOM element of an img tag.\n\t\tauto_play \t\t\tOptional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n\t\tmax_width\t\t\tOptional. Scale images over max_width down to max_width. Helpful with mobile.\n\n\tInstance methods\n\n\t\t// loading\n\t\tload( callback )\tLoads the gif into a canvas element and then calls callback if one is passed\n\n\t\t// play controls\n\t\tplay -\t\t\t\tStart playing the gif\n\t\tpause -\t\t\t\tStop playing the gif\n\t\tmove_to(i) -\t\tMove to frame i of the gif\n\t\tmove_relative(i) -\tMove i frames ahead (or behind if i < 0)\n\n\t\t// getters\n\t\tget_canvas\t\t\tThe canvas element that the gif is playing in.\n\t\tget_playing\t\t\tWhether or not the gif is currently playing\n\t\tget_loading\t\t\tWhether or not the gif has finished loading/parsing\n\t\tget_auto_play\t\tWhether or not the gif is set to play automatically\n\t\tget_length\t\t\tThe number of frames in the gif\n\t\tget_current_frame\tThe index of the currently displayed frame of the gif\n\n\t\tFor additional customization (viewport inside iframe) these params may be passed:\n\t\tc_w, c_h - width and height of canvas\n\t\tvp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n*/\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(['./libgif'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('./libgif'));\n    } else {\n        root.RubbableGif = factory(root.SuperGif);\n    }\n}(this, function (SuperGif) {\n    var RubbableGif = function( options ) {\n        var sup = new SuperGif( options );\n\n        var register_canvas_handers = function () {\n\n            var isvp = function(x) {\n                return (options.vp_l ? ( x - options.vp_l ) : x );\n            }\n\n            var canvas = sup.get_canvas();\n            var maxTime = 1000,\n            // allow movement if < 1000 ms (1 sec)\n                w = ( options.vp_w ? options.vp_w : canvas.width ),\n                maxDistance = Math.floor(w / (sup.get_length() * 2)),\n            // swipe movement of 50 pixels triggers the swipe\n                startX = 0,\n                startTime = 0;\n\n            var cantouch = \"ontouchend\" in document;\n\n            var aj = 0;\n            var last_played = 0;\n\n            canvas.addEventListener((cantouch) ? 'touchstart' : 'mousedown', function (e) {\n                // prevent image drag (Firefox)\n                e.preventDefault();\n                if (sup.get_auto_play()) sup.pause();\n\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var x = (pos.layerX > 0) ? isvp(pos.layerX) : w / 2;\n                var progress = x / w;\n\n                sup.move_to( Math.floor(progress * (sup.get_length() - 1)) );\n\n                startTime = e.timeStamp;\n                startX = isvp(pos.pageX);\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchend' : 'mouseup', function (e) {\n                startTime = 0;\n                startX = 0;\n                if (sup.get_auto_play()) sup.play();\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchmove' : 'mousemove', function (e) {\n                e.preventDefault();\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var currentX = isvp(pos.pageX);\n                currentDistance = (startX === 0) ? 0 : Math.abs(currentX - startX);\n                // allow if movement < 1 sec\n                currentTime = e.timeStamp;\n                if (startTime !== 0 && currentDistance > maxDistance) {\n                    if (currentX < startX && sup.get_current_frame() > 0) {\n                        sup.move_relative(-1);\n                    }\n                    if (currentX > startX && sup.get_current_frame() < sup.get_length() - 1) {\n                        sup.move_relative(1);\n                    }\n                    startTime = e.timeStamp;\n                    startX = isvp(pos.pageX);\n                }\n\n                var time_since_last_play = e.timeStamp - last_played;\n                {\n                    aj++;\n                    if (document.getElementById('tickles' + ((aj % 5) + 1))) document.getElementById('tickles' + ((aj % 5) + 1)).play();\n                    last_played = e.timeStamp;\n                }\n\n\n            });\n        };\n\n        sup.orig_load = sup.load;\n        sup.load = function(callback) {\n            sup.orig_load( function() {\n                if (callback) callback();\n                register_canvas_handers( sup );\n            } );\n        }\n\n        return sup;\n    }\n\n    return RubbableGif;\n}));","/*\n    SuperGif\n\n    Example usage:\n\n        <img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n        <script type=\"text/javascript\">\n            $$('img').each(function (img_tag) {\n                if (/.*\\.gif/.test(img_tag.src)) {\n                    var rub = new SuperGif({ gif: img_tag } );\n                    rub.load();\n                }\n            });\n        </script>\n\n    Image tag attributes:\n\n        rel:animated_src -  If this url is specified, it's loaded into the player instead of src.\n                            This allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n        rel:auto_play -     Defaults to 1 if not specified. If set to zero, a call to the play() method is needed\n\n    Constructor options args\n\n        gif                 Required. The DOM element of an img tag.\n        loop_mode           Optional. Setting this to false will force disable looping of the gif.\n        auto_play           Optional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n        max_width           Optional. Scale images over max_width down to max_width. Helpful with mobile.\n        on_end              Optional. Add a callback for when the gif reaches the end of a single loop (one iteration). The first argument passed will be the gif HTMLElement.\n        loop_delay          Optional. The amount of time to pause (in ms) after each single loop (iteration).\n        draw_while_loading  Optional. Determines whether the gif will be drawn to the canvas whilst it is loaded.\n        show_progress_bar   Optional. Only applies when draw_while_loading is set to true.\n\n    Instance methods\n\n        // loading\n        load( callback )        Loads the gif specified by the src or rel:animated_src sttributie of the img tag into a canvas element and then calls callback if one is passed\n        load_url( src, callback )   Loads the gif file specified in the src argument into a canvas element and then calls callback if one is passed\n\n        // play controls\n        play -              Start playing the gif\n        pause -             Stop playing the gif\n        move_to(i) -        Move to frame i of the gif\n        move_relative(i) -  Move i frames ahead (or behind if i < 0)\n\n        // getters\n        get_canvas          The canvas element that the gif is playing in. Handy for assigning event handlers to.\n        get_playing         Whether or not the gif is currently playing\n        get_loading         Whether or not the gif has finished loading/parsing\n        get_auto_play       Whether or not the gif is set to play automatically\n        get_length          The number of frames in the gif\n        get_current_frame   The index of the currently displayed frame of the gif\n\n        For additional customization (viewport inside iframe) these params may be passed:\n        c_w, c_h - width and height of canvas\n        vp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n        A bonus: few articles to understand what is going on\n            http://enthusiasms.org/post/16976438906\n            http://www.matthewflickinger.com/lab/whatsinagif/bits_and_bytes.asp\n            http://humpy77.deviantart.com/journal/Frame-Delay-Times-for-Animated-GIFs-214150546\n\n*/\n\n// Generic functions\nvar bitsToNum = function(ba) {\n  return ba.reduce(function(s, n) {\n    return s * 2 + n;\n  }, 0);\n};\n\nvar byteToBitArr = function(bite) {\n  var a = [];\n  for (var i = 7; i >= 0; i--) {\n    a.push(!!(bite & (1 << i)));\n  }\n  return a;\n};\n\n// Stream\n/**\n * @constructor\n */\n// Make compiler happy.\nvar Stream = function(data) {\n  this.data = data;\n  this.len = this.data.length;\n  this.pos = 0;\n\n  this.readByte = function() {\n    if (this.pos >= this.data.length) {\n      throw new Error('Attempted to read past end of stream.');\n    }\n    if (data instanceof Uint8Array)\n      return data[this.pos++];\n    else\n      return data.charCodeAt(this.pos++) & 0xFF;\n  };\n\n  this.readBytes = function(n) {\n    var bytes = [];\n    for (var i = 0; i < n; i++) {\n      bytes.push(this.readByte());\n    }\n    return bytes;\n  };\n\n  this.read = function(n) {\n    var s = '';\n    for (var i = 0; i < n; i++) {\n      s += String.fromCharCode(this.readByte());\n    }\n    return s;\n  };\n\n  this.readUnsigned = function() { // Little-endian.\n    var a = this.readBytes(2);\n    return (a[1] << 8) + a[0];\n  };\n};\n\nvar lzwDecode = function(minCodeSize, data) {\n  // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\n  var pos = 0; // Maybe this streaming thing should be merged with the Stream?\n  var readCode = function(size) {\n    var code = 0;\n    for (var i = 0; i < size; i++) {\n      if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\n        code |= 1 << i;\n      }\n      pos++;\n    }\n    return code;\n  };\n\n  var output = [];\n\n  var clearCode = 1 << minCodeSize;\n  var eoiCode = clearCode + 1;\n\n  var codeSize = minCodeSize + 1;\n\n  var dict = [];\n\n  var clear = function() {\n    dict = [];\n    codeSize = minCodeSize + 1;\n    for (var i = 0; i < clearCode; i++) {\n      dict[i] = [i];\n    }\n    dict[clearCode] = [];\n    dict[eoiCode] = null;\n\n  };\n\n  var code;\n  var last;\n\n  while (true) {\n    last = code;\n    code = readCode(codeSize);\n\n    if (code === clearCode) {\n      clear();\n      continue;\n    }\n    if (code === eoiCode) break;\n\n    if (code < dict.length) {\n      if (last !== clearCode) {\n        dict.push(dict[last].concat(dict[code][0]));\n      }\n    }\n    else {\n      if (code !== dict.length) throw new Error('Invalid LZW code.');\n      dict.push(dict[last].concat(dict[last][0]));\n    }\n    output.push.apply(output, dict[code]);\n\n    if (dict.length === (1 << codeSize) && codeSize < 12) {\n      // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\n      codeSize++;\n    }\n  }\n\n  // I don't know if this is technically an error, but some GIFs do it.\n  //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\n  return output;\n};\n\n\n// The actual parsing; returns an object with properties.\nvar parseGIF = function(st, handler) {\n  handler || (handler = {});\n\n  // LZW (GIF-specific)\n  var parseCT = function(entries) { // Each entry is 3 bytes, for RGB.\n    var ct = [];\n    for (var i = 0; i < entries; i++) {\n      ct.push(st.readBytes(3));\n    }\n    return ct;\n  };\n\n  var readSubBlocks = function() {\n    var size, data;\n    data = '';\n    do {\n      size = st.readByte();\n      data += st.read(size);\n    } while (size !== 0);\n    return data;\n  };\n\n  var parseHeader = function() {\n    var hdr = {};\n    hdr.sig = st.read(3);\n    hdr.ver = st.read(3);\n    if (hdr.sig !== 'GIF') throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\n    hdr.width = st.readUnsigned();\n    hdr.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    hdr.gctFlag = bits.shift();\n    hdr.colorRes = bitsToNum(bits.splice(0, 3));\n    hdr.sorted = bits.shift();\n    hdr.gctSize = bitsToNum(bits.splice(0, 3));\n\n    hdr.bgColor = st.readByte();\n    hdr.pixelAspectRatio = st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n    if (hdr.gctFlag) {\n      hdr.gct = parseCT(1 << (hdr.gctSize + 1));\n    }\n    handler.hdr && handler.hdr(hdr);\n  };\n\n  var parseExt = function(block) {\n    var parseGCExt = function(block) {\n      var blockSize = st.readByte(); // Always 4\n      var bits = byteToBitArr(st.readByte());\n      block.reserved = bits.splice(0, 3); // Reserved; should be 000.\n      block.disposalMethod = bitsToNum(bits.splice(0, 3));\n      block.userInput = bits.shift();\n      block.transparencyGiven = bits.shift();\n\n      block.delayTime = st.readUnsigned();\n\n      block.transparencyIndex = st.readByte();\n\n      block.terminator = st.readByte();\n\n      handler.gce && handler.gce(block);\n    };\n\n    var parseComExt = function(block) {\n      block.comment = readSubBlocks();\n      handler.com && handler.com(block);\n    };\n\n    var parsePTExt = function(block) {\n      // No one *ever* uses this. If you use it, deal with parsing it yourself.\n      var blockSize = st.readByte(); // Always 12\n      block.ptHeader = st.readBytes(12);\n      block.ptData = readSubBlocks();\n      handler.pte && handler.pte(block);\n    };\n\n    var parseAppExt = function(block) {\n      var parseNetscapeExt = function(block) {\n        var blockSize = st.readByte(); // Always 3\n        block.unknown = st.readByte(); // ??? Always 1? What is this?\n        block.iterations = st.readUnsigned();\n        block.terminator = st.readByte();\n        handler.app && handler.app.NETSCAPE && handler.app.NETSCAPE(block);\n      };\n\n      var parseUnknownAppExt = function(block) {\n        block.appData = readSubBlocks();\n        // FIXME: This won't work if a handler wants to match on any identifier.\n        handler.app && handler.app[block.identifier] && handler.app[block.identifier](block);\n      };\n\n      var blockSize = st.readByte(); // Always 11\n      block.identifier = st.read(8);\n      block.authCode = st.read(3);\n      switch (block.identifier) {\n        case 'NETSCAPE':\n          parseNetscapeExt(block);\n          break;\n        default:\n          parseUnknownAppExt(block);\n          break;\n      }\n    };\n\n    var parseUnknownExt = function(block) {\n      block.data = readSubBlocks();\n      handler.unknown && handler.unknown(block);\n    };\n\n    block.label = st.readByte();\n    switch (block.label) {\n      case 0xF9:\n        block.extType = 'gce';\n        parseGCExt(block);\n        break;\n      case 0xFE:\n        block.extType = 'com';\n        parseComExt(block);\n        break;\n      case 0x01:\n        block.extType = 'pte';\n        parsePTExt(block);\n        break;\n      case 0xFF:\n        block.extType = 'app';\n        parseAppExt(block);\n        break;\n      default:\n        block.extType = 'unknown';\n        parseUnknownExt(block);\n        break;\n    }\n  };\n\n  var parseImg = function(img) {\n    var deinterlace = function(pixels, width) {\n      // Of course this defeats the purpose of interlacing. And it's *probably*\n      // the least efficient way it's ever been implemented. But nevertheless...\n      var newPixels = new Array(pixels.length);\n      var rows = pixels.length / width;\n      var cpRow = function(toRow, fromRow) {\n        var fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n        newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n      };\n\n      // See appendix E.\n      var offsets = [0, 4, 2, 1];\n      var steps = [8, 8, 4, 2];\n\n      var fromRow = 0;\n      for (var pass = 0; pass < 4; pass++) {\n        for (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n          cpRow(toRow, fromRow)\n          fromRow++;\n        }\n      }\n\n      return newPixels;\n    };\n\n    img.leftPos = st.readUnsigned();\n    img.topPos = st.readUnsigned();\n    img.width = st.readUnsigned();\n    img.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    img.lctFlag = bits.shift();\n    img.interlaced = bits.shift();\n    img.sorted = bits.shift();\n    img.reserved = bits.splice(0, 2);\n    img.lctSize = bitsToNum(bits.splice(0, 3));\n\n    if (img.lctFlag) {\n      img.lct = parseCT(1 << (img.lctSize + 1));\n    }\n\n    img.lzwMinCodeSize = st.readByte();\n\n    var lzwData = readSubBlocks();\n\n    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\n\n    if (img.interlaced) { // Move\n      img.pixels = deinterlace(img.pixels, img.width);\n    }\n\n    handler.img && handler.img(img);\n  };\n\n  var parseBlock = function() {\n    var block = {};\n    block.sentinel = st.readByte();\n\n    switch (String.fromCharCode(block.sentinel)) { // For ease of matching\n      case '!':\n        block.type = 'ext';\n        parseExt(block);\n        break;\n      case ',':\n        block.type = 'img';\n        parseImg(block);\n        break;\n      case ';':\n        block.type = 'eof';\n        handler.eof && handler.eof(block);\n        break;\n      default:\n        throw new Error('Unknown block: 0x' + block.sentinel.toString(16)); // TODO: Pad this with a 0.\n    }\n\n    if (block.type !== 'eof') setTimeout(parseBlock, 0);\n  };\n\n  var parse = function() {\n    parseHeader();\n    setTimeout(parseBlock, 0);\n  };\n\n  parse();\n};\n\nvar SuperGif = function(opts) {\n  var options = {\n    //viewport position\n    vp_l: 0,\n    vp_t: 0,\n    vp_w: null,\n    vp_h: null,\n    //canvas sizes\n    c_w: null,\n    c_h: null\n  };\n  for (var i in opts) {\n    options[i] = opts[i]\n  }\n  if (options.vp_w && options.vp_h) options.is_vp = true;\n\n  var stream;\n  var hdr;\n\n  var loadError = null;\n  var loading = false;\n\n  var transparency = null;\n  var delay = null;\n  var disposalMethod = null;\n  var disposalRestoreFromIdx = 0;\n  var lastDisposalMethod = null;\n  var frame = null;\n  var lastImg = null;\n\n  var playing = true;\n  var forward = true;\n\n  var ctx_scaled = false;\n\n  var frames = [];\n  var frameOffsets = []; // elements have .x and .y properties\n\n  var gif = options.gif;\n  if (typeof options.auto_play == 'undefined')\n    options.auto_play = (!gif.getAttribute('rel:auto_play') || gif.getAttribute('rel:auto_play') == '1');\n\n  var onEndListener = (options.hasOwnProperty('on_end') ? options.on_end : null);\n  var loopDelay = (options.hasOwnProperty('loop_delay') ? options.loop_delay : 0);\n  var overrideLoopMode = (options.hasOwnProperty('loop_mode') ? options.loop_mode : 'auto');\n  var drawWhileLoading = (options.hasOwnProperty('draw_while_loading') ? options.draw_while_loading : true);\n  var showProgressBar = drawWhileLoading ? (options.hasOwnProperty('show_progress_bar') ? options.show_progress_bar : true) : false;\n\n  var clear = function() {\n    transparency = null;\n    delay = null;\n    lastDisposalMethod = disposalMethod;\n    disposalMethod = null;\n    frame = null;\n  };\n\n  // XXX: There's probably a better way to handle catching exceptions when\n  // callbacks are involved.\n  var doParse = function() {\n    try {\n      parseGIF(stream, handler);\n    }\n    catch (err) {\n      doLoadError('parse');\n    }\n  };\n\n  var doText = function(text) {\n    toolbar.innerHTML = text; // innerText? Escaping? Whatever.\n    toolbar.style.visibility = 'visible';\n  };\n\n  var setSizes = function(w, h) {\n    canvas.width = w * get_canvas_scale();\n    canvas.height = h * get_canvas_scale();\n    toolbar.style.minWidth = (w * get_canvas_scale()) + 'px';\n\n    tmpCanvas.width = w;\n    tmpCanvas.height = h;\n    tmpCanvas.style.width = w + 'px';\n    tmpCanvas.style.height = h + 'px';\n    tmpCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n  };\n\n  var setFrameOffset = function(frame, offset) {\n    if (!frameOffsets[frame]) {\n      frameOffsets[frame] = offset;\n      return;\n    }\n    if (typeof offset.x !== 'undefined') {\n      frameOffsets[frame].x = offset.x;\n    }\n    if (typeof offset.y !== 'undefined') {\n      frameOffsets[frame].y = offset.y;\n    }\n  };\n\n  var doShowProgress = function(pos, length, draw) {\n    if (draw && showProgressBar) {\n      var height = 25;\n      var left, mid, top, width;\n      if (options.is_vp) {\n        if (!ctx_scaled) {\n          top = (options.vp_t + options.vp_h - height);\n          height = height;\n          left = options.vp_l;\n          mid = left + (pos / length) * options.vp_w;\n          width = canvas.width;\n        }\n        else {\n          top = (options.vp_t + options.vp_h - height) / get_canvas_scale();\n          height = height / get_canvas_scale();\n          left = (options.vp_l / get_canvas_scale());\n          mid = left + (pos / length) * (options.vp_w / get_canvas_scale());\n          width = canvas.width / get_canvas_scale();\n        }\n        //some debugging, draw rect around viewport\n        if (false) {\n          if (!ctx_scaled) {\n            var l = options.vp_l,\n              t = options.vp_t;\n            var w = options.vp_w,\n              h = options.vp_h;\n          }\n          else {\n            var l = options.vp_l / get_canvas_scale(),\n              t = options.vp_t / get_canvas_scale();\n            var w = options.vp_w / get_canvas_scale(),\n              h = options.vp_h / get_canvas_scale();\n          }\n          ctx.rect(l, t, w, h);\n          ctx.stroke();\n        }\n      }\n      else {\n        top = (canvas.height - height) / (ctx_scaled ? get_canvas_scale() : 1);\n        mid = ((pos / length) * canvas.width) / (ctx_scaled ? get_canvas_scale() : 1);\n        width = canvas.width / (ctx_scaled ? get_canvas_scale() : 1);\n        height /= ctx_scaled ? get_canvas_scale() : 1;\n      }\n      // XXX Figure out alpha fillRect.\n      //ctx.fillStyle = 'salmon';\n      ctx.fillStyle = 'rgba(255,255,255,0.4)';\n      ctx.fillRect(mid, top, width - mid, height);\n\n      //ctx.fillStyle = 'teal';\n      ctx.fillStyle = 'rgba(255,0,22,.8)';\n      ctx.fillRect(0, top, mid, height);\n    }\n  };\n\n  var doLoadError = function(originOfError) {\n    var drawError = function() {\n      ctx.fillStyle = 'black';\n      ctx.fillRect(0, 0, options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.strokeStyle = 'red';\n      ctx.lineWidth = 3;\n      ctx.moveTo(0, 0);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.moveTo(0, options.c_h ? options.c_h : hdr.height);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, 0);\n      ctx.stroke();\n    };\n\n    loadError = originOfError;\n    hdr = {\n      width: gif.width,\n      height: gif.height\n    }; // Fake header.\n    frames = [];\n    drawError();\n  };\n\n  var doHdr = function(_hdr) {\n    hdr = _hdr;\n    setSizes(hdr.width, hdr.height)\n  };\n\n  var doGCE = function(gce) {\n    pushFrame();\n    clear();\n    transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\n    delay = gce.delayTime;\n    disposalMethod = gce.disposalMethod;\n    // We don't have much to do with the rest of GCE.\n  };\n\n  var pushFrame = function() {\n    if (!frame) return;\n    frames.push({\n      data: frame.getImageData(0, 0, hdr.width, hdr.height),\n      delay: delay\n    });\n    frameOffsets.push({\n      x: 0,\n      y: 0\n    });\n  };\n\n  var doImg = function(img) {\n    if (!frame) frame = tmpCanvas.getContext('2d');\n\n    var currIdx = frames.length;\n\n    //ct = color table, gct = global color table\n    var ct = img.lctFlag ? img.lct : hdr.gct; // TODO: What if neither exists?\n\n    /*\n    Disposal method indicates the way in which the graphic is to\n    be treated after being displayed.\n\n    Values :    0 - No disposal specified. The decoder is\n                    not required to take any action.\n                1 - Do not dispose. The graphic is to be left\n                    in place.\n                2 - Restore to background color. The area used by the\n                    graphic must be restored to the background color.\n                3 - Restore to previous. The decoder is required to\n                    restore the area overwritten by the graphic with\n                    what was there prior to rendering the graphic.\n\n                    Importantly, \"previous\" means the frame state\n                    after the last disposal of method 0, 1, or 2.\n    */\n    if (currIdx > 0) {\n      if (lastDisposalMethod === 3) {\n        // Restore to previous\n        frame.putImageData(frames[disposalRestoreFromIdx].data, 0, 0);\n      }\n      else {\n        disposalRestoreFromIdx = currIdx - 1;\n      }\n\n      if (lastDisposalMethod === 2) {\n        // Restore to background color\n        // Browser implementations historically restore to transparent; we do the same.\n        // http://www.wizards-toolkit.org/discourse-server/viewtopic.php?f=1&t=21172#p86079\n        frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\n      }\n    }\n    // else, Undefined/Do not dispose.\n    // frame contains final pixel data from the last frame; do nothing\n\n    //Get existing pixels for img region after applying disposal method\n    var imgData = frame.getImageData(img.leftPos, img.topPos, img.width, img.height);\n\n    //apply color table colors\n    var cdd = imgData.data;\n    img.pixels.forEach(function(pixel, i) {\n      // imgData.data === [R,G,B,A,R,G,B,A,...]\n      if (pixel !== transparency) {\n        cdd[i * 4 + 0] = ct[pixel][0];\n        cdd[i * 4 + 1] = ct[pixel][1];\n        cdd[i * 4 + 2] = ct[pixel][2];\n        cdd[i * 4 + 3] = 255; // Opaque.\n      }\n    });\n    imgData.data.set(cdd);\n\n    frame.putImageData(imgData, img.leftPos, img.topPos);\n\n    if (!ctx_scaled) {\n      ctx.scale(get_canvas_scale(), get_canvas_scale());\n      ctx_scaled = true;\n    }\n\n    // We could use the on-page canvas directly, except that we draw a progress\n    // bar for each image chunk (not just the final image).\n    if (drawWhileLoading)\n      ctx.drawImage(tmpCanvas, 0, 0);\n\n    lastImg = img;\n  };\n\n  var player = (function() {\n    var i = -1;\n    var iterationCount = 0;\n\n    var showingInfo = false;\n    var pinned = false;\n\n    /**\n     * Gets the index of the frame \"up next\".\n     * @returns {number}\n     */\n    var getNextFrameNo = function() {\n      var delta = (forward ? 1 : -1);\n      return (i + delta + frames.length) % frames.length;\n    };\n\n    var stepFrame = function(amount) { // XXX: Name is confusing.\n      i = i + amount;\n\n      putFrame();\n    };\n\n    var completeLoop = function() {\n      if (onEndListener !== null)\n        onEndListener(gif);\n      iterationCount++;\n    };\n\n    var step = (function() {\n      var stepping = false;\n\n      var doStep = function() {\n        stepping = playing;\n        if (!stepping) return;\n\n        stepFrame(1);\n        var delay = frames[i].delay * 10;\n        if (!delay) delay = 100; // FIXME: Should this even default at all? What should it be?\n\n        var nextFrameNo = getNextFrameNo();\n        if (nextFrameNo === 0) {\n          delay += loopDelay;\n          setTimeout(completeLoop, delay - 1);\n        }\n\n        if ((overrideLoopMode !== false || nextFrameNo !== 0 || iterationCount < 0))\n          setTimeout(doStep, delay);\n\n      };\n\n      return function() {\n        if (!stepping) setTimeout(doStep, 0);\n      };\n    }());\n\n    var putFrame = function() {\n      var offset;\n      i = parseInt(i, 10);\n\n      if (i > frames.length - 1) {\n        i = 0;\n      }\n\n      if (i < 0) {\n        i = 0;\n      }\n\n      offset = frameOffsets[i];\n\n      tmpCanvas.getContext(\"2d\").putImageData(frames[i].data, offset.x, offset.y);\n      ctx.globalCompositeOperation = \"copy\";\n      ctx.drawImage(tmpCanvas, 0, 0);\n    };\n\n    var play = function() {\n      playing = true;\n      step();\n    };\n\n    var pause = function() {\n      playing = false;\n    };\n\n\n    return {\n      init: function() {\n        if (loadError) return;\n\n        if (!(options.c_w && options.c_h)) {\n          ctx.scale(get_canvas_scale(), get_canvas_scale());\n        }\n\n        if (options.auto_play) {\n          step();\n        }\n        else {\n          i = 0;\n          putFrame();\n        }\n      },\n      step: step,\n      play: play,\n      pause: pause,\n      playing: playing,\n      move_relative: stepFrame,\n      current_frame: function() {\n        return i;\n      },\n      length: function() {\n        return frames.length\n      },\n      move_to: function(frame_idx) {\n        i = frame_idx;\n        putFrame();\n      }\n    }\n  }());\n\n  var doDecodeProgress = function(draw) {\n    doShowProgress(stream.pos, stream.data.length, draw);\n  };\n\n  var doNothing = function() {};\n  /**\n   * @param{boolean=} draw Whether to draw progress bar or not; this is not idempotent because of translucency.\n   *                       Note that this means that the text will be unsynchronized with the progress bar on non-frames;\n   *                       but those are typically so small (GCE etc.) that it doesn't really matter. TODO: Do this properly.\n   */\n  var withProgress = function(fn, draw) {\n    return function(block) {\n      fn(block);\n      doDecodeProgress(draw);\n    };\n  };\n\n\n  var handler = {\n    hdr: withProgress(doHdr),\n    gce: withProgress(doGCE),\n    com: withProgress(doNothing),\n    // I guess that's all for now.\n    app: {\n      // TODO: Is there much point in actually supporting iterations?\n      NETSCAPE: withProgress(doNothing)\n    },\n    img: withProgress(doImg, true),\n    eof: function(block) {\n      //toolbar.style.display = '';\n      pushFrame();\n      doDecodeProgress(false);\n      if (!(options.c_w && options.c_h)) {\n        canvas.width = hdr.width * get_canvas_scale();\n        canvas.height = hdr.height * get_canvas_scale();\n      }\n      player.init();\n      loading = false;\n      if (load_callback) {\n        load_callback(gif);\n      }\n\n    }\n  };\n\n  var init = function() {\n    var parent = gif.parentNode;\n\n    var span = document.createElement('span');\n    canvas = document.createElement('canvas');\n    ctx = canvas.getContext('2d');\n    toolbar = document.createElement('div');\n\n    tmpCanvas = document.createElement('canvas');\n\n    span.width = canvas.width = gif.width;\n    span.height = canvas.height = gif.height;\n    toolbar.style.minWidth = gif.width + 'px';\n\n    span.className = 'jsgif';\n    toolbar.className = 'jsgif_toolbar';\n    span.appendChild(canvas);\n    span.appendChild(toolbar);\n\n    parent.insertBefore(span, gif);\n    parent.removeChild(gif);\n\n    if (options.c_w && options.c_h) setSizes(options.c_w, options.c_h);\n    initialized = true;\n  };\n\n  var get_canvas_scale = function() {\n    var scale;\n    if (options.max_width && hdr && hdr.width > options.max_width) {\n      scale = options.max_width / hdr.width;\n    }\n    else {\n      scale = 1;\n    }\n    return scale;\n  }\n\n  var canvas, ctx, toolbar, tmpCanvas;\n  var initialized = false;\n  var load_callback = false;\n\n  var load_setup = function(callback) {\n    if (loading) return false;\n    if (callback) load_callback = callback;\n    else load_callback = false;\n\n    loading = true;\n    frames = [];\n    clear();\n    disposalRestoreFromIdx = 0;\n    lastDisposalMethod = null;\n    frame = null;\n    lastImg = null;\n\n    return true;\n  }\n\n  return {\n    // play controls\n    play: player.play,\n    pause: player.pause,\n    move_relative: player.move_relative,\n    move_to: player.move_to,\n\n    // getters for instance vars\n    get_playing: function() {\n      return player.playing\n    },\n    get_canvas: function() {\n      return canvas\n    },\n    get_canvas_scale: function() {\n      return get_canvas_scale()\n    },\n    get_loading: function() {\n      return loading\n    },\n    get_auto_play: function() {\n      return options.auto_play\n    },\n    get_length: function() {\n      return player.length()\n    },\n    get_current_frame: function() {\n      return player.current_frame()\n    },\n    load_url: function(src, callback) {\n      if (!load_setup(callback)) return;\n\n      var h = new XMLHttpRequest();\n      h.overrideMimeType('text/plain; charset=x-user-defined');\n      h.onloadstart = function() {\n        // Wait until connection is opened to replace the gif element with a canvas to avoid a blank img\n        if (!initialized) init();\n      };\n      h.onload = function(e) {\n        stream = new Stream(h.responseText);\n        setTimeout(doParse, 0);\n      };\n      h.onprogress = function(e) {\n        if (e.lengthComputable) doShowProgress(e.loaded, e.total, true);\n      };\n      h.onerror = function() {\n        doLoadError('xhr');\n      };\n      h.open('GET', src, true);\n      h.send();\n    },\n    load: function(callback) {\n      this.load_url(gif.getAttribute('rel:animated_src') || gif.src, callback);\n    },\n    load_raw: function(arr, callback) {\n      if (!load_setup(callback)) return;\n      if (!initialized) init();\n      stream = new Stream(arr);\n      setTimeout(doParse, 0);\n    },\n    set_frame_offset: setFrameOffset\n  };\n};\n\nmodule.exports = SuperGif;\n\n","/*\r\n * Static helper functions that are used frequently throughout the game.\r\n */\r\nvar Utils = Utils || {};\r\n\r\nUtils.randomRange = function(min, max) {\r\n  return Math.random() * (max - min) + min;\r\n};\r\n\r\nUtils.damageShield = function(entity, damage) {\r\n  var difference = 0;\r\n\r\n  if (entity.shield.currentValue < damage) {\r\n    difference = damage - entity.shield.currentValue;\r\n  }\r\n\r\n  entity.shield.currentValue -= damage;\r\n\r\n  if (entity.shield.currentValue <= 0) {\r\n    entity.shield.currentValue = 0;\r\n    entity.shield.enabled = false;\r\n  }\r\n\r\n  entity.shield.timer = 0;\r\n  entity.shield.changed = true;\r\n\r\n  if (difference > 0) {\r\n    entity.health.hp -= difference;\r\n    entity.health.changed = true;\r\n\r\n    entity.shield.enabled = false;\r\n  }\r\n};\r\n\r\nmodule.exports = Utils;\r\n\r\n","var Stats = require('stats.js');\r\nvar THREEx = require('./threex.rendererstats.js');\r\nvar Utils = require('./Utils.js');\r\nvar C = require('./Components.js');\r\n\r\n/*\r\n * The main game class. Contains information that should be stored across the entire game-state.\r\n * Required parameters:\r\n *  - The DOM elements for the game container, the loading display, the blocker element, and the instructions element\r\n *  - The models, sounds, and textures that should be preloaded \r\n */\r\nGame = Class({\r\n  constructor: function(options) {\r\n    this.container = options.container;\r\n    this.loadingContainer = options.loadingContainer;\r\n    this.blocker = options.blocker;\r\n    this.instructions = options.instructions;\r\n\r\n    this.stats = null;\r\n\r\n    this.prevTime = performance.now();\r\n\r\n    this.renderer = null;\r\n    this.scene = null;\r\n    this.camera = null;\r\n    this.player = null;\r\n\r\n    this.paused = true;\r\n\r\n    this.controlsEnabled = false;\r\n    this.controls = null;\r\n\r\n    this.systems = [];\r\n    this.postPhysicsSystems = [];\r\n\r\n    this.modelsToPreload = options.modelsToPreload;\r\n    this.percentModelsLoaded = 0;\r\n\r\n    this.soundsToPreload = options.soundsToPreload;\r\n    this.percentSoundsLoaded = 0;\r\n\r\n    this.texturesToPreload = options.texturesToPreload;\r\n    this.percentTexturesLoaded = 0;\r\n\r\n    this.systemsDelay = 0;\r\n  },\r\n\r\n  start: function() {\r\n    window.addEventListener('resize', this.onResize.bind(this));\r\n    window.onkeydown = this.onKeyDown.bind(this); // prevent spacebar from scrolling the page\r\n    window.addEventListener('mousedown', this.onMouseDown.bind(this));\r\n    window.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n    Hamster(window).wheel(this.onMouseWheel.bind(this));\r\n\r\n    this.renderer = new THREE.WebGLRenderer({\r\n      antialias: true\r\n    });\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.container.appendChild(this.renderer.domElement);\r\n\r\n    /* THREEx.RendererStats Setup */\r\n\r\n    this.rendererStats = new THREEx.RendererStats();\r\n    this.rendererStats.domElement.style.position = 'absolute';\r\n    this.rendererStats.domElement.style.left = '10px';\r\n    this.rendererStats.domElement.style.bottom = '10px';\r\n\r\n    document.body.appendChild(this.rendererStats.domElement);\r\n\r\n    /* Stats.js Setup */\r\n    this.stats = new Stats();\r\n    this.stats.setMode(0);\r\n\r\n    this.stats.domElement.style.position = 'absolute';\r\n    this.stats.domElement.style.left = '90px';\r\n    this.stats.domElement.style.bottom = '10px';\r\n\r\n    document.body.appendChild(this.stats.domElement);\r\n\r\n    // Create a new Three.js scene\r\n    this.scene = new Physijs.Scene();\r\n    this.scene.setGravity(new THREE.Vector3(0, -32, 0));\r\n\r\n    // Put in a camera\r\n    var aspectRatio = window.innerWidth / window.innerHeight;\r\n    this.camera = new THREE.PerspectiveCamera(45, aspectRatio, 0.5, 4000);\r\n    this.scene.add(this.camera);\r\n\r\n    /* Camera Controller */\r\n    this.controls = new PointerLockControls({\r\n      camera: this.camera\r\n    });\r\n    this.scene.add(this.controls.getObject());\r\n\r\n    var ambientLight = new THREE.AmbientLight(0xcbcbcb);\r\n    this.scene.add(ambientLight);\r\n\r\n    var dirLight = new THREE.DirectionalLight(0xdcdcdc, 0.5);\r\n    this.scene.add(dirLight);\r\n\r\n    /* Load Assets */\r\n\r\n    this.setupAudio();\r\n\r\n    this.loadModels();\r\n    this.loadSounds();\r\n    this.loadTextures();\r\n  },\r\n\r\n  setupAudio: function() {\r\n    window.AudioContext = (\r\n      window.AudioContext ||\r\n      window.webkitAudioContext ||\r\n      null\r\n    );\r\n\r\n    if (!AudioContext) {\r\n      throw new Error(\"AudioContext not supported!\");\r\n    }\r\n\r\n    var ctx = new AudioContext();\r\n\r\n    Globals.instance.sound = new SoundController({\r\n      context: ctx,\r\n      following: this.camera\r\n    });\r\n  },\r\n\r\n  loadSounds: function() {\r\n    this.soundsToPreload.forEach(function(path) {\r\n      Globals.instance.sound.loadSound(path, {\r\n        callback: this.soundLoaded.bind(this)\r\n      });\r\n    }.bind(this));\r\n  },\r\n\r\n  soundLoaded: function(sound) {\r\n    var percentPerSound = 100.0 / this.soundsToPreload.length;\r\n    this.percentSoundsLoaded += percentPerSound;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  loadModels: function() {\r\n    this.modelsToPreload.forEach(function(path) {\r\n      ResourceManager.instance.loadModel(path, {\r\n        callback: this.modelLoaded.bind(this)\r\n      });\r\n    }.bind(this));\r\n  },\r\n\r\n  modelLoaded: function(model) {\r\n    var percentPerModel = 100.0 / this.modelsToPreload.length;\r\n    this.percentModelsLoaded += percentPerModel;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  loadTextures: function() {\r\n    this.texturesToPreload.forEach(function(path) {\r\n      ResourceManager.instance.loadTexture(path, {\r\n        callback: this.textureLoaded.bind(this)\r\n      });\r\n    }.bind(this));\r\n  },\r\n\r\n  textureLoaded: function(texture) {\r\n    var percentPerTexture = 100.0 / this.texturesToPreload.length;\r\n    this.percentTexturesLoaded += percentPerTexture;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  waitForPreload: function() {\r\n    var modelsDone = this.percentModelsLoaded > 99.0;\r\n    var soundsDone = this.percentSoundsLoaded > 99.0;\r\n    var texturesDone = this.percentTexturesLoaded > 99.0;\r\n\r\n    var donePreloadng = (modelsDone && soundsDone && texturesDone);\r\n\r\n    return donePreloadng;\r\n  },\r\n\r\n  makeGame: function() {\r\n    /* Create Entities */\r\n\r\n    this.createRequiredEntities();\r\n\r\n    /* Setup Systems */\r\n\r\n    this.systems.push(new PlayerInputSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new AISystem(EntityFactory.instance.entities));\r\n    this.systems.push(new MovementSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ExpirableSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new CameraPitchSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ShootDelaySystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HurtSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ShieldSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new PlayerHealthSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new PlayerShieldSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HealthBarSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new DeathSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new SteamRemovalSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new SteamUpdateSystem(EntityFactory.instance.entities));\r\n\r\n    this.postPhysicsSystems.push(new PhysicsUpdateSystem(EntityFactory.instance.entities));\r\n    this.postPhysicsSystems.push(new CameraFollowSystem(EntityFactory.instance.entities));\r\n\r\n    /* Start Game */\r\n\r\n    this.startGame();\r\n  },\r\n\r\n  startGame: function() {\r\n    // hide loading indicator and show instructions\r\n    this.loadingContainer.style.visibility = \"hidden\";\r\n    this.blocker.style.visibility = \"visible\";\r\n    this.instructions.style.visibility = \"visible\";\r\n    Globals.instance.hudLeftElement.style.display = 'block';\r\n    Globals.instance.hudRightElement.style.display = 'block';\r\n    Globals.instance.weaponSelectorElement.style.display = 'block';\r\n\r\n    // ensure the user is at the top of the page\r\n    document.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\r\n    this.update(false);\r\n\r\n    this.initPointerLock();\r\n\r\n    this.update(true);\r\n  },\r\n\r\n  update: function(animationFrame) {\r\n    if (animationFrame) {\r\n      requestAnimationFrame(this.update.bind(this));\r\n    }\r\n\r\n    var time = performance.now();\r\n    var dt = (time - this.prevTime) / 1000;\r\n    Globals.instance.dt = dt;\r\n\r\n    if (!this.paused) {\r\n      if (dt > 0.05) {\r\n        dt = 0.05;\r\n      }\r\n\r\n      this.systems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      this.scene.simulate(dt);\r\n\r\n      this.postPhysicsSystems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      this.waveCheck();\r\n\r\n      Globals.instance.sound.update(dt);\r\n\r\n      MouseController.instance.update(dt);\r\n    }\r\n\r\n    this.renderer.render(this.scene, this.camera);\r\n\r\n    this.rendererStats.update(this.renderer);\r\n    this.stats.update();\r\n\r\n    this.prevTime = time;\r\n  },\r\n\r\n  waveCheck: function() {\r\n    var enemies = EntityFactory.instance.entities.queryTag('enemy');\r\n\r\n    if (enemies.length === 0) {\r\n      Globals.instance.currentWave++;\r\n\r\n      if (Globals.instance.currentWave > Game.TOTAL_WAVES) {\r\n        Globals.instance.waveElement.innerHTML = 'Victory!';\r\n\r\n        document.exitPointerLock();\r\n\r\n        setTimeout(function() {\r\n          document.location.href = 'victory.php?score=' + Globals.instance.score;\r\n        }, 100);\r\n      }\r\n      else {\r\n        this.createNextWave(Globals.instance.currentWave * 2);\r\n\r\n        Globals.instance.waveElement.innerHTML = Globals.instance.currentWave + ' / ' + Game.TOTAL_WAVES;\r\n      }\r\n    }\r\n  },\r\n\r\n  createNextWave: function(enemyCount) {\r\n    for (var i = 0; i < enemyCount; i++) {\r\n      var enemyPosition = new THREE.Vector3(Utils.randomRange(-750, 750), 30, Utils.randomRange(-750, 750));\r\n\r\n      while (enemyPosition.distanceTo(this.player.drawable.mesh.position) < Game.SPAWN_SAFETY_BUBBLE) {\r\n        enemyPosition = new THREE.Vector3(Utils.randomRange(-750, 750), 30, Utils.randomRange(-750, 750));\r\n      }\r\n\r\n      EntityFactory.instance.makeEnemy({\r\n        scene: this.scene,\r\n        position: new THREE.Vector3(Utils.randomRange(-750, 750), 30, Utils.randomRange(-750, 750)),\r\n        rotation: new THREE.Euler(0, Utils.randomRange(-Math.PI / 2, Math.PI / 2), 0, 'XYZ'),\r\n        leashDistance: Utils.randomRange(EntityFactory.MIN_LEASH_DISTANCE.enemy, EntityFactory.MAX_LEASH_DISTANCE.enemy),\r\n        aiTarget: this.player,\r\n        bulletSpeed: Utils.randomRange(EntityFactory.MIN_BULLET_SPEED.enemy, EntityFactory.MAX_BULLET_SPEED.enemy),\r\n        shootDistance: Utils.randomRange(EntityFactory.MIN_SHOOT_DISTANCE.enemy, EntityFactory.MAX_SHOOT_DISTANCE.enemy),\r\n        hp: Utils.randomRange(EntityFactory.MIN_START_HP.enemy, EntityFactory.MAX_START_HP.enemy),\r\n        color: new THREE.Color(Math.random(), Math.random(), Math.random())\r\n      });\r\n    }\r\n  },\r\n\r\n  restartGame: function() {\r\n    this.player = null;\r\n\r\n    var entities = EntityFactory.instance.entities;\r\n\r\n    var drawables = entities.queryComponents([C.Drawable]);\r\n    drawables.forEach(function(entity) {\r\n      var geometry, material;\r\n\r\n      if (entity.hasComponent(C.Health) && entity.health.healthBar) {\r\n        geometry = entity.health.healthBar.geometry;\r\n        material = entity.health.healthBar.material;\r\n\r\n        entity.drawable.mesh.remove(entity.health.healthBar);\r\n\r\n        geometry.dispose();\r\n\r\n        if (material.materials) {\r\n          material.materials.forEach(function(mat) {\r\n            mat.dispose();\r\n          });\r\n        }\r\n\r\n        if (material.dispose) {\r\n          material.dispose();\r\n        }\r\n      }\r\n\r\n      if (entity.hasComponent(C.Steaming)) {\r\n        geometry = entity.steaming.particles;\r\n        material = entity.steaming.system.material;\r\n\r\n        entity.drawable.mesh.remove(entity.steaming.container);\r\n\r\n        geometry.dispose();\r\n\r\n        if (material.materials) {\r\n          material.materials.forEach(function(mat) {\r\n            mat.dispose();\r\n          });\r\n        }\r\n\r\n        if (material.dispose) {\r\n          material.dispose();\r\n        }\r\n      }\r\n\r\n      geometry = entity.drawable.mesh.geometry;\r\n      material = entity.drawable.mesh.material;\r\n\r\n      entity.drawable.scene.remove(entity.drawable.mesh);\r\n\r\n      geometry.dispose();\r\n\r\n      if (material.materials) {\r\n        material.materials.forEach(function(mat) {\r\n          mat.dispose();\r\n        });\r\n      }\r\n\r\n      if (material.dispose) {\r\n        material.dispose();\r\n      }\r\n    });\r\n\r\n    entities.removeAllEntities();\r\n\r\n    Globals.instance.reloadImg.pause();\r\n    Globals.instance.reloadingElement.style.visibility = \"hidden\";\r\n\r\n    this.createRequiredEntities();\r\n\r\n    Globals.instance.currentWave = 0;\r\n\r\n    this.waveCheck();\r\n  },\r\n\r\n  createRequiredEntities: function() {\r\n    EntityFactory.instance.makeGround({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 2000\r\n    });\r\n\r\n\r\n    EntityFactory.instance.makeSkyWall({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 1000,\r\n      position: new THREE.Vector3(0, 500, -1000),\r\n      rotation: new THREE.Euler(Math.PI / 2, Math.PI, 0, 'XYZ')\r\n    });\r\n\r\n    EntityFactory.instance.makeSkyWall({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 1000,\r\n      position: new THREE.Vector3(0, 500, 1000),\r\n      rotation: new THREE.Euler(Math.PI / 2, 0, 0, 'XYZ')\r\n    });\r\n\r\n    EntityFactory.instance.makeSkyWall({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 1000,\r\n      position: new THREE.Vector3(1000, 500, 0),\r\n      rotation: new THREE.Euler(Math.PI / 2, 0, -Math.PI / 2, 'XYZ')\r\n    });\r\n\r\n    EntityFactory.instance.makeSkyWall({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 1000,\r\n      position: new THREE.Vector3(-1000, 500, 0),\r\n      rotation: new THREE.Euler(Math.PI / 2, 0, Math.PI / 2, 'XYZ')\r\n    });\r\n\r\n    EntityFactory.instance.makeSkyWall({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 2000,\r\n      position: new THREE.Vector3(0, 1000, 0),\r\n      rotation: new THREE.Euler(0, Math.PI, 0, 'XYZ')\r\n    });\r\n\r\n    this.player = EntityFactory.instance.makePlayer({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(0, 30, 0),\r\n      controls: this.controls,\r\n      controlsObject: this.controls.getObject(),\r\n      cameraOffset: new THREE.Vector3(0, 10, 0), // 10, 10, 25\r\n      gunOffset: new THREE.Vector3(9, 8, 0),\r\n      hp: 40\r\n    });\r\n  },\r\n\r\n  onResize: function(e) {\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n\r\n    this.camera.aspect = (window.innerWidth / window.innerHeight);\r\n    this.camera.updateProjectionMatrix();\r\n  },\r\n\r\n  onKeyDown: function(e) {\r\n    var keyCode = ('which' in event) ? event.which : event.keyCode;\r\n\r\n    if (keyCode === Game.KEY_CODES.enter) {\r\n      this.restartGame();\r\n    }\r\n\r\n    return (keyCode !== Game.KEY_CODES.space);\r\n  },\r\n\r\n  onMouseDown: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = true;\r\n    }\r\n  },\r\n\r\n  onMouseUp: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = false;\r\n      MouseController.instance.wasPressed.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = false;\r\n      MouseController.instance.wasPressed.right = true;\r\n    }\r\n  },\r\n\r\n  onMouseWheel: function(e, delta, deltaX, deltaY) {\r\n    if (MouseController.instance.canScrollWheel === false || this.paused === true || Globals.instance.playerAlive === false) {\r\n      return;\r\n    }\r\n\r\n    var scrolledUp = delta > 0;\r\n\r\n    if (scrolledUp) {\r\n      this.player.gun.type++;\r\n\r\n      if (this.player.gun.type > Game.TOTAL_GUN_TYPES) {\r\n        this.player.gun.type = Game.BASE_GUN_TYPE;\r\n      }\r\n    }\r\n    else {\r\n      this.player.gun.type--;\r\n\r\n      if (this.player.gun.type < Game.BASE_GUN_TYPE) {\r\n        this.player.gun.type = Game.TOTAL_GUN_TYPES;\r\n      }\r\n    }\r\n\r\n    Globals.instance.ammoElement.innerHTML = (this.player.ammo.currentAmmo[this.player.gun.type] + ' / ' + this.player.ammo.maxAmmo[this.player.gun.type]);\r\n    Globals.instance.weaponNameElement.innerHTML = Game.GUN_NAMES[this.player.gun.type];\r\n    Globals.instance.weaponIconElement.src = Game.GUN_ICONS[this.player.gun.type];\r\n\r\n    MouseController.instance.canScrollWheel = false;\r\n  },\r\n\r\n  initPointerLock: function() {\r\n    var havePointerLock = 'pointerLockElement' in document || 'mozPointerLockElement' in document || 'webkitPointerLockElement' in document;\r\n\r\n    if (havePointerLock) {\r\n\r\n      var element = document.body;\r\n\r\n      document.exitPointerLock = document.exitPointerLock ||\r\n        document.mozExitPointerLock ||\r\n        document.webkitExitPointerLock;\r\n\r\n      var pointerlockchange = function(event) {\r\n\r\n        if (document.pointerLockElement === element || document.mozPointerLockElement === element || document.webkitPointerLockElement === element) {\r\n\r\n          this.controlsEnabled = true;\r\n          this.controls.enabled = true;\r\n\r\n          this.blocker.style.display = 'none';\r\n\r\n          if (Globals.instance.reloadingElement.style.visibility === 'visible') {\r\n            Globals.instance.reloadImg.play();\r\n          }\r\n\r\n          this.paused = false;\r\n\r\n        }\r\n        else {\r\n\r\n          this.controlsEnabled = false;\r\n          this.controls.enabled = false;\r\n\r\n          this.blocker.style.display = '-webkit-box';\r\n          this.blocker.style.display = '-moz-box';\r\n          this.blocker.style.display = 'box';\r\n\r\n          this.instructions.style.display = '';\r\n\r\n          if (Globals.instance.reloadImg.get_playing()) {\r\n            Globals.instance.reloadImg.pause();\r\n          }\r\n\r\n          this.paused = true;\r\n\r\n        }\r\n\r\n      }.bind(this);\r\n\r\n      var pointerlockerror = function(event) {\r\n\r\n        this.instructions.style.display = '';\r\n\r\n      }.bind(this);\r\n\r\n      // Hook pointer lock state change events\r\n      document.addEventListener('pointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('mozpointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('webkitpointerlockchange', pointerlockchange, false);\r\n\r\n      document.addEventListener('pointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('mozpointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('webkitpointerlockerror', pointerlockerror, false);\r\n\r\n      this.instructions.addEventListener('click', function(event) {\r\n\r\n        this.instructions.style.display = 'none';\r\n\r\n        // Ask the browser to lock the pointer\r\n        element.requestPointerLock = element.requestPointerLock || element.mozRequestPointerLock || element.webkitRequestPointerLock;\r\n\r\n        if (/Firefox/i.test(navigator.userAgent)) {\r\n\r\n          var fullscreenchange = function(event) {\r\n\r\n            if (document.fullscreenElement === element || document.mozFullscreenElement === element || document.mozFullScreenElement === element) {\r\n\r\n              document.removeEventListener('fullscreenchange', fullscreenchange);\r\n              document.removeEventListener('mozfullscreenchange', fullscreenchange);\r\n\r\n              element.requestPointerLock();\r\n            }\r\n\r\n          };\r\n\r\n          document.addEventListener('fullscreenchange', fullscreenchange, false);\r\n          document.addEventListener('mozfullscreenchange', fullscreenchange, false);\r\n\r\n          element.requestFullscreen = element.requestFullscreen || element.mozRequestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;\r\n\r\n          element.requestFullscreen();\r\n\r\n        }\r\n        else {\r\n\r\n          element.requestPointerLock();\r\n\r\n        }\r\n\r\n      }.bind(this), false);\r\n\r\n    }\r\n    else {\r\n\r\n      this.instructions.innerHTML = 'Your browser doesn\\'t seem to support Pointer Lock API';\r\n\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    KEY_CODES: {\r\n      space: 32,\r\n      enter: 13\r\n    },\r\n\r\n    GUN_TYPES: {\r\n      none: 0,\r\n      potatoCannon: 1,\r\n      scatterFries: 2\r\n    },\r\n\r\n    GUN_ICONS: {\r\n      0: '',\r\n      1: 'gfx/potatoIcon.png',\r\n      2: 'gfx/frenchFriesIcon.png'\r\n    },\r\n\r\n    GUN_NAMES: {\r\n      0: 'Fisticuffs',\r\n      1: 'T.A.T.E.R',\r\n      2: 'Scatter Fries'\r\n    },\r\n\r\n    BASE_GUN_TYPE: 1,\r\n    TOTAL_GUN_TYPES: 2,\r\n\r\n    TOTAL_WAVES: 5,\r\n\r\n    SPAWN_SAFETY_BUBBLE: 50\r\n  }\r\n});\r\n\r\n","Model = Class({\r\n  constructor: function(options) {\r\n    this.geometry = options.geometry;\r\n    this.material = options.material;\r\n  },\r\n\r\n  clone: function() {\r\n    return new Model({\r\n      geometry: this.geometry.clone(),\r\n      material: this.material.clone()\r\n    });\r\n  }\r\n});\r\n\r\n/*\r\n * Helper singleton class used to manage resources. Handles the loading and use of 3D models and 2D textures.\r\n */\r\nResourceManager = Class({\r\n  constructor: function() {\r\n    this.loadingManager = new THREE.LoadingManager();\r\n\r\n    this.jsonLoader = new THREE.JSONLoader(this.loadingManager);\r\n\r\n    this.textures = {};\r\n    this.models = {};\r\n  },\r\n\r\n  loadTexture: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.textures) {\r\n      throw new Error(\"The texture located at \" + path + \" is already loaded\");\r\n    }\r\n\r\n    this.textures[path] = THREE.ImageUtils.loadTexture(path, undefined, options.callback, function(e) {\r\n      console.log(e);\r\n    });\r\n  },\r\n\r\n  getTexture: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.textures) {\r\n      return this.textures[path];\r\n    }\r\n\r\n    throw new Error(\"The texture located at \" + path + \" is not loaded\");\r\n  },\r\n\r\n  loadModel: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.models) {\r\n      throw new Error(\"The model located at \" + path + \" is already loaded\");\r\n    }\r\n\r\n    this.jsonLoader.load(path, function(geometry, materials) {\r\n      var material = new THREE.MeshFaceMaterial(materials);\r\n\r\n      var model = new Model({\r\n        geometry: geometry,\r\n        material: material\r\n      });\r\n      this.models[path] = model;\r\n\r\n      if (options.callback) {\r\n        options.callback(model);\r\n      }\r\n    }.bind(this));\r\n  },\r\n\r\n  getModel: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.models) {\r\n      return this.models[path];\r\n    }\r\n\r\n    throw new Error(\"The model located at \" + path + \" is not loaded\");\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!ResourceManager._instance) {\r\n        ResourceManager._instance = new ResourceManager();\r\n      }\r\n      return ResourceManager._instance;\r\n    }\r\n  }\r\n});\r\n\r\n","Globals = Class({\r\n  constructor: function() {\r\n    this.dt = 0;\r\n    this.playerAlive = true;\r\n\r\n    this.hudElement = null;\r\n\r\n    this.healthElement = null;\r\n    this.shieldElement = null;\r\n    this.ammoElement = null;\r\n\r\n    this.scoreElement = null;\r\n    this.score = 0;\r\n\r\n    this.reloadingElement = null;\r\n    this.reloadImg = null;\r\n\r\n    this.weaponSelectorElement = null;\r\n    this.weaponNameElement = null;\r\n    this.weaponIconElement = null;\r\n\r\n    this.waveElement = null;\r\n\r\n    this.overlayElement = null;\r\n\r\n    this.sound = null;\r\n\r\n    this.currentWave = 0;\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!Globals._instance) {\r\n        Globals._instance = new Globals();\r\n      }\r\n      return Globals._instance;\r\n    },\r\n\r\n    DIR: \"./\",\r\n\r\n    ENTITY_TYPES: {\r\n      player: 0,\r\n      enemy: 1,\r\n\r\n      ground: 2,\r\n      obstacle: 3,\r\n\r\n      gun: 4,\r\n      bullet: 5,\r\n\r\n      pickup: 6\r\n    }\r\n  }\r\n});\r\n\r\n","/*\r\n * Helper singleton class that manages details of the mouse's state.\r\n */\r\nMouseController = Class({\r\n  constructor: function() {\r\n    this.isDown = {\r\n      left: false,\r\n      right: false\r\n    };\r\n\r\n    this.wasPressed = {\r\n      left: false,\r\n      right: false\r\n    };\r\n\r\n    this.canScrollWheel = true;\r\n    this.__scrollWheelDelay = 0;\r\n  },\r\n\r\n  update: function(dt) {\r\n    this.wasPressed.left = false;\r\n    this.wasPressed.right = false;\r\n\r\n    if (this.canScrollWheel === false) {\r\n      this.__scrollWheelDelay += dt;\r\n\r\n      if (this.__scrollWheelDelay > MouseController.SCROLL_WHEEL_DELAY_THRESHOLD) {\r\n        this.canScrollWheel = true;\r\n        this.__scrollWheelDelay = 0;\r\n      }\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!MouseController._instance) {\r\n        MouseController._instance = new MouseController();\r\n      }\r\n      return MouseController._instance;\r\n    },\r\n\r\n    SCROLL_WHEEL_DELAY_THRESHOLD: 0.5\r\n  }\r\n});\r\n\r\n","var THREEx = require('./THREEx.KeyboardState.js');\r\nvar C = require('./Components.js');\r\nvar Utils = require('./Utils.js');\r\n\r\nPlayerInputSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n\r\n    this.keyboard = new THREEx.KeyboardState();\r\n    this.jumped = false;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n      var dv = new THREE.Vector3(); // delta velocity\r\n\r\n      if (this.keyboard.pressed(\"w\")) {\r\n        dv.z = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"s\")) {\r\n        dv.z = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"a\")) {\r\n        dv.x = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"d\")) {\r\n        dv.x = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"space\") && entity.jump.canJump) {\r\n        dv.y = PlayerInputSystem.JUMP_FORCE;\r\n        entity.jump.canJump = false;\r\n      }\r\n\r\n      dv = dv.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      velocity.add(dv);\r\n\r\n      entity.velocity.x = velocity.x;\r\n      entity.velocity.y = velocity.y;\r\n      entity.velocity.z = velocity.z;\r\n\r\n      if (MouseController.instance.isDown.right) {\r\n        if (entity.shield.currentValue > 0) {\r\n          entity.shield.enabled = true;\r\n        }\r\n      }\r\n      else if (MouseController.instance.wasPressed.right) {\r\n        entity.shield.timer = 0;\r\n        entity.shield.enabled = false;\r\n      }\r\n\r\n      if (MouseController.instance.wasPressed.left) {\r\n        if (entity.shootDelay.canShoot && entity.shield.enabled === false) {\r\n          if (entity.gun.type === Game.GUN_TYPES.potatoCannon && entity.ammo.currentAmmo[Game.GUN_TYPES.potatoCannon] > 0) {\r\n            var direction = new THREE.Vector3();\r\n            entity.cameraFollow.controls.getDirection(direction);\r\n\r\n            var gunPos = new THREE.Vector3().setFromMatrixPosition(entity.gun.mesh.matrixWorld);\r\n            var bulletPos = gunPos.clone();\r\n            var bulletOffset = new THREE.Vector3(0, 0.4, -25);\r\n\r\n            var rotationMatrix = entity.velocity.rotationMatrix.clone();\r\n            var yMatrix = new THREE.Matrix4().extractRotation(entity.cameraFollow.controls.pitchObject.matrix);\r\n            rotationMatrix.multiply(yMatrix);\r\n\r\n            bulletOffset.applyMatrix4(rotationMatrix);\r\n            bulletPos.add(bulletOffset);\r\n\r\n            var bulletRot = entity.cameraFollow.object.rotation.clone();\r\n\r\n            EntityFactory.instance.makePotato({\r\n              scene: entity.drawable.scene,\r\n              position: bulletPos,\r\n              rotation: bulletRot,\r\n              direction: direction,\r\n              rotationMatrix: entity.velocity.rotationMatrix,\r\n              velocity: PlayerInputSystem.POTATO_SPEED,\r\n              owner: 'player'\r\n            });\r\n\r\n            entity.shootDelay.canShoot = false;\r\n\r\n            Globals.instance.reloadImg.move_to(0);\r\n            Globals.instance.reloadImg.play();\r\n            Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n\r\n            entity.ammo.currentAmmo[entity.gun.type] -= 1;\r\n            Globals.instance.ammoElement.innerHTML = (entity.ammo.currentAmmo[entity.gun.type] + ' / ' + entity.ammo.maxAmmo[entity.gun.type]);\r\n\r\n            var sound = Globals.instance.sound.getSound('sfx/arrowlessBow.mp3');\r\n            sound.setPosition(gunPos);\r\n            sound.setVelocity(velocity);\r\n            sound.setOrientation(direction);\r\n            sound.play();\r\n          }\r\n          else if (entity.gun.type === Game.GUN_TYPES.scatterFries && entity.ammo.currentAmmo[Game.GUN_TYPES.scatterFries] > 0) {\r\n            var baseDirection = new THREE.Vector3();\r\n            entity.cameraFollow.controls.getDirection(baseDirection);\r\n\r\n            var basePos = new THREE.Vector3().setFromMatrixPosition(entity.gun.mesh.matrixWorld);\r\n\r\n            var rotationMatrix = entity.velocity.rotationMatrix.clone();\r\n            var yMatrix = new THREE.Matrix4().extractRotation(entity.cameraFollow.controls.pitchObject.matrix);\r\n            rotationMatrix.multiply(yMatrix);\r\n\r\n            var bulletRot = entity.cameraFollow.object.rotation.clone();\r\n\r\n            var numFries = Math.round(Utils.randomRange(4, 9));\r\n            if (numFries > entity.ammo.currentAmmo[Game.GUN_TYPES.scatterFries]) {\r\n              numFries = entity.ammo.currentAmmo[Game.GUN_TYPES.scatterFries];\r\n            }\r\n            for (var i = 0; i < numFries; i++) {\r\n              var bulletPos = basePos.clone();\r\n              var bulletOffset = new THREE.Vector3(Utils.randomRange(-1, 1), Utils.randomRange(-1, 1), -30);\r\n\r\n              bulletOffset.applyMatrix4(rotationMatrix);\r\n              bulletPos.add(bulletOffset);\r\n\r\n              var piOver2 = Math.PI / 2;\r\n\r\n              bulletRot.x += Utils.randomRange(-piOver2, piOver2);\r\n              bulletRot.z += Utils.randomRange(-piOver2, piOver2);\r\n\r\n              var bulletDirection = baseDirection.clone();\r\n              bulletDirection.x += Utils.randomRange(-0.1, 0.1);\r\n              bulletDirection.y += Utils.randomRange(-0.1, 0.2);\r\n              bulletDirection.z += Utils.randomRange(-0.1, 0.1);\r\n\r\n              EntityFactory.instance.makeFry({\r\n                scene: entity.drawable.scene,\r\n                position: bulletPos,\r\n                rotation: bulletRot,\r\n                direction: bulletDirection,\r\n                rotationMatrix: entity.velocity.rotationMatrix,\r\n                velocity: PlayerInputSystem.FRY_SPEED,\r\n                owner: 'player'\r\n              });\r\n            }\r\n\r\n            entity.shootDelay.canShoot = false;\r\n\r\n            Globals.instance.reloadImg.move_to(0);\r\n            Globals.instance.reloadImg.play();\r\n            Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n\r\n            entity.ammo.currentAmmo[entity.gun.type] -= numFries;\r\n            Globals.instance.ammoElement.innerHTML = (entity.ammo.currentAmmo[entity.gun.type] + ' / ' + entity.ammo.maxAmmo[entity.gun.type]);\r\n\r\n            var sound = Globals.instance.sound.getSound('sfx/arrowlessBow.mp3');\r\n            sound.setPosition(basePos);\r\n            sound.setVelocity(velocity);\r\n            sound.setOrientation(baseDirection);\r\n            sound.play();\r\n          }\r\n        }\r\n      }\r\n    }.bind(this));\r\n  }\r\n}, {\r\n  statics: {\r\n    MOVE_SPEED: 300,\r\n    JUMP_FORCE: 4000,\r\n    POTATO_SPEED: 70,\r\n    FRY_SPEED: 0.5\r\n  }\r\n});\r\n\r\nMovementSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n\r\n      if (entity.velocity.doMove === false) {\r\n        return;\r\n      }\r\n\r\n      if (entity.hasComponent(C.Drawable)) {\r\n        entity.drawable.mesh.applyCentralImpulse(velocity);\r\n      }\r\n      else {\r\n        entity.position.x += velocity.x * dt;\r\n        entity.position.y += velocity.y * dt;\r\n        entity.position.z += velocity.z * dt;\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nExpirableSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var expirables = this.entities.queryComponents([C.Expirable]);\r\n\r\n    expirables.forEach(function(entity) {\r\n      entity.expirable.age += dt;\r\n\r\n      if (entity.expirable.age >= entity.expirable.maxAge) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          var geometry = entity.drawable.mesh.geometry;\r\n          var material = entity.drawable.mesh.material;\r\n\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n\r\n          geometry.dispose();\r\n\r\n          if (material.materials) {\r\n            material.materials.forEach(function(mat) {\r\n              mat.dispose();\r\n            });\r\n          }\r\n\r\n          if (material.dispose) {\r\n            material.dispose();\r\n          }\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nCameraFollowSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var follows = this.entities.queryComponents([C.CameraFollow, C.Position, C.Velocity]);\r\n\r\n    if (follows.length > 1) {\r\n      throw new Error(\"The camera can only follow one object at a time!\");\r\n    }\r\n\r\n    follows.forEach(function(entity) {\r\n      if (entity.velocity.rotationMatrix === null) {\r\n        return;\r\n      }\r\n\r\n      var offset = entity.cameraFollow.offset.clone();\r\n      offset = offset.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      entity.cameraFollow.object.position.x = entity.position.x + offset.x;\r\n      entity.cameraFollow.object.position.y = entity.position.y + offset.y;\r\n      entity.cameraFollow.object.position.z = entity.position.z + offset.z;\r\n\r\n      entity.drawable.mesh.rotation.x = entity.cameraFollow.object.rotation.x;\r\n      entity.drawable.mesh.rotation.y = entity.cameraFollow.object.rotation.y;\r\n      entity.drawable.mesh.rotation.z = entity.cameraFollow.object.rotation.z;\r\n    });\r\n  }\r\n});\r\n\r\nShootDelaySystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var shooters = this.entities.queryComponents([C.ShootDelay]);\r\n\r\n    shooters.forEach(function(entity) {\r\n      if (entity.shootDelay.canShoot === false) {\r\n        entity.shootDelay.timer += dt;\r\n\r\n        if (entity.shootDelay.timer > entity.shootDelay.delayTheshold) {\r\n          entity.shootDelay.canShoot = true;\r\n          entity.shootDelay.timer = 0;\r\n\r\n          Globals.instance.reloadImg.pause();\r\n          Globals.instance.reloadingElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nHurtSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var hurtables = this.entities.queryComponents([C.Hurt, C.Drawable]);\r\n\r\n    hurtables.forEach(function(entity) {\r\n      entity.hurt.timer += dt;\r\n\r\n      if (entity.hurt.timer < entity.hurt.timerThreshold) {\r\n        entity.drawable.mesh.material.color = entity.hurt.hurtColor;\r\n\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.backgroundColor = \"#bb0000\";\r\n          Globals.instance.overlayElement.style.visibility = \"visible\";\r\n        }\r\n      }\r\n      else {\r\n        entity.drawable.mesh.material.color = entity.hurt.originalColor;\r\n\r\n        entity.removeComponent(C.Hurt);\r\n\r\n        if (entity.hasTag(\"player\") && entity.shield.enabled === false) {\r\n          Globals.instance.overlayElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nShieldSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var shieldables = this.entities.queryComponents([C.Shield, C.Drawable]);\r\n\r\n    shieldables.forEach(function(entity) {\r\n      if (entity.shield.enabled) {\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.backgroundColor = \"#0000cc\";\r\n          Globals.instance.overlayElement.style.visibility = \"visible\";\r\n        }\r\n      }\r\n      else {\r\n        if (entity.shield.currentValue < entity.shield.maxValue) {\r\n          if (entity.shield.timer < entity.shield.rechargeDelay) {\r\n            entity.shield.timer += dt;\r\n          }\r\n          else {\r\n            entity.shield.currentValue += entity.shield.rechargeRate;\r\n\r\n            if (entity.shield.currentValue > entity.shield.maxValue) {\r\n              entity.shield.currentValue = entity.shield.maxValue;\r\n            }\r\n\r\n            entity.shield.changed = true;\r\n          }\r\n        }\r\n\r\n        if (entity.hasTag(\"player\") && entity.hasComponent(C.Hurt) === false) {\r\n          Globals.instance.overlayElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nPlayerHealthSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      if (entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      entity.health.hp = THREE.Math.clamp(entity.health.hp, 0, entity.health.maxHP);\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n      var percentRounded = Math.round(percent * 100);\r\n\r\n      var healthElement = Globals.instance.healthElement;\r\n      var color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      healthElement.innerHTML = percentRounded + \"%\";\r\n      healthElement.style.color = \"#\" + color.getHexString();\r\n\r\n      if (entity.health.hp <= 0) {\r\n        Globals.instance.playerAlive = false;\r\n      }\r\n\r\n      entity.health.changed = false;\r\n    });\r\n  }\r\n});\r\n\r\nPlayerShieldSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      if (entity.shield.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.shield.currentValue / entity.shield.maxValue;\r\n      var percentRounded = Math.round(percent * 100);\r\n\r\n      var shieldElement = Globals.instance.shieldElement;\r\n      var color = new THREE.Color(1 - percent, 0, percent);\r\n\r\n      shieldElement.innerHTML = percentRounded + \"%\";\r\n      shieldElement.style.color = \"#\" + color.getHexString();\r\n\r\n      entity.shield.changed = false;\r\n    });\r\n  }\r\n});\r\n\r\nHealthBarSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.healthBar === null || entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n\r\n      entity.health.healthBar.scale.x = percent;\r\n      entity.health.healthBar.material.color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      entity.health.changed = false;\r\n    });\r\n  }\r\n});\r\n\r\nDeathSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.hp <= 0) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          var geometry, material;\r\n\r\n          if (entity.identifier.type === Globals.ENTITY_TYPES.enemy) {\r\n            Globals.instance.score += 10;\r\n\r\n            Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n            if (entity.hasComponent(C.DropsPickup) && Math.random() < entity.dropsPickup.dropChance) {\r\n              var randPickup = Math.floor(Utils.randomRange(0, entity.dropsPickup.dropTypes.length));\r\n              var pickupToMake = entity.dropsPickup.dropTypes[randPickup];\r\n\r\n              EntityFactory.instance[\"make\" + pickupToMake + \"Pickup\"]({\r\n                scene: entity.drawable.scene,\r\n                position: entity.drawable.mesh.position.clone(),\r\n                rotation: new THREE.Euler(0, Utils.randomRange(-Math.PI / 2, Math.PI / 2), 0, 'XYZ')\r\n              });\r\n            }\r\n          }\r\n\r\n          if (entity.health.healthBar) {\r\n            geometry = entity.health.healthBar.geometry;\r\n            material = entity.health.healthBar.material;\r\n\r\n            entity.drawable.mesh.remove(entity.health.healthBar);\r\n\r\n            geometry.dispose();\r\n\r\n            if (material.materials) {\r\n              material.materials.forEach(function(mat) {\r\n                mat.dispose();\r\n              });\r\n            }\r\n\r\n            if (material.dispose) {\r\n              material.dispose();\r\n            }\r\n          }\r\n\r\n          geometry = entity.drawable.mesh.geometry;\r\n          material = entity.drawable.mesh.material;\r\n\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n\r\n          geometry.dispose();\r\n\r\n          if (material.materials) {\r\n            material.materials.forEach(function(mat) {\r\n              mat.dispose();\r\n            });\r\n          }\r\n\r\n          if (material.dispose) {\r\n            material.dispose();\r\n          }\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nAISystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var singularities = this.entities.queryComponents([C.AI]);\r\n\r\n    singularities.forEach(function(entity) {\r\n      if (entity.ai.tree === null || entity.ai.target === null || entity.ai.blackboard === null) {\r\n        return;\r\n      }\r\n\r\n      entity.ai.tree.tick(entity.ai.target, entity.ai.blackboard);\r\n    });\r\n  }\r\n});\r\n\r\nSteamUpdateSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var steaming = this.entities.queryComponents([C.Steaming]);\r\n\r\n    steaming.forEach(function(entity) {\r\n      var particles = entity.steaming.particles;\r\n\r\n      var particleCount = particles.vertices.length;\r\n      while (particleCount--) {\r\n        var particle = particles.vertices[particleCount];\r\n        particle.y += dt * 50;\r\n\r\n        if (particle.y >= 5 + Utils.randomRange(-2, 4)) {\r\n          particle.y = Math.random();\r\n          particle.x = Math.random() * Utils.randomRange(-2, 2);\r\n          particle.z = Math.random() * Utils.randomRange(-2, 2);\r\n        }\r\n      }\r\n\r\n      particles.verticesNeedUpdate = true;\r\n    });\r\n  }\r\n});\r\n\r\nSteamRemovalSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var steaming = this.entities.queryComponents([C.Steaming, C.Bullet, C.Drawable]);\r\n\r\n    steaming.forEach(function(entity) {\r\n      if (entity.bullet.isHot === false) {\r\n        var geometry = entity.steaming.particles;\r\n        var material = entity.steaming.system.material;\r\n\r\n        entity.drawable.mesh.remove(entity.steaming.container);\r\n\r\n        geometry.dispose();\r\n\r\n        if (material.materials) {\r\n          material.materials.forEach(function(mat) {\r\n            mat.dispose();\r\n          });\r\n        }\r\n\r\n        if (material.dispose) {\r\n          material.dispose();\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nCameraPitchSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var pitchables = this.entities.queryComponents([C.CameraPitch, C.Drawable]);\r\n\r\n    pitchables.forEach(function(entity) {\r\n      entity.drawable.mesh.rotation.x = entity.cameraPitch.controls.pitchObject.rotation.x + entity.cameraPitch.offset;\r\n    });\r\n  }\r\n});\r\n\r\nPhysicsUpdateSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity, C.Drawable]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      entity.position.x = entity.drawable.mesh.position.x;\r\n      entity.position.y = entity.drawable.mesh.position.y;\r\n      entity.position.z = entity.drawable.mesh.position.z;\r\n\r\n      entity.velocity.x = entity.drawable.mesh.getLinearVelocity().x;\r\n      entity.velocity.y = entity.drawable.mesh.getLinearVelocity().y;\r\n      entity.velocity.z = entity.drawable.mesh.getLinearVelocity().z;\r\n\r\n      entity.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(entity.drawable.mesh.matrix);\r\n    });\r\n  }\r\n});\r\n\r\n","// http://www.html5rocks.com/en/tutorials/webaudio/intro/\r\n// http://www.html5rocks.com/en/tutorials/webaudio/positional_audio/\r\n\r\n/*\r\n * This class contains data and methods needed to play a 3D positioned sound.\r\n */\r\nSound = Class({\r\n  constructor: function(options) {\r\n    this.context = options.context;\r\n    this.source = this.context.createBufferSource();\r\n    this.volume = this.context.createGain();\r\n    this.panner = this.context.createPanner();\r\n\r\n    this.volume.connect(this.panner);\r\n    this.panner.connect(options.mainVolume);\r\n\r\n    this.source.loop = options.loop || false;\r\n\r\n    var self = this;\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open(\"GET\", options.path, true);\r\n    request.responseType = \"arraybuffer\";\r\n    request.onload = function(e) {\r\n      self.context.decodeAudioData(this.response, function onSuccess(buffer) {\r\n        self.buffer = buffer;\r\n\r\n        self.source.buffer = self.buffer;\r\n\r\n        if (options.callback) {\r\n          options.callback(self);\r\n        }\r\n      }, function onFailure() {\r\n        alert(\"Decoding the audio buffer failed\");\r\n      });\r\n    };\r\n    request.send();\r\n  },\r\n\r\n  setPosition: function(position) {\r\n    this.panner.setPosition(position.x, position.y, position.z);\r\n  },\r\n\r\n  setVelocity: function(velocity) {\r\n    this.panner.setVelocity(velocity.x, velocity.y, velocity.z);\r\n  },\r\n\r\n  setOrientation: function(orientation) {\r\n    this.panner.setOrientation(orientation.x, orientation.y, orientation.z);\r\n  },\r\n\r\n  setVolume: function(volume) {\r\n    this.volume.gain = volume;\r\n  },\r\n\r\n  play: function(startTime) {\r\n    this.source = this.context.createBufferSource();\r\n    this.source.buffer = this.buffer;\r\n    this.source.connect(this.volume);\r\n    this.source.start(startTime || 0);\r\n  }\r\n});\r\n\r\n/*\r\n * Helper class used to manage audio resources. Handles the loading and playing of sounds in 3D space.\r\n */\r\nSoundController = Class({\r\n  constructor: function(options) {\r\n    this.context = options.context;\r\n\r\n    this.mainVolume = this.context.createGain();\r\n    this.mainVolume.connect(this.context.destination);\r\n\r\n    this.following = options.following;\r\n\r\n    this.sounds = {};\r\n  },\r\n\r\n  update: function(dt) {\r\n    var position = new THREE.Vector3().setFromMatrixPosition(this.following.matrixWorld);\r\n    this.setListenerPosition(position);\r\n\r\n    var orientation = new THREE.Vector3(0, 0, 1);\r\n    orientation.applyProjection(this.following.matrix);\r\n    orientation.normalize();\r\n\r\n    var up = new THREE.Vector3(0, -1, 0);\r\n    up.applyProjection(this.following.matrix);\r\n    up.normalize();\r\n\r\n    this.setListenerOrientation(orientation, up);\r\n  },\r\n\r\n  loadSound: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.sounds) {\r\n      throw new Error(\"The sound located at \" + path + \" is already loaded\");\r\n    }\r\n\r\n    this.sounds[path] = new Sound({\r\n      context: this.context,\r\n      mainVolume: this.mainVolume,\r\n      path: path,\r\n      callback: options.callback\r\n    });\r\n  },\r\n\r\n  getSound: function(path, options) {\r\n    options = options || {};\r\n    var crossOrigin = options.crossOrigin || false;\r\n\r\n    if (crossOrigin === false) {\r\n      path = Globals.DIR + path;\r\n    }\r\n\r\n    if (path in this.sounds) {\r\n      return this.sounds[path];\r\n    }\r\n\r\n    throw new Error(\"The sound located at \" + path + \" is not loaded\");\r\n  },\r\n\r\n  setListenerPosition: function(position) {\r\n    this.context.listener.setPosition(position.x, position.y, position.z);\r\n  },\r\n\r\n  setListenerOrientation: function(orientation, up) {\r\n    this.context.listener.setOrientation(orientation.x, orientation.y, orientation.z, up.x, up.y, up.z);\r\n  }\r\n});\r\n\r\n","PointerLockControls = Class({\r\n  constructor: function(options) {\r\n    this.camera = options.camera;\r\n    this.camera.rotation.set(0, 0, 0);\r\n\r\n    this.pitchObject = new THREE.Object3D();\r\n    this.pitchObject.add(this.camera);\r\n\r\n    this.yawObject = new THREE.Object3D();\r\n    this.yawObject.position.y = 10;\r\n    this.yawObject.add(this.pitchObject);\r\n\r\n    this.enabled = false;\r\n\r\n    document.addEventListener('mousemove', this.onMouseMove.bind(this), false);\r\n  },\r\n\r\n  onMouseMove: function(event) {\r\n    if (this.enabled === false) {\r\n      return;\r\n    }\r\n\r\n    var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\r\n    var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\r\n\r\n    this.yawObject.rotation.y -= movementX * 0.002;\r\n    this.pitchObject.rotation.x -= movementY * 0.002;\r\n\r\n    this.pitchObject.rotation.x = Math.max(-PointerLockControls.PI_2, Math.min(PointerLockControls.PI_2, this.pitchObject.rotation.x));\r\n  },\r\n\r\n  getObject: function() {\r\n    return this.yawObject;\r\n  },\r\n\r\n  getDirection: function() {\r\n    // assumes the camera itself is not rotated\r\n    var direction = new THREE.Vector3(0, 0, -1);\r\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n\r\n    return function(v) {\r\n      rotation.set(this.pitchObject.rotation.x, this.yawObject.rotation.y, 0);\r\n\r\n      v.copy(direction).applyEuler(rotation);\r\n\r\n      return v;\r\n    };\r\n  }()\r\n\r\n}, {\r\n  statics: {\r\n    PI_2: Math.PI / 2\r\n  }\r\n});\r\n\r\n","var EntityManager = require('tiny-ecs').EntityManager;\r\nvar b3 = require('./../b3core.0.1.0.js');\r\nvar Utils = require('./Utils.js');\r\nvar C = require('./Components.js');\r\nvar PickupMethods = require('./PickupMethods.js');\r\n\r\n/*\r\n * Helper singleton class for quickly constructing entities. Most functions take in a key-value list of options.\r\n * Each function adds necessary components to the relevant entity and sets up said components properties.\r\n */\r\nEntityFactory = Class({\r\n  constructor: function() {\r\n    this.entities = new EntityManager();\r\n  },\r\n\r\n  /*\r\n   * Creates the player entity. There should only ever be one of these at any given time.\r\n   * Requires a position, scene, and pointerlock objects to be passed in.\r\n   * Optional parameters include starting max health.\r\n   */\r\n  makePlayer: function(options) {\r\n    var player = this.entities.createEntity();\r\n\r\n    player.addTag(\"player\");\r\n\r\n    player.addComponent(C.Identifier);\r\n    player.addComponent(C.Position);\r\n    player.addComponent(C.Velocity);\r\n    player.addComponent(C.Jump);\r\n    player.addComponent(C.Drawable);\r\n    player.addComponent(C.CameraFollow);\r\n    player.addComponent(C.ShootDelay);\r\n    player.addComponent(C.Health);\r\n    player.addComponent(C.Gun);\r\n    player.addComponent(C.Ammo);\r\n    player.addComponent(C.Shield);\r\n\r\n    player.identifier.type = Globals.ENTITY_TYPES.player;\r\n\r\n    var model = ResourceManager.instance.getModel('models/character.json').clone();\r\n\r\n    player.drawable.scene = options.scene;\r\n\r\n    player.drawable.mesh = new Physijs.CapsuleMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(new THREE.MeshBasicMaterial({\r\n        color: 0xffff00\r\n      }), 0.9, 0.01), EntityFactory.MASS.player);\r\n    player.drawable.mesh.entity = player;\r\n\r\n    player.drawable.mesh.position.copy(options.position);\r\n    //player.drawable.mesh.rotation.copy(options.rotation);\r\n\r\n    player.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.player;\r\n    player.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet |\r\n      EntityFactory.COLLISION_TYPES.pickup);\r\n\r\n    player.drawable.scene.add(player.drawable.mesh);\r\n\r\n    player.drawable.mesh.setDamping(0.99, 0);\r\n    player.drawable.mesh.setAngularFactor(new THREE.Vector3(0, 0, 0));\r\n\r\n    player.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (contact_normal.y < 0 && other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n        player.jump.canJump = true;\r\n      }\r\n\r\n      if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy && player.hasComponent(C.Hurt) === false) {\r\n        if (other_object.entity.hasComponent(C.Shield) && player.shield.enabled && other_object.player.currentValue >= 1) {\r\n          Utils.damageShield(player, 1);\r\n        }\r\n        else {\r\n          player.addComponent(C.Hurt);\r\n          player.hurt.originalColor = player.drawable.mesh.material.color;\r\n\r\n          player.health.hp--;\r\n          player.health.changed = true;\r\n        }\r\n      }\r\n      else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && player.shield.enabled === false) {\r\n        var hitSounds = [\r\n          \"sfx/hurt1.mp3\",\r\n          \"sfx/hurt2.mp3\",\r\n          \"sfx/hurt3.mp3\"\r\n        ];\r\n\r\n        var soundPos = new THREE.Vector3().setFromMatrixPosition(player.drawable.mesh.matrixWorld);\r\n        var soundVel = new THREE.Vector3(player.velocity.x, player.velocity.y, player.velocity.z);\r\n        var soundDir = new THREE.Vector3();\r\n        player.cameraFollow.controls.getDirection(soundDir);\r\n        var soundIndex = Math.floor(Utils.randomRange(0, hitSounds.length));\r\n\r\n        var sound = Globals.instance.sound.getSound(hitSounds[soundIndex]);\r\n        sound.setPosition(soundPos);\r\n        sound.setVelocity(soundVel);\r\n        sound.setOrientation(soundDir);\r\n        sound.play();\r\n      }\r\n    });\r\n\r\n    player.health.hp = player.health.maxHP = options.hp || 20;\r\n\r\n    player.position.x = options.position.x;\r\n    player.position.y = options.position.y;\r\n    player.position.z = options.position.z;\r\n\r\n    player.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(player.drawable.mesh.matrix);\r\n\r\n    player.cameraFollow.controls = options.controls;\r\n    player.cameraFollow.object = options.controlsObject;\r\n    player.cameraFollow.offset = options.cameraOffset;\r\n\r\n    player.shootDelay.delayTheshold = 1.5;\r\n\r\n    var gun = this.makeGun({\r\n      parent: player.drawable.mesh,\r\n      cameraControls: options.controls,\r\n      offset: options.gunOffset\r\n    });\r\n\r\n    player.gun.entity = gun;\r\n    player.gun.mesh = gun.drawable.mesh;\r\n    player.gun.type = Game.GUN_TYPES.potatoCannon;\r\n\r\n    player.ammo.currentAmmo[Game.GUN_TYPES.potatoCannon] = 54;\r\n    player.ammo.currentAmmo[Game.GUN_TYPES.scatterFries] = 76;\r\n\r\n    player.ammo.maxAmmo[Game.GUN_TYPES.potatoCannon] = 54;\r\n    player.ammo.maxAmmo[Game.GUN_TYPES.scatterFries] = 76;\r\n\r\n    Globals.instance.ammoElement.innerHTML = (player.ammo.currentAmmo[player.gun.type] + ' / ' + player.ammo.maxAmmo[player.gun.type]);\r\n    Globals.instance.weaponNameElement.innerHTML = Game.GUN_NAMES[player.gun.type];\r\n    Globals.instance.weaponIconElement.src = Game.GUN_ICONS[player.gun.type];\r\n\r\n    return player;\r\n  },\r\n\r\n  /*\r\n   * Creates an enemy entity. The enemy's AI is also setup in this function.\r\n   * Requires a position, scene, a bullet speed/velocity, an AI target, a maxmimum shooting distance, and a maximum following leash distance.\r\n   * Optional parameters include starting max health and the enemy's initial rotation.\r\n   */\r\n  makeEnemy: function(options) {\r\n    var enemy = this.entities.createEntity();\r\n\r\n    enemy.addTag(\"enemy\");\r\n\r\n    enemy.addComponent(C.Identifier);\r\n    enemy.addComponent(C.Position);\r\n    enemy.addComponent(C.Velocity);\r\n    enemy.addComponent(C.Drawable);\r\n    enemy.addComponent(C.Health);\r\n    enemy.addComponent(C.ShootDelay);\r\n    enemy.addComponent(C.DropsPickup);\r\n    enemy.addComponent(C.AI);\r\n\r\n    enemy.identifier.type = Globals.ENTITY_TYPES.enemy;\r\n\r\n    var model = ResourceManager.instance.getModel('models/character.json').clone();\r\n\r\n    enemy.drawable.scene = options.scene;\r\n\r\n    var color = options.color || 0x0000ff;\r\n\r\n    enemy.drawable.mesh = new Physijs.CapsuleMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(new THREE.MeshPhongMaterial({\r\n        color: color\r\n      }), 0.9, 0.1), EntityFactory.MASS.enemy);\r\n    enemy.drawable.mesh.entity = enemy;\r\n\r\n    enemy.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemy;\r\n    enemy.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n    enemy.drawable.mesh.position.copy(options.position);\r\n    if (options.rotation) {\r\n      enemy.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n\r\n    enemy.drawable.scene.add(enemy.drawable.mesh);\r\n\r\n    enemy.drawable.mesh.setDamping(0.99, 0);\r\n    enemy.drawable.mesh.setAngularFactor(new THREE.Vector3(0, 1, 0));\r\n\r\n    enemy.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'player' && enemy.hasComponent(C.Hurt) === false) {\r\n        var hitSounds = [\r\n          \"sfx/hurt1.mp3\",\r\n          \"sfx/hurt2.mp3\",\r\n          \"sfx/hurt3.mp3\"\r\n        ];\r\n\r\n        var soundPos = new THREE.Vector3().setFromMatrixPosition(enemy.drawable.mesh.matrixWorld);\r\n        var soundVel = new THREE.Vector3(enemy.velocity.x, enemy.velocity.y, enemy.velocity.z);\r\n        var soundIndex = Math.floor(Utils.randomRange(0, hitSounds.length));\r\n\r\n        var direction = new THREE.Vector3(0, 0, -1);\r\n        var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n        rotation.set(enemy.drawable.mesh.rotation.x, enemy.drawable.mesh.rotation.y, 0);\r\n\r\n        var forward = new THREE.Vector3();\r\n        forward.copy(direction).applyEuler(rotation);\r\n\r\n        var sound = Globals.instance.sound.getSound(hitSounds[soundIndex]);\r\n        sound.setPosition(soundPos);\r\n        sound.setVelocity(soundVel);\r\n        sound.setOrientation(forward);\r\n        sound.play();\r\n      }\r\n    });\r\n\r\n    enemy.position.x = options.position.x;\r\n    enemy.position.y = options.position.y;\r\n    enemy.position.z = options.position.z;\r\n\r\n    enemy.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(enemy.drawable.mesh.matrix);\r\n\r\n    enemy.health.hp = enemy.health.maxHP = options.hp || 15;\r\n    enemy.health.healthBar = new THREE.Mesh(\r\n      new THREE.BoxGeometry(14, 1.5, 0.5),\r\n      new THREE.MeshBasicMaterial({\r\n        color: 0x00ff00\r\n      }));\r\n    enemy.health.healthBar.position.set(0, 25, 0);\r\n    enemy.drawable.mesh.add(enemy.health.healthBar);\r\n\r\n    enemy.shootDelay.delayTheshold = 1.5;\r\n\r\n    enemy.dropsPickup.dropTypes = [\"Health\", \"Ammo\"];\r\n    enemy.dropsPickup.dropChance = 0.6;\r\n\r\n    options.bulletSpeed = THREE.Math.clamp(options.bulletSpeed, EntityFactory.MIN_BULLET_SPEED.enemy, EntityFactory.MAX_BULLET_SPEED.enemy);\r\n    options.shootDistance = Math.max(options.shootDistance, options.leashDistance);\r\n\r\n    var FaceNode = b3.Class(b3.Action);\r\n    FaceNode.prototype.name = 'FaceNode';\r\n    FaceNode.prototype.parameters = {\r\n      'facing': null\r\n    };\r\n\r\n    FaceNode.prototype.__Action_initialize = FaceNode.prototype.initialize;\r\n    FaceNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.facing = settings.facing;\r\n    };\r\n\r\n    FaceNode.prototype.tick = function(tick) {\r\n      if (this.facing._manager === null || this.facing._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      // http://forum.unity3d.com/threads/making-an-object-rotate-to-face-another.1211/\r\n      // http://answers.unity3d.com/questions/503934/chow-to-check-if-an-object-is-facing-another.html\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.facing.drawable.mesh.position.clone();\r\n\r\n      var posDif = parentPos.clone();\r\n      posDif.sub(followingPos);\r\n\r\n      var forward = new THREE.Vector3(0, 0, -1);\r\n      forward.applyMatrix4(tick.target.velocity.rotationMatrix);\r\n\r\n      var angle = forward.angleTo(posDif) * 180 / Math.PI;\r\n\r\n      if (Math.abs(angle) <= 10) {\r\n        return b3.SUCCESS;\r\n      }\r\n\r\n      var lookAtMatrix = new THREE.Matrix4();\r\n      lookAtMatrix.lookAt(followingPos, parentPos, new THREE.Vector3(0, 1, 0));\r\n\r\n      var parentRotation = new THREE.Quaternion().setFromEuler(tick.target.drawable.mesh.rotation);\r\n      var targetRotation = new THREE.Quaternion().setFromRotationMatrix(lookAtMatrix);\r\n\r\n      var str = Math.min(Globals.instance.dt, 0.5);\r\n\r\n      parentRotation.slerp(targetRotation, str);\r\n\r\n      tick.target.drawable.mesh.rotation.setFromQuaternion(parentRotation);\r\n      tick.target.drawable.mesh.__dirtyRotation = true;\r\n\r\n      return b3.RUNNING;\r\n    };\r\n\r\n    var RandomChildNode = b3.Class(b3.Composite);\r\n    RandomChildNode.prototype.name = 'RandomChildNode';\r\n\r\n    RandomChildNode.prototype.__Composite_initialize = RandomChildNode.prototype.initialize;\r\n    RandomChildNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Composite_initialize(settings);\r\n\r\n      this.chance = settings.chance;\r\n    };\r\n\r\n    RandomChildNode.prototype.tick = function(tick) {\r\n      //var chance = 1 / this.children.length;\r\n\r\n      for (var i = 0; i < this.children.length; i++) {\r\n        if (Math.random() <= this.chance[i]) {\r\n          var status = this.children[i]._execute(tick);\r\n\r\n          if (status !== b3.SUCCESS) {\r\n            return status;\r\n          }\r\n        }\r\n      }\r\n\r\n      return b3.SUCCESS;\r\n    };\r\n\r\n    var FollowNode = b3.Class(b3.Action);\r\n    FollowNode.prototype.name = 'FollowNode';\r\n    FollowNode.prototype.parameters = {\r\n      'following': null\r\n    };\r\n\r\n    FollowNode.prototype.__Action_initialize = FollowNode.prototype.initialize;\r\n    FollowNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.following = settings.following;\r\n      this.leashDistance = settings.leashDistance;\r\n    };\r\n\r\n    FollowNode.prototype.tick = function(tick) {\r\n      if (this.following._manager === null || this.following._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.following.drawable.mesh.position.clone();\r\n\r\n      var distance = parentPos.distanceTo(followingPos);\r\n\r\n      if (distance < this.leashDistance) {\r\n        return b3.SUCCESS;\r\n      }\r\n\r\n      var difference = new THREE.Vector3();\r\n      difference.subVectors(followingPos, parentPos);\r\n\r\n      var normal = difference.normalize();\r\n      var velocity = new THREE.Vector3(tick.target.velocity.x, tick.target.velocity.y, tick.target.velocity.z);\r\n      var dv = new THREE.Vector3(EntityFactory.MOVE_SPEED.enemy * normal.x, 0, EntityFactory.MOVE_SPEED.enemy * normal.z);\r\n\r\n      velocity.add(dv);\r\n\r\n      tick.target.velocity.x = velocity.x;\r\n      tick.target.velocity.y = velocity.y;\r\n      tick.target.velocity.z = velocity.z;\r\n\r\n      return b3.RUNNING;\r\n    };\r\n\r\n    var ShootNode = b3.Class(b3.Action);\r\n    ShootNode.prototype.name = 'ShootNode';\r\n    ShootNode.prototype.parameters = {\r\n      'shootingAt': null\r\n    };\r\n\r\n    ShootNode.prototype.__Action_initialize = ShootNode.prototype.initialize;\r\n    ShootNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.shootingAt = settings.shootingAt;\r\n      this.bulletSpeed = settings.bulletSpeed;\r\n      this.shootDistance = settings.shootDistance;\r\n    };\r\n\r\n    ShootNode.prototype.tick = function(tick) {\r\n      if (this.shootingAt._manager === null || this.shootingAt._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n      else if (tick.target.shootDelay.canShoot === false) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.shootingAt.drawable.mesh.position.clone();\r\n\r\n      var spawnLocation = parentPos.clone();\r\n      var spawnOffset = new THREE.Vector3(0, 10, 20);\r\n      spawnOffset.applyMatrix4(tick.target.velocity.rotationMatrix);\r\n      spawnLocation.add(spawnOffset);\r\n\r\n      // the number of frames to \"look ahead\"\r\n      // this is used to lead the shot, making it easier to hit a moving target (in this case, the player)\r\n      var futureFrames = (EntityFactory.MAX_BULLET_SPEED.enemy - this.bulletSpeed) / 3.5;\r\n      futureFrames = THREE.Math.clamp(futureFrames, 2, 15);\r\n\r\n      var followingVel = new THREE.Vector3(this.shootingAt.velocity.x, this.shootingAt.velocity.y, this.shootingAt.velocity.z);\r\n      followingVel.multiplyScalar(Globals.instance.dt * futureFrames);\r\n      var predictedPos = followingPos.clone();\r\n      predictedPos.add(followingVel);\r\n\r\n      var posDif = spawnLocation.clone();\r\n      posDif.sub(predictedPos);\r\n\r\n      var distance = posDif.length();\r\n\r\n      if (distance > this.shootDistance) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      var lookAtMatrix = new THREE.Matrix4();\r\n      lookAtMatrix.lookAt(predictedPos, spawnLocation, new THREE.Vector3(0, 1, 0));\r\n\r\n      var forward = new THREE.Vector3(0, 0, -1);\r\n      forward.applyMatrix4(lookAtMatrix);\r\n\r\n      var velocity = -this.bulletSpeed;\r\n\r\n      // I have no clue why this works, but it seems to generate an arc fairly consistently\r\n      var velOffset = 1 - (velocity / 100);\r\n      forward.y -= distance / ((velocity - (velocity * velOffset * EntityFactory.MASS.bullet)) * velocity);\r\n      forward.normalize();\r\n\r\n      EntityFactory.instance.makePotato({\r\n        scene: tick.target.drawable.scene,\r\n        position: spawnLocation,\r\n        rotation: tick.target.drawable.mesh.rotation.clone(),\r\n        direction: forward,\r\n        velocity: velocity,\r\n        owner: 'enemy'\r\n      });\r\n\r\n      tick.target.shootDelay.canShoot = false;\r\n\r\n      return b3.SUCCESS;\r\n    };\r\n\r\n    enemy.ai.tree = new b3.BehaviorTree();\r\n    enemy.ai.tree.root = new b3.Sequence({\r\n      children: [\r\n        new b3.Sequence({\r\n          children: [\r\n            new FaceNode({\r\n              facing: options.aiTarget\r\n            }),\r\n            new RandomChildNode({\r\n              children: [\r\n                new FollowNode({\r\n                  following: options.aiTarget,\r\n                  leashDistance: options.leashDistance\r\n                }),\r\n                new ShootNode({\r\n                  shootingAt: options.aiTarget,\r\n                  bulletSpeed: options.bulletSpeed,\r\n                  shootDistance: options.shootDistance\r\n                })\r\n              ],\r\n              chance: [\r\n                0.9,\r\n                0.1\r\n              ]\r\n            })\r\n          ]\r\n        })\r\n      ]\r\n    });\r\n\r\n    enemy.ai.target = enemy;\r\n    enemy.ai.blackboard = new b3.Blackboard();\r\n\r\n    return enemy;\r\n  },\r\n\r\n  /*\r\n   * Creates a gun entity. Gun's are meant to be \"attached\" to an existing entity.\r\n   * Requires a position and a parent.\r\n   * Optional parameters include a pointerlock controls object to make the gun follow the camera's pitch.\r\n   */\r\n  makeGun: function(options) {\r\n    var gun = this.entities.createEntity();\r\n\r\n    gun.addComponent(C.Identifier);\r\n    gun.addComponent(C.Position);\r\n    gun.addComponent(C.Drawable);\r\n\r\n    gun.identifier.type = Globals.ENTITY_TYPES.gun;\r\n\r\n    var model = ResourceManager.instance.getModel('models/potatoCannon.json').clone();\r\n\r\n    gun.drawable.scene = options.parent;\r\n    gun.drawable.mesh = new THREE.Mesh(\r\n      model.geometry,\r\n      model.material);\r\n\r\n    gun.drawable.mesh.position.copy(options.offset);\r\n\r\n    gun.drawable.scene.add(gun.drawable.mesh);\r\n\r\n    if (options.cameraControls) {\r\n      gun.addComponent(C.CameraPitch);\r\n\r\n      gun.cameraPitch.controls = options.cameraControls;\r\n    }\r\n\r\n    return gun;\r\n  },\r\n\r\n  /*\r\n   * Creates a potato entity. Potatoes are a form of bullet.\r\n   * Requires an owner (generally enemy or player), a position, a scene, and a velocity.\r\n   * Optional parameters include the potato's rotation and scale.\r\n   */\r\n  makePotato: function(options) {\r\n    var potato = this.entities.createEntity();\r\n\r\n    potato.addTag(\"bullet\");\r\n    potato.addTag(\"potato\");\r\n\r\n    potato.addComponent(C.Identifier);\r\n    potato.addComponent(C.Position);\r\n    potato.addComponent(C.Velocity);\r\n    potato.addComponent(C.Drawable);\r\n    potato.addComponent(C.Bullet);\r\n    potato.addComponent(C.Expirable);\r\n    potato.addComponent(C.OneTimeHit);\r\n    potato.addComponent(C.Steaming);\r\n\r\n    potato.identifier.type = Globals.ENTITY_TYPES.bullet;\r\n    potato.bullet.owner = options.owner;\r\n\r\n    potato.velocity.doMove = false;\r\n\r\n    var model = ResourceManager.instance.getModel('models/potato.json').clone();\r\n\r\n    potato.drawable.scene = options.scene;\r\n\r\n    potato.drawable.mesh = new Physijs.CapsuleMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(model.material, 0.7, 0.01),\r\n      0.3);\r\n    potato.drawable.mesh.entity = potato;\r\n\r\n    // potatos are \"hot\" when created, so tint them red\r\n    potato.drawable.mesh.material.materials.forEach(function(mat) {\r\n      mat.color.setHex(0xE34D4D);\r\n    });\r\n\r\n    if (options.owner === 'player') {\r\n      potato.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.playerBullet;\r\n    }\r\n    else {\r\n      potato.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemyBullet;\r\n    }\r\n\r\n    potato.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n    potato.drawable.mesh.position.copy(options.position);\r\n    if (options.rotation) {\r\n      potato.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n    if (options.scale) {\r\n      potato.drawable.mesh.scale.copy(options.scale);\r\n    }\r\n\r\n    potato.drawable.scene.add(potato.drawable.mesh);\r\n\r\n    potato.drawable.mesh.setDamping(0.1, 0);\r\n\r\n    potato.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (potato.bullet.isHot === false) {\r\n        return;\r\n      }\r\n\r\n      var hitPlayer = potato.bullet.owner === 'enemy' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.player;\r\n      var hitEnemy = potato.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy;\r\n\r\n      if ((hitPlayer || hitEnemy) && potato.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n        if (other_object.entity.hasComponent(C.Shield) && other_object.entity.shield.enabled && other_object.entity.shield.currentValue >= EntityFactory.BULLET_DAMAGE.potato) {\r\n          Utils.damageShield(other_object.entity, EntityFactory.BULLET_DAMAGE.potato);\r\n        }\r\n        else {\r\n          other_object.entity.addComponent(C.Hurt);\r\n          other_object.entity.hurt.originalColor = other_object.material.color.clone();\r\n\r\n          other_object.entity.health.hp -= EntityFactory.BULLET_DAMAGE.potato;\r\n          other_object.entity.health.changed = true;\r\n\r\n          potato.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n      }\r\n      else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n        potato.bullet.touchedGround = true;\r\n      }\r\n      else if (potato.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && potato.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n        Globals.instance.score += 5;\r\n\r\n        Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n        potato.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n      }\r\n\r\n      var soundPos = new THREE.Vector3().setFromMatrixPosition(potato.drawable.mesh.matrixWorld);\r\n      var soundVel = new THREE.Vector3(potato.velocity.x * Globals.instance.dt, potato.velocity.y * Globals.instance.dt, potato.velocity.z * Globals.instance.dt);\r\n      var soundForward = new THREE.Vector3(0, 0, 1);\r\n      soundForward.applyProjection(potato.drawable.mesh.matrixWorld);\r\n      soundForward.normalize();\r\n\r\n      var sound = Globals.instance.sound.getSound('sfx/hitSplat.wav');\r\n      sound.setPosition(soundPos);\r\n      sound.setVelocity(vel);\r\n      sound.setOrientation(soundForward);\r\n      sound.play();\r\n\r\n      potato.bullet.isHot = false;\r\n\r\n      // the potato is now \"cold,\" so tint it blue\r\n      potato.drawable.mesh.material.materials.forEach(function(mat) {\r\n        mat.color.setHex(0x45B7DE);\r\n      });\r\n    }.bind(this));\r\n\r\n    potato.position.x = options.position.x;\r\n    potato.position.y = options.position.y;\r\n    potato.position.z = options.position.z;\r\n\r\n    var vel = new THREE.Vector3(options.velocity, options.velocity, options.velocity);\r\n    vel.multiply(options.direction);\r\n    potato.drawable.mesh.applyCentralImpulse(vel);\r\n\r\n    potato.expirable.maxAge = 6;\r\n\r\n    potato.steaming.parent = potato.drawable.mesh;\r\n    potato.steaming.particles = new THREE.Geometry();\r\n    for (var i = 0; i < 25; i++) {\r\n      var particle = new THREE.Vector3(\r\n        Math.random() * Utils.randomRange(-2, 2),\r\n        Math.random() * 20,\r\n        Math.random() * Utils.randomRange(-2, 2));\r\n      potato.steaming.particles.vertices.push(particle);\r\n    }\r\n\r\n    var smokeTexture = ResourceManager.instance.getTexture('gfx/smoketex.jpg');\r\n    var smokeMaterial = new THREE.PointCloudMaterial({\r\n      map: smokeTexture,\r\n      transparent: true,\r\n      depthWrite: false,\r\n      blending: THREE.AdditiveBlending,\r\n      size: 2,\r\n      color: 0x111111\r\n    });\r\n\r\n    potato.steaming.system = new THREE.PointCloud(potato.steaming.particles, smokeMaterial);\r\n    potato.steaming.system.sortParticles = true;\r\n\r\n    potato.steaming.container = new THREE.Gyroscope();\r\n    potato.steaming.container.add(potato.steaming.system);\r\n    potato.drawable.mesh.add(potato.steaming.container);\r\n\r\n    return potato;\r\n  },\r\n\r\n  /*\r\n   * Creates a fry entity. Fries are a form of bullet.\r\n   * Requires an owner (generally enemy or player), a position, a scene, and a velocity.\r\n   * Optional parameters include the fry's rotation and scale.\r\n   */\r\n  makeFry: function(options) {\r\n    var fry = this.entities.createEntity();\r\n\r\n    fry.addTag(\"bullet\");\r\n    fry.addTag(\"fry\");\r\n\r\n    fry.addComponent(C.Identifier);\r\n    fry.addComponent(C.Position);\r\n    fry.addComponent(C.Drawable);\r\n    fry.addComponent(C.Bullet);\r\n    fry.addComponent(C.Expirable);\r\n    fry.addComponent(C.OneTimeHit);\r\n    fry.addComponent(C.Steaming);\r\n\r\n    fry.identifier.type = Globals.ENTITY_TYPES.bullet;\r\n    fry.bullet.owner = options.owner;\r\n\r\n    var model = ResourceManager.instance.getModel('models/fry.json').clone();\r\n\r\n    fry.drawable.scene = options.scene;\r\n\r\n    fry.drawable.mesh = new Physijs.BoxMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(model.material, 0.7, 0.01),\r\n      0.002);\r\n    fry.drawable.mesh.entity = fry;\r\n\r\n    // fries are \"hot\" when created, so tint them red\r\n    fry.drawable.mesh.material.materials.forEach(function(mat) {\r\n      mat.color.setHex(0xE34D4D);\r\n    });\r\n\r\n    if (options.owner === 'player') {\r\n      fry.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.playerBullet;\r\n    }\r\n    else {\r\n      fry.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemyBullet;\r\n    }\r\n\r\n    fry.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n    fry.drawable.mesh.position.copy(options.position);\r\n    if (options.rotation) {\r\n      fry.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n    if (options.scale) {\r\n      fry.drawable.mesh.scale.copy(options.scale);\r\n    }\r\n\r\n    fry.drawable.scene.add(fry.drawable.mesh);\r\n\r\n    fry.drawable.mesh.setDamping(0.1, 0);\r\n\r\n    fry.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (fry.bullet.isHot === false) {\r\n        return;\r\n      }\r\n\r\n      var hitPlayer = fry.bullet.owner === 'enemy' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.player;\r\n      var hitEnemy = fry.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy;\r\n\r\n      if ((hitPlayer || hitEnemy) && fry.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n        other_object.entity.addComponent(C.Hurt);\r\n        other_object.entity.hurt.originalColor = other_object.material.color.clone();\r\n\r\n        other_object.entity.health.hp -= EntityFactory.BULLET_DAMAGE.fry;\r\n        other_object.entity.health.changed = true;\r\n\r\n        fry.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n      }\r\n      else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n        fry.bullet.touchedGround = true;\r\n      }\r\n      else if (fry.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && fry.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n        Globals.instance.score += 5;\r\n\r\n        Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n        fry.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n      }\r\n\r\n      fry.bullet.isHot = other_object.entity.hasTag(\"fry\");\r\n\r\n      if (fry.bullet.isHot === false) {\r\n        // the fry is now \"cold,\" so tint it blue\r\n        fry.drawable.mesh.material.materials.forEach(function(mat) {\r\n          mat.color.setHex(0x45B7DE);\r\n        });\r\n      }\r\n    }.bind(this));\r\n\r\n    fry.position.x = options.position.x;\r\n    fry.position.y = options.position.y;\r\n    fry.position.z = options.position.z;\r\n\r\n    var vel = new THREE.Vector3(options.velocity, options.velocity, options.velocity);\r\n    vel.multiply(options.direction);\r\n    fry.drawable.mesh.applyCentralImpulse(vel);\r\n\r\n    fry.expirable.maxAge = 6;\r\n\r\n    fry.steaming.parent = fry.drawable.mesh;\r\n    fry.steaming.particles = new THREE.Geometry();\r\n    for (var i = 0; i < 25; i++) {\r\n      var particle = new THREE.Vector3(\r\n        Math.random() * Utils.randomRange(-2, 2),\r\n        Math.random() * 20,\r\n        Math.random() * Utils.randomRange(-2, 2));\r\n      fry.steaming.particles.vertices.push(particle);\r\n    }\r\n\r\n    var smokeTexture = ResourceManager.instance.getTexture('gfx/smoketex.jpg');\r\n    var smokeMaterial = new THREE.PointCloudMaterial({\r\n      map: smokeTexture,\r\n      transparent: true,\r\n      depthWrite: false,\r\n      blending: THREE.AdditiveBlending,\r\n      size: 2,\r\n      color: 0x111111\r\n    });\r\n\r\n    fry.steaming.system = new THREE.PointCloud(fry.steaming.particles, smokeMaterial);\r\n    fry.steaming.system.sortParticles = true;\r\n\r\n    fry.steaming.container = new THREE.Gyroscope();\r\n    fry.steaming.container.add(fry.steaming.system);\r\n    fry.drawable.mesh.add(fry.steaming.container);\r\n\r\n    return fry;\r\n  },\r\n\r\n  /*\r\n   * Creates a heatlh pickup entity.\r\n   * Requires a scene and a position.\r\n   */\r\n  makeHealthPickup: function(options) {\r\n    var pickup = this.entities.createEntity();\r\n\r\n    pickup.addTag(\"pickup\");\r\n\r\n    pickup.addComponent(C.Identifier);\r\n    pickup.addComponent(C.Position);\r\n    pickup.addComponent(C.Drawable);\r\n    pickup.addComponent(C.Expirable);\r\n    pickup.addComponent(C.Pickup);\r\n\r\n    pickup.identifier.type = Globals.ENTITY_TYPES.pickup;\r\n\r\n    var model = ResourceManager.instance.getModel('models/pickupBox.json').clone();\r\n\r\n    pickup.drawable.scene = options.scene;\r\n\r\n    pickup.drawable.mesh = new Physijs.BoxMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(model.material, 0.7, 0.01),\r\n      1.2);\r\n    pickup.drawable.mesh.entity = pickup;\r\n\r\n    pickup.drawable.mesh.material.materials.forEach(function(mat) {\r\n      mat.color.setHex(0xdd1100);\r\n    });\r\n\r\n    pickup.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.pickup;\r\n    pickup.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.pickup);\r\n\r\n    pickup.drawable.mesh.position.copy(options.position);\r\n    if (options.rotation) {\r\n      pickup.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n    if (options.scale) {\r\n      pickup.drawable.mesh.scale.copy(options.scale);\r\n    }\r\n\r\n    pickup.drawable.scene.add(pickup.drawable.mesh);\r\n\r\n    pickup.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.player) {\r\n        pickup.pickup.parameters.target = other_object.entity;\r\n\r\n        pickup.pickup.method(pickup);\r\n      }\r\n    }.bind(this));\r\n\r\n    pickup.expirable.maxAge = 15;\r\n\r\n    pickup.pickup.method = PickupMethods.heal;\r\n    pickup.pickup.parameters = {\r\n      healAmount: 5\r\n    };\r\n  },\r\n\r\n  /*\r\n   * Creates an ammo pickup entity.\r\n   * Requires a scene and a position.\r\n   */\r\n  makeAmmoPickup: function(options) {\r\n    var pickup = this.entities.createEntity();\r\n\r\n    pickup.addTag(\"pickup\");\r\n\r\n    pickup.addComponent(C.Identifier);\r\n    pickup.addComponent(C.Position);\r\n    pickup.addComponent(C.Drawable);\r\n    pickup.addComponent(C.Expirable);\r\n    pickup.addComponent(C.Pickup);\r\n\r\n    pickup.identifier.type = Globals.ENTITY_TYPES.pickup;\r\n\r\n    var model = ResourceManager.instance.getModel('models/pickupBox.json').clone();\r\n\r\n    pickup.drawable.scene = options.scene;\r\n\r\n    pickup.drawable.mesh = new Physijs.BoxMesh(\r\n      model.geometry,\r\n      Physijs.createMaterial(model.material, 0.7, 0.01),\r\n      1.2);\r\n    pickup.drawable.mesh.entity = pickup;\r\n\r\n    pickup.drawable.mesh.material.materials.forEach(function(mat) {\r\n      mat.color.setHex(0xddcc00);\r\n    });\r\n\r\n    pickup.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.pickup;\r\n    pickup.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.pickup);\r\n\r\n    pickup.drawable.mesh.position.copy(options.position);\r\n    if (options.rotation) {\r\n      pickup.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n    if (options.scale) {\r\n      pickup.drawable.mesh.scale.copy(options.scale);\r\n    }\r\n\r\n    pickup.drawable.scene.add(pickup.drawable.mesh);\r\n\r\n    pickup.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.player) {\r\n        pickup.pickup.parameters.target = other_object.entity;\r\n        pickup.pickup.parameters.gun = other_object.entity.gun.type;\r\n\r\n        pickup.pickup.method(pickup);\r\n\r\n        Globals.instance.ammoElement.innerHTML = (other_object.entity.ammo.currentAmmo[other_object.entity.gun.type] + ' / ' + other_object.entity.ammo.maxAmmo[other_object.entity.gun.type]);\r\n      }\r\n    }.bind(this));\r\n\r\n    pickup.expirable.maxAge = 15;\r\n\r\n    pickup.pickup.method = PickupMethods.increaseAmmo;\r\n    pickup.pickup.parameters = {\r\n      ammoAmount: 10\r\n    };\r\n  },\r\n\r\n  /*\r\n   * Creates a ground pickup entity. There generally will only be one of these in the scene.\r\n   * Requires a scene, a position, a width, and a height.\r\n   */\r\n  makeGround: function(options) {\r\n    var ground = this.entities.createEntity();\r\n\r\n    ground.addComponent(C.Identifier);\r\n    ground.addComponent(C.Position);\r\n    ground.addComponent(C.Drawable);\r\n\r\n    ground.identifier.type = Globals.ENTITY_TYPES.ground;\r\n\r\n    ground.drawable.scene = options.scene;\r\n\r\n    var mainTex = ResourceManager.instance.getTexture('gfx/brick-floor-tileable_COLOR.jpg');\r\n    mainTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n    var diffuseTex = ResourceManager.instance.getTexture('gfx/brick-floor-tileable_DISP.jpg');\r\n    diffuseTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n    var specularTex = ResourceManager.instance.getTexture('gfx/brick-floor-tileable_SPEC.jpg');\r\n    specularTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n\r\n    ground.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(options.width, 1, options.height),\r\n      new THREE.MeshPhongMaterial({\r\n        map: mainTex,\r\n        displacementMap: diffuseTex,\r\n        specularMap: specularTex\r\n      }), 0);\r\n    ground.drawable.mesh.entity = ground;\r\n\r\n    ground.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.obstacle;\r\n    ground.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet |\r\n      EntityFactory.COLLISION_TYPES.pickup);\r\n\r\n    ground.drawable.scene.add(ground.drawable.mesh);\r\n  },\r\n\r\n  /*\r\n   * Creates a sky wall entity. These are used to encase the scene in a sky.\r\n   * Requires a scene, a position, a width, and a height.\r\n   */\r\n  makeSkyWall: function(options) {\r\n    var skyWall = this.entities.createEntity();\r\n\r\n    skyWall.addComponent(C.Identifier);\r\n    skyWall.addComponent(C.Position);\r\n    skyWall.addComponent(C.Drawable);\r\n\r\n    skyWall.identifier.type = Globals.ENTITY_TYPES.obstacle;\r\n\r\n    skyWall.drawable.scene = options.scene;\r\n\r\n    var mainTex = ResourceManager.instance.getTexture('gfx/skyTex2.jpg');\r\n    mainTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n    mainTex.minFilter = THREE.LinearMipMapLinearFilter;\r\n    mainTex.magFilter = THREE.LinearFilter;\r\n\r\n    skyWall.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(options.width, 1, options.height),\r\n      new THREE.MeshPhongMaterial({\r\n        map: mainTex,\r\n        side: THREE.DoubleSide\r\n      }), 0);\r\n    skyWall.drawable.mesh.entity = skyWall;\r\n\r\n    if (options.position) {\r\n      skyWall.drawable.mesh.position.copy(options.position);\r\n    }\r\n    if (options.rotation) {\r\n      skyWall.drawable.mesh.rotation.copy(options.rotation);\r\n    }\r\n\r\n    skyWall.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.obstacle;\r\n    skyWall.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet |\r\n      EntityFactory.COLLISION_TYPES.pickup);\r\n\r\n    skyWall.drawable.scene.add(skyWall.drawable.mesh);\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!EntityFactory._instance) {\r\n        EntityFactory._instance = new EntityFactory();\r\n      }\r\n      return EntityFactory._instance;\r\n    },\r\n\r\n    COLLISION_TYPES: {\r\n      nothing: 0, // collide with nothing\r\n\r\n      obstacle: 1 << 0,\r\n      player: 1 << 2,\r\n      enemy: 1 << 3,\r\n\r\n      playerBullet: 1 << 4,\r\n      enemyBullet: 1 << 5,\r\n\r\n      pickup: 1 << 6\r\n    },\r\n\r\n    MOVE_SPEED: {\r\n      enemy: 275\r\n    },\r\n\r\n    MASS: {\r\n      player: 73,\r\n      enemy: 81,\r\n      bullet: 0.3\r\n    },\r\n\r\n    BULLET_DAMAGE: {\r\n      potato: 7,\r\n      fry: 3\r\n    },\r\n\r\n    MIN_BULLET_SPEED: {\r\n      enemy: 25\r\n    },\r\n\r\n    MAX_BULLET_SPEED: {\r\n      enemy: 75\r\n    },\r\n\r\n    MIN_LEASH_DISTANCE: {\r\n      enemy: 50\r\n    },\r\n\r\n    MAX_LEASH_DISTANCE: {\r\n      enemy: 250\r\n    },\r\n\r\n    MIN_SHOOT_DISTANCE: {\r\n      enemy: 50\r\n    },\r\n\r\n    MAX_SHOOT_DISTANCE: {\r\n      enemy: 250\r\n    },\r\n\r\n    MIN_START_HP: {\r\n      enemy: 10\r\n    },\r\n\r\n    MAX_START_HP: {\r\n      enemy: 25\r\n    }\r\n  }\r\n});\r\n\r\n","module.exports = function(THREE) {\n  'use strict';\n\n  var SUPPORT_TRANSFERABLE,\n    _is_simulating = false,\n    _Physijs = Physijs, // used for noConflict method\n    Physijs = {}, // object assigned to window.Physijs\n    Eventable, // class to provide simple event methods\n    getObjectId, // returns a unique ID for a Physijs mesh object\n    getEulerXYZFromQuaternion, getQuatertionFromEuler,\n    convertWorldPositionToObject, // Converts a world-space position to object-space\n    addObjectChildren,\n\n    _temp1, _temp2,\n    _temp_vector3_1 = new THREE.Vector3,\n    _temp_vector3_2 = new THREE.Vector3,\n    _temp_matrix4_1 = new THREE.Matrix4,\n    _quaternion_1 = new THREE.Quaternion,\n\n    // constants\n    MESSAGE_TYPES = {\n      WORLDREPORT: 0,\n      COLLISIONREPORT: 1,\n      VEHICLEREPORT: 2,\n      CONSTRAINTREPORT: 3\n    },\n    REPORT_ITEMSIZE = 14,\n    COLLISIONREPORT_ITEMSIZE = 5,\n    VEHICLEREPORT_ITEMSIZE = 9,\n    CONSTRAINTREPORT_ITEMSIZE = 6;\n\n  Physijs.scripts = {};\n\n  Eventable = function() {\n    this._eventListeners = {};\n  };\n  Eventable.prototype.addEventListener = function(event_name, callback) {\n    if (!this._eventListeners.hasOwnProperty(event_name)) {\n      this._eventListeners[event_name] = [];\n    }\n    this._eventListeners[event_name].push(callback);\n  };\n  Eventable.prototype.removeEventListener = function(event_name, callback) {\n    var index;\n\n    if (!this._eventListeners.hasOwnProperty(event_name)) return false;\n\n    if ((index = this._eventListeners[event_name].indexOf(callback)) >= 0) {\n      this._eventListeners[event_name].splice(index, 1);\n      return true;\n    }\n\n    return false;\n  };\n  Eventable.prototype.dispatchEvent = function(event_name) {\n    var i,\n      parameters = Array.prototype.splice.call(arguments, 1);\n\n    if (this._eventListeners.hasOwnProperty(event_name)) {\n      for (i = 0; i < this._eventListeners[event_name].length; i++) {\n        this._eventListeners[event_name][i].apply(this, parameters);\n      }\n    }\n  };\n  Eventable.make = function(obj) {\n    obj.prototype.addEventListener = Eventable.prototype.addEventListener;\n    obj.prototype.removeEventListener = Eventable.prototype.removeEventListener;\n    obj.prototype.dispatchEvent = Eventable.prototype.dispatchEvent;\n  };\n\n  getObjectId = (function() {\n    var _id = 1;\n    return function() {\n      return _id++;\n    };\n  })();\n\n  getEulerXYZFromQuaternion = function(x, y, z, w) {\n    return new THREE.Vector3(\n      Math.atan2(2 * (x * w - y * z), (w * w - x * x - y * y + z * z)),\n      Math.asin(2 * (x * z + y * w)),\n      Math.atan2(2 * (z * w - x * y), (w * w + x * x - y * y - z * z))\n    );\n  };\n\n  getQuatertionFromEuler = function(x, y, z) {\n    var c1, s1, c2, s2, c3, s3, c1c2, s1s2;\n    c1 = Math.cos(y);\n    s1 = Math.sin(y);\n    c2 = Math.cos(-z);\n    s2 = Math.sin(-z);\n    c3 = Math.cos(x);\n    s3 = Math.sin(x);\n\n    c1c2 = c1 * c2;\n    s1s2 = s1 * s2;\n\n    return {\n      w: c1c2 * c3 - s1s2 * s3,\n      x: c1c2 * s3 + s1s2 * c3,\n      y: s1 * c2 * c3 + c1 * s2 * s3,\n      z: c1 * s2 * c3 - s1 * c2 * s3\n    };\n  };\n\n  convertWorldPositionToObject = function(position, object) {\n    _temp_matrix4_1.identity(); // reset temp matrix\n\n    // Set the temp matrix's rotation to the object's rotation\n    _temp_matrix4_1.identity().makeRotationFromQuaternion(object.quaternion);\n\n    // Invert rotation matrix in order to \"unrotate\" a point back to object space\n    _temp_matrix4_1.getInverse(_temp_matrix4_1);\n\n    // Yay! Temp vars!\n    _temp_vector3_1.copy(position);\n    _temp_vector3_2.copy(object.position);\n\n    // Apply the rotation\n\n    return _temp_vector3_1.sub(_temp_vector3_2).applyMatrix4(_temp_matrix4_1);\n  };\n\n\n\n  // Physijs.noConflict\n  Physijs.noConflict = function() {\n    window.Physijs = _Physijs;\n    return Physijs;\n  };\n\n\n  // Physijs.createMaterial\n  Physijs.createMaterial = function(material, friction, restitution) {\n    var physijs_material = function() {};\n    physijs_material.prototype = material;\n    physijs_material = new physijs_material;\n\n    physijs_material._physijs = {\n      id: material.id,\n      friction: friction === undefined ? .8 : friction,\n      restitution: restitution === undefined ? .2 : restitution\n    };\n\n    return physijs_material;\n  };\n\n\n  // Constraints\n  Physijs.PointConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'point';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.PointConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb\n    };\n  };\n\n  Physijs.HingeConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'hinge';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.position = position.clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.HingeConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  /*\n   * low = minimum angle in radians\n   * high = maximum angle in radians\n   * bias_factor = applied as a factor to constraint error\n   * relaxation_factor = controls bounce (0.0 == no bounce)\n   */\n  Physijs.HingeConstraint.prototype.setLimits = function(low, high, bias_factor, relaxation_factor) {\n    this.scene.execute('hinge_setLimits', {\n      constraint: this.id,\n      low: low,\n      high: high,\n      bias_factor: bias_factor,\n      relaxation_factor: relaxation_factor\n    });\n  };\n  Physijs.HingeConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.HingeConstraint.prototype.disableMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.SliderConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'slider';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.SliderConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  Physijs.SliderConstraint.prototype.setLimits = function(lin_lower, lin_upper, ang_lower, ang_upper) {\n    this.scene.execute('slider_setLimits', {\n      constraint: this.id,\n      lin_lower: lin_lower,\n      lin_upper: lin_upper,\n      ang_lower: ang_lower,\n      ang_upper: ang_upper\n    });\n  };\n  Physijs.SliderConstraint.prototype.setRestitution = function(linear, angular) {\n    this.scene.execute(\n      'slider_setRestitution', {\n        constraint: this.id,\n        linear: linear,\n        angular: angular\n      }\n    );\n  };\n  Physijs.SliderConstraint.prototype.enableLinearMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableLinearMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableLinearMotor = function() {\n    this.scene.execute('slider_disableLinearMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.SliderConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableAngularMotor = function() {\n    this.scene.execute('slider_disableAngularMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.ConeTwistConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      throw 'Both objects must be defined in a ConeTwistConstraint.';\n    }\n    this.type = 'conetwist';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.objectb = objectb._physijs.id;\n    this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n    this.axisb = {\n      x: objectb.rotation.x,\n      y: objectb.rotation.y,\n      z: objectb.rotation.z\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.setLimit = function(x, y, z) {\n    this.scene.execute('conetwist_setLimit', {\n      constraint: this.id,\n      x: x,\n      y: y,\n      z: z\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.enableMotor = function() {\n    this.scene.execute('conetwist_enableMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMaxMotorImpulse = function(max_impulse) {\n    this.scene.execute('conetwist_setMaxMotorImpulse', {\n      constraint: this.id,\n      max_impulse: max_impulse\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMotorTarget = function(target) {\n    if (target instanceof THREE.Vector3) {\n      target = new THREE.Quaternion().setFromEuler(new THREE.Euler(target.x, target.y, target.z));\n    }\n    else if (target instanceof THREE.Euler) {\n      target = new THREE.Quaternion().setFromEuler(target);\n    }\n    else if (target instanceof THREE.Matrix4) {\n      target = new THREE.Quaternion().setFromRotationMatrix(target);\n    }\n    this.scene.execute('conetwist_setMotorTarget', {\n      constraint: this.id,\n      x: target.x,\n      y: target.y,\n      z: target.z,\n      w: target.w\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.disableMotor = function() {\n    this.scene.execute('conetwist_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.DOFConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n    this.type = 'dof';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n      this.axisb = {\n        x: objectb.rotation.x,\n        y: objectb.rotation.y,\n        z: objectb.rotation.z\n      };\n    }\n  };\n  Physijs.DOFConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.DOFConstraint.prototype.setLinearLowerLimit = function(limit) {\n    this.scene.execute('dof_setLinearLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setLinearUpperLimit = function(limit) {\n    this.scene.execute('dof_setLinearUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularLowerLimit = function(limit) {\n    this.scene.execute('dof_setAngularLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularUpperLimit = function(limit) {\n    this.scene.execute('dof_setAngularUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.enableAngularMotor = function(which) {\n    this.scene.execute('dof_enableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n  Physijs.DOFConstraint.prototype.configureAngularMotor = function(which, low_angle, high_angle, velocity, max_force) {\n    this.scene.execute('dof_configureAngularMotor', {\n      constraint: this.id,\n      which: which,\n      low_angle: low_angle,\n      high_angle: high_angle,\n      velocity: velocity,\n      max_force: max_force\n    });\n  };\n  Physijs.DOFConstraint.prototype.disableAngularMotor = function(which) {\n    this.scene.execute('dof_disableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n\n  // Physijs.Scene\n  Physijs.Scene = function(params) {\n    var self = this;\n\n    Eventable.call(this);\n    THREE.Scene.call(this);\n\n    this._worker = new Worker(Physijs.scripts.worker || 'physijsWorker.js');\n    this._worker.transferableMessage = this._worker.webkitPostMessage || this._worker.postMessage;\n    this._materials_ref_counts = {};\n    this._objects = {};\n    this._vehicles = {};\n    this._constraints = {};\n\n    var ab = new ArrayBuffer(1);\n    this._worker.transferableMessage(ab, [ab]);\n    SUPPORT_TRANSFERABLE = (ab.byteLength === 0);\n\n    this._worker.onerror = function(event) {\n      console.log(event.message);\n      console.log(event.filename);\n      console.log(event.lineno);\n    };\n\n    this._worker.onmessage = function(event) {\n      var _temp,\n        data = event.data;\n\n      if (data instanceof ArrayBuffer && data.byteLength !== 1) { // byteLength === 1 is the worker making a SUPPORT_TRANSFERABLE test\n        data = new Float32Array(data);\n      }\n\n      if (data instanceof Float32Array) {\n\n        // transferable object\n        switch (data[0]) {\n          case MESSAGE_TYPES.WORLDREPORT:\n            self._updateScene(data);\n            break;\n\n          case MESSAGE_TYPES.COLLISIONREPORT:\n            self._updateCollisions(data);\n            break;\n\n          case MESSAGE_TYPES.VEHICLEREPORT:\n            self._updateVehicles(data);\n            break;\n\n          case MESSAGE_TYPES.CONSTRAINTREPORT:\n            self._updateConstraints(data);\n            break;\n        }\n\n      }\n      else {\n\n        if (data.cmd) {\n\n          // non-transferable object\n          switch (data.cmd) {\n            case 'objectReady':\n              _temp = data.params;\n              if (self._objects[_temp]) {\n                self._objects[_temp].dispatchEvent('ready');\n              }\n              break;\n\n            case 'worldReady':\n              self.dispatchEvent('ready');\n              break;\n\n            case 'vehicle':\n              window.test = data;\n              break;\n\n            default:\n              // Do nothing, just show the message\n              console.debug('Received: ' + data.cmd);\n              console.dir(data.params);\n              break;\n          }\n\n        }\n        else {\n\n          switch (data[0]) {\n            case MESSAGE_TYPES.WORLDREPORT:\n              self._updateScene(data);\n              break;\n\n            case MESSAGE_TYPES.COLLISIONREPORT:\n              self._updateCollisions(data);\n              break;\n\n            case MESSAGE_TYPES.VEHICLEREPORT:\n              self._updateVehicles(data);\n              break;\n\n            case MESSAGE_TYPES.CONSTRAINTREPORT:\n              self._updateConstraints(data);\n              break;\n          }\n\n        }\n\n      }\n    };\n\n\n    params = params || {};\n    params.ammo = Physijs.scripts.ammo || 'ammo.js';\n    params.fixedTimeStep = params.fixedTimeStep || 1 / 60;\n    params.rateLimit = params.rateLimit || true;\n    this.execute('init', params);\n  };\n  Physijs.Scene.prototype = new THREE.Scene;\n  Physijs.Scene.prototype.constructor = Physijs.Scene;\n  Eventable.make(Physijs.Scene);\n\n  Physijs.Scene.prototype._updateScene = function(data) {\n    var num_objects = data[1],\n      object,\n      i, offset;\n\n    for (i = 0; i < num_objects; i++) {\n      offset = 2 + i * REPORT_ITEMSIZE;\n      object = this._objects[data[offset]];\n\n      if (object === undefined) {\n        continue;\n      }\n\n      if (object.__dirtyPosition === false) {\n        object.position.set(\n          data[offset + 1],\n          data[offset + 2],\n          data[offset + 3]\n        );\n      }\n\n      if (object.__dirtyRotation === false) {\n        object.quaternion.set(\n          data[offset + 4],\n          data[offset + 5],\n          data[offset + 6],\n          data[offset + 7]\n        );\n      }\n\n      object._physijs.linearVelocity.set(\n        data[offset + 8],\n        data[offset + 9],\n        data[offset + 10]\n      );\n\n      object._physijs.angularVelocity.set(\n        data[offset + 11],\n        data[offset + 12],\n        data[offset + 13]\n      );\n\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n\n    _is_simulating = false;\n    this.dispatchEvent('update');\n  };\n\n  Physijs.Scene.prototype._updateVehicles = function(data) {\n    var vehicle, wheel,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / VEHICLEREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * VEHICLEREPORT_ITEMSIZE;\n      vehicle = this._vehicles[data[offset]];\n\n      if (vehicle === undefined) {\n        continue;\n      }\n\n      wheel = vehicle.wheels[data[offset + 1]];\n\n      wheel.position.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n\n      wheel.quaternion.set(\n        data[offset + 5],\n        data[offset + 6],\n        data[offset + 7],\n        data[offset + 8]\n      );\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateConstraints = function(data) {\n    var constraint, object,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / CONSTRAINTREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * CONSTRAINTREPORT_ITEMSIZE;\n      constraint = this._constraints[data[offset]];\n      object = this._objects[data[offset + 1]];\n\n      if (constraint === undefined || object === undefined) {\n        continue;\n      }\n\n      _temp_vector3_1.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n      _temp_matrix4_1.extractRotation(object.matrix);\n      _temp_vector3_1.applyMatrix4(_temp_matrix4_1);\n\n      constraint.positiona.addVectors(object.position, _temp_vector3_1);\n      constraint.appliedImpulse = data[offset + 5];\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateCollisions = function(data) {\n    /**\n     * #TODO\n     * This is probably the worst way ever to handle collisions. The inherent evilness is a residual\n     * effect from the previous version's evilness which mutated when switching to transferable objects.\n     *\n     * If you feel inclined to make this better, please do so.\n     */\n\n    var i, j, offset, object, object2, id1, id2,\n      collisions = {},\n      normal_offsets = {};\n\n    // Build collision manifest\n    for (i = 0; i < data[1]; i++) {\n      offset = 2 + i * COLLISIONREPORT_ITEMSIZE;\n      object = data[offset];\n      object2 = data[offset + 1];\n\n      normal_offsets[object + '-' + object2] = offset + 2;\n      normal_offsets[object2 + '-' + object] = -1 * (offset + 2);\n\n      // Register collisions for both the object colliding and the object being collided with\n      if (!collisions[object]) collisions[object] = [];\n      collisions[object].push(object2);\n\n      if (!collisions[object2]) collisions[object2] = [];\n      collisions[object2].push(object);\n    }\n\n    // Deal with collisions\n    for (id1 in this._objects) {\n      if (!this._objects.hasOwnProperty(id1)) continue;\n      object = this._objects[id1];\n\n      // If object touches anything, ...\n      if (collisions[id1]) {\n\n        // Clean up touches array\n        for (j = 0; j < object._physijs.touches.length; j++) {\n          if (collisions[id1].indexOf(object._physijs.touches[j]) === -1) {\n            object._physijs.touches.splice(j--, 1);\n          }\n        }\n\n        // Handle each colliding object\n        for (j = 0; j < collisions[id1].length; j++) {\n          id2 = collisions[id1][j];\n          object2 = this._objects[id2];\n\n          if (object2) {\n            // If object was not already touching object2, notify object\n            if (object._physijs.touches.indexOf(id2) === -1) {\n              object._physijs.touches.push(id2);\n\n              _temp_vector3_1.subVectors(object.getLinearVelocity(), object2.getLinearVelocity());\n              _temp1 = _temp_vector3_1.clone();\n\n              _temp_vector3_1.subVectors(object.getAngularVelocity(), object2.getAngularVelocity());\n              _temp2 = _temp_vector3_1.clone();\n\n              var normal_offset = normal_offsets[object._physijs.id + '-' + object2._physijs.id];\n              if (normal_offset > 0) {\n                _temp_vector3_1.set(-data[normal_offset], -data[normal_offset + 1], -data[normal_offset + 2]);\n              }\n              else {\n                normal_offset *= -1;\n                _temp_vector3_1.set(\n                  data[normal_offset],\n                  data[normal_offset + 1],\n                  data[normal_offset + 2]\n                );\n              }\n\n              object.dispatchEvent('collision', object2, _temp1, _temp2, _temp_vector3_1);\n            }\n          }\n        }\n\n      }\n      else {\n\n        // not touching other objects\n        object._physijs.touches.length = 0;\n\n      }\n\n    }\n\n    this.collisions = collisions;\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype.addConstraint = function(constraint, show_marker) {\n    this._constraints[constraint.id] = constraint;\n    this.execute('addConstraint', constraint.getDefinition());\n\n    if (show_marker) {\n      var marker;\n\n      switch (constraint.type) {\n        case 'point':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'hinge':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'slider':\n          marker = new THREE.Mesh(\n            new THREE.BoxGeometry(10, 1, 1),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          // This rotation isn't right if all three axis are non-0 values\n          // TODO: change marker's rotation order to ZYX\n          marker.rotation.set(\n            constraint.axis.y, // yes, y and\n            constraint.axis.x, // x axis are swapped\n            constraint.axis.z\n          );\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'conetwist':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'dof':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n      }\n    }\n\n    return constraint;\n  };\n\n  Physijs.Scene.prototype.onSimulationResume = function() {\n    this.execute('onSimulationResume', {});\n  };\n\n  Physijs.Scene.prototype.removeConstraint = function(constraint) {\n    if (this._constraints[constraint.id] !== undefined) {\n      this.execute('removeConstraint', {\n        id: constraint.id\n      });\n      delete this._constraints[constraint.id];\n    }\n  };\n\n  Physijs.Scene.prototype.execute = function(cmd, params) {\n    this._worker.postMessage({\n      cmd: cmd,\n      params: params\n    });\n  };\n\n  addObjectChildren = function(parent, object) {\n    var i;\n\n    for (i = 0; i < object.children.length; i++) {\n      if (object.children[i]._physijs) {\n        object.children[i].updateMatrix();\n        object.children[i].updateMatrixWorld();\n\n        _temp_vector3_1.setFromMatrixPosition(object.children[i].matrixWorld);\n        _quaternion_1.setFromRotationMatrix(object.children[i].matrixWorld);\n\n        object.children[i]._physijs.position_offset = {\n          x: _temp_vector3_1.x,\n          y: _temp_vector3_1.y,\n          z: _temp_vector3_1.z\n        };\n\n        object.children[i]._physijs.rotation = {\n          x: _quaternion_1.x,\n          y: _quaternion_1.y,\n          z: _quaternion_1.z,\n          w: _quaternion_1.w\n        };\n\n        parent._physijs.children.push(object.children[i]._physijs);\n      }\n\n      addObjectChildren(parent, object.children[i]);\n    }\n  };\n\n  Physijs.Scene.prototype.add = function(object) {\n    THREE.Mesh.prototype.add.call(this, object);\n\n    if (object._physijs) {\n\n      object.world = this;\n\n      if (object instanceof Physijs.Vehicle) {\n\n        this.add(object.mesh);\n        this._vehicles[object._physijs.id] = object;\n        this.execute('addVehicle', object._physijs);\n\n      }\n      else {\n\n        object.__dirtyPosition = false;\n        object.__dirtyRotation = false;\n        this._objects[object._physijs.id] = object;\n\n        if (object.children.length) {\n          object._physijs.children = [];\n          addObjectChildren(object, object);\n        }\n\n        if (object.material._physijs) {\n          if (!this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n            this.execute('registerMaterial', object.material._physijs);\n            object._physijs.materialId = object.material._physijs.id;\n            this._materials_ref_counts[object.material._physijs.id] = 1;\n          }\n          else {\n            this._materials_ref_counts[object.material._physijs.id]++;\n          }\n        }\n\n        // Object starting position + rotation\n        object._physijs.position = {\n          x: object.position.x,\n          y: object.position.y,\n          z: object.position.z\n        };\n        object._physijs.rotation = {\n          x: object.quaternion.x,\n          y: object.quaternion.y,\n          z: object.quaternion.z,\n          w: object.quaternion.w\n        };\n\n        // Check for scaling\n        var mass_scaling = new THREE.Vector3(1, 1, 1);\n        if (object._physijs.width) {\n          object._physijs.width *= object.scale.x;\n        }\n        if (object._physijs.height) {\n          object._physijs.height *= object.scale.y;\n        }\n        if (object._physijs.depth) {\n          object._physijs.depth *= object.scale.z;\n        }\n\n        this.execute('addObject', object._physijs);\n\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.remove = function(object) {\n    if (object instanceof Physijs.Vehicle) {\n      this.execute('removeVehicle', {\n        id: object._physijs.id\n      });\n      while (object.wheels.length) {\n        this.remove(object.wheels.pop());\n      }\n      this.remove(object.mesh);\n      delete this._vehicles[object._physijs.id];\n    }\n    else {\n      THREE.Mesh.prototype.remove.call(this, object);\n      if (object._physijs) {\n        delete this._objects[object._physijs.id];\n        this.execute('removeObject', {\n          id: object._physijs.id\n        });\n      }\n    }\n    if (object.material && object.material._physijs && this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n      this._materials_ref_counts[object.material._physijs.id]--;\n      if (this._materials_ref_counts[object.material._physijs.id] == 0) {\n        this.execute('unRegisterMaterial', object.material._physijs);\n        delete this._materials_ref_counts[object.material._physijs.id];\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.setFixedTimeStep = function(fixedTimeStep) {\n    if (fixedTimeStep) {\n      this.execute('setFixedTimeStep', fixedTimeStep);\n    }\n  };\n\n  Physijs.Scene.prototype.setGravity = function(gravity) {\n    if (gravity) {\n      this.execute('setGravity', gravity);\n    }\n  };\n\n  Physijs.Scene.prototype.simulate = function(timeStep, maxSubSteps) {\n    var object_id, object, update;\n\n    if (_is_simulating) {\n      return false;\n    }\n\n    _is_simulating = true;\n\n    for (object_id in this._objects) {\n      if (!this._objects.hasOwnProperty(object_id)) continue;\n\n      object = this._objects[object_id];\n\n      if (object.__dirtyPosition || object.__dirtyRotation) {\n        update = {\n          id: object._physijs.id\n        };\n\n        if (object.__dirtyPosition) {\n          update.pos = {\n            x: object.position.x,\n            y: object.position.y,\n            z: object.position.z\n          };\n          object.__dirtyPosition = false;\n        }\n\n        if (object.__dirtyRotation) {\n          update.quat = {\n            x: object.quaternion.x,\n            y: object.quaternion.y,\n            z: object.quaternion.z,\n            w: object.quaternion.w\n          };\n          object.__dirtyRotation = false;\n        }\n\n        this.execute('updateTransform', update);\n      }\n    }\n\n    this.execute('simulate', {\n      timeStep: timeStep,\n      maxSubSteps: maxSubSteps\n    });\n\n    return true;\n  };\n\n\n  // Phsijs.Mesh\n  Physijs.Mesh = function(geometry, material, mass) {\n    var index;\n\n    if (!geometry) {\n      return;\n    }\n\n    Eventable.call(this);\n    THREE.Mesh.call(this, geometry, material);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    this._physijs = {\n      type: null,\n      id: getObjectId(),\n      mass: mass || 0,\n      touches: [],\n      linearVelocity: new THREE.Vector3,\n      angularVelocity: new THREE.Vector3\n    };\n  };\n  Physijs.Mesh.prototype = new THREE.Mesh;\n  Physijs.Mesh.prototype.constructor = Physijs.Mesh;\n  Eventable.make(Physijs.Mesh);\n\n  // Physijs.Mesh.mass\n  Physijs.Mesh.prototype.__defineGetter__('mass', function() {\n    return this._physijs.mass;\n  });\n  Physijs.Mesh.prototype.__defineSetter__('mass', function(mass) {\n    this._physijs.mass = mass;\n    if (this.world) {\n      this.world.execute('updateMass', {\n        id: this._physijs.id,\n        mass: mass\n      });\n    }\n  });\n\n  // Physijs.Mesh.applyCentralImpulse\n  Physijs.Mesh.prototype.applyCentralImpulse = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralImpulse', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyImpulse\n  Physijs.Mesh.prototype.applyImpulse = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyImpulse', {\n        id: this._physijs.id,\n        impulse_x: force.x,\n        impulse_y: force.y,\n        impulse_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyTorque\n  Physijs.Mesh.prototype.applyTorque = function(force) {\n    if (this.world) {\n      this.world.execute('applyTorque', {\n        id: this._physijs.id,\n        torque_x: force.x,\n        torque_y: force.y,\n        torque_z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyCentralForce\n  Physijs.Mesh.prototype.applyCentralForce = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralForce', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyForce\n  Physijs.Mesh.prototype.applyForce = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyForce', {\n        id: this._physijs.id,\n        force_x: force.x,\n        force_y: force.y,\n        force_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getAngularVelocity\n  Physijs.Mesh.prototype.getAngularVelocity = function() {\n    return this._physijs.angularVelocity;\n  };\n\n  // Physijs.Mesh.setAngularVelocity\n  Physijs.Mesh.prototype.setAngularVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setAngularVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getLinearVelocity\n  Physijs.Mesh.prototype.getLinearVelocity = function() {\n    return this._physijs.linearVelocity;\n  };\n\n  // Physijs.Mesh.setLinearVelocity\n  Physijs.Mesh.prototype.setLinearVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setLinearVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setAngularFactor\n  Physijs.Mesh.prototype.setAngularFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setAngularFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setLinearFactor\n  Physijs.Mesh.prototype.setLinearFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setLinearFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setDamping\n  Physijs.Mesh.prototype.setDamping = function(linear, angular) {\n    if (this.world) {\n      this.world.execute('setDamping', {\n        id: this._physijs.id,\n        linear: linear,\n        angular: angular\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdMotionThreshold\n  Physijs.Mesh.prototype.setCcdMotionThreshold = function(threshold) {\n    if (this.world) {\n      this.world.execute('setCcdMotionThreshold', {\n        id: this._physijs.id,\n        threshold: threshold\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdSweptSphereRadius\n  Physijs.Mesh.prototype.setCcdSweptSphereRadius = function(radius) {\n    if (this.world) {\n      this.world.execute('setCcdSweptSphereRadius', {\n        id: this._physijs.id,\n        radius: radius\n      });\n    }\n  };\n\n\n  // Physijs.PlaneMesh\n  Physijs.PlaneMesh = function(geometry, material, mass) {\n    var width, height;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'plane';\n    this._physijs.normal = geometry.faces[0].normal.clone();\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.PlaneMesh.prototype = new Physijs.Mesh;\n  Physijs.PlaneMesh.prototype.constructor = Physijs.PlaneMesh;\n\n  // Physijs.HeightfieldMesh\n  Physijs.HeightfieldMesh = function(geometry, material, mass, xdiv, ydiv) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    this._physijs.type = 'heightfield';\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\n\n    var points = [];\n\n    var a, b;\n    for (var i = 0; i < geometry.vertices.length; i++) {\n\n      a = i % this._physijs.xpts;\n      b = Math.round((i / this._physijs.xpts) - ((i % this._physijs.xpts) / this._physijs.xpts));\n      points[i] = geometry.vertices[a + ((this._physijs.ypts - b - 1) * this._physijs.ypts)].z;\n\n      //points[i] = geometry.vertices[i];\n    }\n\n    this._physijs.points = points;\n  };\n  Physijs.HeightfieldMesh.prototype = new Physijs.Mesh;\n  Physijs.HeightfieldMesh.prototype.constructor = Physijs.HeightfieldMesh;\n\n  // Physijs.BoxMesh\n  Physijs.BoxMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'box';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.BoxMesh.prototype = new Physijs.Mesh;\n  Physijs.BoxMesh.prototype.constructor = Physijs.BoxMesh;\n\n\n  // Physijs.SphereMesh\n  Physijs.SphereMesh = function(geometry, material, mass) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingSphere) {\n      geometry.computeBoundingSphere();\n    }\n\n    this._physijs.type = 'sphere';\n    this._physijs.radius = geometry.boundingSphere.radius;\n    this._physijs.mass = (typeof mass === 'undefined') ? (4 / 3) * Math.PI * Math.pow(this._physijs.radius, 3) : mass;\n  };\n  Physijs.SphereMesh.prototype = new Physijs.Mesh;\n  Physijs.SphereMesh.prototype.constructor = Physijs.SphereMesh;\n\n\n  // Physijs.CylinderMesh\n  Physijs.CylinderMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'cylinder';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CylinderMesh.prototype = new Physijs.Mesh;\n  Physijs.CylinderMesh.prototype.constructor = Physijs.CylinderMesh;\n\n\n  // Physijs.CapsuleMesh\n  Physijs.CapsuleMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'capsule';\n    this._physijs.radius = Math.max(width / 2, depth / 2);\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CapsuleMesh.prototype = new Physijs.Mesh;\n  Physijs.CapsuleMesh.prototype.constructor = Physijs.CapsuleMesh;\n\n\n  // Physijs.ConeMesh\n  Physijs.ConeMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'cone';\n    this._physijs.radius = width / 2;\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.ConeMesh.prototype = new Physijs.Mesh;\n  Physijs.ConeMesh.prototype.constructor = Physijs.ConeMesh;\n\n\n  // Physijs.ConcaveMesh\n  Physijs.ConcaveMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      vertices, face, triangles = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    vertices = geometry.vertices;\n\n    for (i = 0; i < geometry.faces.length; i++) {\n      face = geometry.faces[i];\n      if (face instanceof THREE.Face3) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }]);\n\n      }\n      else if (face instanceof THREE.Face4) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n        triangles.push([{\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n\n      }\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'concave';\n    this._physijs.triangles = triangles;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConcaveMesh.prototype = new Physijs.Mesh;\n  Physijs.ConcaveMesh.prototype.constructor = Physijs.ConcaveMesh;\n\n\n  // Physijs.ConvexMesh\n  Physijs.ConvexMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      points = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    for (i = 0; i < geometry.vertices.length; i++) {\n      points.push({\n        x: geometry.vertices[i].x,\n        y: geometry.vertices[i].y,\n        z: geometry.vertices[i].z\n      });\n    }\n\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'convex';\n    this._physijs.points = points;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConvexMesh.prototype = new Physijs.Mesh;\n  Physijs.ConvexMesh.prototype.constructor = Physijs.ConvexMesh;\n\n\n  // Physijs.Vehicle\n  Physijs.Vehicle = function(mesh, tuning) {\n    tuning = tuning || new Physijs.VehicleTuning;\n    this.mesh = mesh;\n    this.wheels = [];\n    this._physijs = {\n      id: getObjectId(),\n      rigidBody: mesh._physijs.id,\n      suspension_stiffness: tuning.suspension_stiffness,\n      suspension_compression: tuning.suspension_compression,\n      suspension_damping: tuning.suspension_damping,\n      max_suspension_travel: tuning.max_suspension_travel,\n      friction_slip: tuning.friction_slip,\n      max_suspension_force: tuning.max_suspension_force\n    };\n  };\n  Physijs.Vehicle.prototype.addWheel = function(wheel_geometry, wheel_material, connection_point, wheel_direction, wheel_axle, suspension_rest_length, wheel_radius, is_front_wheel, tuning) {\n    var wheel = new THREE.Mesh(wheel_geometry, wheel_material);\n    wheel.castShadow = wheel.receiveShadow = true;\n    wheel.position.copy(wheel_direction).multiplyScalar(suspension_rest_length / 100).add(connection_point);\n    this.world.add(wheel);\n    this.wheels.push(wheel);\n\n    this.world.execute('addWheel', {\n      id: this._physijs.id,\n      connection_point: {\n        x: connection_point.x,\n        y: connection_point.y,\n        z: connection_point.z\n      },\n      wheel_direction: {\n        x: wheel_direction.x,\n        y: wheel_direction.y,\n        z: wheel_direction.z\n      },\n      wheel_axle: {\n        x: wheel_axle.x,\n        y: wheel_axle.y,\n        z: wheel_axle.z\n      },\n      suspension_rest_length: suspension_rest_length,\n      wheel_radius: wheel_radius,\n      is_front_wheel: is_front_wheel,\n      tuning: tuning\n    });\n  };\n  Physijs.Vehicle.prototype.setSteering = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setSteering', {\n        id: this._physijs.id,\n        wheel: wheel,\n        steering: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setSteering', {\n          id: this._physijs.id,\n          wheel: i,\n          steering: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.setBrake = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setBrake', {\n        id: this._physijs.id,\n        wheel: wheel,\n        brake: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setBrake', {\n          id: this._physijs.id,\n          wheel: i,\n          brake: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.applyEngineForce = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('applyEngineForce', {\n        id: this._physijs.id,\n        wheel: wheel,\n        force: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('applyEngineForce', {\n          id: this._physijs.id,\n          wheel: i,\n          force: amount\n        });\n      }\n    }\n  };\n\n  // Physijs.VehicleTuning\n  Physijs.VehicleTuning = function(suspension_stiffness, suspension_compression, suspension_damping, max_suspension_travel, friction_slip, max_suspension_force) {\n    this.suspension_stiffness = suspension_stiffness !== undefined ? suspension_stiffness : 5.88;\n    this.suspension_compression = suspension_compression !== undefined ? suspension_compression : 0.83;\n    this.suspension_damping = suspension_damping !== undefined ? suspension_damping : 0.88;\n    this.max_suspension_travel = max_suspension_travel !== undefined ? max_suspension_travel : 500;\n    this.friction_slip = friction_slip !== undefined ? friction_slip : 10.5;\n    this.max_suspension_force = max_suspension_force !== undefined ? max_suspension_force : 6000;\n  };\n\n  return Physijs;\n}\n\n","/** @preserve http://github.com/easeway/js-class */\n\n// Class Definition using ECMA5 prototype chain\n\nfunction inherit(dest, src, noParent) {\n    while (src && src !== Object.prototype) {\n        Object.getOwnPropertyNames(src).forEach(function (name) {\n            if (name != '.class' && !dest.hasOwnProperty(name)) {\n                var desc = Object.getOwnPropertyDescriptor(src, name);\n                Object.defineProperty(dest, name, desc);\n            }\n        });\n        if (noParent) {\n            break;\n        }\n        src = src.__proto__;\n    }\n    return dest;\n}\n\nvar Class = function (base, proto, options) {\n    if (typeof(base) != 'function') {\n        options = proto;\n        proto = base;\n        base = Object;\n    }\n    if (!proto) {\n        proto = {};\n    }\n    if (!options) {\n        options = {};\n    }\n    \n    var meta = {\n        name: options.name,\n        base: base,\n        implements: []\n    }\n    var classProto = Class.clone(proto);\n    if (options.implements) {\n        (Array.isArray(options.implements) ? options.implements : [options.implements])\n            .forEach(function (implementedType) {\n                if (typeof(implementedType) == 'function' && implementedType.prototype) {\n                    meta.implements.push(implementedType);\n                    Class.extend(classProto, implementedType.prototype);\n                }\n            });\n    }\n    classProto.__proto__ = base.prototype;\n    var theClass = function () {\n        if (typeof(this.constructor) == 'function') {\n            this.constructor.apply(this, arguments);\n        }\n    };\n    meta.type = theClass;\n    theClass.prototype = classProto;\n    Object.defineProperty(theClass, '.class.meta', { value: meta, enumerable: false, configurable: false, writable: false });\n    Object.defineProperty(classProto, '.class', { value: theClass, enumerable: false, configurable: false, writable: false });\n    if (options.statics) {\n        Class.extend(theClass, options.statics);\n    }\n    return theClass;\n};\n\nClass.extend = inherit;\n\nClass.clone = function (object) {\n    return inherit({}, object);\n};\n\nfunction findType(meta, type) {\n    while (meta) {\n        if (meta.type.prototype === type.prototype) {\n            return true;\n        }\n        for (var i in meta.implements) {\n            var implType = meta.implements[i];\n            var implMeta = implType['.class.meta'];\n            if (implMeta) {\n                if (findType(implMeta, type)) {\n                    return true;\n                }\n            } else {\n                for (var proto = implType.prototype; proto; proto = proto.__proto__) {\n                    if (proto === type.prototype) {\n                        return true;\n                    }\n                }\n            }\n        }\n        meta = meta.base ? meta.base['.class.meta'] : undefined;\n    }\n    return false;\n}\n\nvar Checker = Class({\n    constructor: function (object) {\n        this.object = object;\n    },\n    \n    typeOf: function (type) {\n        if (this.object instanceof type) {\n            return true;\n        }\n        var meta = Class.typeInfo(this.object);\n        return meta && findType(meta, type);\n    }\n});\n\n// aliases\nChecker.prototype.a = Checker.prototype.typeOf;\nChecker.prototype.an = Checker.prototype.typeOf;\n\nClass.is = function (object) {\n    return new Checker(object);\n};\n\nClass.typeInfo = function (object) {\n    var theClass = object.__proto__['.class'];\n    return theClass ? theClass['.class.meta'] : undefined;\n};\n\nClass.VERSION = [0, 0, 2];\n\nif (module) {\n    module.exports = Class;\n} else {\n    global.Class = Class;   // for browser\n}","/*\n * Hamster.js v1.0.5\n * (c) 2013 Monospaced http://monospaced.com\n * License: MIT\n */\n\n(function(window, document){\n'use strict';\n\n/**\n * Hamster\n * use this to create instances\n * @returns {Hamster.Instance}\n * @constructor\n */\nvar Hamster = function(element) {\n  return new Hamster.Instance(element);\n};\n\n// default event name\nHamster.SUPPORT = 'wheel';\n\n// default DOM methods\nHamster.ADD_EVENT = 'addEventListener';\nHamster.REMOVE_EVENT = 'removeEventListener';\nHamster.PREFIX = '';\n\n// until browser inconsistencies have been fixed...\nHamster.READY = false;\n\nHamster.Instance = function(element){\n  if (!Hamster.READY) {\n    // fix browser inconsistencies\n    Hamster.normalise.browser();\n\n    // Hamster is ready...!\n    Hamster.READY = true;\n  }\n\n  this.element = element;\n\n  // store attached event handlers\n  this.handlers = [];\n\n  // return instance\n  return this;\n};\n\n/**\n * create new hamster instance\n * all methods should return the instance itself, so it is chainable.\n * @param   {HTMLElement}       element\n * @returns {Hamster.Instance}\n * @constructor\n */\nHamster.Instance.prototype = {\n  /**\n   * bind events to the instance\n   * @param   {Function}    handler\n   * @param   {Boolean}     useCapture\n   * @returns {Hamster.Instance}\n   */\n  wheel: function onEvent(handler, useCapture){\n    Hamster.event.add(this, Hamster.SUPPORT, handler, useCapture);\n\n    // handle MozMousePixelScroll in older Firefox\n    if (Hamster.SUPPORT === 'DOMMouseScroll') {\n      Hamster.event.add(this, 'MozMousePixelScroll', handler, useCapture);\n    }\n\n    return this;\n  },\n\n  /**\n   * unbind events to the instance\n   * @param   {Function}    handler\n   * @param   {Boolean}     useCapture\n   * @returns {Hamster.Instance}\n   */\n  unwheel: function offEvent(handler, useCapture){\n    // if no handler argument,\n    // unbind the last bound handler (if exists)\n    if (handler === undefined && (handler = this.handlers.slice(-1)[0])) {\n      handler = handler.original;\n    }\n\n    Hamster.event.remove(this, Hamster.SUPPORT, handler, useCapture);\n\n    // handle MozMousePixelScroll in older Firefox\n    if (Hamster.SUPPORT === 'DOMMouseScroll') {\n      Hamster.event.remove(this, 'MozMousePixelScroll', handler, useCapture);\n    }\n\n    return this;\n  }\n};\n\nHamster.event = {\n  /**\n   * cross-browser 'addWheelListener'\n   * @param   {Instance}    hamster\n   * @param   {String}      eventName\n   * @param   {Function}    handler\n   * @param   {Boolean}     useCapture\n   */\n  add: function add(hamster, eventName, handler, useCapture){\n    // store the original handler\n    var originalHandler = handler;\n\n    // redefine the handler\n    handler = function(originalEvent){\n\n      if (!originalEvent) {\n        originalEvent = window.event;\n      }\n\n      // create a normalised event object,\n      // and normalise \"deltas\" of the mouse wheel\n      var event = Hamster.normalise.event(originalEvent),\n          delta = Hamster.normalise.delta(originalEvent);\n\n      // fire the original handler with normalised arguments\n      return originalHandler(event, delta[0], delta[1], delta[2]);\n\n    };\n\n    // cross-browser addEventListener\n    hamster.element[Hamster.ADD_EVENT](Hamster.PREFIX + eventName, handler, useCapture || false);\n\n    // store original and normalised handlers on the instance\n    hamster.handlers.push({\n      original: originalHandler,\n      normalised: handler\n    });\n  },\n\n  /**\n   * removeWheelListener\n   * @param   {Instance}    hamster\n   * @param   {String}      eventName\n   * @param   {Function}    handler\n   * @param   {Boolean}     useCapture\n   */\n  remove: function remove(hamster, eventName, handler, useCapture){\n    // find the normalised handler on the instance\n    var originalHandler = handler,\n        lookup = {},\n        handlers;\n    for (var i = 0, len = hamster.handlers.length; i < len; ++i) {\n      lookup[hamster.handlers[i].original] = hamster.handlers[i];\n    }\n    handlers = lookup[originalHandler];\n    handler = handlers.normalised;\n\n    // cross-browser removeEventListener\n    hamster.element[Hamster.REMOVE_EVENT](Hamster.PREFIX + eventName, handler, useCapture || false);\n\n    // remove original and normalised handlers from the instance\n    for (var h in hamster.handlers) {\n      if (hamster.handlers[h] == handlers) {\n        hamster.handlers.splice(h, 1);\n        break;\n      }\n    }\n  }\n};\n\n/**\n * these hold the lowest deltas,\n * used to normalise the delta values\n * @type {Number}\n */\nvar lowestDelta,\n    lowestDeltaXY;\n\nHamster.normalise = {\n  /**\n   * fix browser inconsistencies\n   */\n  browser: function normaliseBrowser(){\n    // detect deprecated wheel events\n    if (!('onwheel' in document || document.documentMode >= 9)) {\n      Hamster.SUPPORT = document.onmousewheel !== undefined ?\n                        'mousewheel' : // webkit and IE < 9 support at least \"mousewheel\"\n                        'DOMMouseScroll'; // assume remaining browsers are older Firefox\n    }\n\n    // detect deprecated event model\n    if (!window.addEventListener) {\n      // assume IE < 9\n      Hamster.ADD_EVENT = 'attachEvent';\n      Hamster.REMOVE_EVENT = 'detachEvent';\n      Hamster.PREFIX = 'on';\n    }\n\n  },\n\n  /**\n   * create a normalised event object\n   * @param   {Function}    originalEvent\n   * @returns {Object}      event\n   */\n   event: function normaliseEvent(originalEvent){\n    var event = {\n          // keep a reference to the original event object\n          originalEvent: originalEvent,\n          target: originalEvent.target || originalEvent.srcElement,\n          type: 'wheel',\n          deltaMode: originalEvent.type === 'MozMousePixelScroll' ? 0 : 1,\n          deltaX: 0,\n          delatZ: 0,\n          preventDefault: function(){\n            if (originalEvent.preventDefault) {\n              originalEvent.preventDefault();\n            } else {\n              originalEvent.returnValue = false;\n            }\n          },\n          stopPropagation: function(){\n            if (originalEvent.stopPropagation) {\n              originalEvent.stopPropagation();\n            } else {\n              originalEvent.cancelBubble = false;\n            }\n          }\n        };\n\n    // calculate deltaY (and deltaX) according to the event\n\n    // 'mousewheel'\n    if (originalEvent.wheelDelta) {\n      event.deltaY = - 1/40 * originalEvent.wheelDelta;\n    }\n    // webkit\n    if (originalEvent.wheelDeltaX) {\n      event.deltaX = - 1/40 * originalEvent.wheelDeltaX;\n    }\n\n    // 'DomMouseScroll'\n    if (originalEvent.detail) {\n      event.deltaY = originalEvent.detail;\n    }\n\n    return event;\n  },\n\n  /**\n   * normalise 'deltas' of the mouse wheel\n   * @param   {Function}    originalEvent\n   * @returns {Array}       deltas\n   */\n  delta: function normaliseDelta(originalEvent){\n    var delta = 0,\n      deltaX = 0,\n      deltaY = 0,\n      absDelta = 0,\n      absDeltaXY = 0,\n      fn;\n\n    // normalise deltas according to the event\n\n    // 'wheel' event\n    if (originalEvent.deltaY) {\n      deltaY = originalEvent.deltaY * -1;\n      delta  = deltaY;\n    }\n    if (originalEvent.deltaX) {\n      deltaX = originalEvent.deltaX;\n      delta  = deltaX * -1;\n    }\n\n    // 'mousewheel' event\n    if (originalEvent.wheelDelta) {\n      delta = originalEvent.wheelDelta;\n    }\n    // webkit\n    if (originalEvent.wheelDeltaY) {\n      deltaY = originalEvent.wheelDeltaY;\n    }\n    if (originalEvent.wheelDeltaX) {\n      deltaX = originalEvent.wheelDeltaX * -1;\n    }\n\n    // 'DomMouseScroll' event\n    if (originalEvent.detail) {\n      delta = originalEvent.detail * -1;\n    }\n\n    // look for lowest delta to normalize the delta values\n    absDelta = Math.abs(delta);\n    if (!lowestDelta || absDelta < lowestDelta) {\n      lowestDelta = absDelta;\n    }\n    absDeltaXY = Math.max(Math.abs(deltaY), Math.abs(deltaX));\n    if (!lowestDeltaXY || absDeltaXY < lowestDeltaXY) {\n      lowestDeltaXY = absDeltaXY;\n    }\n\n    // convert deltas to whole numbers\n    fn = delta > 0 ? 'floor' : 'ceil';\n    delta  = Math[fn](delta / lowestDelta);\n    deltaX = Math[fn](deltaX / lowestDeltaXY);\n    deltaY = Math[fn](deltaY / lowestDeltaXY);\n\n    return [delta, deltaX, deltaY];\n  }\n};\n\n// Expose Hamster to the global object\nwindow.Hamster = Hamster;\n\n// requireJS module definition\nif (typeof window.define === 'function' && window.define.amd) {\n  window.define('hamster', [], function(){\n    return Hamster;\n  });\n}\n\n})(window, window.document);\n","var self = self || {}; // File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = {\r\n  REVISION: '71'\r\n};\r\n\r\n// browserify support\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREE;\r\n\r\n}\r\n\r\n// polyfills\r\n\r\nif (Math.sign === undefined) {\r\n\r\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n  Math.sign = function(x) {\r\n\r\n    return (x < 0) ? -1 : (x > 0) ? 1 : +x;\r\n\r\n  };\r\n\r\n}\r\n\r\n\r\n// set the default log handlers\r\nTHREE.log = function() {\r\n  console.log.apply(console, arguments);\r\n}\r\nTHREE.warn = function() {\r\n  console.warn.apply(console, arguments);\r\n}\r\nTHREE.error = function() {\r\n  console.error.apply(console, arguments);\r\n}\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = {\r\n  LEFT: 0,\r\n  MIDDLE: 1,\r\n  RIGHT: 2\r\n};\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.NoShading = 0;\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n//  mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n\r\n// DEPRECATED\r\n\r\nTHREE.Projector = function() {\r\n\r\n  THREE.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.');\r\n\r\n  this.projectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .projectVector() is now vector.project().');\r\n    vector.project(camera);\r\n\r\n  };\r\n\r\n  this.unprojectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .unprojectVector() is now vector.unproject().');\r\n    vector.unproject(camera);\r\n\r\n  };\r\n\r\n  this.pickingRay = function(vector, camera) {\r\n\r\n    THREE.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().');\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CanvasRenderer = function() {\r\n\r\n  THREE.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js');\r\n\r\n  this.domElement = document.createElement('canvas');\r\n  this.clear = function() {};\r\n  this.render = function() {};\r\n  this.setClearColor = function() {};\r\n  this.setSize = function() {};\r\n\r\n};\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function(color) {\r\n\r\n  if (arguments.length === 3) {\r\n\r\n    return this.setRGB(arguments[0], arguments[1], arguments[2]);\r\n\r\n  }\r\n\r\n  return this.set(color)\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n  constructor: THREE.Color,\r\n\r\n  r: 1,\r\n  g: 1,\r\n  b: 1,\r\n\r\n  set: function(value) {\r\n\r\n    if (value instanceof THREE.Color) {\r\n\r\n      this.copy(value);\r\n\r\n    }\r\n    else if (typeof value === 'number') {\r\n\r\n      this.setHex(value);\r\n\r\n    }\r\n    else if (typeof value === 'string') {\r\n\r\n      this.setStyle(value);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHex: function(hex) {\r\n\r\n    hex = Math.floor(hex);\r\n\r\n    this.r = (hex >> 16 & 255) / 255;\r\n    this.g = (hex >> 8 & 255) / 255;\r\n    this.b = (hex & 255) / 255;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRGB: function(r, g, b) {\r\n\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHSL: function(h, s, l) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    if (s === 0) {\r\n\r\n      this.r = this.g = this.b = l;\r\n\r\n    }\r\n    else {\r\n\r\n      var hue2rgb = function(p, q, t) {\r\n\r\n        if (t < 0) t += 1;\r\n        if (t > 1) t -= 1;\r\n        if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n        if (t < 1 / 2) return q;\r\n        if (t < 2 / 3) return p + (q - p) * 6 * (2 / 3 - t);\r\n        return p;\r\n\r\n      };\r\n\r\n      var p = l <= 0.5 ? l * (1 + s) : l + s - (l * s);\r\n      var q = (2 * l) - p;\r\n\r\n      this.r = hue2rgb(q, p, h + 1 / 3);\r\n      this.g = hue2rgb(q, p, h);\r\n      this.b = hue2rgb(q, p, h - 1 / 3);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setStyle: function(style) {\r\n\r\n    // rgb(255,0,0)\r\n\r\n    if (/^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(255, parseInt(color[1], 10)) / 255;\r\n      this.g = Math.min(255, parseInt(color[2], 10)) / 255;\r\n      this.b = Math.min(255, parseInt(color[3], 10)) / 255;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // rgb(100%,0%,0%)\r\n\r\n    if (/^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(100, parseInt(color[1], 10)) / 100;\r\n      this.g = Math.min(100, parseInt(color[2], 10)) / 100;\r\n      this.b = Math.min(100, parseInt(color[3], 10)) / 100;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #ff0000\r\n\r\n    if (/^\\#([0-9a-f]{6})$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f]{6})$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #f00\r\n\r\n    if (/^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1] + color[1] + color[2] + color[2] + color[3] + color[3], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // red\r\n\r\n    if (/^(\\w+)$/i.test(style)) {\r\n\r\n      this.setHex(THREE.ColorKeywords[style]);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n  },\r\n\r\n  copy: function(color) {\r\n\r\n    this.r = color.r;\r\n    this.g = color.g;\r\n    this.b = color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyGammaToLinear: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    this.r = Math.pow(color.r, gammaFactor);\r\n    this.g = Math.pow(color.g, gammaFactor);\r\n    this.b = Math.pow(color.b, gammaFactor);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyLinearToGamma: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    var safeInverse = (gammaFactor > 0) ? (1.0 / gammaFactor) : 1.0;\r\n\r\n    this.r = Math.pow(color.r, safeInverse);\r\n    this.g = Math.pow(color.g, safeInverse);\r\n    this.b = Math.pow(color.b, safeInverse);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertGammaToLinear: function() {\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    this.r = r * r;\r\n    this.g = g * g;\r\n    this.b = b * b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertLinearToGamma: function() {\r\n\r\n    this.r = Math.sqrt(this.r);\r\n    this.g = Math.sqrt(this.g);\r\n    this.b = Math.sqrt(this.b);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getHex: function() {\r\n\r\n    return (this.r * 255) << 16 ^ (this.g * 255) << 8 ^ (this.b * 255) << 0;\r\n\r\n  },\r\n\r\n  getHexString: function() {\r\n\r\n    return ('000000' + this.getHex().toString(16)).slice(-6);\r\n\r\n  },\r\n\r\n  getHSL: function(optionalTarget) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    var hsl = optionalTarget || {\r\n      h: 0,\r\n      s: 0,\r\n      l: 0\r\n    };\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    var max = Math.max(r, g, b);\r\n    var min = Math.min(r, g, b);\r\n\r\n    var hue, saturation;\r\n    var lightness = (min + max) / 2.0;\r\n\r\n    if (min === max) {\r\n\r\n      hue = 0;\r\n      saturation = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      var delta = max - min;\r\n\r\n      saturation = lightness <= 0.5 ? delta / (max + min) : delta / (2 - max - min);\r\n\r\n      switch (max) {\r\n\r\n        case r:\r\n          hue = (g - b) / delta + (g < b ? 6 : 0);\r\n          break;\r\n        case g:\r\n          hue = (b - r) / delta + 2;\r\n          break;\r\n        case b:\r\n          hue = (r - g) / delta + 4;\r\n          break;\r\n\r\n      }\r\n\r\n      hue /= 6;\r\n\r\n    }\r\n\r\n    hsl.h = hue;\r\n    hsl.s = saturation;\r\n    hsl.l = lightness;\r\n\r\n    return hsl;\r\n\r\n  },\r\n\r\n  getStyle: function() {\r\n\r\n    return 'rgb(' + ((this.r * 255) | 0) + ',' + ((this.g * 255) | 0) + ',' + ((this.b * 255) | 0) + ')';\r\n\r\n  },\r\n\r\n  offsetHSL: function(h, s, l) {\r\n\r\n    var hsl = this.getHSL();\r\n\r\n    hsl.h += h;\r\n    hsl.s += s;\r\n    hsl.l += l;\r\n\r\n    this.setHSL(hsl.h, hsl.s, hsl.l);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(color) {\r\n\r\n    this.r += color.r;\r\n    this.g += color.g;\r\n    this.b += color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addColors: function(color1, color2) {\r\n\r\n    this.r = color1.r + color2.r;\r\n    this.g = color1.g + color2.g;\r\n    this.b = color1.b + color2.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.r += s;\r\n    this.g += s;\r\n    this.b += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(color) {\r\n\r\n    this.r *= color.r;\r\n    this.g *= color.g;\r\n    this.b *= color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.r *= s;\r\n    this.g *= s;\r\n    this.b *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(color, alpha) {\r\n\r\n    this.r += (color.r - this.r) * alpha;\r\n    this.g += (color.g - this.g) * alpha;\r\n    this.b += (color.b - this.b) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(c) {\r\n\r\n    return (c.r === this.r) && (c.g === this.g) && (c.b === this.b);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.r = array[0];\r\n    this.g = array[1];\r\n    this.b = array[2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.r;\r\n    array[offset + 1] = this.g;\r\n    array[offset + 2] = this.b;\r\n\r\n    return array;\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Color().setRGB(this.r, this.g, this.b);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = {\r\n  'aliceblue': 0xF0F8FF,\r\n  'antiquewhite': 0xFAEBD7,\r\n  'aqua': 0x00FFFF,\r\n  'aquamarine': 0x7FFFD4,\r\n  'azure': 0xF0FFFF,\r\n  'beige': 0xF5F5DC,\r\n  'bisque': 0xFFE4C4,\r\n  'black': 0x000000,\r\n  'blanchedalmond': 0xFFEBCD,\r\n  'blue': 0x0000FF,\r\n  'blueviolet': 0x8A2BE2,\r\n  'brown': 0xA52A2A,\r\n  'burlywood': 0xDEB887,\r\n  'cadetblue': 0x5F9EA0,\r\n  'chartreuse': 0x7FFF00,\r\n  'chocolate': 0xD2691E,\r\n  'coral': 0xFF7F50,\r\n  'cornflowerblue': 0x6495ED,\r\n  'cornsilk': 0xFFF8DC,\r\n  'crimson': 0xDC143C,\r\n  'cyan': 0x00FFFF,\r\n  'darkblue': 0x00008B,\r\n  'darkcyan': 0x008B8B,\r\n  'darkgoldenrod': 0xB8860B,\r\n  'darkgray': 0xA9A9A9,\r\n  'darkgreen': 0x006400,\r\n  'darkgrey': 0xA9A9A9,\r\n  'darkkhaki': 0xBDB76B,\r\n  'darkmagenta': 0x8B008B,\r\n  'darkolivegreen': 0x556B2F,\r\n  'darkorange': 0xFF8C00,\r\n  'darkorchid': 0x9932CC,\r\n  'darkred': 0x8B0000,\r\n  'darksalmon': 0xE9967A,\r\n  'darkseagreen': 0x8FBC8F,\r\n  'darkslateblue': 0x483D8B,\r\n  'darkslategray': 0x2F4F4F,\r\n  'darkslategrey': 0x2F4F4F,\r\n  'darkturquoise': 0x00CED1,\r\n  'darkviolet': 0x9400D3,\r\n  'deeppink': 0xFF1493,\r\n  'deepskyblue': 0x00BFFF,\r\n  'dimgray': 0x696969,\r\n  'dimgrey': 0x696969,\r\n  'dodgerblue': 0x1E90FF,\r\n  'firebrick': 0xB22222,\r\n  'floralwhite': 0xFFFAF0,\r\n  'forestgreen': 0x228B22,\r\n  'fuchsia': 0xFF00FF,\r\n  'gainsboro': 0xDCDCDC,\r\n  'ghostwhite': 0xF8F8FF,\r\n  'gold': 0xFFD700,\r\n  'goldenrod': 0xDAA520,\r\n  'gray': 0x808080,\r\n  'green': 0x008000,\r\n  'greenyellow': 0xADFF2F,\r\n  'grey': 0x808080,\r\n  'honeydew': 0xF0FFF0,\r\n  'hotpink': 0xFF69B4,\r\n  'indianred': 0xCD5C5C,\r\n  'indigo': 0x4B0082,\r\n  'ivory': 0xFFFFF0,\r\n  'khaki': 0xF0E68C,\r\n  'lavender': 0xE6E6FA,\r\n  'lavenderblush': 0xFFF0F5,\r\n  'lawngreen': 0x7CFC00,\r\n  'lemonchiffon': 0xFFFACD,\r\n  'lightblue': 0xADD8E6,\r\n  'lightcoral': 0xF08080,\r\n  'lightcyan': 0xE0FFFF,\r\n  'lightgoldenrodyellow': 0xFAFAD2,\r\n  'lightgray': 0xD3D3D3,\r\n  'lightgreen': 0x90EE90,\r\n  'lightgrey': 0xD3D3D3,\r\n  'lightpink': 0xFFB6C1,\r\n  'lightsalmon': 0xFFA07A,\r\n  'lightseagreen': 0x20B2AA,\r\n  'lightskyblue': 0x87CEFA,\r\n  'lightslategray': 0x778899,\r\n  'lightslategrey': 0x778899,\r\n  'lightsteelblue': 0xB0C4DE,\r\n  'lightyellow': 0xFFFFE0,\r\n  'lime': 0x00FF00,\r\n  'limegreen': 0x32CD32,\r\n  'linen': 0xFAF0E6,\r\n  'magenta': 0xFF00FF,\r\n  'maroon': 0x800000,\r\n  'mediumaquamarine': 0x66CDAA,\r\n  'mediumblue': 0x0000CD,\r\n  'mediumorchid': 0xBA55D3,\r\n  'mediumpurple': 0x9370DB,\r\n  'mediumseagreen': 0x3CB371,\r\n  'mediumslateblue': 0x7B68EE,\r\n  'mediumspringgreen': 0x00FA9A,\r\n  'mediumturquoise': 0x48D1CC,\r\n  'mediumvioletred': 0xC71585,\r\n  'midnightblue': 0x191970,\r\n  'mintcream': 0xF5FFFA,\r\n  'mistyrose': 0xFFE4E1,\r\n  'moccasin': 0xFFE4B5,\r\n  'navajowhite': 0xFFDEAD,\r\n  'navy': 0x000080,\r\n  'oldlace': 0xFDF5E6,\r\n  'olive': 0x808000,\r\n  'olivedrab': 0x6B8E23,\r\n  'orange': 0xFFA500,\r\n  'orangered': 0xFF4500,\r\n  'orchid': 0xDA70D6,\r\n  'palegoldenrod': 0xEEE8AA,\r\n  'palegreen': 0x98FB98,\r\n  'paleturquoise': 0xAFEEEE,\r\n  'palevioletred': 0xDB7093,\r\n  'papayawhip': 0xFFEFD5,\r\n  'peachpuff': 0xFFDAB9,\r\n  'peru': 0xCD853F,\r\n  'pink': 0xFFC0CB,\r\n  'plum': 0xDDA0DD,\r\n  'powderblue': 0xB0E0E6,\r\n  'purple': 0x800080,\r\n  'red': 0xFF0000,\r\n  'rosybrown': 0xBC8F8F,\r\n  'royalblue': 0x4169E1,\r\n  'saddlebrown': 0x8B4513,\r\n  'salmon': 0xFA8072,\r\n  'sandybrown': 0xF4A460,\r\n  'seagreen': 0x2E8B57,\r\n  'seashell': 0xFFF5EE,\r\n  'sienna': 0xA0522D,\r\n  'silver': 0xC0C0C0,\r\n  'skyblue': 0x87CEEB,\r\n  'slateblue': 0x6A5ACD,\r\n  'slategray': 0x708090,\r\n  'slategrey': 0x708090,\r\n  'snow': 0xFFFAFA,\r\n  'springgreen': 0x00FF7F,\r\n  'steelblue': 0x4682B4,\r\n  'tan': 0xD2B48C,\r\n  'teal': 0x008080,\r\n  'thistle': 0xD8BFD8,\r\n  'tomato': 0xFF6347,\r\n  'turquoise': 0x40E0D0,\r\n  'violet': 0xEE82EE,\r\n  'wheat': 0xF5DEB3,\r\n  'white': 0xFFFFFF,\r\n  'whitesmoke': 0xF5F5F5,\r\n  'yellow': 0xFFFF00,\r\n  'yellowgreen': 0x9ACD32\r\n};\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Quaternion = function(x, y, z, w) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n  constructor: THREE.Quaternion,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _w: 0,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get w() {\r\n\r\n    return this._w;\r\n\r\n  },\r\n\r\n  set w(value) {\r\n\r\n    this._w = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._w = w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(quaternion) {\r\n\r\n    this._x = quaternion.x;\r\n    this._y = quaternion.y;\r\n    this._z = quaternion.z;\r\n    this._w = quaternion.w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromEuler: function(euler, update) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      throw new Error('THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n    }\r\n\r\n    // http://www.mathworks.com/matlabcentral/fileexchange/\r\n    // \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n    //\tcontent/SpinCalc.m\r\n\r\n    var c1 = Math.cos(euler._x / 2);\r\n    var c2 = Math.cos(euler._y / 2);\r\n    var c3 = Math.cos(euler._z / 2);\r\n    var s1 = Math.sin(euler._x / 2);\r\n    var s2 = Math.sin(euler._y / 2);\r\n    var s3 = Math.sin(euler._z / 2);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromAxisAngle: function(axis, angle) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n    // assumes axis is normalized\r\n\r\n    var halfAngle = angle / 2,\r\n      s = Math.sin(halfAngle);\r\n\r\n    this._x = axis.x * s;\r\n    this._y = axis.y * s;\r\n    this._z = axis.z * s;\r\n    this._w = Math.cos(halfAngle);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10],\r\n\r\n      trace = m11 + m22 + m33,\r\n      s;\r\n\r\n    if (trace > 0) {\r\n\r\n      s = 0.5 / Math.sqrt(trace + 1.0);\r\n\r\n      this._w = 0.25 / s;\r\n      this._x = (m32 - m23) * s;\r\n      this._y = (m13 - m31) * s;\r\n      this._z = (m21 - m12) * s;\r\n\r\n    }\r\n    else if (m11 > m22 && m11 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\r\n\r\n      this._w = (m32 - m23) / s;\r\n      this._x = 0.25 * s;\r\n      this._y = (m12 + m21) / s;\r\n      this._z = (m13 + m31) / s;\r\n\r\n    }\r\n    else if (m22 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\r\n\r\n      this._w = (m13 - m31) / s;\r\n      this._x = (m12 + m21) / s;\r\n      this._y = 0.25 * s;\r\n      this._z = (m23 + m32) / s;\r\n\r\n    }\r\n    else {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\r\n\r\n      this._w = (m21 - m12) / s;\r\n      this._x = (m13 + m31) / s;\r\n      this._y = (m23 + m32) / s;\r\n      this._z = 0.25 * s;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromUnitVectors: function() {\r\n\r\n    // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n    // assumes direction vectors vFrom and vTo are normalized\r\n\r\n    var v1, r;\r\n\r\n    var EPS = 0.000001;\r\n\r\n    return function(vFrom, vTo) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      r = vFrom.dot(vTo) + 1;\r\n\r\n      if (r < EPS) {\r\n\r\n        r = 0;\r\n\r\n        if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\r\n\r\n          v1.set(-vFrom.y, vFrom.x, 0);\r\n\r\n        }\r\n        else {\r\n\r\n          v1.set(0, -vFrom.z, vFrom.y);\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        v1.crossVectors(vFrom, vTo);\r\n\r\n      }\r\n\r\n      this._x = v1.x;\r\n      this._y = v1.y;\r\n      this._z = v1.z;\r\n      this._w = r;\r\n\r\n      this.normalize();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  inverse: function() {\r\n\r\n    this.conjugate().normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  conjugate: function() {\r\n\r\n    this._x *= -1;\r\n    this._y *= -1;\r\n    this._z *= -1;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    var l = this.length();\r\n\r\n    if (l === 0) {\r\n\r\n      this._x = 0;\r\n      this._y = 0;\r\n      this._z = 0;\r\n      this._w = 1;\r\n\r\n    }\r\n    else {\r\n\r\n      l = 1 / l;\r\n\r\n      this._x = this._x * l;\r\n      this._y = this._y * l;\r\n      this._z = this._z * l;\r\n      this._w = this._w * l;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(q, p) {\r\n\r\n    if (p !== undefined) {\r\n\r\n      THREE.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.');\r\n      return this.multiplyQuaternions(q, p);\r\n\r\n    }\r\n\r\n    return this.multiplyQuaternions(this, q);\r\n\r\n  },\r\n\r\n  multiplyQuaternions: function(a, b) {\r\n\r\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n    var qax = a._x,\r\n      qay = a._y,\r\n      qaz = a._z,\r\n      qaw = a._w;\r\n    var qbx = b._x,\r\n      qby = b._y,\r\n      qbz = b._z,\r\n      qbw = b._w;\r\n\r\n    this._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n    this._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n    this._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n    this._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.');\r\n    return vector.applyQuaternion(this);\r\n\r\n  },\r\n\r\n  slerp: function(qb, t) {\r\n\r\n    if (t === 0) return this;\r\n    if (t === 1) return this.copy(qb);\r\n\r\n    var x = this._x,\r\n      y = this._y,\r\n      z = this._z,\r\n      w = this._w;\r\n\r\n    // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n    var cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n    if (cosHalfTheta < 0) {\r\n\r\n      this._w = -qb._w;\r\n      this._x = -qb._x;\r\n      this._y = -qb._y;\r\n      this._z = -qb._z;\r\n\r\n      cosHalfTheta = -cosHalfTheta;\r\n\r\n    }\r\n    else {\r\n\r\n      this.copy(qb);\r\n\r\n    }\r\n\r\n    if (cosHalfTheta >= 1.0) {\r\n\r\n      this._w = w;\r\n      this._x = x;\r\n      this._y = y;\r\n      this._z = z;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var halfTheta = Math.acos(cosHalfTheta);\r\n    var sinHalfTheta = Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);\r\n\r\n    if (Math.abs(sinHalfTheta) < 0.001) {\r\n\r\n      this._w = 0.5 * (w + this._w);\r\n      this._x = 0.5 * (x + this._x);\r\n      this._y = 0.5 * (y + this._y);\r\n      this._z = 0.5 * (z + this._z);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\r\n      ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n    this._w = (w * ratioA + this._w * ratioB);\r\n    this._x = (x * ratioA + this._x * ratioB);\r\n    this._y = (y * ratioA + this._y * ratioB);\r\n    this._z = (z * ratioA + this._z * ratioB);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(quaternion) {\r\n\r\n    return (quaternion._x === this._x) && (quaternion._y === this._y) && (quaternion._z === this._z) && (quaternion._w === this._w);\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this._x = array[offset];\r\n    this._y = array[offset + 1];\r\n    this._z = array[offset + 2];\r\n    this._w = array[offset + 3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Quaternion(this._x, this._y, this._z, this._w);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Quaternion.slerp = function(qa, qb, qm, t) {\r\n\r\n  return qm.copy(qa).slerp(qb, t);\r\n\r\n}\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function(x, y) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n  constructor: THREE.Vector2,\r\n\r\n  set: function(x, y) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v) {\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.x *= s;\r\n    this.y *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector2();\r\n        max = new THREE.Vector2();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal);\r\n      max.set(maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x,\r\n      dy = this.y - v.y;\r\n    return dx * dx + dy * dy;\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector2(this.x, this.y);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function(x, y, z) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n  constructor: THREE.Vector3,\r\n\r\n  set: function(x, y, z) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.');\r\n      return this.multiplyVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n    this.z *= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVectors: function(a, b) {\r\n\r\n    this.x = a.x * b.x;\r\n    this.y = a.y * b.y;\r\n    this.z = a.z * b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyEuler: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(euler) {\r\n\r\n      if (euler instanceof THREE.Euler === false) {\r\n\r\n        THREE.error('THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n      }\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromEuler(euler));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyAxisAngle: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(axis, angle) {\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromAxisAngle(axis, angle));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix3: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[3] * y + e[6] * z;\r\n    this.y = e[1] * x + e[4] * y + e[7] * z;\r\n    this.z = e[2] * x + e[5] * y + e[8] * z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12];\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13];\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyProjection: function(m) {\r\n\r\n    // input: THREE.Matrix4 projection matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n    var d = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]); // perspective divide\r\n\r\n    this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * d;\r\n    this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * d;\r\n    this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * d;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyQuaternion: function(q) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var qx = q.x;\r\n    var qy = q.y;\r\n    var qz = q.z;\r\n    var qw = q.w;\r\n\r\n    // calculate quat * vector\r\n\r\n    var ix = qw * x + qy * z - qz * y;\r\n    var iy = qw * y + qz * x - qx * z;\r\n    var iz = qw * z + qx * y - qy * x;\r\n    var iw = -qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n\r\n    this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n    this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n    this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  project: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.projectionMatrix, matrix.getInverse(camera.matrixWorld));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  unproject: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.matrixWorld, matrix.getInverse(camera.projectionMatrix));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  transformDirection: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n    // vector interpreted as a direction\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z;\r\n\r\n    this.normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n    this.z /= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector3();\r\n        max = new THREE.Vector3();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  cross: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.');\r\n      return this.crossVectors(v, w);\r\n\r\n    }\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    this.x = y * v.z - z * v.y;\r\n    this.y = z * v.x - x * v.z;\r\n    this.z = x * v.y - y * v.x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  crossVectors: function(a, b) {\r\n\r\n    var ax = a.x,\r\n      ay = a.y,\r\n      az = a.z;\r\n    var bx = b.x,\r\n      by = b.y,\r\n      bz = b.z;\r\n\r\n    this.x = ay * bz - az * by;\r\n    this.y = az * bx - ax * bz;\r\n    this.z = ax * by - ay * bx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  projectOnVector: function() {\r\n\r\n    var v1, dot;\r\n\r\n    return function(vector) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(vector).normalize();\r\n\r\n      dot = this.dot(v1);\r\n\r\n      return this.copy(v1).multiplyScalar(dot);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  projectOnPlane: function() {\r\n\r\n    var v1;\r\n\r\n    return function(planeNormal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(this).projectOnVector(planeNormal);\r\n\r\n      return this.sub(v1);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  reflect: function() {\r\n\r\n    // reflect incident vector off plane orthogonal to normal\r\n    // normal is assumed to have unit length\r\n\r\n    var v1;\r\n\r\n    return function(normal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      return this.sub(v1.copy(normal).multiplyScalar(2 * this.dot(normal)));\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  angleTo: function(v) {\r\n\r\n    var theta = this.dot(v) / (this.length() * v.length());\r\n\r\n    // clamp, to handle numerical problems\r\n\r\n    return Math.acos(THREE.Math.clamp(theta, -1, 1));\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x;\r\n    var dy = this.y - v.y;\r\n    var dz = this.z - v.z;\r\n\r\n    return dx * dx + dy * dy + dz * dz;\r\n\r\n  },\r\n\r\n  setEulerFromRotationMatrix: function(m, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.');\r\n\r\n  },\r\n\r\n  setEulerFromQuaternion: function(q, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.');\r\n\r\n  },\r\n\r\n  getPositionFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().');\r\n\r\n    return this.setFromMatrixPosition(m);\r\n\r\n  },\r\n\r\n  getScaleFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().');\r\n\r\n    return this.setFromMatrixScale(m);\r\n  },\r\n\r\n  getColumnFromMatrix: function(index, matrix) {\r\n\r\n    THREE.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().');\r\n\r\n    return this.setFromMatrixColumn(index, matrix);\r\n\r\n  },\r\n\r\n  setFromMatrixPosition: function(m) {\r\n\r\n    this.x = m.elements[12];\r\n    this.y = m.elements[13];\r\n    this.z = m.elements[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrixScale: function(m) {\r\n\r\n    var sx = this.set(m.elements[0], m.elements[1], m.elements[2]).length();\r\n    var sy = this.set(m.elements[4], m.elements[5], m.elements[6]).length();\r\n    var sz = this.set(m.elements[8], m.elements[9], m.elements[10]).length();\r\n\r\n    this.x = sx;\r\n    this.y = sy;\r\n    this.z = sz;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromMatrixColumn: function(index, matrix) {\r\n\r\n    var offset = index * 4;\r\n\r\n    var me = matrix.elements;\r\n\r\n    this.x = me[offset];\r\n    this.y = me[offset + 1];\r\n    this.z = me[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector3(this.x, this.y, this.z);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function(x, y, z, w) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n  this.w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n  constructor: THREE.Vector4,\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setW: function(w) {\r\n\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      case 3:\r\n        this.w = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      case 3:\r\n        return this.w;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n    this.w = (v.w !== undefined) ? v.w : 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n    this.w += v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n    this.w += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n    this.w = a.w + b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n    this.w -= v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n    this.w -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n    this.w = a.w - b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n    this.w *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n    var w = this.w;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12] * w;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13] * w;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14] * w;\r\n    this.w = e[3] * x + e[7] * y + e[11] * z + e[15] * w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n      this.w *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n      this.w = 1;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromQuaternion: function(q) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n    // q is assumed to be normalized\r\n\r\n    this.w = 2 * Math.acos(q.w);\r\n\r\n    var s = Math.sqrt(1 - q.w * q.w);\r\n\r\n    if (s < 0.0001) {\r\n\r\n      this.x = 1;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = q.x / s;\r\n      this.y = q.y / s;\r\n      this.z = q.z / s;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var angle, x, y, z, // variables for result\r\n      epsilon = 0.01, // margin to allow for rounding errors\r\n      epsilon2 = 0.1, // margin to distinguish between 0 and 180 degrees\r\n\r\n      te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    if ((Math.abs(m12 - m21) < epsilon) && (Math.abs(m13 - m31) < epsilon) && (Math.abs(m23 - m32) < epsilon)) {\r\n\r\n      // singularity found\r\n      // first check for identity matrix which must have +1 for all terms\r\n      // in leading diagonal and zero in other terms\r\n\r\n      if ((Math.abs(m12 + m21) < epsilon2) && (Math.abs(m13 + m31) < epsilon2) && (Math.abs(m23 + m32) < epsilon2) && (Math.abs(m11 + m22 + m33 - 3) < epsilon2)) {\r\n\r\n        // this singularity is identity matrix so angle = 0\r\n\r\n        this.set(1, 0, 0, 0);\r\n\r\n        return this; // zero angle, arbitrary axis\r\n\r\n      }\r\n\r\n      // otherwise this singularity is angle = 180\r\n\r\n      angle = Math.PI;\r\n\r\n      var xx = (m11 + 1) / 2;\r\n      var yy = (m22 + 1) / 2;\r\n      var zz = (m33 + 1) / 2;\r\n      var xy = (m12 + m21) / 4;\r\n      var xz = (m13 + m31) / 4;\r\n      var yz = (m23 + m32) / 4;\r\n\r\n      if ((xx > yy) && (xx > zz)) { // m11 is the largest diagonal term\r\n\r\n        if (xx < epsilon) {\r\n\r\n          x = 0;\r\n          y = 0.707106781;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          x = Math.sqrt(xx);\r\n          y = xy / x;\r\n          z = xz / x;\r\n\r\n        }\r\n\r\n      }\r\n      else if (yy > zz) { // m22 is the largest diagonal term\r\n\r\n        if (yy < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          y = Math.sqrt(yy);\r\n          x = xy / y;\r\n          z = yz / y;\r\n\r\n        }\r\n\r\n      }\r\n      else { // m33 is the largest diagonal term so base result on this\r\n\r\n        if (zz < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0.707106781;\r\n          z = 0;\r\n\r\n        }\r\n        else {\r\n\r\n          z = Math.sqrt(zz);\r\n          x = xz / z;\r\n          y = yz / z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.set(x, y, z, angle);\r\n\r\n      return this; // return 180 deg rotation\r\n\r\n    }\r\n\r\n    // as we have reached here there are no singularities so we can handle normally\r\n\r\n    var s = Math.sqrt((m32 - m23) * (m32 - m23) + (m13 - m31) * (m13 - m31) + (m21 - m12) * (m21 - m12)); // used to normalize\r\n\r\n    if (Math.abs(s) < 0.001) s = 1;\r\n\r\n    // prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n    // caught by singularity test above, but I've left it in just in case\r\n\r\n    this.x = (m32 - m23) / s;\r\n    this.y = (m13 - m31) / s;\r\n    this.z = (m21 - m12) / s;\r\n    this.w = Math.acos((m11 + m22 + m33 - 1) / 2);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w > v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w < v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    if (this.w < min.w) {\r\n\r\n      this.w = min.w;\r\n\r\n    }\r\n    else if (this.w > max.w) {\r\n\r\n      this.w = max.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector4();\r\n        max = new THREE.Vector4();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n    this.w = Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n    this.w = Math.ceil(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n    this.w = Math.round(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n    this.w = (this.w < 0) ? Math.ceil(this.w) : Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n    this.w = -this.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n    this.w += (v.w - this.w) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z) && (v.w === this.w));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n    this.w = array[offset + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n    array[offset + 3] = this.w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n    this.w = attribute.array[index + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector4(this.x, this.y, this.z, this.w);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Euler = function(x, y, z, order) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n  constructor: THREE.Euler,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _order: THREE.Euler.DefaultOrder,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get order() {\r\n\r\n    return this._order;\r\n\r\n  },\r\n\r\n  set order(value) {\r\n\r\n    this._order = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, order) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._order = order || this._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(euler) {\r\n\r\n    this._x = euler._x;\r\n    this._y = euler._y;\r\n    this._z = euler._z;\r\n    this._order = euler._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m, order, update) {\r\n\r\n    var clamp = THREE.Math.clamp;\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements;\r\n    var m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8];\r\n    var m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9];\r\n    var m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    order = order || this._order;\r\n\r\n    if (order === 'XYZ') {\r\n\r\n      this._y = Math.asin(clamp(m13, -1, 1));\r\n\r\n      if (Math.abs(m13) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._z = Math.atan2(-m12, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YXZ') {\r\n\r\n      this._x = Math.asin(-clamp(m23, -1, 1));\r\n\r\n      if (Math.abs(m23) < 0.99999) {\r\n\r\n        this._y = Math.atan2(m13, m33);\r\n        this._z = Math.atan2(m21, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = Math.atan2(-m31, m11);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZXY') {\r\n\r\n      this._x = Math.asin(clamp(m32, -1, 1));\r\n\r\n      if (Math.abs(m32) < 0.99999) {\r\n\r\n        this._y = Math.atan2(-m31, m33);\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = 0;\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZYX') {\r\n\r\n      this._y = Math.asin(-clamp(m31, -1, 1));\r\n\r\n      if (Math.abs(m31) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m33);\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YZX') {\r\n\r\n      this._z = Math.asin(clamp(m21, -1, 1));\r\n\r\n      if (Math.abs(m21) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m22);\r\n        this._y = Math.atan2(-m31, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._y = Math.atan2(m13, m33);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'XZY') {\r\n\r\n      this._z = Math.asin(-clamp(m12, -1, 1));\r\n\r\n      if (Math.abs(m12) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._y = Math.atan2(m13, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._y = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order)\r\n\r\n    }\r\n\r\n    this._order = order;\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromQuaternion: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(q, order, update) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n      matrix.makeRotationFromQuaternion(q);\r\n      this.setFromRotationMatrix(matrix, order, update);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromVector3: function(v, order) {\r\n\r\n    return this.set(v.x, v.y, v.z, order || this._order);\r\n\r\n  },\r\n\r\n  reorder: function() {\r\n\r\n    // WARNING: this discards revolution information -bhouston\r\n\r\n    var q = new THREE.Quaternion();\r\n\r\n    return function(newOrder) {\r\n\r\n      q.setFromEuler(this);\r\n      this.setFromQuaternion(q, newOrder);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  equals: function(euler) {\r\n\r\n    return (euler._x === this._x) && (euler._y === this._y) && (euler._z === this._z) && (euler._order === this._order);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this._x = array[0];\r\n    this._y = array[1];\r\n    this._z = array[2];\r\n    if (array[3] !== undefined) this._order = array[3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._order;\r\n\r\n    return array;\r\n  },\r\n\r\n  toVector3: function(optionalResult) {\r\n\r\n    if (optionalResult) {\r\n\r\n      return optionalResult.set(this._x, this._y, this._z);\r\n\r\n    }\r\n    else {\r\n\r\n      return new THREE.Vector3(this._x, this._y, this._z);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Euler(this._x, this._y, this._z, this._order);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Line3 = function(start, end) {\r\n\r\n  this.start = (start !== undefined) ? start : new THREE.Vector3();\r\n  this.end = (end !== undefined) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n  constructor: THREE.Line3,\r\n\r\n  set: function(start, end) {\r\n\r\n    this.start.copy(start);\r\n    this.end.copy(end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(line) {\r\n\r\n    this.start.copy(line.start);\r\n    this.end.copy(line.end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.start, this.end).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  delta: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.end, this.start);\r\n\r\n  },\r\n\r\n  distanceSq: function() {\r\n\r\n    return this.start.distanceToSquared(this.end);\r\n\r\n  },\r\n\r\n  distance: function() {\r\n\r\n    return this.start.distanceTo(this.end);\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  closestPointToPointParameter: function() {\r\n\r\n    var startP = new THREE.Vector3();\r\n    var startEnd = new THREE.Vector3();\r\n\r\n    return function(point, clampToLine) {\r\n\r\n      startP.subVectors(point, this.start);\r\n      startEnd.subVectors(this.end, this.start);\r\n\r\n      var startEnd2 = startEnd.dot(startEnd);\r\n      var startEnd_startP = startEnd.dot(startP);\r\n\r\n      var t = startEnd_startP / startEnd2;\r\n\r\n      if (clampToLine) {\r\n\r\n        t = THREE.Math.clamp(t, 0, 1);\r\n\r\n      }\r\n\r\n      return t;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, clampToLine, optionalTarget) {\r\n\r\n    var t = this.closestPointToPointParameter(point, clampToLine);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.start.applyMatrix4(matrix);\r\n    this.end.applyMatrix4(matrix);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(line) {\r\n\r\n    return line.start.equals(this.start) && line.end.equals(this.end);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Line3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Box2 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector2(Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector2(-Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n  constructor: THREE.Box2,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = Infinity;\r\n    this.max.x = this.max.y = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box2().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector3(Infinity, Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector3(-Infinity, -Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n  constructor: THREE.Box3,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromObject: function() {\r\n\r\n    // Computes the world-axis-aligned bounding box of an object (including its children),\r\n    // accounting for both the object's, and childrens', world transforms\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(object) {\r\n\r\n      var scope = this;\r\n\r\n      object.updateMatrixWorld(true);\r\n\r\n      this.makeEmpty();\r\n\r\n      object.traverse(function(node) {\r\n\r\n        var geometry = node.geometry;\r\n\r\n        if (geometry !== undefined) {\r\n\r\n          if (geometry instanceof THREE.Geometry) {\r\n\r\n            var vertices = geometry.vertices;\r\n\r\n            for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n              v1.copy(vertices[i]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n          else if (geometry instanceof THREE.BufferGeometry && geometry.attributes['position'] !== undefined) {\r\n\r\n            var positions = geometry.attributes['position'].array;\r\n\r\n            for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n              v1.set(positions[i], positions[i + 1], positions[i + 2]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      });\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = this.min.z = Infinity;\r\n    this.max.x = this.max.y = this.max.z = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y) || (this.max.z < this.min.z);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y ||\r\n      point.z < this.min.z || point.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y) &&\r\n      (this.min.z <= box.min.z) && (box.max.z <= this.max.z)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y), (point.z - this.min.z) / (this.max.z - this.min.z)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y ||\r\n      box.max.z < this.min.z || box.min.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  getBoundingSphere: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Sphere();\r\n\r\n      result.center = this.center();\r\n      result.radius = this.size(v1).length() * 0.5;\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var points = [\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3()\r\n    ];\r\n\r\n    return function(matrix) {\r\n\r\n      // NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n      points[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(matrix); // 000\r\n      points[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(matrix); // 001\r\n      points[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(matrix); // 010\r\n      points[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(matrix); // 011\r\n      points[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(matrix); // 100\r\n      points[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(matrix); // 101\r\n      points[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(matrix); // 110\r\n      points[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(matrix); // 111\r\n\r\n      this.makeEmpty();\r\n      this.setFromPoints(points);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Matrix3 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0,\r\n    0, 1, 0,\r\n    0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n  constructor: THREE.Matrix3,\r\n\r\n  set: function(n11, n12, n13, n21, n22, n23, n31, n32, n33) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[3] = n12;\r\n    te[6] = n13;\r\n    te[1] = n21;\r\n    te[4] = n22;\r\n    te[7] = n23;\r\n    te[2] = n31;\r\n    te[5] = n32;\r\n    te[8] = n33;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0,\r\n      0, 1, 0,\r\n      0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    var me = m.elements;\r\n\r\n    this.set(\r\n\r\n      me[0], me[3], me[6],\r\n      me[1], me[4], me[7],\r\n      me[2], me[5], me[8]\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.');\r\n    return vector.applyMatrix3(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix3(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[3] *= s;\r\n    te[6] *= s;\r\n    te[1] *= s;\r\n    te[4] *= s;\r\n    te[7] *= s;\r\n    te[2] *= s;\r\n    te[5] *= s;\r\n    te[8] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var a = te[0],\r\n      b = te[1],\r\n      c = te[2],\r\n      d = te[3],\r\n      e = te[4],\r\n      f = te[5],\r\n      g = te[6],\r\n      h = te[7],\r\n      i = te[8];\r\n\r\n    return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n  },\r\n\r\n  getInverse: function(matrix, throwOnInvertible) {\r\n\r\n    // input: THREE.Matrix4\r\n    // ( based on http://code.google.com/p/webgl-mjs/ )\r\n\r\n    var me = matrix.elements;\r\n    var te = this.elements;\r\n\r\n    te[0] = me[10] * me[5] - me[6] * me[9];\r\n    te[1] = -me[10] * me[1] + me[2] * me[9];\r\n    te[2] = me[6] * me[1] - me[2] * me[5];\r\n    te[3] = -me[10] * me[4] + me[6] * me[8];\r\n    te[4] = me[10] * me[0] - me[2] * me[8];\r\n    te[5] = -me[6] * me[0] + me[2] * me[4];\r\n    te[6] = me[9] * me[4] - me[5] * me[8];\r\n    te[7] = -me[9] * me[0] + me[1] * me[8];\r\n    te[8] = me[5] * me[0] - me[1] * me[4];\r\n\r\n    var det = me[0] * te[0] + me[1] * te[3] + me[2] * te[6];\r\n\r\n    // no inverse\r\n\r\n    if (det === 0) {\r\n\r\n      var msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    this.multiplyScalar(1.0 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var tmp, m = this.elements;\r\n\r\n    tmp = m[1];\r\n    m[1] = m[3];\r\n    m[3] = tmp;\r\n    tmp = m[2];\r\n    m[2] = m[6];\r\n    m[6] = tmp;\r\n    tmp = m[5];\r\n    m[5] = m[7];\r\n    m[7] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n\r\n    array[offset + 3] = te[3];\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n    array[offset + 8] = te[8];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getNormalMatrix: function(m) {\r\n\r\n    // input: THREE.Matrix4\r\n\r\n    this.getInverse(m).transpose();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transposeIntoArray: function(r) {\r\n\r\n    var m = this.elements;\r\n\r\n    r[0] = m[0];\r\n    r[1] = m[3];\r\n    r[2] = m[6];\r\n    r[3] = m[1];\r\n    r[4] = m[4];\r\n    r[5] = m[7];\r\n    r[6] = m[2];\r\n    r[7] = m[5];\r\n    r[8] = m[8];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2],\r\n      te[3], te[4], te[5],\r\n      te[6], te[7], te[8]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix3().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n  constructor: THREE.Matrix4,\r\n\r\n  set: function(n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[4] = n12;\r\n    te[8] = n13;\r\n    te[12] = n14;\r\n    te[1] = n21;\r\n    te[5] = n22;\r\n    te[9] = n23;\r\n    te[13] = n24;\r\n    te[2] = n31;\r\n    te[6] = n32;\r\n    te[10] = n33;\r\n    te[14] = n34;\r\n    te[3] = n41;\r\n    te[7] = n42;\r\n    te[11] = n43;\r\n    te[15] = n44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, 1, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    this.elements.set(m.elements);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractPosition: function(m) {\r\n\r\n    THREE.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().');\r\n    return this.copyPosition(m);\r\n\r\n  },\r\n\r\n  copyPosition: function(m) {\r\n\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    te[12] = me[12];\r\n    te[13] = me[13];\r\n    te[14] = me[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    var te = this.elements;\r\n\r\n    xAxis.set(te[0], te[1], te[2]);\r\n    yAxis.set(te[4], te[5], te[6]);\r\n    zAxis.set(te[8], te[9], te[10]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    this.set(\r\n      xAxis.x, yAxis.x, zAxis.x, 0,\r\n      xAxis.y, yAxis.y, zAxis.y, 0,\r\n      xAxis.z, yAxis.z, zAxis.z, 0,\r\n      0, 0, 0, 1\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractRotation: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(m) {\r\n\r\n      var te = this.elements;\r\n      var me = m.elements;\r\n\r\n      var scaleX = 1 / v1.set(me[0], me[1], me[2]).length();\r\n      var scaleY = 1 / v1.set(me[4], me[5], me[6]).length();\r\n      var scaleZ = 1 / v1.set(me[8], me[9], me[10]).length();\r\n\r\n      te[0] = me[0] * scaleX;\r\n      te[1] = me[1] * scaleX;\r\n      te[2] = me[2] * scaleX;\r\n\r\n      te[4] = me[4] * scaleY;\r\n      te[5] = me[5] * scaleY;\r\n      te[6] = me[6] * scaleY;\r\n\r\n      te[8] = me[8] * scaleZ;\r\n      te[9] = me[9] * scaleZ;\r\n      te[10] = me[10] * scaleZ;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeRotationFromEuler: function(euler) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      THREE.error('THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n    }\r\n\r\n    var te = this.elements;\r\n\r\n    var x = euler.x,\r\n      y = euler.y,\r\n      z = euler.z;\r\n    var a = Math.cos(x),\r\n      b = Math.sin(x);\r\n    var c = Math.cos(y),\r\n      d = Math.sin(y);\r\n    var e = Math.cos(z),\r\n      f = Math.sin(z);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -c * f;\r\n      te[8] = d;\r\n\r\n      te[1] = af + be * d;\r\n      te[5] = ae - bf * d;\r\n      te[9] = -b * c;\r\n\r\n      te[2] = bf - ae * d;\r\n      te[6] = be + af * d;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce + df * b;\r\n      te[4] = de * b - cf;\r\n      te[8] = a * d;\r\n\r\n      te[1] = a * f;\r\n      te[5] = a * e;\r\n      te[9] = -b;\r\n\r\n      te[2] = cf * b - de;\r\n      te[6] = df + ce * b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce - df * b;\r\n      te[4] = -a * f;\r\n      te[8] = de + cf * b;\r\n\r\n      te[1] = cf + de * b;\r\n      te[5] = a * e;\r\n      te[9] = df - ce * b;\r\n\r\n      te[2] = -a * d;\r\n      te[6] = b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = be * d - af;\r\n      te[8] = ae * d + bf;\r\n\r\n      te[1] = c * f;\r\n      te[5] = bf * d + ae;\r\n      te[9] = af * d - be;\r\n\r\n      te[2] = -d;\r\n      te[6] = b * c;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = bd - ac * f;\r\n      te[8] = bc * f + ad;\r\n\r\n      te[1] = f;\r\n      te[5] = a * e;\r\n      te[9] = -b * e;\r\n\r\n      te[2] = -d * e;\r\n      te[6] = ad * f + bc;\r\n      te[10] = ac - bd * f;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -f;\r\n      te[8] = d * e;\r\n\r\n      te[1] = ac * f + bd;\r\n      te[5] = a * e;\r\n      te[9] = ad * f - bc;\r\n\r\n      te[2] = bc * f - ad;\r\n      te[6] = b * e;\r\n      te[10] = bd * f + ac;\r\n\r\n    }\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    THREE.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().');\r\n\r\n    return this.makeRotationFromQuaternion(q);\r\n\r\n  },\r\n\r\n  makeRotationFromQuaternion: function(q) {\r\n\r\n    var te = this.elements;\r\n\r\n    var x = q.x,\r\n      y = q.y,\r\n      z = q.z,\r\n      w = q.w;\r\n    var x2 = x + x,\r\n      y2 = y + y,\r\n      z2 = z + z;\r\n    var xx = x * x2,\r\n      xy = x * y2,\r\n      xz = x * z2;\r\n    var yy = y * y2,\r\n      yz = y * z2,\r\n      zz = z * z2;\r\n    var wx = w * x2,\r\n      wy = w * y2,\r\n      wz = w * z2;\r\n\r\n    te[0] = 1 - (yy + zz);\r\n    te[4] = xy - wz;\r\n    te[8] = xz + wy;\r\n\r\n    te[1] = xy + wz;\r\n    te[5] = 1 - (xx + zz);\r\n    te[9] = yz - wx;\r\n\r\n    te[2] = xz - wy;\r\n    te[6] = yz + wx;\r\n    te[10] = 1 - (xx + yy);\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lookAt: function() {\r\n\r\n    var x = new THREE.Vector3();\r\n    var y = new THREE.Vector3();\r\n    var z = new THREE.Vector3();\r\n\r\n    return function(eye, target, up) {\r\n\r\n      var te = this.elements;\r\n\r\n      z.subVectors(eye, target).normalize();\r\n\r\n      if (z.length() === 0) {\r\n\r\n        z.z = 1;\r\n\r\n      }\r\n\r\n      x.crossVectors(up, z).normalize();\r\n\r\n      if (x.length() === 0) {\r\n\r\n        z.x += 0.0001;\r\n        x.crossVectors(up, z).normalize();\r\n\r\n      }\r\n\r\n      y.crossVectors(z, x);\r\n\r\n\r\n      te[0] = x.x;\r\n      te[4] = y.x;\r\n      te[8] = z.x;\r\n      te[1] = x.y;\r\n      te[5] = y.y;\r\n      te[9] = z.y;\r\n      te[2] = x.z;\r\n      te[6] = y.z;\r\n      te[10] = z.z;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiply: function(m, n) {\r\n\r\n    if (n !== undefined) {\r\n\r\n      THREE.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.');\r\n      return this.multiplyMatrices(m, n);\r\n\r\n    }\r\n\r\n    return this.multiplyMatrices(this, m);\r\n\r\n  },\r\n\r\n  multiplyMatrices: function(a, b) {\r\n\r\n    var ae = a.elements;\r\n    var be = b.elements;\r\n    var te = this.elements;\r\n\r\n    var a11 = ae[0],\r\n      a12 = ae[4],\r\n      a13 = ae[8],\r\n      a14 = ae[12];\r\n    var a21 = ae[1],\r\n      a22 = ae[5],\r\n      a23 = ae[9],\r\n      a24 = ae[13];\r\n    var a31 = ae[2],\r\n      a32 = ae[6],\r\n      a33 = ae[10],\r\n      a34 = ae[14];\r\n    var a41 = ae[3],\r\n      a42 = ae[7],\r\n      a43 = ae[11],\r\n      a44 = ae[15];\r\n\r\n    var b11 = be[0],\r\n      b12 = be[4],\r\n      b13 = be[8],\r\n      b14 = be[12];\r\n    var b21 = be[1],\r\n      b22 = be[5],\r\n      b23 = be[9],\r\n      b24 = be[13];\r\n    var b31 = be[2],\r\n      b32 = be[6],\r\n      b33 = be[10],\r\n      b34 = be[14];\r\n    var b41 = be[3],\r\n      b42 = be[7],\r\n      b43 = be[11],\r\n      b44 = be[15];\r\n\r\n    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyToArray: function(a, b, r) {\r\n\r\n    var te = this.elements;\r\n\r\n    this.multiplyMatrices(a, b);\r\n\r\n    r[0] = te[0];\r\n    r[1] = te[1];\r\n    r[2] = te[2];\r\n    r[3] = te[3];\r\n    r[4] = te[4];\r\n    r[5] = te[5];\r\n    r[6] = te[6];\r\n    r[7] = te[7];\r\n    r[8] = te[8];\r\n    r[9] = te[9];\r\n    r[10] = te[10];\r\n    r[11] = te[11];\r\n    r[12] = te[12];\r\n    r[13] = te[13];\r\n    r[14] = te[14];\r\n    r[15] = te[15];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[4] *= s;\r\n    te[8] *= s;\r\n    te[12] *= s;\r\n    te[1] *= s;\r\n    te[5] *= s;\r\n    te[9] *= s;\r\n    te[13] *= s;\r\n    te[2] *= s;\r\n    te[6] *= s;\r\n    te[10] *= s;\r\n    te[14] *= s;\r\n    te[3] *= s;\r\n    te[7] *= s;\r\n    te[11] *= s;\r\n    te[15] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.');\r\n    return vector.applyProjection(this);\r\n\r\n  },\r\n\r\n  multiplyVector4: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix4(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateAxis: function(v) {\r\n\r\n    THREE.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.');\r\n\r\n    v.transformDirection(this);\r\n\r\n  },\r\n\r\n  crossVector: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var n11 = te[0],\r\n      n12 = te[4],\r\n      n13 = te[8],\r\n      n14 = te[12];\r\n    var n21 = te[1],\r\n      n22 = te[5],\r\n      n23 = te[9],\r\n      n24 = te[13];\r\n    var n31 = te[2],\r\n      n32 = te[6],\r\n      n33 = te[10],\r\n      n34 = te[14];\r\n    var n41 = te[3],\r\n      n42 = te[7],\r\n      n43 = te[11],\r\n      n44 = te[15];\r\n\r\n    //TODO: make this more efficient\r\n    //( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n    return (\r\n      n41 * (+n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34) +\r\n      n42 * (+n11 * n23 * n34 - n11 * n24 * n33 + n14 * n21 * n33 - n13 * n21 * n34 + n13 * n24 * n31 - n14 * n23 * n31) +\r\n      n43 * (+n11 * n24 * n32 - n11 * n22 * n34 - n14 * n21 * n32 + n12 * n21 * n34 + n14 * n22 * n31 - n12 * n24 * n31) +\r\n      n44 * (-n13 * n22 * n31 - n11 * n23 * n32 + n11 * n22 * n33 + n13 * n21 * n32 - n12 * n21 * n33 + n12 * n23 * n31)\r\n\r\n    );\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var te = this.elements;\r\n    var tmp;\r\n\r\n    tmp = te[1];\r\n    te[1] = te[4];\r\n    te[4] = tmp;\r\n    tmp = te[2];\r\n    te[2] = te[8];\r\n    te[8] = tmp;\r\n    tmp = te[6];\r\n    te[6] = te[9];\r\n    te[9] = tmp;\r\n\r\n    tmp = te[3];\r\n    te[3] = te[12];\r\n    te[12] = tmp;\r\n    tmp = te[7];\r\n    te[7] = te[13];\r\n    te[13] = tmp;\r\n    tmp = te[11];\r\n    te[11] = te[14];\r\n    te[14] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n    array[offset + 3] = te[3];\r\n\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n\r\n    array[offset + 8] = te[8];\r\n    array[offset + 9] = te[9];\r\n    array[offset + 10] = te[10];\r\n    array[offset + 11] = te[11];\r\n\r\n    array[offset + 12] = te[12];\r\n    array[offset + 13] = te[13];\r\n    array[offset + 14] = te[14];\r\n    array[offset + 15] = te[15];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getPosition: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      THREE.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.');\r\n\r\n      var te = this.elements;\r\n      return v1.set(te[12], te[13], te[14]);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setPosition: function(v) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[12] = v.x;\r\n    te[13] = v.y;\r\n    te[14] = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getInverse: function(m, throwOnInvertible) {\r\n\r\n    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    var n11 = me[0],\r\n      n12 = me[4],\r\n      n13 = me[8],\r\n      n14 = me[12];\r\n    var n21 = me[1],\r\n      n22 = me[5],\r\n      n23 = me[9],\r\n      n24 = me[13];\r\n    var n31 = me[2],\r\n      n32 = me[6],\r\n      n33 = me[10],\r\n      n34 = me[14];\r\n    var n41 = me[3],\r\n      n42 = me[7],\r\n      n43 = me[11],\r\n      n44 = me[15];\r\n\r\n    te[0] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n    te[4] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n    te[8] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n    te[12] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n    te[1] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n    te[5] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n    te[9] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n    te[13] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n    te[2] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n    te[6] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n    te[10] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n    te[14] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n    te[3] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n    te[7] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n    te[11] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n    te[15] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n    var det = n11 * te[0] + n21 * te[4] + n31 * te[8] + n41 * te[12];\r\n\r\n    if (det == 0) {\r\n\r\n      var msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n    }\r\n\r\n    this.multiplyScalar(1 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(v) {\r\n\r\n    THREE.error('THREE.Matrix4: .translate() has been removed.');\r\n\r\n  },\r\n\r\n  rotateX: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateX() has been removed.');\r\n\r\n  },\r\n\r\n  rotateY: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateY() has been removed.');\r\n\r\n  },\r\n\r\n  rotateZ: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateZ() has been removed.');\r\n\r\n  },\r\n\r\n  rotateByAxis: function(axis, angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateByAxis() has been removed.');\r\n\r\n  },\r\n\r\n  scale: function(v) {\r\n\r\n    var te = this.elements;\r\n    var x = v.x,\r\n      y = v.y,\r\n      z = v.z;\r\n\r\n    te[0] *= x;\r\n    te[4] *= y;\r\n    te[8] *= z;\r\n    te[1] *= x;\r\n    te[5] *= y;\r\n    te[9] *= z;\r\n    te[2] *= x;\r\n    te[6] *= y;\r\n    te[10] *= z;\r\n    te[3] *= x;\r\n    te[7] *= y;\r\n    te[11] *= z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getMaxScaleOnAxis: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var scaleXSq = te[0] * te[0] + te[1] * te[1] + te[2] * te[2];\r\n    var scaleYSq = te[4] * te[4] + te[5] * te[5] + te[6] * te[6];\r\n    var scaleZSq = te[8] * te[8] + te[9] * te[9] + te[10] * te[10];\r\n\r\n    return Math.sqrt(Math.max(scaleXSq, Math.max(scaleYSq, scaleZSq)));\r\n\r\n  },\r\n\r\n  makeTranslation: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, x,\r\n      0, 1, 0, y,\r\n      0, 0, 1, z,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationX: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, c, -s, 0,\r\n      0, s, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationY: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, 0, s, 0,\r\n      0, 1, 0, 0, -s, 0, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationZ: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, -s, 0, 0,\r\n      s, c, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationAxis: function(axis, angle) {\r\n\r\n    // Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n    var c = Math.cos(angle);\r\n    var s = Math.sin(angle);\r\n    var t = 1 - c;\r\n    var x = axis.x,\r\n      y = axis.y,\r\n      z = axis.z;\r\n    var tx = t * x,\r\n      ty = t * y;\r\n\r\n    this.set(\r\n\r\n      tx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n      tx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n      tx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeScale: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      x, 0, 0, 0,\r\n      0, y, 0, 0,\r\n      0, 0, z, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  compose: function(position, quaternion, scale) {\r\n\r\n    this.makeRotationFromQuaternion(quaternion);\r\n    this.scale(scale);\r\n    this.setPosition(position);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  decompose: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(position, quaternion, scale) {\r\n\r\n      var te = this.elements;\r\n\r\n      var sx = vector.set(te[0], te[1], te[2]).length();\r\n      var sy = vector.set(te[4], te[5], te[6]).length();\r\n      var sz = vector.set(te[8], te[9], te[10]).length();\r\n\r\n      // if determine is negative, we need to invert one scale\r\n      var det = this.determinant();\r\n      if (det < 0) {\r\n        sx = -sx;\r\n      }\r\n\r\n      position.x = te[12];\r\n      position.y = te[13];\r\n      position.z = te[14];\r\n\r\n      // scale the rotation part\r\n\r\n      matrix.elements.set(this.elements); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n      var invSX = 1 / sx;\r\n      var invSY = 1 / sy;\r\n      var invSZ = 1 / sz;\r\n\r\n      matrix.elements[0] *= invSX;\r\n      matrix.elements[1] *= invSX;\r\n      matrix.elements[2] *= invSX;\r\n\r\n      matrix.elements[4] *= invSY;\r\n      matrix.elements[5] *= invSY;\r\n      matrix.elements[6] *= invSY;\r\n\r\n      matrix.elements[8] *= invSZ;\r\n      matrix.elements[9] *= invSZ;\r\n      matrix.elements[10] *= invSZ;\r\n\r\n      quaternion.setFromRotationMatrix(matrix);\r\n\r\n      scale.x = sx;\r\n      scale.y = sy;\r\n      scale.z = sz;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeFrustum: function(left, right, bottom, top, near, far) {\r\n\r\n    var te = this.elements;\r\n    var x = 2 * near / (right - left);\r\n    var y = 2 * near / (top - bottom);\r\n\r\n    var a = (right + left) / (right - left);\r\n    var b = (top + bottom) / (top - bottom);\r\n    var c = -(far + near) / (far - near);\r\n    var d = -2 * far * near / (far - near);\r\n\r\n    te[0] = x;\r\n    te[4] = 0;\r\n    te[8] = a;\r\n    te[12] = 0;\r\n    te[1] = 0;\r\n    te[5] = y;\r\n    te[9] = b;\r\n    te[13] = 0;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = c;\r\n    te[14] = d;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = -1;\r\n    te[15] = 0;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makePerspective: function(fov, aspect, near, far) {\r\n\r\n    var ymax = near * Math.tan(THREE.Math.degToRad(fov * 0.5));\r\n    var ymin = -ymax;\r\n    var xmin = ymin * aspect;\r\n    var xmax = ymax * aspect;\r\n\r\n    return this.makeFrustum(xmin, xmax, ymin, ymax, near, far);\r\n\r\n  },\r\n\r\n  makeOrthographic: function(left, right, top, bottom, near, far) {\r\n\r\n    var te = this.elements;\r\n    var w = right - left;\r\n    var h = top - bottom;\r\n    var p = far - near;\r\n\r\n    var x = (right + left) / w;\r\n    var y = (top + bottom) / h;\r\n    var z = (far + near) / p;\r\n\r\n    te[0] = 2 / w;\r\n    te[4] = 0;\r\n    te[8] = 0;\r\n    te[12] = -x;\r\n    te[1] = 0;\r\n    te[5] = 2 / h;\r\n    te[9] = 0;\r\n    te[13] = -y;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = -2 / p;\r\n    te[14] = -z;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2], te[3],\r\n      te[4], te[5], te[6], te[7],\r\n      te[8], te[9], te[10], te[11],\r\n      te[12], te[13], te[14], te[15]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix4().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Ray = function(origin, direction) {\r\n\r\n  this.origin = (origin !== undefined) ? origin : new THREE.Vector3();\r\n  this.direction = (direction !== undefined) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n  constructor: THREE.Ray,\r\n\r\n  set: function(origin, direction) {\r\n\r\n    this.origin.copy(origin);\r\n    this.direction.copy(direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(ray) {\r\n\r\n    this.origin.copy(ray.origin);\r\n    this.direction.copy(ray.direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.copy(this.direction).multiplyScalar(t).add(this.origin);\r\n\r\n  },\r\n\r\n  recast: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(t) {\r\n\r\n      this.origin.copy(this.at(t, v1));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.subVectors(point, this.origin);\r\n    var directionDistance = result.dot(this.direction);\r\n\r\n    if (directionDistance < 0) {\r\n\r\n      return result.copy(this.origin);\r\n\r\n    }\r\n\r\n    return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var directionDistance = v1.subVectors(point, this.origin).dot(this.direction);\r\n\r\n      // point behind the ray\r\n\r\n      if (directionDistance < 0) {\r\n\r\n        return this.origin.distanceTo(point);\r\n\r\n      }\r\n\r\n      v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n      return v1.distanceTo(point);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  distanceSqToSegment: function() {\r\n\r\n    var segCenter = new THREE.Vector3();\r\n    var segDir = new THREE.Vector3();\r\n    var diff = new THREE.Vector3();\r\n\r\n    return function(v0, v1, optionalPointOnRay, optionalPointOnSegment) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n      // It returns the min distance between the ray and the segment\r\n      // defined by v0 and v1\r\n      // It can also set two optional targets :\r\n      // - The closest point on the ray\r\n      // - The closest point on the segment\r\n\r\n      segCenter.copy(v0).add(v1).multiplyScalar(0.5);\r\n      segDir.copy(v1).sub(v0).normalize();\r\n      diff.copy(this.origin).sub(segCenter);\r\n\r\n      var segExtent = v0.distanceTo(v1) * 0.5;\r\n      var a01 = -this.direction.dot(segDir);\r\n      var b0 = diff.dot(this.direction);\r\n      var b1 = -diff.dot(segDir);\r\n      var c = diff.lengthSq();\r\n      var det = Math.abs(1 - a01 * a01);\r\n      var s0, s1, sqrDist, extDet;\r\n\r\n      if (det > 0) {\r\n\r\n        // The ray and segment are not parallel.\r\n\r\n        s0 = a01 * b1 - b0;\r\n        s1 = a01 * b0 - b1;\r\n        extDet = segExtent * det;\r\n\r\n        if (s0 >= 0) {\r\n\r\n          if (s1 >= -extDet) {\r\n\r\n            if (s1 <= extDet) {\r\n\r\n              // region 0\r\n              // Minimum at interior points of ray and segment.\r\n\r\n              var invDet = 1 / det;\r\n              s0 *= invDet;\r\n              s1 *= invDet;\r\n              sqrDist = s0 * (s0 + a01 * s1 + 2 * b0) + s1 * (a01 * s0 + s1 + 2 * b1) + c;\r\n\r\n            }\r\n            else {\r\n\r\n              // region 1\r\n\r\n              s1 = segExtent;\r\n              s0 = Math.max(0, -(a01 * s1 + b0));\r\n              sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            // region 5\r\n\r\n            s1 = -segExtent;\r\n            s0 = Math.max(0, -(a01 * s1 + b0));\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          if (s1 <= -extDet) {\r\n\r\n            // region 4\r\n\r\n            s0 = Math.max(0, -(-a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? -segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else if (s1 <= extDet) {\r\n\r\n            // region 3\r\n\r\n            s0 = 0;\r\n            s1 = Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else {\r\n\r\n            // region 2\r\n\r\n            s0 = Math.max(0, -(a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // Ray and segment are parallel.\r\n\r\n        s1 = (a01 > 0) ? -segExtent : segExtent;\r\n        s0 = Math.max(0, -(a01 * s1 + b0));\r\n        sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n      }\r\n\r\n      if (optionalPointOnRay) {\r\n\r\n        optionalPointOnRay.copy(this.direction).multiplyScalar(s0).add(this.origin);\r\n\r\n      }\r\n\r\n      if (optionalPointOnSegment) {\r\n\r\n        optionalPointOnSegment.copy(segDir).multiplyScalar(s1).add(segCenter);\r\n\r\n      }\r\n\r\n      return sqrDist;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  isIntersectionSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) <= sphere.radius;\r\n\r\n  },\r\n\r\n  intersectSphere: function() {\r\n\r\n    // from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(sphere, optionalTarget) {\r\n\r\n      v1.subVectors(sphere.center, this.origin);\r\n\r\n      var tca = v1.dot(this.direction);\r\n\r\n      var d2 = v1.dot(v1) - tca * tca;\r\n\r\n      var radius2 = sphere.radius * sphere.radius;\r\n\r\n      if (d2 > radius2) return null;\r\n\r\n      var thc = Math.sqrt(radius2 - d2);\r\n\r\n      // t0 = first intersect point - entrance on front of sphere\r\n      var t0 = tca - thc;\r\n\r\n      // t1 = second intersect point - exit point on back of sphere\r\n      var t1 = tca + thc;\r\n\r\n      // test to see if both t0 and t1 are behind the ray - if so, return null\r\n      if (t0 < 0 && t1 < 0) return null;\r\n\r\n      // test to see if t0 is behind the ray:\r\n      // if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n      // in order to always return an intersect point that is in front of the ray.\r\n      if (t0 < 0) return this.at(t1, optionalTarget);\r\n\r\n      // else t0 is in front of the ray, so return the first collision point scaled by t0 \r\n      return this.at(t0, optionalTarget);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  isIntersectionPlane: function(plane) {\r\n\r\n    // check if the ray lies on the plane first\r\n\r\n    var distToPoint = plane.distanceToPoint(this.origin);\r\n\r\n    if (distToPoint === 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n\r\n    if (denominator * distToPoint < 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    // ray origin is behind the plane (and is pointing behind it)\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  distanceToPlane: function(plane) {\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n    if (denominator == 0) {\r\n\r\n      // line is coplanar, return origin\r\n      if (plane.distanceToPoint(this.origin) == 0) {\r\n\r\n        return 0;\r\n\r\n      }\r\n\r\n      // Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n      return null;\r\n\r\n    }\r\n\r\n    var t = -(this.origin.dot(plane.normal) + plane.constant) / denominator;\r\n\r\n    // Return if the ray never intersects the plane\r\n\r\n    return t >= 0 ? t : null;\r\n\r\n  },\r\n\r\n  intersectPlane: function(plane, optionalTarget) {\r\n\r\n    var t = this.distanceToPlane(plane);\r\n\r\n    if (t === null) {\r\n\r\n      return null;\r\n    }\r\n\r\n    return this.at(t, optionalTarget);\r\n\r\n  },\r\n\r\n  isIntersectionBox: function() {\r\n\r\n    var v = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      return this.intersectBox(box, v) !== null;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectBox: function(box, optionalTarget) {\r\n\r\n    // http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\r\n    var tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n    var invdirx = 1 / this.direction.x,\r\n      invdiry = 1 / this.direction.y,\r\n      invdirz = 1 / this.direction.z;\r\n\r\n    var origin = this.origin;\r\n\r\n    if (invdirx >= 0) {\r\n\r\n      tmin = (box.min.x - origin.x) * invdirx;\r\n      tmax = (box.max.x - origin.x) * invdirx;\r\n\r\n    }\r\n    else {\r\n\r\n      tmin = (box.max.x - origin.x) * invdirx;\r\n      tmax = (box.min.x - origin.x) * invdirx;\r\n    }\r\n\r\n    if (invdiry >= 0) {\r\n\r\n      tymin = (box.min.y - origin.y) * invdiry;\r\n      tymax = (box.max.y - origin.y) * invdiry;\r\n\r\n    }\r\n    else {\r\n\r\n      tymin = (box.max.y - origin.y) * invdiry;\r\n      tymax = (box.min.y - origin.y) * invdiry;\r\n    }\r\n\r\n    if ((tmin > tymax) || (tymin > tmax)) return null;\r\n\r\n    // These lines also handle the case where tmin or tmax is NaN\r\n    // (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n    if (tymin > tmin || tmin !== tmin) tmin = tymin;\r\n\r\n    if (tymax < tmax || tmax !== tmax) tmax = tymax;\r\n\r\n    if (invdirz >= 0) {\r\n\r\n      tzmin = (box.min.z - origin.z) * invdirz;\r\n      tzmax = (box.max.z - origin.z) * invdirz;\r\n\r\n    }\r\n    else {\r\n\r\n      tzmin = (box.max.z - origin.z) * invdirz;\r\n      tzmax = (box.min.z - origin.z) * invdirz;\r\n    }\r\n\r\n    if ((tmin > tzmax) || (tzmin > tmax)) return null;\r\n\r\n    if (tzmin > tmin || tmin !== tmin) tmin = tzmin;\r\n\r\n    if (tzmax < tmax || tmax !== tmax) tmax = tzmax;\r\n\r\n    //return point closest to the ray (positive side)\r\n\r\n    if (tmax < 0) return null;\r\n\r\n    return this.at(tmin >= 0 ? tmin : tmax, optionalTarget);\r\n\r\n  },\r\n\r\n  intersectTriangle: function() {\r\n\r\n    // Compute the offset origin, edges, and normal.\r\n    var diff = new THREE.Vector3();\r\n    var edge1 = new THREE.Vector3();\r\n    var edge2 = new THREE.Vector3();\r\n    var normal = new THREE.Vector3();\r\n\r\n    return function(a, b, c, backfaceCulling, optionalTarget) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n      edge1.subVectors(b, a);\r\n      edge2.subVectors(c, a);\r\n      normal.crossVectors(edge1, edge2);\r\n\r\n      // Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n      // E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n      //   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n      //   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n      //   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n      var DdN = this.direction.dot(normal);\r\n      var sign;\r\n\r\n      if (DdN > 0) {\r\n\r\n        if (backfaceCulling) return null;\r\n        sign = 1;\r\n\r\n      }\r\n      else if (DdN < 0) {\r\n\r\n        sign = -1;\r\n        DdN = -DdN;\r\n\r\n      }\r\n      else {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      diff.subVectors(this.origin, a);\r\n      var DdQxE2 = sign * this.direction.dot(edge2.crossVectors(diff, edge2));\r\n\r\n      // b1 < 0, no intersection\r\n      if (DdQxE2 < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      var DdE1xQ = sign * this.direction.dot(edge1.cross(diff));\r\n\r\n      // b2 < 0, no intersection\r\n      if (DdE1xQ < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // b1+b2 > 1, no intersection\r\n      if (DdQxE2 + DdE1xQ > DdN) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Line intersects triangle, check if ray does.\r\n      var QdN = -sign * diff.dot(normal);\r\n\r\n      // t < 0, no intersection\r\n      if (QdN < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Ray intersects triangle.\r\n      return this.at(QdN / DdN, optionalTarget);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix4: function(matrix4) {\r\n\r\n    this.direction.add(this.origin).applyMatrix4(matrix4);\r\n    this.origin.applyMatrix4(matrix4);\r\n    this.direction.sub(this.origin);\r\n    this.direction.normalize();\r\n\r\n    return this;\r\n  },\r\n\r\n  equals: function(ray) {\r\n\r\n    return ray.origin.equals(this.origin) && ray.direction.equals(this.direction);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Ray().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function(center, radius) {\r\n\r\n  this.center = (center !== undefined) ? center : new THREE.Vector3();\r\n  this.radius = (radius !== undefined) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n  constructor: THREE.Sphere,\r\n\r\n  set: function(center, radius) {\r\n\r\n    this.center.copy(center);\r\n    this.radius = radius;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromPoints: function() {\r\n\r\n    var box = new THREE.Box3();\r\n\r\n    return function(points, optionalCenter) {\r\n\r\n      var center = this.center;\r\n\r\n      if (optionalCenter !== undefined) {\r\n\r\n        center.copy(optionalCenter);\r\n\r\n      }\r\n      else {\r\n\r\n        box.setFromPoints(points).center(center);\r\n\r\n      }\r\n\r\n      var maxRadiusSq = 0;\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(points[i]));\r\n\r\n      }\r\n\r\n      this.radius = Math.sqrt(maxRadiusSq);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(sphere) {\r\n\r\n    this.center.copy(sphere.center);\r\n    this.radius = sphere.radius;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    return (this.radius <= 0);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return (point.distanceToSquared(this.center) <= (this.radius * this.radius));\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return (point.distanceTo(this.center) - this.radius);\r\n\r\n  },\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var radiusSum = this.radius + sphere.radius;\r\n\r\n    return sphere.center.distanceToSquared(this.center) <= (radiusSum * radiusSum);\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var deltaLengthSq = this.center.distanceToSquared(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.copy(point);\r\n\r\n    if (deltaLengthSq > (this.radius * this.radius)) {\r\n\r\n      result.sub(this.center).normalize();\r\n      result.multiplyScalar(this.radius).add(this.center);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  },\r\n\r\n  getBoundingBox: function(optionalTarget) {\r\n\r\n    var box = optionalTarget || new THREE.Box3();\r\n\r\n    box.set(this.center, this.center);\r\n    box.expandByScalar(this.radius);\r\n\r\n    return box;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.center.applyMatrix4(matrix);\r\n    this.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.center.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(sphere) {\r\n\r\n    return sphere.center.equals(this.center) && (sphere.radius === this.radius);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Sphere().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Frustum = function(p0, p1, p2, p3, p4, p5) {\r\n\r\n  this.planes = [\r\n\r\n    (p0 !== undefined) ? p0 : new THREE.Plane(), (p1 !== undefined) ? p1 : new THREE.Plane(), (p2 !== undefined) ? p2 : new THREE.Plane(), (p3 !== undefined) ? p3 : new THREE.Plane(), (p4 !== undefined) ? p4 : new THREE.Plane(), (p5 !== undefined) ? p5 : new THREE.Plane()\r\n\r\n  ];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n  constructor: THREE.Frustum,\r\n\r\n  set: function(p0, p1, p2, p3, p4, p5) {\r\n\r\n    var planes = this.planes;\r\n\r\n    planes[0].copy(p0);\r\n    planes[1].copy(p1);\r\n    planes[2].copy(p2);\r\n    planes[3].copy(p3);\r\n    planes[4].copy(p4);\r\n    planes[5].copy(p5);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(frustum) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      planes[i].copy(frustum.planes[i]);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrix: function(m) {\r\n\r\n    var planes = this.planes;\r\n    var me = m.elements;\r\n    var me0 = me[0],\r\n      me1 = me[1],\r\n      me2 = me[2],\r\n      me3 = me[3];\r\n    var me4 = me[4],\r\n      me5 = me[5],\r\n      me6 = me[6],\r\n      me7 = me[7];\r\n    var me8 = me[8],\r\n      me9 = me[9],\r\n      me10 = me[10],\r\n      me11 = me[11];\r\n    var me12 = me[12],\r\n      me13 = me[13],\r\n      me14 = me[14],\r\n      me15 = me[15];\r\n\r\n    planes[0].setComponents(me3 - me0, me7 - me4, me11 - me8, me15 - me12).normalize();\r\n    planes[1].setComponents(me3 + me0, me7 + me4, me11 + me8, me15 + me12).normalize();\r\n    planes[2].setComponents(me3 + me1, me7 + me5, me11 + me9, me15 + me13).normalize();\r\n    planes[3].setComponents(me3 - me1, me7 - me5, me11 - me9, me15 - me13).normalize();\r\n    planes[4].setComponents(me3 - me2, me7 - me6, me11 - me10, me15 - me14).normalize();\r\n    planes[5].setComponents(me3 + me2, me7 + me6, me11 + me10, me15 + me14).normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  intersectsObject: function() {\r\n\r\n    var sphere = new THREE.Sphere();\r\n\r\n    return function(object) {\r\n\r\n      var geometry = object.geometry;\r\n\r\n      if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n      sphere.copy(geometry.boundingSphere);\r\n      sphere.applyMatrix4(object.matrixWorld);\r\n\r\n      return this.intersectsSphere(sphere);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var planes = this.planes;\r\n    var center = sphere.center;\r\n    var negRadius = -sphere.radius;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      var distance = planes[i].distanceToPoint(center);\r\n\r\n      if (distance < negRadius) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  intersectsBox: function() {\r\n\r\n    var p1 = new THREE.Vector3(),\r\n      p2 = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      var planes = this.planes;\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        var plane = planes[i];\r\n\r\n        p1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n        p2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n        p1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n        p2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n        p1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n        p2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n        var d1 = plane.distanceToPoint(p1);\r\n        var d2 = plane.distanceToPoint(p2);\r\n\r\n        // if both outside plane, no intersection\r\n\r\n        if (d1 < 0 && d2 < 0) {\r\n\r\n          return false;\r\n\r\n        }\r\n      }\r\n\r\n      return true;\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  containsPoint: function(point) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      if (planes[i].distanceToPoint(point) < 0) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Frustum().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Plane = function(normal, constant) {\r\n\r\n  this.normal = (normal !== undefined) ? normal : new THREE.Vector3(1, 0, 0);\r\n  this.constant = (constant !== undefined) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n  constructor: THREE.Plane,\r\n\r\n  set: function(normal, constant) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponents: function(x, y, z, w) {\r\n\r\n    this.normal.set(x, y, z);\r\n    this.constant = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromNormalAndCoplanarPoint: function(normal, point) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = -point.dot(this.normal); // must be this.normal, not normal, as this.normal is normalized\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCoplanarPoints: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n\r\n    return function(a, b, c) {\r\n\r\n      var normal = v1.subVectors(c, b).cross(v2.subVectors(a, b)).normalize();\r\n\r\n      // Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n      this.setFromNormalAndCoplanarPoint(normal, a);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  copy: function(plane) {\r\n\r\n    this.normal.copy(plane.normal);\r\n    this.constant = plane.constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    // Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n    var inverseNormalLength = 1.0 / this.normal.length();\r\n    this.normal.multiplyScalar(inverseNormalLength);\r\n    this.constant *= inverseNormalLength;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.constant *= -1;\r\n    this.normal.negate();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return this.normal.dot(point) + this.constant;\r\n\r\n  },\r\n\r\n  distanceToSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) - sphere.radius;\r\n\r\n  },\r\n\r\n  projectPoint: function(point, optionalTarget) {\r\n\r\n    return this.orthoPoint(point, optionalTarget).sub(point).negate();\r\n\r\n  },\r\n\r\n  orthoPoint: function(point, optionalTarget) {\r\n\r\n    var perpendicularMagnitude = this.distanceToPoint(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(perpendicularMagnitude);\r\n\r\n  },\r\n\r\n  isIntersectionLine: function(line) {\r\n\r\n    // Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n    var startSign = this.distanceToPoint(line.start);\r\n    var endSign = this.distanceToPoint(line.end);\r\n\r\n    return (startSign < 0 && endSign > 0) || (endSign < 0 && startSign > 0);\r\n\r\n  },\r\n\r\n  intersectLine: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(line, optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      var direction = line.delta(v1);\r\n\r\n      var denominator = this.normal.dot(direction);\r\n\r\n      if (denominator == 0) {\r\n\r\n        // line is coplanar, return origin\r\n        if (this.distanceToPoint(line.start) == 0) {\r\n\r\n          return result.copy(line.start);\r\n\r\n        }\r\n\r\n        // Unsure if this is the correct method to handle this case.\r\n        return undefined;\r\n\r\n      }\r\n\r\n      var t = -(line.start.dot(this.normal) + this.constant) / denominator;\r\n\r\n      if (t < 0 || t > 1) {\r\n\r\n        return undefined;\r\n\r\n      }\r\n\r\n      return result.copy(direction).multiplyScalar(t).add(line.start);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  coplanarPoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(-this.constant);\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n    var m1 = new THREE.Matrix3();\r\n\r\n    return function(matrix, optionalNormalMatrix) {\r\n\r\n      // compute new normal based on theory here:\r\n      // http://www.songho.ca/opengl/gl_normaltransform.html\r\n      var normalMatrix = optionalNormalMatrix || m1.getNormalMatrix(matrix);\r\n      var newNormal = v1.copy(this.normal).applyMatrix3(normalMatrix);\r\n\r\n      var newCoplanarPoint = this.coplanarPoint(v2);\r\n      newCoplanarPoint.applyMatrix4(matrix);\r\n\r\n      this.setFromNormalAndCoplanarPoint(newNormal, newCoplanarPoint);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.constant = this.constant - offset.dot(this.normal);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(plane) {\r\n\r\n    return plane.normal.equals(this.normal) && (plane.constant == this.constant);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Plane().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n  generateUUID: function() {\r\n\r\n    // http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n    var uuid = new Array(36);\r\n    var rnd = 0,\r\n      r;\r\n\r\n    return function() {\r\n\r\n      for (var i = 0; i < 36; i++) {\r\n\r\n        if (i == 8 || i == 13 || i == 18 || i == 23) {\r\n\r\n          uuid[i] = '-';\r\n\r\n        }\r\n        else if (i == 14) {\r\n\r\n          uuid[i] = '4';\r\n\r\n        }\r\n        else {\r\n\r\n          if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;\r\n          r = rnd & 0xf;\r\n          rnd = rnd >> 4;\r\n          uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n\r\n        }\r\n      }\r\n\r\n      return uuid.join('');\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  // Clamp value to range <a, b>\r\n\r\n  clamp: function(x, a, b) {\r\n\r\n    return (x < a) ? a : ((x > b) ? b : x);\r\n\r\n  },\r\n\r\n  // Clamp value to range <a, inf)\r\n\r\n  clampBottom: function(x, a) {\r\n\r\n    return x < a ? a : x;\r\n\r\n  },\r\n\r\n  // Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n  mapLinear: function(x, a1, a2, b1, b2) {\r\n\r\n    return b1 + (x - a1) * (b2 - b1) / (a2 - a1);\r\n\r\n  },\r\n\r\n  // http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n  smoothstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * (3 - 2 * x);\r\n\r\n  },\r\n\r\n  smootherstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * x * (x * (x * 6 - 15) + 10);\r\n\r\n  },\r\n\r\n  // Random float from <0, 1> with 16 bits of randomness\r\n  // (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\r\n  random16: function() {\r\n\r\n    return (65280 * Math.random() + 255 * Math.random()) / 65535;\r\n\r\n  },\r\n\r\n  // Random integer from <low, high> interval\r\n\r\n  randInt: function(low, high) {\r\n\r\n    return Math.floor(this.randFloat(low, high));\r\n\r\n  },\r\n\r\n  // Random float from <low, high> interval\r\n\r\n  randFloat: function(low, high) {\r\n\r\n    return low + Math.random() * (high - low);\r\n\r\n  },\r\n\r\n  // Random float from <-range/2, range/2> interval\r\n\r\n  randFloatSpread: function(range) {\r\n\r\n    return range * (0.5 - Math.random());\r\n\r\n  },\r\n\r\n  degToRad: function() {\r\n\r\n    var degreeToRadiansFactor = Math.PI / 180;\r\n\r\n    return function(degrees) {\r\n\r\n      return degrees * degreeToRadiansFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  radToDeg: function() {\r\n\r\n    var radianToDegreesFactor = 180 / Math.PI;\r\n\r\n    return function(radians) {\r\n\r\n      return radians * radianToDegreesFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  isPowerOfTwo: function(value) {\r\n\r\n    return (value & (value - 1)) === 0 && value !== 0;\r\n\r\n  },\r\n\r\n  nextPowerOfTwo: function(value) {\r\n\r\n    value--;\r\n    value |= value >> 1;\r\n    value |= value >> 2;\r\n    value |= value >> 4;\r\n    value |= value >> 8;\r\n    value |= value >> 16;\r\n    value++;\r\n\r\n    return value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function(points) {\r\n\r\n  this.points = points;\r\n\r\n  var c = [],\r\n    v3 = {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n    },\r\n    point, intPoint, weight, w2, w3,\r\n    pa, pb, pc, pd;\r\n\r\n  this.initFromArray = function(a) {\r\n\r\n    this.points = [];\r\n\r\n    for (var i = 0; i < a.length; i++) {\r\n\r\n      this.points[i] = {\r\n        x: a[i][0],\r\n        y: a[i][1],\r\n        z: a[i][2]\r\n      };\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.getPoint = function(k) {\r\n\r\n    point = (this.points.length - 1) * k;\r\n    intPoint = Math.floor(point);\r\n    weight = point - intPoint;\r\n\r\n    c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n    c[1] = intPoint;\r\n    c[2] = intPoint > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n    c[3] = intPoint > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n    pa = this.points[c[0]];\r\n    pb = this.points[c[1]];\r\n    pc = this.points[c[2]];\r\n    pd = this.points[c[3]];\r\n\r\n    w2 = weight * weight;\r\n    w3 = weight * w2;\r\n\r\n    v3.x = interpolate(pa.x, pb.x, pc.x, pd.x, weight, w2, w3);\r\n    v3.y = interpolate(pa.y, pb.y, pc.y, pd.y, weight, w2, w3);\r\n    v3.z = interpolate(pa.z, pb.z, pc.z, pd.z, weight, w2, w3);\r\n\r\n    return v3;\r\n\r\n  };\r\n\r\n  this.getControlPointsArray = function() {\r\n\r\n    var i, p, l = this.points.length,\r\n      coords = [];\r\n\r\n    for (i = 0; i < l; i++) {\r\n\r\n      p = this.points[i];\r\n      coords[i] = [p.x, p.y, p.z];\r\n\r\n    }\r\n\r\n    return coords;\r\n\r\n  };\r\n\r\n  // approximate length by summing linear segments\r\n\r\n  this.getLength = function(nSubDivisions) {\r\n\r\n    var i, index, nSamples, position,\r\n      point = 0,\r\n      intPoint = 0,\r\n      oldIntPoint = 0,\r\n      oldPosition = new THREE.Vector3(),\r\n      tmpVec = new THREE.Vector3(),\r\n      chunkLengths = [],\r\n      totalLength = 0;\r\n\r\n    // first point has 0 length\r\n\r\n    chunkLengths[0] = 0;\r\n\r\n    if (!nSubDivisions) nSubDivisions = 100;\r\n\r\n    nSamples = this.points.length * nSubDivisions;\r\n\r\n    oldPosition.copy(this.points[0]);\r\n\r\n    for (i = 1; i < nSamples; i++) {\r\n\r\n      index = i / nSamples;\r\n\r\n      position = this.getPoint(index);\r\n      tmpVec.copy(position);\r\n\r\n      totalLength += tmpVec.distanceTo(oldPosition);\r\n\r\n      oldPosition.copy(position);\r\n\r\n      point = (this.points.length - 1) * index;\r\n      intPoint = Math.floor(point);\r\n\r\n      if (intPoint != oldIntPoint) {\r\n\r\n        chunkLengths[intPoint] = totalLength;\r\n        oldIntPoint = intPoint;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // last point ends with total length\r\n\r\n    chunkLengths[chunkLengths.length] = totalLength;\r\n\r\n    return {\r\n      chunks: chunkLengths,\r\n      total: totalLength\r\n    };\r\n\r\n  };\r\n\r\n  this.reparametrizeByArcLength = function(samplingCoef) {\r\n\r\n    var i, j,\r\n      index, indexCurrent, indexNext,\r\n      realDistance,\r\n      sampling, position,\r\n      newpoints = [],\r\n      tmpVec = new THREE.Vector3(),\r\n      sl = this.getLength();\r\n\r\n    newpoints.push(tmpVec.copy(this.points[0]).clone());\r\n\r\n    for (i = 1; i < this.points.length; i++) {\r\n\r\n      //tmpVec.copy( this.points[ i - 1 ] );\r\n      //linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n      realDistance = sl.chunks[i] - sl.chunks[i - 1];\r\n\r\n      sampling = Math.ceil(samplingCoef * realDistance / sl.total);\r\n\r\n      indexCurrent = (i - 1) / (this.points.length - 1);\r\n      indexNext = i / (this.points.length - 1);\r\n\r\n      for (j = 1; j < sampling - 1; j++) {\r\n\r\n        index = indexCurrent + j * (1 / sampling) * (indexNext - indexCurrent);\r\n\r\n        position = this.getPoint(index);\r\n        newpoints.push(tmpVec.copy(position).clone());\r\n\r\n      }\r\n\r\n      newpoints.push(tmpVec.copy(this.points[i]).clone());\r\n\r\n    }\r\n\r\n    this.points = newpoints;\r\n\r\n  };\r\n\r\n  // Catmull-Rom\r\n\r\n  function interpolate(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n    var v0 = (p2 - p0) * 0.5,\r\n      v1 = (p3 - p1) * 0.5;\r\n\r\n    return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function(a, b, c) {\r\n\r\n  this.a = (a !== undefined) ? a : new THREE.Vector3();\r\n  this.b = (b !== undefined) ? b : new THREE.Vector3();\r\n  this.c = (c !== undefined) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n\r\n  return function(a, b, c, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    result.subVectors(c, b);\r\n    v0.subVectors(a, b);\r\n    result.cross(v0);\r\n\r\n    var resultLengthSq = result.lengthSq();\r\n    if (resultLengthSq > 0) {\r\n\r\n      return result.multiplyScalar(1 / Math.sqrt(resultLengthSq));\r\n\r\n    }\r\n\r\n    return result.set(0, 0, 0);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycoordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c, optionalTarget) {\r\n\r\n    v0.subVectors(c, a);\r\n    v1.subVectors(b, a);\r\n    v2.subVectors(point, a);\r\n\r\n    var dot00 = v0.dot(v0);\r\n    var dot01 = v0.dot(v1);\r\n    var dot02 = v0.dot(v2);\r\n    var dot11 = v1.dot(v1);\r\n    var dot12 = v1.dot(v2);\r\n\r\n    var denom = (dot00 * dot11 - dot01 * dot01);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    // colinear or singular triangle\r\n    if (denom == 0) {\r\n      // arbitrary location outside of triangle?\r\n      // not sure if this is the best idea, maybe should be returning undefined\r\n      return result.set(-2, -1, -1);\r\n    }\r\n\r\n    var invDenom = 1 / denom;\r\n    var u = (dot11 * dot02 - dot01 * dot12) * invDenom;\r\n    var v = (dot00 * dot12 - dot01 * dot02) * invDenom;\r\n\r\n    // barycoordinates must always sum to 1\r\n    return result.set(1 - u - v, v, u);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c) {\r\n\r\n    var result = THREE.Triangle.barycoordFromPoint(point, a, b, c, v1);\r\n\r\n    return (result.x >= 0) && (result.y >= 0) && ((result.x + result.y) <= 1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n  constructor: THREE.Triangle,\r\n\r\n  set: function(a, b, c) {\r\n\r\n    this.a.copy(a);\r\n    this.b.copy(b);\r\n    this.c.copy(c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPointsAndIndices: function(points, i0, i1, i2) {\r\n\r\n    this.a.copy(points[i0]);\r\n    this.b.copy(points[i1]);\r\n    this.c.copy(points[i2]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(triangle) {\r\n\r\n    this.a.copy(triangle.a);\r\n    this.b.copy(triangle.b);\r\n    this.c.copy(triangle.c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  area: function() {\r\n\r\n    var v0 = new THREE.Vector3();\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      v0.subVectors(this.c, this.b);\r\n      v1.subVectors(this.a, this.b);\r\n\r\n      return v0.cross(v1).length() * 0.5;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  midpoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3);\r\n\r\n  },\r\n\r\n  normal: function(optionalTarget) {\r\n\r\n    return THREE.Triangle.normal(this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  plane: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Plane();\r\n\r\n    return result.setFromCoplanarPoints(this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  barycoordFromPoint: function(point, optionalTarget) {\r\n\r\n    return THREE.Triangle.barycoordFromPoint(point, this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return THREE.Triangle.containsPoint(point, this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  equals: function(triangle) {\r\n\r\n    return triangle.a.equals(this.a) && triangle.b.equals(this.b) && triangle.c.equals(this.c);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Triangle().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function(autoStart) {\r\n\r\n  this.autoStart = (autoStart !== undefined) ? autoStart : true;\r\n\r\n  this.startTime = 0;\r\n  this.oldTime = 0;\r\n  this.elapsedTime = 0;\r\n\r\n  this.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n  constructor: THREE.Clock,\r\n\r\n  start: function() {\r\n\r\n    this.startTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n    this.oldTime = this.startTime;\r\n    this.running = true;\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.getElapsedTime();\r\n    this.running = false;\r\n\r\n  },\r\n\r\n  getElapsedTime: function() {\r\n\r\n    this.getDelta();\r\n    return this.elapsedTime;\r\n\r\n  },\r\n\r\n  getDelta: function() {\r\n\r\n    var diff = 0;\r\n\r\n    if (this.autoStart && !this.running) {\r\n\r\n      this.start();\r\n\r\n    }\r\n\r\n    if (this.running) {\r\n\r\n      var newTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n      diff = 0.001 * (newTime - this.oldTime);\r\n      this.oldTime = newTime;\r\n\r\n      this.elapsedTime += diff;\r\n\r\n    }\r\n\r\n    return diff;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function() {}\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n  constructor: THREE.EventDispatcher,\r\n\r\n  apply: function(object) {\r\n\r\n    object.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n    object.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n    object.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n    object.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n  },\r\n\r\n  addEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) this._listeners = {};\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] === undefined) {\r\n\r\n      listeners[type] = [];\r\n\r\n    }\r\n\r\n    if (listeners[type].indexOf(listener) === -1) {\r\n\r\n      listeners[type].push(listener);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  hasEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return false;\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  removeEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      var index = listenerArray.indexOf(listener);\r\n\r\n      if (index !== -1) {\r\n\r\n        listenerArray.splice(index, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  dispatchEvent: function(event) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[event.type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      event.target = this;\r\n\r\n      var array = [];\r\n      var length = listenerArray.length;\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i] = listenerArray[i];\r\n\r\n      }\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i].call(this, event);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://exocortex.com/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n(function(THREE) {\r\n\r\n  THREE.Raycaster = function(origin, direction, near, far) {\r\n\r\n    this.ray = new THREE.Ray(origin, direction);\r\n    // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n    this.near = near || 0;\r\n    this.far = far || Infinity;\r\n\r\n    this.params = {\r\n      Sprite: {},\r\n      Mesh: {},\r\n      PointCloud: {\r\n        threshold: 1\r\n      },\r\n      LOD: {},\r\n      Line: {}\r\n    };\r\n\r\n  };\r\n\r\n  var descSort = function(a, b) {\r\n\r\n    return a.distance - b.distance;\r\n\r\n  };\r\n\r\n  var intersectObject = function(object, raycaster, intersects, recursive) {\r\n\r\n    object.raycast(raycaster, intersects);\r\n\r\n    if (recursive === true) {\r\n\r\n      var children = object.children;\r\n\r\n      for (var i = 0, l = children.length; i < l; i++) {\r\n\r\n        intersectObject(children[i], raycaster, intersects, true);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  //\r\n\r\n  THREE.Raycaster.prototype = {\r\n\r\n    constructor: THREE.Raycaster,\r\n\r\n    precision: 0.0001,\r\n    linePrecision: 1,\r\n\r\n    set: function(origin, direction) {\r\n\r\n      // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n      this.ray.set(origin, direction);\r\n\r\n    },\r\n\r\n    setFromCamera: function(coords, camera) {\r\n\r\n      // camera is assumed _not_ to be a child of a transformed object\r\n\r\n      if (camera instanceof THREE.PerspectiveCamera) {\r\n\r\n        this.ray.origin.copy(camera.position);\r\n        this.ray.direction.set(coords.x, coords.y, 0.5).unproject(camera).sub(camera.position).normalize();\r\n\r\n      }\r\n      else if (camera instanceof THREE.OrthographicCamera) {\r\n\r\n        this.ray.origin.set(coords.x, coords.y, -1).unproject(camera);\r\n        this.ray.direction.set(0, 0, -1).transformDirection(camera.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.Raycaster: Unsupported camera type.');\r\n\r\n      }\r\n\r\n    },\r\n\r\n    intersectObject: function(object, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      intersectObject(object, this, intersects, recursive);\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    },\r\n\r\n    intersectObjects: function(objects, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      if (objects instanceof Array === false) {\r\n\r\n        THREE.warn('THREE.Raycaster.intersectObjects: objects is not an Array.');\r\n        return intersects;\r\n\r\n      }\r\n\r\n      for (var i = 0, l = objects.length; i < l; i++) {\r\n\r\n        intersectObject(objects[i], this, intersects, recursive);\r\n\r\n      }\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    }\r\n\r\n  };\r\n\r\n}(THREE));\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Object3D = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.Object3DIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Object3D';\r\n\r\n  this.parent = undefined;\r\n  this.children = [];\r\n\r\n  this.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n  var position = new THREE.Vector3();\r\n  var rotation = new THREE.Euler();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3(1, 1, 1);\r\n\r\n  var onRotationChange = function() {\r\n    quaternion.setFromEuler(rotation, false);\r\n  };\r\n\r\n  var onQuaternionChange = function() {\r\n    rotation.setFromQuaternion(quaternion, undefined, false);\r\n  };\r\n\r\n  rotation.onChange(onRotationChange);\r\n  quaternion.onChange(onQuaternionChange);\r\n\r\n  Object.defineProperties(this, {\r\n    position: {\r\n      enumerable: true,\r\n      value: position\r\n    },\r\n    rotation: {\r\n      enumerable: true,\r\n      value: rotation\r\n    },\r\n    quaternion: {\r\n      enumerable: true,\r\n      value: quaternion\r\n    },\r\n    scale: {\r\n      enumerable: true,\r\n      value: scale\r\n    }\r\n  });\r\n\r\n  this.rotationAutoUpdate = true;\r\n\r\n  this.matrix = new THREE.Matrix4();\r\n  this.matrixWorld = new THREE.Matrix4();\r\n\r\n  this.matrixAutoUpdate = true;\r\n  this.matrixWorldNeedsUpdate = false;\r\n\r\n  this.visible = true;\r\n\r\n  this.castShadow = false;\r\n  this.receiveShadow = false;\r\n\r\n  this.frustumCulled = true;\r\n  this.renderOrder = 0;\r\n\r\n  this.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3(0, 1, 0);\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n  constructor: THREE.Object3D,\r\n\r\n  get eulerOrder() {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    return this.rotation.order;\r\n\r\n  },\r\n\r\n  set eulerOrder(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    this.rotation.order = value;\r\n\r\n  },\r\n\r\n  get useQuaternion() {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  set useQuaternion(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    this.matrix.multiplyMatrices(matrix, this.matrix);\r\n\r\n    this.matrix.decompose(this.position, this.quaternion, this.scale);\r\n\r\n  },\r\n\r\n  setRotationFromAxisAngle: function(axis, angle) {\r\n\r\n    // assumes axis is normalized\r\n\r\n    this.quaternion.setFromAxisAngle(axis, angle);\r\n\r\n  },\r\n\r\n  setRotationFromEuler: function(euler) {\r\n\r\n    this.quaternion.setFromEuler(euler, true);\r\n\r\n  },\r\n\r\n  setRotationFromMatrix: function(m) {\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    this.quaternion.setFromRotationMatrix(m);\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    // assumes q is normalized\r\n\r\n    this.quaternion.copy(q);\r\n\r\n  },\r\n\r\n  rotateOnAxis: function() {\r\n\r\n    // rotate object on axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var q1 = new THREE.Quaternion();\r\n\r\n    return function(axis, angle) {\r\n\r\n      q1.setFromAxisAngle(axis, angle);\r\n\r\n      this.quaternion.multiply(q1);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  rotateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateOnAxis: function() {\r\n\r\n    // translate object by distance along axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(axis, distance) {\r\n\r\n      v1.copy(axis).applyQuaternion(this.quaternion);\r\n\r\n      this.position.add(v1.multiplyScalar(distance));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  translate: function(distance, axis) {\r\n\r\n    THREE.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.');\r\n    return this.translateOnAxis(axis, distance);\r\n\r\n  },\r\n\r\n  translateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  localToWorld: function(vector) {\r\n\r\n    return vector.applyMatrix4(this.matrixWorld);\r\n\r\n  },\r\n\r\n  worldToLocal: function() {\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      return vector.applyMatrix4(m1.getInverse(this.matrixWorld));\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  lookAt: function() {\r\n\r\n    // This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      m1.lookAt(vector, this.position, this.up);\r\n\r\n      this.quaternion.setFromRotationMatrix(m1);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  add: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.add(arguments[i]);\r\n\r\n      }\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n    if (object === this) {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object can't be added as a child of itself.\", object);\r\n      return this;\r\n\r\n    }\r\n\r\n    if (object instanceof THREE.Object3D) {\r\n\r\n      if (object.parent !== undefined) {\r\n\r\n        object.parent.remove(object);\r\n\r\n      }\r\n\r\n      object.parent = this;\r\n      object.dispatchEvent({\r\n        type: 'added'\r\n      });\r\n\r\n      this.children.push(object);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  remove: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.remove(arguments[i]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    var index = this.children.indexOf(object);\r\n\r\n    if (index !== -1) {\r\n\r\n      object.parent = undefined;\r\n\r\n      object.dispatchEvent({\r\n        type: 'removed'\r\n      });\r\n\r\n      this.children.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getChildByName: function(name) {\r\n\r\n    THREE.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().');\r\n    return this.getObjectByName(name);\r\n\r\n  },\r\n\r\n  getObjectById: function(id) {\r\n\r\n    return this.getObjectByProperty('id', id);\r\n\r\n  },\r\n\r\n  getObjectByName: function(name) {\r\n\r\n    return this.getObjectByProperty('name', name);\r\n\r\n  },\r\n\r\n  getObjectByProperty: function(name, value) {\r\n\r\n    if (this[name] === value) return this;\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      var child = this.children[i];\r\n      var object = child.getObjectByProperty(name, value);\r\n\r\n      if (object !== undefined) {\r\n\r\n        return object;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return undefined;\r\n\r\n  },\r\n\r\n  getWorldPosition: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    return result.setFromMatrixPosition(this.matrixWorld);\r\n\r\n  },\r\n\r\n  getWorldQuaternion: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var scale = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Quaternion();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, result, scale);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldRotation: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Euler();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.setFromQuaternion(quaternion, this.rotation.order, false);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldScale: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, quaternion, result);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldDirection: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.set(0, 0, 1).applyQuaternion(quaternion);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  raycast: function() {},\r\n\r\n  traverse: function(callback) {\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverse(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseVisible: function(callback) {\r\n\r\n    if (this.visible === false) return;\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverseVisible(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseAncestors: function(callback) {\r\n\r\n    if (this.parent) {\r\n\r\n      callback(this.parent);\r\n\r\n      this.parent.traverseAncestors(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  updateMatrix: function() {\r\n\r\n    this.matrix.compose(this.position, this.quaternion, this.scale);\r\n\r\n    this.matrixWorldNeedsUpdate = true;\r\n\r\n  },\r\n\r\n  updateMatrixWorld: function(force) {\r\n\r\n    if (this.matrixAutoUpdate === true) this.updateMatrix();\r\n\r\n    if (this.matrixWorldNeedsUpdate === true || force === true) {\r\n\r\n      if (this.parent === undefined) {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n      }\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.3,\r\n        type: 'Object',\r\n        generator: 'ObjectExporter'\r\n      }\r\n    };\r\n\r\n    //\r\n\r\n    var geometries = {};\r\n\r\n    var parseGeometry = function(geometry) {\r\n\r\n      if (output.geometries === undefined) {\r\n\r\n        output.geometries = [];\r\n\r\n      }\r\n\r\n      if (geometries[geometry.uuid] === undefined) {\r\n\r\n        var json = geometry.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        geometries[geometry.uuid] = json;\r\n\r\n        output.geometries.push(json);\r\n\r\n      }\r\n\r\n      return geometry.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var materials = {};\r\n\r\n    var parseMaterial = function(material) {\r\n\r\n      if (output.materials === undefined) {\r\n\r\n        output.materials = [];\r\n\r\n      }\r\n\r\n      if (materials[material.uuid] === undefined) {\r\n\r\n        var json = material.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        materials[material.uuid] = json;\r\n\r\n        output.materials.push(json);\r\n\r\n      }\r\n\r\n      return material.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var parseObject = function(object) {\r\n\r\n      var data = {};\r\n\r\n      data.uuid = object.uuid;\r\n      data.type = object.type;\r\n\r\n      if (object.name !== '') data.name = object.name;\r\n      if (JSON.stringify(object.userData) !== '{}') data.userData = object.userData;\r\n      if (object.visible !== true) data.visible = object.visible;\r\n\r\n      if (object instanceof THREE.PerspectiveCamera) {\r\n\r\n        data.fov = object.fov;\r\n        data.aspect = object.aspect;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.OrthographicCamera) {\r\n\r\n        data.left = object.left;\r\n        data.right = object.right;\r\n        data.top = object.top;\r\n        data.bottom = object.bottom;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.AmbientLight) {\r\n\r\n        data.color = object.color.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.DirectionalLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n\r\n      }\r\n      else if (object instanceof THREE.PointLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.SpotLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.angle = object.angle;\r\n        data.exponent = object.exponent;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.HemisphereLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.groundColor = object.groundColor.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        data.geometry = parseGeometry(object.geometry);\r\n        data.material = parseMaterial(object.material);\r\n\r\n        if (object instanceof THREE.Line) data.mode = object.mode;\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        data.material = parseMaterial(object.material);\r\n\r\n      }\r\n\r\n      data.matrix = object.matrix.toArray();\r\n\r\n      if (object.children.length > 0) {\r\n\r\n        data.children = [];\r\n\r\n        for (var i = 0; i < object.children.length; i++) {\r\n\r\n          data.children.push(parseObject(object.children[i]));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return data;\r\n\r\n    }\r\n\r\n    output.object = parseObject(this);\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(object, recursive) {\r\n\r\n    if (object === undefined) object = new THREE.Object3D();\r\n    if (recursive === undefined) recursive = true;\r\n\r\n    object.name = this.name;\r\n\r\n    object.up.copy(this.up);\r\n\r\n    object.position.copy(this.position);\r\n    object.quaternion.copy(this.quaternion);\r\n    object.scale.copy(this.scale);\r\n\r\n    object.rotationAutoUpdate = this.rotationAutoUpdate;\r\n\r\n    object.matrix.copy(this.matrix);\r\n    object.matrixWorld.copy(this.matrixWorld);\r\n\r\n    object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n    object.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate;\r\n\r\n    object.visible = this.visible;\r\n\r\n    object.castShadow = this.castShadow;\r\n    object.receiveShadow = this.receiveShadow;\r\n\r\n    object.frustumCulled = this.frustumCulled;\r\n\r\n    object.userData = JSON.parse(JSON.stringify(this.userData));\r\n\r\n    if (recursive === true) {\r\n\r\n      for (var i = 0; i < this.children.length; i++) {\r\n\r\n        var child = this.children[i];\r\n        object.add(child.clone());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function(a, b, c, normal, color, materialIndex) {\r\n\r\n  this.a = a;\r\n  this.b = b;\r\n  this.c = c;\r\n\r\n  this.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n  this.vertexNormals = normal instanceof Array ? normal : [];\r\n\r\n  this.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n  this.vertexColors = color instanceof Array ? color : [];\r\n\r\n  this.vertexTangents = [];\r\n\r\n  this.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n  constructor: THREE.Face3,\r\n\r\n  clone: function() {\r\n\r\n    var face = new THREE.Face3(this.a, this.b, this.c);\r\n\r\n    face.normal.copy(this.normal);\r\n    face.color.copy(this.color);\r\n\r\n    face.materialIndex = this.materialIndex;\r\n\r\n    for (var i = 0, il = this.vertexNormals.length; i < il; i++) {\r\n\r\n      face.vertexNormals[i] = this.vertexNormals[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexColors.length; i < il; i++) {\r\n\r\n      face.vertexColors[i] = this.vertexColors[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexTangents.length; i < il; i++) {\r\n\r\n      face.vertexTangents[i] = this.vertexTangents[i].clone();\r\n\r\n    }\r\n\r\n    return face;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Face4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Face4 = function(a, b, c, d, normal, color, materialIndex) {\r\n\r\n  THREE.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.')\r\n  return new THREE.Face3(a, b, c, normal, color, materialIndex);\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function(array, itemSize) {\r\n\r\n  this.array = array;\r\n  this.itemSize = itemSize;\r\n\r\n  this.needsUpdate = false;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n  constructor: THREE.BufferAttribute,\r\n\r\n  get length() {\r\n\r\n    return this.array.length;\r\n\r\n  },\r\n\r\n  copyAt: function(index1, attribute, index2) {\r\n\r\n    index1 *= this.itemSize;\r\n    index2 *= attribute.itemSize;\r\n\r\n    for (var i = 0, l = this.itemSize; i < l; i++) {\r\n\r\n      this.array[index1 + i] = attribute.array[index2 + i];\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  set: function(value, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.array.set(value, offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(index, x) {\r\n\r\n    this.array[index * this.itemSize] = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(index, y) {\r\n\r\n    this.array[index * this.itemSize + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(index, z) {\r\n\r\n    this.array[index * this.itemSize + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXY: function(index, x, y) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZ: function(index, x, y, z) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZW: function(index, x, y, z, w) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n    this.array[index + 3] = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.BufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n  }\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\n// File:src/core/DynamicBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DynamicBufferAttribute = function(array, itemSize) {\r\n\r\n  THREE.BufferAttribute.call(this, array, itemSize);\r\n\r\n  this.updateRange = {\r\n    offset: 0,\r\n    count: -1\r\n  };\r\n\r\n};\r\n\r\nTHREE.DynamicBufferAttribute.prototype = Object.create(THREE.BufferAttribute.prototype);\r\nTHREE.DynamicBufferAttribute.prototype.constructor = THREE.DynamicBufferAttribute;\r\n\r\nTHREE.DynamicBufferAttribute.prototype.clone = function() {\r\n\r\n  return new THREE.DynamicBufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n};\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'BufferGeometry';\r\n\r\n  this.attributes = {};\r\n  this.attributesKeys = [];\r\n\r\n  this.drawcalls = [];\r\n  this.offsets = this.drawcalls; // backwards compatibility\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n  constructor: THREE.BufferGeometry,\r\n\r\n  addAttribute: function(name, attribute) {\r\n\r\n    if (attribute instanceof THREE.BufferAttribute === false) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).');\r\n\r\n      this.attributes[name] = {\r\n        array: arguments[1],\r\n        itemSize: arguments[2]\r\n      };\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    this.attributes[name] = attribute;\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n  },\r\n\r\n  getAttribute: function(name) {\r\n\r\n    return this.attributes[name];\r\n\r\n  },\r\n\r\n  addDrawCall: function(start, count, indexOffset) {\r\n\r\n    this.drawcalls.push({\r\n\r\n      start: start,\r\n      count: count,\r\n      index: indexOffset !== undefined ? indexOffset : 0\r\n\r\n    });\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var position = this.attributes.position;\r\n\r\n    if (position !== undefined) {\r\n\r\n      matrix.applyToVector3Array(position.array);\r\n      position.needsUpdate = true;\r\n\r\n    }\r\n\r\n    var normal = this.attributes.normal;\r\n\r\n    if (normal !== undefined) {\r\n\r\n      var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n      normalMatrix.applyToVector3Array(normal.array);\r\n      normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  fromGeometry: function(geometry, settings) {\r\n\r\n    settings = settings || {\r\n      'vertexColors': THREE.NoColors\r\n    };\r\n\r\n    var vertices = geometry.vertices;\r\n    var faces = geometry.faces;\r\n    var faceVertexUvs = geometry.faceVertexUvs;\r\n    var vertexColors = settings.vertexColors;\r\n    var hasFaceVertexUv = faceVertexUvs[0].length > 0;\r\n    var hasFaceVertexNormals = faces[0].vertexNormals.length == 3;\r\n\r\n    var positions = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('position', new THREE.BufferAttribute(positions, 3));\r\n\r\n    var normals = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n\r\n    if (vertexColors !== THREE.NoColors) {\r\n\r\n      var colors = new Float32Array(faces.length * 3 * 3);\r\n      this.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n    }\r\n\r\n    if (hasFaceVertexUv === true) {\r\n\r\n      var uvs = new Float32Array(faces.length * 3 * 2);\r\n      this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n    }\r\n\r\n    for (var i = 0, i2 = 0, i3 = 0; i < faces.length; i++, i2 += 6, i3 += 9) {\r\n\r\n      var face = faces[i];\r\n\r\n      var a = vertices[face.a];\r\n      var b = vertices[face.b];\r\n      var c = vertices[face.c];\r\n\r\n      positions[i3] = a.x;\r\n      positions[i3 + 1] = a.y;\r\n      positions[i3 + 2] = a.z;\r\n\r\n      positions[i3 + 3] = b.x;\r\n      positions[i3 + 4] = b.y;\r\n      positions[i3 + 5] = b.z;\r\n\r\n      positions[i3 + 6] = c.x;\r\n      positions[i3 + 7] = c.y;\r\n      positions[i3 + 8] = c.z;\r\n\r\n      if (hasFaceVertexNormals === true) {\r\n\r\n        var na = face.vertexNormals[0];\r\n        var nb = face.vertexNormals[1];\r\n        var nc = face.vertexNormals[2];\r\n\r\n        normals[i3] = na.x;\r\n        normals[i3 + 1] = na.y;\r\n        normals[i3 + 2] = na.z;\r\n\r\n        normals[i3 + 3] = nb.x;\r\n        normals[i3 + 4] = nb.y;\r\n        normals[i3 + 5] = nb.z;\r\n\r\n        normals[i3 + 6] = nc.x;\r\n        normals[i3 + 7] = nc.y;\r\n        normals[i3 + 8] = nc.z;\r\n\r\n      }\r\n      else {\r\n\r\n        var n = face.normal;\r\n\r\n        normals[i3] = n.x;\r\n        normals[i3 + 1] = n.y;\r\n        normals[i3 + 2] = n.z;\r\n\r\n        normals[i3 + 3] = n.x;\r\n        normals[i3 + 4] = n.y;\r\n        normals[i3 + 5] = n.z;\r\n\r\n        normals[i3 + 6] = n.x;\r\n        normals[i3 + 7] = n.y;\r\n        normals[i3 + 8] = n.z;\r\n\r\n      }\r\n\r\n      if (vertexColors === THREE.FaceColors) {\r\n\r\n        var fc = face.color;\r\n\r\n        colors[i3] = fc.r;\r\n        colors[i3 + 1] = fc.g;\r\n        colors[i3 + 2] = fc.b;\r\n\r\n        colors[i3 + 3] = fc.r;\r\n        colors[i3 + 4] = fc.g;\r\n        colors[i3 + 5] = fc.b;\r\n\r\n        colors[i3 + 6] = fc.r;\r\n        colors[i3 + 7] = fc.g;\r\n        colors[i3 + 8] = fc.b;\r\n\r\n      }\r\n      else if (vertexColors === THREE.VertexColors) {\r\n\r\n        var vca = face.vertexColors[0];\r\n        var vcb = face.vertexColors[1];\r\n        var vcc = face.vertexColors[2];\r\n\r\n        colors[i3] = vca.r;\r\n        colors[i3 + 1] = vca.g;\r\n        colors[i3 + 2] = vca.b;\r\n\r\n        colors[i3 + 3] = vcb.r;\r\n        colors[i3 + 4] = vcb.g;\r\n        colors[i3 + 5] = vcb.b;\r\n\r\n        colors[i3 + 6] = vcc.r;\r\n        colors[i3 + 7] = vcc.g;\r\n        colors[i3 + 8] = vcc.b;\r\n\r\n      }\r\n\r\n      if (hasFaceVertexUv === true) {\r\n\r\n        var uva = faceVertexUvs[0][i][0];\r\n        var uvb = faceVertexUvs[0][i][1];\r\n        var uvc = faceVertexUvs[0][i][2];\r\n\r\n        uvs[i2] = uva.x;\r\n        uvs[i2 + 1] = uva.y;\r\n\r\n        uvs[i2 + 2] = uvb.x;\r\n        uvs[i2 + 3] = uvb.y;\r\n\r\n        uvs[i2 + 4] = uvc.x;\r\n        uvs[i2 + 5] = uvc.y;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeBoundingSphere()\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingBox === null) {\r\n\r\n        this.boundingBox = new THREE.Box3();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        var bb = this.boundingBox;\r\n        bb.makeEmpty();\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          bb.expandByPoint(vector);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (positions === undefined || positions.length === 0) {\r\n\r\n        this.boundingBox.min.set(0, 0, 0);\r\n        this.boundingBox.max.set(0, 0, 0);\r\n\r\n      }\r\n\r\n      if (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) {\r\n\r\n        THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    var box = new THREE.Box3();\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingSphere === null) {\r\n\r\n        this.boundingSphere = new THREE.Sphere();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        box.makeEmpty();\r\n\r\n        var center = this.boundingSphere.center;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          box.expandByPoint(vector);\r\n\r\n        }\r\n\r\n        box.center(center);\r\n\r\n        // hoping to find a boundingSphere with a radius smaller than the\r\n        // boundingSphere of the boundingBox:  sqrt(3) smaller in the best case\r\n\r\n        var maxRadiusSq = 0;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n\r\n        }\r\n\r\n        this.boundingSphere.radius = Math.sqrt(maxRadiusSq);\r\n\r\n        if (isNaN(this.boundingSphere.radius)) {\r\n\r\n          THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.');\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    // backwards compatibility\r\n\r\n  },\r\n\r\n  computeVertexNormals: function() {\r\n\r\n    var attributes = this.attributes;\r\n\r\n    if (attributes.position) {\r\n\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.normal === undefined) {\r\n\r\n        this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(positions.length), 3));\r\n\r\n      }\r\n      else {\r\n\r\n        // reset existing normals to zero\r\n\r\n        var normals = attributes.normal.array;\r\n\r\n        for (var i = 0, il = normals.length; i < il; i++) {\r\n\r\n          normals[i] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var normals = attributes.normal.array;\r\n\r\n      var vA, vB, vC,\r\n\r\n        pA = new THREE.Vector3(),\r\n        pB = new THREE.Vector3(),\r\n        pC = new THREE.Vector3(),\r\n\r\n        cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      // indexed elements\r\n\r\n      if (attributes.index) {\r\n\r\n        var indices = attributes.index.array;\r\n\r\n        var offsets = (this.offsets.length > 0 ? this.offsets : [{\r\n          start: 0,\r\n          count: indices.length,\r\n          index: 0\r\n        }]);\r\n\r\n        for (var j = 0, jl = offsets.length; j < jl; ++j) {\r\n\r\n          var start = offsets[j].start;\r\n          var count = offsets[j].count;\r\n          var index = offsets[j].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            vA = (index + indices[i]) * 3;\r\n            vB = (index + indices[i + 1]) * 3;\r\n            vC = (index + indices[i + 2]) * 3;\r\n\r\n            pA.fromArray(positions, vA);\r\n            pB.fromArray(positions, vB);\r\n            pC.fromArray(positions, vC);\r\n\r\n            cb.subVectors(pC, pB);\r\n            ab.subVectors(pA, pB);\r\n            cb.cross(ab);\r\n\r\n            normals[vA] += cb.x;\r\n            normals[vA + 1] += cb.y;\r\n            normals[vA + 2] += cb.z;\r\n\r\n            normals[vB] += cb.x;\r\n            normals[vB + 1] += cb.y;\r\n            normals[vB + 2] += cb.z;\r\n\r\n            normals[vC] += cb.x;\r\n            normals[vC + 1] += cb.y;\r\n            normals[vC + 2] += cb.z;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed elements (unconnected triangle soup)\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 9) {\r\n\r\n          pA.fromArray(positions, i);\r\n          pB.fromArray(positions, i + 3);\r\n          pC.fromArray(positions, i + 6);\r\n\r\n          cb.subVectors(pC, pB);\r\n          ab.subVectors(pA, pB);\r\n          cb.cross(ab);\r\n\r\n          normals[i] = cb.x;\r\n          normals[i + 1] = cb.y;\r\n          normals[i + 2] = cb.z;\r\n\r\n          normals[i + 3] = cb.x;\r\n          normals[i + 4] = cb.y;\r\n          normals[i + 5] = cb.z;\r\n\r\n          normals[i + 6] = cb.x;\r\n          normals[i + 7] = cb.y;\r\n          normals[i + 8] = cb.z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.normalizeNormals();\r\n\r\n      attributes.normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // (per vertex tangents)\r\n\r\n    if (this.attributes.index === undefined ||\r\n      this.attributes.position === undefined ||\r\n      this.attributes.normal === undefined ||\r\n      this.attributes.uv === undefined) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');\r\n      return;\r\n\r\n    }\r\n\r\n    var indices = this.attributes.index.array;\r\n    var positions = this.attributes.position.array;\r\n    var normals = this.attributes.normal.array;\r\n    var uvs = this.attributes.uv.array;\r\n\r\n    var nVertices = positions.length / 3;\r\n\r\n    if (this.attributes.tangent === undefined) {\r\n\r\n      this.addAttribute('tangent', new THREE.BufferAttribute(new Float32Array(4 * nVertices), 4));\r\n\r\n    }\r\n\r\n    var tangents = this.attributes.tangent.array;\r\n\r\n    var tan1 = [],\r\n      tan2 = [];\r\n\r\n    for (var k = 0; k < nVertices; k++) {\r\n\r\n      tan1[k] = new THREE.Vector3();\r\n      tan2[k] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var vA = new THREE.Vector3(),\r\n      vB = new THREE.Vector3(),\r\n      vC = new THREE.Vector3(),\r\n\r\n      uvA = new THREE.Vector2(),\r\n      uvB = new THREE.Vector2(),\r\n      uvC = new THREE.Vector2(),\r\n\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r;\r\n\r\n    var sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3();\r\n\r\n    function handleTriangle(a, b, c) {\r\n\r\n      vA.fromArray(positions, a * 3);\r\n      vB.fromArray(positions, b * 3);\r\n      vC.fromArray(positions, c * 3);\r\n\r\n      uvA.fromArray(uvs, a * 2);\r\n      uvB.fromArray(uvs, b * 2);\r\n      uvC.fromArray(uvs, c * 2);\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n\r\n      sdir.set(\r\n        (t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r\r\n      );\r\n\r\n      tdir.set(\r\n        (s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r\r\n      );\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    var i, il;\r\n    var j, jl;\r\n    var iA, iB, iC;\r\n\r\n    if (this.drawcalls.length === 0) {\r\n\r\n      this.addDrawCall(0, indices.length, 0);\r\n\r\n    }\r\n\r\n    var drawcalls = this.drawcalls;\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleTriangle(iA, iB, iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3();\r\n    var n = new THREE.Vector3(),\r\n      n2 = new THREE.Vector3();\r\n    var w, t, test;\r\n\r\n    function handleVertex(v) {\r\n\r\n      n.fromArray(normals, v * 3);\r\n      n2.copy(n);\r\n\r\n      t = tan1[v];\r\n\r\n      // Gram-Schmidt orthogonalize\r\n\r\n      tmp.copy(t);\r\n      tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n      // Calculate handedness\r\n\r\n      tmp2.crossVectors(n2, t);\r\n      test = tmp2.dot(tan2[v]);\r\n      w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n      tangents[v * 4] = tmp.x;\r\n      tangents[v * 4 + 1] = tmp.y;\r\n      tangents[v * 4 + 2] = tmp.z;\r\n      tangents[v * 4 + 3] = w;\r\n\r\n    }\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleVertex(iA);\r\n        handleVertex(iB);\r\n        handleVertex(iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  Compute the draw offset for large models by chunking the index buffer into chunks of 65k addressable vertices.\r\n  This method will effectively rewrite the index buffer and remap all attributes to match the new indices.\r\n  WARNING: This method will also expand the vertex count to prevent sprawled triangles across draw offsets.\r\n  size - Defaults to 65535, but allows for larger or smaller chunks.\r\n  */\r\n  computeOffsets: function(size) {\r\n\r\n    if (size === undefined) size = 65535; // WebGL limits type of index buffer values to 16-bit.\r\n\r\n    var indices = this.attributes.index.array;\r\n    var vertices = this.attributes.position.array;\r\n\r\n    var facesCount = (indices.length / 3);\r\n\r\n    /*\r\n    console.log(\"Computing buffers in offsets of \"+size+\" -> indices:\"+indices.length+\" vertices:\"+vertices.length);\r\n    console.log(\"Faces to process: \"+(indices.length/3));\r\n    console.log(\"Reordering \"+verticesCount+\" vertices.\");\r\n    */\r\n\r\n    var sortedIndices = new Uint16Array(indices.length); //16-bit buffers\r\n    var indexPtr = 0;\r\n    var vertexPtr = 0;\r\n\r\n    var offsets = [{\r\n      start: 0,\r\n      count: 0,\r\n      index: 0\r\n    }];\r\n    var offset = offsets[0];\r\n\r\n    var duplicatedVertices = 0;\r\n    var newVerticeMaps = 0;\r\n    var faceVertices = new Int32Array(6);\r\n    var vertexMap = new Int32Array(vertices.length);\r\n    var revVertexMap = new Int32Array(vertices.length);\r\n    for (var j = 0; j < vertices.length; j++) {\r\n      vertexMap[j] = -1;\r\n      revVertexMap[j] = -1;\r\n    }\r\n\r\n    /*\r\n    \tTraverse every face and reorder vertices in the proper offsets of 65k.\r\n    \tWe can have more than 65k entries in the index buffer per offset, but only reference 65k values.\r\n    */\r\n    for (var findex = 0; findex < facesCount; findex++) {\r\n      newVerticeMaps = 0;\r\n\r\n      for (var vo = 0; vo < 3; vo++) {\r\n        var vid = indices[findex * 3 + vo];\r\n        if (vertexMap[vid] == -1) {\r\n          //Unmapped vertice\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          newVerticeMaps++;\r\n        }\r\n        else if (vertexMap[vid] < offset.index) {\r\n          //Reused vertices from previous block (duplicate)\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          duplicatedVertices++;\r\n        }\r\n        else {\r\n          //Reused vertice in the current block\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = vertexMap[vid];\r\n        }\r\n      }\r\n\r\n      var faceMax = vertexPtr + newVerticeMaps;\r\n      if (faceMax > (offset.index + size)) {\r\n        var new_offset = {\r\n          start: indexPtr,\r\n          count: 0,\r\n          index: vertexPtr\r\n        };\r\n        offsets.push(new_offset);\r\n        offset = new_offset;\r\n\r\n        //Re-evaluate reused vertices in light of new offset.\r\n        for (var v = 0; v < 6; v += 2) {\r\n          var new_vid = faceVertices[v + 1];\r\n          if (new_vid > -1 && new_vid < offset.index)\r\n            faceVertices[v + 1] = -1;\r\n        }\r\n      }\r\n\r\n      //Reindex the face.\r\n      for (var v = 0; v < 6; v += 2) {\r\n        var vid = faceVertices[v];\r\n        var new_vid = faceVertices[v + 1];\r\n\r\n        if (new_vid === -1)\r\n          new_vid = vertexPtr++;\r\n\r\n        vertexMap[vid] = new_vid;\r\n        revVertexMap[new_vid] = vid;\r\n        sortedIndices[indexPtr++] = new_vid - offset.index; //XXX overflows at 16bit\r\n        offset.count++;\r\n      }\r\n    }\r\n\r\n    /* Move all attribute values to map to the new computed indices , also expand the vertice stack to match our new vertexPtr. */\r\n    this.reorderBuffers(sortedIndices, revVertexMap, vertexPtr);\r\n    this.offsets = offsets; // TODO: Deprecate\r\n    this.drawcalls = offsets;\r\n\r\n    /*\r\n    var orderTime = Date.now();\r\n    console.log(\"Reorder time: \"+(orderTime-s)+\"ms\");\r\n    console.log(\"Duplicated \"+duplicatedVertices+\" vertices.\");\r\n    console.log(\"Compute Buffers time: \"+(Date.now()-s)+\"ms\");\r\n    console.log(\"Draw offsets: \"+offsets.length);\r\n    */\r\n\r\n    return offsets;\r\n\r\n  },\r\n\r\n  merge: function(geometry, offset) {\r\n\r\n    if (geometry instanceof THREE.BufferGeometry === false) {\r\n\r\n      THREE.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    var attributes = this.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      if (geometry.attributes[key] === undefined) continue;\r\n\r\n      var attribute1 = attributes[key];\r\n      var attributeArray1 = attribute1.array;\r\n\r\n      var attribute2 = geometry.attributes[key];\r\n      var attributeArray2 = attribute2.array;\r\n\r\n      var attributeSize = attribute2.itemSize;\r\n\r\n      for (var i = 0, j = attributeSize * offset; i < attributeArray2.length; i++, j++) {\r\n\r\n        attributeArray1[j] = attributeArray2[i];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalizeNormals: function() {\r\n\r\n    var normals = this.attributes.normal.array;\r\n\r\n    var x, y, z, n;\r\n\r\n    for (var i = 0, il = normals.length; i < il; i += 3) {\r\n\r\n      x = normals[i];\r\n      y = normals[i + 1];\r\n      z = normals[i + 2];\r\n\r\n      n = 1.0 / Math.sqrt(x * x + y * y + z * z);\r\n\r\n      normals[i] *= n;\r\n      normals[i + 1] *= n;\r\n      normals[i + 2] *= n;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  \treoderBuffers:\r\n  \tReorder attributes based on a new indexBuffer and indexMap.\r\n  \tindexBuffer - Uint16Array of the new ordered indices.\r\n  \tindexMap - Int32Array where the position is the new vertex ID and the value the old vertex ID for each vertex.\r\n  \tvertexCount - Amount of total vertices considered in this reordering (in case you want to grow the vertice stack).\r\n  */\r\n  reorderBuffers: function(indexBuffer, indexMap, vertexCount) {\r\n\r\n    /* Create a copy of all attributes for reordering. */\r\n    var sortedAttributes = {};\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      var sourceArray = this.attributes[attr].array;\r\n      sortedAttributes[attr] = new sourceArray.constructor(this.attributes[attr].itemSize * vertexCount);\r\n    }\r\n\r\n    /* Move attribute positions based on the new index map */\r\n    for (var new_vid = 0; new_vid < vertexCount; new_vid++) {\r\n      var vid = indexMap[new_vid];\r\n      for (var attr in this.attributes) {\r\n        if (attr == 'index')\r\n          continue;\r\n        var attrArray = this.attributes[attr].array;\r\n        var attrSize = this.attributes[attr].itemSize;\r\n        var sortedAttr = sortedAttributes[attr];\r\n        for (var k = 0; k < attrSize; k++)\r\n          sortedAttr[new_vid * attrSize + k] = attrArray[vid * attrSize + k];\r\n      }\r\n    }\r\n\r\n    /* Carry the new sorted buffers locally */\r\n    this.attributes['index'].array = indexBuffer;\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      this.attributes[attr].array = sortedAttributes[attr];\r\n      this.attributes[attr].numItems = this.attributes[attr].itemSize * vertexCount;\r\n    }\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      data: {\r\n        attributes: {}\r\n      }\r\n    };\r\n\r\n    var attributes = this.attributes;\r\n    var offsets = this.offsets;\r\n    var boundingSphere = this.boundingSphere;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n\r\n      var array = Array.prototype.slice.call(attribute.array);\r\n\r\n      output.data.attributes[key] = {\r\n        itemSize: attribute.itemSize,\r\n        type: attribute.array.constructor.name,\r\n        array: array\r\n      }\r\n\r\n    }\r\n\r\n    if (offsets.length > 0) {\r\n\r\n      output.data.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    if (boundingSphere !== null) {\r\n\r\n      output.data.boundingSphere = {\r\n        center: boundingSphere.center.toArray(),\r\n        radius: boundingSphere.radius\r\n      }\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    for (var attr in this.attributes) {\r\n\r\n      var sourceAttr = this.attributes[attr];\r\n      geometry.addAttribute(attr, sourceAttr.clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.offsets.length; i < il; i++) {\r\n\r\n      var offset = this.offsets[i];\r\n\r\n      geometry.offsets.push({\r\n\r\n        start: offset.start,\r\n        index: offset.index,\r\n        count: offset.count\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Geometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Geometry';\r\n\r\n  this.vertices = [];\r\n  this.colors = []; // one-to-one vertex colors, used in Points and Line\r\n\r\n  this.faces = [];\r\n\r\n  this.faceVertexUvs = [\r\n    []\r\n  ];\r\n\r\n  this.morphTargets = [];\r\n  this.morphColors = [];\r\n  this.morphNormals = [];\r\n\r\n  this.skinWeights = [];\r\n  this.skinIndices = [];\r\n\r\n  this.lineDistances = [];\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n  this.hasTangents = false;\r\n\r\n  this.dynamic = true; // the intermediate typed arrays will be deleted when set to false\r\n\r\n  // update flags\r\n\r\n  this.verticesNeedUpdate = false;\r\n  this.elementsNeedUpdate = false;\r\n  this.uvsNeedUpdate = false;\r\n  this.normalsNeedUpdate = false;\r\n  this.tangentsNeedUpdate = false;\r\n  this.colorsNeedUpdate = false;\r\n  this.lineDistancesNeedUpdate = false;\r\n\r\n  this.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n  constructor: THREE.Geometry,\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    for (var i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertex.applyMatrix4(matrix);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      var face = this.faces[i];\r\n      face.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        face.vertexNormals[j].applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n    this.verticesNeedUpdate = true;\r\n    this.normalsNeedUpdate = true;\r\n\r\n  },\r\n\r\n  fromBufferGeometry: function(geometry) {\r\n\r\n    var scope = this;\r\n\r\n    var attributes = geometry.attributes;\r\n\r\n    var vertices = attributes.position.array;\r\n    var indices = attributes.index !== undefined ? attributes.index.array : undefined;\r\n    var normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n    var colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n    var uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\r\n    var tempNormals = [];\r\n    var tempUVs = [];\r\n\r\n    for (var i = 0, j = 0; i < vertices.length; i += 3, j += 2) {\r\n\r\n      scope.vertices.push(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n      if (normals !== undefined) {\r\n\r\n        tempNormals.push(new THREE.Vector3(normals[i], normals[i + 1], normals[i + 2]));\r\n\r\n      }\r\n\r\n      if (colors !== undefined) {\r\n\r\n        scope.colors.push(new THREE.Color(colors[i], colors[i + 1], colors[i + 2]));\r\n\r\n      }\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        tempUVs.push(new THREE.Vector2(uvs[j], uvs[j + 1]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var addFace = function(a, b, c) {\r\n\r\n      var vertexNormals = normals !== undefined ? [tempNormals[a].clone(), tempNormals[b].clone(), tempNormals[c].clone()] : [];\r\n      var vertexColors = colors !== undefined ? [scope.colors[a].clone(), scope.colors[b].clone(), scope.colors[c].clone()] : [];\r\n\r\n      scope.faces.push(new THREE.Face3(a, b, c, vertexNormals, vertexColors));\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        scope.faceVertexUvs[0].push([tempUVs[a].clone(), tempUVs[b].clone(), tempUVs[c].clone()]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (indices !== undefined) {\r\n\r\n      var drawcalls = geometry.drawcalls;\r\n\r\n      if (drawcalls.length > 0) {\r\n\r\n        for (var i = 0; i < drawcalls.length; i++) {\r\n\r\n          var drawcall = drawcalls[i];\r\n\r\n          var start = drawcall.start;\r\n          var count = drawcall.count;\r\n          var index = drawcall.index;\r\n\r\n          for (var j = start, jl = start + count; j < jl; j += 3) {\r\n\r\n            addFace(index + indices[j], index + indices[j + 1], index + indices[j + 2]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        for (var i = 0; i < indices.length; i += 3) {\r\n\r\n          addFace(indices[i], indices[i + 1], indices[i + 2]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (var i = 0; i < vertices.length / 3; i += 3) {\r\n\r\n        addFace(i, i + 1, i + 2);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeFaceNormals();\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      this.boundingBox = geometry.boundingBox.clone();\r\n\r\n    }\r\n\r\n    if (geometry.boundingSphere !== null) {\r\n\r\n      this.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    var cb = new THREE.Vector3(),\r\n      ab = new THREE.Vector3();\r\n\r\n    for (var f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      var face = this.faces[f];\r\n\r\n      var vA = this.vertices[face.a];\r\n      var vB = this.vertices[face.b];\r\n      var vC = this.vertices[face.c];\r\n\r\n      cb.subVectors(vC, vB);\r\n      ab.subVectors(vA, vB);\r\n      cb.cross(ab);\r\n\r\n      cb.normalize();\r\n\r\n      face.normal.copy(cb);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeVertexNormals: function(areaWeighted) {\r\n\r\n    var v, vl, f, fl, face, vertices;\r\n\r\n    vertices = new Array(this.vertices.length);\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    if (areaWeighted) {\r\n\r\n      // vertex normals weighted by triangle areas\r\n      // http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n      var vA, vB, vC;\r\n      var cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vA = this.vertices[face.a];\r\n        vB = this.vertices[face.b];\r\n        vC = this.vertices[face.c];\r\n\r\n        cb.subVectors(vC, vB);\r\n        ab.subVectors(vA, vB);\r\n        cb.cross(ab);\r\n\r\n        vertices[face.a].add(cb);\r\n        vertices[face.b].add(cb);\r\n        vertices[face.c].add(cb);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vertices[face.a].add(face.normal);\r\n        vertices[face.b].add(face.normal);\r\n        vertices[face.c].add(face.normal);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v].normalize();\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.vertexNormals[0] = vertices[face.a].clone();\r\n      face.vertexNormals[1] = vertices[face.b].clone();\r\n      face.vertexNormals[2] = vertices[face.c].clone();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeMorphNormals: function() {\r\n\r\n    var i, il, f, fl, face;\r\n\r\n    // save original normals\r\n    // - create temp variables on first access\r\n    //   otherwise just copy (for faster repeated calls)\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      if (!face.__originalFaceNormal) {\r\n\r\n        face.__originalFaceNormal = face.normal.clone();\r\n\r\n      }\r\n      else {\r\n\r\n        face.__originalFaceNormal.copy(face.normal);\r\n\r\n      }\r\n\r\n      if (!face.__originalVertexNormals) face.__originalVertexNormals = [];\r\n\r\n      for (i = 0, il = face.vertexNormals.length; i < il; i++) {\r\n\r\n        if (!face.__originalVertexNormals[i]) {\r\n\r\n          face.__originalVertexNormals[i] = face.vertexNormals[i].clone();\r\n\r\n        }\r\n        else {\r\n\r\n          face.__originalVertexNormals[i].copy(face.vertexNormals[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // use temp geometry to compute face and vertex normals for each morph\r\n\r\n    var tmpGeo = new THREE.Geometry();\r\n    tmpGeo.faces = this.faces;\r\n\r\n    for (i = 0, il = this.morphTargets.length; i < il; i++) {\r\n\r\n      // create on first access\r\n\r\n      if (!this.morphNormals[i]) {\r\n\r\n        this.morphNormals[i] = {};\r\n        this.morphNormals[i].faceNormals = [];\r\n        this.morphNormals[i].vertexNormals = [];\r\n\r\n        var dstNormalsFace = this.morphNormals[i].faceNormals;\r\n        var dstNormalsVertex = this.morphNormals[i].vertexNormals;\r\n\r\n        var faceNormal, vertexNormals;\r\n\r\n        for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n          faceNormal = new THREE.Vector3();\r\n          vertexNormals = {\r\n            a: new THREE.Vector3(),\r\n            b: new THREE.Vector3(),\r\n            c: new THREE.Vector3()\r\n          };\r\n\r\n          dstNormalsFace.push(faceNormal);\r\n          dstNormalsVertex.push(vertexNormals);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var morphNormals = this.morphNormals[i];\r\n\r\n      // set vertices to morph target\r\n\r\n      tmpGeo.vertices = this.morphTargets[i].vertices;\r\n\r\n      // compute morph normals\r\n\r\n      tmpGeo.computeFaceNormals();\r\n      tmpGeo.computeVertexNormals();\r\n\r\n      // store morph normals\r\n\r\n      var faceNormal, vertexNormals;\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        faceNormal = morphNormals.faceNormals[f];\r\n        vertexNormals = morphNormals.vertexNormals[f];\r\n\r\n        faceNormal.copy(face.normal);\r\n\r\n        vertexNormals.a.copy(face.vertexNormals[0]);\r\n        vertexNormals.b.copy(face.vertexNormals[1]);\r\n        vertexNormals.c.copy(face.vertexNormals[2]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore original normals\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.normal = face.__originalFaceNormal;\r\n      face.vertexNormals = face.__originalVertexNormals;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // tangents go to vertices\r\n\r\n    var f, fl, v, vl, i, vertexIndex,\r\n      face, uv, vA, vB, vC, uvA, uvB, uvC,\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r, t, test,\r\n      tan1 = [],\r\n      tan2 = [],\r\n      sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3(),\r\n      tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3(),\r\n      n = new THREE.Vector3(),\r\n      w;\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      tan1[v] = new THREE.Vector3();\r\n      tan2[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    function handleTriangle(context, a, b, c, ua, ub, uc) {\r\n\r\n      vA = context.vertices[a];\r\n      vB = context.vertices[b];\r\n      vC = context.vertices[c];\r\n\r\n      uvA = uv[ua];\r\n      uvB = uv[ub];\r\n      uvC = uv[uc];\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n      sdir.set((t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r);\r\n      tdir.set((s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r);\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n      uv = this.faceVertexUvs[0][f]; // use UV layer 0 for tangents\r\n\r\n      handleTriangle(this, face.a, face.b, face.c, 0, 1, 2);\r\n\r\n    }\r\n\r\n    var faceIndex = ['a', 'b', 'c', 'd'];\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      for (i = 0; i < Math.min(face.vertexNormals.length, 3); i++) {\r\n\r\n        n.copy(face.vertexNormals[i]);\r\n\r\n        vertexIndex = face[faceIndex[i]];\r\n\r\n        t = tan1[vertexIndex];\r\n\r\n        // Gram-Schmidt orthogonalize\r\n\r\n        tmp.copy(t);\r\n        tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n        // Calculate handedness\r\n\r\n        tmp2.crossVectors(face.vertexNormals[i], t);\r\n        test = tmp2.dot(tan2[vertexIndex]);\r\n        w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n        face.vertexTangents[i] = new THREE.Vector4(tmp.x, tmp.y, tmp.z, w);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.hasTangents = true;\r\n\r\n  },\r\n\r\n  computeLineDistances: function() {\r\n\r\n    var d = 0;\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      if (i > 0) {\r\n\r\n        d += vertices[i].distanceTo(vertices[i - 1]);\r\n\r\n      }\r\n\r\n      this.lineDistances[i] = d;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    if (this.boundingBox === null) {\r\n\r\n      this.boundingBox = new THREE.Box3();\r\n\r\n    }\r\n\r\n    this.boundingBox.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    if (this.boundingSphere === null) {\r\n\r\n      this.boundingSphere = new THREE.Sphere();\r\n\r\n    }\r\n\r\n    this.boundingSphere.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  merge: function(geometry, matrix, materialIndexOffset) {\r\n\r\n    if (geometry instanceof THREE.Geometry === false) {\r\n\r\n      THREE.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    var normalMatrix,\r\n      vertexOffset = this.vertices.length,\r\n      vertices1 = this.vertices,\r\n      vertices2 = geometry.vertices,\r\n      faces1 = this.faces,\r\n      faces2 = geometry.faces,\r\n      uvs1 = this.faceVertexUvs[0],\r\n      uvs2 = geometry.faceVertexUvs[0];\r\n\r\n    if (materialIndexOffset === undefined) materialIndexOffset = 0;\r\n\r\n    if (matrix !== undefined) {\r\n\r\n      normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    for (var i = 0, il = vertices2.length; i < il; i++) {\r\n\r\n      var vertex = vertices2[i];\r\n\r\n      var vertexCopy = vertex.clone();\r\n\r\n      if (matrix !== undefined) vertexCopy.applyMatrix4(matrix);\r\n\r\n      vertices1.push(vertexCopy);\r\n\r\n    }\r\n\r\n    // faces\r\n\r\n    for (i = 0, il = faces2.length; i < il; i++) {\r\n\r\n      var face = faces2[i],\r\n        faceCopy, normal, color,\r\n        faceVertexNormals = face.vertexNormals,\r\n        faceVertexColors = face.vertexColors;\r\n\r\n      faceCopy = new THREE.Face3(face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset);\r\n      faceCopy.normal.copy(face.normal);\r\n\r\n      if (normalMatrix !== undefined) {\r\n\r\n        faceCopy.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexNormals.length; j < jl; j++) {\r\n\r\n        normal = faceVertexNormals[j].clone();\r\n\r\n        if (normalMatrix !== undefined) {\r\n\r\n          normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n        }\r\n\r\n        faceCopy.vertexNormals.push(normal);\r\n\r\n      }\r\n\r\n      faceCopy.color.copy(face.color);\r\n\r\n      for (var j = 0, jl = faceVertexColors.length; j < jl; j++) {\r\n\r\n        color = faceVertexColors[j];\r\n        faceCopy.vertexColors.push(color.clone());\r\n\r\n      }\r\n\r\n      faceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n      faces1.push(faceCopy);\r\n\r\n    }\r\n\r\n    // uvs\r\n\r\n    for (i = 0, il = uvs2.length; i < il; i++) {\r\n\r\n      var uv = uvs2[i],\r\n        uvCopy = [];\r\n\r\n      if (uv === undefined) {\r\n\r\n        continue;\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = uv.length; j < jl; j++) {\r\n\r\n        uvCopy.push(uv[j].clone());\r\n\r\n      }\r\n\r\n      uvs1.push(uvCopy);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  mergeMesh: function(mesh) {\r\n\r\n    if (mesh instanceof THREE.Mesh === false) {\r\n\r\n      THREE.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh);\r\n      return;\r\n\r\n    }\r\n\r\n    mesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n    this.merge(mesh.geometry, mesh.matrix);\r\n\r\n  },\r\n\r\n  /*\r\n   * Checks for duplicate vertices with hashmap.\r\n   * Duplicated vertices are removed\r\n   * and faces' vertices are updated.\r\n   */\r\n\r\n  mergeVertices: function() {\r\n\r\n    var verticesMap = {}; // Hashmap for looking up vertice by position coordinates (and making sure they are unique)\r\n    var unique = [],\r\n      changes = [];\r\n\r\n    var v, key;\r\n    var precisionPoints = 4; // number of decimal points, eg. 4 for epsilon of 0.0001\r\n    var precision = Math.pow(10, precisionPoints);\r\n    var i, il, face;\r\n    var indices, j, jl;\r\n\r\n    for (i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      v = this.vertices[i];\r\n      key = Math.round(v.x * precision) + '_' + Math.round(v.y * precision) + '_' + Math.round(v.z * precision);\r\n\r\n      if (verticesMap[key] === undefined) {\r\n\r\n        verticesMap[key] = i;\r\n        unique.push(this.vertices[i]);\r\n        changes[i] = unique.length - 1;\r\n\r\n      }\r\n      else {\r\n\r\n        //console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n        changes[i] = changes[verticesMap[key]];\r\n\r\n      }\r\n\r\n    };\r\n\r\n\r\n    // if faces are completely degenerate after merging vertices, we\r\n    // have to remove them from the geometry.\r\n    var faceIndicesToRemove = [];\r\n\r\n    for (i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      face = this.faces[i];\r\n\r\n      face.a = changes[face.a];\r\n      face.b = changes[face.b];\r\n      face.c = changes[face.c];\r\n\r\n      indices = [face.a, face.b, face.c];\r\n\r\n      var dupIndex = -1;\r\n\r\n      // if any duplicate vertices are found in a Face3\r\n      // we have to remove the face as nothing can be saved\r\n      for (var n = 0; n < 3; n++) {\r\n        if (indices[n] == indices[(n + 1) % 3]) {\r\n\r\n          dupIndex = n;\r\n          faceIndicesToRemove.push(i);\r\n          break;\r\n\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    for (i = faceIndicesToRemove.length - 1; i >= 0; i--) {\r\n      var idx = faceIndicesToRemove[i];\r\n\r\n      this.faces.splice(idx, 1);\r\n\r\n      for (j = 0, jl = this.faceVertexUvs.length; j < jl; j++) {\r\n\r\n        this.faceVertexUvs[j].splice(idx, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Use unique set of vertices\r\n\r\n    var diff = this.vertices.length - unique.length;\r\n    this.vertices = unique;\r\n    return diff;\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this.parameters !== undefined) {\r\n\r\n      var parameters = this.parameters;\r\n\r\n      for (var key in parameters) {\r\n\r\n        if (parameters[key] !== undefined) output[key] = parameters[key];\r\n\r\n      }\r\n\r\n      return output;\r\n\r\n    }\r\n\r\n    var vertices = [];\r\n\r\n    for (var i = 0; i < this.vertices.length; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertices.push(vertex.x, vertex.y, vertex.z);\r\n\r\n    }\r\n\r\n    var faces = [];\r\n    var normals = [];\r\n    var normalsHash = {};\r\n    var colors = [];\r\n    var colorsHash = {};\r\n    var uvs = [];\r\n    var uvsHash = {};\r\n\r\n    for (var i = 0; i < this.faces.length; i++) {\r\n\r\n      var face = this.faces[i];\r\n\r\n      var hasMaterial = false; // face.materialIndex !== undefined;\r\n      var hasFaceUv = false; // deprecated\r\n      var hasFaceVertexUv = this.faceVertexUvs[0][i] !== undefined;\r\n      var hasFaceNormal = face.normal.length() > 0;\r\n      var hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n      var hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n      var hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n      var faceType = 0;\r\n\r\n      faceType = setBit(faceType, 0, 0);\r\n      faceType = setBit(faceType, 1, hasMaterial);\r\n      faceType = setBit(faceType, 2, hasFaceUv);\r\n      faceType = setBit(faceType, 3, hasFaceVertexUv);\r\n      faceType = setBit(faceType, 4, hasFaceNormal);\r\n      faceType = setBit(faceType, 5, hasFaceVertexNormal);\r\n      faceType = setBit(faceType, 6, hasFaceColor);\r\n      faceType = setBit(faceType, 7, hasFaceVertexColor);\r\n\r\n      faces.push(faceType);\r\n      faces.push(face.a, face.b, face.c);\r\n\r\n\r\n      /*\r\n      if ( hasMaterial ) {\r\n\r\n      \tfaces.push( face.materialIndex );\r\n\r\n      }\r\n      */\r\n\r\n      if (hasFaceVertexUv) {\r\n\r\n        var faceVertexUvs = this.faceVertexUvs[0][i];\r\n\r\n        faces.push(\r\n          getUvIndex(faceVertexUvs[0]),\r\n          getUvIndex(faceVertexUvs[1]),\r\n          getUvIndex(faceVertexUvs[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceNormal) {\r\n\r\n        faces.push(getNormalIndex(face.normal));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexNormal) {\r\n\r\n        var vertexNormals = face.vertexNormals;\r\n\r\n        faces.push(\r\n          getNormalIndex(vertexNormals[0]),\r\n          getNormalIndex(vertexNormals[1]),\r\n          getNormalIndex(vertexNormals[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceColor) {\r\n\r\n        faces.push(getColorIndex(face.color));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexColor) {\r\n\r\n        var vertexColors = face.vertexColors;\r\n\r\n        faces.push(\r\n          getColorIndex(vertexColors[0]),\r\n          getColorIndex(vertexColors[1]),\r\n          getColorIndex(vertexColors[2])\r\n        );\r\n\r\n      }\r\n\r\n    }\r\n\r\n    function setBit(value, position, enabled) {\r\n\r\n      return enabled ? value | (1 << position) : value & (~(1 << position));\r\n\r\n    }\r\n\r\n    function getNormalIndex(normal) {\r\n\r\n      var hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n      if (normalsHash[hash] !== undefined) {\r\n\r\n        return normalsHash[hash];\r\n\r\n      }\r\n\r\n      normalsHash[hash] = normals.length / 3;\r\n      normals.push(normal.x, normal.y, normal.z);\r\n\r\n      return normalsHash[hash];\r\n\r\n    }\r\n\r\n    function getColorIndex(color) {\r\n\r\n      var hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n      if (colorsHash[hash] !== undefined) {\r\n\r\n        return colorsHash[hash];\r\n\r\n      }\r\n\r\n      colorsHash[hash] = colors.length;\r\n      colors.push(color.getHex());\r\n\r\n      return colorsHash[hash];\r\n\r\n    }\r\n\r\n    function getUvIndex(uv) {\r\n\r\n      var hash = uv.x.toString() + uv.y.toString();\r\n\r\n      if (uvsHash[hash] !== undefined) {\r\n\r\n        return uvsHash[hash];\r\n\r\n      }\r\n\r\n      uvsHash[hash] = uvs.length / 2;\r\n      uvs.push(uv.x, uv.y);\r\n\r\n      return uvsHash[hash];\r\n\r\n    }\r\n\r\n    output.data = {};\r\n\r\n    output.data.vertices = vertices;\r\n    output.data.normals = normals;\r\n    if (colors.length > 0) output.data.colors = colors;\r\n    if (uvs.length > 0) output.data.uvs = [uvs]; // temporal backward compatibility\r\n    output.data.faces = faces;\r\n\r\n    //\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.Geometry();\r\n\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      geometry.vertices.push(vertices[i].clone());\r\n\r\n    }\r\n\r\n    var faces = this.faces;\r\n\r\n    for (var i = 0, il = faces.length; i < il; i++) {\r\n\r\n      geometry.faces.push(faces[i].clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faceVertexUvs.length; i < il; i++) {\r\n\r\n      var faceVertexUvs = this.faceVertexUvs[i];\r\n\r\n      if (geometry.faceVertexUvs[i] === undefined) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexUvs.length; j < jl; j++) {\r\n\r\n        var uvs = faceVertexUvs[j],\r\n          uvsCopy = [];\r\n\r\n        for (var k = 0, kl = uvs.length; k < kl; k++) {\r\n\r\n          var uv = uvs[k];\r\n\r\n          uvsCopy.push(uv.clone());\r\n\r\n        }\r\n\r\n        geometry.faceVertexUvs[i].push(uvsCopy);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Camera = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Camera';\r\n\r\n  this.matrixWorldInverse = new THREE.Matrix4();\r\n  this.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function() {\r\n\r\n  var quaternion = new THREE.Quaternion();\r\n\r\n  return function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.getWorldQuaternion(quaternion);\r\n\r\n    return result.set(0, 0, -1).applyQuaternion(quaternion);\r\n\r\n  }\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function() {\r\n\r\n  // This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n  var m1 = new THREE.Matrix4();\r\n\r\n  return function(vector) {\r\n\r\n    m1.lookAt(this.position, vector, this.up);\r\n\r\n    this.quaternion.setFromRotationMatrix(m1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function(camera) {\r\n\r\n  if (camera === undefined) camera = new THREE.Camera();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, camera);\r\n\r\n  camera.matrixWorldInverse.copy(this.matrixWorldInverse);\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function(near, far, cubeResolution) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'CubeCamera';\r\n\r\n  var fov = 90,\r\n    aspect = 1;\r\n\r\n  var cameraPX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPX.up.set(0, -1, 0);\r\n  cameraPX.lookAt(new THREE.Vector3(1, 0, 0));\r\n  this.add(cameraPX);\r\n\r\n  var cameraNX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNX.up.set(0, -1, 0);\r\n  cameraNX.lookAt(new THREE.Vector3(-1, 0, 0));\r\n  this.add(cameraNX);\r\n\r\n  var cameraPY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPY.up.set(0, 0, 1);\r\n  cameraPY.lookAt(new THREE.Vector3(0, 1, 0));\r\n  this.add(cameraPY);\r\n\r\n  var cameraNY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNY.up.set(0, 0, -1);\r\n  cameraNY.lookAt(new THREE.Vector3(0, -1, 0));\r\n  this.add(cameraNY);\r\n\r\n  var cameraPZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPZ.up.set(0, -1, 0);\r\n  cameraPZ.lookAt(new THREE.Vector3(0, 0, 1));\r\n  this.add(cameraPZ);\r\n\r\n  var cameraNZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNZ.up.set(0, -1, 0);\r\n  cameraNZ.lookAt(new THREE.Vector3(0, 0, -1));\r\n  this.add(cameraNZ);\r\n\r\n  this.renderTarget = new THREE.WebGLRenderTargetCube(cubeResolution, cubeResolution, {\r\n    format: THREE.RGBFormat,\r\n    magFilter: THREE.LinearFilter,\r\n    minFilter: THREE.LinearFilter\r\n  });\r\n\r\n  this.updateCubeMap = function(renderer, scene) {\r\n\r\n    var renderTarget = this.renderTarget;\r\n    var generateMipmaps = renderTarget.generateMipmaps;\r\n\r\n    renderTarget.generateMipmaps = false;\r\n\r\n    renderTarget.activeCubeFace = 0;\r\n    renderer.render(scene, cameraPX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 1;\r\n    renderer.render(scene, cameraNX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 2;\r\n    renderer.render(scene, cameraPY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 3;\r\n    renderer.render(scene, cameraNY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 4;\r\n    renderer.render(scene, cameraPZ, renderTarget);\r\n\r\n    renderTarget.generateMipmaps = generateMipmaps;\r\n\r\n    renderTarget.activeCubeFace = 5;\r\n    renderer.render(scene, cameraNZ, renderTarget);\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function(left, right, top, bottom, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'OrthographicCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.left = left;\r\n  this.right = right;\r\n  this.top = top;\r\n  this.bottom = bottom;\r\n\r\n  this.near = (near !== undefined) ? near : 0.1;\r\n  this.far = (far !== undefined) ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var dx = (this.right - this.left) / (2 * this.zoom);\r\n  var dy = (this.top - this.bottom) / (2 * this.zoom);\r\n  var cx = (this.right + this.left) / 2;\r\n  var cy = (this.top + this.bottom) / 2;\r\n\r\n  this.projectionMatrix.makeOrthographic(cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far);\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.OrthographicCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.left = this.left;\r\n  camera.right = this.right;\r\n  camera.top = this.top;\r\n  camera.bottom = this.bottom;\r\n\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.PerspectiveCamera = function(fov, aspect, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'PerspectiveCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.fov = fov !== undefined ? fov : 50;\r\n  this.aspect = aspect !== undefined ? aspect : 1;\r\n  this.near = near !== undefined ? near : 0.1;\r\n  this.far = far !== undefined ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Uses Focal Length (in mm) to estimate and set FOV\r\n * 35mm (fullframe) camera is used if frame size is not specified;\r\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function(focalLength, frameHeight) {\r\n\r\n  if (frameHeight === undefined) frameHeight = 24;\r\n\r\n  this.fov = 2 * THREE.Math.radToDeg(Math.atan(frameHeight / (focalLength * 2)));\r\n  this.updateProjectionMatrix();\r\n\r\n}\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function(fullWidth, fullHeight, x, y, width, height) {\r\n\r\n  this.fullWidth = fullWidth;\r\n  this.fullHeight = fullHeight;\r\n  this.x = x;\r\n  this.y = y;\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var fov = THREE.Math.radToDeg(2 * Math.atan(Math.tan(THREE.Math.degToRad(this.fov) * 0.5) / this.zoom));\r\n\r\n  if (this.fullWidth) {\r\n\r\n    var aspect = this.fullWidth / this.fullHeight;\r\n    var top = Math.tan(THREE.Math.degToRad(fov * 0.5)) * this.near;\r\n    var bottom = -top;\r\n    var left = aspect * bottom;\r\n    var right = aspect * top;\r\n    var width = Math.abs(right - left);\r\n    var height = Math.abs(top - bottom);\r\n\r\n    this.projectionMatrix.makeFrustum(\r\n      left + this.x * width / this.fullWidth,\r\n      left + (this.x + this.width) * width / this.fullWidth,\r\n      top - (this.y + this.height) * height / this.fullHeight,\r\n      top - this.y * height / this.fullHeight,\r\n      this.near,\r\n      this.far\r\n    );\r\n\r\n  }\r\n  else {\r\n\r\n    this.projectionMatrix.makePerspective(fov, this.aspect, this.near, this.far);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.PerspectiveCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.fov = this.fov;\r\n  camera.aspect = this.aspect;\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function(color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Light';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nTHREE.Light.prototype.clone = function(light) {\r\n\r\n  if (light === undefined) light = new THREE.Light();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, light);\r\n\r\n  light.color.copy(this.color);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function(color) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AmbientLight';\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\nTHREE.AmbientLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.AmbientLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AreaLight.js\r\n\r\n/**\r\n * @author MPanknin / http://www.redplant.de/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.AreaLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AreaLight';\r\n\r\n  this.normal = new THREE.Vector3(0, -1, 0);\r\n  this.right = new THREE.Vector3(1, 0, 0);\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.width = 1.0;\r\n  this.height = 1.0;\r\n\r\n  this.constantAttenuation = 1.5;\r\n  this.linearAttenuation = 0.5;\r\n  this.quadraticAttenuation = 0.1;\r\n\r\n};\r\n\r\nTHREE.AreaLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AreaLight.prototype.constructor = THREE.AreaLight;\r\n\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'DirectionalLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n\r\n  this.shadowCameraLeft = -500;\r\n  this.shadowCameraRight = 500;\r\n  this.shadowCameraTop = 500;\r\n  this.shadowCameraBottom = -500;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowCascade = false;\r\n\r\n  this.shadowCascadeOffset = new THREE.Vector3(0, 0, -1000);\r\n  this.shadowCascadeCount = 2;\r\n\r\n  this.shadowCascadeBias = [0, 0, 0];\r\n  this.shadowCascadeWidth = [512, 512, 512];\r\n  this.shadowCascadeHeight = [512, 512, 512];\r\n\r\n  this.shadowCascadeNearZ = [-1.000, 0.990, 0.998];\r\n  this.shadowCascadeFarZ = [0.990, 0.998, 1.000];\r\n\r\n  this.shadowCascadeArray = [];\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.DirectionalLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n\r\n  light.shadowCameraLeft = this.shadowCameraLeft;\r\n  light.shadowCameraRight = this.shadowCameraRight;\r\n  light.shadowCameraTop = this.shadowCameraTop;\r\n  light.shadowCameraBottom = this.shadowCameraBottom;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  //\r\n\r\n  light.shadowCascade = this.shadowCascade;\r\n\r\n  light.shadowCascadeOffset.copy(this.shadowCascadeOffset);\r\n  light.shadowCascadeCount = this.shadowCascadeCount;\r\n\r\n  light.shadowCascadeBias = this.shadowCascadeBias.slice(0);\r\n  light.shadowCascadeWidth = this.shadowCascadeWidth.slice(0);\r\n  light.shadowCascadeHeight = this.shadowCascadeHeight.slice(0);\r\n\r\n  light.shadowCascadeNearZ = this.shadowCascadeNearZ.slice(0);\r\n  light.shadowCascadeFarZ = this.shadowCascadeFarZ.slice(0);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function(skyColor, groundColor, intensity) {\r\n\r\n  THREE.Light.call(this, skyColor);\r\n\r\n  this.type = 'HemisphereLight';\r\n\r\n  this.position.set(0, 100, 0);\r\n\r\n  this.groundColor = new THREE.Color(groundColor);\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.HemisphereLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.groundColor.copy(this.groundColor);\r\n  light.intensity = this.intensity;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLight = function(color, intensity, distance, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'PointLight';\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nTHREE.PointLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.PointLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.decay = this.decay;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function(color, intensity, distance, angle, exponent, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'SpotLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.angle = (angle !== undefined) ? angle : Math.PI / 3;\r\n  this.exponent = (exponent !== undefined) ? exponent : 10;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n  this.shadowCameraFov = 50;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nTHREE.SpotLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.SpotLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.angle = this.angle;\r\n  light.exponent = this.exponent;\r\n  light.decay = this.decay;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n  light.shadowCameraFov = this.shadowCameraFov;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n  files: {},\r\n\r\n  add: function(key, file) {\r\n\r\n    // console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n    this.files[key] = file;\r\n\r\n  },\r\n\r\n  get: function(key) {\r\n\r\n    // console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n    return this.files[key];\r\n\r\n  },\r\n\r\n  remove: function(key) {\r\n\r\n    delete this.files[key];\r\n\r\n  },\r\n\r\n  clear: function() {\r\n\r\n    this.files = {}\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function(showStatus) {\r\n\r\n  this.showStatus = showStatus;\r\n  this.statusDomElement = showStatus ? THREE.Loader.prototype.addStatusElement() : null;\r\n\r\n  this.imageLoader = new THREE.ImageLoader();\r\n\r\n  this.onLoadStart = function() {};\r\n  this.onLoadProgress = function() {};\r\n  this.onLoadComplete = function() {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n  constructor: THREE.Loader,\r\n\r\n  crossOrigin: undefined,\r\n\r\n  addStatusElement: function() {\r\n\r\n    var e = document.createElement('div');\r\n\r\n    e.style.position = 'absolute';\r\n    e.style.right = '0px';\r\n    e.style.top = '0px';\r\n    e.style.fontSize = '0.8em';\r\n    e.style.textAlign = 'left';\r\n    e.style.background = 'rgba(0,0,0,0.25)';\r\n    e.style.color = '#fff';\r\n    e.style.width = '120px';\r\n    e.style.padding = '0.5em 0.5em 0.5em 0.5em';\r\n    e.style.zIndex = 1000;\r\n\r\n    e.innerHTML = 'Loading ...';\r\n\r\n    return e;\r\n\r\n  },\r\n\r\n  updateProgress: function(progress) {\r\n\r\n    var message = 'Loaded ';\r\n\r\n    if (progress.total) {\r\n\r\n      message += (100 * progress.loaded / progress.total).toFixed(0) + '%';\r\n\r\n\r\n    }\r\n    else {\r\n\r\n      message += (progress.loaded / 1024).toFixed(2) + ' KB';\r\n\r\n    }\r\n\r\n    this.statusDomElement.innerHTML = message;\r\n\r\n  },\r\n\r\n  extractUrlBase: function(url) {\r\n\r\n    var parts = url.split('/');\r\n\r\n    if (parts.length === 1) return './';\r\n\r\n    parts.pop();\r\n\r\n    return parts.join('/') + '/';\r\n\r\n  },\r\n\r\n  initMaterials: function(materials, texturePath) {\r\n\r\n    var array = [];\r\n\r\n    for (var i = 0; i < materials.length; ++i) {\r\n\r\n      array[i] = this.createMaterial(materials[i], texturePath);\r\n\r\n    }\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  needsTangents: function(materials) {\r\n\r\n    for (var i = 0, il = materials.length; i < il; i++) {\r\n\r\n      var m = materials[i];\r\n\r\n      if (m instanceof THREE.ShaderMaterial) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  createMaterial: function(m, texturePath) {\r\n\r\n    var scope = this;\r\n\r\n    function nearest_pow2(n) {\r\n\r\n      var l = Math.log(n) / Math.LN2;\r\n      return Math.pow(2, Math.round(l));\r\n\r\n    }\r\n\r\n    function create_texture(where, name, sourceFile, repeat, offset, wrap, anisotropy) {\r\n\r\n      var fullPath = texturePath + sourceFile;\r\n\r\n      var texture;\r\n\r\n      var loader = THREE.Loader.Handlers.get(fullPath);\r\n\r\n      if (loader !== null) {\r\n\r\n        texture = loader.load(fullPath);\r\n\r\n      }\r\n      else {\r\n\r\n        texture = new THREE.Texture();\r\n\r\n        loader = scope.imageLoader;\r\n        loader.crossOrigin = scope.crossOrigin;\r\n        loader.load(fullPath, function(image) {\r\n\r\n          if (THREE.Math.isPowerOfTwo(image.width) === false ||\r\n            THREE.Math.isPowerOfTwo(image.height) === false) {\r\n\r\n            var width = nearest_pow2(image.width);\r\n            var height = nearest_pow2(image.height);\r\n\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n\r\n            var context = canvas.getContext('2d');\r\n            context.drawImage(image, 0, 0, width, height);\r\n\r\n            texture.image = canvas;\r\n\r\n          }\r\n          else {\r\n\r\n            texture.image = image;\r\n\r\n          }\r\n\r\n          texture.needsUpdate = true;\r\n\r\n        });\r\n\r\n      }\r\n\r\n      texture.sourceFile = sourceFile;\r\n\r\n      if (repeat) {\r\n\r\n        texture.repeat.set(repeat[0], repeat[1]);\r\n\r\n        if (repeat[0] !== 1) texture.wrapS = THREE.RepeatWrapping;\r\n        if (repeat[1] !== 1) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n      }\r\n\r\n      if (offset) {\r\n\r\n        texture.offset.set(offset[0], offset[1]);\r\n\r\n      }\r\n\r\n      if (wrap) {\r\n\r\n        var wrapMap = {\r\n          'repeat': THREE.RepeatWrapping,\r\n          'mirror': THREE.MirroredRepeatWrapping\r\n        }\r\n\r\n        if (wrapMap[wrap[0]] !== undefined) texture.wrapS = wrapMap[wrap[0]];\r\n        if (wrapMap[wrap[1]] !== undefined) texture.wrapT = wrapMap[wrap[1]];\r\n\r\n      }\r\n\r\n      if (anisotropy) {\r\n\r\n        texture.anisotropy = anisotropy;\r\n\r\n      }\r\n\r\n      where[name] = texture;\r\n\r\n    }\r\n\r\n    function rgb2hex(rgb) {\r\n\r\n      return (rgb[0] * 255 << 16) + (rgb[1] * 255 << 8) + rgb[2] * 255;\r\n\r\n    }\r\n\r\n    // defaults\r\n\r\n    var mtype = 'MeshLambertMaterial';\r\n    var mpars = {\r\n      color: 0xeeeeee,\r\n      opacity: 1.0,\r\n      map: null,\r\n      lightMap: null,\r\n      normalMap: null,\r\n      bumpMap: null,\r\n      wireframe: false\r\n    };\r\n\r\n    // parameters from model file\r\n\r\n    if (m.shading) {\r\n\r\n      var shading = m.shading.toLowerCase();\r\n\r\n      if (shading === 'phong') mtype = 'MeshPhongMaterial';\r\n      else if (shading === 'basic') mtype = 'MeshBasicMaterial';\r\n\r\n    }\r\n\r\n    if (m.blending !== undefined && THREE[m.blending] !== undefined) {\r\n\r\n      mpars.blending = THREE[m.blending];\r\n\r\n    }\r\n\r\n    if (m.transparent !== undefined) {\r\n\r\n      mpars.transparent = m.transparent;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined && m.opacity < 1.0) {\r\n\r\n      mpars.transparent = true;\r\n\r\n    }\r\n\r\n    if (m.depthTest !== undefined) {\r\n\r\n      mpars.depthTest = m.depthTest;\r\n\r\n    }\r\n\r\n    if (m.depthWrite !== undefined) {\r\n\r\n      mpars.depthWrite = m.depthWrite;\r\n\r\n    }\r\n\r\n    if (m.visible !== undefined) {\r\n\r\n      mpars.visible = m.visible;\r\n\r\n    }\r\n\r\n    if (m.flipSided !== undefined) {\r\n\r\n      mpars.side = THREE.BackSide;\r\n\r\n    }\r\n\r\n    if (m.doubleSided !== undefined) {\r\n\r\n      mpars.side = THREE.DoubleSide;\r\n\r\n    }\r\n\r\n    if (m.wireframe !== undefined) {\r\n\r\n      mpars.wireframe = m.wireframe;\r\n\r\n    }\r\n\r\n    if (m.vertexColors !== undefined) {\r\n\r\n      if (m.vertexColors === 'face') {\r\n\r\n        mpars.vertexColors = THREE.FaceColors;\r\n\r\n      }\r\n      else if (m.vertexColors) {\r\n\r\n        mpars.vertexColors = THREE.VertexColors;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // colors\r\n\r\n    if (m.colorDiffuse) {\r\n\r\n      mpars.color = rgb2hex(m.colorDiffuse);\r\n\r\n    }\r\n    else if (m.DbgColor) {\r\n\r\n      mpars.color = m.DbgColor;\r\n\r\n    }\r\n\r\n    if (m.colorSpecular) {\r\n\r\n      mpars.specular = rgb2hex(m.colorSpecular);\r\n\r\n    }\r\n\r\n    if (m.colorEmissive) {\r\n\r\n      mpars.emissive = rgb2hex(m.colorEmissive);\r\n\r\n    }\r\n\r\n    // modifiers\r\n\r\n    if (m.transparency !== undefined) {\r\n\r\n      console.warn('THREE.Loader: transparency has been renamed to opacity');\r\n      m.opacity = m.transparency;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined) {\r\n\r\n      mpars.opacity = m.opacity;\r\n\r\n    }\r\n\r\n    if (m.specularCoef) {\r\n\r\n      mpars.shininess = m.specularCoef;\r\n\r\n    }\r\n\r\n    // textures\r\n\r\n    if (m.mapDiffuse && texturePath) {\r\n\r\n      create_texture(mpars, 'map', m.mapDiffuse, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapLight && texturePath) {\r\n\r\n      create_texture(mpars, 'lightMap', m.mapLight, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapBump && texturePath) {\r\n\r\n      create_texture(mpars, 'bumpMap', m.mapBump, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapNormal && texturePath) {\r\n\r\n      create_texture(mpars, 'normalMap', m.mapNormal, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapSpecular && texturePath) {\r\n\r\n      create_texture(mpars, 'specularMap', m.mapSpecular, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapAlpha && texturePath) {\r\n\r\n      create_texture(mpars, 'alphaMap', m.mapAlpha, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy);\r\n\r\n    }\r\n\r\n    //\r\n\r\n    if (m.mapBumpScale) {\r\n\r\n      mpars.bumpScale = m.mapBumpScale;\r\n\r\n    }\r\n\r\n    if (m.mapNormalFactor) {\r\n\r\n      mpars.normalScale = new THREE.Vector2(m.mapNormalFactor, m.mapNormalFactor);\r\n\r\n    }\r\n\r\n    var material = new THREE[mtype](mpars);\r\n\r\n    if (m.DbgName !== undefined) material.name = m.DbgName;\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n  handlers: [],\r\n\r\n  add: function(regex, loader) {\r\n\r\n    this.handlers.push(regex, loader);\r\n\r\n  },\r\n\r\n  get: function(file) {\r\n\r\n    for (var i = 0, l = this.handlers.length; i < l; i += 2) {\r\n\r\n      var regex = this.handlers[i];\r\n      var loader = this.handlers[i + 1];\r\n\r\n      if (regex.test(file)) {\r\n\r\n        return loader;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return null;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n  constructor: THREE.XHRLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      if (onLoad) onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open('GET', url, true);\r\n\r\n    request.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this.response);\r\n\r\n      if (onLoad) onLoad(this.response);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      request.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      request.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) request.crossOrigin = this.crossOrigin;\r\n    if (this.responseType !== undefined) request.responseType = this.responseType;\r\n\r\n    request.send(null);\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n  },\r\n\r\n  setResponseType: function(value) {\r\n\r\n    this.responseType = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n  constructor: THREE.ImageLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var image = document.createElement('img');\r\n\r\n    image.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this);\r\n\r\n      if (onLoad) onLoad(this);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      image.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      image.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) image.crossOrigin = this.crossOrigin;\r\n\r\n    image.src = url;\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n    return image;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n}\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function(showStatus) {\r\n\r\n  THREE.Loader.call(this, showStatus);\r\n\r\n  this.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = Object.create(THREE.Loader.prototype);\r\nTHREE.JSONLoader.prototype.constructor = THREE.JSONLoader;\r\n\r\nTHREE.JSONLoader.prototype.load = function(url, callback, texturePath) {\r\n\r\n  // todo: unify load API to for easier SceneLoader use\r\n\r\n  texturePath = texturePath && (typeof texturePath === 'string') ? texturePath : this.extractUrlBase(url);\r\n\r\n  this.onLoadStart();\r\n  this.loadAjaxJSON(this, url, callback, texturePath);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.loadAjaxJSON = function(context, url, callback, texturePath, callbackProgress) {\r\n\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  var length = 0;\r\n\r\n  xhr.onreadystatechange = function() {\r\n\r\n    if (xhr.readyState === xhr.DONE) {\r\n\r\n      if (xhr.status === 200 || xhr.status === 0) {\r\n\r\n        if (xhr.responseText) {\r\n\r\n          var json = JSON.parse(xhr.responseText);\r\n          var metadata = json.metadata;\r\n\r\n          if (metadata !== undefined) {\r\n\r\n            if (metadata.type === 'object') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n            if (metadata.type === 'scene') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' seems to be a Scene. Use THREE.SceneLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          var result = context.parse(json, texturePath);\r\n          callback(result.geometry, result.materials);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error('THREE.JSONLoader: ' + url + ' seems to be unreachable or the file is empty.');\r\n\r\n        }\r\n\r\n        // in context of more complex asset initialization\r\n        // do not block on single failed file\r\n        // maybe should go even one more level up\r\n\r\n        context.onLoadComplete();\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.JSONLoader: Couldn\\'t load ' + url + ' (' + xhr.status + ')');\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.LOADING) {\r\n\r\n      if (callbackProgress) {\r\n\r\n        if (length === 0) {\r\n\r\n          length = xhr.getResponseHeader('Content-Length');\r\n\r\n        }\r\n\r\n        callbackProgress({\r\n          total: length,\r\n          loaded: xhr.responseText.length\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.HEADERS_RECEIVED) {\r\n\r\n      if (callbackProgress !== undefined) {\r\n\r\n        length = xhr.getResponseHeader('Content-Length');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  xhr.open('GET', url, true);\r\n  xhr.withCredentials = this.withCredentials;\r\n  xhr.send(null);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.parse = function(json, texturePath) {\r\n\r\n  var geometry = new THREE.Geometry(),\r\n    scale = (json.scale !== undefined) ? 1.0 / json.scale : 1.0;\r\n\r\n  parseModel(scale);\r\n\r\n  parseSkin();\r\n  parseMorphing(scale);\r\n\r\n  geometry.computeFaceNormals();\r\n  geometry.computeBoundingSphere();\r\n\r\n  function parseModel(scale) {\r\n\r\n    function isBitSet(value, position) {\r\n\r\n      return value & (1 << position);\r\n\r\n    }\r\n\r\n    var i, j, fi,\r\n\r\n      offset, zLength,\r\n\r\n      colorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n      type,\r\n      isQuad,\r\n      hasMaterial,\r\n      hasFaceVertexUv,\r\n      hasFaceNormal, hasFaceVertexNormal,\r\n      hasFaceColor, hasFaceVertexColor,\r\n\r\n      vertex, face, faceA, faceB, hex, normal,\r\n\r\n      uvLayer, uv, u, v,\r\n\r\n      faces = json.faces,\r\n      vertices = json.vertices,\r\n      normals = json.normals,\r\n      colors = json.colors,\r\n\r\n      nUvLayers = 0;\r\n\r\n    if (json.uvs !== undefined) {\r\n\r\n      // disregard empty arrays\r\n\r\n      for (i = 0; i < json.uvs.length; i++) {\r\n\r\n        if (json.uvs[i].length) nUvLayers++;\r\n\r\n      }\r\n\r\n      for (i = 0; i < nUvLayers; i++) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = vertices.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      vertex = new THREE.Vector3();\r\n\r\n      vertex.x = vertices[offset++] * scale;\r\n      vertex.y = vertices[offset++] * scale;\r\n      vertex.z = vertices[offset++] * scale;\r\n\r\n      geometry.vertices.push(vertex);\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = faces.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      type = faces[offset++];\r\n\r\n\r\n      isQuad = isBitSet(type, 0);\r\n      hasMaterial = isBitSet(type, 1);\r\n      hasFaceVertexUv = isBitSet(type, 3);\r\n      hasFaceNormal = isBitSet(type, 4);\r\n      hasFaceVertexNormal = isBitSet(type, 5);\r\n      hasFaceColor = isBitSet(type, 6);\r\n      hasFaceVertexColor = isBitSet(type, 7);\r\n\r\n      // console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n      if (isQuad) {\r\n\r\n        faceA = new THREE.Face3();\r\n        faceA.a = faces[offset];\r\n        faceA.b = faces[offset + 1];\r\n        faceA.c = faces[offset + 3];\r\n\r\n        faceB = new THREE.Face3();\r\n        faceB.a = faces[offset + 1];\r\n        faceB.b = faces[offset + 2];\r\n        faceB.c = faces[offset + 3];\r\n\r\n        offset += 4;\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          faceA.materialIndex = materialIndex;\r\n          faceB.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n            geometry.faceVertexUvs[i][fi + 1] = []\r\n\r\n            for (j = 0; j < 4; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              if (j !== 2) geometry.faceVertexUvs[i][fi].push(uv);\r\n              if (j !== 0) geometry.faceVertexUvs[i][fi + 1].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          faceA.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n          faceB.normal.copy(faceA.normal);\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n\r\n            if (i !== 2) faceA.vertexNormals.push(normal);\r\n            if (i !== 0) faceB.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          hex = colors[colorIndex];\r\n\r\n          faceA.color.setHex(hex);\r\n          faceB.color.setHex(hex);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            hex = colors[colorIndex];\r\n\r\n            if (i !== 2) faceA.vertexColors.push(new THREE.Color(hex));\r\n            if (i !== 0) faceB.vertexColors.push(new THREE.Color(hex));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(faceA);\r\n        geometry.faces.push(faceB);\r\n\r\n      }\r\n      else {\r\n\r\n        face = new THREE.Face3();\r\n        face.a = faces[offset++];\r\n        face.b = faces[offset++];\r\n        face.c = faces[offset++];\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          face.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n\r\n            for (j = 0; j < 3; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              geometry.faceVertexUvs[i][fi].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          face.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n            face.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          face.color.setHex(colors[colorIndex]);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            face.vertexColors.push(new THREE.Color(colors[colorIndex]));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(face);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function parseSkin() {\r\n    var influencesPerVertex = (json.influencesPerVertex !== undefined) ? json.influencesPerVertex : 2;\r\n\r\n    if (json.skinWeights) {\r\n\r\n      for (var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex) {\r\n\r\n        var x = json.skinWeights[i];\r\n        var y = (influencesPerVertex > 1) ? json.skinWeights[i + 1] : 0;\r\n        var z = (influencesPerVertex > 2) ? json.skinWeights[i + 2] : 0;\r\n        var w = (influencesPerVertex > 3) ? json.skinWeights[i + 3] : 0;\r\n\r\n        geometry.skinWeights.push(new THREE.Vector4(x, y, z, w));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.skinIndices) {\r\n\r\n      for (var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex) {\r\n\r\n        var a = json.skinIndices[i];\r\n        var b = (influencesPerVertex > 1) ? json.skinIndices[i + 1] : 0;\r\n        var c = (influencesPerVertex > 2) ? json.skinIndices[i + 2] : 0;\r\n        var d = (influencesPerVertex > 3) ? json.skinIndices[i + 3] : 0;\r\n\r\n        geometry.skinIndices.push(new THREE.Vector4(a, b, c, d));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.bones = json.bones;\r\n\r\n    if (geometry.bones && geometry.bones.length > 0 && (geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length)) {\r\n\r\n      THREE.warn('THREE.JSONLoader: When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n        geometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.');\r\n\r\n    }\r\n\r\n\r\n    // could change this to json.animations[0] or remove completely\r\n\r\n    geometry.animation = json.animation;\r\n    geometry.animations = json.animations;\r\n\r\n  };\r\n\r\n  function parseMorphing(scale) {\r\n\r\n    if (json.morphTargets !== undefined) {\r\n\r\n      var i, l, v, vl, dstVertices, srcVertices;\r\n\r\n      for (i = 0, l = json.morphTargets.length; i < l; i++) {\r\n\r\n        geometry.morphTargets[i] = {};\r\n        geometry.morphTargets[i].name = json.morphTargets[i].name;\r\n        geometry.morphTargets[i].vertices = [];\r\n\r\n        dstVertices = geometry.morphTargets[i].vertices;\r\n        srcVertices = json.morphTargets[i].vertices;\r\n\r\n        for (v = 0, vl = srcVertices.length; v < vl; v += 3) {\r\n\r\n          var vertex = new THREE.Vector3();\r\n          vertex.x = srcVertices[v] * scale;\r\n          vertex.y = srcVertices[v + 1] * scale;\r\n          vertex.z = srcVertices[v + 2] * scale;\r\n\r\n          dstVertices.push(vertex);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.morphColors !== undefined) {\r\n\r\n      var i, l, c, cl, dstColors, srcColors, color;\r\n\r\n      for (i = 0, l = json.morphColors.length; i < l; i++) {\r\n\r\n        geometry.morphColors[i] = {};\r\n        geometry.morphColors[i].name = json.morphColors[i].name;\r\n        geometry.morphColors[i].colors = [];\r\n\r\n        dstColors = geometry.morphColors[i].colors;\r\n        srcColors = json.morphColors[i].colors;\r\n\r\n        for (c = 0, cl = srcColors.length; c < cl; c += 3) {\r\n\r\n          color = new THREE.Color(0xffaa00);\r\n          color.setRGB(srcColors[c], srcColors[c + 1], srcColors[c + 2]);\r\n          dstColors.push(color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  if (json.materials === undefined || json.materials.length === 0) {\r\n\r\n    return {\r\n      geometry: geometry\r\n    };\r\n\r\n  }\r\n  else {\r\n\r\n    var materials = this.initMaterials(json.materials, texturePath);\r\n\r\n    if (this.needsTangents(materials)) {\r\n\r\n      geometry.computeTangents();\r\n\r\n    }\r\n\r\n    return {\r\n      geometry: geometry,\r\n      materials: materials\r\n    };\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function(onLoad, onProgress, onError) {\r\n\r\n  var scope = this;\r\n\r\n  var loaded = 0,\r\n    total = 0;\r\n\r\n  this.onLoad = onLoad;\r\n  this.onProgress = onProgress;\r\n  this.onError = onError;\r\n\r\n  this.itemStart = function(url) {\r\n\r\n    total++;\r\n\r\n  };\r\n\r\n  this.itemEnd = function(url) {\r\n\r\n    loaded++;\r\n\r\n    if (scope.onProgress !== undefined) {\r\n\r\n      scope.onProgress(url, loaded, total);\r\n\r\n    }\r\n\r\n    if (loaded === total && scope.onLoad !== undefined) {\r\n\r\n      scope.onLoad();\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n  constructor: THREE.BufferGeometryLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    var attributes = json.data.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n      var typedArray = new self[attribute.type](attribute.array);\r\n\r\n      geometry.addAttribute(key, new THREE.BufferAttribute(typedArray, attribute.itemSize));\r\n\r\n    }\r\n\r\n    var offsets = json.data.offsets;\r\n\r\n    if (offsets !== undefined) {\r\n\r\n      geometry.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    var boundingSphere = json.data.boundingSphere;\r\n\r\n    if (boundingSphere !== undefined) {\r\n\r\n      var center = new THREE.Vector3();\r\n\r\n      if (boundingSphere.center !== undefined) {\r\n\r\n        center.fromArray(boundingSphere.center);\r\n\r\n      }\r\n\r\n      geometry.boundingSphere = new THREE.Sphere(center, boundingSphere.radius);\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n  constructor: THREE.MaterialLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var material = new THREE[json.type];\r\n\r\n    if (json.color !== undefined) material.color.setHex(json.color);\r\n    if (json.emissive !== undefined) material.emissive.setHex(json.emissive);\r\n    if (json.specular !== undefined) material.specular.setHex(json.specular);\r\n    if (json.shininess !== undefined) material.shininess = json.shininess;\r\n    if (json.uniforms !== undefined) material.uniforms = json.uniforms;\r\n    if (json.vertexShader !== undefined) material.vertexShader = json.vertexShader;\r\n    if (json.fragmentShader !== undefined) material.fragmentShader = json.fragmentShader;\r\n    if (json.vertexColors !== undefined) material.vertexColors = json.vertexColors;\r\n    if (json.shading !== undefined) material.shading = json.shading;\r\n    if (json.blending !== undefined) material.blending = json.blending;\r\n    if (json.side !== undefined) material.side = json.side;\r\n    if (json.opacity !== undefined) material.opacity = json.opacity;\r\n    if (json.transparent !== undefined) material.transparent = json.transparent;\r\n    if (json.wireframe !== undefined) material.wireframe = json.wireframe;\r\n\r\n    // for PointCloudMaterial\r\n    if (json.size !== undefined) material.size = json.size;\r\n    if (json.sizeAttenuation !== undefined) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n    if (json.materials !== undefined) {\r\n\r\n      for (var i = 0, l = json.materials.length; i < l; i++) {\r\n\r\n        material.materials.push(this.parse(json.materials[i]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n  this.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n  constructor: THREE.ObjectLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    if (this.texturePath === '') {\r\n\r\n      this.texturePath = url.substring(0, url.lastIndexOf('/') + 1);\r\n\r\n    }\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      scope.parse(JSON.parse(text), onLoad);\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setTexturePath: function(value) {\r\n\r\n    this.texturePath = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json, onLoad) {\r\n\r\n    var geometries = this.parseGeometries(json.geometries);\r\n\r\n    var images = this.parseImages(json.images, function() {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    });\r\n    var textures = this.parseTextures(json.textures, images);\r\n    var materials = this.parseMaterials(json.materials, textures);\r\n    var object = this.parseObject(json.object, geometries, materials);\r\n\r\n    if (json.images === undefined || json.images.length === 0) {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  },\r\n\r\n  parseGeometries: function(json) {\r\n\r\n    var geometries = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var geometryLoader = new THREE.JSONLoader();\r\n      var bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var geometry;\r\n        var data = json[i];\r\n\r\n        switch (data.type) {\r\n\r\n          case 'PlaneGeometry':\r\n          case 'PlaneBufferGeometry':\r\n\r\n            geometry = new THREE[data.type](\r\n              data.width,\r\n              data.height,\r\n              data.widthSegments,\r\n              data.heightSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BoxGeometry':\r\n          case 'CubeGeometry': // backwards compatible\r\n\r\n            geometry = new THREE.BoxGeometry(\r\n              data.width,\r\n              data.height,\r\n              data.depth,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.depthSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CircleGeometry':\r\n\r\n            geometry = new THREE.CircleGeometry(\r\n              data.radius,\r\n              data.segments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CylinderGeometry':\r\n\r\n            geometry = new THREE.CylinderGeometry(\r\n              data.radiusTop,\r\n              data.radiusBottom,\r\n              data.height,\r\n              data.radialSegments,\r\n              data.heightSegments,\r\n              data.openEnded\r\n            );\r\n\r\n            break;\r\n\r\n          case 'SphereGeometry':\r\n\r\n            geometry = new THREE.SphereGeometry(\r\n              data.radius,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.phiStart,\r\n              data.phiLength,\r\n              data.thetaStart,\r\n              data.thetaLength\r\n            );\r\n\r\n            break;\r\n\r\n          case 'IcosahedronGeometry':\r\n\r\n            geometry = new THREE.IcosahedronGeometry(\r\n              data.radius,\r\n              data.detail\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusGeometry':\r\n\r\n            geometry = new THREE.TorusGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.arc\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusKnotGeometry':\r\n\r\n            geometry = new THREE.TorusKnotGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.p,\r\n              data.q,\r\n              data.heightScale\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BufferGeometry':\r\n\r\n            geometry = bufferGeometryLoader.parse(data);\r\n\r\n            break;\r\n\r\n          case 'Geometry':\r\n\r\n            geometry = geometryLoader.parse(data.data).geometry;\r\n\r\n            break;\r\n\r\n        }\r\n\r\n        geometry.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) geometry.name = data.name;\r\n\r\n        geometries[data.uuid] = geometry;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometries;\r\n\r\n  },\r\n\r\n  parseMaterials: function(json, textures) {\r\n\r\n    var materials = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var getTexture = function(name) {\r\n\r\n        if (textures[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined texture', name);\r\n\r\n        }\r\n\r\n        return textures[name];\r\n\r\n      };\r\n\r\n      var loader = new THREE.MaterialLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n        var material = loader.parse(data);\r\n\r\n        material.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) material.name = data.name;\r\n\r\n        if (data.map !== undefined) {\r\n\r\n          material.map = getTexture(data.map);\r\n\r\n        }\r\n\r\n        if (data.bumpMap !== undefined) {\r\n\r\n          material.bumpMap = getTexture(data.bumpMap);\r\n          if (data.bumpScale) {\r\n            material.bumpScale = new THREE.Vector2(data.bumpScale, data.bumpScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.alphaMap !== undefined) {\r\n\r\n          material.alphaMap = getTexture(data.alphaMap);\r\n\r\n        }\r\n\r\n        if (data.envMap !== undefined) {\r\n\r\n          material.envMap = getTexture(data.envMap);\r\n\r\n        }\r\n\r\n        if (data.normalMap !== undefined) {\r\n\r\n          material.normalMap = getTexture(data.normalMap);\r\n          if (data.normalScale) {\r\n            material.normalScale = new THREE.Vector2(data.normalScale, data.normalScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.lightMap !== undefined) {\r\n\r\n          material.lightMap = getTexture(data.lightMap);\r\n\r\n        }\r\n\r\n        if (data.specularMap !== undefined) {\r\n\r\n          material.specularMap = getTexture(data.specularMap);\r\n\r\n        }\r\n\r\n        materials[data.uuid] = material;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return materials;\r\n\r\n  },\r\n\r\n  parseImages: function(json, onLoad) {\r\n\r\n    var scope = this;\r\n    var images = {};\r\n\r\n    if (json !== undefined && json.length > 0) {\r\n\r\n      var manager = new THREE.LoadingManager(onLoad);\r\n\r\n      var loader = new THREE.ImageLoader(manager);\r\n      loader.setCrossOrigin(this.crossOrigin);\r\n\r\n      var loadImage = function(url) {\r\n\r\n        scope.manager.itemStart(url);\r\n\r\n        return loader.load(url, function() {\r\n\r\n          scope.manager.itemEnd(url);\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var image = json[i];\r\n        var path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(image.url) ? image.url : scope.texturePath + image.url;\r\n\r\n        images[image.uuid] = loadImage(path);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return images;\r\n\r\n  },\r\n\r\n  parseTextures: function(json, images) {\r\n\r\n    var textures = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n\r\n        if (data.image === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: No \"image\" speficied for', data.uuid);\r\n\r\n        }\r\n\r\n        if (images[data.image] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined image', data.image);\r\n\r\n        }\r\n\r\n        var texture = new THREE.Texture(images[data.image]);\r\n        texture.needsUpdate = true;\r\n\r\n        texture.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) texture.name = data.name;\r\n        if (data.repeat !== undefined) texture.repeat = new THREE.Vector2(data.repeat[0], data.repeat[1]);\r\n        if (data.minFilter !== undefined) texture.minFilter = THREE[data.minFilter];\r\n        if (data.magFilter !== undefined) texture.magFilter = THREE[data.magFilter];\r\n        if (data.anisotropy !== undefined) texture.anisotropy = data.anisotropy;\r\n        if (data.wrap instanceof Array) {\r\n\r\n          texture.wrapS = THREE[data.wrap[0]];\r\n          texture.wrapT = THREE[data.wrap[1]];\r\n\r\n        }\r\n\r\n        textures[data.uuid] = texture;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return textures;\r\n\r\n  },\r\n\r\n  parseObject: function() {\r\n\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(data, geometries, materials) {\r\n\r\n      var object;\r\n\r\n      var getGeometry = function(name) {\r\n\r\n        if (geometries[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined geometry', name);\r\n\r\n        }\r\n\r\n        return geometries[name];\r\n\r\n      };\r\n\r\n      var getMaterial = function(name) {\r\n\r\n        if (materials[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined material', name);\r\n\r\n        }\r\n\r\n        return materials[name];\r\n\r\n      };\r\n\r\n      switch (data.type) {\r\n\r\n        case 'Scene':\r\n\r\n          object = new THREE.Scene();\r\n\r\n          break;\r\n\r\n        case 'PerspectiveCamera':\r\n\r\n          object = new THREE.PerspectiveCamera(data.fov, data.aspect, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'OrthographicCamera':\r\n\r\n          object = new THREE.OrthographicCamera(data.left, data.right, data.top, data.bottom, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'AmbientLight':\r\n\r\n          object = new THREE.AmbientLight(data.color);\r\n\r\n          break;\r\n\r\n        case 'DirectionalLight':\r\n\r\n          object = new THREE.DirectionalLight(data.color, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'PointLight':\r\n\r\n          object = new THREE.PointLight(data.color, data.intensity, data.distance, data.decay);\r\n\r\n          break;\r\n\r\n        case 'SpotLight':\r\n\r\n          object = new THREE.SpotLight(data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay);\r\n\r\n          break;\r\n\r\n        case 'HemisphereLight':\r\n\r\n          object = new THREE.HemisphereLight(data.color, data.groundColor, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'Mesh':\r\n\r\n          object = new THREE.Mesh(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Line':\r\n\r\n          object = new THREE.Line(getGeometry(data.geometry), getMaterial(data.material), data.mode);\r\n\r\n          break;\r\n\r\n        case 'PointCloud':\r\n\r\n          object = new THREE.PointCloud(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Sprite':\r\n\r\n          object = new THREE.Sprite(getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Group':\r\n\r\n          object = new THREE.Group();\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          object = new THREE.Object3D();\r\n\r\n      }\r\n\r\n      object.uuid = data.uuid;\r\n\r\n      if (data.name !== undefined) object.name = data.name;\r\n      if (data.matrix !== undefined) {\r\n\r\n        matrix.fromArray(data.matrix);\r\n        matrix.decompose(object.position, object.quaternion, object.scale);\r\n\r\n      }\r\n      else {\r\n\r\n        if (data.position !== undefined) object.position.fromArray(data.position);\r\n        if (data.rotation !== undefined) object.rotation.fromArray(data.rotation);\r\n        if (data.scale !== undefined) object.scale.fromArray(data.scale);\r\n\r\n      }\r\n\r\n      if (data.visible !== undefined) object.visible = data.visible;\r\n      if (data.userData !== undefined) object.userData = data.userData;\r\n\r\n      if (data.children !== undefined) {\r\n\r\n        for (var child in data.children) {\r\n\r\n          object.add(this.parseObject(data.children[child], geometries, materials));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return object;\r\n\r\n    }\r\n\r\n  }()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n  constructor: THREE.TextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.ImageLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(image) {\r\n\r\n      var texture = new THREE.Texture(image);\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad !== undefined) {\r\n\r\n        onLoad(texture);\r\n\r\n      }\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n  constructor: THREE.BinaryTextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var texture = new THREE.DataTexture();\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    loader.load(url, function(buffer) {\r\n\r\n      var texData = scope._parser(buffer);\r\n\r\n      if (!texData) return;\r\n\r\n      if (undefined !== texData.image) {\r\n\r\n        texture.image = texData.image;\r\n\r\n      }\r\n      else if (undefined !== texData.data) {\r\n\r\n        texture.image.width = texData.width;\r\n        texture.image.height = texData.height;\r\n        texture.image.data = texData.data;\r\n\r\n      }\r\n\r\n      texture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n      texture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n      texture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n      texture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n      texture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n      if (undefined !== texData.format) {\r\n\r\n        texture.format = texData.format;\r\n\r\n      }\r\n      if (undefined !== texData.type) {\r\n\r\n        texture.type = texData.type;\r\n\r\n      }\r\n\r\n      if (undefined !== texData.mipmaps) {\r\n\r\n        texture.mipmaps = texData.mipmaps;\r\n\r\n      }\r\n\r\n      if (1 === texData.mipmapCount) {\r\n\r\n        texture.minFilter = THREE.LinearFilter;\r\n\r\n      }\r\n\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture, texData);\r\n\r\n    }, onProgress, onError);\r\n\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n  constructor: THREE.CompressedTextureLoader,\r\n\r\n  load: function(url, onLoad, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var images = [];\r\n\r\n    var texture = new THREE.CompressedTexture();\r\n    texture.image = images;\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    if (url instanceof Array) {\r\n\r\n      var loaded = 0;\r\n\r\n      var loadTexture = function(i) {\r\n\r\n        loader.load(url[i], function(buffer) {\r\n\r\n          var texDatas = scope._parser(buffer, true);\r\n\r\n          images[i] = {\r\n            width: texDatas.width,\r\n            height: texDatas.height,\r\n            format: texDatas.format,\r\n            mipmaps: texDatas.mipmaps\r\n          };\r\n\r\n          loaded += 1;\r\n\r\n          if (loaded === 6) {\r\n\r\n            if (texDatas.mipmapCount == 1)\r\n              texture.minFilter = THREE.LinearFilter;\r\n\r\n            texture.format = texDatas.format;\r\n            texture.needsUpdate = true;\r\n\r\n            if (onLoad) onLoad(texture);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, il = url.length; i < il; ++i) {\r\n\r\n        loadTexture(i);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // compressed cubemap texture stored in a single DDS file\r\n\r\n      loader.load(url, function(buffer) {\r\n\r\n        var texDatas = scope._parser(buffer, true);\r\n\r\n        if (texDatas.isCubemap) {\r\n\r\n          var faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n          for (var f = 0; f < faces; f++) {\r\n\r\n            images[f] = {\r\n              mipmaps: []\r\n            };\r\n\r\n            for (var i = 0; i < texDatas.mipmapCount; i++) {\r\n\r\n              images[f].mipmaps.push(texDatas.mipmaps[f * texDatas.mipmapCount + i]);\r\n              images[f].format = texDatas.format;\r\n              images[f].width = texDatas.width;\r\n              images[f].height = texDatas.height;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          texture.image.width = texDatas.width;\r\n          texture.image.height = texDatas.height;\r\n          texture.mipmaps = texDatas.mipmaps;\r\n\r\n        }\r\n\r\n        if (texDatas.mipmapCount === 1) {\r\n\r\n          texture.minFilter = THREE.LinearFilter;\r\n\r\n        }\r\n\r\n        texture.format = texDatas.format;\r\n        texture.needsUpdate = true;\r\n\r\n        if (onLoad) onLoad(texture);\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.MaterialIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Material';\r\n\r\n  this.side = THREE.FrontSide;\r\n\r\n  this.opacity = 1;\r\n  this.transparent = false;\r\n\r\n  this.blending = THREE.NormalBlending;\r\n\r\n  this.blendSrc = THREE.SrcAlphaFactor;\r\n  this.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n  this.blendEquation = THREE.AddEquation;\r\n  this.blendSrcAlpha = null;\r\n  this.blendDstAlpha = null;\r\n  this.blendEquationAlpha = null;\r\n\r\n  this.depthTest = true;\r\n  this.depthWrite = true;\r\n\r\n  this.colorWrite = true;\r\n\r\n  this.polygonOffset = false;\r\n  this.polygonOffsetFactor = 0;\r\n  this.polygonOffsetUnits = 0;\r\n\r\n  this.alphaTest = 0;\r\n\r\n  this.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n  this.visible = true;\r\n\r\n  this._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n  constructor: THREE.Material,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  setValues: function(values) {\r\n\r\n    if (values === undefined) return;\r\n\r\n    for (var key in values) {\r\n\r\n      var newValue = values[key];\r\n\r\n      if (newValue === undefined) {\r\n\r\n        THREE.warn(\"THREE.Material: '\" + key + \"' parameter is undefined.\");\r\n        continue;\r\n\r\n      }\r\n\r\n      if (key in this) {\r\n\r\n        var currentValue = this[key];\r\n\r\n        if (currentValue instanceof THREE.Color) {\r\n\r\n          currentValue.set(newValue);\r\n\r\n        }\r\n        else if (currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3) {\r\n\r\n          currentValue.copy(newValue);\r\n\r\n        }\r\n        else if (key == 'overdraw') {\r\n\r\n          // ensure overdraw is backwards-compatable with legacy boolean type\r\n          this[key] = Number(newValue);\r\n\r\n        }\r\n        else {\r\n\r\n          this[key] = newValue;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this instanceof THREE.MeshBasicMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshLambertMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshPhongMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      output.specular = this.specular.getHex();\r\n      output.shininess = this.shininess;\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshNormalMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshDepthMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.PointCloudMaterial) {\r\n\r\n      output.size = this.size;\r\n      output.sizeAttenuation = this.sizeAttenuation;\r\n      output.color = this.color.getHex();\r\n\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n\r\n    }\r\n    else if (this instanceof THREE.ShaderMaterial) {\r\n\r\n      output.uniforms = this.uniforms;\r\n      output.vertexShader = this.vertexShader;\r\n      output.fragmentShader = this.fragmentShader;\r\n\r\n    }\r\n    else if (this instanceof THREE.SpriteMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n\r\n    }\r\n\r\n    if (this.opacity < 1) output.opacity = this.opacity;\r\n    if (this.transparent !== false) output.transparent = this.transparent;\r\n    if (this.wireframe !== false) output.wireframe = this.wireframe;\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(material) {\r\n\r\n    if (material === undefined) material = new THREE.Material();\r\n\r\n    material.name = this.name;\r\n\r\n    material.side = this.side;\r\n\r\n    material.opacity = this.opacity;\r\n    material.transparent = this.transparent;\r\n\r\n    material.blending = this.blending;\r\n\r\n    material.blendSrc = this.blendSrc;\r\n    material.blendDst = this.blendDst;\r\n    material.blendEquation = this.blendEquation;\r\n    material.blendSrcAlpha = this.blendSrcAlpha;\r\n    material.blendDstAlpha = this.blendDstAlpha;\r\n    material.blendEquationAlpha = this.blendEquationAlpha;\r\n\r\n    material.depthTest = this.depthTest;\r\n    material.depthWrite = this.depthWrite;\r\n\r\n    material.polygonOffset = this.polygonOffset;\r\n    material.polygonOffsetFactor = this.polygonOffsetFactor;\r\n    material.polygonOffsetUnits = this.polygonOffsetUnits;\r\n\r\n    material.alphaTest = this.alphaTest;\r\n\r\n    material.overdraw = this.overdraw;\r\n\r\n    material.visible = this.visible;\r\n\r\n    return material;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Material.prototype);\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n  this.linecap = 'round';\r\n  this.linejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n  material.linecap = this.linecap;\r\n  material.linejoin = this.linejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineDashedMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.scale = 1;\r\n  this.dashSize = 3;\r\n  this.gapSize = 1;\r\n\r\n  this.vertexColors = false;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineDashedMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n\r\n  material.scale = this.scale;\r\n  material.dashSize = this.dashSize;\r\n  material.gapSize = this.gapSize;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // emissive\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshLambertMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshLambertMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshPhongMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n  this.specular = new THREE.Color(0x111111);\r\n  this.shininess = 30;\r\n\r\n  this.metal = false;\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.bumpMap = null;\r\n  this.bumpScale = 1;\r\n\r\n  this.normalMap = null;\r\n  this.normalScale = new THREE.Vector2(1, 1);\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshPhongMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n  material.specular.copy(this.specular);\r\n  material.shininess = this.shininess;\r\n\r\n  material.metal = this.metal;\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.bumpMap = this.bumpMap;\r\n  material.bumpScale = this.bumpScale;\r\n\r\n  material.normalMap = this.normalMap;\r\n  material.normalScale.copy(this.normalScale);\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshDepthMaterial';\r\n\r\n  this.morphTargets = false;\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshDepthMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  shading: THREE.FlatShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this, parameters);\r\n\r\n  this.type = 'MeshNormalMaterial';\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshNormalMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshFaceMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MeshFaceMaterial = function(materials) {\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.type = 'MeshFaceMaterial';\r\n\r\n  this.materials = materials instanceof Array ? materials : [];\r\n\r\n};\r\n\r\nTHREE.MeshFaceMaterial.prototype = {\r\n\r\n  constructor: THREE.MeshFaceMaterial,\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      materials: []\r\n    };\r\n\r\n    for (var i = 0, l = this.materials.length; i < l; i++) {\r\n\r\n      output.materials.push(this.materials[i].toJSON());\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var material = new THREE.MeshFaceMaterial();\r\n\r\n    for (var i = 0; i < this.materials.length; i++) {\r\n\r\n      material.materials.push(this.materials[i].clone());\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/PointCloudMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointCloudMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'PointCloudMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.map = null;\r\n\r\n  this.size = 1;\r\n  this.sizeAttenuation = true;\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.PointCloudMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.PointCloudMaterial.prototype.constructor = THREE.PointCloudMaterial;\r\n\r\nTHREE.PointCloudMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.PointCloudMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.size = this.size;\r\n  material.sizeAttenuation = this.sizeAttenuation;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.ParticleBasicMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\nTHREE.ParticleSystemMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'ShaderMaterial';\r\n\r\n  this.defines = {};\r\n  this.uniforms = {};\r\n  this.attributes = null;\r\n\r\n  this.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n  this.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.fog = false; // set to use scene fog\r\n\r\n  this.lights = false; // set to use scene lights\r\n\r\n  this.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n  this.skinning = false; // set to use skinning attribute streams\r\n\r\n  this.morphTargets = false; // set to use morph targets\r\n  this.morphNormals = false; // set to use morph normals\r\n\r\n  // When rendered geometry doesn't include these attributes but the material does,\r\n  // use these default values in WebGL. This avoids errors when buffer data is missing.\r\n  this.defaultAttributeValues = {\r\n    'color': [1, 1, 1],\r\n    'uv': [0, 0],\r\n    'uv2': [0, 0]\r\n  };\r\n\r\n  this.index0AttributeName = undefined;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.ShaderMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.fragmentShader = this.fragmentShader;\r\n  material.vertexShader = this.vertexShader;\r\n\r\n  material.uniforms = THREE.UniformsUtils.clone(this.uniforms);\r\n\r\n  material.attributes = this.attributes;\r\n  material.defines = this.defines;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.lights = this.lights;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function(parameters) {\r\n\r\n  THREE.ShaderMaterial.call(this, parameters);\r\n\r\n  this.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\nTHREE.RawShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.RawShaderMaterial();\r\n\r\n  THREE.ShaderMaterial.prototype.clone.call(this, material);\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'SpriteMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n  this.map = null;\r\n\r\n  this.rotation = 0;\r\n\r\n  this.fog = false;\r\n\r\n  // set parameters\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.SpriteMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.map = this.map;\r\n\r\n  material.rotation = this.rotation;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function(image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.TextureIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.sourceFile = '';\r\n\r\n  this.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n  this.mipmaps = [];\r\n\r\n  this.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n  this.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n  this.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n  this.format = format !== undefined ? format : THREE.RGBAFormat;\r\n  this.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.generateMipmaps = true;\r\n  this.premultiplyAlpha = false;\r\n  this.flipY = true;\r\n  this.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n  this._needsUpdate = false;\r\n  this.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n  constructor: THREE.Texture,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  clone: function(texture) {\r\n\r\n    if (texture === undefined) texture = new THREE.Texture();\r\n\r\n    texture.image = this.image;\r\n    texture.mipmaps = this.mipmaps.slice(0);\r\n\r\n    texture.mapping = this.mapping;\r\n\r\n    texture.wrapS = this.wrapS;\r\n    texture.wrapT = this.wrapT;\r\n\r\n    texture.magFilter = this.magFilter;\r\n    texture.minFilter = this.minFilter;\r\n\r\n    texture.anisotropy = this.anisotropy;\r\n\r\n    texture.format = this.format;\r\n    texture.type = this.type;\r\n\r\n    texture.offset.copy(this.offset);\r\n    texture.repeat.copy(this.repeat);\r\n\r\n    texture.generateMipmaps = this.generateMipmaps;\r\n    texture.premultiplyAlpha = this.premultiplyAlpha;\r\n    texture.flipY = this.flipY;\r\n    texture.unpackAlignment = this.unpackAlignment;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function(images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  mapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n  THREE.Texture.call(this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.images = images;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nTHREE.CubeTexture.clone = function(texture) {\r\n\r\n  if (texture === undefined) texture = new THREE.CubeTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  texture.images = this.images;\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function(mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    width: width,\r\n    height: height\r\n  };\r\n  this.mipmaps = mipmaps;\r\n\r\n  // no flipping for cube textures\r\n  // (also flipping doesn't work for compressed textures )\r\n\r\n  this.flipY = false;\r\n\r\n  // can't generate mipmaps for compressed textures\r\n  // mips must be embedded in DDS files\r\n\r\n  this.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\nTHREE.CompressedTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.CompressedTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function(data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    data: data,\r\n    width: width,\r\n    height: height\r\n  };\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\nTHREE.DataTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.DataTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function(video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  THREE.Texture.call(this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.generateMipmaps = false;\r\n\r\n  var scope = this;\r\n\r\n  var update = function() {\r\n\r\n    requestAnimationFrame(update);\r\n\r\n    if (video.readyState === video.HAVE_ENOUGH_DATA) {\r\n\r\n      scope.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  update();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n\r\n// File:src/objects/PointCloud.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.PointCloud = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'PointCloud';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.PointCloudMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n};\r\n\r\nTHREE.PointCloud.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.PointCloud.prototype.constructor = THREE.PointCloud;\r\n\r\nTHREE.PointCloud.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var object = this;\r\n    var geometry = object.geometry;\r\n    var threshold = raycaster.params.PointCloud.threshold;\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var localThreshold = threshold / ((this.scale.x + this.scale.y + this.scale.z) / 3);\r\n    var position = new THREE.Vector3();\r\n\r\n    var testPoint = function(point, index) {\r\n\r\n      var rayPointDistance = ray.distanceToPoint(point);\r\n\r\n      if (rayPointDistance < localThreshold) {\r\n\r\n        var intersectPoint = ray.closestPointToPoint(point);\r\n        intersectPoint.applyMatrix4(object.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectPoint);\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          distanceToRay: rayPointDistance,\r\n          point: intersectPoint.clone(),\r\n          index: index,\r\n          face: null,\r\n          object: object\r\n\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          var offset = {\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          };\r\n\r\n          offsets = [offset];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i++) {\r\n\r\n            var a = index + indices[i];\r\n\r\n            position.fromArray(positions, a * 3);\r\n\r\n            testPoint(position, a);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var pointCount = positions.length / 3;\r\n\r\n        for (var i = 0; i < pointCount; i++) {\r\n\r\n          position.set(\r\n            positions[3 * i],\r\n            positions[3 * i + 1],\r\n            positions[3 * i + 2]\r\n          );\r\n\r\n          testPoint(position, i);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      var vertices = this.geometry.vertices;\r\n\r\n      for (var i = 0; i < vertices.length; i++) {\r\n\r\n        testPoint(vertices[i], i);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.PointCloud.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.PointCloud(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.ParticleSystem = function(geometry, material) {\r\n\r\n  THREE.warn('THREE.ParticleSystem has been renamed to THREE.PointCloud.');\r\n  return new THREE.PointCloud(geometry, material);\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function(geometry, material, mode) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Line';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.LineBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.mode = mode !== undefined ? mode : THREE.LineStrip;\r\n\r\n};\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\nTHREE.Line.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var precision = raycaster.linePrecision;\r\n    var precisionSq = precision * precision;\r\n\r\n    var geometry = this.geometry;\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    var vStart = new THREE.Vector3();\r\n    var vEnd = new THREE.Vector3();\r\n    var interSegment = new THREE.Vector3();\r\n    var interRay = new THREE.Vector3();\r\n    var step = this.mode === THREE.LineStrip ? 1 : 2;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0; oi < offsets.length; oi++) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start; i < start + count - 1; i += step) {\r\n\r\n            var a = index + indices[i];\r\n            var b = index + indices[i + 1];\r\n\r\n            vStart.fromArray(positions, a * 3);\r\n            vEnd.fromArray(positions, b * 3);\r\n\r\n            var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n            if (distSq > precisionSq) continue;\r\n\r\n            var distance = ray.origin.distanceTo(interRay);\r\n\r\n            if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              // What do we want? intersection point on the ray or on the segment??\r\n              // point: raycaster.ray.at( distance ),\r\n              point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n              index: i,\r\n              offsetIndex: oi,\r\n              face: null,\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0; i < positions.length / 3 - 1; i += step) {\r\n\r\n          vStart.fromArray(positions, 3 * i);\r\n          vEnd.fromArray(positions, 3 * i + 3);\r\n\r\n          var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n          if (distSq > precisionSq) continue;\r\n\r\n          var distance = ray.origin.distanceTo(interRay);\r\n\r\n          if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            // What do we want? intersection point on the ray or on the segment??\r\n            // point: raycaster.ray.at( distance ),\r\n            point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n            index: i,\r\n            face: null,\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var vertices = geometry.vertices;\r\n      var nbVertices = vertices.length;\r\n\r\n      for (var i = 0; i < nbVertices - 1; i += step) {\r\n\r\n        var distSq = ray.distanceSqToSegment(vertices[i], vertices[i + 1], interRay, interSegment);\r\n\r\n        if (distSq > precisionSq) continue;\r\n\r\n        var distance = ray.origin.distanceTo(interRay);\r\n\r\n        if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          // What do we want? intersection point on the ray or on the segment??\r\n          // point: raycaster.ray.at( distance ),\r\n          point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n          index: i,\r\n          face: null,\r\n          faceIndex: null,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Line.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Line(this.geometry, this.material, this.mode);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Mesh';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.MeshBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function() {\r\n\r\n  if (this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0) {\r\n\r\n    this.morphTargetBase = -1;\r\n    this.morphTargetForcedOrder = [];\r\n    this.morphTargetInfluences = [];\r\n    this.morphTargetDictionary = {};\r\n\r\n    for (var m = 0, ml = this.geometry.morphTargets.length; m < ml; m++) {\r\n\r\n      this.morphTargetInfluences.push(0);\r\n      this.morphTargetDictionary[this.geometry.morphTargets[m].name] = m;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function(name) {\r\n\r\n  if (this.morphTargetDictionary[name] !== undefined) {\r\n\r\n    return this.morphTargetDictionary[name];\r\n\r\n  }\r\n\r\n  THREE.warn('THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.');\r\n\r\n  return 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  var vA = new THREE.Vector3();\r\n  var vB = new THREE.Vector3();\r\n  var vC = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var geometry = this.geometry;\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    // Check boundingBox before continuing\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var material = this.material;\r\n\r\n      if (material === undefined) return;\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            a = index + indices[i];\r\n            b = index + indices[i + 1];\r\n            c = index + indices[i + 2];\r\n\r\n            vA.fromArray(positions, a * 3);\r\n            vB.fromArray(positions, b * 3);\r\n            vC.fromArray(positions, c * 3);\r\n\r\n            if (material.side === THREE.BackSide) {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n            }\r\n            else {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n            }\r\n\r\n            if (intersectionPoint === null) continue;\r\n\r\n            intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n            var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n            if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              point: intersectionPoint,\r\n              face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0, j = 0, il = positions.length; i < il; i += 3, j += 9) {\r\n\r\n          a = i;\r\n          b = i + 1;\r\n          c = i + 2;\r\n\r\n          vA.fromArray(positions, j);\r\n          vB.fromArray(positions, j + 3);\r\n          vC.fromArray(positions, j + 6);\r\n\r\n          if (material.side === THREE.BackSide) {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n          }\r\n          else {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n          }\r\n\r\n          if (intersectionPoint === null) continue;\r\n\r\n          intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n          var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n          if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            point: intersectionPoint,\r\n            face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var isFaceMaterial = this.material instanceof THREE.MeshFaceMaterial;\r\n      var objectMaterials = isFaceMaterial === true ? this.material.materials : null;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      var vertices = geometry.vertices;\r\n\r\n      for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n        var face = geometry.faces[f];\r\n\r\n        var material = isFaceMaterial === true ? objectMaterials[face.materialIndex] : this.material;\r\n\r\n        if (material === undefined) continue;\r\n\r\n        a = vertices[face.a];\r\n        b = vertices[face.b];\r\n        c = vertices[face.c];\r\n\r\n        if (material.morphTargets === true) {\r\n\r\n          var morphTargets = geometry.morphTargets;\r\n          var morphInfluences = this.morphTargetInfluences;\r\n\r\n          vA.set(0, 0, 0);\r\n          vB.set(0, 0, 0);\r\n          vC.set(0, 0, 0);\r\n\r\n          for (var t = 0, tl = morphTargets.length; t < tl; t++) {\r\n\r\n            var influence = morphInfluences[t];\r\n\r\n            if (influence === 0) continue;\r\n\r\n            var targets = morphTargets[t].vertices;\r\n\r\n            vA.x += (targets[face.a].x - a.x) * influence;\r\n            vA.y += (targets[face.a].y - a.y) * influence;\r\n            vA.z += (targets[face.a].z - a.z) * influence;\r\n\r\n            vB.x += (targets[face.b].x - b.x) * influence;\r\n            vB.y += (targets[face.b].y - b.y) * influence;\r\n            vB.z += (targets[face.b].z - b.z) * influence;\r\n\r\n            vC.x += (targets[face.c].x - c.x) * influence;\r\n            vC.y += (targets[face.c].y - c.y) * influence;\r\n            vC.z += (targets[face.c].z - c.z) * influence;\r\n\r\n          }\r\n\r\n          vA.add(a);\r\n          vB.add(b);\r\n          vC.add(c);\r\n\r\n          a = vA;\r\n          b = vB;\r\n          c = vC;\r\n\r\n        }\r\n\r\n        if (material.side === THREE.BackSide) {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(c, b, a, true);\r\n\r\n        }\r\n        else {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(a, b, c, material.side !== THREE.DoubleSide);\r\n\r\n        }\r\n\r\n        if (intersectionPoint === null) continue;\r\n\r\n        intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n        if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          point: intersectionPoint,\r\n          face: face,\r\n          faceIndex: f,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Mesh.prototype.clone = function(object, recursive) {\r\n\r\n  if (object === undefined) object = new THREE.Mesh(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object, recursive);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function(skin) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Bone';\r\n\r\n  this.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function(bones, boneInverses, useVertexTexture) {\r\n\r\n  this.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n  this.identityMatrix = new THREE.Matrix4();\r\n\r\n  // copy the bone array\r\n\r\n  bones = bones || [];\r\n\r\n  this.bones = bones.slice(0);\r\n\r\n  // create a bone texture or an array of floats\r\n\r\n  if (this.useVertexTexture) {\r\n\r\n    // layout (1 matrix = 4 pixels)\r\n    //      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n    //  with  8x8  pixel texture max   16 bones  (8 * 8  / 4)\r\n    //       16x16 pixel texture max   64 bones (16 * 16 / 4)\r\n    //       32x32 pixel texture max  256 bones (32 * 32 / 4)\r\n    //       64x64 pixel texture max 1024 bones (64 * 64 / 4)\r\n\r\n    var size;\r\n\r\n    if (this.bones.length > 256)\r\n      size = 64;\r\n    else if (this.bones.length > 64)\r\n      size = 32;\r\n    else if (this.bones.length > 16)\r\n      size = 16;\r\n    else\r\n      size = 8;\r\n\r\n    this.boneTextureWidth = size;\r\n    this.boneTextureHeight = size;\r\n\r\n    this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4); // 4 floats per RGBA pixel\r\n    this.boneTexture = new THREE.DataTexture(this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType);\r\n    this.boneTexture.minFilter = THREE.NearestFilter;\r\n    this.boneTexture.magFilter = THREE.NearestFilter;\r\n    this.boneTexture.generateMipmaps = false;\r\n    this.boneTexture.flipY = false;\r\n\r\n  }\r\n  else {\r\n\r\n    this.boneMatrices = new Float32Array(16 * this.bones.length);\r\n\r\n  }\r\n\r\n  // use the supplied bone inverses or calculate the inverses\r\n\r\n  if (boneInverses === undefined) {\r\n\r\n    this.calculateInverses();\r\n\r\n  }\r\n  else {\r\n\r\n    if (this.bones.length === boneInverses.length) {\r\n\r\n      this.boneInverses = boneInverses.slice(0);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Skeleton bonInverses is the wrong length.');\r\n\r\n      this.boneInverses = [];\r\n\r\n      for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n        this.boneInverses.push(new THREE.Matrix4());\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function() {\r\n\r\n  this.boneInverses = [];\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    var inverse = new THREE.Matrix4();\r\n\r\n    if (this.bones[b]) {\r\n\r\n      inverse.getInverse(this.bones[b].matrixWorld);\r\n\r\n    }\r\n\r\n    this.boneInverses.push(inverse);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function() {\r\n\r\n  var bone;\r\n\r\n  // recover the bind-time world matrices\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      bone.matrixWorld.getInverse(this.boneInverses[b]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // compute the local matrices, positions, rotations and scales\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      if (bone.parent) {\r\n\r\n        bone.matrix.getInverse(bone.parent.matrixWorld);\r\n        bone.matrix.multiply(bone.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.matrix.copy(bone.matrixWorld);\r\n\r\n      }\r\n\r\n      bone.matrix.decompose(bone.position, bone.quaternion, bone.scale);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = (function() {\r\n\r\n  var offsetMatrix = new THREE.Matrix4();\r\n\r\n  return function() {\r\n\r\n    // flatten bone matrices to array\r\n\r\n    for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n      // compute the offset between the current and the original transform\r\n\r\n      var matrix = this.bones[b] ? this.bones[b].matrixWorld : this.identityMatrix;\r\n\r\n      offsetMatrix.multiplyMatrices(matrix, this.boneInverses[b]);\r\n      offsetMatrix.flattenToArrayOffset(this.boneMatrices, b * 16);\r\n\r\n    }\r\n\r\n    if (this.useVertexTexture) {\r\n\r\n      this.boneTexture.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n})();\r\n\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function(geometry, material, useVertexTexture) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'SkinnedMesh';\r\n\r\n  this.bindMode = \"attached\";\r\n  this.bindMatrix = new THREE.Matrix4();\r\n  this.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n  // init bones\r\n\r\n  // TODO: remove bone creation as there is no reason (other than\r\n  // convenience) for THREE.SkinnedMesh to do this.\r\n\r\n  var bones = [];\r\n\r\n  if (this.geometry && this.geometry.bones !== undefined) {\r\n\r\n    var bone, gbone, p, q, s;\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      p = gbone.pos;\r\n      q = gbone.rotq;\r\n      s = gbone.scl;\r\n\r\n      bone = new THREE.Bone(this);\r\n      bones.push(bone);\r\n\r\n      bone.name = gbone.name;\r\n      bone.position.set(p[0], p[1], p[2]);\r\n      bone.quaternion.set(q[0], q[1], q[2], q[3]);\r\n\r\n      if (s !== undefined) {\r\n\r\n        bone.scale.set(s[0], s[1], s[2]);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.scale.set(1, 1, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      if (gbone.parent !== -1) {\r\n\r\n        bones[gbone.parent].add(bones[b]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.add(bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.normalizeSkinWeights();\r\n\r\n  this.updateMatrixWorld(true);\r\n  this.bind(new THREE.Skeleton(bones, undefined, useVertexTexture));\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function(skeleton, bindMatrix) {\r\n\r\n  this.skeleton = skeleton;\r\n\r\n  if (bindMatrix === undefined) {\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    bindMatrix = this.matrixWorld;\r\n\r\n  }\r\n\r\n  this.bindMatrix.copy(bindMatrix);\r\n  this.bindMatrixInverse.getInverse(bindMatrix);\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function() {\r\n\r\n  this.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function() {\r\n\r\n  if (this.geometry instanceof THREE.Geometry) {\r\n\r\n    for (var i = 0; i < this.geometry.skinIndices.length; i++) {\r\n\r\n      var sw = this.geometry.skinWeights[i];\r\n\r\n      var scale = 1.0 / sw.lengthManhattan();\r\n\r\n      if (scale !== Infinity) {\r\n\r\n        sw.multiplyScalar(scale);\r\n\r\n      }\r\n      else {\r\n\r\n        sw.set(1); // this will be normalized by the shader anyway\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    // skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function(force) {\r\n\r\n  THREE.Mesh.prototype.updateMatrixWorld.call(this, true);\r\n\r\n  if (this.bindMode === \"attached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.matrixWorld);\r\n\r\n  }\r\n  else if (this.bindMode === \"detached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.bindMatrix);\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.SkinnedMesh unreckognized bindMode: ' + this.bindMode);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) {\r\n\r\n    object = new THREE.SkinnedMesh(this.geometry, this.material, this.useVertexTexture);\r\n\r\n  }\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n\r\n// File:src/objects/MorphAnimMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphAnimMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'MorphAnimMesh';\r\n\r\n  // API\r\n\r\n  this.duration = 1000; // milliseconds\r\n  this.mirroredLoop = false;\r\n  this.time = 0;\r\n\r\n  // internals\r\n\r\n  this.lastKeyframe = 0;\r\n  this.currentKeyframe = 0;\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n  this.setFrameRange(0, this.geometry.morphTargets.length - 1);\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;\r\n\r\nTHREE.MorphAnimMesh.prototype.setFrameRange = function(start, end) {\r\n\r\n  this.startKeyframe = start;\r\n  this.endKeyframe = end;\r\n\r\n  this.length = this.endKeyframe - this.startKeyframe + 1;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionForward = function() {\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionBackward = function() {\r\n\r\n  this.direction = -1;\r\n  this.directionBackwards = true;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.parseAnimations = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  if (!geometry.animations) geometry.animations = {};\r\n\r\n  var firstAnimation, animations = geometry.animations;\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var parts = morph.name.match(pattern);\r\n\r\n    if (parts && parts.length > 1) {\r\n\r\n      var label = parts[1];\r\n\r\n      if (!animations[label]) animations[label] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var animation = animations[label];\r\n\r\n      if (i < animation.start) animation.start = i;\r\n      if (i > animation.end) animation.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = label;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setAnimationLabel = function(label, start, end) {\r\n\r\n  if (!this.geometry.animations) this.geometry.animations = {};\r\n\r\n  this.geometry.animations[label] = {\r\n    start: start,\r\n    end: end\r\n  };\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.playAnimation = function(label, fps) {\r\n\r\n  var animation = this.geometry.animations[label];\r\n\r\n  if (animation) {\r\n\r\n    this.setFrameRange(animation.start, animation.end);\r\n    this.duration = 1000 * ((animation.end - animation.start) / fps);\r\n    this.time = 0;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.updateAnimation = function(delta) {\r\n\r\n  var frameTime = this.duration / this.length;\r\n\r\n  this.time += this.direction * delta;\r\n\r\n  if (this.mirroredLoop) {\r\n\r\n    if (this.time > this.duration || this.time < 0) {\r\n\r\n      this.direction *= -1;\r\n\r\n      if (this.time > this.duration) {\r\n\r\n        this.time = this.duration;\r\n        this.directionBackwards = true;\r\n\r\n      }\r\n\r\n      if (this.time < 0) {\r\n\r\n        this.time = 0;\r\n        this.directionBackwards = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    this.time = this.time % this.duration;\r\n\r\n    if (this.time < 0) this.time += this.duration;\r\n\r\n  }\r\n\r\n  var keyframe = this.startKeyframe + THREE.Math.clamp(Math.floor(this.time / frameTime), 0, this.length - 1);\r\n\r\n  if (keyframe !== this.currentKeyframe) {\r\n\r\n    this.morphTargetInfluences[this.lastKeyframe] = 0;\r\n    this.morphTargetInfluences[this.currentKeyframe] = 1;\r\n\r\n    this.morphTargetInfluences[keyframe] = 0;\r\n\r\n    this.lastKeyframe = this.currentKeyframe;\r\n    this.currentKeyframe = keyframe;\r\n\r\n  }\r\n\r\n  var mix = (this.time % frameTime) / frameTime;\r\n\r\n  if (this.directionBackwards) {\r\n\r\n    mix = 1 - mix;\r\n\r\n  }\r\n\r\n  this.morphTargetInfluences[this.currentKeyframe] = mix;\r\n  this.morphTargetInfluences[this.lastKeyframe] = 1 - mix;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.interpolateTargets = function(a, b, t) {\r\n\r\n  var influences = this.morphTargetInfluences;\r\n\r\n  for (var i = 0, l = influences.length; i < l; i++) {\r\n\r\n    influences[i] = 0;\r\n\r\n  }\r\n\r\n  if (a > -1) influences[a] = 1 - t;\r\n  if (b > -1) influences[b] = t;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.MorphAnimMesh(this.geometry, this.material);\r\n\r\n  object.duration = this.duration;\r\n  object.mirroredLoop = this.mirroredLoop;\r\n  object.time = this.time;\r\n\r\n  object.lastKeyframe = this.lastKeyframe;\r\n  object.currentKeyframe = this.currentKeyframe;\r\n\r\n  object.direction = this.direction;\r\n  object.directionBackwards = this.directionBackwards;\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.objects = [];\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function(object, distance) {\r\n\r\n  if (distance === undefined) distance = 0;\r\n\r\n  distance = Math.abs(distance);\r\n\r\n  for (var l = 0; l < this.objects.length; l++) {\r\n\r\n    if (distance < this.objects[l].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.objects.splice(l, 0, {\r\n    distance: distance,\r\n    object: object\r\n  });\r\n  this.add(object);\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function(distance) {\r\n\r\n  for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n    if (distance < this.objects[i].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  return this.objects[i - 1].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.origin.distanceTo(matrixPosition);\r\n\r\n    this.getObjectForDistance(distance).raycast(raycaster, intersects);\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.LOD.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(camera) {\r\n\r\n    if (this.objects.length > 1) {\r\n\r\n      v1.setFromMatrixPosition(camera.matrixWorld);\r\n      v2.setFromMatrixPosition(this.matrixWorld);\r\n\r\n      var distance = v1.distanceTo(v2);\r\n\r\n      this.objects[0].object.visible = true;\r\n\r\n      for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n        if (distance >= this.objects[i].distance) {\r\n\r\n          this.objects[i - 1].object.visible = false;\r\n          this.objects[i].object.visible = true;\r\n\r\n        }\r\n        else {\r\n\r\n          break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (; i < l; i++) {\r\n\r\n        this.objects[i].object.visible = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.LOD();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  for (var i = 0, l = this.objects.length; i < l; i++) {\r\n    var x = this.objects[i].object.clone();\r\n    x.visible = i === 0;\r\n    object.addLevel(x, this.objects[i].distance);\r\n  }\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = (function() {\r\n\r\n  var indices = new Uint16Array([0, 1, 2, 0, 2, 3]);\r\n  var vertices = new Float32Array([-0.5, -0.5, 0, 0.5, -0.5, 0, 0.5, 0.5, 0, -0.5, 0.5, 0]);\r\n  var uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n  return function(material) {\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    this.type = 'Sprite';\r\n\r\n    this.geometry = geometry;\r\n    this.material = (material !== undefined) ? material : new THREE.SpriteMaterial();\r\n\r\n  };\r\n\r\n})();\r\n\r\nTHREE.Sprite.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.distanceToPoint(matrixPosition);\r\n\r\n    if (distance > this.scale.x) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    intersects.push({\r\n\r\n      distance: distance,\r\n      point: this.position,\r\n      face: null,\r\n      object: this\r\n\r\n    });\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Sprite.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Sprite(this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function(texture, size, distance, blending, color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.lensFlares = [];\r\n\r\n  this.positionScreen = new THREE.Vector3();\r\n  this.customUpdateCallback = undefined;\r\n\r\n  if (texture !== undefined) {\r\n\r\n    this.add(texture, size, distance, blending, color);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function(texture, size, distance, blending, color, opacity) {\r\n\r\n  if (size === undefined) size = -1;\r\n  if (distance === undefined) distance = 0;\r\n  if (opacity === undefined) opacity = 1;\r\n  if (color === undefined) color = new THREE.Color(0xffffff);\r\n  if (blending === undefined) blending = THREE.NormalBlending;\r\n\r\n  distance = Math.min(distance, Math.max(0, distance));\r\n\r\n  this.lensFlares.push({\r\n    texture: texture, // THREE.Texture\r\n    size: size, // size in pixels (-1 = use texture.width)\r\n    distance: distance, // distance (0-1) from light source (0=at light source)\r\n    x: 0,\r\n    y: 0,\r\n    z: 0, // screen position (-1 => 1) z = 0 is ontop z = 1 is back\r\n    scale: 1, // scale\r\n    rotation: 1, // rotation\r\n    opacity: opacity, // opacity\r\n    color: color, // color\r\n    blending: blending // blending\r\n  });\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function() {\r\n\r\n  var f, fl = this.lensFlares.length;\r\n  var flare;\r\n  var vecX = -this.positionScreen.x * 2;\r\n  var vecY = -this.positionScreen.y * 2;\r\n\r\n  for (f = 0; f < fl; f++) {\r\n\r\n    flare = this.lensFlares[f];\r\n\r\n    flare.x = this.positionScreen.x + vecX * flare.distance;\r\n    flare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n    flare.wantedRotation = flare.x * Math.PI * 0.25;\r\n    flare.rotation += (flare.wantedRotation - flare.rotation) * 0.25;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Scene';\r\n\r\n  this.fog = null;\r\n  this.overrideMaterial = null;\r\n\r\n  this.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Scene();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  if (this.fog !== null) object.fog = this.fog.clone();\r\n  if (this.overrideMaterial !== null) object.overrideMaterial = this.overrideMaterial.clone();\r\n\r\n  object.autoUpdate = this.autoUpdate;\r\n  object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function(color, near, far) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n  this.near = (near !== undefined) ? near : 1;\r\n  this.far = (far !== undefined) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function() {\r\n\r\n  return new THREE.Fog(this.color.getHex(), this.near, this.far);\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function(color, density) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n  this.density = (density !== undefined) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function() {\r\n\r\n  return new THREE.FogExp2(this.color.getHex(), this.density);\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk['common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\nfloat square( in float a ) { return a*a; }\\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\\nfloat average( in float a ) { return a; }\\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n}\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\\n\treturn point - distance * planeNormal;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\\n}\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\tif ( decayExponent > 0.0 ) {\\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\\n\t}\\n\treturn 1.0;\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n#ifdef GAMMA_INPUT\\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\nvec3 linearToOutput( in vec3 a ) {\\n#ifdef GAMMA_OUTPUT\\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\ntransformedNormal = normalize( transformedNormal );\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\tfloat dotProduct = dot( transformedNormal, dirVector );\\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\t#ifdef WRAP_AROUND\\n\\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\\n\\n\t#endif\\n\\n}\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tlVector = normalize( lVector );\\n\\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\\n\\n\t\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/default_vertex.glsl\r\n\r\nTHREE.ShaderChunk['default_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#elif defined( USE_MORPHTARGETS )\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\\n\\n#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\t#ifdef USE_MORPHNORMALS\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\\n\\n\t#else\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\nvec3 viewPosition = normalize( vViewPosition );\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\\n\\n\t\t\t\t// specular\\n\\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t\t#else\\n\\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t\t#endif\\n\\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, dirVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\\n\\n\t\t// specular\\n\\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t/*\\n\t\t// fresnel term from skin shader\\n\t\tconst float F0 = 0.128;\\n\\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\\n\t\tfloat exponential = pow( base, 5.0 );\\n\\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\\n\t\t*/\\n\\n\t\t/*\\n\t\t// fresnel term from fresnel shader\\n\t\tconst float mFresnelBias = 0.08;\\n\t\tconst float mFresnelScale = 0.3;\\n\t\tconst float mFresnelPower = 5.0;\\n\\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\\n\t\t*/\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += hemiColor;\\n\\n\t\t// specular (sky light)\\n\\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\\n\\n\t\t// specular (ground light)\\n\\n\t\tvec3 lVectorGround = -lVector;\\n\\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\\n\\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tvec3 morphedNormal = vec3( 0.0 );\\n\\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n\tmorphedNormal += normal;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\tuniform sampler2D lightMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = inputToLinear( color.xyz );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\t#ifdef USE_MORPHTARGETS\\n\\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\r\nTHREE.ShaderChunk['linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\\n\t\tfogFactor = whiteCompliment( fogFactor );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['defaultnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec3 objectNormal = skinnedNormal.xyz;\\n\\n#elif defined( USE_MORPHNORMALS )\\n\\n\tvec3 objectNormal = morphedNormal;\\n\\n#else\\n\\n\tvec3 objectNormal = normal;\\n\\n#endif\\n\\n#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\tvec3 morphed = vec3( 0.0 );\\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n\tmorphed += position;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\tint inFrustumCount = 0;\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\t\t// don't shadow pixels outside of light frustum\\n\t\t\t\t// use just first frustum (for cascades)\\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\\n\\n\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\tinFrustumCount += int( inFrustum );\\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\\n\\n\t\t#else\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t#endif\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#else\\n\\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t}\\n\\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\\n\tshadowColor = inputToLinear( shadowColor );\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk['worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#elif defined( USE_MORPHTARGETS )\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\t#extension GL_EXT_frag_depth : enable\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n  merge: function(uniforms) {\r\n\r\n    var merged = {};\r\n\r\n    for (var u = 0; u < uniforms.length; u++) {\r\n\r\n      var tmp = this.clone(uniforms[u]);\r\n\r\n      for (var p in tmp) {\r\n\r\n        merged[p] = tmp[p];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return merged;\r\n\r\n  },\r\n\r\n  clone: function(uniforms_src) {\r\n\r\n    var uniforms_dst = {};\r\n\r\n    for (var u in uniforms_src) {\r\n\r\n      uniforms_dst[u] = {};\r\n\r\n      for (var p in uniforms_src[u]) {\r\n\r\n        var parameter_src = uniforms_src[u][p];\r\n\r\n        if (parameter_src instanceof THREE.Color ||\r\n          parameter_src instanceof THREE.Vector2 ||\r\n          parameter_src instanceof THREE.Vector3 ||\r\n          parameter_src instanceof THREE.Vector4 ||\r\n          parameter_src instanceof THREE.Matrix4 ||\r\n          parameter_src instanceof THREE.Texture) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.clone();\r\n\r\n        }\r\n        else if (parameter_src instanceof Array) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.slice();\r\n\r\n        }\r\n        else {\r\n\r\n          uniforms_dst[u][p] = parameter_src;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return uniforms_dst;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n  common: {\r\n\r\n    \"diffuse\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"lightMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"specularMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"alphaMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n\r\n    \"envMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"flipEnvMap\": {\r\n      type: \"f\",\r\n      value: -1\r\n    },\r\n    \"reflectivity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"refractionRatio\": {\r\n      type: \"f\",\r\n      value: 0.98\r\n    },\r\n\r\n    \"morphTargetInfluences\": {\r\n      type: \"f\",\r\n      value: 0\r\n    }\r\n\r\n  },\r\n\r\n  bump: {\r\n\r\n    \"bumpMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"bumpScale\": {\r\n      type: \"f\",\r\n      value: 1\r\n    }\r\n\r\n  },\r\n\r\n  normalmap: {\r\n\r\n    \"normalMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"normalScale\": {\r\n      type: \"v2\",\r\n      value: new THREE.Vector2(1, 1)\r\n    }\r\n  },\r\n\r\n  fog: {\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  lights: {\r\n\r\n    \"ambientLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"directionalLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"directionalLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"hemisphereLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightSkyColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightGroundColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"pointLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"pointLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"spotLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightAngleCos\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightExponent\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    }\r\n\r\n  },\r\n\r\n  particle: {\r\n\r\n    \"psColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"size\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"scale\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  shadowmap: {\r\n\r\n    \"shadowMap\": {\r\n      type: \"tv\",\r\n      value: []\r\n    },\r\n    \"shadowMapSize\": {\r\n      type: \"v2v\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowBias\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"shadowDarkness\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowMatrix\": {\r\n      type: \"m4v\",\r\n      value: []\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n  'basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n\r\n      \"\t#ifdef USE_ENVMAP\",\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"], // TODO: Light map on an otherwise unlit surface doesn't make sense.\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"], // TODO: Shadows on an otherwise unlit surface doesn't make sense.\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'lambert': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define LAMBERT\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\t#ifdef DOUBLE_SIDED\",\r\n\r\n      //\"float isFront = float( gl_FrontFacing );\",\r\n      //\"gl_FragColor.xyz *= isFront * vLightFront + ( 1.0 - isFront ) * vLightBack;\",\r\n\r\n      \"\t\tif ( gl_FrontFacing )\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n      \"\t\telse\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'phong': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"bump\"],\r\n      THREE.UniformsLib[\"normalmap\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"specular\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x111111)\r\n        },\r\n        \"shininess\": {\r\n          type: \"f\",\r\n          value: 30\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"varying vec3 vViewPosition;\",\r\n\r\n      \"#ifndef FLAT_SHADED\",\r\n\r\n      \"\tvarying vec3 vNormal;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n      \"\tvNormal = normalize( transformedNormal );\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"\tvViewPosition = -mvPosition.xyz;\",\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform vec3 specular;\",\r\n      \"uniform float shininess;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"bumpmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"normalmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lights_phong_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'particle_basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"particle\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float size;\",\r\n      \"uniform float scale;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      \"\t#ifdef USE_SIZEATTENUATION\",\r\n      \"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n      \"\t#else\",\r\n      \"\t\tgl_PointSize = size;\",\r\n      \"\t#endif\",\r\n\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 psColor;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'dashed': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n\r\n      {\r\n        \"scale\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"dashSize\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"totalSize\": {\r\n          type: \"f\",\r\n          value: 2\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float scale;\",\r\n      \"attribute float lineDistance;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvLineDistance = scale * lineDistance;\",\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"uniform float dashSize;\",\r\n      \"uniform float totalSize;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\r\n      \"\t\tdiscard;\",\r\n\r\n      \"\t}\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'depth': {\r\n\r\n    uniforms: {\r\n\r\n      \"mNear\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      },\r\n      \"mFar\": {\r\n        type: \"f\",\r\n        value: 2000.0\r\n      },\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float mNear;\",\r\n      \"uniform float mFar;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      \"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n      \"\tgl_FragColor = vec4( vec3( color ), opacity );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'normal': {\r\n\r\n    uniforms: {\r\n\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvNormal = normalize( normalMatrix * normal );\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float opacity;\",\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'cube': {\r\n\r\n    uniforms: {\r\n      \"tCube\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform samplerCube tCube;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'equirect': {\r\n\r\n    uniforms: {\r\n      \"tEquirect\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform sampler2D tEquirect;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      // \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n      \"vec3 direction = normalize( vWorldPosition );\",\r\n      \"vec2 sampleUV;\",\r\n      \"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n      \"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n      \"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* Depth encoding into RGBA texture\r\n   *\r\n   * based on SpiderGL shadow map example\r\n   * http://spidergl.org/example.php?id=6\r\n   *\r\n   * originally from\r\n   * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n   *\r\n   * see also\r\n   * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n   */\r\n\r\n  'depthRGBA': {\r\n\r\n    uniforms: {},\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"vec4 pack_depth( const in float depth ) {\",\r\n\r\n      \"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n      \"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n      \"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n      \"\tres -= res.xxyz * bit_mask;\",\r\n      \"\treturn res;\",\r\n\r\n      \"}\",\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\r\n      \"\t#endif\",\r\n\r\n      //\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n      //\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n      //\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n      //\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.WebGLRenderer = function(parameters) {\r\n\r\n  console.log('THREE.WebGLRenderer', THREE.REVISION);\r\n\r\n  parameters = parameters || {};\r\n\r\n  var _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement('canvas'),\r\n    _context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n    pixelRatio = 1,\r\n\r\n    _precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\r\n    _alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n    _depth = parameters.depth !== undefined ? parameters.depth : true,\r\n    _stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n    _antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n    _premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n    _preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n    _logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false,\r\n\r\n    _clearColor = new THREE.Color(0x000000),\r\n    _clearAlpha = 0;\r\n\r\n  var lights = [];\r\n\r\n  var _webglObjects = {};\r\n  var _webglObjectsImmediate = [];\r\n\r\n  var opaqueObjects = [];\r\n  var transparentObjects = [];\r\n\r\n  var sprites = [];\r\n  var lensFlares = [];\r\n\r\n  // public properties\r\n\r\n  this.domElement = _canvas;\r\n  this.context = null;\r\n\r\n  // clearing\r\n\r\n  this.autoClear = true;\r\n  this.autoClearColor = true;\r\n  this.autoClearDepth = true;\r\n  this.autoClearStencil = true;\r\n\r\n  // scene graph\r\n\r\n  this.sortObjects = true;\r\n\r\n  // physically based shading\r\n\r\n  this.gammaFactor = 2.0; // for backwards compatibility\r\n  this.gammaInput = false;\r\n  this.gammaOutput = false;\r\n\r\n  // shadow map\r\n\r\n  this.shadowMapEnabled = false;\r\n  this.shadowMapType = THREE.PCFShadowMap;\r\n  this.shadowMapCullFace = THREE.CullFaceFront;\r\n  this.shadowMapDebug = false;\r\n  this.shadowMapCascade = false;\r\n\r\n  // morphs\r\n\r\n  this.maxMorphTargets = 8;\r\n  this.maxMorphNormals = 4;\r\n\r\n  // flags\r\n\r\n  this.autoScaleCubemaps = true;\r\n\r\n  // info\r\n\r\n  this.info = {\r\n\r\n    memory: {\r\n\r\n      programs: 0,\r\n      geometries: 0,\r\n      textures: 0\r\n\r\n    },\r\n\r\n    render: {\r\n\r\n      calls: 0,\r\n      vertices: 0,\r\n      faces: 0,\r\n      points: 0\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // internal properties\r\n\r\n  var _this = this,\r\n\r\n    _programs = [],\r\n\r\n    // internal state cache\r\n\r\n    _currentProgram = null,\r\n    _currentFramebuffer = null,\r\n    _currentMaterialId = -1,\r\n    _currentGeometryProgram = '',\r\n    _currentCamera = null,\r\n\r\n    _usedTextureUnits = 0,\r\n\r\n    _viewportX = 0,\r\n    _viewportY = 0,\r\n    _viewportWidth = _canvas.width,\r\n    _viewportHeight = _canvas.height,\r\n    _currentWidth = 0,\r\n    _currentHeight = 0,\r\n\r\n    // frustum\r\n\r\n    _frustum = new THREE.Frustum(),\r\n\r\n    // camera matrices cache\r\n\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _vector3 = new THREE.Vector3(),\r\n\r\n    // light arrays cache\r\n\r\n    _direction = new THREE.Vector3(),\r\n\r\n    _lightsNeedUpdate = true,\r\n\r\n    _lights = {\r\n\r\n      ambient: [0, 0, 0],\r\n      directional: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: []\r\n      },\r\n      point: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        decays: []\r\n      },\r\n      spot: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        directions: [],\r\n        anglesCos: [],\r\n        exponents: [],\r\n        decays: []\r\n      },\r\n      hemi: {\r\n        length: 0,\r\n        skyColors: [],\r\n        groundColors: [],\r\n        positions: []\r\n      }\r\n\r\n    };\r\n\r\n  // initialize\r\n\r\n  var _gl;\r\n\r\n  try {\r\n\r\n    var attributes = {\r\n      alpha: _alpha,\r\n      depth: _depth,\r\n      stencil: _stencil,\r\n      antialias: _antialias,\r\n      premultipliedAlpha: _premultipliedAlpha,\r\n      preserveDrawingBuffer: _preserveDrawingBuffer\r\n    };\r\n\r\n    _gl = _context || _canvas.getContext('webgl', attributes) || _canvas.getContext('experimental-webgl', attributes);\r\n\r\n    if (_gl === null) {\r\n\r\n      if (_canvas.getContext('webgl') !== null) {\r\n\r\n        throw 'Error creating WebGL context with your selected attributes.';\r\n\r\n      }\r\n      else {\r\n\r\n        throw 'Error creating WebGL context.';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _canvas.addEventListener('webglcontextlost', function(event) {\r\n\r\n      event.preventDefault();\r\n\r\n      resetGLState();\r\n      setDefaultGLState();\r\n\r\n      _webglObjects = {};\r\n\r\n    }, false);\r\n\r\n  }\r\n  catch (error) {\r\n\r\n    THREE.error('THREE.WebGLRenderer: ' + error);\r\n\r\n  }\r\n\r\n  var state = new THREE.WebGLState(_gl, paramThreeToGL);\r\n\r\n  if (_gl.getShaderPrecisionFormat === undefined) {\r\n\r\n    _gl.getShaderPrecisionFormat = function() {\r\n\r\n      return {\r\n        'rangeMin': 1,\r\n        'rangeMax': 1,\r\n        'precision': 1\r\n      };\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var extensions = new THREE.WebGLExtensions(_gl);\r\n\r\n  extensions.get('OES_texture_float');\r\n  extensions.get('OES_texture_float_linear');\r\n  extensions.get('OES_texture_half_float');\r\n  extensions.get('OES_texture_half_float_linear');\r\n  extensions.get('OES_standard_derivatives');\r\n\r\n  if (_logarithmicDepthBuffer) {\r\n\r\n    extensions.get('EXT_frag_depth');\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var glClearColor = function(r, g, b, a) {\r\n\r\n    if (_premultipliedAlpha === true) {\r\n\r\n      r *= a;\r\n      g *= a;\r\n      b *= a;\r\n\r\n    }\r\n\r\n    _gl.clearColor(r, g, b, a);\r\n\r\n  };\r\n\r\n  var setDefaultGLState = function() {\r\n\r\n    _gl.clearColor(0, 0, 0, 1);\r\n    _gl.clearDepth(1);\r\n    _gl.clearStencil(0);\r\n\r\n    _gl.enable(_gl.DEPTH_TEST);\r\n    _gl.depthFunc(_gl.LEQUAL);\r\n\r\n    _gl.frontFace(_gl.CCW);\r\n    _gl.cullFace(_gl.BACK);\r\n    _gl.enable(_gl.CULL_FACE);\r\n\r\n    _gl.enable(_gl.BLEND);\r\n    _gl.blendEquation(_gl.FUNC_ADD);\r\n    _gl.blendFunc(_gl.SRC_ALPHA, _gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  var resetGLState = function() {\r\n\r\n    _currentProgram = null;\r\n    _currentCamera = null;\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n\r\n    _lightsNeedUpdate = true;\r\n\r\n    state.reset();\r\n\r\n  };\r\n\r\n  setDefaultGLState();\r\n\r\n  this.context = _gl;\r\n  this.state = state;\r\n\r\n  // GPU capabilities\r\n\r\n  var _maxTextures = _gl.getParameter(_gl.MAX_TEXTURE_IMAGE_UNITS);\r\n  var _maxVertexTextures = _gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n  var _maxTextureSize = _gl.getParameter(_gl.MAX_TEXTURE_SIZE);\r\n  var _maxCubemapSize = _gl.getParameter(_gl.MAX_CUBE_MAP_TEXTURE_SIZE);\r\n\r\n  var _supportsVertexTextures = _maxVertexTextures > 0;\r\n  var _supportsBoneTextures = _supportsVertexTextures && extensions.get('OES_texture_float');\r\n\r\n  //\r\n\r\n  var _vertexShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.HIGH_FLOAT);\r\n  var _vertexShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var _fragmentShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.HIGH_FLOAT);\r\n  var _fragmentShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var getCompressedTextureFormats = (function() {\r\n\r\n    var array;\r\n\r\n    return function() {\r\n\r\n      if (array !== undefined) {\r\n\r\n        return array;\r\n\r\n      }\r\n\r\n      array = [];\r\n\r\n      if (extensions.get('WEBGL_compressed_texture_pvrtc') || extensions.get('WEBGL_compressed_texture_s3tc')) {\r\n\r\n        var formats = _gl.getParameter(_gl.COMPRESSED_TEXTURE_FORMATS);\r\n\r\n        for (var i = 0; i < formats.length; i++) {\r\n\r\n          array.push(formats[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  })();\r\n\r\n  // clamp precision to maximum available\r\n\r\n  var highpAvailable = _vertexShaderPrecisionHighpFloat.precision > 0 && _fragmentShaderPrecisionHighpFloat.precision > 0;\r\n  var mediumpAvailable = _vertexShaderPrecisionMediumpFloat.precision > 0 && _fragmentShaderPrecisionMediumpFloat.precision > 0;\r\n\r\n  if (_precision === 'highp' && !highpAvailable) {\r\n\r\n    if (mediumpAvailable) {\r\n\r\n      _precision = 'mediump';\r\n      THREE.warn('THREE.WebGLRenderer: highp not supported, using mediump.');\r\n\r\n    }\r\n    else {\r\n\r\n      _precision = 'lowp';\r\n      THREE.warn('THREE.WebGLRenderer: highp and mediump not supported, using lowp.');\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if (_precision === 'mediump' && !mediumpAvailable) {\r\n\r\n    _precision = 'lowp';\r\n    THREE.warn('THREE.WebGLRenderer: mediump not supported, using lowp.');\r\n\r\n  }\r\n\r\n  // Plugins\r\n\r\n  var shadowMapPlugin = new THREE.ShadowMapPlugin(this, lights, _webglObjects, _webglObjectsImmediate);\r\n\r\n  var spritePlugin = new THREE.SpritePlugin(this, sprites);\r\n  var lensFlarePlugin = new THREE.LensFlarePlugin(this, lensFlares);\r\n\r\n  // API\r\n\r\n  this.getContext = function() {\r\n\r\n    return _gl;\r\n\r\n  };\r\n\r\n  this.forceContextLoss = function() {\r\n\r\n    extensions.get('WEBGL_lose_context').loseContext();\r\n\r\n  };\r\n\r\n  this.supportsVertexTextures = function() {\r\n\r\n    return _supportsVertexTextures;\r\n\r\n  };\r\n\r\n  this.supportsFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_float');\r\n\r\n  };\r\n\r\n  this.supportsHalfFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_half_float');\r\n\r\n  };\r\n\r\n  this.supportsStandardDerivatives = function() {\r\n\r\n    return extensions.get('OES_standard_derivatives');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTextureS3TC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTexturePVRTC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n  };\r\n\r\n  this.supportsBlendMinMax = function() {\r\n\r\n    return extensions.get('EXT_blend_minmax');\r\n\r\n  };\r\n\r\n  this.getMaxAnisotropy = (function() {\r\n\r\n    var value;\r\n\r\n    return function() {\r\n\r\n      if (value !== undefined) {\r\n\r\n        return value;\r\n\r\n      }\r\n\r\n      var extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n      value = extension !== null ? _gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\r\n\r\n      return value;\r\n\r\n    }\r\n\r\n  })();\r\n\r\n  this.getPrecision = function() {\r\n\r\n    return _precision;\r\n\r\n  };\r\n\r\n  this.getPixelRatio = function() {\r\n\r\n    return pixelRatio;\r\n\r\n  };\r\n\r\n  this.setPixelRatio = function(value) {\r\n\r\n    pixelRatio = value;\r\n\r\n  };\r\n\r\n  this.setSize = function(width, height, updateStyle) {\r\n\r\n    _canvas.width = width * pixelRatio;\r\n    _canvas.height = height * pixelRatio;\r\n\r\n    if (updateStyle !== false) {\r\n\r\n      _canvas.style.width = width + 'px';\r\n      _canvas.style.height = height + 'px';\r\n\r\n    }\r\n\r\n    this.setViewport(0, 0, width, height);\r\n\r\n  };\r\n\r\n  this.setViewport = function(x, y, width, height) {\r\n\r\n    _viewportX = x * pixelRatio;\r\n    _viewportY = y * pixelRatio;\r\n\r\n    _viewportWidth = width * pixelRatio;\r\n    _viewportHeight = height * pixelRatio;\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n  };\r\n\r\n  this.setScissor = function(x, y, width, height) {\r\n\r\n    _gl.scissor(\r\n      x * pixelRatio,\r\n      y * pixelRatio,\r\n      width * pixelRatio,\r\n      height * pixelRatio\r\n    );\r\n\r\n  };\r\n\r\n  this.enableScissorTest = function(enable) {\r\n\r\n    enable ? _gl.enable(_gl.SCISSOR_TEST) : _gl.disable(_gl.SCISSOR_TEST);\r\n\r\n  };\r\n\r\n  // Clearing\r\n\r\n  this.getClearColor = function() {\r\n\r\n    return _clearColor;\r\n\r\n  };\r\n\r\n  this.setClearColor = function(color, alpha) {\r\n\r\n    _clearColor.set(color);\r\n\r\n    _clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.getClearAlpha = function() {\r\n\r\n    return _clearAlpha;\r\n\r\n  };\r\n\r\n  this.setClearAlpha = function(alpha) {\r\n\r\n    _clearAlpha = alpha;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.clear = function(color, depth, stencil) {\r\n\r\n    var bits = 0;\r\n\r\n    if (color === undefined || color) bits |= _gl.COLOR_BUFFER_BIT;\r\n    if (depth === undefined || depth) bits |= _gl.DEPTH_BUFFER_BIT;\r\n    if (stencil === undefined || stencil) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n    _gl.clear(bits);\r\n\r\n  };\r\n\r\n  this.clearColor = function() {\r\n\r\n    _gl.clear(_gl.COLOR_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearDepth = function() {\r\n\r\n    _gl.clear(_gl.DEPTH_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearStencil = function() {\r\n\r\n    _gl.clear(_gl.STENCIL_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearTarget = function(renderTarget, color, depth, stencil) {\r\n\r\n    this.setRenderTarget(renderTarget);\r\n    this.clear(color, depth, stencil);\r\n\r\n  };\r\n\r\n  // Reset\r\n\r\n  this.resetGLState = resetGLState;\r\n\r\n  // Buffer allocation\r\n\r\n  function createParticleBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createLineBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n    geometry.__webglLineDistanceBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createMeshBuffers(geometryGroup) {\r\n\r\n    geometryGroup.__webglVertexBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglNormalBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglTangentBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglColorBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUVBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUV2Buffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglSkinIndicesBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglSkinWeightsBuffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglFaceBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglLineBuffer = _gl.createBuffer();\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__webglMorphTargetsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphTargetsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__webglMorphNormalsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphNormalsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  // Events\r\n\r\n  var onObjectRemoved = function(event) {\r\n\r\n    var object = event.target;\r\n\r\n    object.traverse(function(child) {\r\n\r\n      child.removeEventListener('remove', onObjectRemoved);\r\n\r\n      removeObject(child);\r\n\r\n    });\r\n\r\n  };\r\n\r\n  var onGeometryDispose = function(event) {\r\n\r\n    var geometry = event.target;\r\n\r\n    geometry.removeEventListener('dispose', onGeometryDispose);\r\n\r\n    deallocateGeometry(geometry);\r\n\r\n  };\r\n\r\n  var onTextureDispose = function(event) {\r\n\r\n    var texture = event.target;\r\n\r\n    texture.removeEventListener('dispose', onTextureDispose);\r\n\r\n    deallocateTexture(texture);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n\r\n  };\r\n\r\n  var onRenderTargetDispose = function(event) {\r\n\r\n    var renderTarget = event.target;\r\n\r\n    renderTarget.removeEventListener('dispose', onRenderTargetDispose);\r\n\r\n    deallocateRenderTarget(renderTarget);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n  };\r\n\r\n  var onMaterialDispose = function(event) {\r\n\r\n    var material = event.target;\r\n\r\n    material.removeEventListener('dispose', onMaterialDispose);\r\n\r\n    deallocateMaterial(material);\r\n\r\n  };\r\n\r\n  // Buffer deallocation\r\n\r\n  var deleteBuffers = function(geometry) {\r\n\r\n    var buffers = [\r\n      '__webglVertexBuffer',\r\n      '__webglNormalBuffer',\r\n      '__webglTangentBuffer',\r\n      '__webglColorBuffer',\r\n      '__webglUVBuffer',\r\n      '__webglUV2Buffer',\r\n\r\n      '__webglSkinIndicesBuffer',\r\n      '__webglSkinWeightsBuffer',\r\n\r\n      '__webglFaceBuffer',\r\n      '__webglLineBuffer',\r\n\r\n      '__webglLineDistanceBuffer'\r\n    ];\r\n\r\n    for (var i = 0, l = buffers.length; i < l; i++) {\r\n\r\n      var name = buffers[i];\r\n\r\n      if (geometry[name] !== undefined) {\r\n\r\n        _gl.deleteBuffer(geometry[name]);\r\n\r\n        delete geometry[name];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // custom attributes\r\n\r\n    if (geometry.__webglCustomAttributesList !== undefined) {\r\n\r\n      for (var name in geometry.__webglCustomAttributesList) {\r\n\r\n        _gl.deleteBuffer(geometry.__webglCustomAttributesList[name].buffer);\r\n\r\n      }\r\n\r\n      delete geometry.__webglCustomAttributesList;\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries--;\r\n\r\n  };\r\n\r\n  var deallocateGeometry = function(geometry) {\r\n\r\n    delete geometry.__webglInit;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      for (var name in geometry.attributes) {\r\n\r\n        var attribute = geometry.attributes[name];\r\n\r\n        if (attribute.buffer !== undefined) {\r\n\r\n          _gl.deleteBuffer(attribute.buffer);\r\n\r\n          delete attribute.buffer;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _this.info.memory.geometries--;\r\n\r\n    }\r\n    else {\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      if (geometryGroupsList !== undefined) {\r\n\r\n        for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n          var geometryGroup = geometryGroupsList[i];\r\n\r\n          if (geometryGroup.numMorphTargets !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphTargets; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphTargetsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphTargetsBuffers;\r\n\r\n          }\r\n\r\n          if (geometryGroup.numMorphNormals !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphNormals; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphNormalsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphNormalsBuffers;\r\n\r\n          }\r\n\r\n          deleteBuffers(geometryGroup);\r\n\r\n        }\r\n\r\n        delete geometryGroups[geometry.id];\r\n\r\n      }\r\n      else {\r\n\r\n        deleteBuffers(geometry);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // TOFIX: Workaround for deleted geometry being currently bound\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n  };\r\n\r\n  var deallocateTexture = function(texture) {\r\n\r\n    if (texture.image && texture.image.__webglTextureCube) {\r\n\r\n      // cube texture\r\n\r\n      _gl.deleteTexture(texture.image.__webglTextureCube);\r\n\r\n      delete texture.image.__webglTextureCube;\r\n\r\n    }\r\n    else {\r\n\r\n      // 2D texture\r\n\r\n      if (texture.__webglInit === undefined) return;\r\n\r\n      _gl.deleteTexture(texture.__webglTexture);\r\n\r\n      delete texture.__webglTexture;\r\n      delete texture.__webglInit;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  var deallocateRenderTarget = function(renderTarget) {\r\n\r\n    if (!renderTarget || renderTarget.__webglTexture === undefined) return;\r\n\r\n    _gl.deleteTexture(renderTarget.__webglTexture);\r\n\r\n    delete renderTarget.__webglTexture;\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        _gl.deleteFramebuffer(renderTarget.__webglFramebuffer[i]);\r\n        _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer[i]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.deleteFramebuffer(renderTarget.__webglFramebuffer);\r\n      _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer);\r\n\r\n    }\r\n\r\n    delete renderTarget.__webglFramebuffer;\r\n    delete renderTarget.__webglRenderbuffer;\r\n\r\n  };\r\n\r\n  var deallocateMaterial = function(material) {\r\n\r\n    var program = material.program.program;\r\n\r\n    if (program === undefined) return;\r\n\r\n    material.program = undefined;\r\n\r\n    // only deallocate GL program if this was the last use of shared program\r\n    // assumed there is only single copy of any program in the _programs list\r\n    // (that's how it's constructed)\r\n\r\n    var i, il, programInfo;\r\n    var deleteProgram = false;\r\n\r\n    for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n      programInfo = _programs[i];\r\n\r\n      if (programInfo.program === program) {\r\n\r\n        programInfo.usedTimes--;\r\n\r\n        if (programInfo.usedTimes === 0) {\r\n\r\n          deleteProgram = true;\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (deleteProgram === true) {\r\n\r\n      // avoid using array.splice, this is costlier than creating new array from scratch\r\n\r\n      var newPrograms = [];\r\n\r\n      for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n        programInfo = _programs[i];\r\n\r\n        if (programInfo.program !== program) {\r\n\r\n          newPrograms.push(programInfo);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _programs = newPrograms;\r\n\r\n      _gl.deleteProgram(program);\r\n\r\n      _this.info.memory.programs--;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer initialization\r\n\r\n  function initCustomAttributes(object) {\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometry.__webglCustomAttributesList === undefined) {\r\n\r\n        geometry.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        var attribute = material.attributes[name];\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          attribute.needsUpdate = true;\r\n\r\n        }\r\n\r\n        geometry.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function initParticleBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n\r\n    geometry.__webglParticleCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initLineBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n    geometry.__lineDistanceArray = new Float32Array(nvertices * 1);\r\n\r\n    geometry.__webglLineCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initMeshBuffers(geometryGroup, object) {\r\n\r\n    var geometry = object.geometry,\r\n      faces3 = geometryGroup.faces3,\r\n\r\n      nvertices = faces3.length * 3,\r\n      ntris = faces3.length * 1,\r\n      nlines = faces3.length * 3,\r\n\r\n      material = getBufferMaterial(object, geometryGroup);\r\n\r\n    geometryGroup.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__normalArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__colorArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__uvArray = new Float32Array(nvertices * 2);\r\n\r\n    if (geometry.faceVertexUvs.length > 1) {\r\n\r\n      geometryGroup.__uv2Array = new Float32Array(nvertices * 2);\r\n\r\n    }\r\n\r\n    if (geometry.hasTangents) {\r\n\r\n      geometryGroup.__tangentArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    if (object.geometry.skinWeights.length && object.geometry.skinIndices.length) {\r\n\r\n      geometryGroup.__skinIndexArray = new Float32Array(nvertices * 4);\r\n      geometryGroup.__skinWeightArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    var UintArray = extensions.get('OES_element_index_uint') !== null && ntris > 21845 ? Uint32Array : Uint16Array; // 65535 / 3\r\n\r\n    geometryGroup.__typeArray = UintArray;\r\n    geometryGroup.__faceArray = new UintArray(ntris * 3);\r\n    geometryGroup.__lineArray = new UintArray(nlines * 2);\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__morphTargetsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__morphTargetsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__morphNormalsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__morphNormalsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__webglFaceCount = ntris * 3;\r\n    geometryGroup.__webglLineCount = nlines * 2;\r\n\r\n\r\n    // custom attributes\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometryGroup.__webglCustomAttributesList === undefined) {\r\n\r\n        geometryGroup.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        // Do a shallow copy of the attribute object so different geometryGroup chunks use different\r\n        // attribute buffers which are correctly indexed in the setMeshBuffers function\r\n\r\n        var originalAttribute = material.attributes[name];\r\n\r\n        var attribute = {};\r\n\r\n        for (var property in originalAttribute) {\r\n\r\n          attribute[property] = originalAttribute[property];\r\n\r\n        }\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          originalAttribute.needsUpdate = true;\r\n          attribute.__original = originalAttribute;\r\n\r\n        }\r\n\r\n        geometryGroup.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__inittedArrays = true;\r\n\r\n  };\r\n\r\n  function getBufferMaterial(object, geometryGroup) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[geometryGroup.materialIndex] : object.material;\r\n\r\n  }\r\n\r\n  function materialNeedsFaceNormals(material) {\r\n\r\n    return material instanceof THREE.MeshPhongMaterial === false && material.shading === THREE.FlatShading;\r\n\r\n  }\r\n\r\n  // Buffer setting\r\n\r\n  function setParticleBuffers(geometry, hint, object) {\r\n\r\n    var v, c, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      vl = vertices.length,\r\n\r\n      colors = geometry.colors,\r\n      cl = colors.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          offset = 0;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n        customAttribute.needsUpdate = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setLineBuffers(geometry, hint) {\r\n\r\n    var v, c, d, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      colors = geometry.colors,\r\n      lineDistances = geometry.lineDistances,\r\n\r\n      vl = vertices.length,\r\n      cl = colors.length,\r\n      dl = lineDistances.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n      lineDistanceArray = geometry.__lineDistanceArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyLineDistances = geometry.lineDistancesNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyLineDistances) {\r\n\r\n      for (d = 0; d < dl; d++) {\r\n\r\n        lineDistanceArray[d] = lineDistances[d];\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglLineDistanceBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, lineDistanceArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          offset = 0;\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n          customAttribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMeshBuffers(geometryGroup, object, hint, dispose, material) {\r\n\r\n    if (!geometryGroup.__inittedArrays) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    var needsFaceNormals = materialNeedsFaceNormals(material);\r\n\r\n    var f, fl, fi, face,\r\n      vertexNormals, faceNormal,\r\n      vertexColors, faceColor,\r\n      vertexTangents,\r\n      uv, uv2, v1, v2, v3, t1, t2, t3, n1, n2, n3,\r\n      c1, c2, c3,\r\n      sw1, sw2, sw3,\r\n      si1, si2, si3,\r\n      i, il,\r\n      vn, uvi, uv2i,\r\n      vk, vkl, vka,\r\n      nka, chf, faceVertexNormals,\r\n\r\n      vertexIndex = 0,\r\n\r\n      offset = 0,\r\n      offset_uv = 0,\r\n      offset_uv2 = 0,\r\n      offset_face = 0,\r\n      offset_normal = 0,\r\n      offset_tangent = 0,\r\n      offset_line = 0,\r\n      offset_color = 0,\r\n      offset_skin = 0,\r\n      offset_morphTarget = 0,\r\n      offset_custom = 0,\r\n\r\n      value,\r\n\r\n      vertexArray = geometryGroup.__vertexArray,\r\n      uvArray = geometryGroup.__uvArray,\r\n      uv2Array = geometryGroup.__uv2Array,\r\n      normalArray = geometryGroup.__normalArray,\r\n      tangentArray = geometryGroup.__tangentArray,\r\n      colorArray = geometryGroup.__colorArray,\r\n\r\n      skinIndexArray = geometryGroup.__skinIndexArray,\r\n      skinWeightArray = geometryGroup.__skinWeightArray,\r\n\r\n      morphTargetsArrays = geometryGroup.__morphTargetsArrays,\r\n      morphNormalsArrays = geometryGroup.__morphNormalsArrays,\r\n\r\n      customAttributes = geometryGroup.__webglCustomAttributesList,\r\n      customAttribute,\r\n\r\n      faceArray = geometryGroup.__faceArray,\r\n      lineArray = geometryGroup.__lineArray,\r\n\r\n      geometry = object.geometry, // this is shared for all chunks\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyElements = geometry.elementsNeedUpdate,\r\n      dirtyUvs = geometry.uvsNeedUpdate,\r\n      dirtyNormals = geometry.normalsNeedUpdate,\r\n      dirtyTangents = geometry.tangentsNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyMorphTargets = geometry.morphTargetsNeedUpdate,\r\n\r\n      vertices = geometry.vertices,\r\n      chunk_faces3 = geometryGroup.faces3,\r\n      obj_faces = geometry.faces,\r\n\r\n      obj_uvs = geometry.faceVertexUvs[0],\r\n      obj_uvs2 = geometry.faceVertexUvs[1],\r\n\r\n      obj_skinIndices = geometry.skinIndices,\r\n      obj_skinWeights = geometry.skinWeights,\r\n\r\n      morphTargets = geometry.morphTargets,\r\n      morphNormals = geometry.morphNormals;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        v1 = vertices[face.a];\r\n        v2 = vertices[face.b];\r\n        v3 = vertices[face.c];\r\n\r\n        vertexArray[offset] = v1.x;\r\n        vertexArray[offset + 1] = v1.y;\r\n        vertexArray[offset + 2] = v1.z;\r\n\r\n        vertexArray[offset + 3] = v2.x;\r\n        vertexArray[offset + 4] = v2.y;\r\n        vertexArray[offset + 5] = v2.z;\r\n\r\n        vertexArray[offset + 6] = v3.x;\r\n        vertexArray[offset + 7] = v3.y;\r\n        vertexArray[offset + 8] = v3.z;\r\n\r\n        offset += 9;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyMorphTargets) {\r\n\r\n      for (vk = 0, vkl = morphTargets.length; vk < vkl; vk++) {\r\n\r\n        offset_morphTarget = 0;\r\n\r\n        for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n          chf = chunk_faces3[f];\r\n          face = obj_faces[chf];\r\n\r\n          // morph positions\r\n\r\n          v1 = morphTargets[vk].vertices[face.a];\r\n          v2 = morphTargets[vk].vertices[face.b];\r\n          v3 = morphTargets[vk].vertices[face.c];\r\n\r\n          vka = morphTargetsArrays[vk];\r\n\r\n          vka[offset_morphTarget] = v1.x;\r\n          vka[offset_morphTarget + 1] = v1.y;\r\n          vka[offset_morphTarget + 2] = v1.z;\r\n\r\n          vka[offset_morphTarget + 3] = v2.x;\r\n          vka[offset_morphTarget + 4] = v2.y;\r\n          vka[offset_morphTarget + 5] = v2.z;\r\n\r\n          vka[offset_morphTarget + 6] = v3.x;\r\n          vka[offset_morphTarget + 7] = v3.y;\r\n          vka[offset_morphTarget + 8] = v3.z;\r\n\r\n          // morph normals\r\n\r\n          if (material.morphNormals) {\r\n\r\n            if (needsFaceNormals) {\r\n\r\n              n1 = morphNormals[vk].faceNormals[chf];\r\n              n2 = n1;\r\n              n3 = n1;\r\n\r\n            }\r\n            else {\r\n\r\n              faceVertexNormals = morphNormals[vk].vertexNormals[chf];\r\n\r\n              n1 = faceVertexNormals.a;\r\n              n2 = faceVertexNormals.b;\r\n              n3 = faceVertexNormals.c;\r\n\r\n            }\r\n\r\n            nka = morphNormalsArrays[vk];\r\n\r\n            nka[offset_morphTarget] = n1.x;\r\n            nka[offset_morphTarget + 1] = n1.y;\r\n            nka[offset_morphTarget + 2] = n1.z;\r\n\r\n            nka[offset_morphTarget + 3] = n2.x;\r\n            nka[offset_morphTarget + 4] = n2.y;\r\n            nka[offset_morphTarget + 5] = n2.z;\r\n\r\n            nka[offset_morphTarget + 6] = n3.x;\r\n            nka[offset_morphTarget + 7] = n3.y;\r\n            nka[offset_morphTarget + 8] = n3.z;\r\n\r\n          }\r\n\r\n          //\r\n\r\n          offset_morphTarget += 9;\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[vk]);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, morphTargetsArrays[vk], hint);\r\n\r\n        if (material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[vk]);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, morphNormalsArrays[vk], hint);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (obj_skinWeights.length) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        // weights\r\n\r\n        sw1 = obj_skinWeights[face.a];\r\n        sw2 = obj_skinWeights[face.b];\r\n        sw3 = obj_skinWeights[face.c];\r\n\r\n        skinWeightArray[offset_skin] = sw1.x;\r\n        skinWeightArray[offset_skin + 1] = sw1.y;\r\n        skinWeightArray[offset_skin + 2] = sw1.z;\r\n        skinWeightArray[offset_skin + 3] = sw1.w;\r\n\r\n        skinWeightArray[offset_skin + 4] = sw2.x;\r\n        skinWeightArray[offset_skin + 5] = sw2.y;\r\n        skinWeightArray[offset_skin + 6] = sw2.z;\r\n        skinWeightArray[offset_skin + 7] = sw2.w;\r\n\r\n        skinWeightArray[offset_skin + 8] = sw3.x;\r\n        skinWeightArray[offset_skin + 9] = sw3.y;\r\n        skinWeightArray[offset_skin + 10] = sw3.z;\r\n        skinWeightArray[offset_skin + 11] = sw3.w;\r\n\r\n        // indices\r\n\r\n        si1 = obj_skinIndices[face.a];\r\n        si2 = obj_skinIndices[face.b];\r\n        si3 = obj_skinIndices[face.c];\r\n\r\n        skinIndexArray[offset_skin] = si1.x;\r\n        skinIndexArray[offset_skin + 1] = si1.y;\r\n        skinIndexArray[offset_skin + 2] = si1.z;\r\n        skinIndexArray[offset_skin + 3] = si1.w;\r\n\r\n        skinIndexArray[offset_skin + 4] = si2.x;\r\n        skinIndexArray[offset_skin + 5] = si2.y;\r\n        skinIndexArray[offset_skin + 6] = si2.z;\r\n        skinIndexArray[offset_skin + 7] = si2.w;\r\n\r\n        skinIndexArray[offset_skin + 8] = si3.x;\r\n        skinIndexArray[offset_skin + 9] = si3.y;\r\n        skinIndexArray[offset_skin + 10] = si3.z;\r\n        skinIndexArray[offset_skin + 11] = si3.w;\r\n\r\n        offset_skin += 12;\r\n\r\n      }\r\n\r\n      if (offset_skin > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinIndexArray, hint);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinWeightArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexColors = face.vertexColors;\r\n        faceColor = face.color;\r\n\r\n        if (vertexColors.length === 3 && material.vertexColors === THREE.VertexColors) {\r\n\r\n          c1 = vertexColors[0];\r\n          c2 = vertexColors[1];\r\n          c3 = vertexColors[2];\r\n\r\n        }\r\n        else {\r\n\r\n          c1 = faceColor;\r\n          c2 = faceColor;\r\n          c3 = faceColor;\r\n\r\n        }\r\n\r\n        colorArray[offset_color] = c1.r;\r\n        colorArray[offset_color + 1] = c1.g;\r\n        colorArray[offset_color + 2] = c1.b;\r\n\r\n        colorArray[offset_color + 3] = c2.r;\r\n        colorArray[offset_color + 4] = c2.g;\r\n        colorArray[offset_color + 5] = c2.b;\r\n\r\n        colorArray[offset_color + 6] = c3.r;\r\n        colorArray[offset_color + 7] = c3.g;\r\n        colorArray[offset_color + 8] = c3.b;\r\n\r\n        offset_color += 9;\r\n\r\n      }\r\n\r\n      if (offset_color > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyTangents && geometry.hasTangents) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexTangents = face.vertexTangents;\r\n\r\n        t1 = vertexTangents[0];\r\n        t2 = vertexTangents[1];\r\n        t3 = vertexTangents[2];\r\n\r\n        tangentArray[offset_tangent] = t1.x;\r\n        tangentArray[offset_tangent + 1] = t1.y;\r\n        tangentArray[offset_tangent + 2] = t1.z;\r\n        tangentArray[offset_tangent + 3] = t1.w;\r\n\r\n        tangentArray[offset_tangent + 4] = t2.x;\r\n        tangentArray[offset_tangent + 5] = t2.y;\r\n        tangentArray[offset_tangent + 6] = t2.z;\r\n        tangentArray[offset_tangent + 7] = t2.w;\r\n\r\n        tangentArray[offset_tangent + 8] = t3.x;\r\n        tangentArray[offset_tangent + 9] = t3.y;\r\n        tangentArray[offset_tangent + 10] = t3.z;\r\n        tangentArray[offset_tangent + 11] = t3.w;\r\n\r\n        offset_tangent += 12;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, tangentArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyNormals) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexNormals = face.vertexNormals;\r\n        faceNormal = face.normal;\r\n\r\n        if (vertexNormals.length === 3 && needsFaceNormals === false) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            vn = vertexNormals[i];\r\n\r\n            normalArray[offset_normal] = vn.x;\r\n            normalArray[offset_normal + 1] = vn.y;\r\n            normalArray[offset_normal + 2] = vn.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalArray[offset_normal] = faceNormal.x;\r\n            normalArray[offset_normal + 1] = faceNormal.y;\r\n            normalArray[offset_normal + 2] = faceNormal.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, normalArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv = obj_uvs[fi];\r\n\r\n        if (uv === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uvi = uv[i];\r\n\r\n          uvArray[offset_uv] = uvi.x;\r\n          uvArray[offset_uv + 1] = uvi.y;\r\n\r\n          offset_uv += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uvArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs2) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv2 = obj_uvs2[fi];\r\n\r\n        if (uv2 === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uv2i = uv2[i];\r\n\r\n          uv2Array[offset_uv2] = uv2i.x;\r\n          uv2Array[offset_uv2 + 1] = uv2i.y;\r\n\r\n          offset_uv2 += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv2 > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uv2Array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyElements) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        faceArray[offset_face] = vertexIndex;\r\n        faceArray[offset_face + 1] = vertexIndex + 1;\r\n        faceArray[offset_face + 2] = vertexIndex + 2;\r\n\r\n        offset_face += 3;\r\n\r\n        lineArray[offset_line] = vertexIndex;\r\n        lineArray[offset_line + 1] = vertexIndex + 1;\r\n\r\n        lineArray[offset_line + 2] = vertexIndex;\r\n        lineArray[offset_line + 3] = vertexIndex + 2;\r\n\r\n        lineArray[offset_line + 4] = vertexIndex + 1;\r\n        lineArray[offset_line + 5] = vertexIndex + 2;\r\n\r\n        offset_line += 6;\r\n\r\n        vertexIndex += 3;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, faceArray, hint);\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, lineArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (!customAttribute.__original.needsUpdate) continue;\r\n\r\n        offset_custom = 0;\r\n\r\n        if (customAttribute.size === 1) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = customAttribute.value[face.a];\r\n              customAttribute.array[offset_custom + 1] = customAttribute.value[face.b];\r\n              customAttribute.array[offset_custom + 2] = customAttribute.value[face.c];\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = value;\r\n              customAttribute.array[offset_custom + 1] = value;\r\n              customAttribute.array[offset_custom + 2] = value;\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 2) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 3) {\r\n\r\n          var pp;\r\n\r\n          if (customAttribute.type === 'c') {\r\n\r\n            pp = ['r', 'g', 'b'];\r\n\r\n          }\r\n          else {\r\n\r\n            pp = ['x', 'y', 'z'];\r\n\r\n          }\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 4) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dispose) {\r\n\r\n      delete geometryGroup.__inittedArrays;\r\n      delete geometryGroup.__colorArray;\r\n      delete geometryGroup.__normalArray;\r\n      delete geometryGroup.__tangentArray;\r\n      delete geometryGroup.__uvArray;\r\n      delete geometryGroup.__uv2Array;\r\n      delete geometryGroup.__faceArray;\r\n      delete geometryGroup.__vertexArray;\r\n      delete geometryGroup.__lineArray;\r\n      delete geometryGroup.__skinIndexArray;\r\n      delete geometryGroup.__skinWeightArray;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer rendering\r\n\r\n  this.renderBufferImmediate = function(object, program, material) {\r\n\r\n    state.initAttributes();\r\n\r\n    if (object.hasPositions && !object.__webglVertexBuffer) object.__webglVertexBuffer = _gl.createBuffer();\r\n    if (object.hasNormals && !object.__webglNormalBuffer) object.__webglNormalBuffer = _gl.createBuffer();\r\n    if (object.hasUvs && !object.__webglUvBuffer) object.__webglUvBuffer = _gl.createBuffer();\r\n    if (object.hasColors && !object.__webglColorBuffer) object.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    if (object.hasPositions) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.position);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasNormals) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglNormalBuffer);\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial === false &&\r\n        material.shading === THREE.FlatShading) {\r\n\r\n        var nx, ny, nz,\r\n          nax, nbx, ncx, nay, nby, ncy, naz, nbz, ncz,\r\n          normalArray,\r\n          i, il = object.count * 3;\r\n\r\n        for (i = 0; i < il; i += 9) {\r\n\r\n          normalArray = object.normalArray;\r\n\r\n          nax = normalArray[i];\r\n          nay = normalArray[i + 1];\r\n          naz = normalArray[i + 2];\r\n\r\n          nbx = normalArray[i + 3];\r\n          nby = normalArray[i + 4];\r\n          nbz = normalArray[i + 5];\r\n\r\n          ncx = normalArray[i + 6];\r\n          ncy = normalArray[i + 7];\r\n          ncz = normalArray[i + 8];\r\n\r\n          nx = (nax + nbx + ncx) / 3;\r\n          ny = (nay + nby + ncy) / 3;\r\n          nz = (naz + nbz + ncz) / 3;\r\n\r\n          normalArray[i] = nx;\r\n          normalArray[i + 1] = ny;\r\n          normalArray[i + 2] = nz;\r\n\r\n          normalArray[i + 3] = nx;\r\n          normalArray[i + 4] = ny;\r\n          normalArray[i + 5] = nz;\r\n\r\n          normalArray[i + 6] = nx;\r\n          normalArray[i + 7] = ny;\r\n          normalArray[i + 8] = nz;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.normal);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasUvs && material.map) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglUvBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.uv);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasColors && material.vertexColors !== THREE.NoColors) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.color);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    _gl.drawArrays(_gl.TRIANGLES, 0, object.count);\r\n\r\n    object.count = 0;\r\n\r\n  };\r\n\r\n  function setupVertexAttributes(material, program, geometry, startIndex) {\r\n\r\n    var geometryAttributes = geometry.attributes;\r\n\r\n    var programAttributes = program.attributes;\r\n    var programAttributesKeys = program.attributesKeys;\r\n\r\n    for (var i = 0, l = programAttributesKeys.length; i < l; i++) {\r\n\r\n      var key = programAttributesKeys[i];\r\n      var programAttribute = programAttributes[key];\r\n\r\n      if (programAttribute >= 0) {\r\n\r\n        var geometryAttribute = geometryAttributes[key];\r\n\r\n        if (geometryAttribute !== undefined) {\r\n\r\n          var size = geometryAttribute.itemSize;\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryAttribute.buffer);\r\n\r\n          state.enableAttribute(programAttribute);\r\n\r\n          _gl.vertexAttribPointer(programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4); // 4 bytes per Float32\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n          if (material.defaultAttributeValues[key].length === 2) {\r\n\r\n            _gl.vertexAttrib2fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n          else if (material.defaultAttributeValues[key].length === 3) {\r\n\r\n            _gl.vertexAttrib3fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n  }\r\n\r\n  this.renderBufferDirect = function(camera, lights, fog, material, geometry, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = 'direct_' + geometry.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var mode = material.wireframe === true ? _gl.LINES : _gl.TRIANGLES;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed triangles\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n          _this.info.render.faces += index.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed triangles\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n            _this.info.render.faces += offsets[i].count / 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed triangles\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes['position'];\r\n\r\n        // render non-indexed triangles\r\n\r\n        _gl.drawArrays(mode, 0, position.array.length / position.itemSize);\r\n\r\n        _this.info.render.calls++;\r\n        _this.info.render.vertices += position.array.length / position.itemSize;\r\n        _this.info.render.faces += position.array.length / (3 * position.itemSize);\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      // render particles\r\n\r\n      var mode = _gl.POINTS;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed points\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += index.array.length;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed points\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed points\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed lines\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0); // 2 bytes per Uint16Array\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed lines\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size); // 2 bytes per Uint16Array\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed lines\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.renderBuffer = function(camera, lights, fog, material, geometryGroup, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var attributes = program.attributes;\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = geometryGroup.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    if (!material.morphTargets && attributes.position >= 0) {\r\n\r\n      if (updateBuffers) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n        state.enableAttribute(attributes.position);\r\n\r\n        _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      if (object.morphTargetBase) {\r\n\r\n        setupMorphTargets(material, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n    if (updateBuffers) {\r\n\r\n      // custom attributes\r\n\r\n      // Use the per-geometryGroup custom attribute arrays which are setup in initMeshBuffers\r\n\r\n      if (geometryGroup.__webglCustomAttributesList) {\r\n\r\n        for (var i = 0, il = geometryGroup.__webglCustomAttributesList.length; i < il; i++) {\r\n\r\n          var attribute = geometryGroup.__webglCustomAttributesList[i];\r\n\r\n          if (attributes[attribute.buffer.belongsToAttribute] >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, attribute.buffer);\r\n\r\n            state.enableAttribute(attributes[attribute.buffer.belongsToAttribute]);\r\n\r\n            _gl.vertexAttribPointer(attributes[attribute.buffer.belongsToAttribute], attribute.size, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // colors\r\n\r\n      if (attributes.color >= 0) {\r\n\r\n        if (object.geometry.colors.length > 0 || object.geometry.faces.length > 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n\r\n          state.enableAttribute(attributes.color);\r\n\r\n          _gl.vertexAttribPointer(attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib3fv(attributes.color, material.defaultAttributeValues.color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // normals\r\n\r\n      if (attributes.normal >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n\r\n        state.enableAttribute(attributes.normal);\r\n\r\n        _gl.vertexAttribPointer(attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // tangents\r\n\r\n      if (attributes.tangent >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n\r\n        state.enableAttribute(attributes.tangent);\r\n\r\n        _gl.vertexAttribPointer(attributes.tangent, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // uvs\r\n\r\n      if (attributes.uv >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[0]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n\r\n          state.enableAttribute(attributes.uv);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv, material.defaultAttributeValues.uv);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (attributes.uv2 >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[1]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n\r\n          state.enableAttribute(attributes.uv2);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv2, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv2, material.defaultAttributeValues.uv2);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material.skinning &&\r\n        attributes.skinIndex >= 0 && attributes.skinWeight >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n\r\n        state.enableAttribute(attributes.skinIndex);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinIndex, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n\r\n        state.enableAttribute(attributes.skinWeight);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinWeight, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // line distances\r\n\r\n      if (attributes.lineDistance >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglLineDistanceBuffer);\r\n\r\n        state.enableAttribute(attributes.lineDistance);\r\n\r\n        _gl.vertexAttribPointer(attributes.lineDistance, 1, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var type = geometryGroup.__typeArray === Uint32Array ? _gl.UNSIGNED_INT : _gl.UNSIGNED_SHORT;\r\n\r\n      // wireframe\r\n\r\n      if (material.wireframe) {\r\n\r\n        state.setLineWidth(material.wireframeLinewidth * pixelRatio);\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n        _gl.drawElements(_gl.LINES, geometryGroup.__webglLineCount, type, 0);\r\n\r\n        // triangles\r\n\r\n      }\r\n      else {\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n        _gl.drawElements(_gl.TRIANGLES, geometryGroup.__webglFaceCount, type, 0);\r\n\r\n      }\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.vertices += geometryGroup.__webglFaceCount;\r\n      _this.info.render.faces += geometryGroup.__webglFaceCount / 3;\r\n\r\n      // render lines\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      _gl.drawArrays(mode, 0, geometryGroup.__webglLineCount);\r\n\r\n      _this.info.render.calls++;\r\n\r\n      // render particles\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      _gl.drawArrays(_gl.POINTS, 0, geometryGroup.__webglParticleCount);\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.points += geometryGroup.__webglParticleCount;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function setupMorphTargets(material, geometryGroup, object) {\r\n\r\n    // set base\r\n\r\n    var attributes = material.program.attributes;\r\n\r\n    if (object.morphTargetBase !== -1 && attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[object.morphTargetBase]);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n    else if (attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.morphTargetForcedOrder.length) {\r\n\r\n      // set forced order\r\n\r\n      var m = 0;\r\n      var order = object.morphTargetForcedOrder;\r\n      var influences = object.morphTargetInfluences;\r\n\r\n      var attribute;\r\n\r\n      while (m < material.numSupportedMorphTargets && m < order.length) {\r\n\r\n        attribute = attributes['morphTarget' + m];\r\n\r\n        if (attribute >= 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        attribute = attributes['morphNormal' + m];\r\n\r\n        if (attribute >= 0 && material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        object.__webglMorphTargetInfluences[m] = influences[order[m]];\r\n\r\n        m++;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // find the most influencing\r\n\r\n      var activeInfluenceIndices = [];\r\n      var influences = object.morphTargetInfluences;\r\n      var morphTargets = object.geometry.morphTargets;\r\n\r\n      if (influences.length > morphTargets.length) {\r\n\r\n        console.warn('THREE.WebGLRenderer: Influences array is bigger than morphTargets array.');\r\n        influences.length = morphTargets.length;\r\n\r\n      }\r\n\r\n      for (var i = 0, il = influences.length; i < il; i++) {\r\n\r\n        var influence = influences[i];\r\n\r\n        activeInfluenceIndices.push([influence, i]);\r\n\r\n      }\r\n\r\n      if (activeInfluenceIndices.length > material.numSupportedMorphTargets) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n        activeInfluenceIndices.length = material.numSupportedMorphTargets;\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length > material.numSupportedMorphNormals) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length === 0) {\r\n\r\n        activeInfluenceIndices.push([0, 0]);\r\n\r\n      }\r\n\r\n      var attribute;\r\n\r\n      for (var m = 0, ml = material.numSupportedMorphTargets; m < ml; m++) {\r\n\r\n        if (activeInfluenceIndices[m]) {\r\n\r\n          var influenceIndex = activeInfluenceIndices[m][1];\r\n\r\n          attribute = attributes['morphTarget' + m];\r\n\r\n          if (attribute >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          attribute = attributes['morphNormal' + m];\r\n\r\n          if (attribute >= 0 && material.morphNormals) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          object.__webglMorphTargetInfluences[m] = influences[influenceIndex];\r\n\r\n        }\r\n        else {\r\n\r\n          /*\r\n          _gl.vertexAttribPointer( attributes[ \"morphTarget\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          if ( material.morphNormals ) {\r\n\r\n          \t_gl.vertexAttribPointer( attributes[ \"morphNormal\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          }\r\n          */\r\n\r\n          object.__webglMorphTargetInfluences[m] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // load updated influences uniform\r\n\r\n    if (material.program.uniforms.morphTargetInfluences !== null) {\r\n\r\n      _gl.uniform1fv(material.program.uniforms.morphTargetInfluences, object.__webglMorphTargetInfluences);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Sorting\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    else if (a.material.id !== b.material.id) {\r\n\r\n      return a.material.id - b.material.id;\r\n\r\n    }\r\n    else if (a.z !== b.z) {\r\n\r\n      return a.z - b.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function reversePainterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function numericalSort(a, b) {\r\n\r\n    return b[0] - a[0];\r\n\r\n  }\r\n\r\n  // Rendering\r\n\r\n  this.render = function(scene, camera, renderTarget, forceClear) {\r\n\r\n    if (camera instanceof THREE.Camera === false) {\r\n\r\n      THREE.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');\r\n      return;\r\n\r\n    }\r\n\r\n    var fog = scene.fog;\r\n\r\n    // reset caching for this frame\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n    _currentCamera = null;\r\n    _lightsNeedUpdate = true;\r\n\r\n    // update scene graph\r\n\r\n    if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n    // update camera matrices and frustum\r\n\r\n    if (camera.parent === undefined) camera.updateMatrixWorld();\r\n\r\n    // update Skeleton objects\r\n\r\n    scene.traverse(function(object) {\r\n\r\n      if (object instanceof THREE.SkinnedMesh) {\r\n\r\n        object.skeleton.update();\r\n\r\n      }\r\n\r\n    });\r\n\r\n    camera.matrixWorldInverse.getInverse(camera.matrixWorld);\r\n\r\n    _projScreenMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\r\n    _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n    lights.length = 0;\r\n    opaqueObjects.length = 0;\r\n    transparentObjects.length = 0;\r\n\r\n    sprites.length = 0;\r\n    lensFlares.length = 0;\r\n\r\n    projectObject(scene);\r\n\r\n    if (_this.sortObjects === true) {\r\n\r\n      opaqueObjects.sort(painterSortStable);\r\n      transparentObjects.sort(reversePainterSortStable);\r\n\r\n    }\r\n\r\n    // custom render plugins (pre pass)\r\n\r\n    shadowMapPlugin.render(scene, camera);\r\n\r\n    //\r\n\r\n    _this.info.render.calls = 0;\r\n    _this.info.render.vertices = 0;\r\n    _this.info.render.faces = 0;\r\n    _this.info.render.points = 0;\r\n\r\n    this.setRenderTarget(renderTarget);\r\n\r\n    if (this.autoClear || forceClear) {\r\n\r\n      this.clear(this.autoClearColor, this.autoClearDepth, this.autoClearStencil);\r\n\r\n    }\r\n\r\n    // set matrices for immediate objects\r\n\r\n    for (var i = 0, il = _webglObjectsImmediate.length; i < il; i++) {\r\n\r\n      var webglObject = _webglObjectsImmediate[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        setupMatrices(object, camera);\r\n\r\n        unrollImmediateBufferMaterial(webglObject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (scene.overrideMaterial) {\r\n\r\n      var overrideMaterial = scene.overrideMaterial;\r\n\r\n      setMaterial(overrideMaterial);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjects(transparentObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjectsImmediate(_webglObjectsImmediate, '', camera, lights, fog, overrideMaterial);\r\n\r\n    }\r\n    else {\r\n\r\n      // opaque pass (front-to-back order)\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'opaque', camera, lights, fog, null);\r\n\r\n      // transparent pass (back-to-front order)\r\n\r\n      renderObjects(transparentObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'transparent', camera, lights, fog, null);\r\n\r\n    }\r\n\r\n    // custom render plugins (post pass)\r\n\r\n    spritePlugin.render(scene, camera);\r\n    lensFlarePlugin.render(scene, camera, _currentWidth, _currentHeight);\r\n\r\n    // Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n    if (renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter) {\r\n\r\n      updateRenderTargetMipmap(renderTarget);\r\n\r\n    }\r\n\r\n    // Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n    state.setDepthTest(true);\r\n    state.setDepthWrite(true);\r\n    state.setColorWrite(true);\r\n\r\n    // _gl.finish();\r\n\r\n  };\r\n\r\n  function projectObject(object) {\r\n\r\n    if (object.visible === false) return;\r\n\r\n    if (object instanceof THREE.Scene || object instanceof THREE.Group) {\r\n\r\n      // skip\r\n\r\n    }\r\n    else {\r\n\r\n      initObject(object);\r\n\r\n      if (object instanceof THREE.Light) {\r\n\r\n        lights.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        sprites.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.LensFlare) {\r\n\r\n        lensFlares.push(object);\r\n\r\n      }\r\n      else {\r\n\r\n        var webglObjects = _webglObjects[object.id];\r\n\r\n        if (webglObjects && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n          for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n            var webglObject = webglObjects[i];\r\n\r\n            unrollBufferMaterial(webglObject);\r\n\r\n            webglObject.render = true;\r\n\r\n            if (_this.sortObjects === true) {\r\n\r\n              _vector3.setFromMatrixPosition(object.matrixWorld);\r\n              _vector3.applyProjection(_projScreenMatrix);\r\n\r\n              webglObject.z = _vector3.z;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n      projectObject(object.children[i]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjects(renderList, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n\r\n      var object = webglObject.object;\r\n      var buffer = webglObject.buffer;\r\n\r\n      setupMatrices(object, camera);\r\n\r\n      if (overrideMaterial) {\r\n\r\n        material = overrideMaterial;\r\n\r\n      }\r\n      else {\r\n\r\n        material = webglObject.material;\r\n\r\n        if (!material) continue;\r\n\r\n        setMaterial(material);\r\n\r\n      }\r\n\r\n      _this.setMaterialFaces(material);\r\n\r\n      if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n        _this.renderBufferDirect(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n      else {\r\n\r\n        _this.renderBuffer(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjectsImmediate(renderList, materialType, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        if (overrideMaterial) {\r\n\r\n          material = overrideMaterial;\r\n\r\n        }\r\n        else {\r\n\r\n          material = webglObject[materialType];\r\n\r\n          if (!material) continue;\r\n\r\n          setMaterial(material);\r\n\r\n        }\r\n\r\n        _this.renderImmediateObject(camera, lights, fog, material, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.renderImmediateObject = function(camera, lights, fog, material, object) {\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n    _this.setMaterialFaces(material);\r\n\r\n    if (object.immediateRenderCallback) {\r\n\r\n      object.immediateRenderCallback(program, _gl, _frustum);\r\n\r\n    }\r\n    else {\r\n\r\n      object.render(function(object) {\r\n        _this.renderBufferImmediate(object, program, material);\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function unrollImmediateBufferMaterial(globject) {\r\n\r\n    var object = globject.object,\r\n      material = object.material;\r\n\r\n    if (material.transparent) {\r\n\r\n      globject.transparent = material;\r\n      globject.opaque = null;\r\n\r\n    }\r\n    else {\r\n\r\n      globject.opaque = material;\r\n      globject.transparent = null;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function unrollBufferMaterial(globject) {\r\n\r\n    var object = globject.object;\r\n    var buffer = globject.buffer;\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    if (material instanceof THREE.MeshFaceMaterial) {\r\n\r\n      var materialIndex = geometry instanceof THREE.BufferGeometry ? 0 : buffer.materialIndex;\r\n\r\n      material = material.materials[materialIndex];\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n    else if (material) {\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function initObject(object) {\r\n\r\n    if (object.__webglInit === undefined) {\r\n\r\n      object.__webglInit = true;\r\n      object._modelViewMatrix = new THREE.Matrix4();\r\n      object._normalMatrix = new THREE.Matrix3();\r\n\r\n      object.addEventListener('removed', onObjectRemoved);\r\n\r\n    }\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry === undefined) {\r\n\r\n      // ImmediateRenderObject\r\n\r\n    }\r\n    else if (geometry.__webglInit === undefined) {\r\n\r\n      geometry.__webglInit = true;\r\n      geometry.addEventListener('dispose', onGeometryDispose);\r\n\r\n      if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n        _this.info.memory.geometries++;\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n      else if (object instanceof THREE.Line) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createLineBuffers(geometry);\r\n          initLineBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n          geometry.lineDistancesNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.PointCloud) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createParticleBuffers(geometry);\r\n          initParticleBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (object.__webglActive === undefined) {\r\n\r\n      object.__webglActive = true;\r\n\r\n      if (object instanceof THREE.Mesh) {\r\n\r\n        if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n          addBuffer(_webglObjects, geometry, object);\r\n\r\n        }\r\n        else if (geometry instanceof THREE.Geometry) {\r\n\r\n          var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n          for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n            addBuffer(_webglObjects, geometryGroupsList[i], object);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        addBuffer(_webglObjects, geometry, object);\r\n\r\n      }\r\n      else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n        addBufferImmediate(_webglObjectsImmediate, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Geometry splitting\r\n\r\n  var geometryGroups = {};\r\n  var geometryGroupCounter = 0;\r\n\r\n  function makeGroups(geometry, usesFaceMaterial) {\r\n\r\n    var maxVerticesInGroup = extensions.get('OES_element_index_uint') ? 4294967296 : 65535;\r\n\r\n    var groupHash, hash_map = {};\r\n\r\n    var numMorphTargets = geometry.morphTargets.length;\r\n    var numMorphNormals = geometry.morphNormals.length;\r\n\r\n    var group;\r\n    var groups = {};\r\n    var groupsList = [];\r\n\r\n    for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n      var face = geometry.faces[f];\r\n      var materialIndex = usesFaceMaterial ? face.materialIndex : 0;\r\n\r\n      if (!(materialIndex in hash_map)) {\r\n\r\n        hash_map[materialIndex] = {\r\n          hash: materialIndex,\r\n          counter: 0\r\n        };\r\n\r\n      }\r\n\r\n      groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n      if (!(groupHash in groups)) {\r\n\r\n        group = {\r\n          id: geometryGroupCounter++,\r\n          faces3: [],\r\n          materialIndex: materialIndex,\r\n          vertices: 0,\r\n          numMorphTargets: numMorphTargets,\r\n          numMorphNormals: numMorphNormals\r\n        };\r\n\r\n        groups[groupHash] = group;\r\n        groupsList.push(group);\r\n\r\n      }\r\n\r\n      if (groups[groupHash].vertices + 3 > maxVerticesInGroup) {\r\n\r\n        hash_map[materialIndex].counter += 1;\r\n        groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n        if (!(groupHash in groups)) {\r\n\r\n          group = {\r\n            id: geometryGroupCounter++,\r\n            faces3: [],\r\n            materialIndex: materialIndex,\r\n            vertices: 0,\r\n            numMorphTargets: numMorphTargets,\r\n            numMorphNormals: numMorphNormals\r\n          };\r\n\r\n          groups[groupHash] = group;\r\n          groupsList.push(group);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      groups[groupHash].faces3.push(f);\r\n      groups[groupHash].vertices += 3;\r\n\r\n    }\r\n\r\n    return groupsList;\r\n\r\n  }\r\n\r\n  function initGeometryGroups(object, geometry) {\r\n\r\n    var material = object.material,\r\n      addBuffers = false;\r\n\r\n    if (geometryGroups[geometry.id] === undefined || geometry.groupsNeedUpdate === true) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n      geometryGroups[geometry.id] = makeGroups(geometry, material instanceof THREE.MeshFaceMaterial);\r\n\r\n      geometry.groupsNeedUpdate = false;\r\n\r\n    }\r\n\r\n    var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n    // create separate VBOs per geometry chunk\r\n\r\n    for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n      var geometryGroup = geometryGroupsList[i];\r\n\r\n      // initialise VBO on the first access\r\n\r\n      if (geometryGroup.__webglVertexBuffer === undefined) {\r\n\r\n        createMeshBuffers(geometryGroup);\r\n        initMeshBuffers(geometryGroup, object);\r\n\r\n        geometry.verticesNeedUpdate = true;\r\n        geometry.morphTargetsNeedUpdate = true;\r\n        geometry.elementsNeedUpdate = true;\r\n        geometry.uvsNeedUpdate = true;\r\n        geometry.normalsNeedUpdate = true;\r\n        geometry.tangentsNeedUpdate = true;\r\n        geometry.colorsNeedUpdate = true;\r\n\r\n        addBuffers = true;\r\n\r\n      }\r\n      else {\r\n\r\n        addBuffers = false;\r\n\r\n      }\r\n\r\n      if (addBuffers || object.__webglActive === undefined) {\r\n\r\n        addBuffer(_webglObjects, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    object.__webglActive = true;\r\n\r\n  }\r\n\r\n  function addBuffer(objlist, buffer, object) {\r\n\r\n    var id = object.id;\r\n    objlist[id] = objlist[id] || [];\r\n    objlist[id].push({\r\n      id: id,\r\n      buffer: buffer,\r\n      object: object,\r\n      material: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  function addBufferImmediate(objlist, object) {\r\n\r\n    objlist.push({\r\n      id: null,\r\n      object: object,\r\n      opaque: null,\r\n      transparent: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  // Objects updates\r\n\r\n  function updateObject(object) {\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var attributesKeys = geometry.attributesKeys;\r\n\r\n      for (var i = 0, l = attributesKeys.length; i < l; i++) {\r\n\r\n        var key = attributesKeys[i];\r\n        var attribute = attributes[key];\r\n        var bufferType = (key === 'index') ? _gl.ELEMENT_ARRAY_BUFFER : _gl.ARRAY_BUFFER;\r\n\r\n        if (attribute.buffer === undefined) {\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n          _gl.bufferData(bufferType, attribute.array, (attribute instanceof THREE.DynamicBufferAttribute) ? _gl.DYNAMIC_DRAW : _gl.STATIC_DRAW);\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n        else if (attribute.needsUpdate === true) {\r\n\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n\r\n          if (attribute.updateRange === undefined || attribute.updateRange.count === -1) { // Not using update ranges\r\n\r\n            _gl.bufferSubData(bufferType, 0, attribute.array);\r\n\r\n          }\r\n          else if (attribute.updateRange.count === 0) {\r\n\r\n            console.error('THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually.');\r\n\r\n          }\r\n          else {\r\n\r\n            _gl.bufferSubData(bufferType, attribute.updateRange.offset * attribute.array.BYTES_PER_ELEMENT,\r\n              attribute.array.subarray(attribute.updateRange.offset, attribute.updateRange.offset + attribute.updateRange.count));\r\n\r\n            attribute.updateRange.count = 0; // reset range\r\n\r\n          }\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Mesh) {\r\n\r\n      // check all geometry groups\r\n\r\n      if (geometry.groupsNeedUpdate === true) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n        var geometryGroup = geometryGroupsList[i];\r\n        var material = getBufferMaterial(object, geometryGroup);\r\n\r\n        var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n        if (geometry.verticesNeedUpdate || geometry.morphTargetsNeedUpdate || geometry.elementsNeedUpdate ||\r\n          geometry.uvsNeedUpdate || geometry.normalsNeedUpdate ||\r\n          geometry.colorsNeedUpdate || geometry.tangentsNeedUpdate || customAttributesDirty) {\r\n\r\n          setMeshBuffers(geometryGroup, object, _gl.DYNAMIC_DRAW, !geometry.dynamic, material);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.morphTargetsNeedUpdate = false;\r\n      geometry.elementsNeedUpdate = false;\r\n      geometry.uvsNeedUpdate = false;\r\n      geometry.normalsNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.tangentsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || geometry.lineDistancesNeedUpdate || customAttributesDirty) {\r\n\r\n        setLineBuffers(geometry, _gl.DYNAMIC_DRAW);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.lineDistancesNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || customAttributesDirty) {\r\n\r\n        setParticleBuffers(geometry, _gl.DYNAMIC_DRAW, object);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects updates - custom attributes check\r\n\r\n  function areCustomAttributesDirty(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      if (material.attributes[name].needsUpdate) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  function clearCustomAttributes(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      material.attributes[name].needsUpdate = false;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects removal\r\n\r\n  function removeObject(object) {\r\n\r\n    if (object instanceof THREE.Mesh ||\r\n      object instanceof THREE.PointCloud ||\r\n      object instanceof THREE.Line) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n    }\r\n    else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n      removeInstances(_webglObjectsImmediate, object);\r\n\r\n    }\r\n\r\n    delete object.__webglInit;\r\n    delete object._modelViewMatrix;\r\n    delete object._normalMatrix;\r\n\r\n    delete object.__webglActive;\r\n\r\n  }\r\n\r\n  function removeInstances(objlist, object) {\r\n\r\n    for (var o = objlist.length - 1; o >= 0; o--) {\r\n\r\n      if (objlist[o].object === object) {\r\n\r\n        objlist.splice(o, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Materials\r\n\r\n  var shaderIDs = {\r\n    MeshDepthMaterial: 'depth',\r\n    MeshNormalMaterial: 'normal',\r\n    MeshBasicMaterial: 'basic',\r\n    MeshLambertMaterial: 'lambert',\r\n    MeshPhongMaterial: 'phong',\r\n    LineBasicMaterial: 'basic',\r\n    LineDashedMaterial: 'dashed',\r\n    PointCloudMaterial: 'particle_basic'\r\n  };\r\n\r\n  function initMaterial(material, lights, fog, object) {\r\n\r\n    material.addEventListener('dispose', onMaterialDispose);\r\n\r\n    var shaderID = shaderIDs[material.type];\r\n\r\n    if (shaderID) {\r\n\r\n      var shader = THREE.ShaderLib[shaderID];\r\n\r\n      material.__webglShader = {\r\n        uniforms: THREE.UniformsUtils.clone(shader.uniforms),\r\n        vertexShader: shader.vertexShader,\r\n        fragmentShader: shader.fragmentShader\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      material.__webglShader = {\r\n        uniforms: material.uniforms,\r\n        vertexShader: material.vertexShader,\r\n        fragmentShader: material.fragmentShader\r\n      }\r\n\r\n    }\r\n\r\n    // heuristics to create shader parameters according to lights in the scene\r\n    // (not to blow over maxLights budget)\r\n\r\n    var maxLightCount = allocateLights(lights);\r\n    var maxShadows = allocateShadows(lights);\r\n    var maxBones = allocateBones(object);\r\n\r\n    var parameters = {\r\n\r\n      precision: _precision,\r\n      supportsVertexTextures: _supportsVertexTextures,\r\n\r\n      map: !!material.map,\r\n      envMap: !!material.envMap,\r\n      envMapMode: material.envMap && material.envMap.mapping,\r\n      lightMap: !!material.lightMap,\r\n      bumpMap: !!material.bumpMap,\r\n      normalMap: !!material.normalMap,\r\n      specularMap: !!material.specularMap,\r\n      alphaMap: !!material.alphaMap,\r\n\r\n      combine: material.combine,\r\n\r\n      vertexColors: material.vertexColors,\r\n\r\n      fog: fog,\r\n      useFog: material.fog,\r\n      fogExp: fog instanceof THREE.FogExp2,\r\n\r\n      flatShading: material.shading === THREE.FlatShading,\r\n\r\n      sizeAttenuation: material.sizeAttenuation,\r\n      logarithmicDepthBuffer: _logarithmicDepthBuffer,\r\n\r\n      skinning: material.skinning,\r\n      maxBones: maxBones,\r\n      useVertexTexture: _supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n      morphTargets: material.morphTargets,\r\n      morphNormals: material.morphNormals,\r\n      maxMorphTargets: _this.maxMorphTargets,\r\n      maxMorphNormals: _this.maxMorphNormals,\r\n\r\n      maxDirLights: maxLightCount.directional,\r\n      maxPointLights: maxLightCount.point,\r\n      maxSpotLights: maxLightCount.spot,\r\n      maxHemiLights: maxLightCount.hemi,\r\n\r\n      maxShadows: maxShadows,\r\n      shadowMapEnabled: _this.shadowMapEnabled && object.receiveShadow && maxShadows > 0,\r\n      shadowMapType: _this.shadowMapType,\r\n      shadowMapDebug: _this.shadowMapDebug,\r\n      shadowMapCascade: _this.shadowMapCascade,\r\n\r\n      alphaTest: material.alphaTest,\r\n      metal: material.metal,\r\n      wrapAround: material.wrapAround,\r\n      doubleSided: material.side === THREE.DoubleSide,\r\n      flipSided: material.side === THREE.BackSide\r\n\r\n    };\r\n\r\n    // Generate code\r\n\r\n    var chunks = [];\r\n\r\n    if (shaderID) {\r\n\r\n      chunks.push(shaderID);\r\n\r\n    }\r\n    else {\r\n\r\n      chunks.push(material.fragmentShader);\r\n      chunks.push(material.vertexShader);\r\n\r\n    }\r\n\r\n    if (material.defines !== undefined) {\r\n\r\n      for (var name in material.defines) {\r\n\r\n        chunks.push(name);\r\n        chunks.push(material.defines[name]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var name in parameters) {\r\n\r\n      chunks.push(name);\r\n      chunks.push(parameters[name]);\r\n\r\n    }\r\n\r\n    var code = chunks.join();\r\n\r\n    var program;\r\n\r\n    // Check if code has been already compiled\r\n\r\n    for (var p = 0, pl = _programs.length; p < pl; p++) {\r\n\r\n      var programInfo = _programs[p];\r\n\r\n      if (programInfo.code === code) {\r\n\r\n        program = programInfo;\r\n        program.usedTimes++;\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (program === undefined) {\r\n\r\n      program = new THREE.WebGLProgram(_this, code, material, parameters);\r\n      _programs.push(program);\r\n\r\n      _this.info.memory.programs = _programs.length;\r\n\r\n    }\r\n\r\n    material.program = program;\r\n\r\n    var attributes = program.attributes;\r\n\r\n    if (material.morphTargets) {\r\n\r\n      material.numSupportedMorphTargets = 0;\r\n\r\n      var id, base = 'morphTarget';\r\n\r\n      for (var i = 0; i < _this.maxMorphTargets; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphTargets++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (material.morphNormals) {\r\n\r\n      material.numSupportedMorphNormals = 0;\r\n\r\n      var id, base = 'morphNormal';\r\n\r\n      for (i = 0; i < _this.maxMorphNormals; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphNormals++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    material.uniformsList = [];\r\n\r\n    for (var u in material.__webglShader.uniforms) {\r\n\r\n      var location = material.program.uniforms[u];\r\n\r\n      if (location) {\r\n        material.uniformsList.push([material.__webglShader.uniforms[u], location]);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMaterial(material) {\r\n\r\n    if (material.transparent === true) {\r\n\r\n      state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha);\r\n\r\n    }\r\n    else {\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n    }\r\n\r\n    state.setDepthTest(material.depthTest);\r\n    state.setDepthWrite(material.depthWrite);\r\n    state.setColorWrite(material.colorWrite);\r\n    state.setPolygonOffset(material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits);\r\n\r\n  }\r\n\r\n  function setProgram(camera, lights, fog, material, object) {\r\n\r\n    _usedTextureUnits = 0;\r\n\r\n    if (material.needsUpdate) {\r\n\r\n      if (material.program) deallocateMaterial(material);\r\n\r\n      initMaterial(material, lights, fog, object);\r\n      material.needsUpdate = false;\r\n\r\n    }\r\n\r\n    if (material.morphTargets) {\r\n\r\n      if (!object.__webglMorphTargetInfluences) {\r\n\r\n        object.__webglMorphTargetInfluences = new Float32Array(_this.maxMorphTargets);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var refreshProgram = false;\r\n    var refreshMaterial = false;\r\n    var refreshLights = false;\r\n\r\n    var program = material.program,\r\n      p_uniforms = program.uniforms,\r\n      m_uniforms = material.__webglShader.uniforms;\r\n\r\n    if (program.id !== _currentProgram) {\r\n\r\n      _gl.useProgram(program.program);\r\n      _currentProgram = program.id;\r\n\r\n      refreshProgram = true;\r\n      refreshMaterial = true;\r\n      refreshLights = true;\r\n\r\n    }\r\n\r\n    if (material.id !== _currentMaterialId) {\r\n\r\n      if (_currentMaterialId === -1) refreshLights = true;\r\n      _currentMaterialId = material.id;\r\n\r\n      refreshMaterial = true;\r\n\r\n    }\r\n\r\n    if (refreshProgram || camera !== _currentCamera) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n      if (_logarithmicDepthBuffer) {\r\n\r\n        _gl.uniform1f(p_uniforms.logDepthBufFC, 2.0 / (Math.log(camera.far + 1.0) / Math.LN2));\r\n\r\n      }\r\n\r\n\r\n      if (camera !== _currentCamera) _currentCamera = camera;\r\n\r\n      // load material specific uniforms\r\n      // (shader material also gets them for the sake of genericity)\r\n\r\n      if (material instanceof THREE.ShaderMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial ||\r\n        material.envMap) {\r\n\r\n        if (p_uniforms.cameraPosition !== null) {\r\n\r\n          _vector3.setFromMatrixPosition(camera.matrixWorld);\r\n          _gl.uniform3f(p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.ShaderMaterial ||\r\n        material.skinning) {\r\n\r\n        if (p_uniforms.viewMatrix !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // skinning uniforms must be set even if material didn't change\r\n    // auto-setting of texture unit for bone texture must go before other textures\r\n    // not sure why, but otherwise weird things happen\r\n\r\n    if (material.skinning) {\r\n\r\n      if (object.bindMatrix && p_uniforms.bindMatrix !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrix, false, object.bindMatrix.elements);\r\n\r\n      }\r\n\r\n      if (object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements);\r\n\r\n      }\r\n\r\n      if (_supportsBoneTextures && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n        if (p_uniforms.boneTexture !== null) {\r\n\r\n          var textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(p_uniforms.boneTexture, textureUnit);\r\n          _this.setTexture(object.skeleton.boneTexture, textureUnit);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureWidth !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureHeight !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight);\r\n\r\n        }\r\n\r\n      }\r\n      else if (object.skeleton && object.skeleton.boneMatrices) {\r\n\r\n        if (p_uniforms.boneGlobalMatrices !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (refreshMaterial) {\r\n\r\n      // refresh uniforms common to several materials\r\n\r\n      if (fog && material.fog) {\r\n\r\n        refreshUniformsFog(m_uniforms, fog);\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material.lights) {\r\n\r\n        if (_lightsNeedUpdate) {\r\n\r\n          refreshLights = true;\r\n          setupLights(lights);\r\n          _lightsNeedUpdate = false;\r\n        }\r\n\r\n        if (refreshLights) {\r\n          refreshUniformsLights(m_uniforms, _lights);\r\n          markUniformsLightsNeedsUpdate(m_uniforms, true);\r\n        }\r\n        else {\r\n          markUniformsLightsNeedsUpdate(m_uniforms, false);\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsCommon(m_uniforms, material);\r\n\r\n      }\r\n\r\n      // refresh single material specific uniforms\r\n\r\n      if (material instanceof THREE.LineBasicMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.LineDashedMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n        refreshUniformsDash(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.PointCloudMaterial) {\r\n\r\n        refreshUniformsParticle(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsPhong(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshLambertMaterial) {\r\n\r\n        refreshUniformsLambert(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshDepthMaterial) {\r\n\r\n        m_uniforms.mNear.value = camera.near;\r\n        m_uniforms.mFar.value = camera.far;\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshNormalMaterial) {\r\n\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n\r\n      if (object.receiveShadow && !material._shadowPass) {\r\n\r\n        refreshUniformsShadow(m_uniforms, lights);\r\n\r\n      }\r\n\r\n      // load common uniforms\r\n\r\n      loadUniformsGeneric(material.uniformsList);\r\n\r\n    }\r\n\r\n    loadUniformsMatrices(p_uniforms, object);\r\n\r\n    if (p_uniforms.modelMatrix !== null) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.modelMatrix, false, object.matrixWorld.elements);\r\n\r\n    }\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n  // Uniforms (refresh uniforms objects)\r\n\r\n  function refreshUniformsCommon(uniforms, material) {\r\n\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n    uniforms.diffuse.value = material.color;\r\n\r\n    uniforms.map.value = material.map;\r\n    uniforms.lightMap.value = material.lightMap;\r\n    uniforms.specularMap.value = material.specularMap;\r\n    uniforms.alphaMap.value = material.alphaMap;\r\n\r\n    if (material.bumpMap) {\r\n\r\n      uniforms.bumpMap.value = material.bumpMap;\r\n      uniforms.bumpScale.value = material.bumpScale;\r\n\r\n    }\r\n\r\n    if (material.normalMap) {\r\n\r\n      uniforms.normalMap.value = material.normalMap;\r\n      uniforms.normalScale.value.copy(material.normalScale);\r\n\r\n    }\r\n\r\n    // uv repeat and offset setting priorities\r\n    //  1. color map\r\n    //  2. specular map\r\n    //  3. normal map\r\n    //  4. bump map\r\n    //  5. alpha map\r\n\r\n    var uvScaleMap;\r\n\r\n    if (material.map) {\r\n\r\n      uvScaleMap = material.map;\r\n\r\n    }\r\n    else if (material.specularMap) {\r\n\r\n      uvScaleMap = material.specularMap;\r\n\r\n    }\r\n    else if (material.normalMap) {\r\n\r\n      uvScaleMap = material.normalMap;\r\n\r\n    }\r\n    else if (material.bumpMap) {\r\n\r\n      uvScaleMap = material.bumpMap;\r\n\r\n    }\r\n    else if (material.alphaMap) {\r\n\r\n      uvScaleMap = material.alphaMap;\r\n\r\n    }\r\n\r\n    if (uvScaleMap !== undefined) {\r\n\r\n      var offset = uvScaleMap.offset;\r\n      var repeat = uvScaleMap.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n    uniforms.envMap.value = material.envMap;\r\n    uniforms.flipEnvMap.value = (material.envMap instanceof THREE.WebGLRenderTargetCube) ? 1 : -1;\r\n\r\n    uniforms.reflectivity.value = material.reflectivity;\r\n    uniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n  }\r\n\r\n  function refreshUniformsLine(uniforms, material) {\r\n\r\n    uniforms.diffuse.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n  }\r\n\r\n  function refreshUniformsDash(uniforms, material) {\r\n\r\n    uniforms.dashSize.value = material.dashSize;\r\n    uniforms.totalSize.value = material.dashSize + material.gapSize;\r\n    uniforms.scale.value = material.scale;\r\n\r\n  }\r\n\r\n  function refreshUniformsParticle(uniforms, material) {\r\n\r\n    uniforms.psColor.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n    uniforms.size.value = material.size;\r\n    uniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\r\n    uniforms.map.value = material.map;\r\n\r\n    if (material.map !== null) {\r\n\r\n      var offset = material.map.offset;\r\n      var repeat = material.map.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsFog(uniforms, fog) {\r\n\r\n    uniforms.fogColor.value = fog.color;\r\n\r\n    if (fog instanceof THREE.Fog) {\r\n\r\n      uniforms.fogNear.value = fog.near;\r\n      uniforms.fogFar.value = fog.far;\r\n\r\n    }\r\n    else if (fog instanceof THREE.FogExp2) {\r\n\r\n      uniforms.fogDensity.value = fog.density;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsPhong(uniforms, material) {\r\n\r\n    uniforms.shininess.value = material.shininess;\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n    uniforms.specular.value = material.specular;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLambert(uniforms, material) {\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLights(uniforms, lights) {\r\n\r\n    uniforms.ambientLightColor.value = lights.ambient;\r\n\r\n    uniforms.directionalLightColor.value = lights.directional.colors;\r\n    uniforms.directionalLightDirection.value = lights.directional.positions;\r\n\r\n    uniforms.pointLightColor.value = lights.point.colors;\r\n    uniforms.pointLightPosition.value = lights.point.positions;\r\n    uniforms.pointLightDistance.value = lights.point.distances;\r\n    uniforms.pointLightDecay.value = lights.point.decays;\r\n\r\n    uniforms.spotLightColor.value = lights.spot.colors;\r\n    uniforms.spotLightPosition.value = lights.spot.positions;\r\n    uniforms.spotLightDistance.value = lights.spot.distances;\r\n    uniforms.spotLightDirection.value = lights.spot.directions;\r\n    uniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n    uniforms.spotLightExponent.value = lights.spot.exponents;\r\n    uniforms.spotLightDecay.value = lights.spot.decays;\r\n\r\n    uniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n    uniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n    uniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\r\n  }\r\n\r\n  // If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n  function markUniformsLightsNeedsUpdate(uniforms, value) {\r\n\r\n    uniforms.ambientLightColor.needsUpdate = value;\r\n\r\n    uniforms.directionalLightColor.needsUpdate = value;\r\n    uniforms.directionalLightDirection.needsUpdate = value;\r\n\r\n    uniforms.pointLightColor.needsUpdate = value;\r\n    uniforms.pointLightPosition.needsUpdate = value;\r\n    uniforms.pointLightDistance.needsUpdate = value;\r\n    uniforms.pointLightDecay.needsUpdate = value;\r\n\r\n    uniforms.spotLightColor.needsUpdate = value;\r\n    uniforms.spotLightPosition.needsUpdate = value;\r\n    uniforms.spotLightDistance.needsUpdate = value;\r\n    uniforms.spotLightDirection.needsUpdate = value;\r\n    uniforms.spotLightAngleCos.needsUpdate = value;\r\n    uniforms.spotLightExponent.needsUpdate = value;\r\n    uniforms.spotLightDecay.needsUpdate = value;\r\n\r\n    uniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n    uniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n    uniforms.hemisphereLightDirection.needsUpdate = value;\r\n\r\n  }\r\n\r\n  function refreshUniformsShadow(uniforms, lights) {\r\n\r\n    if (uniforms.shadowMatrix) {\r\n\r\n      var j = 0;\r\n\r\n      for (var i = 0, il = lights.length; i < il; i++) {\r\n\r\n        var light = lights[i];\r\n\r\n        if (!light.castShadow) continue;\r\n\r\n        if (light instanceof THREE.SpotLight || (light instanceof THREE.DirectionalLight && !light.shadowCascade)) {\r\n\r\n          uniforms.shadowMap.value[j] = light.shadowMap;\r\n          uniforms.shadowMapSize.value[j] = light.shadowMapSize;\r\n\r\n          uniforms.shadowMatrix.value[j] = light.shadowMatrix;\r\n\r\n          uniforms.shadowDarkness.value[j] = light.shadowDarkness;\r\n          uniforms.shadowBias.value[j] = light.shadowBias;\r\n\r\n          j++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Uniforms (load to GPU)\r\n\r\n  function loadUniformsMatrices(uniforms, object) {\r\n\r\n    _gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, object._modelViewMatrix.elements);\r\n\r\n    if (uniforms.normalMatrix) {\r\n\r\n      _gl.uniformMatrix3fv(uniforms.normalMatrix, false, object._normalMatrix.elements);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function getTextureUnit() {\r\n\r\n    var textureUnit = _usedTextureUnits;\r\n\r\n    if (textureUnit >= _maxTextures) {\r\n\r\n      THREE.warn('WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + _maxTextures);\r\n\r\n    }\r\n\r\n    _usedTextureUnits += 1;\r\n\r\n    return textureUnit;\r\n\r\n  }\r\n\r\n  function loadUniformsGeneric(uniforms) {\r\n\r\n    var texture, textureUnit, offset;\r\n\r\n    for (var j = 0, jl = uniforms.length; j < jl; j++) {\r\n\r\n      var uniform = uniforms[j][0];\r\n\r\n      // needsUpdate property is not added to all uniforms.\r\n      if (uniform.needsUpdate === false) continue;\r\n\r\n      var type = uniform.type;\r\n      var value = uniform.value;\r\n      var location = uniforms[j][1];\r\n\r\n      switch (type) {\r\n\r\n        case '1i':\r\n          _gl.uniform1i(location, value);\r\n          break;\r\n\r\n        case '1f':\r\n          _gl.uniform1f(location, value);\r\n          break;\r\n\r\n        case '2f':\r\n          _gl.uniform2f(location, value[0], value[1]);\r\n          break;\r\n\r\n        case '3f':\r\n          _gl.uniform3f(location, value[0], value[1], value[2]);\r\n          break;\r\n\r\n        case '4f':\r\n          _gl.uniform4f(location, value[0], value[1], value[2], value[3]);\r\n          break;\r\n\r\n        case '1iv':\r\n          _gl.uniform1iv(location, value);\r\n          break;\r\n\r\n        case '3iv':\r\n          _gl.uniform3iv(location, value);\r\n          break;\r\n\r\n        case '1fv':\r\n          _gl.uniform1fv(location, value);\r\n          break;\r\n\r\n        case '2fv':\r\n          _gl.uniform2fv(location, value);\r\n          break;\r\n\r\n        case '3fv':\r\n          _gl.uniform3fv(location, value);\r\n          break;\r\n\r\n        case '4fv':\r\n          _gl.uniform4fv(location, value);\r\n          break;\r\n\r\n        case 'Matrix3fv':\r\n          _gl.uniformMatrix3fv(location, false, value);\r\n          break;\r\n\r\n        case 'Matrix4fv':\r\n          _gl.uniformMatrix4fv(location, false, value);\r\n          break;\r\n\r\n          //\r\n\r\n        case 'i':\r\n\r\n          // single integer\r\n          _gl.uniform1i(location, value);\r\n\r\n          break;\r\n\r\n        case 'f':\r\n\r\n          // single float\r\n          _gl.uniform1f(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2':\r\n\r\n          // single THREE.Vector2\r\n          _gl.uniform2f(location, value.x, value.y);\r\n\r\n          break;\r\n\r\n        case 'v3':\r\n\r\n          // single THREE.Vector3\r\n          _gl.uniform3f(location, value.x, value.y, value.z);\r\n\r\n          break;\r\n\r\n        case 'v4':\r\n\r\n          // single THREE.Vector4\r\n          _gl.uniform4f(location, value.x, value.y, value.z, value.w);\r\n\r\n          break;\r\n\r\n        case 'c':\r\n\r\n          // single THREE.Color\r\n          _gl.uniform3f(location, value.r, value.g, value.b);\r\n\r\n          break;\r\n\r\n        case 'iv1':\r\n\r\n          // flat array of integers (JS or typed array)\r\n          _gl.uniform1iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'iv':\r\n\r\n          // flat array of integers with 3 x N size (JS or typed array)\r\n          _gl.uniform3iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv1':\r\n\r\n          // flat array of floats (JS or typed array)\r\n          _gl.uniform1fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv':\r\n\r\n          // flat array of floats with 3 x N size (JS or typed array)\r\n          _gl.uniform3fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2v':\r\n\r\n          // array of THREE.Vector2\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(2 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 2;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n\r\n          }\r\n\r\n          _gl.uniform2fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v3v':\r\n\r\n          // array of THREE.Vector3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(3 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 3;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n\r\n          }\r\n\r\n          _gl.uniform3fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v4v':\r\n\r\n          // array of THREE.Vector4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(4 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 4;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n            uniform._array[offset + 3] = value[i].w;\r\n\r\n          }\r\n\r\n          _gl.uniform4fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm3':\r\n\r\n          // single THREE.Matrix3\r\n          _gl.uniformMatrix3fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm3v':\r\n\r\n          // array of THREE.Matrix3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(9 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 9);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix3fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm4':\r\n\r\n          // single THREE.Matrix4\r\n          _gl.uniformMatrix4fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm4v':\r\n\r\n          // array of THREE.Matrix4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(16 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 16);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix4fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 't':\r\n\r\n          // single THREE.Texture (2d or cube)\r\n\r\n          texture = value;\r\n          textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(location, textureUnit);\r\n\r\n          if (!texture) continue;\r\n\r\n          if (texture instanceof THREE.CubeTexture ||\r\n            (texture.image instanceof Array && texture.image.length === 6)) { // CompressedTexture can have Array in image :/\r\n\r\n            setCubeTexture(texture, textureUnit);\r\n\r\n          }\r\n          else if (texture instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n            setCubeTextureDynamic(texture, textureUnit);\r\n\r\n          }\r\n          else {\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        case 'tv':\r\n\r\n          // array of THREE.Texture (2d)\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = [];\r\n\r\n          }\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            uniform._array[i] = getTextureUnit();\r\n\r\n          }\r\n\r\n          _gl.uniform1iv(location, uniform._array);\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            texture = uniform.value[i];\r\n            textureUnit = uniform._array[i];\r\n\r\n            if (!texture) continue;\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          THREE.warn('THREE.WebGLRenderer: Unknown uniform type: ' + type);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setupMatrices(object, camera) {\r\n\r\n    object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, object.matrixWorld);\r\n    object._normalMatrix.getNormalMatrix(object._modelViewMatrix);\r\n\r\n  }\r\n\r\n  function setColorLinear(array, offset, color, intensity) {\r\n\r\n    array[offset] = color.r * intensity;\r\n    array[offset + 1] = color.g * intensity;\r\n    array[offset + 2] = color.b * intensity;\r\n\r\n  }\r\n\r\n  function setupLights(lights) {\r\n\r\n    var l, ll, light,\r\n      r = 0,\r\n      g = 0,\r\n      b = 0,\r\n      color, skyColor, groundColor,\r\n      intensity,\r\n      distance,\r\n\r\n      zlights = _lights,\r\n\r\n      dirColors = zlights.directional.colors,\r\n      dirPositions = zlights.directional.positions,\r\n\r\n      pointColors = zlights.point.colors,\r\n      pointPositions = zlights.point.positions,\r\n      pointDistances = zlights.point.distances,\r\n      pointDecays = zlights.point.decays,\r\n\r\n      spotColors = zlights.spot.colors,\r\n      spotPositions = zlights.spot.positions,\r\n      spotDistances = zlights.spot.distances,\r\n      spotDirections = zlights.spot.directions,\r\n      spotAnglesCos = zlights.spot.anglesCos,\r\n      spotExponents = zlights.spot.exponents,\r\n      spotDecays = zlights.spot.decays,\r\n\r\n      hemiSkyColors = zlights.hemi.skyColors,\r\n      hemiGroundColors = zlights.hemi.groundColors,\r\n      hemiPositions = zlights.hemi.positions,\r\n\r\n      dirLength = 0,\r\n      pointLength = 0,\r\n      spotLength = 0,\r\n      hemiLength = 0,\r\n\r\n      dirCount = 0,\r\n      pointCount = 0,\r\n      spotCount = 0,\r\n      hemiCount = 0,\r\n\r\n      dirOffset = 0,\r\n      pointOffset = 0,\r\n      spotOffset = 0,\r\n      hemiOffset = 0;\r\n\r\n    for (l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      light = lights[l];\r\n\r\n      if (light.onlyShadow) continue;\r\n\r\n      color = light.color;\r\n      intensity = light.intensity;\r\n      distance = light.distance;\r\n\r\n      if (light instanceof THREE.AmbientLight) {\r\n\r\n        if (!light.visible) continue;\r\n\r\n        r += color.r;\r\n        g += color.g;\r\n        b += color.b;\r\n\r\n      }\r\n      else if (light instanceof THREE.DirectionalLight) {\r\n\r\n        dirCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        dirOffset = dirLength * 3;\r\n\r\n        dirPositions[dirOffset] = _direction.x;\r\n        dirPositions[dirOffset + 1] = _direction.y;\r\n        dirPositions[dirOffset + 2] = _direction.z;\r\n\r\n        setColorLinear(dirColors, dirOffset, color, intensity);\r\n\r\n        dirLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.PointLight) {\r\n\r\n        pointCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        pointOffset = pointLength * 3;\r\n\r\n        setColorLinear(pointColors, pointOffset, color, intensity);\r\n\r\n        _vector3.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        pointPositions[pointOffset] = _vector3.x;\r\n        pointPositions[pointOffset + 1] = _vector3.y;\r\n        pointPositions[pointOffset + 2] = _vector3.z;\r\n\r\n        // distance is 0 if decay is 0, because there is no attenuation at all.\r\n        pointDistances[pointLength] = distance;\r\n        pointDecays[pointLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        pointLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.SpotLight) {\r\n\r\n        spotCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        spotOffset = spotLength * 3;\r\n\r\n        setColorLinear(spotColors, spotOffset, color, intensity);\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        spotPositions[spotOffset] = _direction.x;\r\n        spotPositions[spotOffset + 1] = _direction.y;\r\n        spotPositions[spotOffset + 2] = _direction.z;\r\n\r\n        spotDistances[spotLength] = distance;\r\n\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        spotDirections[spotOffset] = _direction.x;\r\n        spotDirections[spotOffset + 1] = _direction.y;\r\n        spotDirections[spotOffset + 2] = _direction.z;\r\n\r\n        spotAnglesCos[spotLength] = Math.cos(light.angle);\r\n        spotExponents[spotLength] = light.exponent;\r\n        spotDecays[spotLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        spotLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.HemisphereLight) {\r\n\r\n        hemiCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _direction.normalize();\r\n\r\n        hemiOffset = hemiLength * 3;\r\n\r\n        hemiPositions[hemiOffset] = _direction.x;\r\n        hemiPositions[hemiOffset + 1] = _direction.y;\r\n        hemiPositions[hemiOffset + 2] = _direction.z;\r\n\r\n        skyColor = light.color;\r\n        groundColor = light.groundColor;\r\n\r\n        setColorLinear(hemiSkyColors, hemiOffset, skyColor, intensity);\r\n        setColorLinear(hemiGroundColors, hemiOffset, groundColor, intensity);\r\n\r\n        hemiLength += 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // null eventual remains from removed lights\r\n    // (this is to avoid if in shader)\r\n\r\n    for (l = dirLength * 3, ll = Math.max(dirColors.length, dirCount * 3); l < ll; l++) dirColors[l] = 0.0;\r\n    for (l = pointLength * 3, ll = Math.max(pointColors.length, pointCount * 3); l < ll; l++) pointColors[l] = 0.0;\r\n    for (l = spotLength * 3, ll = Math.max(spotColors.length, spotCount * 3); l < ll; l++) spotColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiSkyColors.length, hemiCount * 3); l < ll; l++) hemiSkyColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiGroundColors.length, hemiCount * 3); l < ll; l++) hemiGroundColors[l] = 0.0;\r\n\r\n    zlights.directional.length = dirLength;\r\n    zlights.point.length = pointLength;\r\n    zlights.spot.length = spotLength;\r\n    zlights.hemi.length = hemiLength;\r\n\r\n    zlights.ambient[0] = r;\r\n    zlights.ambient[1] = g;\r\n    zlights.ambient[2] = b;\r\n\r\n  }\r\n\r\n  // GL state setting\r\n\r\n  this.setFaceCulling = function(cullFace, frontFaceDirection) {\r\n\r\n    if (cullFace === THREE.CullFaceNone) {\r\n\r\n      _gl.disable(_gl.CULL_FACE);\r\n\r\n    }\r\n    else {\r\n\r\n      if (frontFaceDirection === THREE.FrontFaceDirectionCW) {\r\n\r\n        _gl.frontFace(_gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.frontFace(_gl.CCW);\r\n\r\n      }\r\n\r\n      if (cullFace === THREE.CullFaceBack) {\r\n\r\n        _gl.cullFace(_gl.BACK);\r\n\r\n      }\r\n      else if (cullFace === THREE.CullFaceFront) {\r\n\r\n        _gl.cullFace(_gl.FRONT);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.cullFace(_gl.FRONT_AND_BACK);\r\n\r\n      }\r\n\r\n      _gl.enable(_gl.CULL_FACE);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setMaterialFaces = function(material) {\r\n\r\n    state.setDoubleSided(material.side === THREE.DoubleSide);\r\n    state.setFlipSided(material.side === THREE.BackSide);\r\n\r\n  };\r\n\r\n  // Textures\r\n\r\n  function setTextureParameters(textureType, texture, isImagePowerOfTwo) {\r\n\r\n    var extension;\r\n\r\n    if (isImagePowerOfTwo) {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL(texture.wrapS));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL(texture.wrapT));\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL(texture.minFilter));\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);\r\n\r\n      if (texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, filterFallback(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, filterFallback(texture.minFilter));\r\n\r\n      if (texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n    if (extension && texture.type !== THREE.FloatType && texture.type !== THREE.HalfFloatType) {\r\n\r\n      if (texture.anisotropy > 1 || texture.__currentAnisotropy) {\r\n\r\n        _gl.texParameterf(textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(texture.anisotropy, _this.getMaxAnisotropy()));\r\n        texture.__currentAnisotropy = texture.anisotropy;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.uploadTexture = function(texture) {\r\n\r\n    if (texture.__webglInit === undefined) {\r\n\r\n      texture.__webglInit = true;\r\n\r\n      texture.addEventListener('dispose', onTextureDispose);\r\n\r\n      texture.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n    }\r\n\r\n    _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n    _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha);\r\n    _gl.pixelStorei(_gl.UNPACK_ALIGNMENT, texture.unpackAlignment);\r\n\r\n    texture.image = clampToMaxSize(texture.image, _maxTextureSize);\r\n\r\n    var image = texture.image,\r\n      isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n      glFormat = paramThreeToGL(texture.format),\r\n      glType = paramThreeToGL(texture.type);\r\n\r\n    setTextureParameters(_gl.TEXTURE_2D, texture, isImagePowerOfTwo);\r\n\r\n    var mipmap, mipmaps = texture.mipmaps;\r\n\r\n    if (texture instanceof THREE.DataTexture) {\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data);\r\n\r\n      }\r\n\r\n    }\r\n    else if (texture instanceof THREE.CompressedTexture) {\r\n\r\n      for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n        mipmap = mipmaps[i];\r\n\r\n        if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n          if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n            _gl.compressedTexImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n          }\r\n          else {\r\n\r\n            THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\");\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else { // regular Texture (image, video, canvas)\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (texture.generateMipmaps && isImagePowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n    texture.needsUpdate = false;\r\n\r\n    if (texture.onUpdate) texture.onUpdate();\r\n\r\n  };\r\n\r\n  this.setTexture = function(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n\r\n    if (texture.needsUpdate) {\r\n\r\n      _this.uploadTexture(texture);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function clampToMaxSize(image, maxSize) {\r\n\r\n    if (image.width > maxSize || image.height > maxSize) {\r\n\r\n      // Warning: Scaling through the canvas will only work with images that use\r\n      // premultiplied alpha.\r\n\r\n      var scale = maxSize / Math.max(image.width, image.height);\r\n\r\n      var canvas = document.createElement('canvas');\r\n      canvas.width = Math.floor(image.width * scale);\r\n      canvas.height = Math.floor(image.height * scale);\r\n\r\n      var context = canvas.getContext('2d');\r\n      context.drawImage(image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height);\r\n\r\n      THREE.warn('THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image);\r\n\r\n      return canvas;\r\n\r\n    }\r\n\r\n    return image;\r\n\r\n  }\r\n\r\n  function setCubeTexture(texture, slot) {\r\n\r\n    if (texture.image.length === 6) {\r\n\r\n      if (texture.needsUpdate) {\r\n\r\n        if (!texture.image.__webglTextureCube) {\r\n\r\n          texture.addEventListener('dispose', onTextureDispose);\r\n\r\n          texture.image.__webglTextureCube = _gl.createTexture();\r\n\r\n          _this.info.memory.textures++;\r\n\r\n        }\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n\r\n        var isCompressed = texture instanceof THREE.CompressedTexture;\r\n        var isDataTexture = texture.image[0] instanceof THREE.DataTexture;\r\n\r\n        var cubeImage = [];\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (_this.autoScaleCubemaps && !isCompressed && !isDataTexture) {\r\n\r\n            cubeImage[i] = clampToMaxSize(texture.image[i], _maxCubemapSize);\r\n\r\n          }\r\n          else {\r\n\r\n            cubeImage[i] = isDataTexture ? texture.image[i].image : texture.image[i];\r\n\r\n          }\r\n\r\n        }\r\n\r\n        var image = cubeImage[0],\r\n          isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n          glFormat = paramThreeToGL(texture.format),\r\n          glType = paramThreeToGL(texture.type);\r\n\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (!isCompressed) {\r\n\r\n            if (isDataTexture) {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[i].width, cubeImage[i].height, 0, glFormat, glType, cubeImage[i].data);\r\n\r\n            }\r\n            else {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[i]);\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            var mipmap, mipmaps = cubeImage[i].mipmaps;\r\n\r\n            for (var j = 0, jl = mipmaps.length; j < jl; j++) {\r\n\r\n              mipmap = mipmaps[j];\r\n\r\n              if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n                if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n                  _gl.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n                }\r\n                else {\r\n\r\n                  THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\");\r\n\r\n                }\r\n\r\n              }\r\n              else {\r\n\r\n                _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (texture.generateMipmaps && isImagePowerOfTwo) {\r\n\r\n          _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n        }\r\n\r\n        texture.needsUpdate = false;\r\n\r\n        if (texture.onUpdate) texture.onUpdate();\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setCubeTextureDynamic(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n    _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.__webglTexture);\r\n\r\n  }\r\n\r\n  // Render targets\r\n\r\n  function setupFrameBuffer(framebuffer, renderTarget, textureTarget) {\r\n\r\n    _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n    _gl.framebufferTexture2D(_gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, renderTarget.__webglTexture, 0);\r\n\r\n  }\r\n\r\n  function setupRenderBuffer(renderbuffer, renderTarget) {\r\n\r\n    _gl.bindRenderbuffer(_gl.RENDERBUFFER, renderbuffer);\r\n\r\n    if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n      /* For some reason this is not working. Defaulting to RGBA4.\r\n      } else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n      \t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n      \t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n      */\r\n    }\r\n    else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.setRenderTarget = function(renderTarget) {\r\n\r\n    var isCube = (renderTarget instanceof THREE.WebGLRenderTargetCube);\r\n\r\n    if (renderTarget && renderTarget.__webglFramebuffer === undefined) {\r\n\r\n      if (renderTarget.depthBuffer === undefined) renderTarget.depthBuffer = true;\r\n      if (renderTarget.stencilBuffer === undefined) renderTarget.stencilBuffer = true;\r\n\r\n      renderTarget.addEventListener('dispose', onRenderTargetDispose);\r\n\r\n      renderTarget.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n      // Setup texture, create render and frame buffers\r\n\r\n      var isTargetPowerOfTwo = THREE.Math.isPowerOfTwo(renderTarget.width) && THREE.Math.isPowerOfTwo(renderTarget.height),\r\n        glFormat = paramThreeToGL(renderTarget.format),\r\n        glType = paramThreeToGL(renderTarget.type);\r\n\r\n      if (isCube) {\r\n\r\n        renderTarget.__webglFramebuffer = [];\r\n        renderTarget.__webglRenderbuffer = [];\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, renderTarget, isTargetPowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          renderTarget.__webglFramebuffer[i] = _gl.createFramebuffer();\r\n          renderTarget.__webglRenderbuffer[i] = _gl.createRenderbuffer();\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n          setupFrameBuffer(renderTarget.__webglFramebuffer[i], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i);\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer[i], renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n      }\r\n      else {\r\n\r\n        renderTarget.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          renderTarget.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\r\n        }\r\n        else {\r\n\r\n          renderTarget.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\r\n        }\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_2D, renderTarget, isTargetPowerOfTwo);\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n        setupFrameBuffer(renderTarget.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D);\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n          else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer, renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n      }\r\n\r\n      // Release everything\r\n\r\n      if (isCube) {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n      }\r\n\r\n      _gl.bindRenderbuffer(_gl.RENDERBUFFER, null);\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, null);\r\n\r\n    }\r\n\r\n    var framebuffer, width, height, vx, vy;\r\n\r\n    if (renderTarget) {\r\n\r\n      if (isCube) {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer[renderTarget.activeCubeFace];\r\n\r\n      }\r\n      else {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer;\r\n\r\n      }\r\n\r\n      width = renderTarget.width;\r\n      height = renderTarget.height;\r\n\r\n      vx = 0;\r\n      vy = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      framebuffer = null;\r\n\r\n      width = _viewportWidth;\r\n      height = _viewportHeight;\r\n\r\n      vx = _viewportX;\r\n      vy = _viewportY;\r\n\r\n    }\r\n\r\n    if (framebuffer !== _currentFramebuffer) {\r\n\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n      _gl.viewport(vx, vy, width, height);\r\n\r\n      _currentFramebuffer = framebuffer;\r\n\r\n    }\r\n\r\n    _currentWidth = width;\r\n    _currentHeight = height;\r\n\r\n  };\r\n\r\n  this.readRenderTargetPixels = function(renderTarget, x, y, width, height, buffer) {\r\n\r\n    if (!(renderTarget instanceof THREE.WebGLRenderTarget)) {\r\n\r\n      console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');\r\n      return;\r\n\r\n    }\r\n\r\n    if (renderTarget.__webglFramebuffer) {\r\n\r\n      if (renderTarget.format !== THREE.RGBAFormat) {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.');\r\n        return;\r\n\r\n      }\r\n\r\n      var restore = false;\r\n\r\n      if (renderTarget.__webglFramebuffer !== _currentFramebuffer) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, renderTarget.__webglFramebuffer);\r\n\r\n        restore = true;\r\n\r\n      }\r\n\r\n      if (_gl.checkFramebufferStatus(_gl.FRAMEBUFFER) === _gl.FRAMEBUFFER_COMPLETE) {\r\n\r\n        _gl.readPixels(x, y, width, height, _gl.RGBA, _gl.UNSIGNED_BYTE, buffer);\r\n\r\n      }\r\n      else {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.');\r\n\r\n      }\r\n\r\n      if (restore) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, _currentFramebuffer);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function updateRenderTargetMipmap(renderTarget) {\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_2D);\r\n      _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Fallback filters for non-power-of-2 textures\r\n\r\n  function filterFallback(f) {\r\n\r\n    if (f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter) {\r\n\r\n      return _gl.NEAREST;\r\n\r\n    }\r\n\r\n    return _gl.LINEAR;\r\n\r\n  }\r\n\r\n  // Map three.js constants to WebGL constants\r\n\r\n  function paramThreeToGL(p) {\r\n\r\n    var extension;\r\n\r\n    if (p === THREE.RepeatWrapping) return _gl.REPEAT;\r\n    if (p === THREE.ClampToEdgeWrapping) return _gl.CLAMP_TO_EDGE;\r\n    if (p === THREE.MirroredRepeatWrapping) return _gl.MIRRORED_REPEAT;\r\n\r\n    if (p === THREE.NearestFilter) return _gl.NEAREST;\r\n    if (p === THREE.NearestMipMapNearestFilter) return _gl.NEAREST_MIPMAP_NEAREST;\r\n    if (p === THREE.NearestMipMapLinearFilter) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.LinearFilter) return _gl.LINEAR;\r\n    if (p === THREE.LinearMipMapNearestFilter) return _gl.LINEAR_MIPMAP_NEAREST;\r\n    if (p === THREE.LinearMipMapLinearFilter) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.UnsignedByteType) return _gl.UNSIGNED_BYTE;\r\n    if (p === THREE.UnsignedShort4444Type) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n    if (p === THREE.UnsignedShort5551Type) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n    if (p === THREE.UnsignedShort565Type) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n    if (p === THREE.ByteType) return _gl.BYTE;\r\n    if (p === THREE.ShortType) return _gl.SHORT;\r\n    if (p === THREE.UnsignedShortType) return _gl.UNSIGNED_SHORT;\r\n    if (p === THREE.IntType) return _gl.INT;\r\n    if (p === THREE.UnsignedIntType) return _gl.UNSIGNED_INT;\r\n    if (p === THREE.FloatType) return _gl.FLOAT;\r\n\r\n    extension = extensions.get('OES_texture_half_float');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.HalfFloatType) return extension.HALF_FLOAT_OES;\r\n\r\n    }\r\n\r\n    if (p === THREE.AlphaFormat) return _gl.ALPHA;\r\n    if (p === THREE.RGBFormat) return _gl.RGB;\r\n    if (p === THREE.RGBAFormat) return _gl.RGBA;\r\n    if (p === THREE.LuminanceFormat) return _gl.LUMINANCE;\r\n    if (p === THREE.LuminanceAlphaFormat) return _gl.LUMINANCE_ALPHA;\r\n\r\n    if (p === THREE.AddEquation) return _gl.FUNC_ADD;\r\n    if (p === THREE.SubtractEquation) return _gl.FUNC_SUBTRACT;\r\n    if (p === THREE.ReverseSubtractEquation) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n    if (p === THREE.ZeroFactor) return _gl.ZERO;\r\n    if (p === THREE.OneFactor) return _gl.ONE;\r\n    if (p === THREE.SrcColorFactor) return _gl.SRC_COLOR;\r\n    if (p === THREE.OneMinusSrcColorFactor) return _gl.ONE_MINUS_SRC_COLOR;\r\n    if (p === THREE.SrcAlphaFactor) return _gl.SRC_ALPHA;\r\n    if (p === THREE.OneMinusSrcAlphaFactor) return _gl.ONE_MINUS_SRC_ALPHA;\r\n    if (p === THREE.DstAlphaFactor) return _gl.DST_ALPHA;\r\n    if (p === THREE.OneMinusDstAlphaFactor) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n    if (p === THREE.DstColorFactor) return _gl.DST_COLOR;\r\n    if (p === THREE.OneMinusDstColorFactor) return _gl.ONE_MINUS_DST_COLOR;\r\n    if (p === THREE.SrcAlphaSaturateFactor) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_S3TC_DXT1_Format) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT1_Format) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT3_Format) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT5_Format) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n    }\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGB_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_blend_minmax');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.MinEquation) return extension.MIN_EXT;\r\n      if (p === THREE.MaxEquation) return extension.MAX_EXT;\r\n\r\n    }\r\n\r\n    return 0;\r\n\r\n  }\r\n\r\n  // Allocations\r\n\r\n  function allocateBones(object) {\r\n\r\n    if (_supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n      return 1024;\r\n\r\n    }\r\n    else {\r\n\r\n      // default for when object is not specified\r\n      // ( for example when prebuilding shader\r\n      //   to be used with multiple objects )\r\n      //\r\n      //  - leave some extra space for other uniforms\r\n      //  - limit here is ANGLE's 254 max uniform vectors\r\n      //    (up to 54 should be safe)\r\n\r\n      var nVertexUniforms = _gl.getParameter(_gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n      var nVertexMatrices = Math.floor((nVertexUniforms - 20) / 4);\r\n\r\n      var maxBones = nVertexMatrices;\r\n\r\n      if (object !== undefined && object instanceof THREE.SkinnedMesh) {\r\n\r\n        maxBones = Math.min(object.skeleton.bones.length, maxBones);\r\n\r\n        if (maxBones < object.skeleton.bones.length) {\r\n\r\n          THREE.warn('WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return maxBones;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function allocateLights(lights) {\r\n\r\n    var dirLights = 0;\r\n    var pointLights = 0;\r\n    var spotLights = 0;\r\n    var hemiLights = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (light.onlyShadow || light.visible === false) continue;\r\n\r\n      if (light instanceof THREE.DirectionalLight) dirLights++;\r\n      if (light instanceof THREE.PointLight) pointLights++;\r\n      if (light instanceof THREE.SpotLight) spotLights++;\r\n      if (light instanceof THREE.HemisphereLight) hemiLights++;\r\n\r\n    }\r\n\r\n    return {\r\n      'directional': dirLights,\r\n      'point': pointLights,\r\n      'spot': spotLights,\r\n      'hemi': hemiLights\r\n    };\r\n\r\n  }\r\n\r\n  function allocateShadows(lights) {\r\n\r\n    var maxShadows = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if (light instanceof THREE.SpotLight) maxShadows++;\r\n      if (light instanceof THREE.DirectionalLight && !light.shadowCascade) maxShadows++;\r\n\r\n    }\r\n\r\n    return maxShadows;\r\n\r\n  }\r\n\r\n  // DEPRECATED\r\n\r\n  this.initMaterial = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .initMaterial() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPrePlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPostPlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.updateShadowMap = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.');\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.WebGLRenderTarget = function(width, height, options) {\r\n\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  options = options || {};\r\n\r\n  this.wrapS = options.wrapS !== undefined ? options.wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = options.wrapT !== undefined ? options.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = options.magFilter !== undefined ? options.magFilter : THREE.LinearFilter;\r\n  this.minFilter = options.minFilter !== undefined ? options.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = options.anisotropy !== undefined ? options.anisotropy : 1;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.format = options.format !== undefined ? options.format : THREE.RGBAFormat;\r\n  this.type = options.type !== undefined ? options.type : THREE.UnsignedByteType;\r\n\r\n  this.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n  this.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\r\n  this.generateMipmaps = true;\r\n\r\n  this.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n  constructor: THREE.WebGLRenderTarget,\r\n\r\n  setSize: function(width, height) {\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var tmp = new THREE.WebGLRenderTarget(this.width, this.height);\r\n\r\n    tmp.wrapS = this.wrapS;\r\n    tmp.wrapT = this.wrapT;\r\n\r\n    tmp.magFilter = this.magFilter;\r\n    tmp.minFilter = this.minFilter;\r\n\r\n    tmp.anisotropy = this.anisotropy;\r\n\r\n    tmp.offset.copy(this.offset);\r\n    tmp.repeat.copy(this.repeat);\r\n\r\n    tmp.format = this.format;\r\n    tmp.type = this.type;\r\n\r\n    tmp.depthBuffer = this.depthBuffer;\r\n    tmp.stencilBuffer = this.stencilBuffer;\r\n\r\n    tmp.generateMipmaps = this.generateMipmaps;\r\n\r\n    tmp.shareDepthFrom = this.shareDepthFrom;\r\n\r\n    return tmp;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function(width, height, options) {\r\n\r\n  THREE.WebGLRenderTarget.call(this, width, height, options);\r\n\r\n  this.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create(THREE.WebGLRenderTarget.prototype);\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLExtensions = function(gl) {\r\n\r\n  var extensions = {};\r\n\r\n  this.get = function(name) {\r\n\r\n    if (extensions[name] !== undefined) {\r\n\r\n      return extensions[name];\r\n\r\n    }\r\n\r\n    var extension;\r\n\r\n    switch (name) {\r\n\r\n      case 'EXT_texture_filter_anisotropic':\r\n        extension = gl.getExtension('EXT_texture_filter_anisotropic') || gl.getExtension('MOZ_EXT_texture_filter_anisotropic') || gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_s3tc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_s3tc') || gl.getExtension('MOZ_WEBGL_compressed_texture_s3tc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_pvrtc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_pvrtc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');\r\n        break;\r\n\r\n      default:\r\n        extension = gl.getExtension(name);\r\n\r\n    }\r\n\r\n    if (extension === null) {\r\n\r\n      THREE.warn('THREE.WebGLRenderer: ' + name + ' extension not supported.');\r\n\r\n    }\r\n\r\n    extensions[name] = extension;\r\n\r\n    return extension;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = (function() {\r\n\r\n  var programIdCount = 0;\r\n\r\n  var generateDefines = function(defines) {\r\n\r\n    var value, chunk, chunks = [];\r\n\r\n    for (var d in defines) {\r\n\r\n      value = defines[d];\r\n      if (value === false) continue;\r\n\r\n      chunk = '#define ' + d + ' ' + value;\r\n      chunks.push(chunk);\r\n\r\n    }\r\n\r\n    return chunks.join('\\n');\r\n\r\n  };\r\n\r\n  var cacheUniformLocations = function(gl, program, identifiers) {\r\n\r\n    var uniforms = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      uniforms[id] = gl.getUniformLocation(program, id);\r\n\r\n    }\r\n\r\n    return uniforms;\r\n\r\n  };\r\n\r\n  var cacheAttributeLocations = function(gl, program, identifiers) {\r\n\r\n    var attributes = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      attributes[id] = gl.getAttribLocation(program, id);\r\n\r\n    }\r\n\r\n    return attributes;\r\n\r\n  };\r\n\r\n  return function(renderer, code, material, parameters) {\r\n\r\n    var _this = renderer;\r\n    var _gl = _this.context;\r\n\r\n    var defines = material.defines;\r\n    var uniforms = material.__webglShader.uniforms;\r\n    var attributes = material.attributes;\r\n\r\n    var vertexShader = material.__webglShader.vertexShader;\r\n    var fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n    var index0AttributeName = material.index0AttributeName;\r\n\r\n    if (index0AttributeName === undefined && parameters.morphTargets === true) {\r\n\r\n      // programs with morphTargets displace position out of attribute 0\r\n\r\n      index0AttributeName = 'position';\r\n\r\n    }\r\n\r\n    var shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n    if (parameters.shadowMapType === THREE.PCFShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n    }\r\n    else if (parameters.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n    }\r\n\r\n    var envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n    var envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n    var envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n    if (parameters.envMap) {\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeReflectionMapping:\r\n        case THREE.CubeRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n          break;\r\n\r\n        case THREE.EquirectangularReflectionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n          break;\r\n\r\n        case THREE.SphericalReflectionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeRefractionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.combine) {\r\n\r\n        case THREE.MultiplyOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n          break;\r\n\r\n        case THREE.MixOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n          break;\r\n\r\n        case THREE.AddOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n          break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var gammaFactorDefine = (renderer.gammaFactor > 0) ? renderer.gammaFactor : 1.0;\r\n\r\n    // console.log( 'building new program ' );\r\n\r\n    //\r\n\r\n    var customDefines = generateDefines(defines);\r\n\r\n    //\r\n\r\n    var program = _gl.createProgram();\r\n\r\n    var prefix_vertex, prefix_fragment;\r\n\r\n    if (material instanceof THREE.RawShaderMaterial) {\r\n\r\n      prefix_vertex = '';\r\n      prefix_fragment = '';\r\n\r\n    }\r\n    else {\r\n\r\n      prefix_vertex = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        customDefines,\r\n\r\n        parameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        '#define MAX_BONES ' + parameters.maxBones,\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.skinning ? '#define USE_SKINNING' : '',\r\n        parameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n        parameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n        parameters.morphNormals ? '#define USE_MORPHNORMALS' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\r\n        'uniform mat4 modelMatrix;',\r\n        'uniform mat4 modelViewMatrix;',\r\n        'uniform mat4 projectionMatrix;',\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform mat3 normalMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n\r\n        'attribute vec3 position;',\r\n        'attribute vec3 normal;',\r\n        'attribute vec2 uv;',\r\n        'attribute vec2 uv2;',\r\n\r\n        '#ifdef USE_COLOR',\r\n\r\n        '\tattribute vec3 color;',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_MORPHTARGETS',\r\n\r\n        '\tattribute vec3 morphTarget0;',\r\n        '\tattribute vec3 morphTarget1;',\r\n        '\tattribute vec3 morphTarget2;',\r\n        '\tattribute vec3 morphTarget3;',\r\n\r\n        '\t#ifdef USE_MORPHNORMALS',\r\n\r\n        '\t\tattribute vec3 morphNormal0;',\r\n        '\t\tattribute vec3 morphNormal1;',\r\n        '\t\tattribute vec3 morphNormal2;',\r\n        '\t\tattribute vec3 morphNormal3;',\r\n\r\n        '\t#else',\r\n\r\n        '\t\tattribute vec3 morphTarget4;',\r\n        '\t\tattribute vec3 morphTarget5;',\r\n        '\t\tattribute vec3 morphTarget6;',\r\n        '\t\tattribute vec3 morphTarget7;',\r\n\r\n        '\t#endif',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_SKINNING',\r\n\r\n        '\tattribute vec4 skinIndex;',\r\n        '\tattribute vec4 skinWeight;',\r\n\r\n        '#endif',\r\n\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n      prefix_fragment = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        (parameters.bumpMap || parameters.normalMap || parameters.flatShading) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\r\n        customDefines,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        parameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        (parameters.useFog && parameters.fog) ? '#define USE_FOG' : '', (parameters.useFog && parameters.fogExp) ? '#define FOG_EXP2' : '',\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.metal ? '#define METAL' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n    }\r\n\r\n    var glVertexShader = new THREE.WebGLShader(_gl, _gl.VERTEX_SHADER, prefix_vertex + vertexShader);\r\n    var glFragmentShader = new THREE.WebGLShader(_gl, _gl.FRAGMENT_SHADER, prefix_fragment + fragmentShader);\r\n\r\n    _gl.attachShader(program, glVertexShader);\r\n    _gl.attachShader(program, glFragmentShader);\r\n\r\n    if (index0AttributeName !== undefined) {\r\n\r\n      // Force a particular attribute to index 0.\r\n      // because potentially expensive emulation is done by browser if attribute 0 is disabled.\r\n      // And, color, for example is often automatically bound to index 0 so disabling it\r\n\r\n      _gl.bindAttribLocation(program, 0, index0AttributeName);\r\n\r\n    }\r\n\r\n    _gl.linkProgram(program);\r\n\r\n    var programLogInfo = _gl.getProgramInfoLog(program);\r\n\r\n    if (_gl.getProgramParameter(program, _gl.LINK_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLProgram: shader error: ' + _gl.getError(), 'gl.VALIDATE_STATUS', _gl.getProgramParameter(program, _gl.VALIDATE_STATUS), 'gl.getPRogramInfoLog', programLogInfo);\r\n\r\n    }\r\n\r\n    if (programLogInfo !== '') {\r\n\r\n      THREE.warn('THREE.WebGLProgram: gl.getProgramInfoLog()' + programLogInfo);\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n    }\r\n\r\n    // clean up\r\n\r\n    _gl.deleteShader(glVertexShader);\r\n    _gl.deleteShader(glFragmentShader);\r\n\r\n    // cache uniform locations\r\n\r\n    var identifiers = [\r\n\r\n      'viewMatrix',\r\n      'modelViewMatrix',\r\n      'projectionMatrix',\r\n      'normalMatrix',\r\n      'modelMatrix',\r\n      'cameraPosition',\r\n      'morphTargetInfluences',\r\n      'bindMatrix',\r\n      'bindMatrixInverse'\r\n\r\n    ];\r\n\r\n    if (parameters.useVertexTexture) {\r\n\r\n      identifiers.push('boneTexture');\r\n      identifiers.push('boneTextureWidth');\r\n      identifiers.push('boneTextureHeight');\r\n\r\n    }\r\n    else {\r\n\r\n      identifiers.push('boneGlobalMatrices');\r\n\r\n    }\r\n\r\n    if (parameters.logarithmicDepthBuffer) {\r\n\r\n      identifiers.push('logDepthBufFC');\r\n\r\n    }\r\n\r\n\r\n    for (var u in uniforms) {\r\n\r\n      identifiers.push(u);\r\n\r\n    }\r\n\r\n    this.uniforms = cacheUniformLocations(_gl, program, identifiers);\r\n\r\n    // cache attributes locations\r\n\r\n    identifiers = [\r\n\r\n      'position',\r\n      'normal',\r\n      'uv',\r\n      'uv2',\r\n      'tangent',\r\n      'color',\r\n      'skinIndex',\r\n      'skinWeight',\r\n      'lineDistance'\r\n\r\n    ];\r\n\r\n    for (var i = 0; i < parameters.maxMorphTargets; i++) {\r\n\r\n      identifiers.push('morphTarget' + i);\r\n\r\n    }\r\n\r\n    for (var i = 0; i < parameters.maxMorphNormals; i++) {\r\n\r\n      identifiers.push('morphNormal' + i);\r\n\r\n    }\r\n\r\n    for (var a in attributes) {\r\n\r\n      identifiers.push(a);\r\n\r\n    }\r\n\r\n    this.attributes = cacheAttributeLocations(_gl, program, identifiers);\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n    //\r\n\r\n    this.id = programIdCount++;\r\n    this.code = code;\r\n    this.usedTimes = 1;\r\n    this.program = program;\r\n    this.vertexShader = glVertexShader;\r\n    this.fragmentShader = glFragmentShader;\r\n\r\n    return this;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = (function() {\r\n\r\n  var addLineNumbers = function(string) {\r\n\r\n    var lines = string.split('\\n');\r\n\r\n    for (var i = 0; i < lines.length; i++) {\r\n\r\n      lines[i] = (i + 1) + ': ' + lines[i];\r\n\r\n    }\r\n\r\n    return lines.join('\\n');\r\n\r\n  };\r\n\r\n  return function(gl, type, string) {\r\n\r\n    var shader = gl.createShader(type);\r\n\r\n    gl.shaderSource(shader, string);\r\n    gl.compileShader(shader);\r\n\r\n    if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLShader: Shader couldn\\'t compile.');\r\n\r\n    }\r\n\r\n    if (gl.getShaderInfoLog(shader) !== '') {\r\n\r\n      THREE.warn('THREE.WebGLShader: gl.getShaderInfoLog()', gl.getShaderInfoLog(shader), addLineNumbers(string));\r\n\r\n    }\r\n\r\n    // --enable-privileged-webgl-extension\r\n    // console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n    return shader;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLState = function(gl, paramThreeToGL) {\r\n\r\n  var newAttributes = new Uint8Array(16);\r\n  var enabledAttributes = new Uint8Array(16);\r\n\r\n  var currentBlending = null;\r\n  var currentBlendEquation = null;\r\n  var currentBlendSrc = null;\r\n  var currentBlendDst = null;\r\n  var currentBlendEquationAlpha = null;\r\n  var currentBlendSrcAlpha = null;\r\n  var currentBlendDstAlpha = null;\r\n\r\n  var currentDepthTest = null;\r\n  var currentDepthWrite = null;\r\n\r\n  var currentColorWrite = null;\r\n\r\n  var currentDoubleSided = null;\r\n  var currentFlipSided = null;\r\n\r\n  var currentLineWidth = null;\r\n\r\n  var currentPolygonOffset = null;\r\n  var currentPolygonOffsetFactor = null;\r\n  var currentPolygonOffsetUnits = null;\r\n\r\n  this.initAttributes = function() {\r\n\r\n    for (var i = 0, l = newAttributes.length; i < l; i++) {\r\n\r\n      newAttributes[i] = 0;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.enableAttribute = function(attribute) {\r\n\r\n    newAttributes[attribute] = 1;\r\n\r\n    if (enabledAttributes[attribute] === 0) {\r\n\r\n      gl.enableVertexAttribArray(attribute);\r\n      enabledAttributes[attribute] = 1;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.disableUnusedAttributes = function() {\r\n\r\n    for (var i = 0, l = enabledAttributes.length; i < l; i++) {\r\n\r\n      if (enabledAttributes[i] !== newAttributes[i]) {\r\n\r\n        gl.disableVertexAttribArray(i);\r\n        enabledAttributes[i] = 0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setBlending = function(blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha) {\r\n\r\n    if (blending !== currentBlending) {\r\n\r\n      if (blending === THREE.NoBlending) {\r\n\r\n        gl.disable(gl.BLEND);\r\n\r\n      }\r\n      else if (blending === THREE.AdditiveBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\r\n\r\n      }\r\n      else if (blending === THREE.SubtractiveBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.MultiplyBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.CustomBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      }\r\n\r\n      currentBlending = blending;\r\n\r\n    }\r\n\r\n    if (blending === THREE.CustomBlending) {\r\n\r\n      blendEquationAlpha = blendEquationAlpha || blendEquation;\r\n      blendSrcAlpha = blendSrcAlpha || blendSrc;\r\n      blendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n      if (blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha) {\r\n\r\n        gl.blendEquationSeparate(paramThreeToGL(blendEquation), paramThreeToGL(blendEquationAlpha));\r\n\r\n        currentBlendEquation = blendEquation;\r\n        currentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n      }\r\n\r\n      if (blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha) {\r\n\r\n        gl.blendFuncSeparate(paramThreeToGL(blendSrc), paramThreeToGL(blendDst), paramThreeToGL(blendSrcAlpha), paramThreeToGL(blendDstAlpha));\r\n\r\n        currentBlendSrc = blendSrc;\r\n        currentBlendDst = blendDst;\r\n        currentBlendSrcAlpha = blendSrcAlpha;\r\n        currentBlendDstAlpha = blendDstAlpha;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      currentBlendEquation = null;\r\n      currentBlendSrc = null;\r\n      currentBlendDst = null;\r\n      currentBlendEquationAlpha = null;\r\n      currentBlendSrcAlpha = null;\r\n      currentBlendDstAlpha = null;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthTest = function(depthTest) {\r\n\r\n    if (currentDepthTest !== depthTest) {\r\n\r\n      if (depthTest) {\r\n\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n      }\r\n\r\n      currentDepthTest = depthTest;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthWrite = function(depthWrite) {\r\n\r\n    if (currentDepthWrite !== depthWrite) {\r\n\r\n      gl.depthMask(depthWrite);\r\n      currentDepthWrite = depthWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setColorWrite = function(colorWrite) {\r\n\r\n    if (currentColorWrite !== colorWrite) {\r\n\r\n      gl.colorMask(colorWrite, colorWrite, colorWrite, colorWrite);\r\n      currentColorWrite = colorWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDoubleSided = function(doubleSided) {\r\n\r\n    if (currentDoubleSided !== doubleSided) {\r\n\r\n      if (doubleSided) {\r\n\r\n        gl.disable(gl.CULL_FACE);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.CULL_FACE);\r\n\r\n      }\r\n\r\n      currentDoubleSided = doubleSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setFlipSided = function(flipSided) {\r\n\r\n    if (currentFlipSided !== flipSided) {\r\n\r\n      if (flipSided) {\r\n\r\n        gl.frontFace(gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.frontFace(gl.CCW);\r\n\r\n      }\r\n\r\n      currentFlipSided = flipSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setLineWidth = function(width) {\r\n\r\n    if (width !== currentLineWidth) {\r\n\r\n      gl.lineWidth(width);\r\n\r\n      currentLineWidth = width;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setPolygonOffset = function(polygonoffset, factor, units) {\r\n\r\n    if (currentPolygonOffset !== polygonoffset) {\r\n\r\n      if (polygonoffset) {\r\n\r\n        gl.enable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n\r\n      currentPolygonOffset = polygonoffset;\r\n\r\n    }\r\n\r\n    if (polygonoffset && (currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units)) {\r\n\r\n      gl.polygonOffset(factor, units);\r\n\r\n      currentPolygonOffsetFactor = factor;\r\n      currentPolygonOffsetUnits = units;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.reset = function() {\r\n\r\n    for (var i = 0; i < enabledAttributes.length; i++) {\r\n\r\n      enabledAttributes[i] = 0;\r\n\r\n    }\r\n\r\n    currentBlending = null;\r\n    currentDepthTest = null;\r\n    currentDepthWrite = null;\r\n    currentColorWrite = null;\r\n    currentDoubleSided = null;\r\n    currentFlipSided = null;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function(renderer, flares) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n  var hasVertexTexture;\r\n\r\n  var tempTexture, occlusionTexture;\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-1, -1, 0, 0,\r\n      1, -1, 1, 0,\r\n      1, 1, 1, 1, -1, 1, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    // buffers\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    // textures\r\n\r\n    tempTexture = gl.createTexture();\r\n    occlusionTexture = gl.createTexture();\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    hasVertexTexture = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;\r\n\r\n    var shader;\r\n\r\n    if (hasVertexTexture) {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"uniform sampler2D occlusionMap;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n          \"vVisibility =        visibility.r / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n          \"vVisibility *=       visibility.b / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * vVisibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n    else {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"precision mediump float;\",\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform sampler2D occlusionMap;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n          \"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * visibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n\r\n    program = createProgram(shader);\r\n\r\n    attributes = {\r\n      vertex: gl.getAttribLocation(program, \"position\"),\r\n      uv: gl.getAttribLocation(program, \"uv\")\r\n    }\r\n\r\n    uniforms = {\r\n      renderType: gl.getUniformLocation(program, \"renderType\"),\r\n      map: gl.getUniformLocation(program, \"map\"),\r\n      occlusionMap: gl.getUniformLocation(program, \"occlusionMap\"),\r\n      opacity: gl.getUniformLocation(program, \"opacity\"),\r\n      color: gl.getUniformLocation(program, \"color\"),\r\n      scale: gl.getUniformLocation(program, \"scale\"),\r\n      rotation: gl.getUniformLocation(program, \"rotation\"),\r\n      screenPosition: gl.getUniformLocation(program, \"screenPosition\")\r\n    };\r\n\r\n  };\r\n\r\n  /*\r\n   * Render lens flares\r\n   * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n   *         reads these back and calculates occlusion.\r\n   */\r\n\r\n  this.render = function(scene, camera, viewportWidth, viewportHeight) {\r\n\r\n    if (flares.length === 0) return;\r\n\r\n    var tempPosition = new THREE.Vector3();\r\n\r\n    var invAspect = viewportHeight / viewportWidth,\r\n      halfViewportWidth = viewportWidth * 0.5,\r\n      halfViewportHeight = viewportHeight * 0.5;\r\n\r\n    var size = 16 / viewportHeight,\r\n      scale = new THREE.Vector2(size * invAspect, size);\r\n\r\n    var screenPosition = new THREE.Vector3(1, 1, 0),\r\n      screenPositionPixels = new THREE.Vector2(1, 1);\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.vertex);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    // loop through all lens flares to update their occlusion and positions\r\n    // setup gl and common used attribs/unforms\r\n\r\n    gl.uniform1i(uniforms.occlusionMap, 0);\r\n    gl.uniform1i(uniforms.map, 1);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.depthMask(false);\r\n\r\n    for (var i = 0, l = flares.length; i < l; i++) {\r\n\r\n      size = 16 / viewportHeight;\r\n      scale.set(size * invAspect, size);\r\n\r\n      // calc object screen position\r\n\r\n      var flare = flares[i];\r\n\r\n      tempPosition.set(flare.matrixWorld.elements[12], flare.matrixWorld.elements[13], flare.matrixWorld.elements[14]);\r\n\r\n      tempPosition.applyMatrix4(camera.matrixWorldInverse);\r\n      tempPosition.applyProjection(camera.projectionMatrix);\r\n\r\n      // setup arrays for gl programs\r\n\r\n      screenPosition.copy(tempPosition)\r\n\r\n      screenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n      screenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\r\n      // screen cull\r\n\r\n      if (hasVertexTexture || (\r\n          screenPositionPixels.x > 0 &&\r\n          screenPositionPixels.x < viewportWidth &&\r\n          screenPositionPixels.y > 0 &&\r\n          screenPositionPixels.y < viewportHeight)) {\r\n\r\n        // save current RGB to temp texture\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // render pink quad\r\n\r\n        gl.uniform1i(uniforms.renderType, 0);\r\n        gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n        gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n\r\n        gl.disable(gl.BLEND);\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // copy result to occlusionMap\r\n\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // restore graphics\r\n\r\n        gl.uniform1i(uniforms.renderType, 1);\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // update object positions\r\n\r\n        flare.positionScreen.copy(screenPosition)\r\n\r\n        if (flare.customUpdateCallback) {\r\n\r\n          flare.customUpdateCallback(flare);\r\n\r\n        }\r\n        else {\r\n\r\n          flare.updateLensFlares();\r\n\r\n        }\r\n\r\n        // render flares\r\n\r\n        gl.uniform1i(uniforms.renderType, 2);\r\n        gl.enable(gl.BLEND);\r\n\r\n        for (var j = 0, jl = flare.lensFlares.length; j < jl; j++) {\r\n\r\n          var sprite = flare.lensFlares[j];\r\n\r\n          if (sprite.opacity > 0.001 && sprite.scale > 0.001) {\r\n\r\n            screenPosition.x = sprite.x;\r\n            screenPosition.y = sprite.y;\r\n            screenPosition.z = sprite.z;\r\n\r\n            size = sprite.size * sprite.scale / viewportHeight;\r\n\r\n            scale.x = size * invAspect;\r\n            scale.y = size;\r\n\r\n            gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n            gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n            gl.uniform1f(uniforms.rotation, sprite.rotation);\r\n\r\n            gl.uniform1f(uniforms.opacity, sprite.opacity);\r\n            gl.uniform3f(uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b);\r\n\r\n            renderer.state.setBlending(sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst);\r\n            renderer.setTexture(sprite.texture, 1);\r\n\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.enable(gl.DEPTH_TEST);\r\n    gl.depthMask(true);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram(shader) {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n\r\n    var prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n    gl.shaderSource(fragmentShader, prefix + shader.fragmentShader);\r\n    gl.shaderSource(vertexShader, prefix + shader.vertexShader);\r\n\r\n    gl.compileShader(fragmentShader);\r\n    gl.compileShader(vertexShader);\r\n\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.attachShader(program, vertexShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/ShadowMapPlugin.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ShadowMapPlugin = function(_renderer, _lights, _webglObjects, _webglObjectsImmediate) {\r\n\r\n  var _gl = _renderer.context;\r\n\r\n  var _depthMaterial, _depthMaterialMorph, _depthMaterialSkin, _depthMaterialMorphSkin,\r\n\r\n    _frustum = new THREE.Frustum(),\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _min = new THREE.Vector3(),\r\n    _max = new THREE.Vector3(),\r\n\r\n    _matrixPosition = new THREE.Vector3(),\r\n\r\n    _renderList = [];\r\n\r\n  // init\r\n\r\n  var depthShader = THREE.ShaderLib[\"depthRGBA\"];\r\n  var depthUniforms = THREE.UniformsUtils.clone(depthShader.uniforms);\r\n\r\n  _depthMaterial = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader\r\n  });\r\n\r\n  _depthMaterialMorph = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true\r\n  });\r\n\r\n  _depthMaterialSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterialMorphSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterial._shadowPass = true;\r\n  _depthMaterialMorph._shadowPass = true;\r\n  _depthMaterialSkin._shadowPass = true;\r\n  _depthMaterialMorphSkin._shadowPass = true;\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (_renderer.shadowMapEnabled === false) return;\r\n\r\n    var i, il, j, jl, n,\r\n\r\n      shadowMap, shadowMatrix, shadowCamera,\r\n      buffer, material,\r\n      webglObject, object, light,\r\n\r\n      lights = [],\r\n      k = 0,\r\n\r\n      fog = null;\r\n\r\n    // set GL state for depth map\r\n\r\n    _gl.clearColor(1, 1, 1, 1);\r\n    _gl.disable(_gl.BLEND);\r\n\r\n    _gl.enable(_gl.CULL_FACE);\r\n    _gl.frontFace(_gl.CCW);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.FRONT);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.state.setDepthTest(true);\r\n\r\n    // preprocess lights\r\n    // \t- skip lights that are not casting shadows\r\n    //\t- create virtual lights for cascaded shadow maps\r\n\r\n    for (i = 0, il = _lights.length; i < il; i++) {\r\n\r\n      light = _lights[i];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if ((light instanceof THREE.DirectionalLight) && light.shadowCascade) {\r\n\r\n        for (n = 0; n < light.shadowCascadeCount; n++) {\r\n\r\n          var virtualLight;\r\n\r\n          if (!light.shadowCascadeArray[n]) {\r\n\r\n            virtualLight = createVirtualLight(light, n);\r\n            virtualLight.originalCamera = camera;\r\n\r\n            var gyro = new THREE.Gyroscope();\r\n            gyro.position.copy(light.shadowCascadeOffset);\r\n\r\n            gyro.add(virtualLight);\r\n            gyro.add(virtualLight.target);\r\n\r\n            camera.add(gyro);\r\n\r\n            light.shadowCascadeArray[n] = virtualLight;\r\n\r\n            //console.log( \"Created virtualLight\", virtualLight );\r\n\r\n          }\r\n          else {\r\n\r\n            virtualLight = light.shadowCascadeArray[n];\r\n\r\n          }\r\n\r\n          updateVirtualLight(light, n);\r\n\r\n          lights[k] = virtualLight;\r\n          k++;\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        lights[k] = light;\r\n        k++;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // render depth map\r\n\r\n    for (i = 0, il = lights.length; i < il; i++) {\r\n\r\n      light = lights[i];\r\n\r\n      if (!light.shadowMap) {\r\n\r\n        var shadowFilter = THREE.LinearFilter;\r\n\r\n        if (_renderer.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n          shadowFilter = THREE.NearestFilter;\r\n\r\n        }\r\n\r\n        var pars = {\r\n          minFilter: shadowFilter,\r\n          magFilter: shadowFilter,\r\n          format: THREE.RGBAFormat\r\n        };\r\n\r\n        light.shadowMap = new THREE.WebGLRenderTarget(light.shadowMapWidth, light.shadowMapHeight, pars);\r\n        light.shadowMapSize = new THREE.Vector2(light.shadowMapWidth, light.shadowMapHeight);\r\n\r\n        light.shadowMatrix = new THREE.Matrix4();\r\n\r\n      }\r\n\r\n      if (!light.shadowCamera) {\r\n\r\n        if (light instanceof THREE.SpotLight) {\r\n\r\n          light.shadowCamera = new THREE.PerspectiveCamera(light.shadowCameraFov, light.shadowMapWidth / light.shadowMapHeight, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else if (light instanceof THREE.DirectionalLight) {\r\n\r\n          light.shadowCamera = new THREE.OrthographicCamera(light.shadowCameraLeft, light.shadowCameraRight, light.shadowCameraTop, light.shadowCameraBottom, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error(\"THREE.ShadowMapPlugin: Unsupported light type for shadow\", light);\r\n          continue;\r\n\r\n        }\r\n\r\n        scene.add(light.shadowCamera);\r\n\r\n        if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n      }\r\n\r\n      if (light.shadowCameraVisible && !light.cameraHelper) {\r\n\r\n        light.cameraHelper = new THREE.CameraHelper(light.shadowCamera);\r\n        scene.add(light.cameraHelper);\r\n\r\n      }\r\n\r\n      if (light.isVirtual && virtualLight.originalCamera == camera) {\r\n\r\n        updateShadowCamera(camera, light);\r\n\r\n      }\r\n\r\n      shadowMap = light.shadowMap;\r\n      shadowMatrix = light.shadowMatrix;\r\n      shadowCamera = light.shadowCamera;\r\n\r\n      //\r\n\r\n      shadowCamera.position.setFromMatrixPosition(light.matrixWorld);\r\n      _matrixPosition.setFromMatrixPosition(light.target.matrixWorld);\r\n      shadowCamera.lookAt(_matrixPosition);\r\n      shadowCamera.updateMatrixWorld();\r\n\r\n      shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld);\r\n\r\n      //\r\n\r\n      if (light.cameraHelper) light.cameraHelper.visible = light.shadowCameraVisible;\r\n      if (light.shadowCameraVisible) light.cameraHelper.update();\r\n\r\n      // compute shadow matrix\r\n\r\n      shadowMatrix.set(\r\n        0.5, 0.0, 0.0, 0.5,\r\n        0.0, 0.5, 0.0, 0.5,\r\n        0.0, 0.0, 0.5, 0.5,\r\n        0.0, 0.0, 0.0, 1.0\r\n      );\r\n\r\n      shadowMatrix.multiply(shadowCamera.projectionMatrix);\r\n      shadowMatrix.multiply(shadowCamera.matrixWorldInverse);\r\n\r\n      // update camera matrices and frustum\r\n\r\n      _projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse);\r\n      _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n      // render shadow map\r\n\r\n      _renderer.setRenderTarget(shadowMap);\r\n      _renderer.clear();\r\n\r\n      // set object matrices & frustum culling\r\n\r\n      _renderList.length = 0;\r\n\r\n      projectObject(scene, scene, shadowCamera);\r\n\r\n\r\n      // render regular objects\r\n\r\n      var objectMaterial, useMorphing, useSkinning;\r\n\r\n      for (j = 0, jl = _renderList.length; j < jl; j++) {\r\n\r\n        webglObject = _renderList[j];\r\n\r\n        object = webglObject.object;\r\n        buffer = webglObject.buffer;\r\n\r\n        // culling is overriden globally for all objects\r\n        // while rendering depth map\r\n\r\n        // need to deal with MeshFaceMaterial somehow\r\n        // in that case just use the first of material.materials for now\r\n        // (proper solution would require to break objects by materials\r\n        //  similarly to regular rendering and then set corresponding\r\n        //  depth materials per each chunk instead of just once per object)\r\n\r\n        objectMaterial = getObjectMaterial(object);\r\n\r\n        useMorphing = object.geometry.morphTargets !== undefined && object.geometry.morphTargets.length > 0 && objectMaterial.morphTargets;\r\n        useSkinning = object instanceof THREE.SkinnedMesh && objectMaterial.skinning;\r\n\r\n        if (object.customDepthMaterial) {\r\n\r\n          material = object.customDepthMaterial;\r\n\r\n        }\r\n        else if (useSkinning) {\r\n\r\n          material = useMorphing ? _depthMaterialMorphSkin : _depthMaterialSkin;\r\n\r\n        }\r\n        else if (useMorphing) {\r\n\r\n          material = _depthMaterialMorph;\r\n\r\n        }\r\n        else {\r\n\r\n          material = _depthMaterial;\r\n\r\n        }\r\n\r\n        _renderer.setMaterialFaces(objectMaterial);\r\n\r\n        if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n          _renderer.renderBufferDirect(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n        else {\r\n\r\n          _renderer.renderBuffer(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // set matrices and render immediate objects\r\n\r\n      for (j = 0, jl = _webglObjectsImmediate.length; j < jl; j++) {\r\n\r\n        webglObject = _webglObjectsImmediate[j];\r\n        object = webglObject.object;\r\n\r\n        if (object.visible && object.castShadow) {\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n\r\n          _renderer.renderImmediateObject(shadowCamera, _lights, fog, _depthMaterial, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore GL state\r\n\r\n    var clearColor = _renderer.getClearColor(),\r\n      clearAlpha = _renderer.getClearAlpha();\r\n\r\n    _gl.clearColor(clearColor.r, clearColor.g, clearColor.b, clearAlpha);\r\n    _gl.enable(_gl.BLEND);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function projectObject(scene, object, shadowCamera) {\r\n\r\n    if (object.visible) {\r\n\r\n      var webglObjects = _webglObjects[object.id];\r\n\r\n      if (webglObjects && object.castShadow && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n        for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n          var webglObject = webglObjects[i];\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n          _renderList.push(webglObject);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n        projectObject(scene, object.children[i], shadowCamera);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function createVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = new THREE.DirectionalLight();\r\n\r\n    virtualLight.isVirtual = true;\r\n\r\n    virtualLight.onlyShadow = true;\r\n    virtualLight.castShadow = true;\r\n\r\n    virtualLight.shadowCameraNear = light.shadowCameraNear;\r\n    virtualLight.shadowCameraFar = light.shadowCameraFar;\r\n\r\n    virtualLight.shadowCameraLeft = light.shadowCameraLeft;\r\n    virtualLight.shadowCameraRight = light.shadowCameraRight;\r\n    virtualLight.shadowCameraBottom = light.shadowCameraBottom;\r\n    virtualLight.shadowCameraTop = light.shadowCameraTop;\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n    virtualLight.shadowMapWidth = light.shadowCascadeWidth[cascade];\r\n    virtualLight.shadowMapHeight = light.shadowCascadeHeight[cascade];\r\n\r\n    virtualLight.pointsWorld = [];\r\n    virtualLight.pointsFrustum = [];\r\n\r\n    var pointsWorld = virtualLight.pointsWorld,\r\n      pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      pointsWorld[i] = new THREE.Vector3();\r\n      pointsFrustum[i] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    pointsFrustum[0].set(-1, -1, nearZ);\r\n    pointsFrustum[1].set(1, -1, nearZ);\r\n    pointsFrustum[2].set(-1, 1, nearZ);\r\n    pointsFrustum[3].set(1, 1, nearZ);\r\n\r\n    pointsFrustum[4].set(-1, -1, farZ);\r\n    pointsFrustum[5].set(1, -1, farZ);\r\n    pointsFrustum[6].set(-1, 1, farZ);\r\n    pointsFrustum[7].set(1, 1, farZ);\r\n\r\n    return virtualLight;\r\n\r\n  }\r\n\r\n  // Synchronize virtual light with the original light\r\n\r\n  function updateVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = light.shadowCascadeArray[cascade];\r\n\r\n    virtualLight.position.copy(light.position);\r\n    virtualLight.target.position.copy(light.target.position);\r\n    virtualLight.lookAt(virtualLight.target);\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    var pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    pointsFrustum[0].z = nearZ;\r\n    pointsFrustum[1].z = nearZ;\r\n    pointsFrustum[2].z = nearZ;\r\n    pointsFrustum[3].z = nearZ;\r\n\r\n    pointsFrustum[4].z = farZ;\r\n    pointsFrustum[5].z = farZ;\r\n    pointsFrustum[6].z = farZ;\r\n    pointsFrustum[7].z = farZ;\r\n\r\n  }\r\n\r\n  // Fit shadow camera's ortho frustum to camera frustum\r\n\r\n  function updateShadowCamera(camera, light) {\r\n\r\n    var shadowCamera = light.shadowCamera,\r\n      pointsFrustum = light.pointsFrustum,\r\n      pointsWorld = light.pointsWorld;\r\n\r\n    _min.set(Infinity, Infinity, Infinity);\r\n    _max.set(-Infinity, -Infinity, -Infinity);\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      var p = pointsWorld[i];\r\n\r\n      p.copy(pointsFrustum[i]);\r\n      p.unproject(camera);\r\n\r\n      p.applyMatrix4(shadowCamera.matrixWorldInverse);\r\n\r\n      if (p.x < _min.x) _min.x = p.x;\r\n      if (p.x > _max.x) _max.x = p.x;\r\n\r\n      if (p.y < _min.y) _min.y = p.y;\r\n      if (p.y > _max.y) _max.y = p.y;\r\n\r\n      if (p.z < _min.z) _min.z = p.z;\r\n      if (p.z > _max.z) _max.z = p.z;\r\n\r\n    }\r\n\r\n    shadowCamera.left = _min.x;\r\n    shadowCamera.right = _max.x;\r\n    shadowCamera.top = _max.y;\r\n    shadowCamera.bottom = _min.y;\r\n\r\n    // can't really fit near/far\r\n    //shadowCamera.near = _min.z;\r\n    //shadowCamera.far = _max.z;\r\n\r\n    shadowCamera.updateProjectionMatrix();\r\n\r\n  }\r\n\r\n  // For the moment just ignore objects that have multiple materials with different animation methods\r\n  // Only the first material will be taken into account for deciding which depth material to use for shadow maps\r\n\r\n  function getObjectMaterial(object) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[0] : object.material;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function(renderer, sprites) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n\r\n  var texture;\r\n\r\n  // decompose matrixWorld\r\n\r\n  var spritePosition = new THREE.Vector3();\r\n  var spriteRotation = new THREE.Quaternion();\r\n  var spriteScale = new THREE.Vector3();\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-0.5, -0.5, 0, 0,\r\n      0.5, -0.5, 1, 0,\r\n      0.5, 0.5, 1, 1, -0.5, 0.5, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    program = createProgram();\r\n\r\n    attributes = {\r\n      position: gl.getAttribLocation(program, 'position'),\r\n      uv: gl.getAttribLocation(program, 'uv')\r\n    };\r\n\r\n    uniforms = {\r\n      uvOffset: gl.getUniformLocation(program, 'uvOffset'),\r\n      uvScale: gl.getUniformLocation(program, 'uvScale'),\r\n\r\n      rotation: gl.getUniformLocation(program, 'rotation'),\r\n      scale: gl.getUniformLocation(program, 'scale'),\r\n\r\n      color: gl.getUniformLocation(program, 'color'),\r\n      map: gl.getUniformLocation(program, 'map'),\r\n      opacity: gl.getUniformLocation(program, 'opacity'),\r\n\r\n      modelViewMatrix: gl.getUniformLocation(program, 'modelViewMatrix'),\r\n      projectionMatrix: gl.getUniformLocation(program, 'projectionMatrix'),\r\n\r\n      fogType: gl.getUniformLocation(program, 'fogType'),\r\n      fogDensity: gl.getUniformLocation(program, 'fogDensity'),\r\n      fogNear: gl.getUniformLocation(program, 'fogNear'),\r\n      fogFar: gl.getUniformLocation(program, 'fogFar'),\r\n      fogColor: gl.getUniformLocation(program, 'fogColor'),\r\n\r\n      alphaTest: gl.getUniformLocation(program, 'alphaTest')\r\n    };\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 8;\r\n    canvas.height = 8;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.fillStyle = 'white';\r\n    context.fillRect(0, 0, 8, 8);\r\n\r\n    texture = new THREE.Texture(canvas);\r\n    texture.needsUpdate = true;\r\n\r\n  };\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (sprites.length === 0) return;\r\n\r\n    // setup gl\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.position);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.enable(gl.BLEND);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.position, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.uniformMatrix4fv(uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n    gl.activeTexture(gl.TEXTURE0);\r\n    gl.uniform1i(uniforms.map, 0);\r\n\r\n    var oldFogType = 0;\r\n    var sceneFogType = 0;\r\n    var fog = scene.fog;\r\n\r\n    if (fog) {\r\n\r\n      gl.uniform3f(uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b);\r\n\r\n      if (fog instanceof THREE.Fog) {\r\n\r\n        gl.uniform1f(uniforms.fogNear, fog.near);\r\n        gl.uniform1f(uniforms.fogFar, fog.far);\r\n\r\n        gl.uniform1i(uniforms.fogType, 1);\r\n        oldFogType = 1;\r\n        sceneFogType = 1;\r\n\r\n      }\r\n      else if (fog instanceof THREE.FogExp2) {\r\n\r\n        gl.uniform1f(uniforms.fogDensity, fog.density);\r\n\r\n        gl.uniform1i(uniforms.fogType, 2);\r\n        oldFogType = 2;\r\n        sceneFogType = 2;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      gl.uniform1i(uniforms.fogType, 0);\r\n      oldFogType = 0;\r\n      sceneFogType = 0;\r\n\r\n    }\r\n\r\n\r\n    // update positions and sort\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n\r\n      sprite._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, sprite.matrixWorld);\r\n      sprite.z = -sprite._modelViewMatrix.elements[14];\r\n\r\n    }\r\n\r\n    sprites.sort(painterSortStable);\r\n\r\n    // render all sprites\r\n\r\n    var scale = [];\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n      var material = sprite.material;\r\n\r\n      gl.uniform1f(uniforms.alphaTest, material.alphaTest);\r\n      gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, sprite._modelViewMatrix.elements);\r\n\r\n      sprite.matrixWorld.decompose(spritePosition, spriteRotation, spriteScale);\r\n\r\n      scale[0] = spriteScale.x;\r\n      scale[1] = spriteScale.y;\r\n\r\n      var fogType = 0;\r\n\r\n      if (scene.fog && material.fog) {\r\n\r\n        fogType = sceneFogType;\r\n\r\n      }\r\n\r\n      if (oldFogType !== fogType) {\r\n\r\n        gl.uniform1i(uniforms.fogType, fogType);\r\n        oldFogType = fogType;\r\n\r\n      }\r\n\r\n      if (material.map !== null) {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, material.map.offset.x, material.map.offset.y);\r\n        gl.uniform2f(uniforms.uvScale, material.map.repeat.x, material.map.repeat.y);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, 0, 0);\r\n        gl.uniform2f(uniforms.uvScale, 1, 1);\r\n\r\n      }\r\n\r\n      gl.uniform1f(uniforms.opacity, material.opacity);\r\n      gl.uniform3f(uniforms.color, material.color.r, material.color.g, material.color.b);\r\n\r\n      gl.uniform1f(uniforms.rotation, material.rotation);\r\n      gl.uniform2fv(uniforms.scale, scale);\r\n\r\n      renderer.state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst);\r\n      renderer.state.setDepthTest(material.depthTest);\r\n      renderer.state.setDepthWrite(material.depthWrite);\r\n\r\n      if (material.map && material.map.image && material.map.image.width) {\r\n\r\n        renderer.setTexture(material.map, 0);\r\n\r\n      }\r\n      else {\r\n\r\n        renderer.setTexture(texture, 0);\r\n\r\n      }\r\n\r\n      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram() {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n\r\n    gl.shaderSource(vertexShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform mat4 modelViewMatrix;',\r\n      'uniform mat4 projectionMatrix;',\r\n      'uniform float rotation;',\r\n      'uniform vec2 scale;',\r\n      'uniform vec2 uvOffset;',\r\n      'uniform vec2 uvScale;',\r\n\r\n      'attribute vec2 position;',\r\n      'attribute vec2 uv;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vUV = uvOffset + uv * uvScale;',\r\n\r\n      'vec2 alignedPosition = position * scale;',\r\n\r\n      'vec2 rotatedPosition;',\r\n      'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n      'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n      'vec4 finalPosition;',\r\n\r\n      'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n      'finalPosition.xy += rotatedPosition;',\r\n      'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n      'gl_Position = finalPosition;',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.shaderSource(fragmentShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform vec3 color;',\r\n      'uniform sampler2D map;',\r\n      'uniform float opacity;',\r\n\r\n      'uniform int fogType;',\r\n      'uniform vec3 fogColor;',\r\n      'uniform float fogDensity;',\r\n      'uniform float fogNear;',\r\n      'uniform float fogFar;',\r\n      'uniform float alphaTest;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vec4 texture = texture2D( map, vUV );',\r\n\r\n      'if ( texture.a < alphaTest ) discard;',\r\n\r\n      'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n      'if ( fogType > 0 ) {',\r\n\r\n      'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n      'float fogFactor = 0.0;',\r\n\r\n      'if ( fogType == 1 ) {',\r\n\r\n      'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n      '} else {',\r\n\r\n      'const float LOG2 = 1.442695;',\r\n      'float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n      'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n      '}',\r\n\r\n      'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n      '}',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.compileShader(vertexShader);\r\n    gl.compileShader(fragmentShader);\r\n\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  };\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return b.id - a.id;\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/extras/GeometryUtils.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n  merge: function(geometry1, geometry2, materialIndexOffset) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');\r\n\r\n    var matrix;\r\n\r\n    if (geometry2 instanceof THREE.Mesh) {\r\n\r\n      geometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n      matrix = geometry2.matrix;\r\n      geometry2 = geometry2.geometry;\r\n\r\n    }\r\n\r\n    geometry1.merge(geometry2, matrix, materialIndexOffset);\r\n\r\n  },\r\n\r\n  center: function(geometry) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.');\r\n    return geometry.center();\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/ImageUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n */\r\n\r\nTHREE.ImageUtils = {\r\n\r\n  crossOrigin: undefined,\r\n\r\n  loadTexture: function(url, mapping, onLoad, onError) {\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.Texture(undefined, mapping);\r\n\r\n    loader.load(url, function(image) {\r\n\r\n      texture.image = image;\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture);\r\n\r\n    }, undefined, function(event) {\r\n\r\n      if (onError) onError(event);\r\n\r\n    });\r\n\r\n    texture.sourceFile = url;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadTextureCube: function(array, mapping, onLoad, onError) {\r\n\r\n    var images = [];\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.CubeTexture(images, mapping);\r\n\r\n    // no flipping needed for cube textures\r\n\r\n    texture.flipY = false;\r\n\r\n    var loaded = 0;\r\n\r\n    var loadTexture = function(i) {\r\n\r\n      loader.load(array[i], function(image) {\r\n\r\n        texture.images[i] = image;\r\n\r\n        loaded += 1;\r\n\r\n        if (loaded === 6) {\r\n\r\n          texture.needsUpdate = true;\r\n\r\n          if (onLoad) onLoad(texture);\r\n\r\n        }\r\n\r\n      }, undefined, onError);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n\r\n      loadTexture(i);\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadCompressedTexture: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  loadCompressedTextureCube: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  getNormalMap: function(image, depth) {\r\n\r\n    // Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\r\n\r\n    var cross = function(a, b) {\r\n\r\n      return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\r\n\r\n    }\r\n\r\n    var subtract = function(a, b) {\r\n\r\n      return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\r\n\r\n    }\r\n\r\n    var normalize = function(a) {\r\n\r\n      var l = Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2]);\r\n      return [a[0] / l, a[1] / l, a[2] / l];\r\n\r\n    }\r\n\r\n    depth = depth | 1;\r\n\r\n    var width = image.width;\r\n    var height = image.height;\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.drawImage(image, 0, 0);\r\n\r\n    var data = context.getImageData(0, 0, width, height).data;\r\n    var imageData = context.createImageData(width, height);\r\n    var output = imageData.data;\r\n\r\n    for (var x = 0; x < width; x++) {\r\n\r\n      for (var y = 0; y < height; y++) {\r\n\r\n        var ly = y - 1 < 0 ? 0 : y - 1;\r\n        var uy = y + 1 > height - 1 ? height - 1 : y + 1;\r\n        var lx = x - 1 < 0 ? 0 : x - 1;\r\n        var ux = x + 1 > width - 1 ? width - 1 : x + 1;\r\n\r\n        var points = [];\r\n        var origin = [0, 0, data[(y * width + x) * 4] / 255 * depth];\r\n        points.push([-1, 0, data[(y * width + lx) * 4] / 255 * depth]);\r\n        points.push([-1, -1, data[(ly * width + lx) * 4] / 255 * depth]);\r\n        points.push([0, -1, data[(ly * width + x) * 4] / 255 * depth]);\r\n        points.push([1, -1, data[(ly * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 0, data[(y * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 1, data[(uy * width + ux) * 4] / 255 * depth]);\r\n        points.push([0, 1, data[(uy * width + x) * 4] / 255 * depth]);\r\n        points.push([-1, 1, data[(uy * width + lx) * 4] / 255 * depth]);\r\n\r\n        var normals = [];\r\n        var num_points = points.length;\r\n\r\n        for (var i = 0; i < num_points; i++) {\r\n\r\n          var v1 = points[i];\r\n          var v2 = points[(i + 1) % num_points];\r\n          v1 = subtract(v1, origin);\r\n          v2 = subtract(v2, origin);\r\n          normals.push(normalize(cross(v1, v2)));\r\n\r\n        }\r\n\r\n        var normal = [0, 0, 0];\r\n\r\n        for (var i = 0; i < normals.length; i++) {\r\n\r\n          normal[0] += normals[i][0];\r\n          normal[1] += normals[i][1];\r\n          normal[2] += normals[i][2];\r\n\r\n        }\r\n\r\n        normal[0] /= normals.length;\r\n        normal[1] /= normals.length;\r\n        normal[2] /= normals.length;\r\n\r\n        var idx = (y * width + x) * 4;\r\n\r\n        output[idx] = ((normal[0] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 1] = ((normal[1] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 2] = (normal[2] * 255) | 0;\r\n        output[idx + 3] = 255;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    return canvas;\r\n\r\n  },\r\n\r\n  generateDataTexture: function(width, height, color) {\r\n\r\n    var size = width * height;\r\n    var data = new Uint8Array(3 * size);\r\n\r\n    var r = Math.floor(color.r * 255);\r\n    var g = Math.floor(color.g * 255);\r\n    var b = Math.floor(color.b * 255);\r\n\r\n    for (var i = 0; i < size; i++) {\r\n\r\n      data[i * 3] = r;\r\n      data[i * 3 + 1] = g;\r\n      data[i * 3 + 2] = b;\r\n\r\n    }\r\n\r\n    var texture = new THREE.DataTexture(data, width, height, THREE.RGBFormat);\r\n    texture.needsUpdate = true;\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n  createMultiMaterialObject: function(geometry, materials) {\r\n\r\n    var group = new THREE.Object3D();\r\n\r\n    for (var i = 0, l = materials.length; i < l; i++) {\r\n\r\n      group.add(new THREE.Mesh(geometry, materials[i]));\r\n\r\n    }\r\n\r\n    return group;\r\n\r\n  },\r\n\r\n  detach: function(child, parent, scene) {\r\n\r\n    child.applyMatrix(parent.matrixWorld);\r\n    parent.remove(child);\r\n    scene.add(child);\r\n\r\n  },\r\n\r\n  attach: function(child, scene, parent) {\r\n\r\n    var matrixWorldInverse = new THREE.Matrix4();\r\n    matrixWorldInverse.getInverse(parent.matrixWorld);\r\n    child.applyMatrix(matrixWorldInverse);\r\n\r\n    scene.remove(child);\r\n    parent.add(child);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/FontUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For Text operations in three.js (See TextGeometry)\r\n *\r\n * It uses techniques used in:\r\n *\r\n * \ttypeface.js and canvastext\r\n * \t\tFor converting fonts and rendering with javascript\r\n *\t\thttp://typeface.neocracy.org\r\n *\r\n *\tTriangulation ported from AS3\r\n *\t\tSimple Polygon Triangulation\r\n *\t\thttp://actionsnippet.com/?p=1462\r\n *\r\n * \tA Method to triangulate shapes with holes\r\n *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\r\n *\r\n */\r\n\r\nTHREE.FontUtils = {\r\n\r\n  faces: {},\r\n\r\n  // Just for now. face[weight][style]\r\n\r\n  face: 'helvetiker',\r\n  weight: 'normal',\r\n  style: 'normal',\r\n  size: 150,\r\n  divisions: 10,\r\n\r\n  getFace: function() {\r\n\r\n    try {\r\n\r\n      return this.faces[this.face][this.weight][this.style];\r\n\r\n    }\r\n    catch (e) {\r\n\r\n      throw \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\"\r\n\r\n    };\r\n\r\n  },\r\n\r\n  loadFace: function(data) {\r\n\r\n    var family = data.familyName.toLowerCase();\r\n\r\n    var ThreeFont = this;\r\n\r\n    ThreeFont.faces[family] = ThreeFont.faces[family] || {};\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight] = ThreeFont.faces[family][data.cssFontWeight] || {};\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  drawText: function(text) {\r\n\r\n    // RenderText\r\n\r\n    var i,\r\n      face = this.getFace(),\r\n      scale = this.size / face.resolution,\r\n      offset = 0,\r\n      chars = String(text).split(''),\r\n      length = chars.length;\r\n\r\n    var fontPaths = [];\r\n\r\n    for (i = 0; i < length; i++) {\r\n\r\n      var path = new THREE.Path();\r\n\r\n      var ret = this.extractGlyphPoints(chars[i], face, scale, offset, path);\r\n      offset += ret.offset;\r\n\r\n      fontPaths.push(ret.path);\r\n\r\n    }\r\n\r\n    // get the width\r\n\r\n    var width = offset / 2;\r\n    //\r\n    // for ( p = 0; p < allPts.length; p++ ) {\r\n    //\r\n    // \tallPts[ p ].x -= width;\r\n    //\r\n    // }\r\n\r\n    //var extract = this.extractPoints( allPts, characterPts );\r\n    //extract.contour = allPts;\r\n\r\n    //extract.paths = fontPaths;\r\n    //extract.offset = width;\r\n\r\n    return {\r\n      paths: fontPaths,\r\n      offset: width\r\n    };\r\n\r\n  },\r\n\r\n\r\n\r\n\r\n  extractGlyphPoints: function(c, face, scale, offset, path) {\r\n\r\n    var pts = [];\r\n\r\n    var i, i2, divisions,\r\n      outline, action, length,\r\n      scaleX, scaleY,\r\n      x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2,\r\n      laste,\r\n      glyph = face.glyphs[c] || face.glyphs['?'];\r\n\r\n    if (!glyph) return;\r\n\r\n    if (glyph.o) {\r\n\r\n      outline = glyph._cachedOutline || (glyph._cachedOutline = glyph.o.split(' '));\r\n      length = outline.length;\r\n\r\n      scaleX = scale;\r\n      scaleY = scale;\r\n\r\n      for (i = 0; i < length;) {\r\n\r\n        action = outline[i++];\r\n\r\n        //console.log( action );\r\n\r\n        switch (action) {\r\n\r\n          case 'm':\r\n\r\n            // Move To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n\r\n            path.moveTo(x, y);\r\n            break;\r\n\r\n          case 'l':\r\n\r\n            // Line To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n            path.lineTo(x, y);\r\n            break;\r\n\r\n          case 'q':\r\n\r\n            // QuadraticCurveTo\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n\r\n            path.quadraticCurveTo(cpx1, cpy1, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n                THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n          case 'b':\r\n\r\n            // Cubic Bezier Curve\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n            cpx2 = outline[i++] * scaleX + offset;\r\n            cpy2 = outline[i++] * scaleY;\r\n\r\n            path.bezierCurveTo(cpx1, cpy1, cpx2, cpy2, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n                THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n\r\n\r\n    return {\r\n      offset: glyph.ha * scale,\r\n      path: path\r\n    };\r\n  }\r\n\r\n};\r\n\r\n\r\nTHREE.FontUtils.generateShapes = function(text, parameters) {\r\n\r\n  // Parameters \r\n\r\n  parameters = parameters || {};\r\n\r\n  var size = parameters.size !== undefined ? parameters.size : 100;\r\n  var curveSegments = parameters.curveSegments !== undefined ? parameters.curveSegments : 4;\r\n\r\n  var font = parameters.font !== undefined ? parameters.font : 'helvetiker';\r\n  var weight = parameters.weight !== undefined ? parameters.weight : 'normal';\r\n  var style = parameters.style !== undefined ? parameters.style : 'normal';\r\n\r\n  THREE.FontUtils.size = size;\r\n  THREE.FontUtils.divisions = curveSegments;\r\n\r\n  THREE.FontUtils.face = font;\r\n  THREE.FontUtils.weight = weight;\r\n  THREE.FontUtils.style = style;\r\n\r\n  // Get a Font data json object\r\n\r\n  var data = THREE.FontUtils.drawText(text);\r\n\r\n  var paths = data.paths;\r\n  var shapes = [];\r\n\r\n  for (var p = 0, pl = paths.length; p < pl; p++) {\r\n\r\n    Array.prototype.push.apply(shapes, paths[p].toShapes());\r\n\r\n  }\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n\r\n/**\r\n * This code is a quick port of code written in C++ which was submitted to\r\n * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n * See original code and more information here:\r\n * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n *\r\n * ported to actionscript by Zevan Rosser\r\n * www.actionsnippet.com\r\n *\r\n * ported to javascript by Joshua Koo\r\n * http://www.lab4games.net/zz85/blog\r\n *\r\n */\r\n\r\n\r\n(function(namespace) {\r\n\r\n  var EPSILON = 0.0000000001;\r\n\r\n  // takes in an contour array and returns\r\n\r\n  var process = function(contour, indices) {\r\n\r\n    var n = contour.length;\r\n\r\n    if (n < 3) return null;\r\n\r\n    var result = [],\r\n      verts = [],\r\n      vertIndices = [];\r\n\r\n    /* we want a counter-clockwise polygon in verts */\r\n\r\n    var u, v, w;\r\n\r\n    if (area(contour) > 0.0) {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = v;\r\n\r\n    }\r\n    else {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = (n - 1) - v;\r\n\r\n    }\r\n\r\n    var nv = n;\r\n\r\n    /*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n    var count = 2 * nv; /* error detection */\r\n\r\n    for (v = nv - 1; nv > 2;) {\r\n\r\n      /* if we loop, it is probably a non-simple polygon */\r\n\r\n      if ((count--) <= 0) {\r\n\r\n        //** Triangulate: ERROR - probable bad polygon!\r\n\r\n        //throw ( \"Warning, unable to triangulate polygon!\" );\r\n        //return null;\r\n        // Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n        THREE.warn('THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()');\r\n\r\n        if (indices) return vertIndices;\r\n        return result;\r\n\r\n      }\r\n\r\n      /* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n      u = v;\r\n      if (nv <= u) u = 0; /* previous */\r\n      v = u + 1;\r\n      if (nv <= v) v = 0; /* new v    */\r\n      w = v + 1;\r\n      if (nv <= w) w = 0; /* next     */\r\n\r\n      if (snip(contour, u, v, w, nv, verts)) {\r\n\r\n        var a, b, c, s, t;\r\n\r\n        /* true names of the vertices */\r\n\r\n        a = verts[u];\r\n        b = verts[v];\r\n        c = verts[w];\r\n\r\n        /* output Triangle */\r\n\r\n        result.push([contour[a],\r\n          contour[b],\r\n          contour[c]\r\n        ]);\r\n\r\n\r\n        vertIndices.push([verts[u], verts[v], verts[w]]);\r\n\r\n        /* remove v from the remaining polygon */\r\n\r\n        for (s = v, t = v + 1; t < nv; s++, t++) {\r\n\r\n          verts[s] = verts[t];\r\n\r\n        }\r\n\r\n        nv--;\r\n\r\n        /* reset error detection counter */\r\n\r\n        count = 2 * nv;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (indices) return vertIndices;\r\n    return result;\r\n\r\n  };\r\n\r\n  // calculate area of the contour polygon\r\n\r\n  var area = function(contour) {\r\n\r\n    var n = contour.length;\r\n    var a = 0.0;\r\n\r\n    for (var p = n - 1, q = 0; q < n; p = q++) {\r\n\r\n      a += contour[p].x * contour[q].y - contour[q].x * contour[p].y;\r\n\r\n    }\r\n\r\n    return a * 0.5;\r\n\r\n  };\r\n\r\n  var snip = function(contour, u, v, w, n, verts) {\r\n\r\n    var p;\r\n    var ax, ay, bx, by;\r\n    var cx, cy, px, py;\r\n\r\n    ax = contour[verts[u]].x;\r\n    ay = contour[verts[u]].y;\r\n\r\n    bx = contour[verts[v]].x;\r\n    by = contour[verts[v]].y;\r\n\r\n    cx = contour[verts[w]].x;\r\n    cy = contour[verts[w]].y;\r\n\r\n    if (EPSILON > (((bx - ax) * (cy - ay)) - ((by - ay) * (cx - ax)))) return false;\r\n\r\n    var aX, aY, bX, bY, cX, cY;\r\n    var apx, apy, bpx, bpy, cpx, cpy;\r\n    var cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n    aX = cx - bx;\r\n    aY = cy - by;\r\n    bX = ax - cx;\r\n    bY = ay - cy;\r\n    cX = bx - ax;\r\n    cY = by - ay;\r\n\r\n    for (p = 0; p < n; p++) {\r\n\r\n      px = contour[verts[p]].x\r\n      py = contour[verts[p]].y\r\n\r\n      if (((px === ax) && (py === ay)) ||\r\n        ((px === bx) && (py === by)) ||\r\n        ((px === cx) && (py === cy))) continue;\r\n\r\n      apx = px - ax;\r\n      apy = py - ay;\r\n      bpx = px - bx;\r\n      bpy = py - by;\r\n      cpx = px - cx;\r\n      cpy = py - cy;\r\n\r\n      // see if p is inside triangle abc\r\n\r\n      aCROSSbp = aX * bpy - aY * bpx;\r\n      cCROSSap = cX * apy - cY * apx;\r\n      bCROSScp = bX * cpy - bY * cpx;\r\n\r\n      if ((aCROSSbp >= -EPSILON) && (bCROSScp >= -EPSILON) && (cCROSSap >= -EPSILON)) return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n\r\n  namespace.Triangulate = process;\r\n  namespace.Triangulate.area = area;\r\n\r\n  return namespace;\r\n\r\n})(THREE.FontUtils);\r\n\r\n// To use the typeface.js face files, hook up the API\r\nself._typeface_js = {\r\n  faces: THREE.FontUtils.faces,\r\n  loadFace: THREE.FontUtils.loadFace\r\n};\r\nTHREE.typeface_js = self._typeface_js;\r\n\r\n// File:src/extras/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Audio = function(listener) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Audio';\r\n\r\n  this.context = listener.context;\r\n  this.source = this.context.createBufferSource();\r\n  this.source.onended = this.onEnded.bind(this);\r\n\r\n  this.gain = this.context.createGain();\r\n  this.gain.connect(this.context.destination);\r\n\r\n  this.panner = this.context.createPanner();\r\n  this.panner.connect(this.gain);\r\n\r\n  this.autoplay = false;\r\n\r\n  this.startTime = 0;\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.load = function(file) {\r\n\r\n  var scope = this;\r\n\r\n  var request = new XMLHttpRequest();\r\n  request.open('GET', file, true);\r\n  request.responseType = 'arraybuffer';\r\n  request.onload = function(e) {\r\n\r\n    scope.context.decodeAudioData(this.response, function(buffer) {\r\n\r\n      scope.source.buffer = buffer;\r\n\r\n      if (scope.autoplay) scope.play();\r\n\r\n    });\r\n\r\n  };\r\n  request.send();\r\n\r\n  return this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function() {\r\n\r\n  if (this.isPlaying === true) {\r\n\r\n    THREE.warn('THREE.Audio: Audio is already playing.');\r\n    return;\r\n\r\n  }\r\n\r\n  var source = this.context.createBufferSource();\r\n\r\n  source.buffer = this.source.buffer;\r\n  source.loop = this.source.loop;\r\n  source.onended = this.source.onended;\r\n  source.connect(this.panner);\r\n  source.start(0, this.startTime);\r\n\r\n  this.isPlaying = true;\r\n\r\n  this.source = source;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function() {\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function(value) {\r\n\r\n  this.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRefDistance = function(value) {\r\n\r\n  this.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRolloffFactor = function(value) {\r\n\r\n  this.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setVolume = function(value) {\r\n\r\n  this.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    position.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    this.panner.setPosition(position.x, position.y, position.z);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'AudioListener';\r\n\r\n  this.context = new(window.AudioContext || window.webkitAudioContext)();\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3();\r\n\r\n  var orientation = new THREE.Vector3();\r\n  var velocity = new THREE.Vector3();\r\n\r\n  var positionPrev = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    var listener = this.context.listener;\r\n    var up = this.up;\r\n\r\n    this.matrixWorld.decompose(position, quaternion, scale);\r\n\r\n    orientation.set(0, 0, -1).applyQuaternion(quaternion);\r\n    velocity.subVectors(position, positionPrev);\r\n\r\n    listener.setPosition(position.x, position.y, position.z);\r\n    listener.setOrientation(orientation.x, orientation.y, orientation.z, up.x, up.y, up.z);\r\n    listener.setVelocity(velocity.x, velocity.y, velocity.z);\r\n\r\n    positionPrev.copy(position);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n * THREE.ClosedSplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function() {\r\n\r\n};\r\n\r\n// Virtual base class method to overwrite and implement in subclasses\r\n//\t- t [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPoint = function(t) {\r\n\r\n  THREE.warn(\"THREE.Curve: Warning, getPoint() not implemented!\");\r\n  return null;\r\n\r\n};\r\n\r\n// Get point at relative position in curve according to arc length\r\n// - u [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPointAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getPoint(t);\r\n\r\n};\r\n\r\n// Get sequence of points using getPoint( t )\r\n\r\nTHREE.Curve.prototype.getPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPoint(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get sequence of points using getPointAt( u )\r\n\r\nTHREE.Curve.prototype.getSpacedPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPointAt(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get total curve arc length\r\n\r\nTHREE.Curve.prototype.getLength = function() {\r\n\r\n  var lengths = this.getLengths();\r\n  return lengths[lengths.length - 1];\r\n\r\n};\r\n\r\n// Get list of cumulative segment lengths\r\n\r\nTHREE.Curve.prototype.getLengths = function(divisions) {\r\n\r\n  if (!divisions) divisions = (this.__arcLengthDivisions) ? (this.__arcLengthDivisions) : 200;\r\n\r\n  if (this.cacheArcLengths && (this.cacheArcLengths.length == divisions + 1) && !this.needsUpdate) {\r\n\r\n    //console.log( \"cached\", this.cacheArcLengths );\r\n    return this.cacheArcLengths;\r\n\r\n  }\r\n\r\n  this.needsUpdate = false;\r\n\r\n  var cache = [];\r\n  var current, last = this.getPoint(0);\r\n  var p, sum = 0;\r\n\r\n  cache.push(0);\r\n\r\n  for (p = 1; p <= divisions; p++) {\r\n\r\n    current = this.getPoint(p / divisions);\r\n    sum += current.distanceTo(last);\r\n    cache.push(sum);\r\n    last = current;\r\n\r\n  }\r\n\r\n  this.cacheArcLengths = cache;\r\n\r\n  return cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.updateArcLengths = function() {\r\n  this.needsUpdate = true;\r\n  this.getLengths();\r\n};\r\n\r\n// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equi distance\r\n\r\nTHREE.Curve.prototype.getUtoTmapping = function(u, distance) {\r\n\r\n  var arcLengths = this.getLengths();\r\n\r\n  var i = 0,\r\n    il = arcLengths.length;\r\n\r\n  var targetArcLength; // The targeted u distance value to get\r\n\r\n  if (distance) {\r\n\r\n    targetArcLength = distance;\r\n\r\n  }\r\n  else {\r\n\r\n    targetArcLength = u * arcLengths[il - 1];\r\n\r\n  }\r\n\r\n  //var time = Date.now();\r\n\r\n  // binary search for the index with largest value smaller than target u distance\r\n\r\n  var low = 0,\r\n    high = il - 1,\r\n    comparison;\r\n\r\n  while (low <= high) {\r\n\r\n    i = Math.floor(low + (high - low) / 2); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n    comparison = arcLengths[i] - targetArcLength;\r\n\r\n    if (comparison < 0) {\r\n\r\n      low = i + 1;\r\n\r\n    }\r\n    else if (comparison > 0) {\r\n\r\n      high = i - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      high = i;\r\n      break;\r\n\r\n      // DONE\r\n\r\n    }\r\n\r\n  }\r\n\r\n  i = high;\r\n\r\n  //console.log('b' , i, low, high, Date.now()- time);\r\n\r\n  if (arcLengths[i] == targetArcLength) {\r\n\r\n    var t = i / (il - 1);\r\n    return t;\r\n\r\n  }\r\n\r\n  // we could get finer grain at lengths, or use simple interpolatation between two points\r\n\r\n  var lengthBefore = arcLengths[i];\r\n  var lengthAfter = arcLengths[i + 1];\r\n\r\n  var segmentLength = lengthAfter - lengthBefore;\r\n\r\n  // determine where we are between the 'before' and 'after' points\r\n\r\n  var segmentFraction = (targetArcLength - lengthBefore) / segmentLength;\r\n\r\n  // add that fractional amount to t\r\n\r\n  var t = (i + segmentFraction) / (il - 1);\r\n\r\n  return t;\r\n\r\n};\r\n\r\n// Returns a unit vector tangent at t\r\n// In case any sub curve does not implement its tangent derivation,\r\n// 2 points a small delta apart will be used to find its gradient\r\n// which seems to give a reasonable approximation\r\n\r\nTHREE.Curve.prototype.getTangent = function(t) {\r\n\r\n  var delta = 0.0001;\r\n  var t1 = t - delta;\r\n  var t2 = t + delta;\r\n\r\n  // Capping in case of danger\r\n\r\n  if (t1 < 0) t1 = 0;\r\n  if (t2 > 1) t2 = 1;\r\n\r\n  var pt1 = this.getPoint(t1);\r\n  var pt2 = this.getPoint(t2);\r\n\r\n  var vec = pt2.clone().sub(pt1);\r\n  return vec.normalize();\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.getTangentAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getTangent(t);\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Curve.Utils = {\r\n\r\n  tangentQuadraticBezier: function(t, p0, p1, p2) {\r\n\r\n    return 2 * (1 - t) * (p1 - p0) + 2 * t * (p2 - p1);\r\n\r\n  },\r\n\r\n  // Puay Bing, thanks for helping with this derivative!\r\n\r\n  tangentCubicBezier: function(t, p0, p1, p2, p3) {\r\n\r\n    return -3 * p0 * (1 - t) * (1 - t) +\r\n      3 * p1 * (1 - t) * (1 - t) - 6 * t * p1 * (1 - t) +\r\n      6 * t * p2 * (1 - t) - 3 * t * t * p2 +\r\n      3 * t * t * p3;\r\n\r\n  },\r\n\r\n  tangentSpline: function(t, p0, p1, p2, p3) {\r\n\r\n    // To check if my formulas are correct\r\n\r\n    var h00 = 6 * t * t - 6 * t; // derived from 2t^3  3t^2 + 1\r\n    var h10 = 3 * t * t - 4 * t + 1; // t^3  2t^2 + t\r\n    var h01 = -6 * t * t + 6 * t; //  2t3 + 3t2\r\n    var h11 = 3 * t * t - 2 * t; // t3  t2\r\n\r\n    return h00 + h10 + h01 + h11;\r\n\r\n  },\r\n\r\n  // Catmull-Rom\r\n\r\n  interpolate: function(p0, p1, p2, p3, t) {\r\n\r\n    var v0 = (p2 - p0) * 0.5;\r\n    var v1 = (p3 - p1) * 0.5;\r\n    var t2 = t * t;\r\n    var t3 = t * t2;\r\n    return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function(constructor, getPointFunc) {\r\n\r\n  constructor.prototype = Object.create(THREE.Curve.prototype);\r\n  constructor.prototype.constructor = constructor;\r\n  constructor.prototype.getPoint = getPointFunc;\r\n\r\n  return constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function() {\r\n\r\n  this.curves = [];\r\n  this.bends = [];\r\n\r\n  this.autoClose = false; // Automatically closes the path\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function(curve) {\r\n\r\n  this.curves.push(curve);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n  // TODO\r\n  // If the ending of curve is not connected to the starting\r\n  // or the next curve, then, this is not a real path\r\n};\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n  // TODO Test\r\n  // and verify for vector3 (needs to implement equals)\r\n  // Add a line curve if start and end of lines are not connected\r\n  var startPoint = this.curves[0].getPoint(0);\r\n  var endPoint = this.curves[this.curves.length - 1].getPoint(1);\r\n\r\n  if (!startPoint.equals(endPoint)) {\r\n    this.curves.push(new THREE.LineCurve(endPoint, startPoint));\r\n  }\r\n\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function(t) {\r\n\r\n  var d = t * this.getLength();\r\n  var curveLengths = this.getCurveLengths();\r\n  var i = 0,\r\n    diff, curve;\r\n\r\n  // To think about boundaries points.\r\n\r\n  while (i < curveLengths.length) {\r\n\r\n    if (curveLengths[i] >= d) {\r\n\r\n      diff = curveLengths[i] - d;\r\n      curve = this.curves[i];\r\n\r\n      var u = 1 - diff / curve.getLength();\r\n\r\n      return curve.getPointAt(u);\r\n\r\n    }\r\n\r\n    i++;\r\n\r\n  }\r\n\r\n  return null;\r\n\r\n  // loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};*/\r\n\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n  var lens = this.getCurveLengths();\r\n  return lens[lens.length - 1];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n  // We use cache values if curves and cache array are same length\r\n\r\n  if (this.cacheLengths && this.cacheLengths.length == this.curves.length) {\r\n\r\n    return this.cacheLengths;\r\n\r\n  };\r\n\r\n  // Get length of subsurve\r\n  // Push sums into cached array\r\n\r\n  var lengths = [],\r\n    sums = 0;\r\n  var i, il = this.curves.length;\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    sums += this.curves[i].getLength();\r\n    lengths.push(sums);\r\n\r\n  }\r\n\r\n  this.cacheLengths = lengths;\r\n\r\n  return lengths;\r\n\r\n};\r\n\r\n\r\n\r\n// Returns min and max coordinates\r\n\r\nTHREE.CurvePath.prototype.getBoundingBox = function() {\r\n\r\n  var points = this.getPoints();\r\n\r\n  var maxX, maxY, maxZ;\r\n  var minX, minY, minZ;\r\n\r\n  maxX = maxY = Number.NEGATIVE_INFINITY;\r\n  minX = minY = Number.POSITIVE_INFINITY;\r\n\r\n  var p, i, il, sum;\r\n\r\n  var v3 = points[0] instanceof THREE.Vector3;\r\n\r\n  sum = v3 ? new THREE.Vector3() : new THREE.Vector2();\r\n\r\n  for (i = 0, il = points.length; i < il; i++) {\r\n\r\n    p = points[i];\r\n\r\n    if (p.x > maxX) maxX = p.x;\r\n    else if (p.x < minX) minX = p.x;\r\n\r\n    if (p.y > maxY) maxY = p.y;\r\n    else if (p.y < minY) minY = p.y;\r\n\r\n    if (v3) {\r\n\r\n      if (p.z > maxZ) maxZ = p.z;\r\n      else if (p.z < minZ) minZ = p.z;\r\n\r\n    }\r\n\r\n    sum.add(p);\r\n\r\n  }\r\n\r\n  var ret = {\r\n\r\n    minX: minX,\r\n    minY: minY,\r\n    maxX: maxX,\r\n    maxY: maxY\r\n\r\n  };\r\n\r\n  if (v3) {\r\n\r\n    ret.maxZ = maxZ;\r\n    ret.minZ = minZ;\r\n\r\n  }\r\n\r\n  return ret;\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\n// Generate geometry from equidistance sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getSpacedPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function(points) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < points.length; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(points[i].x, points[i].y, points[i].z || 0));\r\n\r\n  }\r\n\r\n  return geometry;\r\n\r\n};\r\n\r\n\r\n/**************************************************************\r\n *\tBend / Wrap Helper Methods\r\n **************************************************************/\r\n\r\n// Wrap path / Bend modifiers?\r\n\r\nTHREE.CurvePath.prototype.addWrapPath = function(bendpath) {\r\n\r\n  this.bends.push(bendpath);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getPoints(segments); // getPoints getSpacedPoints\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedSpacedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getSpacedPoints(segments);\r\n\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n// This returns getPoints() bend/wrapped around the contour of a path.\r\n// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\r\n\r\nTHREE.CurvePath.prototype.getWrapPoints = function(oldPts, path) {\r\n\r\n  var bounds = this.getBoundingBox();\r\n\r\n  var i, il, p, oldX, oldY, xNorm;\r\n\r\n  for (i = 0, il = oldPts.length; i < il; i++) {\r\n\r\n    p = oldPts[i];\r\n\r\n    oldX = p.x;\r\n    oldY = p.y;\r\n\r\n    xNorm = oldX / bounds.maxX;\r\n\r\n    // If using actual distance, for length > path, requires line extrusions\r\n    //xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\r\n\r\n    xNorm = path.getUtoTmapping(xNorm, oldX);\r\n\r\n    // check for out of bounds?\r\n\r\n    var pathPt = path.getPoint(xNorm);\r\n    var normal = path.getTangent(xNorm);\r\n    normal.set(-normal.y, normal.x).multiplyScalar(oldY);\r\n\r\n    p.x = pathPt.x + normal.x;\r\n    p.y = pathPt.y + normal.y;\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/core/Gyroscope.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Gyroscope = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n};\r\n\r\nTHREE.Gyroscope.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Gyroscope.prototype.constructor = THREE.Gyroscope;\r\n\r\nTHREE.Gyroscope.prototype.updateMatrixWorld = (function() {\r\n\r\n  var translationObject = new THREE.Vector3();\r\n  var quaternionObject = new THREE.Quaternion();\r\n  var scaleObject = new THREE.Vector3();\r\n\r\n  var translationWorld = new THREE.Vector3();\r\n  var quaternionWorld = new THREE.Quaternion();\r\n  var scaleWorld = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    this.matrixAutoUpdate && this.updateMatrix();\r\n\r\n    // update matrixWorld\r\n\r\n    if (this.matrixWorldNeedsUpdate || force) {\r\n\r\n      if (this.parent) {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n        this.matrixWorld.decompose(translationWorld, quaternionWorld, scaleWorld);\r\n        this.matrix.decompose(translationObject, quaternionObject, scaleObject);\r\n\r\n        this.matrixWorld.compose(translationWorld, quaternionObject, scaleWorld);\r\n\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function(points) {\r\n\r\n  THREE.CurvePath.call(this);\r\n\r\n  this.actions = [];\r\n\r\n  if (points) {\r\n\r\n    this.fromPoints(points);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create(THREE.CurvePath.prototype);\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\nTHREE.PathActions = {\r\n\r\n  MOVE_TO: 'moveTo',\r\n  LINE_TO: 'lineTo',\r\n  QUADRATIC_CURVE_TO: 'quadraticCurveTo', // Bezier quadratic curve\r\n  BEZIER_CURVE_TO: 'bezierCurveTo', // Bezier cubic curve\r\n  CSPLINE_THRU: 'splineThru', // Catmull-rom spline\r\n  ARC: 'arc', // Circle\r\n  ELLIPSE: 'ellipse'\r\n};\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function(vectors) {\r\n\r\n  this.moveTo(vectors[0].x, vectors[0].y);\r\n\r\n  for (var v = 1, vlen = vectors.length; v < vlen; v++) {\r\n\r\n    this.lineTo(vectors[v].x, vectors[v].y);\r\n\r\n  };\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  this.actions.push({\r\n    action: THREE.PathActions.MOVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.LineCurve(new THREE.Vector2(x0, y0), new THREE.Vector2(x, y));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.LINE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.QuadraticBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCPx, aCPy),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.QUADRATIC_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function(aCP1x, aCP1y,\r\n  aCP2x, aCP2y,\r\n  aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.CubicBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCP1x, aCP1y),\r\n    new THREE.Vector2(aCP2x, aCP2y),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.BEZIER_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function(pts /*Array of Vector*/ ) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n  //---\r\n  var npts = [new THREE.Vector2(x0, y0)];\r\n  Array.prototype.push.apply(npts, pts);\r\n\r\n  var curve = new THREE.SplineCurve(npts);\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.CSPLINE_THRU,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absarc(aX + x0, aY + y0, aRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\nTHREE.Path.prototype.absarc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n  this.absellipse(aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.Path.prototype.ellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absellipse(aX + x0, aY + y0, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var curve = new THREE.EllipseCurve(aX, aY, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n  this.curves.push(curve);\r\n\r\n  var lastPoint = curve.getPoint(1);\r\n  args.push(lastPoint.x);\r\n  args.push(lastPoint.y);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.ELLIPSE,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function(divisions, closedPath) {\r\n\r\n  if (!divisions) divisions = 40;\r\n\r\n  var points = [];\r\n\r\n  for (var i = 0; i < divisions; i++) {\r\n\r\n    points.push(this.getPoint(i / divisions));\r\n\r\n    //if( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n  }\r\n\r\n  // if ( closedPath ) {\r\n  //\r\n  // \tpoints.push( points[ 0 ] );\r\n  //\r\n  // }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function(divisions, closedPath) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    console.log('tata');\r\n    return this.getSpacedPoints(divisions, closedPath);\r\n  }\r\n\r\n  divisions = divisions || 12;\r\n\r\n  var points = [];\r\n\r\n  var i, il, item, action, args;\r\n  var cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n    laste, j,\r\n    t, tx, ty;\r\n\r\n  for (i = 0, il = this.actions.length; i < il; i++) {\r\n\r\n    item = this.actions[i];\r\n\r\n    action = item.action;\r\n    args = item.args;\r\n\r\n    switch (action) {\r\n\r\n      case THREE.PathActions.MOVE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.LINE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.QUADRATIC_CURVE_TO:\r\n\r\n        cpx = args[2];\r\n        cpy = args[3];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n          ty = THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.BEZIER_CURVE_TO:\r\n\r\n        cpx = args[4];\r\n        cpy = args[5];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        cpx2 = args[2];\r\n        cpy2 = args[3];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n          ty = THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.CSPLINE_THRU:\r\n\r\n        laste = this.actions[i - 1].args;\r\n\r\n        var last = new THREE.Vector2(laste[laste.length - 2], laste[laste.length - 1]);\r\n        var spts = [last];\r\n\r\n        var n = divisions * args[0].length;\r\n\r\n        spts = spts.concat(args[0]);\r\n\r\n        var spline = new THREE.SplineCurve(spts);\r\n\r\n        for (j = 1; j <= n; j++) {\r\n\r\n          points.push(spline.getPointAt(j / n));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ARC:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          aRadius = args[2],\r\n          aStartAngle = args[3],\r\n          aEndAngle = args[4],\r\n          aClockwise = !!args[5];\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + aRadius * Math.cos(angle);\r\n          ty = aY + aRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ELLIPSE:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          xRadius = args[2],\r\n          yRadius = args[3],\r\n          aStartAngle = args[4],\r\n          aEndAngle = args[5],\r\n          aClockwise = !!args[6];\r\n\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + xRadius * Math.cos(angle);\r\n          ty = aY + yRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n    } // end switch\r\n\r\n  }\r\n\r\n\r\n\r\n  // Normalize to remove the closing point by default.\r\n  var lastPoint = points[points.length - 1];\r\n  var EPSILON = 0.0000000001;\r\n  if (Math.abs(lastPoint.x - points[0].x) < EPSILON &&\r\n    Math.abs(lastPoint.y - points[0].y) < EPSILON)\r\n    points.splice(points.length - 1, 1);\r\n  if (closedPath) {\r\n\r\n    points.push(points[0]);\r\n\r\n  }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function(isCCW, noHoles) {\r\n\r\n  function extractSubpaths(inActions) {\r\n\r\n    var i, il, item, action, args;\r\n\r\n    var subPaths = [],\r\n      lastPath = new THREE.Path();\r\n\r\n    for (i = 0, il = inActions.length; i < il; i++) {\r\n\r\n      item = inActions[i];\r\n\r\n      args = item.args;\r\n      action = item.action;\r\n\r\n      if (action == THREE.PathActions.MOVE_TO) {\r\n\r\n        if (lastPath.actions.length != 0) {\r\n\r\n          subPaths.push(lastPath);\r\n          lastPath = new THREE.Path();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      lastPath[action].apply(lastPath, args);\r\n\r\n    }\r\n\r\n    if (lastPath.actions.length != 0) {\r\n\r\n      subPaths.push(lastPath);\r\n\r\n    }\r\n\r\n    // console.log(subPaths);\r\n\r\n    return subPaths;\r\n  }\r\n\r\n  function toShapesNoHoles(inSubpaths) {\r\n\r\n    var shapes = [];\r\n\r\n    for (var i = 0, il = inSubpaths.length; i < il; i++) {\r\n\r\n      var tmpPath = inSubpaths[i];\r\n\r\n      var tmpShape = new THREE.Shape();\r\n      tmpShape.actions = tmpPath.actions;\r\n      tmpShape.curves = tmpPath.curves;\r\n\r\n      shapes.push(tmpShape);\r\n    }\r\n\r\n    //console.log(\"shape\", shapes);\r\n\r\n    return shapes;\r\n  };\r\n\r\n  function isPointInsidePolygon(inPt, inPolygon) {\r\n    var EPSILON = 0.0000000001;\r\n\r\n    var polyLen = inPolygon.length;\r\n\r\n    // inPt on polygon contour => immediate success    or\r\n    // toggling of inside/outside at every single! intersection point of an edge\r\n    //  with the horizontal line through inPt, left of inPt\r\n    //  not counting lowerY endpoints of edges and whole edges on that line\r\n    var inside = false;\r\n    for (var p = polyLen - 1, q = 0; q < polyLen; p = q++) {\r\n      var edgeLowPt = inPolygon[p];\r\n      var edgeHighPt = inPolygon[q];\r\n\r\n      var edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n      var edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n      if (Math.abs(edgeDy) > EPSILON) { // not parallel\r\n        if (edgeDy < 0) {\r\n          edgeLowPt = inPolygon[q];\r\n          edgeDx = -edgeDx;\r\n          edgeHighPt = inPolygon[p];\r\n          edgeDy = -edgeDy;\r\n        }\r\n        if ((inPt.y < edgeLowPt.y) || (inPt.y > edgeHighPt.y)) continue;\r\n\r\n        if (inPt.y == edgeLowPt.y) {\r\n          if (inPt.x == edgeLowPt.x) return true; // inPt is on contour ?\r\n          // continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n        }\r\n        else {\r\n          var perpEdge = edgeDy * (inPt.x - edgeLowPt.x) - edgeDx * (inPt.y - edgeLowPt.y);\r\n          if (perpEdge == 0) return true; // inPt is on contour ?\r\n          if (perpEdge < 0) continue;\r\n          inside = !inside; // true intersection left of inPt\r\n        }\r\n      }\r\n      else { // parallel or colinear\r\n        if (inPt.y != edgeLowPt.y) continue; // parallel\r\n        // egde lies on the same horizontal line as inPt\r\n        if (((edgeHighPt.x <= inPt.x) && (inPt.x <= edgeLowPt.x)) ||\r\n          ((edgeLowPt.x <= inPt.x) && (inPt.x <= edgeHighPt.x))) return true; // inPt: Point on contour !\r\n        // continue;\r\n      }\r\n    }\r\n\r\n    return inside;\r\n  }\r\n\r\n\r\n  var subPaths = extractSubpaths(this.actions);\r\n  if (subPaths.length == 0) return [];\r\n\r\n  if (noHoles === true) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  var solid, tmpPath, tmpShape, shapes = [];\r\n\r\n  if (subPaths.length == 1) {\r\n\r\n    tmpPath = subPaths[0];\r\n    tmpShape = new THREE.Shape();\r\n    tmpShape.actions = tmpPath.actions;\r\n    tmpShape.curves = tmpPath.curves;\r\n    shapes.push(tmpShape);\r\n    return shapes;\r\n\r\n  }\r\n\r\n  var holesFirst = !THREE.Shape.Utils.isClockWise(subPaths[0].getPoints());\r\n  holesFirst = isCCW ? !holesFirst : holesFirst;\r\n\r\n  // console.log(\"Holes first\", holesFirst);\r\n\r\n  var betterShapeHoles = [];\r\n  var newShapes = [];\r\n  var newShapeHoles = [];\r\n  var mainIdx = 0;\r\n  var tmpPoints;\r\n\r\n  newShapes[mainIdx] = undefined;\r\n  newShapeHoles[mainIdx] = [];\r\n\r\n  var i, il;\r\n\r\n  for (i = 0, il = subPaths.length; i < il; i++) {\r\n\r\n    tmpPath = subPaths[i];\r\n    tmpPoints = tmpPath.getPoints();\r\n    solid = THREE.Shape.Utils.isClockWise(tmpPoints);\r\n    solid = isCCW ? !solid : solid;\r\n\r\n    if (solid) {\r\n\r\n      if ((!holesFirst) && (newShapes[mainIdx])) mainIdx++;\r\n\r\n      newShapes[mainIdx] = {\r\n        s: new THREE.Shape(),\r\n        p: tmpPoints\r\n      };\r\n      newShapes[mainIdx].s.actions = tmpPath.actions;\r\n      newShapes[mainIdx].s.curves = tmpPath.curves;\r\n\r\n      if (holesFirst) mainIdx++;\r\n      newShapeHoles[mainIdx] = [];\r\n\r\n      //console.log('cw', i);\r\n\r\n    }\r\n    else {\r\n\r\n      newShapeHoles[mainIdx].push({\r\n        h: tmpPath,\r\n        p: tmpPoints[0]\r\n      });\r\n\r\n      //console.log('ccw', i);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // only Holes? -> probably all Shapes with wrong orientation\r\n  if (!newShapes[0]) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  if (newShapes.length > 1) {\r\n    var ambigious = false;\r\n    var toChange = [];\r\n\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      betterShapeHoles[sIdx] = [];\r\n    }\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      var sho = newShapeHoles[sIdx];\r\n      for (var hIdx = 0; hIdx < sho.length; hIdx++) {\r\n        var ho = sho[hIdx];\r\n        var hole_unassigned = true;\r\n        for (var s2Idx = 0; s2Idx < newShapes.length; s2Idx++) {\r\n          if (isPointInsidePolygon(ho.p, newShapes[s2Idx].p)) {\r\n            if (sIdx != s2Idx) toChange.push({\r\n              froms: sIdx,\r\n              tos: s2Idx,\r\n              hole: hIdx\r\n            });\r\n            if (hole_unassigned) {\r\n              hole_unassigned = false;\r\n              betterShapeHoles[s2Idx].push(ho);\r\n            }\r\n            else {\r\n              ambigious = true;\r\n            }\r\n          }\r\n        }\r\n        if (hole_unassigned) {\r\n          betterShapeHoles[sIdx].push(ho);\r\n        }\r\n      }\r\n    }\r\n    // console.log(\"ambigious: \", ambigious);\r\n    if (toChange.length > 0) {\r\n      // console.log(\"to change: \", toChange);\r\n      if (!ambigious) newShapeHoles = betterShapeHoles;\r\n    }\r\n  }\r\n\r\n  var tmpHoles, j, jl;\r\n  for (i = 0, il = newShapes.length; i < il; i++) {\r\n    tmpShape = newShapes[i].s;\r\n    shapes.push(tmpShape);\r\n    tmpHoles = newShapeHoles[i];\r\n    for (j = 0, jl = tmpHoles.length; j < jl; j++) {\r\n      tmpShape.holes.push(tmpHoles[j].h);\r\n    }\r\n  }\r\n\r\n  //console.log(\"shape\", shapes);\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function() {\r\n\r\n  THREE.Path.apply(this, arguments);\r\n  this.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create(THREE.Path.prototype);\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function(options) {\r\n\r\n  var extruded = new THREE.ExtrudeGeometry(this, options);\r\n  return extruded;\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function(options) {\r\n\r\n  var geometry = new THREE.ShapeGeometry(this, options);\r\n  return geometry;\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n// Get points of holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.getSpacedPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedSpacedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedPoints(divisions),\r\n    holes: this.getPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function(divisions) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    return this.extractAllSpacedPoints(divisions);\r\n  }\r\n\r\n  return this.extractAllPoints(divisions);\r\n\r\n};\r\n\r\n//\r\n// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\r\n//\r\n// \treturn {\r\n//\r\n// \t\tshape: this.transform( bend, divisions ),\r\n// \t\tholes: this.getPointsHoles( divisions, bend )\r\n//\r\n// \t};\r\n//\r\n// };\r\n\r\n// Get points of shape and holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.extractAllSpacedPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedSpacedPoints(divisions),\r\n    holes: this.getSpacedPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Shape.Utils = {\r\n\r\n  triangulateShape: function(contour, holes) {\r\n\r\n    function point_in_segment_2D_colin(inSegPt1, inSegPt2, inOtherPt) {\r\n      // inOtherPt needs to be colinear to the inSegment\r\n      if (inSegPt1.x != inSegPt2.x) {\r\n        if (inSegPt1.x < inSegPt2.x) {\r\n          return ((inSegPt1.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt2.x));\r\n        }\r\n        else {\r\n          return ((inSegPt2.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt1.x));\r\n        }\r\n      }\r\n      else {\r\n        if (inSegPt1.y < inSegPt2.y) {\r\n          return ((inSegPt1.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt2.y));\r\n        }\r\n        else {\r\n          return ((inSegPt2.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt1.y));\r\n        }\r\n      }\r\n    }\r\n\r\n    function intersect_segments_2D(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs) {\r\n      var EPSILON = 0.0000000001;\r\n\r\n      var seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,\r\n        seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n      var seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,\r\n        seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n      var seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n      var seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n      var limit = seg1dy * seg2dx - seg1dx * seg2dy;\r\n      var perpSeg1 = seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n      if (Math.abs(limit) > EPSILON) { // not parallel\r\n\r\n        var perpSeg2;\r\n        if (limit > 0) {\r\n          if ((perpSeg1 < 0) || (perpSeg1 > limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 < 0) || (perpSeg2 > limit)) return [];\r\n        }\r\n        else {\r\n          if ((perpSeg1 > 0) || (perpSeg1 < limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 > 0) || (perpSeg2 < limit)) return [];\r\n        }\r\n\r\n        // i.e. to reduce rounding errors\r\n        // intersection at endpoint of segment#1?\r\n        if (perpSeg2 == 0) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt1];\r\n        }\r\n        if (perpSeg2 == limit) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt2];\r\n        }\r\n        // intersection at endpoint of segment#2?\r\n        if (perpSeg1 == 0) return [inSeg2Pt1];\r\n        if (perpSeg1 == limit) return [inSeg2Pt2];\r\n\r\n        // return real intersection point\r\n        var factorSeg1 = perpSeg2 / limit;\r\n        return [{\r\n          x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n          y: inSeg1Pt1.y + factorSeg1 * seg1dy\r\n        }];\r\n\r\n      }\r\n      else { // parallel or colinear\r\n        if ((perpSeg1 != 0) ||\r\n          (seg2dy * seg1seg2dx != seg2dx * seg1seg2dy)) return [];\r\n\r\n        // they are collinear or degenerate\r\n        var seg1Pt = ((seg1dx == 0) && (seg1dy == 0)); // segment1 ist just a point?\r\n        var seg2Pt = ((seg2dx == 0) && (seg2dy == 0)); // segment2 ist just a point?\r\n        // both segments are points\r\n        if (seg1Pt && seg2Pt) {\r\n          if ((inSeg1Pt1.x != inSeg2Pt1.x) ||\r\n            (inSeg1Pt1.y != inSeg2Pt1.y)) return []; // they are distinct  points\r\n          return [inSeg1Pt1]; // they are the same point\r\n        }\r\n        // segment#1  is a single point\r\n        if (seg1Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg2Pt1, inSeg2Pt2, inSeg1Pt1)) return []; // but not in segment#2\r\n          return [inSeg1Pt1];\r\n        }\r\n        // segment#2  is a single point\r\n        if (seg2Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1)) return []; // but not in segment#1\r\n          return [inSeg2Pt1];\r\n        }\r\n\r\n        // they are collinear segments, which might overlap\r\n        var seg1min, seg1max, seg1minVal, seg1maxVal;\r\n        var seg2min, seg2max, seg2minVal, seg2maxVal;\r\n        if (seg1dx != 0) { // the segments are NOT on a vertical line\r\n          if (inSeg1Pt1.x < inSeg1Pt2.x) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.x;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.x;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.x;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.x;\r\n          }\r\n          if (inSeg2Pt1.x < inSeg2Pt2.x) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.x;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.x;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.x;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.x;\r\n          }\r\n        }\r\n        else { // the segments are on a vertical line\r\n          if (inSeg1Pt1.y < inSeg1Pt2.y) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.y;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.y;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.y;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.y;\r\n          }\r\n          if (inSeg2Pt1.y < inSeg2Pt2.y) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.y;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.y;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.y;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.y;\r\n          }\r\n        }\r\n        if (seg1minVal <= seg2minVal) {\r\n          if (seg1maxVal < seg2minVal) return [];\r\n          if (seg1maxVal == seg2minVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg2min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg2min, seg1max];\r\n          return [seg2min, seg2max];\r\n        }\r\n        else {\r\n          if (seg1minVal > seg2maxVal) return [];\r\n          if (seg1minVal == seg2maxVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg1min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg1min, seg1max];\r\n          return [seg1min, seg2max];\r\n        }\r\n      }\r\n    }\r\n\r\n    function isPointInsideAngle(inVertex, inLegFromPt, inLegToPt, inOtherPt) {\r\n      // The order of legs is important\r\n\r\n      var EPSILON = 0.0000000001;\r\n\r\n      // translation of all points, so that Vertex is at (0,0)\r\n      var legFromPtX = inLegFromPt.x - inVertex.x,\r\n        legFromPtY = inLegFromPt.y - inVertex.y;\r\n      var legToPtX = inLegToPt.x - inVertex.x,\r\n        legToPtY = inLegToPt.y - inVertex.y;\r\n      var otherPtX = inOtherPt.x - inVertex.x,\r\n        otherPtY = inOtherPt.y - inVertex.y;\r\n\r\n      // main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n      var from2toAngle = legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n      var from2otherAngle = legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n      if (Math.abs(from2toAngle) > EPSILON) { // angle != 180 deg.\r\n\r\n        var other2toAngle = otherPtX * legToPtY - otherPtY * legToPtX;\r\n        // console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n        if (from2toAngle > 0) { // main angle < 180 deg.\r\n          return ((from2otherAngle >= 0) && (other2toAngle >= 0));\r\n        }\r\n        else { // main angle > 180 deg.\r\n          return ((from2otherAngle >= 0) || (other2toAngle >= 0));\r\n        }\r\n      }\r\n      else { // angle == 180 deg.\r\n        // console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n        return (from2otherAngle > 0);\r\n      }\r\n    }\r\n\r\n\r\n    function removeHoles(contour, holes) {\r\n\r\n      var shape = contour.concat(); // work on this shape\r\n      var hole;\r\n\r\n      function isCutLineInsideAngles(inShapeIdx, inHoleIdx) {\r\n        // Check if hole point lies within angle around shape point\r\n        var lastShapeIdx = shape.length - 1;\r\n\r\n        var prevShapeIdx = inShapeIdx - 1;\r\n        if (prevShapeIdx < 0) prevShapeIdx = lastShapeIdx;\r\n\r\n        var nextShapeIdx = inShapeIdx + 1;\r\n        if (nextShapeIdx > lastShapeIdx) nextShapeIdx = 0;\r\n\r\n        var insideAngle = isPointInsideAngle(shape[inShapeIdx], shape[prevShapeIdx], shape[nextShapeIdx], hole[inHoleIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n          return false;\r\n        }\r\n\r\n        // Check if shape point lies within angle around hole point\r\n        var lastHoleIdx = hole.length - 1;\r\n\r\n        var prevHoleIdx = inHoleIdx - 1;\r\n        if (prevHoleIdx < 0) prevHoleIdx = lastHoleIdx;\r\n\r\n        var nextHoleIdx = inHoleIdx + 1;\r\n        if (nextHoleIdx > lastHoleIdx) nextHoleIdx = 0;\r\n\r\n        insideAngle = isPointInsideAngle(hole[inHoleIdx], hole[prevHoleIdx], hole[nextHoleIdx], shape[inShapeIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n          return false;\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      function intersectsShapeEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with shape edges\r\n        var sIdx, nextIdx, intersection;\r\n        for (sIdx = 0; sIdx < shape.length; sIdx++) {\r\n          nextIdx = sIdx + 1;\r\n          nextIdx %= shape.length;\r\n          intersection = intersect_segments_2D(inShapePt, inHolePt, shape[sIdx], shape[nextIdx], true);\r\n          if (intersection.length > 0) return true;\r\n        }\r\n\r\n        return false;\r\n      }\r\n\r\n      var indepHoles = [];\r\n\r\n      function intersectsHoleEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with hole edges\r\n        var ihIdx, chkHole,\r\n          hIdx, nextIdx, intersection;\r\n        for (ihIdx = 0; ihIdx < indepHoles.length; ihIdx++) {\r\n          chkHole = holes[indepHoles[ihIdx]];\r\n          for (hIdx = 0; hIdx < chkHole.length; hIdx++) {\r\n            nextIdx = hIdx + 1;\r\n            nextIdx %= chkHole.length;\r\n            intersection = intersect_segments_2D(inShapePt, inHolePt, chkHole[hIdx], chkHole[nextIdx], true);\r\n            if (intersection.length > 0) return true;\r\n          }\r\n        }\r\n        return false;\r\n      }\r\n\r\n      var holeIndex, shapeIndex,\r\n        shapePt, holePt,\r\n        holeIdx, cutKey, failedCuts = [],\r\n        tmpShape1, tmpShape2,\r\n        tmpHole1, tmpHole2;\r\n\r\n      for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n        indepHoles.push(h);\r\n\r\n      }\r\n\r\n      var minShapeIndex = 0;\r\n      var counter = indepHoles.length * 2;\r\n      while (indepHoles.length > 0) {\r\n        counter--;\r\n        if (counter < 0) {\r\n          console.log(\"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\");\r\n          break;\r\n        }\r\n\r\n        // search for shape-vertex and hole-vertex,\r\n        // which can be connected without intersections\r\n        for (shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex++) {\r\n\r\n          shapePt = shape[shapeIndex];\r\n          holeIndex = -1;\r\n\r\n          // search for hole which can be reached without intersections\r\n          for (var h = 0; h < indepHoles.length; h++) {\r\n            holeIdx = indepHoles[h];\r\n\r\n            // prevent multiple checks\r\n            cutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n            if (failedCuts[cutKey] !== undefined) continue;\r\n\r\n            hole = holes[holeIdx];\r\n            for (var h2 = 0; h2 < hole.length; h2++) {\r\n              holePt = hole[h2];\r\n              if (!isCutLineInsideAngles(shapeIndex, h2)) continue;\r\n              if (intersectsShapeEdge(shapePt, holePt)) continue;\r\n              if (intersectsHoleEdge(shapePt, holePt)) continue;\r\n\r\n              holeIndex = h2;\r\n              indepHoles.splice(h, 1);\r\n\r\n              tmpShape1 = shape.slice(0, shapeIndex + 1);\r\n              tmpShape2 = shape.slice(shapeIndex);\r\n              tmpHole1 = hole.slice(holeIndex);\r\n              tmpHole2 = hole.slice(0, holeIndex + 1);\r\n\r\n              shape = tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2);\r\n\r\n              minShapeIndex = shapeIndex;\r\n\r\n              // Debug only, to show the selected cuts\r\n              // glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n              break;\r\n            }\r\n            if (holeIndex >= 0) break; // hole-vertex found\r\n\r\n            failedCuts[cutKey] = true; // remember failure\r\n          }\r\n          if (holeIndex >= 0) break; // hole-vertex found\r\n        }\r\n      }\r\n\r\n      return shape; /* shape with no holes */\r\n    }\r\n\r\n\r\n    var i, il, f, face,\r\n      key, index,\r\n      allPointsMap = {};\r\n\r\n    // To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n    var allpoints = contour.concat();\r\n\r\n    for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      Array.prototype.push.apply(allpoints, holes[h]);\r\n\r\n    }\r\n\r\n    //console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n    // prepare all points map\r\n\r\n    for (i = 0, il = allpoints.length; i < il; i++) {\r\n\r\n      key = allpoints[i].x + \":\" + allpoints[i].y;\r\n\r\n      if (allPointsMap[key] !== undefined) {\r\n\r\n        THREE.warn(\"THREE.Shape: Duplicate point\", key);\r\n\r\n      }\r\n\r\n      allPointsMap[key] = i;\r\n\r\n    }\r\n\r\n    // remove holes by cutting paths to holes and adding them to the shape\r\n    var shapeWithoutHoles = removeHoles(contour, holes);\r\n\r\n    var triangles = THREE.FontUtils.Triangulate(shapeWithoutHoles, false); // True returns indices for points of spooled shape\r\n    //console.log( \"triangles\",triangles, triangles.length );\r\n\r\n    // check all face vertices against all points map\r\n\r\n    for (i = 0, il = triangles.length; i < il; i++) {\r\n\r\n      face = triangles[i];\r\n\r\n      for (f = 0; f < 3; f++) {\r\n\r\n        key = face[f].x + \":\" + face[f].y;\r\n\r\n        index = allPointsMap[key];\r\n\r\n        if (index !== undefined) {\r\n\r\n          face[f] = index;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return triangles.concat();\r\n\r\n  },\r\n\r\n  isClockWise: function(pts) {\r\n\r\n    return THREE.FontUtils.Triangulate.area(pts) < 0;\r\n\r\n  },\r\n\r\n  // Bezier Curves formulas obtained from\r\n  // http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n  // Quad Bezier Functions\r\n\r\n  b2p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * p;\r\n\r\n  },\r\n\r\n  b2p1: function(t, p) {\r\n\r\n    return 2 * (1 - t) * t * p;\r\n\r\n  },\r\n\r\n  b2p2: function(t, p) {\r\n\r\n    return t * t * p;\r\n\r\n  },\r\n\r\n  b2: function(t, p0, p1, p2) {\r\n\r\n    return this.b2p0(t, p0) + this.b2p1(t, p1) + this.b2p2(t, p2);\r\n\r\n  },\r\n\r\n  // Cubic Bezier Functions\r\n\r\n  b3p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * k * p;\r\n\r\n  },\r\n\r\n  b3p1: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * k * t * p;\r\n\r\n  },\r\n\r\n  b3p2: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * t * t * p;\r\n\r\n  },\r\n\r\n  b3p3: function(t, p) {\r\n\r\n    return t * t * t * p;\r\n\r\n  },\r\n\r\n  b3: function(t, p0, p1, p2, p3) {\r\n\r\n    return this.b3p0(t, p0) + this.b3p1(t, p1) + this.b3p2(t, p2) + this.b3p3(t, p3);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function(v1, v2) {\r\n\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function(t) {\r\n\r\n  var point = this.v2.clone().sub(this.v1);\r\n  point.multiplyScalar(t).add(this.v1);\r\n\r\n  return point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function(u) {\r\n\r\n  return this.getPoint(u);\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function(t) {\r\n\r\n  var tangent = this.v2.clone().sub(this.v1);\r\n\r\n  return tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function(v0, v1, v2) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  // returns unit vector\r\n\r\n  return vector.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function(v0, v1, v2, v3) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n  this.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  return new THREE.Vector2(tx, ty);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  var tangent = new THREE.Vector2(tx, ty);\r\n  tangent.normalize();\r\n\r\n  return tangent;\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function(points /* array of Vector2 */ ) {\r\n\r\n  this.points = (points == undefined) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function(t) {\r\n\r\n  var points = this.points;\r\n  var point = (points.length - 1) * t;\r\n\r\n  var intPoint = Math.floor(point);\r\n  var weight = point - intPoint;\r\n\r\n  var point0 = points[intPoint == 0 ? intPoint : intPoint - 1]\r\n  var point1 = points[intPoint]\r\n  var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1]\r\n  var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2]\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n  vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function(aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  this.aX = aX;\r\n  this.aY = aY;\r\n\r\n  this.xRadius = xRadius;\r\n  this.yRadius = yRadius;\r\n\r\n  this.aStartAngle = aStartAngle;\r\n  this.aEndAngle = aEndAngle;\r\n\r\n  this.aClockwise = aClockwise;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function(t) {\r\n\r\n  var deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n  if (deltaAngle < 0) deltaAngle += Math.PI * 2;\r\n  if (deltaAngle > Math.PI * 2) deltaAngle -= Math.PI * 2;\r\n\r\n  var angle;\r\n\r\n  if (this.aClockwise === true) {\r\n\r\n    angle = this.aEndAngle + (1 - t) * (Math.PI * 2 - deltaAngle);\r\n\r\n  }\r\n  else {\r\n\r\n    angle = this.aStartAngle + t * deltaAngle;\r\n\r\n  }\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = this.aX + this.xRadius * Math.cos(angle);\r\n  vector.y = this.aY + this.yRadius * Math.sin(angle);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function(aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  THREE.EllipseCurve.call(this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create(THREE.EllipseCurve.prototype);\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n  function(v1, v2) {\r\n\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.subVectors(this.v2, this.v1); // diff\r\n    vector.multiplyScalar(t);\r\n    vector.add(this.v1);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n    vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n    vector.z = THREE.Shape.Utils.b2(t, this.v0.z, this.v1.z, this.v2.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2, v3) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n    this.v3 = v3;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n    vector.y = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n    vector.z = THREE.Shape.Utils.b3(t, this.v0.z, this.v1.z, this.v2.z, this.v3.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 1) * t;\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    var point0 = points[intPoint == 0 ? intPoint : intPoint - 1];\r\n    var point1 = points[intPoint];\r\n    var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1];\r\n    var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 0) * t; // This needs to be from 0-length +1\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    intPoint += intPoint > 0 ? 0 : (Math.floor(Math.abs(intPoint) / points.length) + 1) * points.length;\r\n\r\n    var point0 = points[(intPoint - 1) % points.length];\r\n    var point1 = points[(intPoint) % points.length];\r\n    var point2 = points[(intPoint + 1) % points.length];\r\n    var point3 = points[(intPoint + 2) % points.length];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/animation/AnimationHandler.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\nTHREE.AnimationHandler = {\r\n\r\n  LINEAR: 0,\r\n  CATMULLROM: 1,\r\n  CATMULLROM_FORWARD: 2,\r\n\r\n  //\r\n\r\n  add: function() {\r\n    THREE.warn('THREE.AnimationHandler.add() has been deprecated.');\r\n  },\r\n  get: function() {\r\n    THREE.warn('THREE.AnimationHandler.get() has been deprecated.');\r\n  },\r\n  remove: function() {\r\n    THREE.warn('THREE.AnimationHandler.remove() has been deprecated.');\r\n  },\r\n\r\n  //\r\n\r\n  animations: [],\r\n\r\n  init: function(data) {\r\n\r\n    if (data.initialized === true) return data;\r\n\r\n    // loop through all keys\r\n\r\n    for (var h = 0; h < data.hierarchy.length; h++) {\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        // remove minus times\r\n\r\n        if (data.hierarchy[h].keys[k].time < 0) {\r\n\r\n          data.hierarchy[h].keys[k].time = 0;\r\n\r\n        }\r\n\r\n        // create quaternions\r\n\r\n        if (data.hierarchy[h].keys[k].rot !== undefined &&\r\n          !(data.hierarchy[h].keys[k].rot instanceof THREE.Quaternion)) {\r\n\r\n          var quat = data.hierarchy[h].keys[k].rot;\r\n          data.hierarchy[h].keys[k].rot = new THREE.Quaternion().fromArray(quat);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // prepare morph target keys\r\n\r\n      if (data.hierarchy[h].keys.length && data.hierarchy[h].keys[0].morphTargets !== undefined) {\r\n\r\n        // get all used\r\n\r\n        var usedMorphTargets = {};\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n            var morphTargetName = data.hierarchy[h].keys[k].morphTargets[m];\r\n            usedMorphTargets[morphTargetName] = -1;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        data.hierarchy[h].usedMorphTargets = usedMorphTargets;\r\n\r\n\r\n        // set all used on all frames\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          var influences = {};\r\n\r\n          for (var morphTargetName in usedMorphTargets) {\r\n\r\n            for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n              if (data.hierarchy[h].keys[k].morphTargets[m] === morphTargetName) {\r\n\r\n                influences[morphTargetName] = data.hierarchy[h].keys[k].morphTargetsInfluences[m];\r\n                break;\r\n\r\n              }\r\n\r\n            }\r\n\r\n            if (m === data.hierarchy[h].keys[k].morphTargets.length) {\r\n\r\n              influences[morphTargetName] = 0;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          data.hierarchy[h].keys[k].morphTargetsInfluences = influences;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // remove all keys that are on the same time\r\n\r\n      for (var k = 1; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        if (data.hierarchy[h].keys[k].time === data.hierarchy[h].keys[k - 1].time) {\r\n\r\n          data.hierarchy[h].keys.splice(k, 1);\r\n          k--;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // set index\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        data.hierarchy[h].keys[k].index = k;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    data.initialized = true;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  parse: function(root) {\r\n\r\n    var parseRecurseHierarchy = function(root, hierarchy) {\r\n\r\n      hierarchy.push(root);\r\n\r\n      for (var c = 0; c < root.children.length; c++)\r\n        parseRecurseHierarchy(root.children[c], hierarchy);\r\n\r\n    };\r\n\r\n    // setup hierarchy\r\n\r\n    var hierarchy = [];\r\n\r\n    if (root instanceof THREE.SkinnedMesh) {\r\n\r\n      for (var b = 0; b < root.skeleton.bones.length; b++) {\r\n\r\n        hierarchy.push(root.skeleton.bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      parseRecurseHierarchy(root, hierarchy);\r\n\r\n    }\r\n\r\n    return hierarchy;\r\n\r\n  },\r\n\r\n  play: function(animation) {\r\n\r\n    if (this.animations.indexOf(animation) === -1) {\r\n\r\n      this.animations.push(animation);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  stop: function(animation) {\r\n\r\n    var index = this.animations.indexOf(animation);\r\n\r\n    if (index !== -1) {\r\n\r\n      this.animations.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(deltaTimeMS) {\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].resetBlendWeights();\r\n\r\n    }\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].update(deltaTimeMS);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/Animation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Animation = function(root, data) {\r\n\r\n  this.root = root;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(root);\r\n\r\n  this.currentTime = 0;\r\n  this.timeScale = 1;\r\n\r\n  this.isPlaying = false;\r\n  this.loop = true;\r\n  this.weight = 0;\r\n\r\n  this.interpolationType = THREE.AnimationHandler.LINEAR;\r\n\r\n};\r\n\r\nTHREE.Animation.prototype = {\r\n\r\n  constructor: THREE.Animation,\r\n\r\n  keyTypes: [\"pos\", \"rot\", \"scl\"],\r\n\r\n  play: function(startTime, weight) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n    this.weight = weight !== undefined ? weight : 1;\r\n\r\n    this.isPlaying = true;\r\n\r\n    this.reset();\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n  },\r\n\r\n  reset: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n\r\n      if (object.animationCache === undefined) {\r\n\r\n        object.animationCache = {\r\n          animations: {},\r\n          blending: {\r\n            positionWeight: 0.0,\r\n            quaternionWeight: 0.0,\r\n            scaleWeight: 0.0\r\n          }\r\n        };\r\n      }\r\n\r\n      var name = this.data.name;\r\n      var animations = object.animationCache.animations;\r\n      var animationCache = animations[name];\r\n\r\n      if (animationCache === undefined) {\r\n\r\n        animationCache = {\r\n          prevKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          nextKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          originalMatrix: object.matrix\r\n        };\r\n\r\n        animations[name] = animationCache;\r\n\r\n      }\r\n\r\n      // Get keys to match our current time\r\n\r\n      for (var t = 0; t < 3; t++) {\r\n\r\n        var type = this.keyTypes[t];\r\n\r\n        var prevKey = this.data.hierarchy[h].keys[0];\r\n        var nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n        while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n          prevKey = nextKey;\r\n          nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n        }\r\n\r\n        animationCache.prevKey[type] = prevKey;\r\n        animationCache.nextKey[type] = nextKey;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  resetBlendWeights: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var animationCache = object.animationCache;\r\n\r\n      if (animationCache !== undefined) {\r\n\r\n        var blending = animationCache.blending;\r\n\r\n        blending.positionWeight = 0.0;\r\n        blending.quaternionWeight = 0.0;\r\n        blending.scaleWeight = 0.0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: (function() {\r\n\r\n    var points = [];\r\n    var target = new THREE.Vector3();\r\n    var newVector = new THREE.Vector3();\r\n    var newQuat = new THREE.Quaternion();\r\n\r\n    // Catmull-Rom spline\r\n\r\n    var interpolateCatmullRom = function(points, scale) {\r\n\r\n      var c = [],\r\n        v3 = [],\r\n        point, intPoint, weight, w2, w3,\r\n        pa, pb, pc, pd;\r\n\r\n      point = (points.length - 1) * scale;\r\n      intPoint = Math.floor(point);\r\n      weight = point - intPoint;\r\n\r\n      c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n      c[1] = intPoint;\r\n      c[2] = intPoint > points.length - 2 ? intPoint : intPoint + 1;\r\n      c[3] = intPoint > points.length - 3 ? intPoint : intPoint + 2;\r\n\r\n      pa = points[c[0]];\r\n      pb = points[c[1]];\r\n      pc = points[c[2]];\r\n      pd = points[c[3]];\r\n\r\n      w2 = weight * weight;\r\n      w3 = weight * w2;\r\n\r\n      v3[0] = interpolate(pa[0], pb[0], pc[0], pd[0], weight, w2, w3);\r\n      v3[1] = interpolate(pa[1], pb[1], pc[1], pd[1], weight, w2, w3);\r\n      v3[2] = interpolate(pa[2], pb[2], pc[2], pd[2], weight, w2, w3);\r\n\r\n      return v3;\r\n\r\n    };\r\n\r\n    var interpolate = function(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n      var v0 = (p2 - p0) * 0.5,\r\n        v1 = (p3 - p1) * 0.5;\r\n\r\n      return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n    };\r\n\r\n    return function(delta) {\r\n\r\n      if (this.isPlaying === false) return;\r\n\r\n      this.currentTime += delta * this.timeScale;\r\n\r\n      if (this.weight === 0)\r\n        return;\r\n\r\n      //\r\n\r\n      var duration = this.data.length;\r\n\r\n      if (this.currentTime > duration || this.currentTime < 0) {\r\n\r\n        if (this.loop) {\r\n\r\n          this.currentTime %= duration;\r\n\r\n          if (this.currentTime < 0)\r\n            this.currentTime += duration;\r\n\r\n          this.reset();\r\n\r\n        }\r\n        else {\r\n\r\n          this.stop();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n        var object = this.hierarchy[h];\r\n        var animationCache = object.animationCache.animations[this.data.name];\r\n        var blending = object.animationCache.blending;\r\n\r\n        // loop through pos/rot/scl\r\n\r\n        for (var t = 0; t < 3; t++) {\r\n\r\n          // get keys\r\n\r\n          var type = this.keyTypes[t];\r\n          var prevKey = animationCache.prevKey[type];\r\n          var nextKey = animationCache.nextKey[type];\r\n\r\n          if ((this.timeScale > 0 && nextKey.time <= this.currentTime) ||\r\n            (this.timeScale < 0 && prevKey.time >= this.currentTime)) {\r\n\r\n            prevKey = this.data.hierarchy[h].keys[0];\r\n            nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n            while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n              prevKey = nextKey;\r\n              nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n            }\r\n\r\n            animationCache.prevKey[type] = prevKey;\r\n            animationCache.nextKey[type] = nextKey;\r\n\r\n          }\r\n\r\n          var scale = (this.currentTime - prevKey.time) / (nextKey.time - prevKey.time);\r\n\r\n          var prevXYZ = prevKey[type];\r\n          var nextXYZ = nextKey[type];\r\n\r\n          if (scale < 0) scale = 0;\r\n          if (scale > 1) scale = 1;\r\n\r\n          // interpolate\r\n\r\n          if (type === \"pos\") {\r\n\r\n            if (this.interpolationType === THREE.AnimationHandler.LINEAR) {\r\n\r\n              newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n              newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n              newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n              // blend\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              object.position.lerp(newVector, proportionalWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n            }\r\n            else if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n              this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n              points[0] = this.getPrevKeyWith(\"pos\", h, prevKey.index - 1)[\"pos\"];\r\n              points[1] = prevXYZ;\r\n              points[2] = nextXYZ;\r\n              points[3] = this.getNextKeyWith(\"pos\", h, nextKey.index + 1)[\"pos\"];\r\n\r\n              scale = scale * 0.33 + 0.33;\r\n\r\n              var currentPoint = interpolateCatmullRom(points, scale);\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n              // blend\r\n\r\n              var vector = object.position;\r\n\r\n              vector.x = vector.x + (currentPoint[0] - vector.x) * proportionalWeight;\r\n              vector.y = vector.y + (currentPoint[1] - vector.y) * proportionalWeight;\r\n              vector.z = vector.z + (currentPoint[2] - vector.z) * proportionalWeight;\r\n\r\n              if (this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n                var forwardPoint = interpolateCatmullRom(points, scale * 1.01);\r\n\r\n                target.set(forwardPoint[0], forwardPoint[1], forwardPoint[2]);\r\n                target.sub(vector);\r\n                target.y = 0;\r\n                target.normalize();\r\n\r\n                var angle = Math.atan2(target.x, target.z);\r\n                object.rotation.set(0, angle, 0);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"rot\") {\r\n\r\n            THREE.Quaternion.slerp(prevXYZ, nextXYZ, newQuat, scale);\r\n\r\n            // Avoid paying the cost of an additional slerp if we don't have to\r\n            if (blending.quaternionWeight === 0) {\r\n\r\n              object.quaternion.copy(newQuat);\r\n              blending.quaternionWeight = this.weight;\r\n\r\n            }\r\n            else {\r\n\r\n              var proportionalWeight = this.weight / (this.weight + blending.quaternionWeight);\r\n              THREE.Quaternion.slerp(object.quaternion, newQuat, object.quaternion, proportionalWeight);\r\n              blending.quaternionWeight += this.weight;\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"scl\") {\r\n\r\n            newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n            newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n            newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n            var proportionalWeight = this.weight / (this.weight + blending.scaleWeight);\r\n            object.scale.lerp(newVector, proportionalWeight);\r\n            blending.scaleWeight += this.weight;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  getNextKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key < keys.length - 1 ? key : keys.length - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key % keys.length;\r\n\r\n    }\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key > 0 ? key : 0;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key >= 0 ? key : key + keys.length;\r\n\r\n    }\r\n\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/KeyFrameAnimation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author khang duong\r\n * @author erik kitson\r\n */\r\n\r\nTHREE.KeyFrameAnimation = function(data) {\r\n\r\n  this.root = data.node;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(this.root);\r\n  this.currentTime = 0;\r\n  this.timeScale = 0.001;\r\n  this.isPlaying = false;\r\n  this.isPaused = true;\r\n  this.loop = true;\r\n\r\n  // initialize to first keyframes\r\n\r\n  for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n    var keys = this.data.hierarchy[h].keys,\r\n      sids = this.data.hierarchy[h].sids,\r\n      obj = this.hierarchy[h];\r\n\r\n    if (keys.length && sids) {\r\n\r\n      for (var s = 0; s < sids.length; s++) {\r\n\r\n        var sid = sids[s],\r\n          next = this.getNextKeyWith(sid, h, 0);\r\n\r\n        if (next) {\r\n\r\n          next.apply(sid);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      obj.matrixAutoUpdate = false;\r\n      this.data.hierarchy[h].node.updateMatrix();\r\n      obj.matrixWorldNeedsUpdate = true;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.KeyFrameAnimation.prototype = {\r\n\r\n  constructor: THREE.KeyFrameAnimation,\r\n\r\n  play: function(startTime) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n\r\n    if (this.isPlaying === false) {\r\n\r\n      this.isPlaying = true;\r\n\r\n      // reset key cache\r\n\r\n      var h, hl = this.hierarchy.length,\r\n        object,\r\n        node;\r\n\r\n      for (h = 0; h < hl; h++) {\r\n\r\n        object = this.hierarchy[h];\r\n        node = this.data.hierarchy[h];\r\n\r\n        if (node.animationCache === undefined) {\r\n\r\n          node.animationCache = {};\r\n          node.animationCache.prevKey = null;\r\n          node.animationCache.nextKey = null;\r\n          node.animationCache.originalMatrix = object.matrix;\r\n\r\n        }\r\n\r\n        var keys = this.data.hierarchy[h].keys;\r\n\r\n        if (keys.length) {\r\n\r\n          node.animationCache.prevKey = keys[0];\r\n          node.animationCache.nextKey = keys[1];\r\n\r\n          this.startTime = Math.min(keys[0].time, this.startTime);\r\n          this.endTime = Math.max(keys[keys.length - 1].time, this.endTime);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.update(0);\r\n\r\n    }\r\n\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n    // reset JIT matrix and remove cache\r\n\r\n    for (var h = 0; h < this.data.hierarchy.length; h++) {\r\n\r\n      var obj = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      if (node.animationCache !== undefined) {\r\n\r\n        var original = node.animationCache.originalMatrix;\r\n\r\n        original.copy(obj.matrix);\r\n        obj.matrix = original;\r\n\r\n        delete node.animationCache;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta * this.timeScale;\r\n\r\n    //\r\n\r\n    var duration = this.data.length;\r\n\r\n    if (this.loop === true && this.currentTime > duration) {\r\n\r\n      this.currentTime %= duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, duration);\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      var keys = node.keys,\r\n        animationCache = node.animationCache;\r\n\r\n\r\n      if (keys.length) {\r\n\r\n        var prevKey = animationCache.prevKey;\r\n        var nextKey = animationCache.nextKey;\r\n\r\n        if (nextKey.time <= this.currentTime) {\r\n\r\n          while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n            prevKey = nextKey;\r\n            nextKey = keys[prevKey.index + 1];\r\n\r\n          }\r\n\r\n          animationCache.prevKey = prevKey;\r\n          animationCache.nextKey = nextKey;\r\n\r\n        }\r\n\r\n        if (nextKey.time >= this.currentTime) {\r\n\r\n          prevKey.interpolate(nextKey, this.currentTime);\r\n\r\n        }\r\n        else {\r\n\r\n          prevKey.interpolate(nextKey, nextKey.time);\r\n\r\n        }\r\n\r\n        this.data.hierarchy[h].node.updateMatrix();\r\n        object.matrixWorldNeedsUpdate = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getNextKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key % keys.length;\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key >= 0 ? key : key + keys.length;\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/MorphAnimation.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com\r\n * @author willy-vvu / http://willy-vvu.github.io\r\n */\r\n\r\nTHREE.MorphAnimation = function(mesh) {\r\n\r\n  this.mesh = mesh;\r\n  this.frames = mesh.morphTargetInfluences.length;\r\n  this.currentTime = 0;\r\n  this.duration = 1000;\r\n  this.loop = true;\r\n  this.lastFrame = 0;\r\n  this.currentFrame = 0;\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimation.prototype = {\r\n\r\n  constructor: THREE.MorphAnimation,\r\n\r\n  play: function() {\r\n\r\n    this.isPlaying = true;\r\n\r\n  },\r\n\r\n  pause: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta;\r\n\r\n    if (this.loop === true && this.currentTime > this.duration) {\r\n\r\n      this.currentTime %= this.duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, this.duration);\r\n\r\n    var interpolation = this.duration / this.frames;\r\n    var frame = Math.floor(this.currentTime / interpolation);\r\n\r\n    var influences = this.mesh.morphTargetInfluences;\r\n\r\n    if (frame != this.currentFrame) {\r\n\r\n      influences[this.lastFrame] = 0;\r\n      influences[this.currentFrame] = 1;\r\n      influences[frame] = 0;\r\n\r\n      this.lastFrame = this.currentFrame;\r\n      this.currentFrame = frame;\r\n\r\n    }\r\n\r\n    influences[frame] = (this.currentTime % interpolation) / interpolation;\r\n    influences[this.lastFrame] = 1 - influences[frame];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'BoxGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    depth: depth,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    depthSegments: depthSegments\r\n  };\r\n\r\n  this.widthSegments = widthSegments || 1;\r\n  this.heightSegments = heightSegments || 1;\r\n  this.depthSegments = depthSegments || 1;\r\n\r\n  var scope = this;\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n  var depth_half = depth / 2;\r\n\r\n  buildPlane('z', 'y', -1, -1, depth, height, width_half, 0); // px\r\n  buildPlane('z', 'y', 1, -1, depth, height, -width_half, 1); // nx\r\n  buildPlane('x', 'z', 1, 1, width, depth, height_half, 2); // py\r\n  buildPlane('x', 'z', 1, -1, width, depth, -height_half, 3); // ny\r\n  buildPlane('x', 'y', 1, -1, width, height, depth_half, 4); // pz\r\n  buildPlane('x', 'y', -1, -1, width, height, -depth_half, 5); // nz\r\n\r\n  function buildPlane(u, v, udir, vdir, width, height, depth, materialIndex) {\r\n\r\n    var w, ix, iy,\r\n      gridX = scope.widthSegments,\r\n      gridY = scope.heightSegments,\r\n      width_half = width / 2,\r\n      height_half = height / 2,\r\n      offset = scope.vertices.length;\r\n\r\n    if ((u === 'x' && v === 'y') || (u === 'y' && v === 'x')) {\r\n\r\n      w = 'z';\r\n\r\n    }\r\n    else if ((u === 'x' && v === 'z') || (u === 'z' && v === 'x')) {\r\n\r\n      w = 'y';\r\n      gridY = scope.depthSegments;\r\n\r\n    }\r\n    else if ((u === 'z' && v === 'y') || (u === 'y' && v === 'z')) {\r\n\r\n      w = 'x';\r\n      gridX = scope.depthSegments;\r\n\r\n    }\r\n\r\n    var gridX1 = gridX + 1,\r\n      gridY1 = gridY + 1,\r\n      segment_width = width / gridX,\r\n      segment_height = height / gridY,\r\n      normal = new THREE.Vector3();\r\n\r\n    normal[w] = depth > 0 ? 1 : -1;\r\n\r\n    for (iy = 0; iy < gridY1; iy++) {\r\n\r\n      for (ix = 0; ix < gridX1; ix++) {\r\n\r\n        var vector = new THREE.Vector3();\r\n        vector[u] = (ix * segment_width - width_half) * udir;\r\n        vector[v] = (iy * segment_height - height_half) * vdir;\r\n        vector[w] = depth;\r\n\r\n        scope.vertices.push(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (iy = 0; iy < gridY; iy++) {\r\n\r\n      for (ix = 0; ix < gridX; ix++) {\r\n\r\n        var a = ix + gridX1 * iy;\r\n        var b = ix + gridX1 * (iy + 1);\r\n        var c = (ix + 1) + gridX1 * (iy + 1);\r\n        var d = (ix + 1) + gridX1 * iy;\r\n\r\n        var uva = new THREE.Vector2(ix / gridX, 1 - iy / gridY);\r\n        var uvb = new THREE.Vector2(ix / gridX, 1 - (iy + 1) / gridY);\r\n        var uvc = new THREE.Vector2((ix + 1) / gridX, 1 - (iy + 1) / gridY);\r\n        var uvd = new THREE.Vector2((ix + 1) / gridX, 1 - iy / gridY);\r\n\r\n        var face = new THREE.Face3(a + offset, b + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n        face = new THREE.Face3(b + offset, c + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function(radius, segments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CircleGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    segments: segments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n  segments = segments !== undefined ? Math.max(3, segments) : 8;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  var i, uvs = [],\r\n    center = new THREE.Vector3(),\r\n    centerUV = new THREE.Vector2(0.5, 0.5);\r\n\r\n  this.vertices.push(center);\r\n  uvs.push(centerUV);\r\n\r\n  for (i = 0; i <= segments; i++) {\r\n\r\n    var vertex = new THREE.Vector3();\r\n    var segment = thetaStart + i / segments * thetaLength;\r\n\r\n    vertex.x = radius * Math.cos(segment);\r\n    vertex.y = radius * Math.sin(segment);\r\n\r\n    this.vertices.push(vertex);\r\n    uvs.push(new THREE.Vector2((vertex.x / radius + 1) / 2, (vertex.y / radius + 1) / 2));\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 1; i <= segments; i++) {\r\n\r\n    this.faces.push(new THREE.Face3(i, i + 1, 0, [n.clone(), n.clone(), n.clone()]));\r\n    this.faceVertexUvs[0].push([uvs[i].clone(), uvs[i + 1].clone(), centerUV.clone()]);\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CubeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.CubeGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.warn('THREE.CubeGeometry has been renamed to THREE.BoxGeometry.');\r\n  return new THREE.BoxGeometry(width, height, depth, widthSegments, heightSegments, depthSegments);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function(radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CylinderGeometry';\r\n\r\n  this.parameters = {\r\n    radiusTop: radiusTop,\r\n    radiusBottom: radiusBottom,\r\n    height: height,\r\n    radialSegments: radialSegments,\r\n    heightSegments: heightSegments,\r\n    openEnded: openEnded,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n  radiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n  height = height !== undefined ? height : 100;\r\n\r\n  radialSegments = radialSegments || 8;\r\n  heightSegments = heightSegments || 1;\r\n\r\n  openEnded = openEnded !== undefined ? openEnded : false;\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n  var heightHalf = height / 2;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    var v = y / heightSegments;\r\n    var radius = v * (radiusBottom - radiusTop) + radiusTop;\r\n\r\n    for (x = 0; x <= radialSegments; x++) {\r\n\r\n      var u = x / radialSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = radius * Math.sin(u * thetaLength + thetaStart);\r\n      vertex.y = -v * height + heightHalf;\r\n      vertex.z = radius * Math.cos(u * thetaLength + thetaStart);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  var tanTheta = (radiusBottom - radiusTop) / height;\r\n  var na, nb;\r\n\r\n  for (x = 0; x < radialSegments; x++) {\r\n\r\n    if (radiusTop !== 0) {\r\n\r\n      na = this.vertices[vertices[0][x]].clone();\r\n      nb = this.vertices[vertices[0][x + 1]].clone();\r\n\r\n    }\r\n    else {\r\n\r\n      na = this.vertices[vertices[1][x]].clone();\r\n      nb = this.vertices[vertices[1][x + 1]].clone();\r\n\r\n    }\r\n\r\n    na.setY(Math.sqrt(na.x * na.x + na.z * na.z) * tanTheta).normalize();\r\n    nb.setY(Math.sqrt(nb.x * nb.x + nb.z * nb.z) * tanTheta).normalize();\r\n\r\n    for (y = 0; y < heightSegments; y++) {\r\n\r\n      var v1 = vertices[y][x];\r\n      var v2 = vertices[y + 1][x];\r\n      var v3 = vertices[y + 1][x + 1];\r\n      var v4 = vertices[y][x + 1];\r\n\r\n      var n1 = na.clone();\r\n      var n2 = na.clone();\r\n      var n3 = nb.clone();\r\n      var n4 = nb.clone();\r\n\r\n      var uv1 = uvs[y][x].clone();\r\n      var uv2 = uvs[y + 1][x].clone();\r\n      var uv3 = uvs[y + 1][x + 1].clone();\r\n      var uv4 = uvs[y][x + 1].clone();\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n      this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n      this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // top cap\r\n\r\n  if (openEnded === false && radiusTop > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[0][x];\r\n      var v2 = vertices[0][x + 1];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, 1, 0);\r\n      var n2 = new THREE.Vector3(0, 1, 0);\r\n      var n3 = new THREE.Vector3(0, 1, 0);\r\n\r\n      var uv1 = uvs[0][x].clone();\r\n      var uv2 = uvs[0][x + 1].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 0);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // bottom cap\r\n\r\n  if (openEnded === false && radiusBottom > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, -heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[heightSegments][x + 1];\r\n      var v2 = vertices[heightSegments][x];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, -1, 0);\r\n      var n2 = new THREE.Vector3(0, -1, 0);\r\n      var n3 = new THREE.Vector3(0, -1, 0);\r\n\r\n      var uv1 = uvs[heightSegments][x + 1].clone();\r\n      var uv2 = uvs[heightSegments][x].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 1);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segements of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  material: <int> // material index for front and back faces\r\n *  extrudeMaterial: <int> // material index for extrusion and beveled faces\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function(shapes, options) {\r\n\r\n  if (typeof(shapes) === \"undefined\") {\r\n    shapes = [];\r\n    return;\r\n  }\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ExtrudeGeometry';\r\n\r\n  shapes = shapes instanceof Array ? shapes : [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n  // can't really use automatic vertex normals\r\n  // as then front and back sides get smoothed too\r\n  // should do separate smoothing just for sides\r\n\r\n  //this.computeVertexNormals();\r\n\r\n  //console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function(shapes, options) {\r\n  var sl = shapes.length;\r\n\r\n  for (var s = 0; s < sl; s++) {\r\n    var shape = shapes[s];\r\n    this.addShape(shape, options);\r\n  }\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  var amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n  var bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n  var bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n  var bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n  var bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n  var extrudePath = options.extrudePath;\r\n  var extrudePts, extrudeByPath = false;\r\n\r\n  var material = options.material;\r\n  var extrudeMaterial = options.extrudeMaterial;\r\n\r\n  // Use default WorldUVGenerator if no UV generators are specified.\r\n  var uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n  var splineTube, binormal, normal, position2;\r\n  if (extrudePath) {\r\n\r\n    extrudePts = extrudePath.getSpacedPoints(steps);\r\n\r\n    extrudeByPath = true;\r\n    bevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n    // SETUP TNB variables\r\n\r\n    // Reuse TNB from TubeGeomtry for now.\r\n    // TODO1 - have a .isClosed in spline?\r\n\r\n    splineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames(extrudePath, steps, false);\r\n\r\n    // console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n    binormal = new THREE.Vector3();\r\n    normal = new THREE.Vector3();\r\n    position2 = new THREE.Vector3();\r\n\r\n  }\r\n\r\n  // Safeguards if bevels are not enabled\r\n\r\n  if (!bevelEnabled) {\r\n\r\n    bevelSegments = 0;\r\n    bevelThickness = 0;\r\n    bevelSize = 0;\r\n\r\n  }\r\n\r\n  // Variables initalization\r\n\r\n  var ahole, h, hl; // looping of holes\r\n  var scope = this;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(ahole)) {\r\n\r\n        holes[h] = ahole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n  }\r\n\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  /* Vertices */\r\n\r\n  var contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    vertices = vertices.concat(ahole);\r\n\r\n  }\r\n\r\n\r\n  function scalePt2(pt, vec, size) {\r\n\r\n    if (!vec) THREE.error(\"THREE.ExtrudeGeometry: vec does not exist\");\r\n\r\n    return vec.clone().multiplyScalar(size).add(pt);\r\n\r\n  }\r\n\r\n  var b, bs, t, z,\r\n    vert, vlen = vertices.length,\r\n    face, flen = faces.length;\r\n\r\n\r\n  // Find directions for point movement\r\n\r\n\r\n  function getBevelVec(inPt, inPrev, inNext) {\r\n\r\n    var EPSILON = 0.0000000001;\r\n\r\n    // computes for inPt the corresponding point inPt' on a new contour\r\n    //   shiftet by 1 unit (length of normalized vector) to the left\r\n    // if we walk along contour clockwise, this new contour is outside the old one\r\n    //\r\n    // inPt' is the intersection of the two lines parallel to the two\r\n    //  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n    var v_trans_x, v_trans_y, shrink_by = 1; // resulting translation vector for inPt\r\n\r\n    // good reading for geometry algorithms (here: line-line intersection)\r\n    // http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n    var v_prev_x = inPt.x - inPrev.x,\r\n      v_prev_y = inPt.y - inPrev.y;\r\n    var v_next_x = inNext.x - inPt.x,\r\n      v_next_y = inNext.y - inPt.y;\r\n\r\n    var v_prev_lensq = (v_prev_x * v_prev_x + v_prev_y * v_prev_y);\r\n\r\n    // check for colinear edges\r\n    var colinear0 = (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n    if (Math.abs(colinear0) > EPSILON) { // not colinear\r\n\r\n      // length of vectors for normalizing\r\n\r\n      var v_prev_len = Math.sqrt(v_prev_lensq);\r\n      var v_next_len = Math.sqrt(v_next_x * v_next_x + v_next_y * v_next_y);\r\n\r\n      // shift adjacent points by unit vectors to the left\r\n\r\n      var ptPrevShift_x = (inPrev.x - v_prev_y / v_prev_len);\r\n      var ptPrevShift_y = (inPrev.y + v_prev_x / v_prev_len);\r\n\r\n      var ptNextShift_x = (inNext.x - v_next_y / v_next_len);\r\n      var ptNextShift_y = (inNext.y + v_next_x / v_next_len);\r\n\r\n      // scaling factor for v_prev to intersection point\r\n\r\n      var sf = ((ptNextShift_x - ptPrevShift_x) * v_next_y -\r\n          (ptNextShift_y - ptPrevShift_y) * v_next_x) /\r\n        (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n      // vector from inPt to intersection point\r\n\r\n      v_trans_x = (ptPrevShift_x + v_prev_x * sf - inPt.x);\r\n      v_trans_y = (ptPrevShift_y + v_prev_y * sf - inPt.y);\r\n\r\n      // Don't normalize!, otherwise sharp corners become ugly\r\n      //  but prevent crazy spikes\r\n      var v_trans_lensq = (v_trans_x * v_trans_x + v_trans_y * v_trans_y)\r\n      if (v_trans_lensq <= 2) {\r\n        return new THREE.Vector2(v_trans_x, v_trans_y);\r\n      }\r\n      else {\r\n        shrink_by = Math.sqrt(v_trans_lensq / 2);\r\n      }\r\n\r\n    }\r\n    else { // handle special case of colinear edges\r\n\r\n      var direction_eq = false; // assumes: opposite\r\n      if (v_prev_x > EPSILON) {\r\n        if (v_next_x > EPSILON) {\r\n          direction_eq = true;\r\n        }\r\n      }\r\n      else {\r\n        if (v_prev_x < -EPSILON) {\r\n          if (v_next_x < -EPSILON) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n        else {\r\n          if (Math.sign(v_prev_y) == Math.sign(v_next_y)) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (direction_eq) {\r\n        // console.log(\"Warning: lines are a straight sequence\");\r\n        v_trans_x = -v_prev_y;\r\n        v_trans_y = v_prev_x;\r\n        shrink_by = Math.sqrt(v_prev_lensq);\r\n      }\r\n      else {\r\n        // console.log(\"Warning: lines are a straight spike\");\r\n        v_trans_x = v_prev_x;\r\n        v_trans_y = v_prev_y;\r\n        shrink_by = Math.sqrt(v_prev_lensq / 2);\r\n      }\r\n\r\n    }\r\n\r\n    return new THREE.Vector2(v_trans_x / shrink_by, v_trans_y / shrink_by);\r\n\r\n  }\r\n\r\n\r\n  var contourMovements = [];\r\n\r\n  for (var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n    if (j === il) j = 0;\r\n    if (k === il) k = 0;\r\n\r\n    //  (j)---(i)---(k)\r\n    // console.log('i,j,k', i, j , k)\r\n\r\n    contourMovements[i] = getBevelVec(contour[i], contour[j], contour[k]);\r\n\r\n  }\r\n\r\n  var holesMovements = [],\r\n    oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    oneHoleMovements = [];\r\n\r\n    for (i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n      if (j === il) j = 0;\r\n      if (k === il) k = 0;\r\n\r\n      //  (j)---(i)---(k)\r\n      oneHoleMovements[i] = getBevelVec(ahole[i], ahole[j], ahole[k]);\r\n\r\n    }\r\n\r\n    holesMovements.push(oneHoleMovements);\r\n    verticesMovements = verticesMovements.concat(oneHoleMovements);\r\n\r\n  }\r\n\r\n\r\n  // Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n  for (b = 0; b < bevelSegments; b++) {\r\n    //for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n\r\n    //z = bevelThickness * t;\r\n    bs = bevelSize * (Math.sin(t * Math.PI / 2)); // curved\r\n    //bs = bevelSize * t ; // linear\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n\r\n      v(vert.x, vert.y, -z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        v(vert.x, vert.y, -z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  bs = bevelSize;\r\n\r\n  // Back facing vertices\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n    if (!extrudeByPath) {\r\n\r\n      v(vert.x, vert.y, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      // v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n      normal.copy(splineTube.normals[0]).multiplyScalar(vert.x);\r\n      binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y);\r\n\r\n      position2.copy(extrudePts[0]).add(normal).add(binormal);\r\n\r\n      v(position2.x, position2.y, position2.z);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Add stepped vertices...\r\n  // Including front facing vertices\r\n\r\n  var s;\r\n\r\n  for (s = 1; s <= steps; s++) {\r\n\r\n    for (i = 0; i < vlen; i++) {\r\n\r\n      vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n      if (!extrudeByPath) {\r\n\r\n        v(vert.x, vert.y, amount / steps * s);\r\n\r\n      }\r\n      else {\r\n\r\n        // v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n        normal.copy(splineTube.normals[s]).multiplyScalar(vert.x);\r\n        binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y);\r\n\r\n        position2.copy(extrudePts[s]).add(normal).add(binormal);\r\n\r\n        v(position2.x, position2.y, position2.z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Add bevel segments planes\r\n\r\n  //for ( b = 1; b <= bevelSegments; b ++ ) {\r\n  for (b = bevelSegments - 1; b >= 0; b--) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n    //bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n    bs = bevelSize * Math.sin(t * Math.PI / 2);\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n      v(vert.x, vert.y, amount + z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        if (!extrudeByPath) {\r\n\r\n          v(vert.x, vert.y, amount + z);\r\n\r\n        }\r\n        else {\r\n\r\n          v(vert.x, vert.y + extrudePts[steps - 1].y, extrudePts[steps - 1].x + z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  /* Faces */\r\n\r\n  // Top and bottom faces\r\n\r\n  buildLidFaces();\r\n\r\n  // Sides faces\r\n\r\n  buildSideFaces();\r\n\r\n\r\n  /////  Internal functions\r\n\r\n  function buildLidFaces() {\r\n\r\n    if (bevelEnabled) {\r\n\r\n      var layer = 0; // steps + 1\r\n      var offset = vlen * layer;\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2] + offset, face[1] + offset, face[0] + offset);\r\n\r\n      }\r\n\r\n      layer = steps + bevelSegments * 2;\r\n      offset = vlen * layer;\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + offset, face[1] + offset, face[2] + offset);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2], face[1], face[0]);\r\n\r\n      }\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + vlen * steps, face[1] + vlen * steps, face[2] + vlen * steps);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  // Create faces for the z-sides of the shape\r\n\r\n  function buildSideFaces() {\r\n\r\n    var layeroffset = 0;\r\n    sidewalls(contour, layeroffset);\r\n    layeroffset += contour.length;\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      sidewalls(ahole, layeroffset);\r\n\r\n      //, true\r\n      layeroffset += ahole.length;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function sidewalls(contour, layeroffset) {\r\n\r\n    var j, k;\r\n    i = contour.length;\r\n\r\n    while (--i >= 0) {\r\n\r\n      j = i;\r\n      k = i - 1;\r\n      if (k < 0) k = contour.length - 1;\r\n\r\n      //console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n      var s = 0,\r\n        sl = steps + bevelSegments * 2;\r\n\r\n      for (s = 0; s < sl; s++) {\r\n\r\n        var slen1 = vlen * s;\r\n        var slen2 = vlen * (s + 1);\r\n\r\n        var a = layeroffset + j + slen1,\r\n          b = layeroffset + k + slen1,\r\n          c = layeroffset + k + slen2,\r\n          d = layeroffset + j + slen2;\r\n\r\n        f4(a, b, c, d, contour, s, sl, j, k);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n\r\n  function v(x, y, z) {\r\n\r\n    scope.vertices.push(new THREE.Vector3(x, y, z));\r\n\r\n  }\r\n\r\n  function f3(a, b, c) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n\r\n    // normal, color, material\r\n    scope.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n\r\n    var uvs = uvgen.generateTopUV(scope, a, b, c);\r\n\r\n    scope.faceVertexUvs[0].push(uvs);\r\n\r\n  }\r\n\r\n  function f4(a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n    d += shapesOffset;\r\n\r\n    scope.faces.push(new THREE.Face3(a, b, d, null, null, extrudeMaterial));\r\n    scope.faces.push(new THREE.Face3(b, c, d, null, null, extrudeMaterial));\r\n\r\n    var uvs = uvgen.generateSideWallUV(scope, a, b, c, d);\r\n\r\n    scope.faceVertexUvs[0].push([uvs[0], uvs[1], uvs[3]]);\r\n    scope.faceVertexUvs[0].push([uvs[1], uvs[2], uvs[3]]);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n  generateTopUV: function(geometry, indexA, indexB, indexC) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n\r\n    return [\r\n      new THREE.Vector2(a.x, a.y),\r\n      new THREE.Vector2(b.x, b.y),\r\n      new THREE.Vector2(c.x, c.y)\r\n    ];\r\n\r\n  },\r\n\r\n  generateSideWallUV: function(geometry, indexA, indexB, indexC, indexD) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n    var d = vertices[indexD];\r\n\r\n    if (Math.abs(a.y - b.y) < 0.01) {\r\n      return [\r\n        new THREE.Vector2(a.x, 1 - a.z),\r\n        new THREE.Vector2(b.x, 1 - b.z),\r\n        new THREE.Vector2(c.x, 1 - c.z),\r\n        new THREE.Vector2(d.x, 1 - d.z)\r\n      ];\r\n    }\r\n    else {\r\n      return [\r\n        new THREE.Vector2(a.y, 1 - a.z),\r\n        new THREE.Vector2(b.y, 1 - b.z),\r\n        new THREE.Vector2(c.y, 1 - c.z),\r\n        new THREE.Vector2(d.y, 1 - d.z)\r\n      ];\r\n    }\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function(shapes, options) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ShapeGeometry';\r\n\r\n  if (shapes instanceof Array === false) shapes = [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function(shapes, options) {\r\n\r\n  for (var i = 0, l = shapes.length; i < l; i++) {\r\n\r\n    this.addShape(shapes[i], options);\r\n\r\n  }\r\n\r\n  return this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  if (options === undefined) options = {};\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var material = options.material;\r\n  var uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n  //\r\n\r\n  var i, l, hole;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n    for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n      hole = holes[i];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(hole)) {\r\n\r\n        holes[i] = hole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false;\r\n\r\n  }\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  // Vertices\r\n\r\n  var contour = vertices;\r\n\r\n  for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n    hole = holes[i];\r\n    vertices = vertices.concat(hole);\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var vert, vlen = vertices.length;\r\n  var face, flen = faces.length;\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = vertices[i];\r\n\r\n    this.vertices.push(new THREE.Vector3(vert.x, vert.y, 0));\r\n\r\n  }\r\n\r\n  for (i = 0; i < flen; i++) {\r\n\r\n    face = faces[i];\r\n\r\n    var a = face[0] + shapesOffset;\r\n    var b = face[1] + shapesOffset;\r\n    var c = face[2] + shapesOffset;\r\n\r\n    this.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n    this.faceVertexUvs[0].push(uvgen.generateTopUV(this, a, b, c));\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points \r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function(points, segments, phiStart, phiLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'LatheGeometry';\r\n\r\n  this.parameters = {\r\n    points: points,\r\n    segments: segments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength\r\n  };\r\n\r\n  segments = segments || 12;\r\n  phiStart = phiStart || 0;\r\n  phiLength = phiLength || 2 * Math.PI;\r\n\r\n  var inversePointLength = 1.0 / (points.length - 1);\r\n  var inverseSegments = 1.0 / segments;\r\n\r\n  for (var i = 0, il = segments; i <= il; i++) {\r\n\r\n    var phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n    var c = Math.cos(phi),\r\n      s = Math.sin(phi);\r\n\r\n    for (var j = 0, jl = points.length; j < jl; j++) {\r\n\r\n      var pt = points[j];\r\n\r\n      var vertex = new THREE.Vector3();\r\n\r\n      vertex.x = c * pt.x - s * pt.y;\r\n      vertex.y = s * pt.x + c * pt.y;\r\n      vertex.z = pt.z;\r\n\r\n      this.vertices.push(vertex);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var np = points.length;\r\n\r\n  for (var i = 0, il = segments; i < il; i++) {\r\n\r\n    for (var j = 0, jl = points.length - 1; j < jl; j++) {\r\n\r\n      var base = j + np * i;\r\n      var a = base;\r\n      var b = base + np;\r\n      var c = base + 1 + np;\r\n      var d = base + 1;\r\n\r\n      var u0 = i * inverseSegments;\r\n      var v0 = j * inversePointLength;\r\n      var u1 = u0 + inverseSegments;\r\n      var v1 = v0 + inversePointLength;\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u0, v0),\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u1, v1),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  console.info('THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.');\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PlaneGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  this.fromBufferGeometry(new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments));\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  THREE.BufferGeometry.call(this);\r\n\r\n  this.type = 'PlaneBufferGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n\r\n  var gridX = widthSegments || 1;\r\n  var gridY = heightSegments || 1;\r\n\r\n  var gridX1 = gridX + 1;\r\n  var gridY1 = gridY + 1;\r\n\r\n  var segment_width = width / gridX;\r\n  var segment_height = height / gridY;\r\n\r\n  var vertices = new Float32Array(gridX1 * gridY1 * 3);\r\n  var normals = new Float32Array(gridX1 * gridY1 * 3);\r\n  var uvs = new Float32Array(gridX1 * gridY1 * 2);\r\n\r\n  var offset = 0;\r\n  var offset2 = 0;\r\n\r\n  for (var iy = 0; iy < gridY1; iy++) {\r\n\r\n    var y = iy * segment_height - height_half;\r\n\r\n    for (var ix = 0; ix < gridX1; ix++) {\r\n\r\n      var x = ix * segment_width - width_half;\r\n\r\n      vertices[offset] = x;\r\n      vertices[offset + 1] = -y;\r\n\r\n      normals[offset + 2] = 1;\r\n\r\n      uvs[offset2] = ix / gridX;\r\n      uvs[offset2 + 1] = 1 - (iy / gridY);\r\n\r\n      offset += 3;\r\n      offset2 += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  offset = 0;\r\n\r\n  var indices = new((vertices.length / 3) > 65535 ? Uint32Array : Uint16Array)(gridX * gridY * 6);\r\n\r\n  for (var iy = 0; iy < gridY; iy++) {\r\n\r\n    for (var ix = 0; ix < gridX; ix++) {\r\n\r\n      var a = ix + gridX1 * iy;\r\n      var b = ix + gridX1 * (iy + 1);\r\n      var c = (ix + 1) + gridX1 * (iy + 1);\r\n      var d = (ix + 1) + gridX1 * iy;\r\n\r\n      indices[offset] = a;\r\n      indices[offset + 1] = b;\r\n      indices[offset + 2] = d;\r\n\r\n      indices[offset + 3] = b;\r\n      indices[offset + 4] = c;\r\n      indices[offset + 5] = d;\r\n\r\n      offset += 6;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  this.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n  this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function(innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'RingGeometry';\r\n\r\n  this.parameters = {\r\n    innerRadius: innerRadius,\r\n    outerRadius: outerRadius,\r\n    thetaSegments: thetaSegments,\r\n    phiSegments: phiSegments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  innerRadius = innerRadius || 0;\r\n  outerRadius = outerRadius || 50;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  thetaSegments = thetaSegments !== undefined ? Math.max(3, thetaSegments) : 8;\r\n  phiSegments = phiSegments !== undefined ? Math.max(1, phiSegments) : 8;\r\n\r\n  var i, o, uvs = [],\r\n    radius = innerRadius,\r\n    radiusStep = ((outerRadius - innerRadius) / phiSegments);\r\n\r\n  for (i = 0; i < phiSegments + 1; i++) { // concentric circles inside ring\r\n\r\n    for (o = 0; o < thetaSegments + 1; o++) { // number of segments per circle\r\n\r\n      var vertex = new THREE.Vector3();\r\n      var segment = thetaStart + o / thetaSegments * thetaLength;\r\n      vertex.x = radius * Math.cos(segment);\r\n      vertex.y = radius * Math.sin(segment);\r\n\r\n      this.vertices.push(vertex);\r\n      uvs.push(new THREE.Vector2((vertex.x / outerRadius + 1) / 2, (vertex.y / outerRadius + 1) / 2));\r\n    }\r\n\r\n    radius += radiusStep;\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 0; i < phiSegments; i++) { // concentric circles inside ring\r\n\r\n    var thetaSegment = i * (thetaSegments + 1);\r\n\r\n    for (o = 0; o < thetaSegments; o++) { // number of segments per circle\r\n\r\n      var segment = o + thetaSegment;\r\n\r\n      var v1 = segment;\r\n      var v2 = segment + thetaSegments + 1;\r\n      var v3 = segment + thetaSegments + 2;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n      v1 = segment;\r\n      v2 = segment + thetaSegments + 2;\r\n      v3 = segment + 1;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'SphereGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n\r\n  widthSegments = Math.max(3, Math.floor(widthSegments) || 8);\r\n  heightSegments = Math.max(2, Math.floor(heightSegments) || 6);\r\n\r\n  phiStart = phiStart !== undefined ? phiStart : 0;\r\n  phiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    for (x = 0; x <= widthSegments; x++) {\r\n\r\n      var u = x / widthSegments;\r\n      var v = y / heightSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = -radius * Math.cos(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n      vertex.y = radius * Math.cos(thetaStart + v * thetaLength);\r\n      vertex.z = radius * Math.sin(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  for (y = 0; y < heightSegments; y++) {\r\n\r\n    for (x = 0; x < widthSegments; x++) {\r\n\r\n      var v1 = vertices[y][x + 1];\r\n      var v2 = vertices[y][x];\r\n      var v3 = vertices[y + 1][x];\r\n      var v4 = vertices[y + 1][x + 1];\r\n\r\n      var n1 = this.vertices[v1].clone().normalize();\r\n      var n2 = this.vertices[v2].clone().normalize();\r\n      var n3 = this.vertices[v3].clone().normalize();\r\n      var n4 = this.vertices[v4].clone().normalize();\r\n\r\n      var uv1 = uvs[y][x + 1].clone();\r\n      var uv2 = uvs[y][x].clone();\r\n      var uv3 = uvs[y + 1][x].clone();\r\n      var uv4 = uvs[y + 1][x + 1].clone();\r\n\r\n      if (Math.abs(this.vertices[v1].y) === radius) {\r\n\r\n        uv1.x = (uv1.x + uv2.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v3, v4, [n1, n3, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv3, uv4]);\r\n\r\n      }\r\n      else if (Math.abs(this.vertices[v3].y) === radius) {\r\n\r\n        uv3.x = (uv3.x + uv4.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n        this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n        this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For creating 3D text geometry in three.js\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  size: \t\t\t<float>, \t// size of the text\r\n *  height: \t\t<float>, \t// thickness to extrude text\r\n *  curveSegments: \t<int>,\t\t// number of points on the curves\r\n *\r\n *  font: \t\t\t<string>,\t\t// font name\r\n *  weight: \t\t<string>,\t\t// font weight (normal, bold)\r\n *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\r\n *\r\n *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\r\n *  bevelThickness: <float>, \t\t// how deep into text bevel goes\r\n *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\r\n *  }\r\n *\r\n */\r\n\r\n/*\tUsage Examples\r\n\r\n\t// TextGeometry wrapper\r\n\r\n\tvar text3d = new TextGeometry( text, options );\r\n\r\n\t// Complete manner\r\n\r\n\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\r\n\tvar text3d = new ExtrudeGeometry( textShapes, options );\r\n\r\n*/\r\n\r\n\r\nTHREE.TextGeometry = function(text, parameters) {\r\n\r\n  parameters = parameters || {};\r\n\r\n  var textShapes = THREE.FontUtils.generateShapes(text, parameters);\r\n\r\n  // translate parameters to ExtrudeGeometry API\r\n\r\n  parameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n  // defaults\r\n\r\n  if (parameters.bevelThickness === undefined) parameters.bevelThickness = 10;\r\n  if (parameters.bevelSize === undefined) parameters.bevelSize = 8;\r\n  if (parameters.bevelEnabled === undefined) parameters.bevelEnabled = false;\r\n\r\n  THREE.ExtrudeGeometry.call(this, textShapes, parameters);\r\n\r\n  this.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create(THREE.ExtrudeGeometry.prototype);\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function(radius, tube, radialSegments, tubularSegments, arc) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    arc: arc\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 8;\r\n  tubularSegments = tubularSegments || 6;\r\n  arc = arc || Math.PI * 2;\r\n\r\n  var center = new THREE.Vector3(),\r\n    uvs = [],\r\n    normals = [];\r\n\r\n  for (var j = 0; j <= radialSegments; j++) {\r\n\r\n    for (var i = 0; i <= tubularSegments; i++) {\r\n\r\n      var u = i / tubularSegments * arc;\r\n      var v = j / radialSegments * Math.PI * 2;\r\n\r\n      center.x = radius * Math.cos(u);\r\n      center.y = radius * Math.sin(u);\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = (radius + tube * Math.cos(v)) * Math.cos(u);\r\n      vertex.y = (radius + tube * Math.cos(v)) * Math.sin(u);\r\n      vertex.z = tube * Math.sin(v);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      uvs.push(new THREE.Vector2(i / tubularSegments, j / radialSegments));\r\n      normals.push(vertex.clone().sub(center).normalize());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var j = 1; j <= radialSegments; j++) {\r\n\r\n    for (var i = 1; i <= tubularSegments; i++) {\r\n\r\n      var a = (tubularSegments + 1) * j + i - 1;\r\n      var b = (tubularSegments + 1) * (j - 1) + i - 1;\r\n      var c = (tubularSegments + 1) * (j - 1) + i;\r\n      var d = (tubularSegments + 1) * j + i;\r\n\r\n      var face = new THREE.Face3(a, b, d, [normals[a].clone(), normals[b].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[a].clone(), uvs[b].clone(), uvs[d].clone()]);\r\n\r\n      face = new THREE.Face3(b, c, d, [normals[b].clone(), normals[c].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[b].clone(), uvs[c].clone(), uvs[d].clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function(radius, tube, radialSegments, tubularSegments, p, q, heightScale) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusKnotGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    p: p,\r\n    q: q,\r\n    heightScale: heightScale\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 64;\r\n  tubularSegments = tubularSegments || 8;\r\n  p = p || 2;\r\n  q = q || 3;\r\n  heightScale = heightScale || 1;\r\n\r\n  var grid = new Array(radialSegments);\r\n  var tang = new THREE.Vector3();\r\n  var n = new THREE.Vector3();\r\n  var bitan = new THREE.Vector3();\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    grid[i] = new Array(tubularSegments);\r\n    var u = i / radialSegments * 2 * p * Math.PI;\r\n    var p1 = getPos(u, q, p, radius, heightScale);\r\n    var p2 = getPos(u + 0.01, q, p, radius, heightScale);\r\n    tang.subVectors(p2, p1);\r\n    n.addVectors(p2, p1);\r\n\r\n    bitan.crossVectors(tang, n);\r\n    n.crossVectors(bitan, tang);\r\n    bitan.normalize();\r\n    n.normalize();\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var v = j / tubularSegments * 2 * Math.PI;\r\n      var cx = -tube * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      var cy = tube * Math.sin(v);\r\n\r\n      var pos = new THREE.Vector3();\r\n      pos.x = p1.x + cx * n.x + cy * bitan.x;\r\n      pos.y = p1.y + cx * n.y + cy * bitan.y;\r\n      pos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\r\n      grid[i][j] = this.vertices.push(pos) - 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var ip = (i + 1) % radialSegments;\r\n      var jp = (j + 1) % tubularSegments;\r\n\r\n      var a = grid[i][j];\r\n      var b = grid[ip][j];\r\n      var c = grid[ip][jp];\r\n      var d = grid[i][jp];\r\n\r\n      var uva = new THREE.Vector2(i / radialSegments, j / tubularSegments);\r\n      var uvb = new THREE.Vector2((i + 1) / radialSegments, j / tubularSegments);\r\n      var uvc = new THREE.Vector2((i + 1) / radialSegments, (j + 1) / tubularSegments);\r\n      var uvd = new THREE.Vector2(i / radialSegments, (j + 1) / tubularSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n  function getPos(u, in_q, in_p, radius, heightScale) {\r\n\r\n    var cu = Math.cos(u);\r\n    var su = Math.sin(u);\r\n    var quOverP = in_q / in_p * u;\r\n    var cs = Math.cos(quOverP);\r\n\r\n    var tx = radius * (2 + cs) * 0.5 * cu;\r\n    var ty = radius * (2 + cs) * su * 0.5;\r\n    var tz = heightScale * radius * Math.sin(quOverP) * 0.5;\r\n\r\n    return new THREE.Vector3(tx, ty, tz);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function(path, segments, radius, radialSegments, closed, taper) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TubeGeometry';\r\n\r\n  this.parameters = {\r\n    path: path,\r\n    segments: segments,\r\n    radius: radius,\r\n    radialSegments: radialSegments,\r\n    closed: closed\r\n  };\r\n\r\n  segments = segments || 64;\r\n  radius = radius || 1;\r\n  radialSegments = radialSegments || 8;\r\n  closed = closed || false;\r\n  taper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n  var grid = [];\r\n\r\n  var scope = this,\r\n\r\n    tangent,\r\n    normal,\r\n    binormal,\r\n\r\n    numpoints = segments + 1,\r\n\r\n    u, v, r,\r\n\r\n    cx, cy,\r\n    pos, pos2 = new THREE.Vector3(),\r\n    i, j,\r\n    ip, jp,\r\n    a, b, c, d,\r\n    uva, uvb, uvc, uvd;\r\n\r\n  var frames = new THREE.TubeGeometry.FrenetFrames(path, segments, closed),\r\n    tangents = frames.tangents,\r\n    normals = frames.normals,\r\n    binormals = frames.binormals;\r\n\r\n  // proxy internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  function vert(x, y, z) {\r\n\r\n    return scope.vertices.push(new THREE.Vector3(x, y, z)) - 1;\r\n\r\n  }\r\n\r\n  // consruct the grid\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    grid[i] = [];\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    pos = path.getPointAt(u);\r\n\r\n    tangent = tangents[i];\r\n    normal = normals[i];\r\n    binormal = binormals[i];\r\n\r\n    r = radius * taper(u);\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      v = j / radialSegments * 2 * Math.PI;\r\n\r\n      cx = -r * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      cy = r * Math.sin(v);\r\n\r\n      pos2.copy(pos);\r\n      pos2.x += cx * normal.x + cy * binormal.x;\r\n      pos2.y += cx * normal.y + cy * binormal.y;\r\n      pos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n      grid[i][j] = vert(pos2.x, pos2.y, pos2.z);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  // construct the mesh\r\n\r\n  for (i = 0; i < segments; i++) {\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      ip = (closed) ? (i + 1) % segments : i + 1;\r\n      jp = (j + 1) % radialSegments;\r\n\r\n      a = grid[i][j]; // *** NOT NECESSARILY PLANAR ! ***\r\n      b = grid[ip][j];\r\n      c = grid[ip][jp];\r\n      d = grid[i][jp];\r\n\r\n      uva = new THREE.Vector2(i / segments, j / radialSegments);\r\n      uvb = new THREE.Vector2((i + 1) / segments, j / radialSegments);\r\n      uvc = new THREE.Vector2((i + 1) / segments, (j + 1) / radialSegments);\r\n      uvd = new THREE.Vector2(i / segments, (j + 1) / radialSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function(u) {\r\n\r\n  return 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function(u) {\r\n\r\n  return Math.sin(Math.PI * u);\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function(path, segments, closed) {\r\n\r\n  var normal = new THREE.Vector3(),\r\n\r\n    tangents = [],\r\n    normals = [],\r\n    binormals = [],\r\n\r\n    vec = new THREE.Vector3(),\r\n    mat = new THREE.Matrix4(),\r\n\r\n    numpoints = segments + 1,\r\n    theta,\r\n    epsilon = 0.0001,\r\n    smallest,\r\n\r\n    tx, ty, tz,\r\n    i, u;\r\n\r\n\r\n  // expose internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  // compute the tangent vectors for each segment on the path\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    tangents[i] = path.getTangentAt(u);\r\n    tangents[i].normalize();\r\n\r\n  }\r\n\r\n  initialNormal3();\r\n\r\n  /*\r\n  function initialNormal1(lastBinormal) {\r\n  \t// fixed start binormal. Has dangers of 0 vectors\r\n  \tnormals[ 0 ] = new THREE.Vector3();\r\n  \tbinormals[ 0 ] = new THREE.Vector3();\r\n  \tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n  \tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n  }\r\n\r\n  function initialNormal2() {\r\n\r\n  \t// This uses the Frenet-Serret formula for deriving binormal\r\n  \tvar t2 = path.getTangentAt( epsilon );\r\n\r\n  \tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n  \tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n  }\r\n  */\r\n\r\n  function initialNormal3() {\r\n    // select an initial normal vector perpenicular to the first tangent vector,\r\n    // and in the direction of the smallest tangent xyz component\r\n\r\n    normals[0] = new THREE.Vector3();\r\n    binormals[0] = new THREE.Vector3();\r\n    smallest = Number.MAX_VALUE;\r\n    tx = Math.abs(tangents[0].x);\r\n    ty = Math.abs(tangents[0].y);\r\n    tz = Math.abs(tangents[0].z);\r\n\r\n    if (tx <= smallest) {\r\n      smallest = tx;\r\n      normal.set(1, 0, 0);\r\n    }\r\n\r\n    if (ty <= smallest) {\r\n      smallest = ty;\r\n      normal.set(0, 1, 0);\r\n    }\r\n\r\n    if (tz <= smallest) {\r\n      normal.set(0, 0, 1);\r\n    }\r\n\r\n    vec.crossVectors(tangents[0], normal).normalize();\r\n\r\n    normals[0].crossVectors(tangents[0], vec);\r\n    binormals[0].crossVectors(tangents[0], normals[0]);\r\n  }\r\n\r\n\r\n  // compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n  for (i = 1; i < numpoints; i++) {\r\n\r\n    normals[i] = normals[i - 1].clone();\r\n\r\n    binormals[i] = binormals[i - 1].clone();\r\n\r\n    vec.crossVectors(tangents[i - 1], tangents[i]);\r\n\r\n    if (vec.length() > epsilon) {\r\n\r\n      vec.normalize();\r\n\r\n      theta = Math.acos(THREE.Math.clamp(tangents[i - 1].dot(tangents[i]), -1, 1)); // clamp for floating pt errors\r\n\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(vec, theta));\r\n\r\n    }\r\n\r\n    binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n  }\r\n\r\n\r\n  // if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n  if (closed) {\r\n\r\n    theta = Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints - 1]), -1, 1));\r\n    theta /= (numpoints - 1);\r\n\r\n    if (tangents[0].dot(vec.crossVectors(normals[0], normals[numpoints - 1])) > 0) {\r\n\r\n      theta = -theta;\r\n\r\n    }\r\n\r\n    for (i = 1; i < numpoints; i++) {\r\n\r\n      // twist a little...\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(tangents[i], theta * i));\r\n      binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.PolyhedronGeometry = function(vertices, indices, radius, detail) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PolyhedronGeometry';\r\n\r\n  this.parameters = {\r\n    vertices: vertices,\r\n    indices: indices,\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  radius = radius || 1;\r\n  detail = detail || 0;\r\n\r\n  var that = this;\r\n\r\n  for (var i = 0, l = vertices.length; i < l; i += 3) {\r\n\r\n    prepare(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n  }\r\n\r\n  var p = this.vertices;\r\n\r\n  var faces = [];\r\n\r\n  for (var i = 0, j = 0, l = indices.length; i < l; i += 3, j++) {\r\n\r\n    var v1 = p[indices[i]];\r\n    var v2 = p[indices[i + 1]];\r\n    var v3 = p[indices[i + 2]];\r\n\r\n    faces[j] = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n\r\n  }\r\n\r\n  var centroid = new THREE.Vector3();\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    subdivide(faces[i], detail);\r\n\r\n  }\r\n\r\n\r\n  // Handle case when face straddles the seam\r\n\r\n  for (var i = 0, l = this.faceVertexUvs[0].length; i < l; i++) {\r\n\r\n    var uvs = this.faceVertexUvs[0][i];\r\n\r\n    var x0 = uvs[0].x;\r\n    var x1 = uvs[1].x;\r\n    var x2 = uvs[2].x;\r\n\r\n    var max = Math.max(x0, Math.max(x1, x2));\r\n    var min = Math.min(x0, Math.min(x1, x2));\r\n\r\n    if (max > 0.9 && min < 0.1) { // 0.9 is somewhat arbitrary\r\n\r\n      if (x0 < 0.2) uvs[0].x += 1;\r\n      if (x1 < 0.2) uvs[1].x += 1;\r\n      if (x2 < 0.2) uvs[2].x += 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Apply radius\r\n\r\n  for (var i = 0, l = this.vertices.length; i < l; i++) {\r\n\r\n    this.vertices[i].multiplyScalar(radius);\r\n\r\n  }\r\n\r\n\r\n  // Merge vertices\r\n\r\n  this.mergeVertices();\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n\r\n  // Project vector onto sphere's surface\r\n\r\n  function prepare(vector) {\r\n\r\n    var vertex = vector.normalize().clone();\r\n    vertex.index = that.vertices.push(vertex) - 1;\r\n\r\n    // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n    var u = azimuth(vector) / 2 / Math.PI + 0.5;\r\n    var v = inclination(vector) / Math.PI + 0.5;\r\n    vertex.uv = new THREE.Vector2(u, 1 - v);\r\n\r\n    return vertex;\r\n\r\n  }\r\n\r\n\r\n  // Approximate a curved face with recursively sub-divided triangles.\r\n\r\n  function make(v1, v2, v3) {\r\n\r\n    var face = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n    that.faces.push(face);\r\n\r\n    centroid.copy(v1).add(v2).add(v3).divideScalar(3);\r\n\r\n    var azi = azimuth(centroid);\r\n\r\n    that.faceVertexUvs[0].push([\r\n      correctUV(v1.uv, v1, azi),\r\n      correctUV(v2.uv, v2, azi),\r\n      correctUV(v3.uv, v3, azi)\r\n    ]);\r\n\r\n  }\r\n\r\n\r\n  // Analytically subdivide a face to the required detail level.\r\n\r\n  function subdivide(face, detail) {\r\n\r\n    var cols = Math.pow(2, detail);\r\n    var a = prepare(that.vertices[face.a]);\r\n    var b = prepare(that.vertices[face.b]);\r\n    var c = prepare(that.vertices[face.c]);\r\n    var v = [];\r\n\r\n    // Construct all of the vertices for this subdivision.\r\n\r\n    for (var i = 0; i <= cols; i++) {\r\n\r\n      v[i] = [];\r\n\r\n      var aj = prepare(a.clone().lerp(c, i / cols));\r\n      var bj = prepare(b.clone().lerp(c, i / cols));\r\n      var rows = cols - i;\r\n\r\n      for (var j = 0; j <= rows; j++) {\r\n\r\n        if (j == 0 && i == cols) {\r\n\r\n          v[i][j] = aj;\r\n\r\n        }\r\n        else {\r\n\r\n          v[i][j] = prepare(aj.clone().lerp(bj, j / rows));\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Construct all of the faces.\r\n\r\n    for (var i = 0; i < cols; i++) {\r\n\r\n      for (var j = 0; j < 2 * (cols - i) - 1; j++) {\r\n\r\n        var k = Math.floor(j / 2);\r\n\r\n        if (j % 2 == 0) {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k],\r\n            v[i][k]\r\n          );\r\n\r\n        }\r\n        else {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k + 1],\r\n            v[i + 1][k]\r\n          );\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n  function azimuth(vector) {\r\n\r\n    return Math.atan2(vector.z, -vector.x);\r\n\r\n  }\r\n\r\n\r\n  // Angle above the XZ plane.\r\n\r\n  function inclination(vector) {\r\n\r\n    return Math.atan2(-vector.y, Math.sqrt((vector.x * vector.x) + (vector.z * vector.z)));\r\n\r\n  }\r\n\r\n\r\n  // Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n  function correctUV(uv, vector, azimuth) {\r\n\r\n    if ((azimuth < 0) && (uv.x === 1)) uv = new THREE.Vector2(uv.x - 1, uv.y);\r\n    if ((vector.x === 0) && (vector.z === 0)) uv = new THREE.Vector2(azimuth / 2 / Math.PI + 0.5, uv.y);\r\n    return uv.clone();\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n  var r = 1 / t;\r\n\r\n  var vertices = [\r\n\r\n    // (1, 1, 1)\r\n    -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1,\r\n    1, -1, -1, 1, -1, 1,\r\n    1, 1, -1, 1, 1, 1,\r\n\r\n    // (0, 1/, )\r\n    0, -r, -t, 0, -r, t,\r\n    0, r, -t, 0, r, t,\r\n\r\n    // (1/, , 0)\r\n    -r, -t, 0, -r, t, 0,\r\n    r, -t, 0, r, t, 0,\r\n\r\n    // (, 0, 1/)\r\n    -t, 0, -r, t, 0, -r, -t, 0, r, t, 0, r\r\n  ];\r\n\r\n  var indices = [\r\n    3, 11, 7, 3, 7, 15, 3, 15, 13,\r\n    7, 19, 17, 7, 17, 6, 7, 6, 15,\r\n    17, 4, 8, 17, 8, 10, 17, 10, 6,\r\n    8, 0, 16, 8, 16, 2, 8, 2, 10,\r\n    0, 12, 1, 0, 1, 18, 0, 18, 16,\r\n    6, 10, 2, 6, 2, 13, 6, 13, 15,\r\n    2, 16, 18, 2, 18, 3, 2, 3, 13,\r\n    18, 1, 9, 18, 9, 11, 18, 11, 3,\r\n    4, 14, 12, 4, 12, 0, 4, 0, 8,\r\n    11, 9, 5, 11, 5, 19, 11, 19, 7,\r\n    19, 5, 14, 19, 14, 4, 19, 4, 17,\r\n    1, 12, 14, 1, 14, 5, 1, 5, 9\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function(radius, detail) {\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n\r\n  var vertices = [-1, t, 0, 1, t, 0, -1, -t, 0, 1, -t, 0,\r\n    0, -1, t, 0, 1, t, 0, -1, -t, 0, 1, -t,\r\n    t, 0, -1, t, 0, 1, -t, 0, -1, -t, 0, 1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11,\r\n    1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8,\r\n    3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9,\r\n    4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'IcosahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var vertices = [\r\n    1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'OctahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function(radius, detail) {\r\n\r\n  var vertices = [\r\n    1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1\r\n  ];\r\n\r\n  var indices = [\r\n    2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'TetrahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function(func, slices, stacks) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ParametricGeometry';\r\n\r\n  this.parameters = {\r\n    func: func,\r\n    slices: slices,\r\n    stacks: stacks\r\n  };\r\n\r\n  var verts = this.vertices;\r\n  var faces = this.faces;\r\n  var uvs = this.faceVertexUvs[0];\r\n\r\n  var i, j, p;\r\n  var u, v;\r\n\r\n  var sliceCount = slices + 1;\r\n\r\n  for (i = 0; i <= stacks; i++) {\r\n\r\n    v = i / stacks;\r\n\r\n    for (j = 0; j <= slices; j++) {\r\n\r\n      u = j / slices;\r\n\r\n      p = func(u, v);\r\n      verts.push(p);\r\n\r\n    }\r\n  }\r\n\r\n  var a, b, c, d;\r\n  var uva, uvb, uvc, uvd;\r\n\r\n  for (i = 0; i < stacks; i++) {\r\n\r\n    for (j = 0; j < slices; j++) {\r\n\r\n      a = i * sliceCount + j;\r\n      b = i * sliceCount + j + 1;\r\n      c = (i + 1) * sliceCount + j + 1;\r\n      d = (i + 1) * sliceCount + j;\r\n\r\n      uva = new THREE.Vector2(j / slices, i / stacks);\r\n      uvb = new THREE.Vector2((j + 1) / slices, i / stacks);\r\n      uvc = new THREE.Vector2((j + 1) / slices, (i + 1) / stacks);\r\n      uvd = new THREE.Vector2(j / slices, (i + 1) / stacks);\r\n\r\n      faces.push(new THREE.Face3(a, b, d));\r\n      uvs.push([uva, uvb, uvd]);\r\n\r\n      faces.push(new THREE.Face3(b, c, d));\r\n      uvs.push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // console.log(this);\r\n\r\n  // magic bullet\r\n  // var diff = this.mergeVertices();\r\n  // console.log('removed ', diff, ' vertices by merging');\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function(size) {\r\n\r\n  size = size || 1;\r\n\r\n  var vertices = new Float32Array([\r\n    0, 0, 0, size, 0, 0,\r\n    0, 0, 0, 0, size, 0,\r\n    0, 0, 0, 0, 0, size\r\n  ]);\r\n\r\n  var colors = new Float32Array([\r\n    1, 0, 0, 1, 0.6, 0,\r\n    0, 1, 0, 0.6, 1, 0,\r\n    0, 0, 1, 0, 0.6, 1\r\n  ]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = (function() {\r\n\r\n  var lineGeometry = new THREE.Geometry();\r\n  lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0));\r\n\r\n  var coneGeometry = new THREE.CylinderGeometry(0, 0.5, 1, 5, 1);\r\n  coneGeometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n\r\n  return function(dir, origin, length, color, headLength, headWidth) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    if (color === undefined) color = 0xffff00;\r\n    if (length === undefined) length = 1;\r\n    if (headLength === undefined) headLength = 0.2 * length;\r\n    if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n    this.position.copy(origin);\r\n\r\n    this.line = new THREE.Line(lineGeometry, new THREE.LineBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.line.matrixAutoUpdate = false;\r\n    this.add(this.line);\r\n\r\n    this.cone = new THREE.Mesh(coneGeometry, new THREE.MeshBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.cone.matrixAutoUpdate = false;\r\n    this.add(this.cone);\r\n\r\n    this.setDirection(dir);\r\n    this.setLength(length, headLength, headWidth);\r\n\r\n  }\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = (function() {\r\n\r\n  var axis = new THREE.Vector3();\r\n  var radians;\r\n\r\n  return function(dir) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    if (dir.y > 0.99999) {\r\n\r\n      this.quaternion.set(0, 0, 0, 1);\r\n\r\n    }\r\n    else if (dir.y < -0.99999) {\r\n\r\n      this.quaternion.set(1, 0, 0, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      axis.set(dir.z, 0, -dir.x).normalize();\r\n\r\n      radians = Math.acos(dir.y);\r\n\r\n      this.quaternion.setFromAxisAngle(axis, radians);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function(length, headLength, headWidth) {\r\n\r\n  if (headLength === undefined) headLength = 0.2 * length;\r\n  if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n  this.line.scale.set(1, length - headLength, 1);\r\n  this.line.updateMatrix();\r\n\r\n  this.cone.scale.set(headWidth, headLength, headWidth);\r\n  this.cone.position.y = length;\r\n  this.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function(color) {\r\n\r\n  this.line.material.color.set(color);\r\n  this.cone.material.color.set(color);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function(object) {\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(new Float32Array(72), 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: 0xffff00\r\n  }), THREE.LinePieces);\r\n\r\n  if (object !== undefined) {\r\n\r\n    this.update(object);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = function(object) {\r\n\r\n  var geometry = object.geometry;\r\n\r\n  if (geometry.boundingBox === null) {\r\n\r\n    geometry.computeBoundingBox();\r\n\r\n  }\r\n\r\n  var min = geometry.boundingBox.min;\r\n  var max = geometry.boundingBox.max;\r\n\r\n  /*\r\n    5____4\r\n  1/___0/|\r\n  | 6__|_7\r\n  2/___3/\r\n\r\n  0: max.x, max.y, max.z\r\n  1: min.x, max.y, max.z\r\n  2: min.x, min.y, max.z\r\n  3: max.x, min.y, max.z\r\n  4: max.x, max.y, min.z\r\n  5: min.x, max.y, min.z\r\n  6: min.x, min.y, min.z\r\n  7: max.x, min.y, min.z\r\n  */\r\n\r\n  var vertices = this.geometry.attributes.position.array;\r\n\r\n  vertices[0] = max.x;\r\n  vertices[1] = max.y;\r\n  vertices[2] = max.z;\r\n  vertices[3] = min.x;\r\n  vertices[4] = max.y;\r\n  vertices[5] = max.z;\r\n\r\n  vertices[6] = min.x;\r\n  vertices[7] = max.y;\r\n  vertices[8] = max.z;\r\n  vertices[9] = min.x;\r\n  vertices[10] = min.y;\r\n  vertices[11] = max.z;\r\n\r\n  vertices[12] = min.x;\r\n  vertices[13] = min.y;\r\n  vertices[14] = max.z;\r\n  vertices[15] = max.x;\r\n  vertices[16] = min.y;\r\n  vertices[17] = max.z;\r\n\r\n  vertices[18] = max.x;\r\n  vertices[19] = min.y;\r\n  vertices[20] = max.z;\r\n  vertices[21] = max.x;\r\n  vertices[22] = max.y;\r\n  vertices[23] = max.z;\r\n\r\n  //\r\n\r\n  vertices[24] = max.x;\r\n  vertices[25] = max.y;\r\n  vertices[26] = min.z;\r\n  vertices[27] = min.x;\r\n  vertices[28] = max.y;\r\n  vertices[29] = min.z;\r\n\r\n  vertices[30] = min.x;\r\n  vertices[31] = max.y;\r\n  vertices[32] = min.z;\r\n  vertices[33] = min.x;\r\n  vertices[34] = min.y;\r\n  vertices[35] = min.z;\r\n\r\n  vertices[36] = min.x;\r\n  vertices[37] = min.y;\r\n  vertices[38] = min.z;\r\n  vertices[39] = max.x;\r\n  vertices[40] = min.y;\r\n  vertices[41] = min.z;\r\n\r\n  vertices[42] = max.x;\r\n  vertices[43] = min.y;\r\n  vertices[44] = min.z;\r\n  vertices[45] = max.x;\r\n  vertices[46] = max.y;\r\n  vertices[47] = min.z;\r\n\r\n  //\r\n\r\n  vertices[48] = max.x;\r\n  vertices[49] = max.y;\r\n  vertices[50] = max.z;\r\n  vertices[51] = max.x;\r\n  vertices[52] = max.y;\r\n  vertices[53] = min.z;\r\n\r\n  vertices[54] = min.x;\r\n  vertices[55] = max.y;\r\n  vertices[56] = max.z;\r\n  vertices[57] = min.x;\r\n  vertices[58] = max.y;\r\n  vertices[59] = min.z;\r\n\r\n  vertices[60] = min.x;\r\n  vertices[61] = min.y;\r\n  vertices[62] = max.z;\r\n  vertices[63] = min.x;\r\n  vertices[64] = min.y;\r\n  vertices[65] = min.z;\r\n\r\n  vertices[66] = max.x;\r\n  vertices[67] = min.y;\r\n  vertices[68] = max.z;\r\n  vertices[69] = max.x;\r\n  vertices[70] = min.y;\r\n  vertices[71] = min.z;\r\n\r\n  this.geometry.attributes.position.needsUpdate = true;\r\n\r\n  this.geometry.computeBoundingSphere();\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0x888888;\r\n\r\n  this.object = object;\r\n\r\n  this.box = new THREE.Box3();\r\n\r\n  THREE.Mesh.call(this, new THREE.BoxGeometry(1, 1, 1), new THREE.MeshBasicMaterial({\r\n    color: color,\r\n    wireframe: true\r\n  }));\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function() {\r\n\r\n  this.box.setFromObject(this.object);\r\n\r\n  this.box.size(this.scale);\r\n\r\n  this.box.center(this.position);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function(camera) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    color: 0xffffff,\r\n    vertexColors: THREE.FaceColors\r\n  });\r\n\r\n  var pointMap = {};\r\n\r\n  // colors\r\n\r\n  var hexFrustum = 0xffaa00;\r\n  var hexCone = 0xff0000;\r\n  var hexUp = 0x00aaff;\r\n  var hexTarget = 0xffffff;\r\n  var hexCross = 0x333333;\r\n\r\n  // near\r\n\r\n  addLine(\"n1\", \"n2\", hexFrustum);\r\n  addLine(\"n2\", \"n4\", hexFrustum);\r\n  addLine(\"n4\", \"n3\", hexFrustum);\r\n  addLine(\"n3\", \"n1\", hexFrustum);\r\n\r\n  // far\r\n\r\n  addLine(\"f1\", \"f2\", hexFrustum);\r\n  addLine(\"f2\", \"f4\", hexFrustum);\r\n  addLine(\"f4\", \"f3\", hexFrustum);\r\n  addLine(\"f3\", \"f1\", hexFrustum);\r\n\r\n  // sides\r\n\r\n  addLine(\"n1\", \"f1\", hexFrustum);\r\n  addLine(\"n2\", \"f2\", hexFrustum);\r\n  addLine(\"n3\", \"f3\", hexFrustum);\r\n  addLine(\"n4\", \"f4\", hexFrustum);\r\n\r\n  // cone\r\n\r\n  addLine(\"p\", \"n1\", hexCone);\r\n  addLine(\"p\", \"n2\", hexCone);\r\n  addLine(\"p\", \"n3\", hexCone);\r\n  addLine(\"p\", \"n4\", hexCone);\r\n\r\n  // up\r\n\r\n  addLine(\"u1\", \"u2\", hexUp);\r\n  addLine(\"u2\", \"u3\", hexUp);\r\n  addLine(\"u3\", \"u1\", hexUp);\r\n\r\n  // target\r\n\r\n  addLine(\"c\", \"t\", hexTarget);\r\n  addLine(\"p\", \"c\", hexCross);\r\n\r\n  // cross\r\n\r\n  addLine(\"cn1\", \"cn2\", hexCross);\r\n  addLine(\"cn3\", \"cn4\", hexCross);\r\n\r\n  addLine(\"cf1\", \"cf2\", hexCross);\r\n  addLine(\"cf3\", \"cf4\", hexCross);\r\n\r\n  function addLine(a, b, hex) {\r\n\r\n    addPoint(a, hex);\r\n    addPoint(b, hex);\r\n\r\n  }\r\n\r\n  function addPoint(id, hex) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3());\r\n    geometry.colors.push(new THREE.Color(hex));\r\n\r\n    if (pointMap[id] === undefined) {\r\n\r\n      pointMap[id] = [];\r\n\r\n    }\r\n\r\n    pointMap[id].push(geometry.vertices.length - 1);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.camera = camera;\r\n  this.matrix = camera.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.pointMap = pointMap;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function() {\r\n\r\n  var geometry, pointMap;\r\n\r\n  var vector = new THREE.Vector3();\r\n  var camera = new THREE.Camera();\r\n\r\n  var setPoint = function(point, x, y, z) {\r\n\r\n    vector.set(x, y, z).unproject(camera);\r\n\r\n    var points = pointMap[point];\r\n\r\n    if (points !== undefined) {\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        geometry.vertices[points[i]].copy(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  return function() {\r\n\r\n    geometry = this.geometry;\r\n    pointMap = this.pointMap;\r\n\r\n    var w = 1,\r\n      h = 1;\r\n\r\n    // we need just camera projection matrix\r\n    // world matrix must be identity\r\n\r\n    camera.projectionMatrix.copy(this.camera.projectionMatrix);\r\n\r\n    // center / target\r\n\r\n    setPoint(\"c\", 0, 0, -1);\r\n    setPoint(\"t\", 0, 0, 1);\r\n\r\n    // near\r\n\r\n    setPoint(\"n1\", -w, -h, -1);\r\n    setPoint(\"n2\", w, -h, -1);\r\n    setPoint(\"n3\", -w, h, -1);\r\n    setPoint(\"n4\", w, h, -1);\r\n\r\n    // far\r\n\r\n    setPoint(\"f1\", -w, -h, 1);\r\n    setPoint(\"f2\", w, -h, 1);\r\n    setPoint(\"f3\", -w, h, 1);\r\n    setPoint(\"f4\", w, h, 1);\r\n\r\n    // up\r\n\r\n    setPoint(\"u1\", w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u2\", -w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u3\", 0, h * 2, -1);\r\n\r\n    // cross\r\n\r\n    setPoint(\"cf1\", -w, 0, 1);\r\n    setPoint(\"cf2\", w, 0, 1);\r\n    setPoint(\"cf3\", 0, -h, 1);\r\n    setPoint(\"cf4\", 0, h, 1);\r\n\r\n    setPoint(\"cn1\", -w, 0, -1);\r\n    setPoint(\"cn2\", w, 0, -1);\r\n    setPoint(\"cn3\", 0, -h, -1);\r\n    setPoint(\"cn4\", 0, h, -1);\r\n\r\n    geometry.verticesNeedUpdate = true;\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function(light, size) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  size = size || 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(-size, size, 0),\r\n    new THREE.Vector3(size, size, 0),\r\n    new THREE.Vector3(size, -size, 0),\r\n    new THREE.Vector3(-size, -size, 0),\r\n    new THREE.Vector3(-size, size, 0)\r\n  );\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.lightPlane = new THREE.Line(geometry, material);\r\n  this.add(this.lightPlane);\r\n\r\n  geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(),\r\n    new THREE.Vector3()\r\n  );\r\n\r\n  material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.targetLine = new THREE.Line(geometry, material);\r\n  this.add(this.targetLine);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function() {\r\n\r\n  this.lightPlane.geometry.dispose();\r\n  this.lightPlane.material.dispose();\r\n  this.targetLine.geometry.dispose();\r\n  this.targetLine.material.dispose();\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n  var v3 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    v1.setFromMatrixPosition(this.light.matrixWorld);\r\n    v2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n    v3.subVectors(v2, v1);\r\n\r\n    this.lightPlane.lookAt(v3);\r\n    this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n    this.targetLine.geometry.vertices[1].copy(v3);\r\n    this.targetLine.geometry.verticesNeedUpdate = true;\r\n    this.targetLine.material.color.copy(this.lightPlane.material.color);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimim angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function(object, hex, thresholdAngle) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n  thresholdAngle = (thresholdAngle !== undefined) ? thresholdAngle : 1;\r\n\r\n  var thresholdDot = Math.cos(THREE.Math.degToRad(thresholdAngle));\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  var geometry2;\r\n\r\n  if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    geometry2 = new THREE.Geometry();\r\n    geometry2.fromBufferGeometry(object.geometry);\r\n\r\n  }\r\n  else {\r\n\r\n    geometry2 = object.geometry.clone();\r\n\r\n  }\r\n\r\n  geometry2.mergeVertices();\r\n  geometry2.computeFaceNormals();\r\n\r\n  var vertices = geometry2.vertices;\r\n  var faces = geometry2.faces;\r\n  var numEdges = 0;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0; j < 3; j++) {\r\n\r\n      edge[0] = face[keys[j]];\r\n      edge[1] = face[keys[(j + 1) % 3]];\r\n      edge.sort(sortFunction);\r\n\r\n      var key = edge.toString();\r\n\r\n      if (hash[key] === undefined) {\r\n\r\n        hash[key] = {\r\n          vert1: edge[0],\r\n          vert2: edge[1],\r\n          face1: i,\r\n          face2: undefined\r\n        };\r\n        numEdges++;\r\n\r\n      }\r\n      else {\r\n\r\n        hash[key].face2 = i;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n  var index = 0;\r\n\r\n  for (var key in hash) {\r\n\r\n    var h = hash[key];\r\n\r\n    if (h.face2 === undefined || faces[h.face1].normal.dot(faces[h.face2].normal) <= thresholdDot) {\r\n\r\n      var vertex = vertices[h.vert1];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n      vertex = vertices[h.vert2];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.FaceNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffff00;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = this.object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = function() {\r\n\r\n  var vertices = this.geometry.vertices;\r\n\r\n  var object = this.object;\r\n  var objectVertices = object.geometry.vertices;\r\n  var objectFaces = object.geometry.faces;\r\n  var objectWorldMatrix = object.matrixWorld;\r\n\r\n  object.updateMatrixWorld(true);\r\n\r\n  this.normalMatrix.getNormalMatrix(objectWorldMatrix);\r\n\r\n  for (var i = 0, i2 = 0, l = objectFaces.length; i < l; i++, i2 += 2) {\r\n\r\n    var face = objectFaces[i];\r\n\r\n    vertices[i2].copy(objectVertices[face.a])\r\n      .add(objectVertices[face.b])\r\n      .add(objectVertices[face.c])\r\n      .divideScalar(3)\r\n      .applyMatrix4(objectWorldMatrix);\r\n\r\n    vertices[i2 + 1].copy(face.normal)\r\n      .applyMatrix3(this.normalMatrix)\r\n      .normalize()\r\n      .multiplyScalar(this.size)\r\n      .add(vertices[i2]);\r\n\r\n  }\r\n\r\n  this.geometry.verticesNeedUpdate = true;\r\n\r\n  return this;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function(size, step) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  this.color1 = new THREE.Color(0x444444);\r\n  this.color2 = new THREE.Color(0x888888);\r\n\r\n  for (var i = -size; i <= size; i += step) {\r\n\r\n    geometry.vertices.push(\r\n      new THREE.Vector3(-size, 0, i), new THREE.Vector3(size, 0, i),\r\n      new THREE.Vector3(i, 0, -size), new THREE.Vector3(i, 0, size)\r\n    );\r\n\r\n    var color = i === 0 ? this.color1 : this.color2;\r\n\r\n    geometry.colors.push(color, color, color, color);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function(colorCenterLine, colorGrid) {\r\n\r\n  this.color1.set(colorCenterLine);\r\n  this.color2.set(colorGrid);\r\n\r\n  this.geometry.colorsNeedUpdate = true;\r\n\r\n}\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function(light, sphereSize) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.colors = [new THREE.Color(), new THREE.Color()];\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  for (var i = 0, il = 8; i < il; i++) {\r\n\r\n    geometry.faces[i].color = this.colors[i < 4 ? 0 : 1];\r\n\r\n  }\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    vertexColors: THREE.FaceColors,\r\n    wireframe: true\r\n  });\r\n\r\n  this.lightSphere = new THREE.Mesh(geometry, material);\r\n  this.add(this.lightSphere);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function() {\r\n  this.lightSphere.geometry.dispose();\r\n  this.lightSphere.material.dispose();\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);\r\n    this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);\r\n\r\n    this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate());\r\n    this.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n  }\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function(light, sphereSize) {\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.matrix = this.light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  /*\r\n  var distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n  var distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n  this.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n  this.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n  var d = light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n\r\n  this.add( this.lightDistance );\r\n  */\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function() {\r\n\r\n  this.geometry.dispose();\r\n  this.material.dispose();\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function() {\r\n\r\n  this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  /*\r\n  var d = this.light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.visible = true;\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n  */\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function(object) {\r\n\r\n  this.bones = this.getBoneList(object);\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.colors.push(new THREE.Color(0, 0, 1));\r\n      geometry.colors.push(new THREE.Color(0, 1, 0));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors,\r\n    depthTest: false,\r\n    depthWrite: false,\r\n    transparent: true\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.root = object;\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function(object) {\r\n\r\n  var boneList = [];\r\n\r\n  if (object instanceof THREE.Bone) {\r\n\r\n    boneList.push(object);\r\n\r\n  }\r\n\r\n  for (var i = 0; i < object.children.length; i++) {\r\n\r\n    boneList.push.apply(boneList, this.getBoneList(object.children[i]));\r\n\r\n  }\r\n\r\n  return boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  var matrixWorldInv = new THREE.Matrix4().getInverse(this.root.matrixWorld);\r\n\r\n  var boneMatrix = new THREE.Matrix4();\r\n\r\n  var j = 0;\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.matrixWorld);\r\n      geometry.vertices[j].setFromMatrixPosition(boneMatrix);\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.parent.matrixWorld);\r\n      geometry.vertices[j + 1].setFromMatrixPosition(boneMatrix);\r\n\r\n      j += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.verticesNeedUpdate = true;\r\n\r\n  geometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.SpotLightHelper = function(light) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  var geometry = new THREE.CylinderGeometry(0, 1, 1, 8, 1, true);\r\n\r\n  geometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n\r\n  this.cone = new THREE.Mesh(geometry, material);\r\n  this.add(this.cone);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function() {\r\n  this.cone.geometry.dispose();\r\n  this.cone.material.dispose();\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n  var vector2 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    var coneLength = this.light.distance ? this.light.distance : 10000;\r\n    var coneWidth = coneLength * Math.tan(this.light.angle);\r\n\r\n    this.cone.scale.set(coneWidth, coneWidth, coneLength);\r\n\r\n    vector.setFromMatrixPosition(this.light.matrixWorld);\r\n    vector2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n\r\n    this.cone.lookAt(vector2.sub(vector));\r\n\r\n    this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xff0000;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    this.normalMatrix.getNormalMatrix(this.object.matrixWorld);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var normal = face.vertexNormals[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/VertexTangentsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexTangentsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0x0000ff;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexTangentsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexTangentsHelper.prototype.constructor = THREE.VertexTangentsHelper;\r\n\r\nTHREE.VertexTangentsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var tangent = face.vertexTangents[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(tangent).transformDirection(worldMatrix).multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  if (object.geometry instanceof THREE.Geometry) {\r\n\r\n    var vertices = object.geometry.vertices;\r\n    var faces = object.geometry.faces;\r\n    var numEdges = 0;\r\n\r\n    // allocate maximal size\r\n    var edges = new Uint32Array(6 * faces.length);\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0; j < 3; j++) {\r\n\r\n        edge[0] = face[keys[j]];\r\n        edge[1] = face[keys[(j + 1) % 3]];\r\n        edge.sort(sortFunction);\r\n\r\n        var key = edge.toString();\r\n\r\n        if (hash[key] === undefined) {\r\n\r\n          edges[2 * numEdges] = edge[0];\r\n          edges[2 * numEdges + 1] = edge[1];\r\n          hash[key] = true;\r\n          numEdges++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n    for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n      for (var j = 0; j < 2; j++) {\r\n\r\n        var vertex = vertices[edges[2 * i + j]];\r\n\r\n        var index = 6 * i + 3 * j;\r\n        coords[index + 0] = vertex.x;\r\n        coords[index + 1] = vertex.y;\r\n        coords[index + 2] = vertex.z;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  }\r\n  else if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    if (object.geometry.attributes.index !== undefined) { // Indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var indices = object.geometry.attributes.index.array;\r\n      var drawcalls = object.geometry.drawcalls;\r\n      var numEdges = 0;\r\n\r\n      if (drawcalls.length === 0) {\r\n\r\n        drawcalls = [{\r\n          count: indices.length,\r\n          index: 0,\r\n          start: 0\r\n        }];\r\n\r\n      }\r\n\r\n      // allocate maximal size\r\n      var edges = new Uint32Array(2 * indices.length);\r\n\r\n      for (var o = 0, ol = drawcalls.length; o < ol; ++o) {\r\n\r\n        var start = drawcalls[o].start;\r\n        var count = drawcalls[o].count;\r\n        var index = drawcalls[o].index;\r\n\r\n        for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n          for (var j = 0; j < 3; j++) {\r\n\r\n            edge[0] = index + indices[i + j];\r\n            edge[1] = index + indices[i + (j + 1) % 3];\r\n            edge.sort(sortFunction);\r\n\r\n            var key = edge.toString();\r\n\r\n            if (hash[key] === undefined) {\r\n\r\n              edges[2 * numEdges] = edge[0];\r\n              edges[2 * numEdges + 1] = edge[1];\r\n              hash[key] = true;\r\n              numEdges++;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n        for (var j = 0; j < 2; j++) {\r\n\r\n          var index = 6 * i + 3 * j;\r\n          var index2 = 3 * edges[2 * i + j];\r\n          coords[index + 0] = vertices[index2];\r\n          coords[index + 1] = vertices[index2 + 1];\r\n          coords[index + 2] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n    else { // non-indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var numEdges = vertices.length / 3;\r\n      var numTris = numEdges / 3;\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numTris; i < l; i++) {\r\n\r\n        for (var j = 0; j < 3; j++) {\r\n\r\n          var index = 18 * i + 6 * j;\r\n\r\n          var index1 = 9 * i + 3 * j;\r\n          coords[index + 0] = vertices[index1];\r\n          coords[index + 1] = vertices[index1 + 1];\r\n          coords[index + 2] = vertices[index1 + 2];\r\n\r\n          var index2 = 9 * i + 3 * ((j + 1) % 3);\r\n          coords[index + 3] = vertices[index2];\r\n          coords[index + 4] = vertices[index2 + 1];\r\n          coords[index + 5] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.render = function(renderCallback) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.animationsMap = {};\r\n  this.animationsList = [];\r\n\r\n  // prepare default animation\r\n  // (all frames played together in 1 second)\r\n\r\n  var numFrames = this.geometry.morphTargets.length;\r\n\r\n  var name = \"__default\";\r\n\r\n  var startFrame = 0;\r\n  var endFrame = numFrames - 1;\r\n\r\n  var fps = numFrames / 1;\r\n\r\n  this.createAnimation(name, startFrame, endFrame, fps);\r\n  this.setAnimationWeight(name, 1);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function(name, start, end, fps) {\r\n\r\n  var animation = {\r\n\r\n    startFrame: start,\r\n    endFrame: end,\r\n\r\n    length: end - start + 1,\r\n\r\n    fps: fps,\r\n    duration: (end - start) / fps,\r\n\r\n    lastFrame: 0,\r\n    currentFrame: 0,\r\n\r\n    active: false,\r\n\r\n    time: 0,\r\n    direction: 1,\r\n    weight: 1,\r\n\r\n    directionBackwards: false,\r\n    mirroredLoop: false\r\n\r\n  };\r\n\r\n  this.animationsMap[name] = animation;\r\n  this.animationsList.push(animation);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function(fps) {\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  var firstAnimation, frameRanges = {};\r\n\r\n  var geometry = this.geometry;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var chunks = morph.name.match(pattern);\r\n\r\n    if (chunks && chunks.length > 1) {\r\n\r\n      var name = chunks[1];\r\n\r\n      if (!frameRanges[name]) frameRanges[name] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var range = frameRanges[name];\r\n\r\n      if (i < range.start) range.start = i;\r\n      if (i > range.end) range.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = name;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var name in frameRanges) {\r\n\r\n    var range = frameRanges[name];\r\n    this.createAnimation(name, range.start, range.end, fps);\r\n\r\n  }\r\n\r\n  this.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = 1;\r\n    animation.directionBackwards = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = -1;\r\n    animation.directionBackwards = true;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function(name, fps) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.fps = fps;\r\n    animation.duration = (animation.end - animation.start) / animation.fps;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function(name, duration) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.duration = duration;\r\n    animation.fps = (animation.end - animation.start) / animation.duration;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function(name, weight) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.weight = weight;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function(name, time) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = time;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function(name) {\r\n\r\n  var time = 0;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    time = animation.time;\r\n\r\n  }\r\n\r\n  return time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function(name) {\r\n\r\n  var duration = -1;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    duration = animation.duration;\r\n\r\n  }\r\n\r\n  return duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = 0;\r\n    animation.active = true;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn(\"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\");\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.active = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function(delta) {\r\n\r\n  for (var i = 0, il = this.animationsList.length; i < il; i++) {\r\n\r\n    var animation = this.animationsList[i];\r\n\r\n    if (!animation.active) continue;\r\n\r\n    var frameTime = animation.duration / animation.length;\r\n\r\n    animation.time += animation.direction * delta;\r\n\r\n    if (animation.mirroredLoop) {\r\n\r\n      if (animation.time > animation.duration || animation.time < 0) {\r\n\r\n        animation.direction *= -1;\r\n\r\n        if (animation.time > animation.duration) {\r\n\r\n          animation.time = animation.duration;\r\n          animation.directionBackwards = true;\r\n\r\n        }\r\n\r\n        if (animation.time < 0) {\r\n\r\n          animation.time = 0;\r\n          animation.directionBackwards = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      animation.time = animation.time % animation.duration;\r\n\r\n      if (animation.time < 0) animation.time += animation.duration;\r\n\r\n    }\r\n\r\n    var keyframe = animation.startFrame + THREE.Math.clamp(Math.floor(animation.time / frameTime), 0, animation.length - 1);\r\n    var weight = animation.weight;\r\n\r\n    if (keyframe !== animation.currentFrame) {\r\n\r\n      this.morphTargetInfluences[animation.lastFrame] = 0;\r\n      this.morphTargetInfluences[animation.currentFrame] = 1 * weight;\r\n\r\n      this.morphTargetInfluences[keyframe] = 0;\r\n\r\n      animation.lastFrame = animation.currentFrame;\r\n      animation.currentFrame = keyframe;\r\n\r\n    }\r\n\r\n    var mix = (animation.time % frameTime) / frameTime;\r\n\r\n    if (animation.directionBackwards) mix = 1 - mix;\r\n\r\n    this.morphTargetInfluences[animation.currentFrame] = mix * weight;\r\n    this.morphTargetInfluences[animation.lastFrame] = (1 - mix) * weight;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n}\r\nelse {\r\n  this['THREE'] = THREE;\r\n}\r\n\r\n","/*\r\n * Exports all known components for easier use in modules that require the use of components\r\n */\r\n\r\nmodule.exports = {\r\n  Identifier: require('./components/Identifier.js'),\r\n  Position: require('./components/Position.js'),\r\n  Velocity: require('./components/Velocity.js'),\r\n  Jump: require('./components/Jump.js'),\r\n  Drawable: require('./components/Drawable.js'),\r\n  Expirable: require('./components/Expirable.js'),\r\n  CameraFollow: require('./components/CameraFollow.js'),\r\n  ShootDelay: require('./components/ShootDelay.js'),\r\n  OneTimeHit: require('./components/OneTimeHit.js'),\r\n  Hurt: require('./components/Hurt.js'),\r\n  Health: require('./components/Health.js'),\r\n  Bullet: require('./components/Bullet.js'),\r\n  AI: require('./components/Ai.js'),\r\n  Steaming: require('./components/Steaming.js'),\r\n  CameraPitch: require('./components/CameraPitch.js'),\r\n  Gun: require('./components/Gun.js'),\r\n  Ammo: require('./components/Ammo.js'),\r\n  Shield: require('./components/Shield.js'),\r\n  Pickup: require('./components/Pickup.js'),\r\n  DropsPickup: require('./components/DropsPickup.js')\r\n};\r\n\r\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @author jetienne / http://jetienne.com/\n */\n/** @namespace */\nvar THREEx = THREEx || {};\n\nif (typeof module === 'object') {\n\n  module.exports = THREEx;\n\n}\n\n/**\n * provide info on THREE.WebGLRenderer\n * \n * @param {Object} renderer the renderer to update\n * @param {Object} Camera the camera to update\n */\nTHREEx.RendererStats = function() {\n\n  var msMin = 100;\n  var msMax = 0;\n\n  var container = document.createElement('div');\n  container.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n  var msDiv = document.createElement('div');\n  msDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#200;';\n  container.appendChild(msDiv);\n\n  var msText = document.createElement('div');\n  msText.style.cssText = 'color:#f00;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n  msText.innerHTML = 'WebGLRenderer';\n  msDiv.appendChild(msText);\n\n  var msTexts = [];\n  var nLines = 9;\n  for (var i = 0; i < nLines; i++) {\n    msTexts[i] = document.createElement('div');\n    msTexts[i].style.cssText = 'color:#f00;background-color:#311;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n    msDiv.appendChild(msTexts[i]);\n    msTexts[i].innerHTML = '-';\n  }\n\n\n  var lastTime = Date.now();\n  return {\n    domElement: container,\n\n    update: function(webGLRenderer) {\n      // sanity check\n      console.assert(webGLRenderer instanceof THREE.WebGLRenderer)\n\n      // refresh only 30time per second\n      if (Date.now() - lastTime < 1000 / 30) return;\n      lastTime = Date.now()\n\n      var i = 0;\n      msTexts[i++].textContent = \"== Memory =====\";\n      msTexts[i++].textContent = \"Programs: \" + webGLRenderer.info.memory.programs;\n      msTexts[i++].textContent = \"Geometries: \" + webGLRenderer.info.memory.geometries;\n      msTexts[i++].textContent = \"Textures: \" + webGLRenderer.info.memory.textures;\n\n      msTexts[i++].textContent = \"== Render =====\";\n      msTexts[i++].textContent = \"Calls: \" + webGLRenderer.info.render.calls;\n      msTexts[i++].textContent = \"Vertices: \" + webGLRenderer.info.render.vertices;\n      msTexts[i++].textContent = \"Faces: \" + webGLRenderer.info.render.faces;\n      msTexts[i++].textContent = \"Points: \" + webGLRenderer.info.render.points;\n    }\n  }\n};\n\nif (typeof exports !== 'undefined') {\n  if (typeof module !== 'undefined' && module.exports) {\n    exports = module.exports = THREEx;\n  }\n  else {\n    exports.THREEx = THREEx;\n  }\n}\nelse {\n  this['THREEx'] = THREEx;\n}\n\n","// THREEx.KeyboardState.js keep the current state of the keyboard.\r\n// It is possible to query it at any time. No need of an event.\r\n// This is particularly convenient in loop driven case, like in\r\n// 3D demos or games.\r\n//\r\n// # Usage\r\n//\r\n// **Step 1**: Create the object\r\n//\r\n// ```var keyboard  = new THREEx.KeyboardState();```\r\n//\r\n// **Step 2**: Query the keyboard state\r\n//\r\n// This will return true if shift and A are pressed, false otherwise\r\n//\r\n// ```keyboard.pressed(\"shift+A\")```\r\n//\r\n// **Step 3**: Stop listening to the keyboard\r\n//\r\n// ```keyboard.destroy()```\r\n//\r\n// NOTE: this library may be nice as standaline. independant from three.js\r\n// - rename it keyboardForGame\r\n//\r\n// # Code\r\n//\r\n\r\n/** @namespace */\r\nvar THREEx = THREEx || {};\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREEx;\r\n\r\n}\r\n\r\n/**\r\n * - NOTE: it would be quite easy to push event-driven too\r\n *   - microevent.js for events handling\r\n *   - in this._onkeyChange, generate a string from the DOM event\r\n *   - use this as event name\r\n */\r\nTHREEx.KeyboardState = function(domElement) {\r\n  this.domElement = domElement || document;\r\n  // to store the current state\r\n  this.keyCodes = {};\r\n  this.modifiers = {};\r\n\r\n  // create callback to bind/unbind keyboard events\r\n  var _this = this;\r\n  this._onKeyDown = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n  this._onKeyUp = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n\r\n  // bind keyEvents\r\n  this.domElement.addEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.addEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // create callback to bind/unbind window blur event\r\n  this._onBlur = function() {\r\n    for (var prop in _this.keyCodes) _this.keyCodes[prop] = false;\r\n    for (var prop in _this.modifiers) _this.modifiers[prop] = false;\r\n  };\r\n\r\n  // bind window blur\r\n  window.addEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\n/**\r\n * To stop listening of the keyboard events\r\n */\r\nTHREEx.KeyboardState.prototype.destroy = function() {\r\n  // unbind keyEvents\r\n  this.domElement.removeEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.removeEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // unbind window blur event\r\n  window.removeEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\nTHREEx.KeyboardState.MODIFIERS = ['shift', 'ctrl', 'alt', 'meta'];\r\nTHREEx.KeyboardState.ALIAS = {\r\n  'left': 37,\r\n  'up': 38,\r\n  'right': 39,\r\n  'down': 40,\r\n  'space': 32,\r\n  'pageup': 33,\r\n  'pagedown': 34,\r\n  'tab': 9,\r\n  'escape': 27\r\n};\r\n\r\n/**\r\n * to process the keyboard dom event\r\n */\r\nTHREEx.KeyboardState.prototype._onKeyChange = function(event) {\r\n  // log to debug\r\n  //console.log(\"onKeyChange\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n\r\n  // update this.keyCodes\r\n  var keyCode = event.keyCode\r\n  var pressed = event.type === 'keydown' ? true : false\r\n  this.keyCodes[keyCode] = pressed\r\n    // update this.modifiers\r\n  this.modifiers['shift'] = event.shiftKey\r\n  this.modifiers['ctrl'] = event.ctrlKey\r\n  this.modifiers['alt'] = event.altKey\r\n  this.modifiers['meta'] = event.metaKey\r\n};\r\n\r\n/**\r\n * query keyboard state to know if a key is pressed of not\r\n *\r\n * @param {String} keyDesc the description of the key. format : modifiers+key e.g shift+A\r\n * @returns {Boolean} true if the key is pressed, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.pressed = function(keyDesc) {\r\n  var keys = keyDesc.split(\"+\");\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i]\r\n    var pressed = false\r\n    if (THREEx.KeyboardState.MODIFIERS.indexOf(key) !== -1) {\r\n      pressed = this.modifiers[key];\r\n    }\r\n    else if (Object.keys(THREEx.KeyboardState.ALIAS).indexOf(key) != -1) {\r\n      pressed = this.keyCodes[THREEx.KeyboardState.ALIAS[key]];\r\n    }\r\n    else {\r\n      pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)]\r\n    }\r\n    if (!pressed) return false;\r\n  };\r\n  return true;\r\n};\r\n\r\n/**\r\n * return true if an event match a keyDesc\r\n * @param  {KeyboardEvent} event   keyboard event\r\n * @param  {String} keyDesc string description of the key\r\n * @return {Boolean}         true if the event match keyDesc, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.eventMatches = function(event, keyDesc) {\r\n  var aliases = THREEx.KeyboardState.ALIAS\r\n  var aliasKeys = Object.keys(aliases)\r\n  var keys = keyDesc.split(\"+\")\r\n    // log to debug\r\n    // console.log(\"eventMatches\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i];\r\n    var pressed = false;\r\n    if (key === 'shift') {\r\n      pressed = (event.shiftKey ? true : false)\r\n    }\r\n    else if (key === 'ctrl') {\r\n      pressed = (event.ctrlKey ? true : false)\r\n    }\r\n    else if (key === 'alt') {\r\n      pressed = (event.altKey ? true : false)\r\n    }\r\n    else if (key === 'meta') {\r\n      pressed = (event.metaKey ? true : false)\r\n    }\r\n    else if (aliasKeys.indexOf(key) !== -1) {\r\n      pressed = (event.keyCode === aliases[key] ? true : false);\r\n    }\r\n    else if (event.keyCode === key.toUpperCase().charCodeAt(0)) {\r\n      pressed = true;\r\n    }\r\n    if (!pressed) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREEx;\r\n  }\r\n  else {\r\n    exports.THREEx = THREEx;\r\n  }\r\n}\r\nelse {\r\n  this['THREEx'] = THREEx;\r\n}\r\n\r\n","/**\r\n * b3\r\n * \r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\nvar b3 = b3 || {};\r\n\r\nmodule.exports = b3;\r\n\r\n/**\r\n * Behavior3JS\r\n * ===========\r\n *\r\n * * * *\r\n * \r\n * **Behavior3JS** is a Behavior Tree library written in JavaScript. It \r\n * provides structures and algorithms that assist you in the task of creating \r\n * intelligent agents for your game or application. Check it out some features \r\n * of Behavior3JS:\r\n * \r\n * - Based on the work of (Marzinotto et al., 2014), in which they propose a \r\n *   **formal**, **consistent** and **general** definition of Behavior Trees;\r\n * - **Optimized to control multiple agents**: you can use a single behavior \r\n *   tree instance to handle hundreds of agents;\r\n * - It was **designed to load and save trees in a JSON format**, in order to \r\n *   use, edit and test it in multiple environments, tools and languages;\r\n * - A **cool visual editor** which you can access online;\r\n * - Several **composite, decorator and action nodes** available within the \r\n *   library. You still can define your own nodes, including composites and \r\n *   decorators;\r\n * - **Completely free**, the core module and the visual editor are all published\r\n *   under the MIT License, which means that you can use them for your open source\r\n *   and commercial projects;\r\n * - **Lightweight**, only 11.5KB!\r\n * \r\n * Visit http://behavior3js.guineashots.com to know more!\r\n *\r\n * \r\n * Core Classes and Functions\r\n * --------------------------\r\n * \r\n * This library include the following core structures...\r\n *\r\n * **Public:**\r\n * \r\n * - **BehaviorTree**: the structure that represents a Behavior Tree;\r\n * - **Blackboard**: represents a \"memory\" in an agent and is required to to \r\n *   run a `BehaviorTree`;\r\n * - **Composite**: base class for all composite nodes;\r\n * - **Decorator**: base class for all decorator nodes;\r\n * - **Action**: base class for all action nodes;\r\n * - **Condition**: base class for all condition nodes;\r\n *\r\n * **Internal:**\r\n * \r\n * \r\n * - **Tick**: used as container and tracking object through the tree during \r\n *   the tick signal;\r\n * - **BaseNode**: the base class that provide all common node features;\r\n * \r\n * *Some classes are used internally on Behavior3JS, but you may need to access\r\n * its functionalities eventually, specially the `Tick` object.*\r\n *\r\n * \r\n * Nodes Included \r\n * --------------\r\n *\r\n * **Composite Nodes**: \r\n * \r\n * - Sequence;\r\n * - Priority;\r\n * - MemSequence;\r\n * - MemPriority;\r\n * \r\n * \r\n * **Decorators**: \r\n * \r\n * - Inverter;\r\n * - Limiter\r\n * - MaxTime;\r\n * - Repeater;\r\n * - RepeaterUntilFailure;\r\n * - RepeaterUntilSuccess;\r\n *\r\n * \r\n * **Actions**:\r\n * \r\n * - Succeeder;\r\n * - Failer;\r\n * - Error;\r\n * - Runner;\r\n * - Wait.\r\n * \r\n * @module Behavior3JS\r\n * @main Behavior3JS\r\n **/\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * List of all constants in Behavior3JS.\r\n   *\r\n   * @class Constants\r\n   **/\r\n\r\n  /**\r\n   * Version of the library.\r\n   * \r\n   * @property VERSION\r\n   * @type {String}\r\n   */\r\n  b3.VERSION = '0.1.0';\r\n\r\n  /**\r\n   * Returned when a criterion has been met by a condition node or an action node\r\n   * has been completed successfully.\r\n   * \r\n   * @property SUCCESS\r\n   * @type {Integer}\r\n   */\r\n  b3.SUCCESS = 1;\r\n\r\n  /**\r\n   * Returned when a criterion has not been met by a condition node or an action \r\n   * node could not finish its execution for any reason.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.FAILURE = 2;\r\n\r\n  /**\r\n   * Returned when an action node has been initialized but is still waiting the \r\n   * its resolution.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.RUNNING = 3;\r\n\r\n  /**\r\n   * Returned when some unexpected error happened in the tree, probably by a \r\n   * programming error (trying to verify an undefined variable). Its use depends \r\n   * on the final implementation of the leaf nodes.\r\n   * \r\n   * @property ERROR\r\n   * @type {Integer}\r\n   */\r\n  b3.ERROR = 4;\r\n\r\n\r\n  /**\r\n   * Describes the node category as Composite.\r\n   * \r\n   * @property COMPOSITE\r\n   * @type {String}\r\n   */\r\n  b3.COMPOSITE = 'composite';\r\n\r\n  /**\r\n   * Describes the node category as Decorator.\r\n   * \r\n   * @property DECORATOR\r\n   * @type {String}\r\n   */\r\n  b3.DECORATOR = 'decorator';\r\n\r\n  /**\r\n   * Describes the node category as Action.\r\n   * \r\n   * @property ACTION\r\n   * @type {String}\r\n   */\r\n  b3.ACTION = 'action';\r\n\r\n  /**\r\n   * Describes the node category as Condition.\r\n   * \r\n   * @property CONDITION\r\n   * @type {String}\r\n   */\r\n  b3.CONDITION = 'condition';\r\n\r\n\r\n  /**\r\n   * List of internal and helper functions in Behavior3JS.\r\n   * \r\n   * @class Utils\r\n   **/\r\n\r\n\r\n  /**\r\n   * This function is used to create unique IDs for trees and nodes.\r\n   * \r\n   * (consult http://www.ietf.org/rfc/rfc4122.txt).\r\n   *\r\n   * @method createUUID\r\n   * @return {String} A unique ID.\r\n   **/\r\n  b3.createUUID = function() {\r\n    var s = [];\r\n    var hexDigits = \"0123456789abcdef\";\r\n    for (var i = 0; i < 36; i++) {\r\n      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n    }\r\n    // bits 12-15 of the time_hi_and_version field to 0010\r\n    s[14] = \"4\";\r\n\r\n    // bits 6-7 of the clock_seq_hi_and_reserved to 01\r\n    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);\r\n\r\n    s[8] = s[13] = s[18] = s[23] = \"-\";\r\n\r\n    var uuid = s.join(\"\");\r\n    return uuid;\r\n  }\r\n\r\n  /**\r\n   * Class is a meta-factory function to create classes in JavaScript. It is a\r\n   * shortcut for the CreateJS syntax style. By default, the class created by \r\n   * this function have an initialize function (the constructor). Optionally, you\r\n   * can specify the inheritance by passing another class as parameter.\r\n   *\r\n   * By default, all classes created using this function, may receives only a\r\n   * settings parameter as argument. This pattern is commonly used by jQuery and \r\n   * its plugins.\r\n   *\r\n   * Usage\r\n   * -----\r\n   *\r\n   *     // Creating a simple class\r\n   *     var BaseClass = b3.Class();\r\n   *\r\n   *     // Using inheritance\r\n   *     var ChildClass = b3.Class(BaseClass);\r\n   *\r\n   *     // Defining the constructor\r\n   *     ChildClass.prototype.initialize = function(settings) { ... }\r\n   *\r\n   * @method Class\r\n   * @param {Object} [baseClass] The super class.\r\n   * @return {Object} A new class.\r\n   **/\r\n  b3.Class = function(baseClass) {\r\n    // create a new class\r\n    var cls = function(params) {\r\n      this.initialize(params);\r\n    }\r\n\r\n    // if base class is provided, inherit\r\n    if (baseClass) {\r\n      cls.prototype = new baseClass();\r\n      cls.prototype.constructor = cls;\r\n    }\r\n\r\n    // create initialize if does not exist on baseClass\r\n    cls.prototype.initialize = cls.prototype.initialize || function() {};\r\n\r\n    return cls;\r\n  }\r\n\r\n})();\r\n/**\r\n * Blackboard\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Blackboard is the memory structure required by `BehaviorTree` and its \r\n   * nodes. It only have 2 public methods: `set` and `get`. These methods works \r\n   * in 3 different contexts: global, per tree, and per node per tree.\r\n   * \r\n   * Suppose you have two different trees controlling a single object with a \r\n   * single blackboard, then:\r\n   *\r\n   * - In the global context, all nodes will access the stored information. \r\n   * - In per tree context, only nodes sharing the same tree share the stored \r\n   *   information.\r\n   * - In per node per tree context, the information stored in the blackboard can\r\n   *   only be accessed by the same node that wrote the data.\r\n   *   \r\n   * The context is selected indirectly by the parameters provided to these \r\n   * methods, for example:\r\n   * \r\n   *     // getting/setting variable in global context\r\n   *     blackboard.set('testKey', 'value');\r\n   *     var value = blackboard.get('testKey');\r\n   *     \r\n   *     // getting/setting variable in per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id);\r\n   *     var value = blackboard.get('testKey', tree.id);\r\n   *     \r\n   *     // getting/setting variable in per node per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id, node.id);\r\n   *     var value = blackboard.get('testKey', tree.id, node.id);\r\n   * \r\n   * Note: Internally, the blackboard store these memories in different objects,\r\n   *  being the global on `_baseMemory`, the per tree on `_treeMemory` and the \r\n   *  per node per tree dynamically create inside the per tree memory (it is \r\n   *  accessed via `_treeMemory[id].nodeMemory`). Avoid to use these variables \r\n   *  manually, use `get` and `set` instead.\r\n   *  \r\n   * @class Blackboard\r\n   **/\r\n  var Blackboard = b3.Class();\r\n\r\n  var p = Blackboard.prototype;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this._baseMemory = {};\r\n    this._treeMemory = {};\r\n  }\r\n\r\n  /**\r\n   * Internal method to retrieve the tree context memory. If the memory does\r\n   * not exist, this method creates it.\r\n   *\r\n   * @method _getTreeMemory\r\n   * @param {string} treeScope The id of the tree in scope.\r\n   * @returns {Object} The tree memory.\r\n   * @protected\r\n   **/\r\n  p._getTreeMemory = function(treeScope) {\r\n    if (!this._treeMemory[treeScope]) {\r\n      this._treeMemory[treeScope] = {\r\n        'nodeMemory': {},\r\n        'openNodes': [],\r\n        'traversalDepth': 0,\r\n        'traversalCycle': 0,\r\n      };\r\n    }\r\n    return this._treeMemory[treeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the node context memory, given the tree \r\n   * memory. If the memory does not exist, this method creates is.\r\n   *\r\n   * @method _getNodeMemory\r\n   * @param {String} treeMemory the tree memory.\r\n   * @param {String} nodeScope The id of the node in scope.\r\n   * @returns {Object} The node memory.\r\n   * @protected\r\n   **/\r\n  p._getNodeMemory = function(treeMemory, nodeScope) {\r\n    var memory = treeMemory['nodeMemory'];\r\n    if (!memory[nodeScope]) {\r\n      memory[nodeScope] = {};\r\n    }\r\n\r\n    return memory[nodeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the context memory. If treeScope and \r\n   * nodeScope are provided, this method returns the per node per tree \r\n   * memory. If only the treeScope is provided, it returns the per tree \r\n   * memory. If no parameter is provided, it returns the global memory. \r\n   * Notice that, if only nodeScope is provided, this method will still \r\n   * return the global memory.\r\n   *\r\n   * @method _getMemory\r\n   * @param {String} treeScope The id of the tree scope.\r\n   * @param {String} nodeScope The id of the node scope.\r\n   * @returns {Object} A memory object.\r\n   * @protected\r\n   **/\r\n  p._getMemory = function(treeScope, nodeScope) {\r\n    var memory = this._baseMemory;\r\n\r\n    if (treeScope) {\r\n      memory = this._getTreeMemory(treeScope);\r\n\r\n      if (nodeScope) {\r\n        memory = this._getNodeMemory(memory, nodeScope);\r\n      }\r\n    }\r\n\r\n    return memory;\r\n  };\r\n\r\n  /**\r\n   * Stores a value in the blackboard. If treeScope and nodeScope are \r\n   * provided, this method will save the value into the per node per tree \r\n   * memory. If only the treeScope is provided, it will save the value into \r\n   * the per tree memory. If no parameter is provided, this method will save \r\n   * the value into the global memory. Notice that, if only nodeScope is \r\n   * provided (but treeScope not), this method will still save the value into\r\n   * the global memory.\r\n   *\r\n   * @method set\r\n   * @param {String} key The key to be stored.\r\n   * @param {String} value The value to be stored.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   **/\r\n  p.set = function(key, value, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    memory[key] = value;\r\n  };\r\n\r\n  /**\r\n   * Retrieves a value in the blackboard. If treeScope and nodeScope are\r\n   * provided, this method will retrieve the value from the per node per tree\r\n   * memory. If only the treeScope is provided, it will retrieve the value\r\n   * from the per tree memory. If no parameter is provided, this method will\r\n   * retrieve from the global memory. If only nodeScope is provided (but\r\n   * treeScope not), this method will still try to retrieve from the global\r\n   * memory.\r\n   *\r\n   * @method get\r\n   * @param {String} key The key to be retrieved.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   * @returns {Object} The value stored or undefined.\r\n   **/\r\n  p.get = function(key, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    return memory[key];\r\n  };\r\n\r\n  b3.Blackboard = Blackboard;\r\n\r\n})();\r\n/**\r\n * Tick\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * A new Tick object is instantiated every tick by BehaviorTree. It is passed \r\n   * as parameter to the nodes through the tree during the traversal.\r\n   * \r\n   * The role of the Tick class is to store the instances of tree, debug, target\r\n   * and blackboard. So, all nodes can access these informations.\r\n   * \r\n   * For internal uses, the Tick also is useful to store the open node after the \r\n   * tick signal, in order to let `BehaviorTree` to keep track and close them \r\n   * when necessary.\r\n   *\r\n   * This class also makes a bridge between nodes and the debug, passing the node\r\n   * state to the debug if the last is provided.\r\n   *\r\n   * @class Tick\r\n   **/\r\n  var Tick = b3.Class();\r\n\r\n  var p = Tick.prototype;\r\n\r\n  /**\r\n   * The tree reference.\r\n   * \r\n   * @property tree\r\n   * @type {b3.BehaviorTree}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The debug reference.\r\n   * \r\n   * @property debug\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The target object reference.\r\n   * \r\n   * @property target\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The blackboard reference.\r\n   * \r\n   * @property blackboard\r\n   * @type {Blackboard}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The list of open nodes. Update during the tree traversal.\r\n   * \r\n   * @property _openNodes\r\n   * @type {Array}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The number of nodes entered during the tick. Update during the tree \r\n   * traversal.\r\n   * \r\n   * @property _nodeCount\r\n   * @type {Integer}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    // set by BehaviorTree\r\n    this.tree = null;\r\n    this.debug = null;\r\n    this.target = null;\r\n    this.blackboard = null;\r\n\r\n    // updated during the tick signal\r\n    this._openNodes = [];\r\n    this._nodeCount = 0;\r\n  }\r\n\r\n  /**\r\n   * Called when entering a node (called by BaseNode).\r\n   *\r\n   * @method _enterNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._enterNode = function(node) {\r\n    this._nodeCount++;\r\n    this._openNodes.push(node);\r\n\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when opening a node (called by BaseNode). \r\n   *\r\n   * @method _openNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._openNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when ticking a node (called by BaseNode).\r\n   *\r\n   * @method _tickNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._tickNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when closing a node (called by BaseNode).\r\n   *\r\n   * @method _closeNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._closeNode = function(node) {\r\n    // TODO: call debug here\r\n    this._openNodes.pop();\r\n  }\r\n\r\n  /**\r\n   * Callback when exiting a node (called by BaseNode).\r\n   *\r\n   * @method _exitNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._exitNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  b3.Tick = Tick;\r\n\r\n})();\r\n/**\r\n * BehaviorTree\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BehaviorTree class, as the name implies, represents the Behavior Tree \r\n   * structure.\r\n   * \r\n   * There are two ways to construct a Behavior Tree: by manually setting the \r\n   * root node, or by loading it from a data structure (which can be loaded from \r\n   * a JSON). Both methods are shown in the examples below and better explained \r\n   * in the user guide.\r\n   *\r\n   * The tick method must be called periodically, in order to send the tick \r\n   * signal to all nodes in the tree, starting from the root. The method \r\n   * `BehaviorTree.tick` receives a target object and a blackboard as parameters.\r\n   * The target object can be anything: a game agent, a system, a DOM object, \r\n   * etc. This target is not used by any piece of Behavior3JS, i.e., the target\r\n   * object will only be used by custom nodes.\r\n   * \r\n   * The blackboard is obligatory and must be an instance of `Blackboard`. This \r\n   * requirement is necessary due to the fact that neither `BehaviorTree` or any \r\n   * node will store the execution variables in its own object (e.g., the BT does\r\n   * not store the target, information about opened nodes or number of times the \r\n   * tree was called). But because of this, you only need a single tree instance \r\n   * to control multiple (maybe hundreds) objects.\r\n   * \r\n   * Manual construction of a Behavior Tree\r\n   * --------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *  \r\n   *     tree.root = new b3.Sequence({children:[\r\n   *         new b3.Priority({children:[\r\n   *             new MyCustomNode(),\r\n   *             new MyCustomNode()\r\n   *         ]}),\r\n   *         ...\r\n   *     ]});\r\n   *     \r\n   * \r\n   * Loading a Behavior Tree from data structure\r\n   * -------------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *\r\n   *     tree.load({\r\n   *         'title'       : 'Behavior Tree title'\r\n   *         'description' : 'My description'\r\n   *         'root'        : 'node-id-1'\r\n   *         'nodes'       : {\r\n   *             'node-id-1' : {\r\n   *                 'name'        : 'Priority', // this is the node type\r\n   *                 'title'       : 'Root Node', \r\n   *                 'description' : 'Description', \r\n   *                 'children'    : ['node-id-2', 'node-id-3'], \r\n   *             },\r\n   *             ...\r\n   *         }\r\n   *     })\r\n   *     \r\n   *\r\n   * @class BehaviorTree\r\n   **/\r\n  var BehaviorTree = b3.Class();\r\n\r\n  var p = BehaviorTree.prototype;\r\n\r\n  /**\r\n   * The tree id, must be unique. By default, created with `b3.createUUID`.\r\n   * \r\n   * @property id\r\n   * @type {String}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The tree title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * Description of the tree.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * A dictionary with (key-value) properties. Useful to define custom \r\n   * variables in the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * The reference to the root node. Must be an instance of `b3.BaseNode`.\r\n   *\r\n   * @property root\r\n   * @type {BaseNode}\r\n   */\r\n\r\n  /**\r\n   * The reference to the debug instance.\r\n   *\r\n   * @property debug\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = 'The behavior tree';\r\n    this.description = 'Default description';\r\n    this.properties = {};\r\n    this.root = null;\r\n    this.debug = null;\r\n  }\r\n\r\n  /**\r\n   * This method loads a Behavior Tree from a data structure, populating this\r\n   * object with the provided data. Notice that, the data structure must \r\n   * follow the format specified by Behavior3JS. Consult the guide to know \r\n   * more about this format.\r\n   *\r\n   * You probably want to use custom nodes in your BTs, thus, you need to \r\n   * provide the `names` object, in which this method can find the nodes by \r\n   * `names[NODE_NAME]`. This variable can be a namespace or a dictionary, \r\n   * as long as this method can find the node by its name, for example:\r\n   *\r\n   *     //json\r\n   *     ...\r\n   *     'node1': {\r\n   *       'name': MyCustomNode,\r\n   *       'title': ...\r\n   *     }\r\n   *     ...\r\n   *     \r\n   *     //code\r\n   *     var bt = new b3.BehaviorTree();\r\n   *     bt.load(data, {'MyCustomNode':MyCustomNode})\r\n   *     \r\n   * \r\n   * @method load\r\n   * @param {Object} data The data structure representing a Behavior Tree.\r\n   * @param {Object} [names] A namespace or dict containing custom nodes.\r\n   **/\r\n  p.load = function(data, names) {\r\n    names = names || {};\r\n\r\n    this.title = data.title || this.title;\r\n    this.description = data.description || this.description;\r\n    this.properties = data.properties || this.properties;\r\n\r\n    var nodes = {};\r\n    // Create the node list (without connection between them)\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n\r\n      if (spec.name in names) {\r\n        // Look for the name in custom nodes\r\n        var cls = names[spec.name];\r\n      }\r\n      else if (spec.name in b3) {\r\n        // Look for the name in default nodes\r\n        var cls = b3[spec.name];\r\n      }\r\n      else {\r\n        // Invalid node name\r\n        throw EvalError('BehaviorTree.load: Invalid node name + \"' +\r\n          spec.name + '\".');\r\n      }\r\n\r\n      var node = new cls(spec.parameters);\r\n      node.id = spec.id || node.id;\r\n      node.title = spec.title || node.title;\r\n      node.description = spec.description || node.description;\r\n      node.properties = spec.properties || node.properties;\r\n      node.parameters = spec.parameters || node.parameters;\r\n\r\n      nodes[id] = node;\r\n    }\r\n\r\n    // Connect the nodes\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n      var node = nodes[id];\r\n\r\n      if (node.category === b3.COMPOSITE && spec.children) {\r\n        for (var i = 0; i < spec.children.length; i++) {\r\n          var cid = spec.children[i];\r\n          node.children.push(nodes[cid]);\r\n        }\r\n      }\r\n      else if (node.category === b3.DECORATOR && spec.child) {\r\n        node.child = nodes[spec.child];\r\n      }\r\n    }\r\n\r\n    this.root = nodes[data.root];\r\n  };\r\n\r\n  /**\r\n   * This method dump the current BT into a data structure.\r\n   *\r\n   * Note: This method does not record the current node parameters. Thus, \r\n   * it may not be compatible with load for now.\r\n   * \r\n   * @method dump\r\n   * @returns {Object} A data object representing this tree.\r\n   **/\r\n  p.dump = function() {\r\n    var data = {};\r\n\r\n    data.title = this.title;\r\n    data.description = this.description;\r\n    data.root = (this.root) ? this.root.id : null;\r\n    data.properties = this.properties;\r\n    data.nodes = {};\r\n\r\n    if (!this.root) return data;\r\n\r\n    var stack = [this.root];\r\n    while (stack.length > 0) {\r\n      var node = stack.pop();\r\n\r\n      var spec = {};\r\n      spec.id = node.id;\r\n      spec.name = node.name;\r\n      spec.title = node.title;\r\n      spec.description = node.description;\r\n      spec.properties = node.properties;\r\n      spec.parameters = node.parameters;\r\n\r\n      if (node.category === b3.COMPOSITE && node.children) {\r\n        var children = []\r\n        for (var i = node.children.length - 1; i >= 0; i--) {\r\n          children.push(node.children[i].id);\r\n          stack.push(node.children[i]);\r\n        }\r\n        spec.children = children;\r\n      }\r\n      else if (node.category === b3.DECORATOR && node.child) {\r\n        stack.push(node.child);\r\n        spec.child = node.child.id;\r\n      }\r\n\r\n      data.nodes[node.id] = spec;\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  /**\r\n   * Propagates the tick signal through the tree, starting from the root.\r\n   * \r\n   * This method receives a target object of any type (Object, Array, \r\n   * DOMElement, whatever) and a `Blackboard` instance. The target object has\r\n   * no use at all for all Behavior3JS components, but surely is important \r\n   * for custom nodes. The blackboard instance is used by the tree and nodes \r\n   * to store execution variables (e.g., last node running) and is obligatory\r\n   * to be a `Blackboard` instance (or an object with the same interface).\r\n   * \r\n   * Internally, this method creates a Tick object, which will store the \r\n   * target and the blackboard objects.\r\n   * \r\n   * Note: BehaviorTree stores a list of open nodes from last tick, if these \r\n   * nodes weren't called after the current tick, this method will close them \r\n   * automatically.\r\n   * \r\n   * @method tick\r\n   * @param {Object} target A target object.\r\n   * @param {Blackboard} blackboard An instance of blackboard object.\r\n   * @returns {Constant} The tick signal state.\r\n   **/\r\n  p.tick = function(target, blackboard) {\r\n    if (!blackboard) {\r\n      throw 'The blackboard parameter is obligatory and must be an ' +\r\n      'instance of b3.Blackboard';\r\n    }\r\n\r\n    /* CREATE A TICK OBJECT */\r\n    var tick = new b3.Tick();\r\n    tick.debug = this.debug;\r\n    tick.target = target;\r\n    tick.blackboard = blackboard;\r\n    tick.tree = this;\r\n\r\n    /* TICK NODE */\r\n    var state = this.root._execute(tick);\r\n\r\n    /* CLOSE NODES FROM LAST TICK, IF NEEDED */\r\n    var lastOpenNodes = blackboard.get('openNodes', this.id);\r\n    var currOpenNodes = tick._openNodes.slice(0);\r\n\r\n    // does not close if it is still open in this tick\r\n    var start = 0;\r\n    for (var i = 0; i < Math.min(lastOpenNodes.length, currOpenNodes.length); i++) {\r\n      start = i + 1;\r\n      if (lastOpenNodes[i] !== currOpenNodes[i]) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    // close the nodes\r\n    for (var i = lastOpenNodes.length - 1; i >= start; i--) {\r\n      lastOpenNodes[i]._close(tick);\r\n    }\r\n\r\n    /* POPULATE BLACKBOARD */\r\n    blackboard.set('openNodes', currOpenNodes, this.id);\r\n    blackboard.set('nodeCount', tick._nodeCount, this.id);\r\n\r\n    return state;\r\n  };\r\n\r\n\r\n  b3.BehaviorTree = BehaviorTree;\r\n\r\n})();\r\n/**\r\n * BaseNode\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BaseNode class is used as super class to all nodes in BehaviorJS. It \r\n   * comprises all common variables and methods that a node must have to execute.\r\n   *\r\n   * **IMPORTANT:** Do not inherit from this class, use `b3.Composite`, \r\n   * `b3.Decorator`, `b3.Action` or `b3.Condition`, instead.\r\n   *\r\n   * The attributes are specially designed to serialization of the node in a JSON\r\n   * format. In special, the `parameters` attribute can be set into the visual \r\n   * editor (thus, in the JSON file), and it will be used as parameter on the \r\n   * node initialization at `BehaviorTree.load`.\r\n   * \r\n   * BaseNode also provide 5 callback methods, which the node implementations can\r\n   * override. They are `enter`, `open`, `tick`, `close` and `exit`. See their \r\n   * documentation to know more. These callbacks are called inside the `_execute`\r\n   * method, which is called in the tree traversal.\r\n   * \r\n   * @class BaseNode\r\n   **/\r\n  var BaseNode = b3.Class();\r\n\r\n  var p = BaseNode.prototype;\r\n\r\n  /**\r\n   * Node ID.\r\n   *\r\n   * @property id\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n\r\n  /**\r\n   * Node name. Must be a unique identifier, preferable the same name of the \r\n   * class. You have to set the node name in the prototype.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = null;\r\n\r\n  /**\r\n   * Node category. Must be `b3.COMPOSITE`, `b3.DECORATOR`, `b3.ACTION` or \r\n   * `b3.CONDITION`. This is defined automatically be inheriting the \r\n   * correspondent class.\r\n   *\r\n   * @property category\r\n   * @type constant\r\n   * @readonly\r\n   **/\r\n  p.category = null;\r\n\r\n  /**\r\n   * Node title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.title = null;\r\n\r\n  /**\r\n   * Node description.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.description = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node parameters. Useful for \r\n   * defining parameter values in the visual editor. Note: this is only \r\n   * useful for nodes when loading trees from JSON files.\r\n   *\r\n   * @property parameters\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.parameters = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node properties. Useful for \r\n   * defining custom variables inside the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.properties = null;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = this.title || this.name;\r\n    this.description = '';\r\n    this.parameters = {};\r\n    this.properties = {};\r\n  }\r\n\r\n  /**\r\n   * This is the main method to propagate the tick signal to this node. This \r\n   * method calls all callbacks: `enter`, `open`, `tick`, `close`, and \r\n   * `exit`. It only opens a node if it is not already open. In the same \r\n   * way, this method only close a node if the node  returned a status \r\n   * different of `b3.RUNNING`.\r\n   *\r\n   * @method _execute\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} The tick state.\r\n   * @protected\r\n   **/\r\n  p._execute = function(tick) {\r\n    /* ENTER */\r\n    this._enter(tick);\r\n\r\n    /* OPEN */\r\n    if (!tick.blackboard.get('isOpen', tick.tree.id, this.id)) {\r\n      this._open(tick);\r\n    }\r\n\r\n    /* TICK */\r\n    var status = this._tick(tick);\r\n\r\n    /* CLOSE */\r\n    if (status !== b3.RUNNING) {\r\n      this._close(tick);\r\n    }\r\n\r\n    /* EXIT */\r\n    this._exit(tick);\r\n\r\n    return status;\r\n  }\r\n\r\n  /**\r\n   * Wrapper for enter method.\r\n   *\r\n   * @method _enter\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._enter = function(tick) {\r\n    tick._enterNode(this);\r\n    this.enter(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for open method.\r\n   *\r\n   * @method _open\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._open = function(tick) {\r\n    tick._openNode(this);\r\n    tick.blackboard.set('isOpen', true, tick.tree.id, this.id);\r\n    this.open(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for tick method.\r\n   *\r\n   * @method _tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   * @protected\r\n   **/\r\n  p._tick = function(tick) {\r\n    tick._tickNode(this);\r\n    return this.tick(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for close method.\r\n   *\r\n   * @method _close\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._close = function(tick) {\r\n    tick._closeNode(this);\r\n    tick.blackboard.set('isOpen', false, tick.tree.id, this.id);\r\n    this.close(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for exit method.\r\n   *\r\n   * @method _exit\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._exit = function(tick) {\r\n    tick._exitNode(this);\r\n    this.exit(tick);\r\n  }\r\n\r\n  /**\r\n   * Enter method, override this to use. It is called every time a node is \r\n   * asked to execute, before the tick itself.\r\n   *\r\n   * @method enter\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.enter = function(tick) {}\r\n\r\n  /**\r\n   * Open method, override this to use. It is called only before the tick \r\n   * callback and only if the not isn't closed.\r\n   *\r\n   * Note: a node will be closed if it returned `b3.RUNNING` in the tick.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {}\r\n\r\n  /**\r\n   * Tick method, override this to use. This method must contain the real \r\n   * execution of node (perform a task, call children, etc.). It is called\r\n   * every time a node is asked to execute.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {}\r\n\r\n  /**\r\n   * Close method, override this to use. This method is called after the tick\r\n   * callback, and only if the tick return a state different from \r\n   * `b3.RUNNING`.\r\n   *\r\n   * @method close\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.close = function(tick) {}\r\n\r\n  /**\r\n   * Exit method, override this to use. Called every time in the end of the \r\n   * execution.\r\n   *\r\n   * @method exit\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.exit = function(tick) {}\r\n\r\n  b3.BaseNode = BaseNode;\r\n\r\n})();\r\n/**\r\n * Action\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Action is the base class for all action nodes. Thus, if you want to \r\n   * create new custom action nodes, you need to inherit from this class. \r\n   *\r\n   * For example, take a look at the Runner action:\r\n   * \r\n   *     var Runner = b3.Class(b3.Action);\r\n   *     var p = Runner.prototype;\r\n   *     \r\n   *         p.name = 'Runner';\r\n   *     \r\n   *         p.tick = function(tick) {\r\n   *             return b3.RUNNING;\r\n   *         }\r\n   *\r\n   * @class Action\r\n   * @extends BaseNode\r\n   **/\r\n  var Action = b3.Class(b3.BaseNode);\r\n\r\n  var p = Action.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.ACTION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.ACTION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Action = Action;\r\n\r\n})();\r\n/**\r\n * Composite\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Composite is the base class for all composite nodes. Thus, if you want to \r\n   * create new custom composite nodes, you need to inherit from this class. \r\n   * \r\n   * When creating composite nodes, you will need to propagate the tick signal to\r\n   * the children nodes manually. To do that, override the `tick` method and call \r\n   * the `_execute` method on all nodes. For instance, take a look at how the \r\n   * Sequence node inherit this class and how it call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Composite, using the util function Class.\r\n   *     var Sequence = b3.Class(b3.Composite);\r\n   *     var p = Sequence.prototype;\r\n   *\r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Sequence';\r\n   *         \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *\r\n   *             // Iterates over the children\r\n   *             for (var i=0; i<this.children.length; i++) {\r\n   *\r\n   *                 // Propagate the tick\r\n   *                 var status = this.children[i]._execute(tick);\r\n   * \r\n   *                 if (status !== b3.SUCCESS) {\r\n   *                     return status;\r\n   *                 }\r\n   *             }\r\n   *\r\n   *             return b3.SUCCESS;\r\n   *         }\r\n   *\r\n   * @class Composite\r\n   * @extends BaseNode\r\n   **/\r\n  var Composite = b3.Class(b3.BaseNode);\r\n\r\n  var p = Composite.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.COMPOSITE`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.COMPOSITE;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.children = (settings.children || []).slice(0);\r\n  };\r\n\r\n  b3.Composite = Composite;\r\n\r\n})();\r\n/**\r\n * Decorator\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Decorator is the base class for all decorator nodes. Thus, if you want to \r\n   * create new custom decorator nodes, you need to inherit from this class. \r\n   * \r\n   * When creating decorator nodes, you will need to propagate the tick signal to\r\n   * the child node manually, just like the composite nodes. To do that, override\r\n   * the `tick` method and call the `_execute` method on the child node. For \r\n   * instance, take a look at how the Inverter node inherit this class and how it\r\n   * call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Decorator, using the util function Class.\r\n   *     var Inverter = b3.Class(b3.Decorator);\r\n   *     var p = Inverter.prototype;\r\n   *     \r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Inverter';\r\n   *     \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *             if (!this.child) {\r\n   *                 return b3.ERROR;\r\n   *             }\r\n   *     \r\n   *             // Propagate the tick\r\n   *             var status = this.child._execute(tick);\r\n   *     \r\n   *             if (status == b3.SUCCESS)\r\n   *                 status = b3.FAILURE;\r\n   *             else if (status == b3.FAILURE)\r\n   *                 status = b3.SUCCESS;\r\n   *     \r\n   *             return status;\r\n   *         };\r\n   *\r\n   * @class Decorator\r\n   * @extends BaseNode\r\n   **/\r\n  var Decorator = b3.Class(b3.BaseNode);\r\n\r\n  var p = Decorator.prototype;\r\n\r\n  /**\r\n   * Node category. Default to b3.DECORATOR.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.DECORATOR;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.child = settings.child || null;\r\n  };\r\n\r\n  b3.Decorator = Decorator;\r\n\r\n})();\r\n/**\r\n * Condition\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Condition is the base class for all condition nodes. Thus, if you want to \r\n   * create new custom condition nodes, you need to inherit from this class. \r\n   *\r\n   * @class Condition\r\n   * @extends BaseNode\r\n   **/\r\n  var Condition = b3.Class(b3.BaseNode);\r\n\r\n  var p = Condition.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.CONDITION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.CONDITION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Condition = Condition;\r\n\r\n})();\r\n/**\r\n * Sequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Sequence node ticks its children sequentially until one of them returns \r\n   * `FAILURE`, `RUNNING` or `ERROR`. If all children return the success state, \r\n   * the sequence also returns `SUCCESS`.\r\n   *\r\n   * @class Sequence\r\n   * @extends Composite\r\n   **/\r\n  var Sequence = b3.Class(b3.Composite);\r\n\r\n  var p = Sequence.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Sequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Sequence';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Sequence = Sequence;\r\n\r\n})();\r\n/**\r\n * Priority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Priority ticks its children sequentially until one of them returns \r\n   * `SUCCESS`, `RUNNING` or `ERROR`. If all children return the failure state, \r\n   * the priority also returns `FAILURE`.\r\n   *\r\n   * @class Priority\r\n   * @extends Composite\r\n   **/\r\n  var Priority = b3.Class(b3.Composite);\r\n\r\n  var p = Priority.prototype\r\n\r\n  /**\r\n   * Node name. Default to `Priority`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Priority';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Priority = Priority;\r\n\r\n})();\r\n/**\r\n * MemSequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemSequence is similar to Sequence node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the MemPriority \r\n   * call the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemSequence = b3.Class(b3.Composite);\r\n\r\n  var p = MemSequence.prototype\r\n\r\n  /**\r\n   * Node name. Default to `MemSequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemSequence';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.MemSequence = MemSequence;\r\n\r\n})();\r\n/**\r\n * MemPriority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemPriority is similar to Priority node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the, MemPriority \r\n   * calls the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemPriority = b3.Class(b3.Composite);\r\n\r\n  var p = MemPriority.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MemPriority`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemPriority';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.MemPriority = MemPriority;\r\n\r\n})();\r\n/**\r\n * Inverter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Inverter decorator inverts the result of the child, returning `SUCCESS`\r\n   * for `FAILURE` and `FAILURE` for `SUCCESS`.\r\n   *\r\n   * @class Inverter\r\n   * @extends Decorator\r\n   **/\r\n  var Inverter = b3.Class(b3.Decorator);\r\n\r\n  var p = Inverter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Inverter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Inverter';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var status = this.child._execute(tick);\r\n\r\n    if (status == b3.SUCCESS)\r\n      status = b3.FAILURE;\r\n    else if (status == b3.FAILURE)\r\n      status = b3.SUCCESS;\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.Inverter = Inverter;\r\n\r\n})();\r\n/**\r\n * Limiter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This decorator limit the number of times its child can be called. After a\r\n   * certain number of times, the Limiter decorator returns `FAILURE` without \r\n   * executing the child.\r\n   *\r\n   * @class Limiter\r\n   * @extends Decorator\r\n   **/\r\n  var Limiter = b3.Class(b3.Decorator);\r\n\r\n  var p = Limiter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Limiter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Limiter';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method. \r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxLoop) {\r\n      throw \"maxLoop parameter in Limiter decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxLoop = settings.maxLoop;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    if (i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        tick.blackboard.set('i', i + 1, tick.tree.id, this.id);\r\n\r\n      return status;\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Limiter = Limiter;\r\n\r\n})();\r\n/**\r\n * MaxTime\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The MaxTime decorator limits the maximum time the node child can execute. \r\n   * Notice that it does not interrupt the execution itself (i.e., the child must\r\n   * be non-preemptive), it only interrupts the node after a `RUNNING` status.\r\n   *\r\n   * @class MaxTime\r\n   * @extends Decorator\r\n   **/\r\n  var MaxTime = b3.Class(b3.Decorator);\r\n\r\n  var p = MaxTime.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MaxTime`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MaxTime';\r\n\r\n  /**\r\n   * Node title. Default to `Max Time`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Max Time';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxTime': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxTime** (*Integer*) Maximum time a child can execute.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxTime) {\r\n      throw \"maxTime parameter in MaxTime decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxTime = settings.maxTime;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    var status = this.child._execute(tick);\r\n    if (currTime - startTime > this.maxTime) {\r\n      return b3.FAILURE;\r\n    }\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.MaxTime = MaxTime;\r\n\r\n})();\r\n/**\r\n * Repeater\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Repeater is a decorator that repeats the tick signal until the child node \r\n   * return `RUNNING` or `ERROR`. Optionally, a maximum number of repetitions \r\n   * can be defined.\r\n   *\r\n   * @class Repeater\r\n   * @extends Decorator\r\n   **/\r\n  var Repeater = b3.Class(b3.Decorator);\r\n\r\n  var p = Repeater.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Repeater`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Repeater';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   * \r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n    var status = b3.SUCCESS;\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  };\r\n\r\n  b3.Repeater = Repeater;\r\n\r\n})();\r\n/**\r\n * RepeatUntilFailure\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilFailure is a decorator that repeats the tick signal until the \r\n   * node child returns `FAILURE`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilFailure\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilFailure = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilFailure.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilFailure`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilFailure';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Failure`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Failure';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilFailure = RepeatUntilFailure;\r\n\r\n})();\r\n/**\r\n * RepeatUntilSuccess\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilSuccess is a decorator that repeats the tick signal until the \r\n   * node child returns `SUCCESS`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilSuccess\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilSuccess = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilSuccess.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilSuccess`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilSuccess';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Success`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Success';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilSuccess = RepeatUntilSuccess;\r\n\r\n})();\r\n/**\r\n * Error\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `ERROR` always.\r\n   *\r\n   * @class Error\r\n   * @extends Action\r\n   **/\r\n  var Error = b3.Class(b3.Action);\r\n\r\n  var p = Error.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Error`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Error';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.ERROR`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.ERROR;\r\n  }\r\n\r\n  b3.Error = Error;\r\n\r\n})();\r\n/**\r\n * Failer\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `FAILURE` always.\r\n   *\r\n   * @class Failer\r\n   * @extends Action\r\n   **/\r\n  var Failer = b3.Class(b3.Action);\r\n\r\n  var p = Failer.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Failer`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Failer';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.FAILURE`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Failer = Failer;\r\n\r\n})();\r\n/**\r\n * Runner\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns RUNNING always.\r\n   *\r\n   * @class Runner\r\n   * @extends Action\r\n   **/\r\n  var Runner = b3.Class(b3.Action);\r\n\r\n  var p = Runner.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Runner`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Runner';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.RUNNING`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Runner = Runner;\r\n\r\n})();\r\n/**\r\n * Succeeder\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `SUCCESS` always.\r\n   *\r\n   * @class Succeeder\r\n   * @extends Action\r\n   **/\r\n  var Succeeder = b3.Class(b3.Action);\r\n\r\n  var p = Succeeder.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Succeeder`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Succeeder';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.SUCCESS`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Succeeder = Succeeder;\r\n\r\n})();\r\n/**\r\n * Wait\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Wait a few seconds.\r\n   *\r\n   * @class Wait\r\n   * @extends Action\r\n   **/\r\n  var Wait = b3.Class(b3.Action);\r\n\r\n  var p = Wait.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Wait`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Wait';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'milliseconds': 0\r\n  };\r\n\r\n  p.__Action_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **milliseconds** (*Integer*) Maximum time, in milliseconds, a child\r\n   *                                can execute.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Action_initialize();\r\n\r\n    this.endTime = settings.milliseconds || 0;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    if (currTime - startTime > this.endTime) {\r\n      return b3.SUCCESS;\r\n    }\r\n\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Wait = Wait;\r\n\r\n})();\r\n\r\n","/*\r\n * Static methods that are used by pickup entities.\r\n * Abstracting the code out into static methods simplifies the creation of new pickups.\r\n * Each method takes in the pickup entity calling it. This entity should contain a pickup component, which itself\r\n * contains a dictionary of parameters needed by the method.\r\n */\r\nvar PickupMethods = PickupMethods || {};\r\n\r\nPickupMethods.heal = function(pickup) {\r\n  var target = pickup.pickup.parameters.target;\r\n\r\n  target.health.hp += pickup.pickup.parameters.healAmount;\r\n\r\n  if (target.health.hp > target.health.maxHP) {\r\n    target.health.hp = target.health.maxHP;\r\n  }\r\n\r\n  target.health.changed = true;\r\n\r\n  var geometry = pickup.drawable.mesh.geometry;\r\n  var material = pickup.drawable.mesh.material;\r\n\r\n  pickup.drawable.scene.remove(pickup.drawable.mesh);\r\n\r\n  geometry.dispose();\r\n\r\n  if (material.materials) {\r\n    material.materials.forEach(function(mat) {\r\n      mat.dispose();\r\n    });\r\n  }\r\n\r\n  if (material.dispose) {\r\n    material.dispose();\r\n  }\r\n\r\n  pickup.remove();\r\n};\r\n\r\nPickupMethods.increaseAmmo = function(pickup) {\r\n  var target = pickup.pickup.parameters.target;\r\n  var currentGun = pickup.pickup.parameters.gun;\r\n\r\n  target.ammo.currentAmmo[currentGun] += pickup.pickup.parameters.ammoAmount;\r\n\r\n  if (target.ammo.currentAmmo[currentGun] > target.ammo.maxAmmo[currentGun]) {\r\n    target.ammo.currentAmmo[currentGun] = target.ammo.maxAmmo[currentGun];\r\n  }\r\n\r\n  var geometry = pickup.drawable.mesh.geometry;\r\n  var material = pickup.drawable.mesh.material;\r\n\r\n  pickup.drawable.scene.remove(pickup.drawable.mesh);\r\n\r\n  geometry.dispose();\r\n\r\n  if (material.materials) {\r\n    material.materials.forEach(function(mat) {\r\n      mat.dispose();\r\n    });\r\n  }\r\n\r\n  if (material.dispose) {\r\n    material.dispose();\r\n  }\r\n\r\n  pickup.remove();\r\n};\r\n\r\nmodule.exports = PickupMethods;\r\n\r\n","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar Stats = function () {\n\n\tvar startTime = Date.now(), prevTime = startTime;\n\tvar ms = 0, msMin = Infinity, msMax = 0;\n\tvar fps = 0, fpsMin = Infinity, fpsMax = 0;\n\tvar frames = 0, mode = 0;\n\n\tvar container = document.createElement( 'div' );\n\tcontainer.id = 'stats';\n\tcontainer.addEventListener( 'mousedown', function ( event ) { event.preventDefault(); setMode( ++ mode % 2 ) }, false );\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar fpsDiv = document.createElement( 'div' );\n\tfpsDiv.id = 'fps';\n\tfpsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#002';\n\tcontainer.appendChild( fpsDiv );\n\n\tvar fpsText = document.createElement( 'div' );\n\tfpsText.id = 'fpsText';\n\tfpsText.style.cssText = 'color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tfpsText.innerHTML = 'FPS';\n\tfpsDiv.appendChild( fpsText );\n\n\tvar fpsGraph = document.createElement( 'div' );\n\tfpsGraph.id = 'fpsGraph';\n\tfpsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0ff';\n\tfpsDiv.appendChild( fpsGraph );\n\n\twhile ( fpsGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#113';\n\t\tfpsGraph.appendChild( bar );\n\n\t}\n\n\tvar msDiv = document.createElement( 'div' );\n\tmsDiv.id = 'ms';\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#020;display:none';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText = document.createElement( 'div' );\n\tmsText.id = 'msText';\n\tmsText.style.cssText = 'color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML = 'MS';\n\tmsDiv.appendChild( msText );\n\n\tvar msGraph = document.createElement( 'div' );\n\tmsGraph.id = 'msGraph';\n\tmsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0f0';\n\tmsDiv.appendChild( msGraph );\n\n\twhile ( msGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#131';\n\t\tmsGraph.appendChild( bar );\n\n\t}\n\n\tvar setMode = function ( value ) {\n\n\t\tmode = value;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 0:\n\t\t\t\tfpsDiv.style.display = 'block';\n\t\t\t\tmsDiv.style.display = 'none';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tfpsDiv.style.display = 'none';\n\t\t\t\tmsDiv.style.display = 'block';\n\t\t\t\tbreak;\n\t\t}\n\n\t};\n\n\tvar updateGraph = function ( dom, value ) {\n\n\t\tvar child = dom.appendChild( dom.firstChild );\n\t\tchild.style.height = value + 'px';\n\n\t};\n\n\treturn {\n\n\t\tREVISION: 12,\n\n\t\tdomElement: container,\n\n\t\tsetMode: setMode,\n\n\t\tbegin: function () {\n\n\t\t\tstartTime = Date.now();\n\n\t\t},\n\n\t\tend: function () {\n\n\t\t\tvar time = Date.now();\n\n\t\t\tms = time - startTime;\n\t\t\tmsMin = Math.min( msMin, ms );\n\t\t\tmsMax = Math.max( msMax, ms );\n\n\t\t\tmsText.textContent = ms + ' MS (' + msMin + '-' + msMax + ')';\n\t\t\tupdateGraph( msGraph, Math.min( 30, 30 - ( ms / 200 ) * 30 ) );\n\n\t\t\tframes ++;\n\n\t\t\tif ( time > prevTime + 1000 ) {\n\n\t\t\t\tfps = Math.round( ( frames * 1000 ) / ( time - prevTime ) );\n\t\t\t\tfpsMin = Math.min( fpsMin, fps );\n\t\t\t\tfpsMax = Math.max( fpsMax, fps );\n\n\t\t\t\tfpsText.textContent = fps + ' FPS (' + fpsMin + '-' + fpsMax + ')';\n\t\t\t\tupdateGraph( fpsGraph, Math.min( 30, 30 - ( fps / 100 ) * 30 ) );\n\n\t\t\t\tprevTime = time;\n\t\t\t\tframes = 0;\n\n\t\t\t}\n\n\t\t\treturn time;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tstartTime = this.end();\n\n\t\t}\n\n\t}\n\n};\n\nif ( typeof module === 'object' ) {\n\n\tmodule.exports = Stats;\n\n}","module.exports = {\n\n  Entity         : require('./lib/Entity.js'),\n  EntityManager  : require('./lib/EntityManager.js'),\n  Messanger      : require('./lib/Messanger.js'),\n  ObjectPool     : require('./lib/ObjectPool.js'),\n  QuadTree       : require('./lib/QuadTree.js'),\n  Spatial        : require('./lib/Spatial.js'),\n  Vec2           : require('./lib/Vec2.js')\n\n};\n","module.exports = Position;\r\n\r\nfunction Position() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n}\r\n\r\n","module.exports = Identifier;\r\n\r\nfunction Identifier() {\r\n  this.type = null;\r\n}\r\n\r\n","module.exports = Velocity;\r\n\r\nfunction Velocity() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n\r\n  this.rotationMatrix = null;\r\n\r\n  this.doMove = true;\r\n}\r\n\r\n","module.exports = Jump;\r\n\r\nfunction Jump() {\r\n  this.canJump = true;\r\n}\r\n\r\n","module.exports = Drawable;\r\n\r\nfunction Drawable() {\r\n  this.mesh = null;\r\n  this.scene = null;\r\n}\r\n\r\n","module.exports = CameraFollow;\r\n\r\nfunction CameraFollow() {\r\n  this.controls = null;\r\n  this.object = null;\r\n  this.offset = new THREE.Vector3();\r\n}\r\n\r\n","module.exports = Expirable;\r\n\r\nfunction Expirable() {\r\n  this.age = 0;\r\n  this.maxAge = 5;\r\n}\r\n\r\n","module.exports = ShootDelay;\r\n\r\nfunction ShootDelay() {\r\n  this.canShoot = true;\r\n\r\n  this.timer = 0;\r\n  this.delayTheshold = 0.2;\r\n}\r\n\r\n","module.exports = Hurt;\r\n\r\nfunction Hurt() {\r\n  this.timer = 0;\r\n  this.timerThreshold = 1;\r\n\r\n  this.hurtColor = new THREE.Color(0xdd0000);\r\n  this.originalColor = 0xffffff;\r\n}\r\n\r\n","module.exports = OneTimeHit;\r\n\r\nfunction OneTimeHit() {\r\n  this.alreadyHit = [];\r\n}\r\n\r\n","module.exports = Health;\r\n\r\nfunction Health() {\r\n  this.hp = 3;\r\n  this.maxHP = 3;\r\n\r\n  this.healthBar = null;\r\n\r\n  this.changed = false;\r\n}\r\n\r\n","module.exports = Bullet;\r\n\r\nfunction Bullet() {\r\n  this.isHot = true;\r\n  this.owner = null;\r\n}\r\n\r\n","module.exports = Ai;\r\n\r\nfunction Ai() {\r\n  this.tree = null;\r\n  this.target = null;\r\n  this.blackboard = null;\r\n}\r\n\r\n","module.exports = Steaming;\r\n\r\nfunction Steaming() {\r\n  this.particles = null;\r\n  this.system = null;\r\n  this.parent = null;\r\n  this.container = null;\r\n}\r\n\r\n","module.exports = CameraPitch;\r\n\r\nfunction CameraPitch() {\r\n  this.controls = null;\r\n  this.offset = 0;\r\n}\r\n\r\n","module.exports = Shield;\r\n\r\nfunction Shield() {\r\n  this.currentValue = 100;\r\n  this.maxValue = 100;\r\n\r\n  this.rechargeRate = 0.1;\r\n\r\n  this.timer = 0;\r\n  this.rechargeDelay = 1.5;\r\n\r\n  this.enabled = false;\r\n  this.changed = false;\r\n}\r\n\r\n","module.exports = Gun;\r\n\r\nfunction Gun() {\r\n  this.entity = null;\r\n  this.mesh = null;\r\n\r\n  this.type = Game.GUN_TYPES.none;\r\n}\r\n\r\n","module.exports = Ammo;\r\n\r\nfunction Ammo() {\r\n  this.currentAmmo = {};\r\n  this.maxAmmo = {};\r\n}\r\n\r\n","module.exports = DropsPickup;\r\n\r\nfunction DropsPickup() {\r\n  this.dropTypes = [];\r\n  this.dropChance = 0.3;\r\n}\r\n\r\n","module.exports = Pickup;\r\n\r\nfunction Pickup() {\r\n  this.method = null;\r\n  this.parameters = {};\r\n}\r\n\r\n","module.exports = EntityManager;\n\nvar Entity     = require('./Entity.js');\nvar ObjectPool = require('./ObjectPool.js');\nvar Messanger  = require('./Messanger.js');\nvar getName    = require('typedef').getName;\n\n/**\n * Manage, create, and destroy entities. Can use methods to mutate entities\n * (tags, components) directly or via the facade on the Entity.\n * @param {Messanger} messanger\n * @constructor\n */\nfunction EntityManager(messanger)\n{\n  this.messanger = messanger;\n  this._tags = {};\n\n  /**\n   * @type {Array.<Entity>}\n   */\n  this._entities = [];\n\n  /**\n   * @type {Array.<Group>}\n   */\n  this._groups = {};\n\n  this._entityPool = new ObjectPool(Entity);\n\n  this._componentPools = {};\n}\n\n/**\n * Fired AFTER an entity has be created.\n * @event\n */\nEntityManager.ENTITY_CREATED = 'EntityManager#ENTITY_CREATED';\n\n/**\n * Fired BEFORE an entity has been removed.\n * @event\n */\nEntityManager.ENTITY_REMOVE = 'EntityManager#ENTITY_REMOVE';\n\n/**\n * Fired AFTER a component has been removed.\n * @event\n */\nEntityManager.COMPONENT_ADDED = 'EntityManager#COMPONENT_ADDED';\n\n/**\n * Fired BEFORE a component has been removedt\n * @event\n */\nEntityManager.COMPONENT_REMOVE = 'EntityManager#COMPONENT_REMOVE';\n\n/**\n * @constructor\n * @param {Array.<Function>} Components\n * @param {Array<Entity>} entities\n */\nfunction Group(Components, entities)\n{\n  this.Components = Components || [];\n  this.entities = entities || [];\n}\n\n/**\n * Get a new entity.\n * @return {Entity}\n */\nEntityManager.prototype.createEntity = function()\n{\n  var entity = this._entityPool.aquire();\n\n  this._entities.push(entity);\n  entity._manager = this;\n  this._trigger(EntityManager.ENTITY_CREATED, entity);\n  return entity;\n};\n\n/**\n * Cleanly remove entities based on tag. Avoids loop issues.\n * @param {String} tag\n */\nEntityManager.prototype.removeEntitiesByTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities) return;\n\n  for (var x = entities.length - 1; x >= 0; x--) {\n    var entity = entities[x];\n    entity.remove();\n  }\n};\n\n/**\n * Dump all entities out of the manager. Avoids loop issues.\n */\nEntityManager.prototype.removeAllEntities = function()\n{\n  for (var x = this._entities.length - 1; x >= 0; x--) {\n    this._entities[x].remove();\n  }\n};\n\n/**\n * Drop an entity. Returns it to the pool and fires all events for removing\n * components as well.\n * @param {Entity} entity\n */\nEntityManager.prototype.removeEntity = function(entity)\n{\n  var index = this._entities.indexOf(entity);\n\n  if (!~index)\n    throw new Error('Tried to remove entity not in list');\n\n  this.entityRemoveAllComponents(entity);\n\n  // Remove from entity list\n  this._trigger(EntityManager.ENTITY_REMOVE, entity);\n  this._entities.splice(index, 1);\n\n  // Remove entity from any tag groups\n  entity._tags = null;\n  for (var tag in this._tags) {\n    var entities = this._tags[tag];\n    var n = entities.indexOf(entity);\n    if (~n) entities.splice(n, 1);\n  }\n\n  // Prevent any acecss and free\n  entity._manager = null;\n  this._entityPool.release(entity);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityAddTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities)\n    entities = this._tags[tag] = [];\n\n  // Don't add if already there\n  if (~entities.indexOf(entity)) return;\n\n  entities.push(entity);\n  entity._tags.push(tag);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityRemoveTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n  if (!entities) return;\n\n  var index = entities.indexOf(entity);\n  if (!~index) return;\n\n  entities.splice(index, 1);\n  entity._tags.splice(entity._tags.indexOf(tag), 1);\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityAddComponent = function(entity, Component)\n{\n  if (~entity._Components.indexOf(Component)) return;\n\n  entity._Components.push(Component);\n\n  // Create the reference on the entity to this (aquired) component\n  var cName = componentPropertyName(Component);\n  var cPool = this._componentPools[cName];\n  if (!cPool)\n    cPool = this._componentPools[cName] = new ObjectPool(Component);\n  var component = cPool.aquire();\n  entity[cName] = component;\n\n  // Check each indexed group to see if we need to add this entity to the list\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n    if (~group.entities.indexOf(entity))\n      continue;\n\n    group.entities.push(entity);\n  }\n\n  this._trigger(EntityManager.COMPONENT_ADDED, entity, Component);\n};\n\n/**\n * Drop all components on an entity.\n * @param {Entity} entity\n */\nEntityManager.prototype.entityRemoveAllComponents = function(entity)\n{\n  var Cs = entity._Components;\n\n  for (var j = Cs.length - 1; j >= 0; j--) {\n    var C = Cs[j];\n    entity.removeComponent(C);\n  }\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityRemoveComponent = function(entity, Component)\n{\n  var index = entity._Components.indexOf(Component);\n  if (!~index) return;\n\n  this._trigger(EntityManager.COMPONENT_REMOVE, entity, Component);\n\n  // Check each indexed group to see if we need to remove it\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n\n    var loc = group.entities.indexOf(entity);\n    if (~loc) {\n      group.entities.splice(loc, 1);\n    }\n  }\n\n  // Remove T listing on entity and property ref, then free the component.\n  var propName = componentPropertyName(Component);\n  entity._Components.splice(index, 1);\n  var component = entity[propName];\n  delete entity[propName];\n  this._componentPools[propName].release(component);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryComponents = function(Components)\n{\n  var group = this._groups[groupKey(Components)];\n\n  if (!group) {\n    group = this._indexGroup(Components);\n  }\n\n  return group.entities;\n};\n\n/**\n * @param {String} tag\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (entities === undefined)\n    entities = this._tags[tag] = [];\n\n  return entities;\n};\n\n/**\n * @return {Number} Total number of entities.\n */\nEntityManager.prototype.count = function()\n{\n  return this._entities.length;\n};\n\n/**\n * Get information about the object pools of the entities and the various\n * components.\n * @return {Object}\n */\nEntityManager.prototype.poolStats = function()\n{\n  var stats = {};\n  var e = this._entityPool;\n  stats.entity = {\n    used: this._entityPool.totalUsed(),\n    size: this._entityPool.count\n  };\n\n  for (var cName in this._componentPools) {\n    var pool = this._componentPools[cName];\n    stats[cName] = {\n      used: pool.totalUsed(),\n      size: pool.count\n    };\n  }\n\n  return stats;\n};\n\n/**\n * Create an index of entities with a set of components.\n * @param {Array.<Function>} Components\n * @private\n */\nEntityManager.prototype._indexGroup = function(Components)\n{\n  var key = groupKey(Components);\n\n  if (this._groups[key]) return;\n\n  var group = this._groups[key] = new Group(Components);\n\n  for (var n = 0; n < this._entities.length; n++) {\n    var entity = this._entities[n];\n    if (entity.hasAllComponents(Components)) {\n      group.entities.push(entity);\n    }\n  }\n\n  return group;\n};\n\n/**\n * Trigger the messanger if we have one.\n * @param {String} event\n * @param {Object=} a\n * @param {Object=} b\n */\nEntityManager.prototype._trigger = function(event, a, b)\n{\n  if (this.messanger)\n    this.messanger.trigger(event, a, b);\n};\n\n/**\n * @param {Function} Component\n * @return {String}\n * @private\n */\nfunction componentPropertyName(Component)\n{\n  var name = getName(Component);\n  return name.charAt(0).toLowerCase() + name.slice(1);\n}\n\n/**\n * @param {Array.<Function>} Components\n * @return {String}\n * @private\n */\nfunction groupKey(Components)\n{\n  var names = [];\n  for (var n = 0; n < Components.length; n++) {\n    var T = Components[n];\n    names.push(getName(T));\n  }\n\n  return names\n    .map(function(x) { return x.toLowerCase(); })\n    .sort()\n    .join('-');\n}\n\n","module.exports = Entity;\n\n/**\n * Basic component-driven object with facade functions for interacting with the\n * injected EntityManager object.\n * @constructor\n */\nfunction Entity()\n{\n  // Injected by EntityManager\n  this._manager    = null;\n\n  /**\n   * @type {Array.<Function>}\n   * @private\n   */\n  this._Components = [];\n\n  /**\n   * @type {Array.<String>}\n   * @private\n   */\n  this._tags       = [];\n}\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.addComponent = function(TComponent)\n{\n  this._manager.entityAddComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.removeComponent = function(TComponent)\n{\n  this._manager.entityRemoveComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {boolean} True if this entity has TComponent.\n */\nEntity.prototype.hasComponent = function(TComponent)\n{\n  return !!~this._Components.indexOf(TComponent);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {boolean} True if entity has all Components.\n */\nEntity.prototype.hasAllComponents = function(Components)\n{\n  var b = true;\n\n  for (var i = 0; i < Components.length; i++) {\n    var C = Components[i];\n    b &= !!~this._Components.indexOf(C);\n  }\n\n  return b;\n};\n\n/**\n * @param {String} tag\n * @return {boolean} True if entity has tag.\n */\nEntity.prototype.hasTag = function(tag)\n{\n  return !!~this._tags.indexOf(tag);\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.addTag = function(tag)\n{\n  this._manager.entityAddTag(this, tag);\n  return this;\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.removeTag = function(tag)\n{\n  this._manager.entityRemoveTag(this, tag);\n  return this;\n};\n\n/**\n * @return {void}\n */\nEntity.prototype.remove = function()\n{\n  return this._manager.removeEntity(this);\n};\n\n","module.exports = ObjectPool;\n\n/**\n * Minimize garbage collector thrashing by re-using existing objects instead of\n * creating new ones. Requires manually lifecycle management.\n * @constructor\n * @param {Function} T\n */\nfunction ObjectPool(T)\n{\n  this.freeList = [];\n  this.count    = 0;\n  this.T        = T;\n}\n\n/**\n * Get a pooled object\n */\nObjectPool.prototype.aquire = function()\n{\n  // Grow the list by 20%ish if we're out\n  if (this.freeList.length <= 0) {\n    this.expand(Math.round(this.count*0.2) + 1);\n  }\n\n  var item = this.freeList.pop();\n\n  // We can provide explicit initing, otherwise re-call constructor (hackish)\n  if (item.__init)\n    item.__init();\n  else\n    this.T.call(item);\n\n  return item;\n};\n\n/**\n * Return an object back to the pool.\n */\nObjectPool.prototype.release = function(item)\n{\n  this.freeList.push(item);\n};\n\n/**\n * @param {Number} Amount of new objects to allocate for this pool.\n */\nObjectPool.prototype.expand = function(count)\n{\n  for (var n = 0; n < count; n++)\n    this.freeList.push(new this.T());\n  this.count += count;\n};\n\n/**\n * @return {Number} Total amount of allocated objects (available and in-use).\n */\nObjectPool.prototype.totalSize = function()\n{\n  return this.count;\n};\n\n/**\n * @return {Number} Total number of objects currently available.\n */\nObjectPool.prototype.totalFree = function()\n{\n  return this.freeList.length;\n};\n\n/**\n * @return {Number} Total number of objects currently in-use.\n */\nObjectPool.prototype.totalUsed = function()\n{\n  return this.count - this.freeList.length;\n};\n\n","module.exports = Vec2;\n\nvar ObjectPool = require('./ObjectPool.js');\n\n/**\n * 2-dimension Cartesian vector with built-in (optional) object pool.\n * @constructor\n * @param {Number} x\n * @param {Number} y\n */\nfunction Vec2(x, y)\n{\n  this.x = +x || 0.0;\n  this.y = +y || 0.0;\n}\n\n/**\n * Reset for pool.\n * @private\n */\nVec2.prototype.__init = function()\n{\n  this.clear();\n};\n\n// Interal static object pool\nvar pool = new ObjectPool(Vec2);\n\n/**\n * Get a vector from the pool.\n * @return {Vec2}\n */\nVec2.aquire = function()\n{\n  return pool.aquire();\n};\n\n/**\n * Return a vector to the pool.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.release = function(v)\n{\n  if (v) pool.release(v);\n  return pool.count - pool.freeList.length;\n};\n\n/**\n * Reset this vector to (0,0).\n * @return {Vec2} This vector.\n */\nVec2.prototype.clear = function()\n{\n  this.x = this.y = 0.0;\n  return this;\n};\n\n/**\n * Assign this vector the value of another.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.assign = function(v)\n{\n  this.x = v.x;\n  this.y = v.y;\n  return this;\n};\n\n/**\n * Determine if this vector is equal to another.\n * @param {Vec2} v\n * @return {Boolean} True if vectors are equal.\n */\nVec2.prototype.equals = function(v)\n{\n  return this.x === v.x && this.y === v.y;\n};\n\n/**\n * Set this vector to a set of coordinates.\n * @param {Number} x\n * @param {Number} y\n * @return {Vec2} This vector.\n */\nVec2.prototype.set = function(x, y)\n{\n  this.x = +x;\n  this.y = +y;\n  return this;\n};\n\n/**\n * Limit this vector to a specific magnitude.\n * @param {Number} size\n * @return {Vec2} This vector.\n */\nVec2.prototype.limit = function(size)\n{\n  size = +size;\n  if (!size)\n    return this;\n  else if (this.magnitude() > size)\n    return this.normalize(size);\n  else\n    return this;\n};\n\n/**\n * Normalize this vector.\n * @param {Number=} m Length.\n * @return {Vec2} This vector.\n */\nVec2.prototype.normalize = function(m)\n{\n  m = m || +1.0;\n  var length = Math.sqrt(this.x * this.x + this.y * this.y);\n  this.x = m * this.x / length;\n  this.y = m * this.y / length;\n  return this;\n};\n\n/**\n * Subtract some vector from this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.sub = function(v)\n{\n  this.x -= v.x;\n  this.y -= v.y;\n  return this;\n};\n\n/**\n * Add some vector to this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.add = function(v)\n{\n  this.x += v.x;\n  this.y += v.y;\n  return this;\n};\n\n/**\n * Scalar multiply this vector by a value.\n * @param {Number} n\n * @return {Vec2} This vector.\n */\nVec2.prototype.smult = function(n)\n{\n  n = +n;\n  this.x *= n;\n  this.y *= n;\n  return this;\n};\n\n/**\n * Rotate this vector clockwise about the origin by a certain angle.\n * @param {Number} theta\n * @return {Vec2} This vector.\n */\nVec2.prototype.rotate = function(theta)\n{\n  return this.set(\n    this.x * Math.cos(theta) - this.y * Math.sin(theta),\n    this.x * Math.sin(theta) + this.y * Math.cos(theta)\n  );\n};\n\n/**\n * Get the dot product of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.dot = function(v)\n{\n  return +(this.x * v.x + this.y * v.y);\n};\n\n/**\n * Get the determinate of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.det = function(v)\n{\n  return +(this.x * v.y - this.y * v.x);\n};\n\n/**\n * Get the magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude = function()\n{\n  return Math.sqrt(this.x * this.x + this.y * this.y);\n};\n\n/**\n * Get the squared magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude2 = function()\n{\n  return this.x * this.x + this.y * this.y;\n};\n\n/**\n * Get the angle of this vector.\n * @return {Number}\n */\nVec2.prototype.angle = function()\n{\n  return Math.atan2(this.y, this.x);\n};\n\n/**\n * Get the angle between this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.angleBetween = function(v)\n{\n  return Math.atan2(this.det(v), this.dot(v));\n};\n\n/**\n * Make a pooled copy of this vector\n * @return {Vec2} A new vector.\n */\nVec2.prototype.pcopy = function()\n{\n  return Vec2.aquire().assign(this);\n};\n\n/**\n * Make a copy of this vector.\n * @return {Vec2} A new vector.\n */\nVec2.prototype.copy = function()\n{\n  return new Vec2().assign(this);\n};\n\n/**\n * Create a vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number=} m\n * @return {Vec2} A new vector.\n */\nVec2.fromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return new Vec2(Math.cos(theta) * m, Math.sin(theta) * m);\n};\n\n/**\n * Create a pooled vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number} m\n * @return {Vec2} A new vector.\n */\nVec2.pfromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return Vec2.aquire().set(\n    Math.cos(theta) * m,\n    Math.sin(theta) * m\n  );\n};\n\n/**\n * Determine if two rectangles, defined by a position and a halfwidth vector,\n * overlap.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they intersect\n */\nVec2.rectIntersect = function(p1, r1, p2, r2)\n{\n  // Basically, rectangles dont intersect if one's bottom is higher than ones\n  // top, ones left is more left than ones right, etc\n  var a = p1.x + r1.x < p2.x - r2.x;\n  var b = p1.x - r1.x > p2.x + r2.x;\n  var c = p1.y + r1.y < p2.y - r2.y;\n  var d = p1.y - r1.y > p2.y + r2.y;\n\n  // We want if they do\n  return !(a || b || c || d);\n};\n\n/**\n * Determines if rectangle 1 is entirely inside of rectangle 2.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they rectangle 1 is inside of rectangle 2\n */\nVec2.rectContains = function(p1, r1, p2, r2)\n{\n  if (p1.x - r1.x < p2.x - r2.x) return false;\n  if (p1.x + r1.x > p2.x + r2.x) return false;\n  if (p1.y - r1.y < p2.y - r2.y) return false;\n  if (p1.y + r1.y > p2.y + r2.y) return false;\n\n  return true;\n};\n\n/**\n * Convert a rectangle specified by top-left point + size into center location\n * + halfwidths.\n * @param {Vec2} position\n * @param {Vec2} size\n * @param {Vec2} out__position Output position\n * @param {Vec2} out__hwidth Output hwidths\n */\nVec2.sizeToHwidth = function(position, size, out__position, out__hwidth)\n{\n  out__hwidth.assign(size).smult(0.5);\n  out__position.assign(position).add(out__hwidth);\n};\n\n/**\n * Output this vector.\n */\nVec2.prototype.toString = function()\n{\n  return '' + (this.x.toFixed(2)) + ',' + (this.y.toFixed(2));\n};\n\n","module.exports = QuadTree;\n\nvar ObjectPool = require('./ObjectPool.js');\nvar Spatial    = require('./Spatial.js');\nvar Vec2       = require('./Vec2.js');\n\n/**\n * Effectively store positional and sized objects. Each tree has a position and\n * size, as well as up to 4 child nodes (other trees) and an array of entries.\n * @constructor\n */\nfunction QuadTree()\n{\n  this.level       = 0;\n  this.position    = new Vec2();\n  this.size        = new Vec2();\n  this.maxEntities = 15;\n  this.maxLevels   = 10;\n\n  /**\n   * Pool that is used for all internal quad trees. Only root node has one, all\n   * others have a refence.\n   */\n  this.pool = new ObjectPool(QuadTree);\n\n  /**\n   * @type {Array.<QuadTree>}\n   */\n  this.nodes = [];\n\n  /**\n   * @type {Array.<{spatial: Spatial}>}\n   */\n  this.entities = [];\n}\n\n/**\n * Reset for pool.\n * @private\n */\nQuadTree.prototype.__init = function()\n{\n  this.level = 0;\n  this.position.clear();\n  this.size.clear();\n  this.nodes.length = 0;\n  this.entities.length = 0;\n\n  // Only root node has actual ref to pool\n  this.pool = null;\n};\n\n/**\n * Add an entity to the tree\n * @param {{spatial: Spatial}} entity\n */\nQuadTree.prototype.insert = function(entity)\n{\n  // Recurse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].insert(entity);\n  }\n\n  // Actually add the entity\n  this.entities.push(entity);\n  this._splitAndRedistributeIfNeeded();\n  entity.spatial._node = this;\n  return entity;\n};\n\n/**\n * Remove an entity from this tree.\n * @param {{spatial: Spatial}} param\n */\nQuadTree.prototype.remove = function(entity)\n{\n  // Remove if we can\n  var n = this.entities.indexOf(entity);\n  if (~n) {\n    this.entities.splice(n, 1);\n    entity.spatial._node = null;\n    if (!this.totalSize())\n      this.clear();\n    return;\n  }\n\n  // Recuse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].remove(entity);\n  }\n};\n\n/**\n * Total recursive size of this tree.\n * @return {Number}\n */\nQuadTree.prototype.totalSize = function()\n{\n  var size = this.entities.length;\n\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    size += node.totalSize();\n  }\n\n  return size;\n};\n\n/**\n * Empty the tree recursively.\n */\nQuadTree.prototype.clear = function()\n{\n  // Clear entity area\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n    entity.spatial._node = null;\n  }\n  this.entities.length = 0;\n\n  // Recurse, free the node, and wipe out our node length\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    node.clear();\n    this.pool.release(node);\n  }\n  this.nodes.length = 0;\n};\n\n/**\n * Get all tree entries that are interesected by a rectangle defined with\n * position and hwidth.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @param {Array.<{spatial: Spatial}>=} out__objects Return objects.\n * @return {Array.<{spatial: Spatial}>} The out__objects parameter (filled up now)\n */\nQuadTree.prototype.queryArea = function(position, hwidth, out__entities)\n{\n  var entities = out__entities || [];\n\n  // If query belongs in ONLY a single node, then recurse\n  var index = this._getIndex(position, hwidth);\n  if (~index && this.nodes.length) {\n    this.nodes[index].queryArea(position, hwidth, entities);\n\n  // Otherwise, we have to add ALL of the nodes as it may be overlapping one\n  } else {\n    for (var j = 0; j < this.nodes.length; j++) {\n      var node = this.nodes[j];\n      node.queryArea(position, hwidth, entities);\n    }\n  }\n\n  // Also add everything from this node itself\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n\n    var overlapping = Vec2.rectIntersect(\n      entity.spatial.absPosition(),\n      entity.spatial.absHwidth(),\n      position,\n      hwidth);\n\n    if (overlapping) {\n      entities.push(entity);\n    }\n  }\n\n  return entities;\n};\n\n/**\n * Do a complete reset of the tree.\n */\nQuadTree.prototype.reIndex = function()\n{\n  this._combine();\n  this._splitAndRedistributeIfNeeded();\n};\n\nvar tSize = new Vec2();\nvar tPos  = new Vec2();\n\n/**\n * Check to see if an entity is still valid.\n * @param {{spatial: Spatial}} entity\n * @return {Boolean} True if the entity is in this tree (non-recursive) in its\n * correct place. False implies we need to re-add it.\n */\nQuadTree.prototype.validateEntity = function(entity)\n{\n  var pos = entity.spatial.position;\n  var hw  = entity.spatial.hwidth;\n\n  // Check to see if we're still inside this node\n  tSize.assign(this.size).smult(0.5);\n  tPos.assign(tSize).add(this.position);\n  var inside = Vec2.rectContains(pos, hw, tPos, tSize);\n\n  if (!inside) return false;\n\n  // No children nodes, then we're good\n  if (!this.nodes.length)\n    return true;\n\n  // Or if children nodes and we overlap, still good\n  var index = this._getIndex(entity.spatial.absPosition(),\n    entity.spatial.absHwidth());\n  if (this.nodes.length && !~index)\n    return true;\n\n  // Didnt make it\n  return false;\n};\n\n/**\n * Return which of the 4 quandrants of this tree an object would go into.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @return {Number} Which quandrant, or -1 if won't fit.\n * @private\n */\nQuadTree.prototype._getIndex = function(position, hwidth)\n{\n  var midX = this.position.x + this.size.x / 2;\n  var midY = this.position.y + this.size.y / 2;\n\n  var left   = position.x - hwidth.x < midX && position.x + hwidth.x < midX;\n  var right  = position.x - hwidth.x > midX && position.x + hwidth.x > midX;\n  var top    = position.y - hwidth.y < midY && position.y + hwidth.y < midY;\n  var bottom = position.y - hwidth.y > midY && position.y + hwidth.y > midY;\n\n  if (top && right) return 0;\n  if (top && left) return 1;\n  if (bottom && left) return 2;\n  if (bottom && right) return 3;\n\n  return -1;\n};\n\n/**\n * If we've overpacked this tree, then split into 4 smaller trees (if we\n * haven't already) and redistribute.\n * @private\n */\nQuadTree.prototype._splitAndRedistributeIfNeeded = function()\n{\n  if (this.entities.length > this.maxEntities &&\n    this.level < this.maxLevels)\n  {\n    this._split();\n    this._redistribute();\n  }\n};\n\n/**\n * Create a sub quad tree\n * @return {QuadTree}\n * @private\n */\nQuadTree.prototype._factory = function()\n{\n  var node = this.pool.aquire();\n\n  node.pool        = this.pool;\n  node.level       = this.level + 1;\n  node.maxEntities = this.maxEntities;\n  node.maxLevels   = this.maxLevels;\n\n  return node;\n};\n\n/**\n * Create 4 sub nodes for the tree (does not populate tho)\n * @private\n */\nQuadTree.prototype._split = function()\n{\n  if (this.nodes.length) return;\n\n  var x = this.position.x;\n  var y = this.position.y;\n\n  var w = this.size.x / 2;\n  var h = this.size.y / 2;\n\n  // Create the seperate nodes\n  for (var n = 0; n < 4; n++) {\n    var node = this._factory();\n    node.size.set(w, h);\n\n    switch(n) {\n      case 0:\n        node.position.set(x + w, y);\n        break;\n      case 1:\n        node.position.set(x, y);\n        break;\n      case 2:\n        node.position.set(x, y + h);\n        break;\n      case 3:\n        node.position.set(x + w, y + h);\n        break;\n    }\n\n    this.nodes.push(node);\n  }\n};\n\n/**\n * Distrubute all entities into child nodes if we can.\n * @private\n */\nQuadTree.prototype._redistribute = function()\n{\n  // Loop through all of our entries and if they can fit into a child node,\n  // move them there\n  var i = 0;\n  while (i < this.entities.length) {\n    var entity = this.entities[i];\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n\n    // Insert into child, remove from our array if they belong in another node\n    if (~index) {\n      this.nodes[index].insert(entity);\n      this.entities.splice(i, 1);\n    } else {\n      i++;\n    }\n  }\n};\n\n/**\n * Unwinds this node. Move all child nodes into this node and remove child\n * nodes.\n * @private\n */\nQuadTree.prototype._combine = function()\n{\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n\n    // Combine all children first\n    node._combine();\n\n    // All entries combined on node, now add it to US\n    for (var m = 0; m < node.entities.length; m++) {\n      var entity = node.entities[m];\n      this.entities.push(entity);\n    }\n\n    // Clear out and ensure we release it\n    node.entities.length = 0;\n    node.clear();\n    this.pool.release(node);\n  }\n\n  // Clear nodes array\n  this.nodes.length = 0;\n};\n\n","module.exports = Messanger;\n\nvar Event = require('./Event.js');\n\n/**\n * General event aggregation with filtering on components or tags.\n * @constructor\n */\nfunction Messanger()\n{\n  this._events = {};\n  this.fired   = 0;\n  this.handled = 0;\n}\n\n/**\n * @param {String} eventName\n * @param {Function} callback\n * @return {Event}\n */\nMessanger.prototype.listenTo = function(eventName, callback)\n{\n  if (!this._events[eventName])\n    this._events[eventName] = [];\n\n  var event = new Event(eventName, callback);\n\n  // Dump and chump\n  this._events[eventName].push(event);\n  return event;\n};\n\n/**\n * @param {String} eventName\n * @param {Object=} entity\n * @param {Option=} option\n */\nMessanger.prototype.trigger = function(eventName, entity, option)\n{\n  this.fired++;\n\n  var events = this._events[eventName];\n  if (!events) return;\n\n  // Try all events\n  for (var n = 0; n < events.length; n++) {\n    var event = events[n];\n    if (event.fire(eventName, entity, option))\n      this.handled++;\n  }\n};\n\n","module.exports = Spatial;\n\nvar Vec2 = require('./Vec2.js');\n\n/**\n * Basic component giving an entity the concept of being located somewhere.\n * Creates basic spatial heirachy, positions, rotation, etc.\n * @constructor\n */\nfunction Spatial()\n{\n  // Alloc our types\n  this.position     = new Vec2();\n  this.scale        = new Vec2();\n  this.hwidth       = new Vec2();\n\n  this._absScale    = new Vec2();\n  this._absPosition = new Vec2();\n  this._absHwidth   = new Vec2();\n\n  // Setup\n  this.__init();\n}\n\n/**\n * Setup called by pool.\n * @private\n */\nSpatial.prototype.__init = function()\n{\n  this.rotation = 0;\n\n  // Ref to quad tree node this component is in\n  this._node = null;\n\n  // Parent component\n  this.parent = null;\n\n  this.position.clear();\n  this.scale.set(1, 1);\n  this.hwidth.clear();\n  this._absPosition.clear();\n  this._absScale.set(1, 1);\n  this._absHwidth.clear();\n};\n\n/**\n * Fired when spatials overlap.\n * @event\n */\nSpatial.COINCIDENT = 'Spatial#COINCIDENT';\n\n/**\n * Attach this component to another entity's Spatial.\n * @param {{spatial: Spatial}} entity An entity with a Spatial component\n */\nSpatial.prototype.attachTo = function(entity)\n{\n  if (this.parent)\n    throw new Error ('Entity already attached');\n\n  if (!entity || !entity.spatial)\n    throw new Error('Invalid / missing entity');\n\n  this.parent = entity.spatial;\n};\n\n/**\n * The absolute world position of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absPosition = function()\n{\n  var v = this._absPosition.assign(this.position);\n\n  // Trivial case, no parent\n  if (!this.parent) {\n    return v;\n  }\n\n  var parent = this.parent;\n\n  // Rotate our angle by parent's angle\n  var r = this.absRotation();\n  v.rotate(parent.absRotation());\n\n  // Scale by parents scale\n  var pScale = parent.absScale();\n  v.set(v.x * pScale.x, v.y * pScale.y);\n\n  // Add parent's position\n  return v.add(parent.absPosition());\n};\n\n/**\n * The absolute world rotation of this component.\n * @return {Number}\n */\nSpatial.prototype.absRotation = function()\n{\n  // Trivial case\n  if (!this.parent)\n    return this.rotation;\n\n  // This + parent\n  var r = this.rotation + this.parent.absRotation();\n\n  return r % (Math.PI*2);\n};\n\n/**\n * The absolute world hwidth for this component.\n * @return {Vec2}\n */\nSpatial.prototype.absHwidth = function()\n{\n  var h = this._absHwidth.assign(this.hwidth);\n\n  if (!this.parent)\n    return h;\n\n  var scale = this.absScale();\n\n  return h.set(h.x * scale.x, h.y * scale.y);\n};\n\n/**\n * The absolute world scale of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absScale = function()\n{\n  var v = this._absScale.assign(this.scale);\n\n  // Trivial case\n  if (!this.parent) {\n    return v;\n  }\n\n  var pScale = this.parent.absScale();\n\n  return v.set(v.x * pScale.x, v.y * pScale.y);\n};\n\n","module.exports = Event;\n\n/**\n * @constructor\n */\nfunction Event(name, callback)\n{\n  this._name     = name || 'name';\n  this._callback = callback || null;\n\n  // Additional filters\n  this._Components = [];\n}\n\n/**\n * @param {String} eventName\n * @param {{hasAllComponents:Function}} entity\n * @param {Object=} option\n * @return {Boolean} True if fired.\n */\nEvent.prototype.fire = function(eventName, entity, option)\n{\n  // Name check\n  if (eventName !== this._name)\n    return false;\n\n  // Component filters\n  var Comps = this._Components;\n  if (entity && entity.hasAllComponents && Comps.length) {\n    if (!entity || !entity.hasAllComponents(Comps))\n      return false;\n  }\n\n  // Made it\n  this._callback(entity, option);\n  return true;\n};\n\n/**\n * @param {Function} T\n * @return {Event} This object.\n */\nEvent.prototype.whereComponent = function(T)\n{\n  this._Components.push(T);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Event} This object.\n */\nEvent.prototype.whereComponents = function(Components)\n{\n  this._Components = this._Components.concat(Components);\n  return this;\n};\n\n","module.exports = {\n\n  'extends'      : require('./lib/extends.js'),\n  'mixin'        : require('./lib/mixin.js'),\n  'getArguments' : require('./lib/getArguments.js'),\n  'getName'      : require('./lib/getName.js')\n\n};\n\n\n","module.exports = getArguments;\n\nvar FUNCTION_ARGS = /^\\w*function[^\\(]*\\(([^\\)]+)/;\n\n/**\n * Get the parameter names of a function.\n * @param {Function} f A function.\n * @return {Array.<String>} An array of the argument names of a function.\n */\nfunction getArguments(f)\n{\n  var ret = [];\n  var args = f.toString().match(FUNCTION_ARGS);\n\n  if (args) {\n    args = args[1]\n      .replace(/[ ]*,[ ]*/, ',')\n      .split(',');\n    for (var n = 0; n < args.length; n++) {\n      var a = args[n].replace(/^\\s+|\\s+$/g, '');\n      if (a) ret.push(a);\n    }\n  }\n\n  return ret;\n}\n\n","module.exports = extends_;\n\n/**\n * The well documented, oft-used (Coffeescript, Typescript, ES6... etc) extends\n * pattern to get some sort of single-inheritance in Javascript.  Modify a\n * Child class to have inherited the static members via copying and link the\n * prototypes.\n * @param {Function} Child Child constructor function.\n * @param {Function} Parent Parent contrusctor function.\n * @return {Function} The Child constructor.\n */\nfunction extends_(Child, Parent)\n{\n  // Drop in statics\n  for (var key in Parent) {\n    if (!Child.hasOwnProperty(key) && Parent.hasOwnProperty(key)) {\n      Child[key] = Parent[key];\n    }\n  }\n\n  // Give static to access parent\n  Child.Super = Parent;\n\n  // Child's prototype property is an object with the parent's prototype\n  // property its [[prototype]] + constructor\n  if (Object.create instanceof Function) {\n    Child.prototype = Object.create(Parent.prototype, {\n      constructor: { value: Child }\n    });\n  } else {\n    // IE8 and below shim\n    var T = makeT(Child);\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n  }\n\n  return Child;\n}\n\n/**\n * @param {Function} Child\n * @return {Function}\n */\nfunction makeT(Child)\n{\n  return function T() { this.constructor = Child; };\n}\n\n","module.exports = mixin_;\n\n/**\n * Add all own properties of mixin to the prototype property of class T\n * @param {Function} T Class we want to mix into.\n * @param {Function|Object} mixin Mixin we want to mixt\n */\nfunction mixin_(T, mixin)\n{\n  // If we're mixing in a class (constructor function), then first mix in all\n  // things hanging directly off the mixin as \"statics\", then switch the mixin\n  // ref to point to the prototype\n  if (mixin instanceof Function) {\n    for (var k in mixin) {\n      T[k] = mixin[k];\n    }\n    mixin = mixin.prototype;\n  }\n\n  // Dump everything on the mixin into the prototype of our class\n  for (var key in mixin) {\n    if (mixin.hasOwnProperty(key)) {\n      T.prototype[key] = mixin[key];\n    }\n  }\n}\n\n","module.exports = getName;\n\nvar FUNCTION_NAME = /function\\s+([^\\s(]+)/;\n\n/**\n * Get the name of a function (e.g. constructor)\n * @param {Function} f\n * @return {String} The function name.\n */\nfunction getName(f)\n{\n  var name = '';\n\n  if (f instanceof Function) {\n    if (f.name) {\n      return f.name;\n    }\n\n    var match = f.toString().match(FUNCTION_NAME);\n\n    if (match) {\n      name = match[1];\n    }\n  } else if (f && f.constructor instanceof Function) {\n    name = getName(f.constructor);\n  }\n\n  return name;\n}\n"]}