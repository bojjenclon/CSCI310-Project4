{"version":3,"sources":["../../../../AppData/Roaming/npm/node_modules/browserify/node_modules/browser-pack/_prelude.js","main.js","RequestAnimationFrame.js","rubbable.js","libgif.js","js/THREEx.KeyboardState.js","js/Game.js","js/Utils.js","js/Globals.js","js/PointerLockControls.js","js/ResourceManager.js","js/EntityFactory.js","js/Systems.js","js/SoundController.js","js/MouseController.js","node_modules/howler/howler.js","node_modules/physijs-browserify/physi.js","node_modules/js-class/class.js","node_modules/stats.js/src/Stats.js","js/Components.js","b3core.0.1.0.js","node_modules/three/three.js","node_modules/tiny-ecs/index.js","js/components/Identifier.js","js/components/Position.js","js/components/Velocity.js","js/components/Jump.js","js/components/CameraFollow.js","js/components/ShootDelay.js","js/components/Expirable.js","js/components/Drawable.js","js/components/Hurt.js","js/components/OneTimeHit.js","js/components/Health.js","js/components/Steaming.js","js/components/Bullet.js","js/components/Ai.js","js/components/CameraPitch.js","js/components/Gun.js","node_modules/tiny-ecs/lib/Entity.js","node_modules/tiny-ecs/lib/EntityManager.js","node_modules/tiny-ecs/lib/Messanger.js","node_modules/tiny-ecs/lib/ObjectPool.js","node_modules/tiny-ecs/lib/Spatial.js","node_modules/tiny-ecs/lib/Vec2.js","node_modules/tiny-ecs/lib/QuadTree.js","node_modules/tiny-ecs/lib/Event.js","node_modules/tiny-ecs/node_modules/typedef/index.js","node_modules/tiny-ecs/node_modules/typedef/lib/mixin.js","node_modules/tiny-ecs/node_modules/typedef/lib/extends.js","node_modules/tiny-ecs/node_modules/typedef/lib/getName.js","node_modules/tiny-ecs/node_modules/typedef/lib/getArguments.js"],"names":["init","Globals","instance","hudLeftElement","document","getElementById","hudRightElement","healthElement","ammoElement","scoreElement","reloadingElement","reloadImg","SuperGif","gif","load","overlayElement","gameOptions","container","loadingContainer","blocker","instructions","modelsToPreload","soundsToPreload","texturesToPreload","game","Game","start","global","Class","require","THREE","THREEx","Physijs","Stats","Howler","Utils","scripts","worker","ammo","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","root","factory","define","amd","exports","module","RubbableGif","this","options","sup","register_canvas_handers","isvp","x","vp_l","canvas","get_canvas","w","vp_w","width","maxDistance","Math","floor","get_length","startX","startTime","cantouch","aj","last_played","addEventListener","e","preventDefault","get_auto_play","pause","pos","touches","length","layerX","progress","move_to","timeStamp","pageX","play","currentX","currentDistance","abs","currentTime","get_current_frame","move_relative","orig_load","bitsToNum","ba","reduce","s","n","byteToBitArr","bite","a","i","push","Stream","data","len","readByte","Error","Uint8Array","charCodeAt","readBytes","bytes","read","String","fromCharCode","readUnsigned","lzwDecode","minCodeSize","code","last","readCode","size","output","clearCode","eoiCode","codeSize","dict","clear","concat","apply","parseGIF","st","handler","parseCT","entries","ct","readSubBlocks","parseHeader","hdr","sig","ver","height","bits","gctFlag","shift","colorRes","splice","sorted","gctSize","bgColor","pixelAspectRatio","gct","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","iterations","app","NETSCAPE","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","img","deinterlace","pixels","newPixels","Array","rows","cpRow","toRow","fromRow","fromPixels","slice","offsets","steps","pass","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","parseBlock","sentinel","type","eof","toString","parse","opts","vp_t","vp_h","c_w","c_h","is_vp","stream","loadError","loading","transparency","delay","disposalRestoreFromIdx","lastDisposalMethod","frame","lastImg","playing","forward","ctx_scaled","frames","frameOffsets","auto_play","getAttribute","ctx","toolbar","tmpCanvas","onEndListener","hasOwnProperty","on_end","loopDelay","loop_delay","overrideLoopMode","loop_mode","drawWhileLoading","draw_while_loading","showProgressBar","show_progress_bar","doParse","err","doLoadError","setSizes","h","get_canvas_scale","style","minWidth","getContext","setTransform","setFrameOffset","offset","y","doShowProgress","draw","left","mid","top","fillStyle","fillRect","originOfError","drawError","strokeStyle","lineWidth","moveTo","lineTo","stroke","doHdr","_hdr","doGCE","pushFrame","getImageData","doImg","currIdx","putImageData","clearRect","imgData","cdd","forEach","pixel","set","scale","drawImage","player","iterationCount","getNextFrameNo","delta","stepFrame","amount","putFrame","completeLoop","step","stepping","doStep","nextFrameNo","parseInt","globalCompositeOperation","current_frame","frame_idx","doDecodeProgress","doNothing","withProgress","fn","load_callback","parent","parentNode","span","createElement","className","appendChild","insertBefore","removeChild","initialized","max_width","load_setup","get_playing","get_loading","load_url","src","XMLHttpRequest","overrideMimeType","onloadstart","onload","responseText","onprogress","lengthComputable","loaded","total","onerror","open","send","load_raw","arr","set_frame_offset","KeyboardState","domElement","keyCodes","modifiers","_this","_onKeyDown","event","_onKeyChange","_onKeyUp","_onBlur","prop","prototype","destroy","removeEventListener","MODIFIERS","ALIAS","up","right","down","space","pageup","pagedown","tab","escape","keyCode","pressed","shiftKey","ctrlKey","altKey","metaKey","keyDesc","keys","split","key","indexOf","Object","toUpperCase","eventMatches","aliases","aliasKeys","constructor","stats","prevTime","performance","now","renderer","scene","camera","paused","controlsEnabled","controls","systems","postPhysicsSystems","percentModelsLoaded","percentSoundsLoaded","percentTexturesLoaded","systemsDelay","runImmediately","undefined","onResize","bind","onkeydown","onKeyDown","onMouseDown","onMouseUp","WebGLRenderer","antialias","setSize","innerWidth","innerHeight","setClearColor","setMode","position","bottom","body","Scene","setGravity","Vector3","aspectRatio","PerspectiveCamera","add","PointerLockControls","getObject","ambientLight","AmbientLight","dirLight","DirectionalLight","setupAudio","loadModels","loadSounds","loadTextures","AudioContext","webkitAudioContext","sound","SoundController","context","following","path","loadSound","DIR","soundLoaded","percentPerSound","waitForPreload","makeGame","ResourceManager","loadModel","modelLoaded","model","percentPerModel","loadTexture","textureLoaded","texture","percentPerTexture","modelsDone","soundsDone","texturesDone","donePreloadng","EntityFactory","makeGround","makePlayer","controlsObject","cameraOffset","gunOffset","hp","makeEnemy","aiTarget","bulletSpeed","randomRange","MIN_BULLET_SPEED","enemy","MAX_BULLET_SPEED","PlayerInputSystem","entities","AISystem","MovementSystem","ExpirableSystem","CameraPitchSystem","ShootDelaySystem","HurtSystem","PlayerHealthSystem","HealthBarSystem","DeathSystem","SteamRemovalSystem","SteamUpdateSystem","PhysicsUpdateSystem","CameraFollowSystem","startGame","visibility","display","scrollTop","documentElement","update","initPointerLock","animationFrame","time","dt","system","simulate","MouseController","render","aspect","updateProjectionMatrix","which","KEY_CODES","button","isDown","wasPressed","havePointerLock","pointerlockchange","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","enabled","pointerlockerror","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","test","navigator","userAgent","fullscreenchange","fullscreenElement","mozFullscreenElement","mozFullScreenElement","requestFullscreen","mozRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","innerHTML","statics","min","max","random","hudElement","score",{"end":{"file":"?","comments_before":[],"nlb":false,"endpos":384,"endcol":16,"endline":23,"pos":376,"col":8,"line":23,"value":"instance","type":"name"},"start":{"file":"?","comments_before":[],"nlb":false,"endpos":384,"endcol":16,"endline":23,"pos":376,"col":8,"line":23,"value":"instance","type":"name"},"name":"instance"},"_instance","ENTITY_TYPES","ground","obstacle","bullet","rotation","pitchObject","Object3D","yawObject","moveForward","moveBackward","moveLeft","moveRight","isOnObject","canJump","velocity","mass","moveSpeed","minimumY","onMouseMove","onKeyUp","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","PI_2","bool","getDirection","direction","Euler","v","copy","applyEuler","z","translateX","translateY","translateZ","PI","Model","geometry","material","clone","loadingManager","LoadingManager","jsonLoader","JSONLoader","textures","models","ImageUtils","console","log","getTexture","materials","MeshFaceMaterial","EntityManager","C","b3","createEntity","addTag","addComponent","Identifier","Position","Velocity","Jump","Drawable","CameraFollow","ShootDelay","Health","Gun","drawable","mesh","CapsuleMesh","createMaterial","MeshBasicMaterial","color","MASS","entity","_physijs","collision_type","COLLISION_TYPES","collision_masks","enemyBullet","setDamping","setAngularFactor","other_object","relative_velocity","relative_rotation","contact_normal","jump","hasComponent","Hurt","hurt","originalColor","health","changed","owner","hitSounds","soundPos","setFromMatrixPosition","matrixWorld","soundVel","soundDir","cameraFollow","soundIndex","getSound","setPosition","setVelocity","setOrientation","maxHP","rotationMatrix","Matrix4","extractRotation","matrix","object","shootDelay","delayTheshold","makeGun","cameraControls","gun","AI","MeshPhongMaterial","playerBullet","healthBar","Mesh","BoxGeometry","clamp","FaceNode","Action","name","parameters","facing","__Action_initialize","initialize","settings","tick","_manager","FAILURE","parentPos","target","followingPos","posDif","sub","applyMatrix4","angle","angleTo","SUCCESS","lookAtMatrix","lookAt","parentRotation","Quaternion","setFromEuler","targetRotation","setFromRotationMatrix","str","slerp","setFromQuaternion","__dirtyRotation","RUNNING","RandomChildNode","Composite","__Composite_initialize","chance","children","status","_execute","FollowNode","distance","distanceTo","difference","subVectors","normal","normalize","dv","MOVE_SPEED","ShootNode","shootingAt","canShoot","spawnLocation","spawnOffset","futureFrames","followingVel","multiplyScalar","predictedPos","velOffset","makePotato","ai","tree","BehaviorTree","Sequence","blackboard","Blackboard","CameraPitch","cameraPitch","potato","Bullet","Expirable","OneTimeHit","Steaming","doMove","mat","setHex","isHot","hitPlayer","hitEnemy","oneTimeHit","alreadyHit","uuid","touchedGround","soundForward","applyProjection","vel","multiply","applyCentralImpulse","expirable","maxAge","steaming","particles","Geometry","particle","vertices","smokeTexture","smokeMaterial","PointCloudMaterial","map","transparent","depthWrite","blending","AdditiveBlending","PointCloud","sortParticles","Gyroscope","makeFry","fry","BoxMesh","hasTag","mainTex","wrapS","wrapT","RepeatWrapping","diffuseTex","specularTex","displacementMap","specularMap","nothing","keyboard","jumped","players","queryTag","JUMP_FORCE","gunPos","bulletPos","bulletOffset","yMatrix","bulletRot","baseDirection","basePos","piOver2","bulletDirection","moveables","queryComponents","expirables","age","remove","follows","shooters","timer","hurtables","invulnerabilityFrames","hurtColor","backgroundColor","removeComponent","percent","percentRounded","round","Color","getHexString","mortals","singularities","particleCount","verticesNeedUpdate","pitchables","getLinearVelocity","Sound","source","createBufferSource","volume","createGain","panner","createPanner","connect","mainVolume","loop","self","request","responseType","decodeAudioData","response","buffer","alert","orientation","setVolume","gain","destination","sounds","setListenerPosition","setListenerOrientation","listener","cache","usingWebAudio","noAudio","Audio","masterGain","createGainNode","value","HowlerGlobal","codecs","_volume","_muted","_howls","_codecs","iOSAutoEnable","vol","parseFloat","_webAudio","_audioNode","mute","_setMuted","unmute","muted","ext","_enableiOSAudio","_iOSEnabled","unlock","createBuffer","noteOn","playbackState","PLAYING_STATE","FINISHED_STATE","audioTest","mp3","canPlayType","replace","opus","ogg","wav","aac","m4a","mp4","weba","Howl","o","_autoplay","autoplay","_buffer","_duration","duration","_format","format","_loop","_loaded","_sprite","sprite","_src","_pos3d","pos3d","_urls","urls","_rate","rate","_model","_onload","_onloaderror","onloaderror","_onend","onend","_onpause","onpause","_onplay","onplay","_onendTimer","_setupAudioNode","url","on","urlItem","exec","toLowerCase","loadBuffer","newNode","error","_pos","preload","ceil","getOwnPropertyNames","_default","stop","_inactiveNode","node","timerId","soundId","Date","id","_nodeById","_clearEndTimer","loopStart","loopEnd","refreshBuffer","_playStart","bufferSource","noteGrainOn","readyState","isCocoonJS","playSprite","activeNode","_activeNode","noteOff","isNaN","panningModel","fade","from","to","diff","dir","stepTime","change","toVol","fadeIn","fadeOut","_drainPool","listenerEvent","inactive","disconnect","index","clearTimeout","events","call","off","fnString","unload","nodes","obj","atob","dataView","xhr","_gainNode","arraybuffer","playbackRate","SUPPORT_TRANSFERABLE","Eventable","getObjectId","getEulerXYZFromQuaternion","getQuatertionFromEuler","convertWorldPositionToObject","addObjectChildren","_temp1","_temp2","_is_simulating","_Physijs","_temp_vector3_1","_temp_vector3_2","_temp_matrix4_1","_quaternion_1","MESSAGE_TYPES","WORLDREPORT","COLLISIONREPORT","VEHICLEREPORT","CONSTRAINTREPORT","REPORT_ITEMSIZE","COLLISIONREPORT_ITEMSIZE","VEHICLEREPORT_ITEMSIZE","CONSTRAINTREPORT_ITEMSIZE","_eventListeners","event_name","dispatchEvent","arguments","make","_id","atan2","asin","c1","s1","c2","s2","c3","s3","c1c2","s1s2","cos","sin","identity","makeRotationFromQuaternion","quaternion","getInverse","noConflict","friction","restitution","physijs_material","PointConstraint","objecta","objectb","appliedImpulse","positiona","positionb","getDefinition","HingeConstraint","axis","setLimits","low","high","bias_factor","relaxation_factor","execute","constraint","enableAngularMotor","acceleration","disableMotor","SliderConstraint","lin_lower","lin_upper","ang_lower","ang_upper","setRestitution","linear","angular","enableLinearMotor","disableLinearMotor","disableAngularMotor","ConeTwistConstraint","axisa","axisb","setLimit","enableMotor","setMaxMotorImpulse","max_impulse","setMotorTarget","DOFConstraint","setLinearLowerLimit","limit","setLinearUpperLimit","setAngularLowerLimit","setAngularUpperLimit","configureAngularMotor","low_angle","high_angle","max_force","params","_worker","Worker","transferableMessage","webkitPostMessage","postMessage","_materials_ref_counts","_objects","_vehicles","_constraints","ab","ArrayBuffer","byteLength","message","filename","lineno","onmessage","_temp","Float32Array","_updateScene","_updateCollisions","_updateVehicles","_updateConstraints","cmd","debug","fixedTimeStep","rateLimit","num_objects","__dirtyPosition","linearVelocity","angularVelocity","vehicle","wheel","wheels","addVectors","j","object2","id1","id2","collisions","normal_offsets","getAngularVelocity","normal_offset","addConstraint","show_marker","marker","SphereGeometry","MeshNormalMaterial","onSimulationResume","removeConstraint","updateMatrix","updateMatrixWorld","position_offset","world","Vehicle","materialId","depth","pop","setFixedTimeStep","gravity","timeStep","maxSubSteps","object_id","quat","boundingBox","computeBoundingBox","__defineGetter__","__defineSetter__","force","applyImpulse","impulse_x","impulse_y","impulse_z","applyTorque","torque_x","torque_y","torque_z","applyCentralForce","applyForce","force_x","force_y","force_z","setAngularVelocity","setLinearVelocity","factor","setLinearFactor","setCcdMotionThreshold","threshold","setCcdSweptSphereRadius","radius","PlaneMesh","faces","HeightfieldMesh","xdiv","ydiv","xsize","ysize","xpts","sqrt","ypts","absMaxHeight","b","points","SphereMesh","boundingSphere","computeBoundingSphere","pow","CylinderMesh","ConeMesh","ConcaveMesh","face","triangles","Face3","c","Face4","d","ConvexMesh","tuning","VehicleTuning","rigidBody","suspension_stiffness","suspension_compression","suspension_damping","max_suspension_travel","friction_slip","max_suspension_force","addWheel","wheel_geometry","wheel_material","connection_point","wheel_direction","wheel_axle","suspension_rest_length","wheel_radius","is_front_wheel","castShadow","receiveShadow","setSteering","steering","setBrake","brake","applyEngineForce","inherit","dest","noParent","desc","getOwnPropertyDescriptor","defineProperty","__proto__","findType","meta","implType","implMeta","proto","base","implements","classProto","isArray","implementedType","extend","theClass","enumerable","configurable","writable","Checker","typeOf","typeInfo","an","is","VERSION","ms","msMin","Infinity","msMax","fps","fpsMin","fpsMax","mode","cssText","fpsDiv","fpsText","fpsGraph","bar","msDiv","msText","msGraph","updateGraph","dom","child","firstChild","REVISION","begin","end","textContent","ERROR","COMPOSITE","DECORATOR","ACTION","CONDITION","createUUID","hexDigits","substr","join","baseClass","cls","p","_baseMemory","_treeMemory","_getTreeMemory","treeScope","nodeMemory","openNodes","traversalDepth","traversalCycle","_getNodeMemory","treeMemory","nodeScope","memory","_getMemory","get","Tick","_openNodes","_nodeCount","_enterNode","_openNode","_tickNode","_closeNode","_exitNode","title","description","properties","names","spec","EvalError","category","cid","dump","stack","state","lastOpenNodes","currOpenNodes","_close","BaseNode","_enter","_open","_tick","_exit","enter","close","exit","__BaseNode_initialize","Decorator","Condition","Priority","MemSequence","MemPriority","Inverter","Limiter","maxLoop","__Decorator_initialize","MaxTime","maxTime","getTime","currTime","Repeater","RepeatUntilFailure","RepeatUntilSuccess","Failer","Runner","Succeeder","Wait","milliseconds","endTime","sign","warn","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","NoShading","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","Projector","projectVector","vector","project","unprojectVector","unproject","pickingRay","CanvasRenderer","setRGB","r","g","setStyle","hex","setHSL","l","hue2rgb","q","t","ColorKeywords","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","getHex","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","lerp","alpha","equals","fromArray","array","toArray","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","_x","_y","_z","_w","onChangeCallback","euler","order","setFromAxisAngle","halfAngle","m","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","dot","crossVectors","inverse","conjugate","lengthSq","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","qa","qm","Vector2","setX","setY","setComponent","getComponent","subScalar","divide","divideScalar","scalar","invScalar","clampScalar","minVal","maxVal","roundToZero","negate","distanceToSquared","dx","dy","setLength","oldLength","lerpVectors","v2","fromAttribute","attribute","itemSize","setZ","multiplyVectors","applyAxisAngle","applyMatrix3","qx","qy","qz","qw","ix","iy","iz","iw","multiplyMatrices","projectionMatrix","transformDirection","lengthManhattan","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","line","center","result","distanceSq","at","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","setFromPoints","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromObject","scope","traverse","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","multiplyVector3Array","applyToVector3Array","determinant","f","throwOnInvertible","det","msg","transpose","tmp","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","eye","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","rotateX","rotateY","rotateZ","rotateByAxis","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","decompose","invSX","invSY","invSZ","makeFrustum","near","far","makePerspective","fov","ymax","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","origin","ray","recast","directionDistance","distanceSqToSegment","segCenter","segDir","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","rnd","clampBottom","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nextPowerOfTwo","Spline","interpolate","t2","t3","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","Clock","autoStart","oldTime","elapsedTime","running","getElapsedTime","getDelta","newTime","EventDispatcher","hasEventListener","_listeners","listeners","listenerArray","Raycaster","Sprite","LOD","Line","descSort","intersectObject","raycaster","intersects","recursive","raycast","precision","linePrecision","setFromCamera","OrthographicCamera","sort","intersectObjects","objects","Object3DIdCount","DefaultUp","onRotationChange","onQuaternionChange","defineProperties","rotationAutoUpdate","matrixAutoUpdate","matrixWorldNeedsUpdate","visible","frustumCulled","renderOrder","userData","eulerOrder","useQuaternion","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","localToWorld","worldToLocal","getChildByName","getObjectByName","getObjectById","getObjectByProperty","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","toJSON","metadata","version","generator","geometries","parseGeometry","json","parseMaterial","parseObject","JSON","stringify","intensity","PointLight","decay","SpotLight","exponent","HemisphereLight","groundColor","materialIndex","vertexNormals","vertexColors","vertexTangents","BufferAttribute","needsUpdate","copyAt","index1","index2","setXY","setXYZ","setXYZW","Int8Attribute","Uint8Attribute","Uint8ClampedAttribute","Int16Attribute","Uint16Attribute","Int32Attribute","Uint32Attribute","Float32Attribute","Float64Attribute","DynamicBufferAttribute","updateRange","count","create","GeometryIdCount","attributesKeys","drawcalls","addAttribute","addDrawCall","indexOffset","fromGeometry","faceVertexUvs","hasFaceVertexUv","hasFaceVertexNormals","normals","colors","uvs","i3","na","nb","nc","fc","vca","vcb","vcc","uva","uvb","uvc","bb","computeFaceNormals","computeVertexNormals","vA","vB","vC","pA","pB","pC","cb","indices","jl","normalizeNormals","computeTangents","handleTriangle","uvA","uvB","uvC","x1","y1","z1","sdir","tdir","tan1","tan2","handleVertex","n2","tmp2","tangents","uv","nVertices","tangent","iA","iB","iC","computeOffsets","facesCount","sortedIndices","Uint16Array","indexPtr","vertexPtr","duplicatedVertices","newVerticeMaps","faceVertices","Int32Array","vertexMap","revVertexMap","findex","vo","vid","faceMax","new_offset","new_vid","reorderBuffers","merge","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","indexBuffer","indexMap","vertexCount","sortedAttributes","attr","sourceArray","attrArray","attrSize","sortedAttr","numItems","sourceAttr","dispose","morphTargets","morphColors","morphNormals","skinWeights","skinIndices","lineDistances","hasTangents","dynamic","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","tangentsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","fromBufferGeometry","tempNormals","tempUVs","addFace","drawcall","fl","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","ua","ub","uc","vertexIndex","faceIndex","computeLineDistances","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","uvs2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mergeVertices","verticesMap","unique","changes","precisionPoints","faceIndicesToRemove","dupIndex","idx","setBit","getNormalIndex","hash","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","hasMaterial","hasFaceUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","magFilter","minFilter","updateCubeMap","generateMipmaps","activeCubeFace","zoom","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","Light","light","AreaLight","constantAttenuation","linearAttenuation","quadraticAttenuation","onlyShadow","shadowCameraNear","shadowCameraFar","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","shadowCascade","shadowCascadeOffset","shadowCascadeCount","shadowCascadeBias","shadowCascadeWidth","shadowCascadeHeight","shadowCascadeNearZ","shadowCascadeFarZ","shadowCascadeArray","shadowMap","shadowMapSize","shadowCamera","shadowMatrix","skyColor","shadowCameraFov","Cache","files","file","Loader","showStatus","statusDomElement","addStatusElement","imageLoader","ImageLoader","onLoadStart","onLoadProgress","onLoadComplete","crossOrigin","fontSize","textAlign","background","padding","zIndex","updateProgress","toFixed","extractUrlBase","parts","initMaterials","texturePath","needsTangents","ShaderMaterial","nearest_pow2","LN2","create_texture","where","sourceFile","repeat","wrap","anisotropy","fullPath","loader","Handlers","Texture","image","wrapMap","mirror","rgb2hex","rgb","mtype","mpars","opacity","lightMap","normalMap","bumpMap","wireframe","shading","depthTest","flipSided","side","doubleSided","colorDiffuse","DbgColor","colorSpecular","specular","colorEmissive","emissive","specularCoef","shininess","mapDiffuse","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLight","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapBump","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormal","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecular","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlpha","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","mapBumpScale","bumpScale","mapNormalFactor","normalScale","DbgName","handlers","regex","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","itemEnd","itemStart","setResponseType","setCrossOrigin","withCredentials","loadAjaxJSON","callbackProgress","onreadystatechange","DONE","LOADING","getResponseHeader","HEADERS_RECEIVED","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","bones","animation","animations","parseMorphing","dstVertices","srcVertices","cl","dstColors","srcColors","BufferGeometryLoader","text","typedArray","MaterialLoader","uniforms","vertexShader","fragmentShader","sizeAttenuation","ObjectLoader","substring","lastIndexOf","setTexturePath","parseGeometries","images","parseImages","parseTextures","parseMaterials","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","depthSegments","CircleGeometry","segments","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","phiStart","phiLength","thetaStart","thetaLength","IcosahedronGeometry","detail","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","alphaMap","envMap","loadImage","getGeometry","getMaterial","Group","TextureLoader","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","texDatas","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","alphaTest","overdraw","_needsUpdate","setValues","values","newValue","currentValue","Number","MeshLambertMaterial","MeshDepthMaterial","SpriteMaterial","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","combine","reflectivity","refractionRatio","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","wrapAround","wrapRGB","metal","ParticleBasicMaterial","ParticleSystemMaterial","defines","lights","defaultAttributeValues","uv2","index0AttributeName","UniformsUtils","RawShaderMaterial","mapping","TextureIdCount","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","CubeTexture","VideoTexture","video","HAVE_ENOUGH_DATA","inverseMatrix","localThreshold","testPoint","rayPointDistance","intersectPoint","distanceToRay","oi","ol","pointCount","ParticleSystem","LineStrip","LinePieces","precisionSq","vStart","vEnd","interSegment","interRay","distSq","offsetIndex","nbVertices","updateMorphTargets","morphTargetBase","morphTargetForcedOrder","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","intersectionPoint","isFaceMaterial","objectMaterials","morphInfluences","tl","influence","targets","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","bone","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","rotq","scl","normalizeSkinWeights","skeleton","sw","MorphAnimMesh","mirroredLoop","lastKeyframe","currentKeyframe","directionBackwards","setFrameRange","startKeyframe","endKeyframe","setDirectionForward","setDirectionBackward","parseAnimations","firstAnimation","pattern","morph","match","setAnimationLabel","playAnimation","updateAnimation","frameTime","keyframe","mix","interpolateTargets","influences","addLevel","getObjectForDistance","matrixPosition","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","diffuse","offsetRepeat","flipEnvMap","bump","normalmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLightDirection","directionalLightColor","hemisphereLightDirection","hemisphereLightSkyColor","hemisphereLightGroundColor","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDirection","spotLightDistance","spotLightAngleCos","spotLightExponent","spotLightDecay","psColor","shadowmap","ShaderLib","basic","lambert","phong","particle_basic","dashed","totalSize","mNear","mFar","cube","tCube","tFlip","equirect","tEquirect","depthRGBA","createParticleBuffers","__webglVertexBuffer","_gl","__webglColorBuffer","info","createLineBuffers","__webglLineDistanceBuffer","createMeshBuffers","geometryGroup","__webglNormalBuffer","__webglTangentBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","numMorphTargets","__webglMorphTargetsBuffers","numMorphNormals","__webglMorphNormalsBuffers","initCustomAttributes","nvertices","__webglCustomAttributesList","__webglInitialized","createUniqueBuffers","belongsToAttribute","initParticleBuffers","__vertexArray","__colorArray","__webglParticleCount","initLineBuffers","__lineDistanceArray","__webglLineCount","initMeshBuffers","faces3","ntris","nlines","getBufferMaterial","__normalArray","__uvArray","__uv2Array","__tangentArray","__skinIndexArray","__skinWeightArray","UintArray","extensions","Uint32Array","__typeArray","__faceArray","__lineArray","__morphTargetsArrays","__morphNormalsArrays","__webglFaceCount","originalAttribute","property","__original","__inittedArrays","materialNeedsFaceNormals","setParticleBuffers","hint","ca","cal","customAttribute","vertexArray","colorArray","dirtyVertices","dirtyColors","customAttributes","bindBuffer","ARRAY_BUFFER","bufferData","boundTo","setLineBuffers","dl","lineDistanceArray","dirtyLineDistances","setMeshBuffers","faceColor","n1","n3","sw1","sw2","sw3","si1","si2","si3","vn","uvi","uv2i","vk","vkl","vka","nka","chf","needsFaceNormals","offset_uv","offset_uv2","offset_face","offset_normal","offset_tangent","offset_line","offset_color","offset_skin","offset_morphTarget","offset_custom","uvArray","uv2Array","normalArray","tangentArray","skinIndexArray","skinWeightArray","morphTargetsArrays","morphNormalsArrays","faceArray","lineArray","dirtyElements","dirtyUvs","dirtyNormals","dirtyTangents","dirtyMorphTargets","morphTargetsNeedUpdate","chunk_faces3","obj_faces","obj_uvs","obj_uvs2","obj_skinIndices","obj_skinWeights","ELEMENT_ARRAY_BUFFER","pp","setupVertexAttributes","program","startIndex","geometryAttributes","programAttributes","programAttributesKeys","programAttribute","geometryAttribute","enableAttribute","vertexAttribPointer","FLOAT","vertexAttrib2fv","vertexAttrib3fv","disableUnusedAttributes","setupMorphTargets","numSupportedMorphTargets","__webglMorphTargetInfluences","activeInfluenceIndices","numericalSort","numSupportedMorphNormals","influenceIndex","uniform1fv","painterSortStable","reversePainterSortStable","projectObject","initObject","sprites","webglObjects","_webglObjects","_frustum","webglObject","unrollBufferMaterial","sortObjects","_vector3","_projScreenMatrix","renderObjects","renderList","setupMatrices","setMaterial","setMaterialFaces","renderBufferDirect","renderBuffer","renderObjectsImmediate","materialType","renderImmediateObject","unrollImmediateBufferMaterial","globject","opaque","transparentObjects","opaqueObjects","__webglInit","_modelViewMatrix","_normalMatrix","onObjectRemoved","onGeometryDispose","initGeometryGroups","__webglActive","addBuffer","geometryGroupsList","geometryGroups","ImmediateRenderObject","immediateRenderCallback","addBufferImmediate","_webglObjectsImmediate","makeGroups","usesFaceMaterial","groupHash","group","maxVerticesInGroup","hash_map","groups","groupsList","counter","geometryGroupCounter","addBuffers","objlist","updateObject","bufferType","DYNAMIC_DRAW","STATIC_DRAW","bufferSubData","BYTES_PER_ELEMENT","subarray","customAttributesDirty","areCustomAttributesDirty","clearCustomAttributes","removeObject","removeInstances","initMaterial","onMaterialDispose","shaderID","shaderIDs","shader","__webglShader","maxLightCount","allocateLights","maxShadows","allocateShadows","maxBones","allocateBones","_precision","supportsVertexTextures","_supportsVertexTextures","envMapMode","useFog","fogExp","flatShading","logarithmicDepthBuffer","_logarithmicDepthBuffer","_supportsBoneTextures","maxMorphTargets","maxMorphNormals","maxDirLights","directional","maxPointLights","maxSpotLights","spot","maxHemiLights","hemi","shadowMapEnabled","shadowMapType","shadowMapDebug","shadowMapCascade","pl","_programs","programInfo","usedTimes","WebGLProgram","programs","uniformsList","location","setBlending","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","setProgram","_usedTextureUnits","deallocateMaterial","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","_currentProgram","useProgram","_currentMaterialId","_currentCamera","uniformMatrix4fv","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","_lightsNeedUpdate","setupLights","refreshUniformsLights","_lights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","refreshUniformsLambert","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","uvScaleMap","_canvas","ambient","distances","decays","directions","anglesCos","exponents","skyColors","groundColors","modelViewMatrix","uniformMatrix3fv","_maxTextures","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform2fv","uniform3fv","uniform4fv","_array","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","_direction","setTextureParameters","textureType","isImagePowerOfTwo","extension","texParameteri","TEXTURE_WRAP_S","paramThreeToGL","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","clampToMaxSize","maxSize","slot","__webglTextureCube","onTextureDispose","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_CUBE_MAP","pixelStorei","UNPACK_FLIP_Y_WEBGL","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","_maxCubemapSize","glFormat","glType","mipmap","getCompressedTextureFormats","compressedTexImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","texImage2D","generateMipmap","__webglTexture","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","updateRenderTargetMipmap","TEXTURE_2D","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","nVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","nVertexMatrices","dirLights","pointLights","spotLights","hemiLights","_context","pixelRatio","_alpha","_depth","_stencil","stencil","_antialias","_premultipliedAlpha","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_clearColor","_clearAlpha","autoClear","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","shadowMapCullFace","calls","_currentFramebuffer","_currentGeometryProgram","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_currentWidth","_currentHeight","resetGLState","setDefaultGLState","WebGLState","getShaderPrecisionFormat","rangeMin","rangeMax","WebGLExtensions","glClearColor","clearColor","clearDepth","clearStencil","enable","DEPTH_TEST","depthFunc","LEQUAL","frontFace","CCW","cullFace","BACK","CULL_FACE","BLEND","blendFunc","viewport","reset","MAX_TEXTURE_IMAGE_UNITS","_maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","_maxTextureSize","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","_vertexShaderPrecisionHighpFloat","VERTEX_SHADER","HIGH_FLOAT","_vertexShaderPrecisionMediumpFloat","MEDIUM_FLOAT","_fragmentShaderPrecisionHighpFloat","FRAGMENT_SHADER","_fragmentShaderPrecisionMediumpFloat","formats","COMPRESSED_TEXTURE_FORMATS","highpAvailable","mediumpAvailable","shadowMapPlugin","ShadowMapPlugin","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","forceContextLoss","loseContext","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","updateStyle","setViewport","setScissor","scissor","enableScissorTest","SCISSOR_TEST","disable","getClearColor","getClearAlpha","setClearAlpha","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearTarget","setRenderTarget","deallocateGeometry","deallocateTexture","onRenderTargetDispose","deallocateRenderTarget","deleteBuffers","buffers","deleteBuffer","deleteTexture","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","deleteProgram","newPrograms","renderBufferImmediate","initAttributes","hasPositions","hasNormals","hasUvs","__webglUvBuffer","hasColors","positionArray","nx","ny","nz","nax","nbx","ncx","nay","nby","ncy","naz","nbz","ncz","drawArrays","TRIANGLES","updateBuffers","wireframeBit","geometryProgram","LINES","drawElements","POINTS","LINE_STRIP","setLineWidth","skinIndex","skinWeight","lineDistance","forceClear","setFaceCulling","frontFaceDirection","CW","FRONT","FRONT_AND_BACK","setDoubleSided","setFlipSided","uploadTexture","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","isCube","isTargetPowerOfTwo","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","WebGLRenderTarget","restore","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","addPrePlugin","addPostPlugin","updateShadowMap","gl","getExtension","programIdCount","generateDefines","chunk","cacheUniformLocations","identifiers","getUniformLocation","cacheAttributeLocations","getAttribLocation","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefix_vertex","prefix_fragment","gammaFactorDefine","customDefines","createProgram","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLogInfo","getProgramInfoLog","getProgramParameter","LINK_STATUS","getError","VALIDATE_STATUS","deleteShader","addLineNumbers","string","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","newAttributes","enabledAttributes","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthTest","currentDepthWrite","currentColorWrite","currentDoubleSided","currentFlipSided","currentLineWidth","currentPolygonOffset","currentPolygonOffsetFactor","currentPolygonOffsetUnits","enableVertexAttribArray","disableVertexAttribArray","blendEquationSeparate","blendFuncSeparate","depthMask","colorMask","polygonoffset","units","POLYGON_OFFSET_FILL","flares","prefix","vertexBuffer","elementBuffer","hasVertexTexture","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","_renderer","_renderList","createVirtualLight","cascade","virtualLight","isVirtual","pointsWorld","pointsFrustum","nearZ","farZ","updateVirtualLight","updateShadowCamera","_min","_max","getObjectMaterial","_depthMaterial","_depthMaterialMorph","_depthMaterialSkin","_depthMaterialMorphSkin","_matrixPosition","depthShader","depthUniforms","originalCamera","gyro","shadowFilter","pars","cameraHelper","CameraHelper","objectMaterial","useMorphing","useSkinning","customDepthMaterial","clearAlpha","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","oldFogType","sceneFogType","GeometryUtils","geometry1","geometry2","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","getNormalMap","subtract","imageData","createImageData","ly","uy","lx","ux","num_points","generateDataTexture","SceneUtils","createMultiMaterialObject","detach","attach","FontUtils","divisions","getFace","loadFace","family","familyName","ThreeFont","cssFontWeight","cssFontStyle","drawText","resolution","fontPaths","Path","ret","extractGlyphPoints","paths","outline","action","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","pts","glyph","glyphs","_cachedOutline","quadraticCurveTo","Shape","bezierCurveTo","ha","generateShapes","curveSegments","font","shapes","toShapes","namespace","EPSILON","process","contour","verts","vertIndices","nv","snip","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cCROSSap","bCROSScp","aCROSSbp","Triangulate","_typeface_js","typeface_js","onended","onEnded","isPlaying","setLoop","setRefDistance","refDistance","setRolloffFactor","rolloffFactor","AudioListener","positionPrev","Curve","getPointAt","getUtoTmapping","getPoints","getSpacedPoints","lengths","getLengths","cacheArcLengths","current","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","getPointFunc","CurvePath","curves","bends","autoClose","curve","checkConnection","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","maxX","maxY","maxZ","minX","minY","minZ","NEGATIVE_INFINITY","POSITIVE_INFINITY","createPointsGeometry","createGeometry","createSpacedPointsGeometry","addWrapPath","bendpath","getTransformedPoints","oldPts","getWrapPoints","getTransformedSpacedPoints","oldX","oldY","xNorm","bounds","pathPt","translationObject","quaternionObject","scaleObject","translationWorld","quaternionWorld","scaleWorld","actions","fromPoints","PathActions","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","BEZIER_CURVE_TO","CSPLINE_THRU","ARC","ELLIPSE","vectors","vlen","args","lastargs","x0","y0","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","EllipseCurve","lastPoint","closedPath","useSpacedPoints","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","isClockWise","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambigious","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","hole","tmpHoles","holes","extrude","extruded","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","getSpacedPointsHoles","extractAllPoints","shape","extractPoints","extractAllSpacedPoints","triangulateShape","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","nextIdx","intersection","intersectsHoleEdge","ihIdx","chkHole","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","h2","allPointsMap","allpoints","shapeWithoutHoles","b2p0","b2p1","b2p2","b3p0","b3p1","b3p2","b3p3","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","ClosedSplineCurve3","AnimationHandler","CATMULLROM","CATMULLROM_FORWARD","hierarchy","rot","usedMorphTargets","morphTargetName","morphTargetsInfluences","parseRecurseHierarchy","deltaTimeMS","resetBlendWeights","Animation","timeScale","interpolationType","keyTypes","animationCache","positionWeight","quaternionWeight","scaleWeight","prevKey","nextKey","originalMatrix","getNextKeyWith","newVector","newQuat","interpolateCatmullRom","prevXYZ","nextXYZ","proportionalWeight","getPrevKeyWith","currentPoint","forwardPoint","KeyFrameAnimation","isPaused","sids","sid","next","original","hasTarget","MorphAnimation","lastFrame","currentFrame","interpolation","buildPlane","udir","vdir","gridX","gridY","width_half","height_half","gridX1","gridY1","segment_width","segment_height","uvd","depth_half","centerUV","segment","CubeGeometry","heightHalf","verticesRow","uvsRow","tanTheta","v4","n4","uv1","uv3","uv4","addShapeList","addShape","scalePt2","pt","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","colinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","layer","flen","f3","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","extrudeMaterial","generateSideWallUV","extrudePts","splineTube","binormal","position2","bevelThickness","bevelSize","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","TubeGeometry","FrenetFrames","shapePoints","reverse","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","radiusStep","thetaSegment","TextGeometry","textShapes","getPos","in_q","in_p","cu","su","quOverP","cs","tz","grid","tang","bitan","ip","jp","closed","taper","NoTaper","numpoints","pos2","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","PolyhedronGeometry","prepare","that","azimuth","inclination","centroid","azi","correctUV","subdivide","cols","bj","DodecahedronGeometry","OctahedronGeometry","TetrahedronGeometry","ParametricGeometry","func","slices","stacks","sliceCount","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","thresholdAngle","thresholdDot","edge","sortFunction","numEdges","vert1","vert2","face1","face2","FaceNormalsHelper","objectVertices","objectFaces","objectWorldMatrix","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","worldMatrix","vertexId","VertexTangentsHelper","WireframeHelper","edges","numTris","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","active","autoCreateAnimations","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","Entity","Messanger","ObjectPool","QuadTree","Spatial","Vec2","Ai","_Components","_tags","TComponent","entityAddComponent","entityRemoveComponent","hasAllComponents","Components","tag","entityAddTag","removeTag","entityRemoveTag","removeEntity","messanger","_entities","_groups","_entityPool","_componentPools","componentPropertyName","Component","getName","charAt","groupKey","T","ENTITY_CREATED","ENTITY_REMOVE","COMPONENT_ADDED","COMPONENT_REMOVE","aquire","_trigger","removeEntitiesByTag","removeAllEntities","entityRemoveAllComponents","release","cName","cPool","component","groupName","Cs","loc","propName","_indexGroup","poolStats","used","totalUsed","pool","trigger","_events","fired","handled","Event","listenTo","eventName","option","fire","freeList","expand","__init","totalFree","hwidth","_absScale","_absPosition","_absHwidth","_node","COINCIDENT","attachTo","spatial","absPosition","assign","absRotation","rotate","pScale","absScale","absHwidth","magnitude","smult","magnitude2","angleBetween","pcopy","fromAngle","pfromAngle","rectIntersect","r1","r2","rectContains","sizeToHwidth","out__position","out__hwidth","level","maxEntities","maxLevels","insert","_getIndex","_splitAndRedistributeIfNeeded","queryArea","out__entities","overlapping","reIndex","_combine","tSize","tPos","validateEntity","hw","midX","midY","_split","_redistribute","_factory","_name","_callback","Comps","whereComponent","whereComponents","extends","mixin","getArguments","mixin_","Function","extends_","Child","Parent","Super","makeT","FUNCTION_NAME","FUNCTION_ARGS"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","global.Class = require('js-class');\r\nglobal.THREE = require('three');\r\nglobal.THREEx = require('./js/THREEx.KeyboardState.js');\r\nglobal.Physijs = require('physijs-browserify')(THREE);\r\nglobal.Stats = require('stats.js');\r\nglobal.Howler = require('howler');\r\n\r\nrequire('./RequestAnimationFrame.js');\r\nrequire('./rubbable.js');\r\nglobal.SuperGif = require('./libgif.js');\r\n\r\nglobal.Utils = require('./js/Utils.js');\r\n\r\nrequire('./js/Game.js');\r\nrequire('./js/Globals.js');\r\nrequire('./js/ResourceManager.js');\r\nrequire('./js/PointerLockControls.js');\r\nrequire('./js/EntityFactory.js');\r\nrequire('./js/Systems.js');\r\nrequire('./js/MouseController.js');\r\nrequire('./js/SoundController.js');\r\n\r\nPhysijs.scripts.worker = './libs/physijsWorker.js';\r\nPhysijs.scripts.ammo = './ammo.js';\r\n\r\n// purpose: function as a basic FPS game using an ECS (entity-component system) pattern\r\n//\r\n// requires: RequestAnimationFrame.js, three.js, three-pointerlockcontrols.js, stats.js, js-class.js, physijs, tiny-ecs\r\n//           Game.js, ResourceManager.js\r\n//\r\n// author: Cornell Daly\r\n//\r\n// date: November 3, 2015\r\n//\r\n// additional notes: code is separated into multiple files\r\n\r\nvar game = null;\r\n\r\nfunction init() {\r\n  Globals.instance.hudLeftElement = document.getElementById(\"hudLeft\");\r\n  Globals.instance.hudRightElement = document.getElementById(\"hudRight\");\r\n\r\n  Globals.instance.healthElement = document.getElementById(\"health\");\r\n  Globals.instance.ammoElement = document.getElementById(\"ammo\");\r\n  Globals.instance.scoreElement = document.getElementById(\"score\");\r\n\r\n  Globals.instance.reloadingElement = document.getElementById(\"reloading\");\r\n  Globals.instance.reloadImg = new SuperGif({\r\n    gif: document.getElementById(\"reloadImg\")\r\n  });\r\n  Globals.instance.reloadImg.load();\r\n\r\n  Globals.instance.overlayElement = document.getElementById(\"overlay\");\r\n\r\n  var gameOptions = {\r\n    container: document.getElementById(\"container\"),\r\n    loadingContainer: document.getElementById(\"loadingContainer\"),\r\n    blocker: document.getElementById(\"blocker\"),\r\n    instructions: document.getElementById(\"instructions\"),\r\n    modelsToPreload: [\r\n      \"models/potato.json\",\r\n      \"models/potatoCannon.json\",\r\n      \"models/character.json\",\r\n      \"models/fry.json\"\r\n    ],\r\n    soundsToPreload: [\r\n      \"sfx/arrowlessBow.mp3\",\r\n      \"sfx/hitSplat.wav\",\r\n      \"sfx/hurt1.mp3\",\r\n      \"sfx/hurt2.mp3\",\r\n      \"sfx/hurt3.mp3\"\r\n    ],\r\n    texturesToPreload: [\r\n      'gfx/brick-floor-tileable_COLOR.jpg',\r\n      'gfx/brick-floor-tileable_DISP.jpg',\r\n      'gfx/brick-floor-tileable_SPEC.jpg',\r\n      'gfx/smoketex.jpg'\r\n    ]\r\n  };\r\n  game = new Game(gameOptions);\r\n\r\n  game.start();\r\n}\r\n\r\ninit();\r\n\r\n","/**\n * Provides requestAnimationFrame in a cross browser way.\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\n\nif ( !window.requestAnimationFrame ) {\n\n\twindow.requestAnimationFrame = ( function() {\n\n\t\treturn window.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\twindow.oRequestAnimationFrame ||\n\t\twindow.msRequestAnimationFrame ||\n\t\tfunction( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {\n\n\t\t\twindow.setTimeout( callback, 1000 / 60 );\n\n\t\t};\n\n\t} )();\n\n}\n","/*\n\tRubbableGif\n\n\tExample usage:\n\n\t\t<img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n\t\t<script type=\"text/javascript\">\n\t\t\t$$('img').each(function (img_tag) {\n\t\t\t\tif (/.*\\.gif/.test(img_tag.src)) {\n\t\t\t\t\tvar rub = new RubbableGif({ gif: img_tag } );\n\t\t\t\t\trub.load();\n\t\t\t\t}\n\t\t\t});\n\t\t</script>\n\n\tImage tag attributes:\n\n\t\trel:animated_src -\tIf this url is specified, it's loaded into the player instead of src.\n\t\t\t\t\t\t\tThis allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n\t\trel:auto_play -\t\tDefaults to 1 if not specified. If set to zero, the gif will be rubbable but will not \n\t\t\t\t\t\t\tanimate unless the user is rubbing it.\n\n\tConstructor options args\n\n\t\tgif \t\t\t\tRequired. The DOM element of an img tag.\n\t\tauto_play \t\t\tOptional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n\t\tmax_width\t\t\tOptional. Scale images over max_width down to max_width. Helpful with mobile.\n\n\tInstance methods\n\n\t\t// loading\n\t\tload( callback )\tLoads the gif into a canvas element and then calls callback if one is passed\n\n\t\t// play controls\n\t\tplay -\t\t\t\tStart playing the gif\n\t\tpause -\t\t\t\tStop playing the gif\n\t\tmove_to(i) -\t\tMove to frame i of the gif\n\t\tmove_relative(i) -\tMove i frames ahead (or behind if i < 0)\n\n\t\t// getters\n\t\tget_canvas\t\t\tThe canvas element that the gif is playing in.\n\t\tget_playing\t\t\tWhether or not the gif is currently playing\n\t\tget_loading\t\t\tWhether or not the gif has finished loading/parsing\n\t\tget_auto_play\t\tWhether or not the gif is set to play automatically\n\t\tget_length\t\t\tThe number of frames in the gif\n\t\tget_current_frame\tThe index of the currently displayed frame of the gif\n\n\t\tFor additional customization (viewport inside iframe) these params may be passed:\n\t\tc_w, c_h - width and height of canvas\n\t\tvp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n*/\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(['./libgif'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('./libgif'));\n    } else {\n        root.RubbableGif = factory(root.SuperGif);\n    }\n}(this, function (SuperGif) {\n    var RubbableGif = function( options ) {\n        var sup = new SuperGif( options );\n\n        var register_canvas_handers = function () {\n\n            var isvp = function(x) {\n                return (options.vp_l ? ( x - options.vp_l ) : x );\n            }\n\n            var canvas = sup.get_canvas();\n            var maxTime = 1000,\n            // allow movement if < 1000 ms (1 sec)\n                w = ( options.vp_w ? options.vp_w : canvas.width ),\n                maxDistance = Math.floor(w / (sup.get_length() * 2)),\n            // swipe movement of 50 pixels triggers the swipe\n                startX = 0,\n                startTime = 0;\n\n            var cantouch = \"ontouchend\" in document;\n\n            var aj = 0;\n            var last_played = 0;\n\n            canvas.addEventListener((cantouch) ? 'touchstart' : 'mousedown', function (e) {\n                // prevent image drag (Firefox)\n                e.preventDefault();\n                if (sup.get_auto_play()) sup.pause();\n\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var x = (pos.layerX > 0) ? isvp(pos.layerX) : w / 2;\n                var progress = x / w;\n\n                sup.move_to( Math.floor(progress * (sup.get_length() - 1)) );\n\n                startTime = e.timeStamp;\n                startX = isvp(pos.pageX);\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchend' : 'mouseup', function (e) {\n                startTime = 0;\n                startX = 0;\n                if (sup.get_auto_play()) sup.play();\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchmove' : 'mousemove', function (e) {\n                e.preventDefault();\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var currentX = isvp(pos.pageX);\n                currentDistance = (startX === 0) ? 0 : Math.abs(currentX - startX);\n                // allow if movement < 1 sec\n                currentTime = e.timeStamp;\n                if (startTime !== 0 && currentDistance > maxDistance) {\n                    if (currentX < startX && sup.get_current_frame() > 0) {\n                        sup.move_relative(-1);\n                    }\n                    if (currentX > startX && sup.get_current_frame() < sup.get_length() - 1) {\n                        sup.move_relative(1);\n                    }\n                    startTime = e.timeStamp;\n                    startX = isvp(pos.pageX);\n                }\n\n                var time_since_last_play = e.timeStamp - last_played;\n                {\n                    aj++;\n                    if (document.getElementById('tickles' + ((aj % 5) + 1))) document.getElementById('tickles' + ((aj % 5) + 1)).play();\n                    last_played = e.timeStamp;\n                }\n\n\n            });\n        };\n\n        sup.orig_load = sup.load;\n        sup.load = function(callback) {\n            sup.orig_load( function() {\n                if (callback) callback();\n                register_canvas_handers( sup );\n            } );\n        }\n\n        return sup;\n    }\n\n    return RubbableGif;\n}));","/*\n    SuperGif\n\n    Example usage:\n\n        <img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n        <script type=\"text/javascript\">\n            $$('img').each(function (img_tag) {\n                if (/.*\\.gif/.test(img_tag.src)) {\n                    var rub = new SuperGif({ gif: img_tag } );\n                    rub.load();\n                }\n            });\n        </script>\n\n    Image tag attributes:\n\n        rel:animated_src -  If this url is specified, it's loaded into the player instead of src.\n                            This allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n        rel:auto_play -     Defaults to 1 if not specified. If set to zero, a call to the play() method is needed\n\n    Constructor options args\n\n        gif                 Required. The DOM element of an img tag.\n        loop_mode           Optional. Setting this to false will force disable looping of the gif.\n        auto_play           Optional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n        max_width           Optional. Scale images over max_width down to max_width. Helpful with mobile.\n        on_end              Optional. Add a callback for when the gif reaches the end of a single loop (one iteration). The first argument passed will be the gif HTMLElement.\n        loop_delay          Optional. The amount of time to pause (in ms) after each single loop (iteration).\n        draw_while_loading  Optional. Determines whether the gif will be drawn to the canvas whilst it is loaded.\n        show_progress_bar   Optional. Only applies when draw_while_loading is set to true.\n\n    Instance methods\n\n        // loading\n        load( callback )        Loads the gif specified by the src or rel:animated_src sttributie of the img tag into a canvas element and then calls callback if one is passed\n        load_url( src, callback )   Loads the gif file specified in the src argument into a canvas element and then calls callback if one is passed\n\n        // play controls\n        play -              Start playing the gif\n        pause -             Stop playing the gif\n        move_to(i) -        Move to frame i of the gif\n        move_relative(i) -  Move i frames ahead (or behind if i < 0)\n\n        // getters\n        get_canvas          The canvas element that the gif is playing in. Handy for assigning event handlers to.\n        get_playing         Whether or not the gif is currently playing\n        get_loading         Whether or not the gif has finished loading/parsing\n        get_auto_play       Whether or not the gif is set to play automatically\n        get_length          The number of frames in the gif\n        get_current_frame   The index of the currently displayed frame of the gif\n\n        For additional customization (viewport inside iframe) these params may be passed:\n        c_w, c_h - width and height of canvas\n        vp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n        A bonus: few articles to understand what is going on\n            http://enthusiasms.org/post/16976438906\n            http://www.matthewflickinger.com/lab/whatsinagif/bits_and_bytes.asp\n            http://humpy77.deviantart.com/journal/Frame-Delay-Times-for-Animated-GIFs-214150546\n\n*/\n\n// Generic functions\nvar bitsToNum = function(ba) {\n  return ba.reduce(function(s, n) {\n    return s * 2 + n;\n  }, 0);\n};\n\nvar byteToBitArr = function(bite) {\n  var a = [];\n  for (var i = 7; i >= 0; i--) {\n    a.push(!!(bite & (1 << i)));\n  }\n  return a;\n};\n\n// Stream\n/**\n * @constructor\n */\n// Make compiler happy.\nvar Stream = function(data) {\n  this.data = data;\n  this.len = this.data.length;\n  this.pos = 0;\n\n  this.readByte = function() {\n    if (this.pos >= this.data.length) {\n      throw new Error('Attempted to read past end of stream.');\n    }\n    if (data instanceof Uint8Array)\n      return data[this.pos++];\n    else\n      return data.charCodeAt(this.pos++) & 0xFF;\n  };\n\n  this.readBytes = function(n) {\n    var bytes = [];\n    for (var i = 0; i < n; i++) {\n      bytes.push(this.readByte());\n    }\n    return bytes;\n  };\n\n  this.read = function(n) {\n    var s = '';\n    for (var i = 0; i < n; i++) {\n      s += String.fromCharCode(this.readByte());\n    }\n    return s;\n  };\n\n  this.readUnsigned = function() { // Little-endian.\n    var a = this.readBytes(2);\n    return (a[1] << 8) + a[0];\n  };\n};\n\nvar lzwDecode = function(minCodeSize, data) {\n  // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\n  var pos = 0; // Maybe this streaming thing should be merged with the Stream?\n  var readCode = function(size) {\n    var code = 0;\n    for (var i = 0; i < size; i++) {\n      if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\n        code |= 1 << i;\n      }\n      pos++;\n    }\n    return code;\n  };\n\n  var output = [];\n\n  var clearCode = 1 << minCodeSize;\n  var eoiCode = clearCode + 1;\n\n  var codeSize = minCodeSize + 1;\n\n  var dict = [];\n\n  var clear = function() {\n    dict = [];\n    codeSize = minCodeSize + 1;\n    for (var i = 0; i < clearCode; i++) {\n      dict[i] = [i];\n    }\n    dict[clearCode] = [];\n    dict[eoiCode] = null;\n\n  };\n\n  var code;\n  var last;\n\n  while (true) {\n    last = code;\n    code = readCode(codeSize);\n\n    if (code === clearCode) {\n      clear();\n      continue;\n    }\n    if (code === eoiCode) break;\n\n    if (code < dict.length) {\n      if (last !== clearCode) {\n        dict.push(dict[last].concat(dict[code][0]));\n      }\n    }\n    else {\n      if (code !== dict.length) throw new Error('Invalid LZW code.');\n      dict.push(dict[last].concat(dict[last][0]));\n    }\n    output.push.apply(output, dict[code]);\n\n    if (dict.length === (1 << codeSize) && codeSize < 12) {\n      // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\n      codeSize++;\n    }\n  }\n\n  // I don't know if this is technically an error, but some GIFs do it.\n  //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\n  return output;\n};\n\n\n// The actual parsing; returns an object with properties.\nvar parseGIF = function(st, handler) {\n  handler || (handler = {});\n\n  // LZW (GIF-specific)\n  var parseCT = function(entries) { // Each entry is 3 bytes, for RGB.\n    var ct = [];\n    for (var i = 0; i < entries; i++) {\n      ct.push(st.readBytes(3));\n    }\n    return ct;\n  };\n\n  var readSubBlocks = function() {\n    var size, data;\n    data = '';\n    do {\n      size = st.readByte();\n      data += st.read(size);\n    } while (size !== 0);\n    return data;\n  };\n\n  var parseHeader = function() {\n    var hdr = {};\n    hdr.sig = st.read(3);\n    hdr.ver = st.read(3);\n    if (hdr.sig !== 'GIF') throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\n    hdr.width = st.readUnsigned();\n    hdr.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    hdr.gctFlag = bits.shift();\n    hdr.colorRes = bitsToNum(bits.splice(0, 3));\n    hdr.sorted = bits.shift();\n    hdr.gctSize = bitsToNum(bits.splice(0, 3));\n\n    hdr.bgColor = st.readByte();\n    hdr.pixelAspectRatio = st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n    if (hdr.gctFlag) {\n      hdr.gct = parseCT(1 << (hdr.gctSize + 1));\n    }\n    handler.hdr && handler.hdr(hdr);\n  };\n\n  var parseExt = function(block) {\n    var parseGCExt = function(block) {\n      var blockSize = st.readByte(); // Always 4\n      var bits = byteToBitArr(st.readByte());\n      block.reserved = bits.splice(0, 3); // Reserved; should be 000.\n      block.disposalMethod = bitsToNum(bits.splice(0, 3));\n      block.userInput = bits.shift();\n      block.transparencyGiven = bits.shift();\n\n      block.delayTime = st.readUnsigned();\n\n      block.transparencyIndex = st.readByte();\n\n      block.terminator = st.readByte();\n\n      handler.gce && handler.gce(block);\n    };\n\n    var parseComExt = function(block) {\n      block.comment = readSubBlocks();\n      handler.com && handler.com(block);\n    };\n\n    var parsePTExt = function(block) {\n      // No one *ever* uses this. If you use it, deal with parsing it yourself.\n      var blockSize = st.readByte(); // Always 12\n      block.ptHeader = st.readBytes(12);\n      block.ptData = readSubBlocks();\n      handler.pte && handler.pte(block);\n    };\n\n    var parseAppExt = function(block) {\n      var parseNetscapeExt = function(block) {\n        var blockSize = st.readByte(); // Always 3\n        block.unknown = st.readByte(); // ??? Always 1? What is this?\n        block.iterations = st.readUnsigned();\n        block.terminator = st.readByte();\n        handler.app && handler.app.NETSCAPE && handler.app.NETSCAPE(block);\n      };\n\n      var parseUnknownAppExt = function(block) {\n        block.appData = readSubBlocks();\n        // FIXME: This won't work if a handler wants to match on any identifier.\n        handler.app && handler.app[block.identifier] && handler.app[block.identifier](block);\n      };\n\n      var blockSize = st.readByte(); // Always 11\n      block.identifier = st.read(8);\n      block.authCode = st.read(3);\n      switch (block.identifier) {\n        case 'NETSCAPE':\n          parseNetscapeExt(block);\n          break;\n        default:\n          parseUnknownAppExt(block);\n          break;\n      }\n    };\n\n    var parseUnknownExt = function(block) {\n      block.data = readSubBlocks();\n      handler.unknown && handler.unknown(block);\n    };\n\n    block.label = st.readByte();\n    switch (block.label) {\n      case 0xF9:\n        block.extType = 'gce';\n        parseGCExt(block);\n        break;\n      case 0xFE:\n        block.extType = 'com';\n        parseComExt(block);\n        break;\n      case 0x01:\n        block.extType = 'pte';\n        parsePTExt(block);\n        break;\n      case 0xFF:\n        block.extType = 'app';\n        parseAppExt(block);\n        break;\n      default:\n        block.extType = 'unknown';\n        parseUnknownExt(block);\n        break;\n    }\n  };\n\n  var parseImg = function(img) {\n    var deinterlace = function(pixels, width) {\n      // Of course this defeats the purpose of interlacing. And it's *probably*\n      // the least efficient way it's ever been implemented. But nevertheless...\n      var newPixels = new Array(pixels.length);\n      var rows = pixels.length / width;\n      var cpRow = function(toRow, fromRow) {\n        var fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n        newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n      };\n\n      // See appendix E.\n      var offsets = [0, 4, 2, 1];\n      var steps = [8, 8, 4, 2];\n\n      var fromRow = 0;\n      for (var pass = 0; pass < 4; pass++) {\n        for (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n          cpRow(toRow, fromRow)\n          fromRow++;\n        }\n      }\n\n      return newPixels;\n    };\n\n    img.leftPos = st.readUnsigned();\n    img.topPos = st.readUnsigned();\n    img.width = st.readUnsigned();\n    img.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    img.lctFlag = bits.shift();\n    img.interlaced = bits.shift();\n    img.sorted = bits.shift();\n    img.reserved = bits.splice(0, 2);\n    img.lctSize = bitsToNum(bits.splice(0, 3));\n\n    if (img.lctFlag) {\n      img.lct = parseCT(1 << (img.lctSize + 1));\n    }\n\n    img.lzwMinCodeSize = st.readByte();\n\n    var lzwData = readSubBlocks();\n\n    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\n\n    if (img.interlaced) { // Move\n      img.pixels = deinterlace(img.pixels, img.width);\n    }\n\n    handler.img && handler.img(img);\n  };\n\n  var parseBlock = function() {\n    var block = {};\n    block.sentinel = st.readByte();\n\n    switch (String.fromCharCode(block.sentinel)) { // For ease of matching\n      case '!':\n        block.type = 'ext';\n        parseExt(block);\n        break;\n      case ',':\n        block.type = 'img';\n        parseImg(block);\n        break;\n      case ';':\n        block.type = 'eof';\n        handler.eof && handler.eof(block);\n        break;\n      default:\n        throw new Error('Unknown block: 0x' + block.sentinel.toString(16)); // TODO: Pad this with a 0.\n    }\n\n    if (block.type !== 'eof') setTimeout(parseBlock, 0);\n  };\n\n  var parse = function() {\n    parseHeader();\n    setTimeout(parseBlock, 0);\n  };\n\n  parse();\n};\n\nvar SuperGif = function(opts) {\n  var options = {\n    //viewport position\n    vp_l: 0,\n    vp_t: 0,\n    vp_w: null,\n    vp_h: null,\n    //canvas sizes\n    c_w: null,\n    c_h: null\n  };\n  for (var i in opts) {\n    options[i] = opts[i]\n  }\n  if (options.vp_w && options.vp_h) options.is_vp = true;\n\n  var stream;\n  var hdr;\n\n  var loadError = null;\n  var loading = false;\n\n  var transparency = null;\n  var delay = null;\n  var disposalMethod = null;\n  var disposalRestoreFromIdx = 0;\n  var lastDisposalMethod = null;\n  var frame = null;\n  var lastImg = null;\n\n  var playing = true;\n  var forward = true;\n\n  var ctx_scaled = false;\n\n  var frames = [];\n  var frameOffsets = []; // elements have .x and .y properties\n\n  var gif = options.gif;\n  if (typeof options.auto_play == 'undefined')\n    options.auto_play = (!gif.getAttribute('rel:auto_play') || gif.getAttribute('rel:auto_play') == '1');\n\n  var onEndListener = (options.hasOwnProperty('on_end') ? options.on_end : null);\n  var loopDelay = (options.hasOwnProperty('loop_delay') ? options.loop_delay : 0);\n  var overrideLoopMode = (options.hasOwnProperty('loop_mode') ? options.loop_mode : 'auto');\n  var drawWhileLoading = (options.hasOwnProperty('draw_while_loading') ? options.draw_while_loading : true);\n  var showProgressBar = drawWhileLoading ? (options.hasOwnProperty('show_progress_bar') ? options.show_progress_bar : true) : false;\n\n  var clear = function() {\n    transparency = null;\n    delay = null;\n    lastDisposalMethod = disposalMethod;\n    disposalMethod = null;\n    frame = null;\n  };\n\n  // XXX: There's probably a better way to handle catching exceptions when\n  // callbacks are involved.\n  var doParse = function() {\n    try {\n      parseGIF(stream, handler);\n    }\n    catch (err) {\n      doLoadError('parse');\n    }\n  };\n\n  var doText = function(text) {\n    toolbar.innerHTML = text; // innerText? Escaping? Whatever.\n    toolbar.style.visibility = 'visible';\n  };\n\n  var setSizes = function(w, h) {\n    canvas.width = w * get_canvas_scale();\n    canvas.height = h * get_canvas_scale();\n    toolbar.style.minWidth = (w * get_canvas_scale()) + 'px';\n\n    tmpCanvas.width = w;\n    tmpCanvas.height = h;\n    tmpCanvas.style.width = w + 'px';\n    tmpCanvas.style.height = h + 'px';\n    tmpCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n  };\n\n  var setFrameOffset = function(frame, offset) {\n    if (!frameOffsets[frame]) {\n      frameOffsets[frame] = offset;\n      return;\n    }\n    if (typeof offset.x !== 'undefined') {\n      frameOffsets[frame].x = offset.x;\n    }\n    if (typeof offset.y !== 'undefined') {\n      frameOffsets[frame].y = offset.y;\n    }\n  };\n\n  var doShowProgress = function(pos, length, draw) {\n    if (draw && showProgressBar) {\n      var height = 25;\n      var left, mid, top, width;\n      if (options.is_vp) {\n        if (!ctx_scaled) {\n          top = (options.vp_t + options.vp_h - height);\n          height = height;\n          left = options.vp_l;\n          mid = left + (pos / length) * options.vp_w;\n          width = canvas.width;\n        }\n        else {\n          top = (options.vp_t + options.vp_h - height) / get_canvas_scale();\n          height = height / get_canvas_scale();\n          left = (options.vp_l / get_canvas_scale());\n          mid = left + (pos / length) * (options.vp_w / get_canvas_scale());\n          width = canvas.width / get_canvas_scale();\n        }\n        //some debugging, draw rect around viewport\n        if (false) {\n          if (!ctx_scaled) {\n            var l = options.vp_l,\n              t = options.vp_t;\n            var w = options.vp_w,\n              h = options.vp_h;\n          }\n          else {\n            var l = options.vp_l / get_canvas_scale(),\n              t = options.vp_t / get_canvas_scale();\n            var w = options.vp_w / get_canvas_scale(),\n              h = options.vp_h / get_canvas_scale();\n          }\n          ctx.rect(l, t, w, h);\n          ctx.stroke();\n        }\n      }\n      else {\n        top = (canvas.height - height) / (ctx_scaled ? get_canvas_scale() : 1);\n        mid = ((pos / length) * canvas.width) / (ctx_scaled ? get_canvas_scale() : 1);\n        width = canvas.width / (ctx_scaled ? get_canvas_scale() : 1);\n        height /= ctx_scaled ? get_canvas_scale() : 1;\n      }\n      // XXX Figure out alpha fillRect.\n      //ctx.fillStyle = 'salmon';\n      ctx.fillStyle = 'rgba(255,255,255,0.4)';\n      ctx.fillRect(mid, top, width - mid, height);\n\n      //ctx.fillStyle = 'teal';\n      ctx.fillStyle = 'rgba(255,0,22,.8)';\n      ctx.fillRect(0, top, mid, height);\n    }\n  };\n\n  var doLoadError = function(originOfError) {\n    var drawError = function() {\n      ctx.fillStyle = 'black';\n      ctx.fillRect(0, 0, options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.strokeStyle = 'red';\n      ctx.lineWidth = 3;\n      ctx.moveTo(0, 0);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.moveTo(0, options.c_h ? options.c_h : hdr.height);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, 0);\n      ctx.stroke();\n    };\n\n    loadError = originOfError;\n    hdr = {\n      width: gif.width,\n      height: gif.height\n    }; // Fake header.\n    frames = [];\n    drawError();\n  };\n\n  var doHdr = function(_hdr) {\n    hdr = _hdr;\n    setSizes(hdr.width, hdr.height)\n  };\n\n  var doGCE = function(gce) {\n    pushFrame();\n    clear();\n    transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\n    delay = gce.delayTime;\n    disposalMethod = gce.disposalMethod;\n    // We don't have much to do with the rest of GCE.\n  };\n\n  var pushFrame = function() {\n    if (!frame) return;\n    frames.push({\n      data: frame.getImageData(0, 0, hdr.width, hdr.height),\n      delay: delay\n    });\n    frameOffsets.push({\n      x: 0,\n      y: 0\n    });\n  };\n\n  var doImg = function(img) {\n    if (!frame) frame = tmpCanvas.getContext('2d');\n\n    var currIdx = frames.length;\n\n    //ct = color table, gct = global color table\n    var ct = img.lctFlag ? img.lct : hdr.gct; // TODO: What if neither exists?\n\n    /*\n    Disposal method indicates the way in which the graphic is to\n    be treated after being displayed.\n\n    Values :    0 - No disposal specified. The decoder is\n                    not required to take any action.\n                1 - Do not dispose. The graphic is to be left\n                    in place.\n                2 - Restore to background color. The area used by the\n                    graphic must be restored to the background color.\n                3 - Restore to previous. The decoder is required to\n                    restore the area overwritten by the graphic with\n                    what was there prior to rendering the graphic.\n\n                    Importantly, \"previous\" means the frame state\n                    after the last disposal of method 0, 1, or 2.\n    */\n    if (currIdx > 0) {\n      if (lastDisposalMethod === 3) {\n        // Restore to previous\n        frame.putImageData(frames[disposalRestoreFromIdx].data, 0, 0);\n      }\n      else {\n        disposalRestoreFromIdx = currIdx - 1;\n      }\n\n      if (lastDisposalMethod === 2) {\n        // Restore to background color\n        // Browser implementations historically restore to transparent; we do the same.\n        // http://www.wizards-toolkit.org/discourse-server/viewtopic.php?f=1&t=21172#p86079\n        frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\n      }\n    }\n    // else, Undefined/Do not dispose.\n    // frame contains final pixel data from the last frame; do nothing\n\n    //Get existing pixels for img region after applying disposal method\n    var imgData = frame.getImageData(img.leftPos, img.topPos, img.width, img.height);\n\n    //apply color table colors\n    var cdd = imgData.data;\n    img.pixels.forEach(function(pixel, i) {\n      // imgData.data === [R,G,B,A,R,G,B,A,...]\n      if (pixel !== transparency) {\n        cdd[i * 4 + 0] = ct[pixel][0];\n        cdd[i * 4 + 1] = ct[pixel][1];\n        cdd[i * 4 + 2] = ct[pixel][2];\n        cdd[i * 4 + 3] = 255; // Opaque.\n      }\n    });\n    imgData.data.set(cdd);\n\n    frame.putImageData(imgData, img.leftPos, img.topPos);\n\n    if (!ctx_scaled) {\n      ctx.scale(get_canvas_scale(), get_canvas_scale());\n      ctx_scaled = true;\n    }\n\n    // We could use the on-page canvas directly, except that we draw a progress\n    // bar for each image chunk (not just the final image).\n    if (drawWhileLoading)\n      ctx.drawImage(tmpCanvas, 0, 0);\n\n    lastImg = img;\n  };\n\n  var player = (function() {\n    var i = -1;\n    var iterationCount = 0;\n\n    var showingInfo = false;\n    var pinned = false;\n\n    /**\n     * Gets the index of the frame \"up next\".\n     * @returns {number}\n     */\n    var getNextFrameNo = function() {\n      var delta = (forward ? 1 : -1);\n      return (i + delta + frames.length) % frames.length;\n    };\n\n    var stepFrame = function(amount) { // XXX: Name is confusing.\n      i = i + amount;\n\n      putFrame();\n    };\n\n    var completeLoop = function() {\n      if (onEndListener !== null)\n        onEndListener(gif);\n      iterationCount++;\n    };\n\n    var step = (function() {\n      var stepping = false;\n\n      var doStep = function() {\n        stepping = playing;\n        if (!stepping) return;\n\n        stepFrame(1);\n        var delay = frames[i].delay * 10;\n        if (!delay) delay = 100; // FIXME: Should this even default at all? What should it be?\n\n        var nextFrameNo = getNextFrameNo();\n        if (nextFrameNo === 0) {\n          delay += loopDelay;\n          setTimeout(completeLoop, delay - 1);\n        }\n\n        if ((overrideLoopMode !== false || nextFrameNo !== 0 || iterationCount < 0))\n          setTimeout(doStep, delay);\n\n      };\n\n      return function() {\n        if (!stepping) setTimeout(doStep, 0);\n      };\n    }());\n\n    var putFrame = function() {\n      var offset;\n      i = parseInt(i, 10);\n\n      if (i > frames.length - 1) {\n        i = 0;\n      }\n\n      if (i < 0) {\n        i = 0;\n      }\n\n      offset = frameOffsets[i];\n\n      tmpCanvas.getContext(\"2d\").putImageData(frames[i].data, offset.x, offset.y);\n      ctx.globalCompositeOperation = \"copy\";\n      ctx.drawImage(tmpCanvas, 0, 0);\n    };\n\n    var play = function() {\n      playing = true;\n      step();\n    };\n\n    var pause = function() {\n      playing = false;\n    };\n\n\n    return {\n      init: function() {\n        if (loadError) return;\n\n        if (!(options.c_w && options.c_h)) {\n          ctx.scale(get_canvas_scale(), get_canvas_scale());\n        }\n\n        if (options.auto_play) {\n          step();\n        }\n        else {\n          i = 0;\n          putFrame();\n        }\n      },\n      step: step,\n      play: play,\n      pause: pause,\n      playing: playing,\n      move_relative: stepFrame,\n      current_frame: function() {\n        return i;\n      },\n      length: function() {\n        return frames.length\n      },\n      move_to: function(frame_idx) {\n        i = frame_idx;\n        putFrame();\n      }\n    }\n  }());\n\n  var doDecodeProgress = function(draw) {\n    doShowProgress(stream.pos, stream.data.length, draw);\n  };\n\n  var doNothing = function() {};\n  /**\n   * @param{boolean=} draw Whether to draw progress bar or not; this is not idempotent because of translucency.\n   *                       Note that this means that the text will be unsynchronized with the progress bar on non-frames;\n   *                       but those are typically so small (GCE etc.) that it doesn't really matter. TODO: Do this properly.\n   */\n  var withProgress = function(fn, draw) {\n    return function(block) {\n      fn(block);\n      doDecodeProgress(draw);\n    };\n  };\n\n\n  var handler = {\n    hdr: withProgress(doHdr),\n    gce: withProgress(doGCE),\n    com: withProgress(doNothing),\n    // I guess that's all for now.\n    app: {\n      // TODO: Is there much point in actually supporting iterations?\n      NETSCAPE: withProgress(doNothing)\n    },\n    img: withProgress(doImg, true),\n    eof: function(block) {\n      //toolbar.style.display = '';\n      pushFrame();\n      doDecodeProgress(false);\n      if (!(options.c_w && options.c_h)) {\n        canvas.width = hdr.width * get_canvas_scale();\n        canvas.height = hdr.height * get_canvas_scale();\n      }\n      player.init();\n      loading = false;\n      if (load_callback) {\n        load_callback(gif);\n      }\n\n    }\n  };\n\n  var init = function() {\n    var parent = gif.parentNode;\n\n    var span = document.createElement('span');\n    canvas = document.createElement('canvas');\n    ctx = canvas.getContext('2d');\n    toolbar = document.createElement('div');\n\n    tmpCanvas = document.createElement('canvas');\n\n    span.width = canvas.width = gif.width;\n    span.height = canvas.height = gif.height;\n    toolbar.style.minWidth = gif.width + 'px';\n\n    span.className = 'jsgif';\n    toolbar.className = 'jsgif_toolbar';\n    span.appendChild(canvas);\n    span.appendChild(toolbar);\n\n    parent.insertBefore(span, gif);\n    parent.removeChild(gif);\n\n    if (options.c_w && options.c_h) setSizes(options.c_w, options.c_h);\n    initialized = true;\n  };\n\n  var get_canvas_scale = function() {\n    var scale;\n    if (options.max_width && hdr && hdr.width > options.max_width) {\n      scale = options.max_width / hdr.width;\n    }\n    else {\n      scale = 1;\n    }\n    return scale;\n  }\n\n  var canvas, ctx, toolbar, tmpCanvas;\n  var initialized = false;\n  var load_callback = false;\n\n  var load_setup = function(callback) {\n    if (loading) return false;\n    if (callback) load_callback = callback;\n    else load_callback = false;\n\n    loading = true;\n    frames = [];\n    clear();\n    disposalRestoreFromIdx = 0;\n    lastDisposalMethod = null;\n    frame = null;\n    lastImg = null;\n\n    return true;\n  }\n\n  return {\n    // play controls\n    play: player.play,\n    pause: player.pause,\n    move_relative: player.move_relative,\n    move_to: player.move_to,\n\n    // getters for instance vars\n    get_playing: function() {\n      return player.playing\n    },\n    get_canvas: function() {\n      return canvas\n    },\n    get_canvas_scale: function() {\n      return get_canvas_scale()\n    },\n    get_loading: function() {\n      return loading\n    },\n    get_auto_play: function() {\n      return options.auto_play\n    },\n    get_length: function() {\n      return player.length()\n    },\n    get_current_frame: function() {\n      return player.current_frame()\n    },\n    load_url: function(src, callback) {\n      if (!load_setup(callback)) return;\n\n      var h = new XMLHttpRequest();\n      h.overrideMimeType('text/plain; charset=x-user-defined');\n      h.onloadstart = function() {\n        // Wait until connection is opened to replace the gif element with a canvas to avoid a blank img\n        if (!initialized) init();\n      };\n      h.onload = function(e) {\n        stream = new Stream(h.responseText);\n        setTimeout(doParse, 0);\n      };\n      h.onprogress = function(e) {\n        if (e.lengthComputable) doShowProgress(e.loaded, e.total, true);\n      };\n      h.onerror = function() {\n        doLoadError('xhr');\n      };\n      h.open('GET', src, true);\n      h.send();\n    },\n    load: function(callback) {\n      this.load_url(gif.getAttribute('rel:animated_src') || gif.src, callback);\n    },\n    load_raw: function(arr, callback) {\n      if (!load_setup(callback)) return;\n      if (!initialized) init();\n      stream = new Stream(arr);\n      setTimeout(doParse, 0);\n    },\n    set_frame_offset: setFrameOffset\n  };\n};\n\nmodule.exports = SuperGif;\n\n","// THREEx.KeyboardState.js keep the current state of the keyboard.\r\n// It is possible to query it at any time. No need of an event.\r\n// This is particularly convenient in loop driven case, like in\r\n// 3D demos or games.\r\n//\r\n// # Usage\r\n//\r\n// **Step 1**: Create the object\r\n//\r\n// ```var keyboard  = new THREEx.KeyboardState();```\r\n//\r\n// **Step 2**: Query the keyboard state\r\n//\r\n// This will return true if shift and A are pressed, false otherwise\r\n//\r\n// ```keyboard.pressed(\"shift+A\")```\r\n//\r\n// **Step 3**: Stop listening to the keyboard\r\n//\r\n// ```keyboard.destroy()```\r\n//\r\n// NOTE: this library may be nice as standaline. independant from three.js\r\n// - rename it keyboardForGame\r\n//\r\n// # Code\r\n//\r\n\r\n/** @namespace */\r\nvar THREEx = THREEx || {};\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREEx;\r\n\r\n}\r\n\r\n/**\r\n * - NOTE: it would be quite easy to push event-driven too\r\n *   - microevent.js for events handling\r\n *   - in this._onkeyChange, generate a string from the DOM event\r\n *   - use this as event name\r\n */\r\nTHREEx.KeyboardState = function(domElement) {\r\n  this.domElement = domElement || document;\r\n  // to store the current state\r\n  this.keyCodes = {};\r\n  this.modifiers = {};\r\n\r\n  // create callback to bind/unbind keyboard events\r\n  var _this = this;\r\n  this._onKeyDown = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n  this._onKeyUp = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n\r\n  // bind keyEvents\r\n  this.domElement.addEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.addEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // create callback to bind/unbind window blur event\r\n  this._onBlur = function() {\r\n    for (var prop in _this.keyCodes) _this.keyCodes[prop] = false;\r\n    for (var prop in _this.modifiers) _this.modifiers[prop] = false;\r\n  };\r\n\r\n  // bind window blur\r\n  window.addEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\n/**\r\n * To stop listening of the keyboard events\r\n */\r\nTHREEx.KeyboardState.prototype.destroy = function() {\r\n  // unbind keyEvents\r\n  this.domElement.removeEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.removeEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // unbind window blur event\r\n  window.removeEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\nTHREEx.KeyboardState.MODIFIERS = ['shift', 'ctrl', 'alt', 'meta'];\r\nTHREEx.KeyboardState.ALIAS = {\r\n  'left': 37,\r\n  'up': 38,\r\n  'right': 39,\r\n  'down': 40,\r\n  'space': 32,\r\n  'pageup': 33,\r\n  'pagedown': 34,\r\n  'tab': 9,\r\n  'escape': 27\r\n};\r\n\r\n/**\r\n * to process the keyboard dom event\r\n */\r\nTHREEx.KeyboardState.prototype._onKeyChange = function(event) {\r\n  // log to debug\r\n  //console.log(\"onKeyChange\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n\r\n  // update this.keyCodes\r\n  var keyCode = event.keyCode\r\n  var pressed = event.type === 'keydown' ? true : false\r\n  this.keyCodes[keyCode] = pressed\r\n    // update this.modifiers\r\n  this.modifiers['shift'] = event.shiftKey\r\n  this.modifiers['ctrl'] = event.ctrlKey\r\n  this.modifiers['alt'] = event.altKey\r\n  this.modifiers['meta'] = event.metaKey\r\n};\r\n\r\n/**\r\n * query keyboard state to know if a key is pressed of not\r\n *\r\n * @param {String} keyDesc the description of the key. format : modifiers+key e.g shift+A\r\n * @returns {Boolean} true if the key is pressed, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.pressed = function(keyDesc) {\r\n  var keys = keyDesc.split(\"+\");\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i]\r\n    var pressed = false\r\n    if (THREEx.KeyboardState.MODIFIERS.indexOf(key) !== -1) {\r\n      pressed = this.modifiers[key];\r\n    }\r\n    else if (Object.keys(THREEx.KeyboardState.ALIAS).indexOf(key) != -1) {\r\n      pressed = this.keyCodes[THREEx.KeyboardState.ALIAS[key]];\r\n    }\r\n    else {\r\n      pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)]\r\n    }\r\n    if (!pressed) return false;\r\n  };\r\n  return true;\r\n};\r\n\r\n/**\r\n * return true if an event match a keyDesc\r\n * @param  {KeyboardEvent} event   keyboard event\r\n * @param  {String} keyDesc string description of the key\r\n * @return {Boolean}         true if the event match keyDesc, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.eventMatches = function(event, keyDesc) {\r\n  var aliases = THREEx.KeyboardState.ALIAS\r\n  var aliasKeys = Object.keys(aliases)\r\n  var keys = keyDesc.split(\"+\")\r\n    // log to debug\r\n    // console.log(\"eventMatches\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i];\r\n    var pressed = false;\r\n    if (key === 'shift') {\r\n      pressed = (event.shiftKey ? true : false)\r\n    }\r\n    else if (key === 'ctrl') {\r\n      pressed = (event.ctrlKey ? true : false)\r\n    }\r\n    else if (key === 'alt') {\r\n      pressed = (event.altKey ? true : false)\r\n    }\r\n    else if (key === 'meta') {\r\n      pressed = (event.metaKey ? true : false)\r\n    }\r\n    else if (aliasKeys.indexOf(key) !== -1) {\r\n      pressed = (event.keyCode === aliases[key] ? true : false);\r\n    }\r\n    else if (event.keyCode === key.toUpperCase().charCodeAt(0)) {\r\n      pressed = true;\r\n    }\r\n    if (!pressed) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREEx;\r\n  }\r\n  else {\r\n    exports.THREEx = THREEx;\r\n  }\r\n}\r\nelse {\r\n  this['THREEx'] = THREEx;\r\n}\r\n\r\n","Game = Class({\r\n  constructor: function(options) {\r\n    this.container = options.container;\r\n    this.loadingContainer = options.loadingContainer;\r\n    this.blocker = options.blocker;\r\n    this.instructions = options.instructions;\r\n\r\n    this.stats = null;\r\n\r\n    this.prevTime = performance.now();\r\n\r\n    this.renderer = null;\r\n    this.scene = null;\r\n    this.camera = null;\r\n\r\n    this.paused = true;\r\n\r\n    this.controlsEnabled = false;\r\n    this.controls = null;\r\n\r\n    this.systems = [];\r\n    this.postPhysicsSystems = [];\r\n\r\n    this.modelsToPreload = options.modelsToPreload;\r\n    this.percentModelsLoaded = 0;\r\n\r\n    this.soundsToPreload = options.soundsToPreload;\r\n    this.percentSoundsLoaded = 0;\r\n\r\n    this.texturesToPreload = options.texturesToPreload;\r\n    this.percentTexturesLoaded = 0;\r\n\r\n    this.systemsDelay = 0;\r\n  },\r\n\r\n  start: function(runImmediately) {\r\n    if (runImmediately === undefined || runImmediately === null) {\r\n      runImmediately = true;\r\n    }\r\n\r\n    window.addEventListener('resize', this.onResize.bind(this));\r\n    window.onkeydown = this.onKeyDown.bind(this); // prevent spacebar from scrolling the page\r\n    window.addEventListener('mousedown', this.onMouseDown.bind(this));\r\n    window.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n\r\n    this.renderer = new THREE.WebGLRenderer({\r\n      antialias: true\r\n    });\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    //this.renderer.setClearColor(0xffffff, 1);\r\n    this.renderer.setClearColor(0xbc00bc, 1);\r\n    this.container.appendChild(this.renderer.domElement);\r\n\r\n    /* Stats.js Setup */\r\n    this.stats = new Stats();\r\n    this.stats.setMode(0);\r\n\r\n    this.stats.domElement.style.position = 'absolute';\r\n    this.stats.domElement.style.left = '10px';\r\n    this.stats.domElement.style.bottom = '10px';\r\n\r\n    document.body.appendChild(this.stats.domElement);\r\n\r\n    // Create a new Three.js scene\r\n    this.scene = new Physijs.Scene();\r\n    this.scene.setGravity(new THREE.Vector3(0, -32, 0));\r\n\r\n    // Put in a camera\r\n    var aspectRatio = window.innerWidth / window.innerHeight;\r\n    this.camera = new THREE.PerspectiveCamera(45, aspectRatio, 0.1, 1000);\r\n    this.scene.add(this.camera);\r\n\r\n    /* Camera Controller */\r\n    this.controls = new PointerLockControls({\r\n      camera: this.camera\r\n    });\r\n    this.scene.add(this.controls.getObject());\r\n\r\n    var ambientLight = new THREE.AmbientLight(0xcbcbcb);\r\n    this.scene.add(ambientLight);\r\n\r\n    var dirLight = new THREE.DirectionalLight(0xdcdcdc, 0.5);\r\n    this.scene.add(dirLight);\r\n\r\n    /* Load Assets */\r\n\r\n    this.setupAudio();\r\n\r\n    this.loadModels();\r\n    this.loadSounds();\r\n    this.loadTextures();\r\n  },\r\n\r\n  setupAudio: function() {\r\n    window.AudioContext = (\r\n      window.AudioContext ||\r\n      window.webkitAudioContext ||\r\n      null\r\n    );\r\n\r\n    if (!AudioContext) {\r\n      throw new Error(\"AudioContext not supported!\");\r\n    }\r\n\r\n    var ctx = new AudioContext();\r\n\r\n    Globals.instance.sound = new SoundController({\r\n      context: ctx,\r\n      following: this.camera\r\n    });\r\n  },\r\n\r\n  loadSounds: function() {\r\n    this.soundsToPreload.forEach(function(path) {\r\n      Globals.instance.sound.loadSound(Globals.DIR + path, this.soundLoaded.bind(this));\r\n    }.bind(this));\r\n  },\r\n\r\n  soundLoaded: function(sound) {\r\n    var percentPerSound = 100.0 / this.soundsToPreload.length;\r\n    this.percentSoundsLoaded += percentPerSound;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  loadModels: function() {\r\n    this.modelsToPreload.forEach(function(path) {\r\n      ResourceManager.instance.loadModel(Globals.DIR + path, this.modelLoaded.bind(this));\r\n    }.bind(this));\r\n  },\r\n\r\n  modelLoaded: function(model) {\r\n    var percentPerModel = 100.0 / this.modelsToPreload.length;\r\n    this.percentModelsLoaded += percentPerModel;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  loadTextures: function() {\r\n    this.texturesToPreload.forEach(function(path) {\r\n      ResourceManager.instance.loadTexture(Globals.DIR + path, this.textureLoaded.bind(this));\r\n    }.bind(this));\r\n  },\r\n\r\n  textureLoaded: function(texture) {\r\n    var percentPerTexture = 100.0 / this.texturesToPreload.length;\r\n    this.percentTexturesLoaded += percentPerTexture;\r\n\r\n    if (this.waitForPreload()) {\r\n      this.makeGame();\r\n    }\r\n  },\r\n\r\n  waitForPreload: function() {\r\n    var modelsDone = this.percentModelsLoaded > 99.0;\r\n    var soundsDone = this.percentSoundsLoaded > 99.0;\r\n    var texturesDone = this.percentTexturesLoaded > 99.0;\r\n\r\n    var donePreloadng = (modelsDone && soundsDone && texturesDone);\r\n\r\n    return donePreloadng;\r\n  },\r\n\r\n  makeGame: function() {\r\n    /* Create Entities */\r\n\r\n    EntityFactory.instance.makeGround({\r\n      scene: this.scene,\r\n      width: 2000,\r\n      height: 2000\r\n    });\r\n\r\n    this.player = EntityFactory.instance.makePlayer({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(0, 30, 0),\r\n      controls: this.controls,\r\n      controlsObject: this.controls.getObject(),\r\n      cameraOffset: new THREE.Vector3(0, 10, 0), // 10, 10, 25\r\n      gunOffset: new THREE.Vector3(9, 8, 0),\r\n      hp: 20\r\n    });\r\n\r\n    EntityFactory.instance.makeEnemy({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(0, 30, -200),\r\n      aiTarget: this.player,\r\n      bulletSpeed: Utils.randomRange(EntityFactory.MIN_BULLET_SPEED.enemy, EntityFactory.MAX_BULLET_SPEED.enemy),\r\n      hp: 15\r\n    });\r\n\r\n    EntityFactory.instance.makeEnemy({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(-100, 30, -150),\r\n      aiTarget: this.player,\r\n      bulletSpeed: Utils.randomRange(EntityFactory.MIN_BULLET_SPEED.enemy, EntityFactory.MAX_BULLET_SPEED.enemy),\r\n      hp: 15\r\n    });\r\n\r\n    /* Setup Systems */\r\n\r\n    this.systems.push(new PlayerInputSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new AISystem(EntityFactory.instance.entities));\r\n    this.systems.push(new MovementSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ExpirableSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new CameraPitchSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ShootDelaySystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HurtSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new PlayerHealthSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HealthBarSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new DeathSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new SteamRemovalSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new SteamUpdateSystem(EntityFactory.instance.entities));\r\n\r\n    this.postPhysicsSystems.push(new PhysicsUpdateSystem(EntityFactory.instance.entities));\r\n    this.postPhysicsSystems.push(new CameraFollowSystem(EntityFactory.instance.entities));\r\n\r\n    /* Start Game */\r\n\r\n    this.startGame();\r\n  },\r\n\r\n  startGame: function() {\r\n    // hide loading indicator and show instructions\r\n    this.loadingContainer.style.visibility = \"hidden\";\r\n    this.blocker.style.visibility = \"visible\";\r\n    this.instructions.style.visibility = \"visible\";\r\n    Globals.instance.hudLeftElement.style.display = 'block';\r\n    Globals.instance.hudRightElement.style.display = 'block';\r\n\r\n    // ensure the user is at the top of the page\r\n    document.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\r\n    this.update(false);\r\n\r\n    this.initPointerLock();\r\n\r\n    this.update(true);\r\n  },\r\n\r\n  update: function(animationFrame) {\r\n    if (animationFrame) {\r\n      requestAnimationFrame(this.update.bind(this));\r\n    }\r\n\r\n    var time = performance.now();\r\n    var dt = (time - this.prevTime) / 1000;\r\n    Globals.instance.dt = dt;\r\n\r\n    if (!this.paused) {\r\n      if (dt > 0.05) {\r\n        dt = 0.05;\r\n      }\r\n\r\n      this.systems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      this.scene.simulate(dt);\r\n\r\n      this.postPhysicsSystems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      Globals.instance.sound.update(dt);\r\n\r\n      MouseController.instance.update(dt);\r\n    }\r\n\r\n    this.renderer.render(this.scene, this.camera);\r\n    this.stats.update();\r\n\r\n    this.prevTime = time;\r\n  },\r\n\r\n  onResize: function(e) {\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n\r\n    this.camera.aspect = (window.innerWidth / window.innerHeight);\r\n    this.camera.updateProjectionMatrix();\r\n  },\r\n\r\n  onKeyDown: function(e) {\r\n    var keyCode = ('which' in event) ? event.which : event.keyCode;\r\n\r\n    return (keyCode !== Game.KEY_CODES.space);\r\n  },\r\n\r\n  onMouseDown: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = true;\r\n    }\r\n  },\r\n\r\n  onMouseUp: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = false;\r\n      MouseController.instance.wasPressed.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = false;\r\n      MouseController.instance.wasPressed.right = true;\r\n    }\r\n  },\r\n\r\n  initPointerLock: function() {\r\n    var havePointerLock = 'pointerLockElement' in document || 'mozPointerLockElement' in document || 'webkitPointerLockElement' in document;\r\n\r\n    if (havePointerLock) {\r\n\r\n      var element = document.body;\r\n\r\n      var pointerlockchange = function(event) {\r\n\r\n        if (document.pointerLockElement === element || document.mozPointerLockElement === element || document.webkitPointerLockElement === element) {\r\n\r\n          this.controlsEnabled = true;\r\n          this.controls.enabled = true;\r\n\r\n          this.blocker.style.display = 'none';\r\n\r\n          if (Globals.instance.reloadingElement.style.visibility === 'visible') {\r\n            Globals.instance.reloadImg.play();\r\n          }\r\n\r\n          this.paused = false;\r\n\r\n        }\r\n        else {\r\n\r\n          this.controls.enabled = false;\r\n\r\n          this.blocker.style.display = '-webkit-box';\r\n          this.blocker.style.display = '-moz-box';\r\n          this.blocker.style.display = 'box';\r\n\r\n          this.instructions.style.display = '';\r\n\r\n          if (Globals.instance.reloadImg.get_playing()) {\r\n            Globals.instance.reloadImg.pause();\r\n          }\r\n\r\n          this.paused = true;\r\n\r\n        }\r\n\r\n      }.bind(this);\r\n\r\n      var pointerlockerror = function(event) {\r\n\r\n        this.instructions.style.display = '';\r\n\r\n      }.bind(this);\r\n\r\n      // Hook pointer lock state change events\r\n      document.addEventListener('pointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('mozpointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('webkitpointerlockchange', pointerlockchange, false);\r\n\r\n      document.addEventListener('pointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('mozpointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('webkitpointerlockerror', pointerlockerror, false);\r\n\r\n      this.instructions.addEventListener('click', function(event) {\r\n\r\n        this.instructions.style.display = 'none';\r\n\r\n        // Ask the browser to lock the pointer\r\n        element.requestPointerLock = element.requestPointerLock || element.mozRequestPointerLock || element.webkitRequestPointerLock;\r\n\r\n        if (/Firefox/i.test(navigator.userAgent)) {\r\n\r\n          var fullscreenchange = function(event) {\r\n\r\n            if (document.fullscreenElement === element || document.mozFullscreenElement === element || document.mozFullScreenElement === element) {\r\n\r\n              document.removeEventListener('fullscreenchange', fullscreenchange);\r\n              document.removeEventListener('mozfullscreenchange', fullscreenchange);\r\n\r\n              element.requestPointerLock();\r\n            }\r\n\r\n          };\r\n\r\n          document.addEventListener('fullscreenchange', fullscreenchange, false);\r\n          document.addEventListener('mozfullscreenchange', fullscreenchange, false);\r\n\r\n          element.requestFullscreen = element.requestFullscreen || element.mozRequestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;\r\n\r\n          element.requestFullscreen();\r\n\r\n        }\r\n        else {\r\n\r\n          element.requestPointerLock();\r\n\r\n        }\r\n\r\n      }.bind(this), false);\r\n\r\n    }\r\n    else {\r\n\r\n      this.instructions.innerHTML = 'Your browser doesn\\'t seem to support Pointer Lock API';\r\n\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    KEY_CODES: {\r\n      space: 32\r\n    }\r\n  }\r\n});\r\n\r\n","var Utils = Utils || {};\r\n\r\nUtils.randomRange = function(min, max) {\r\n  return Math.random() * (max - min) + min;\r\n};\r\n\r\nmodule.exports = Utils;\r\n\r\n","Globals = Class({\r\n  constructor: function() {\r\n    this.dt = 0;\r\n\r\n    this.hudElement = null;\r\n\r\n    this.healthElement = null;\r\n\r\n    this.ammoElement = null;\r\n\r\n    this.scoreElement = null;\r\n    this.score = 0;\r\n\r\n    this.reloadingElement = null;\r\n    this.reloadImg = null;\r\n\r\n    this.overlayElement = null;\r\n\r\n    this.sound = null;\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!Globals._instance) {\r\n        Globals._instance = new Globals();\r\n      }\r\n      return Globals._instance;\r\n    },\r\n\r\n    DIR: \"./\",\r\n\r\n    ENTITY_TYPES: {\r\n      player: 0,\r\n      enemy: 1,\r\n\r\n      ground: 2,\r\n      obstacle: 3,\r\n\r\n      bullet: 4\r\n    }\r\n  }\r\n});\r\n\r\n","PointerLockControls = Class({\r\n  constructor: function(options) {\r\n    this.camera = options.camera;\r\n    this.camera.rotation.set(0, 0, 0);\r\n\r\n    this.pitchObject = new THREE.Object3D();\r\n    this.pitchObject.add(this.camera);\r\n\r\n    this.yawObject = new THREE.Object3D();\r\n    this.yawObject.position.y = 10;\r\n    this.yawObject.add(this.pitchObject);\r\n\r\n    this.moveForward = false;\r\n    this.moveBackward = false;\r\n    this.moveLeft = false;\r\n    this.moveRight = false;\r\n\r\n    this.isOnObject = false;\r\n    this.canJump = false;\r\n\r\n    this.prevTime = performance.now();\r\n\r\n    this.velocity = new THREE.Vector3();\r\n\r\n    this.enabled = false;\r\n\r\n    this.mass = options.mass || 100.0;\r\n    this.moveSpeed = options.moveSpeed || new THREE.Vector3(400.0, 350.0, 400.0);\r\n    this.minimumY = options.minimumY || 10;\r\n\r\n    document.addEventListener('mousemove', this.onMouseMove.bind(this), false);\r\n    document.addEventListener('keydown', this.onKeyDown.bind(this), false);\r\n    document.addEventListener('keyup', this.onKeyUp.bind(this), false);\r\n  },\r\n\r\n  onMouseMove: function(event) {\r\n    if (this.enabled === false) {\r\n      return;\r\n    }\r\n\r\n    var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\r\n    var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\r\n\r\n    this.yawObject.rotation.y -= movementX * 0.002;\r\n    this.pitchObject.rotation.x -= movementY * 0.002;\r\n\r\n    this.pitchObject.rotation.x = Math.max(-PointerLockControls.PI_2, Math.min(PointerLockControls.PI_2, this.pitchObject.rotation.x));\r\n  },\r\n\r\n  onKeyDown: function(event) {\r\n    switch (event.keyCode) {\r\n      case 38: // up\r\n      case 87: // w\r\n        this.moveForward = true;\r\n        break;\r\n\r\n      case 37: // left\r\n      case 65: // a\r\n        this.moveLeft = true;\r\n        break;\r\n\r\n      case 40: // down\r\n      case 83: // s\r\n        this.moveBackward = true;\r\n        break;\r\n\r\n      case 39: // right\r\n      case 68: // d\r\n        this.moveRight = true;\r\n        break;\r\n\r\n      case 32: // space\r\n        if (this.canJump === true) {\r\n          this.velocity.y += this.moveSpeed.y;\r\n        }\r\n\r\n        this.canJump = false;\r\n\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  },\r\n\r\n  onKeyUp: function(event) {\r\n    switch (event.keyCode) {\r\n      case 38: // up\r\n      case 87: // w\r\n        this.moveForward = false;\r\n        break;\r\n\r\n      case 37: // left\r\n      case 65: // a\r\n        this.moveLeft = false;\r\n        break;\r\n\r\n      case 40: // down\r\n      case 83: // s\r\n        this.moveBackward = false;\r\n        break;\r\n\r\n      case 39: // right\r\n      case 68: // d\r\n        this.moveRight = false;\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  },\r\n\r\n  getObject: function() {\r\n    return this.yawObject;\r\n  },\r\n\r\n  isOnObject: function(bool) {\r\n    this.isOnObject = bool;\r\n    this.canJump = bool;\r\n  },\r\n\r\n  getDirection: function() {\r\n    // assumes the camera itself is not rotated\r\n    var direction = new THREE.Vector3(0, 0, -1);\r\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n\r\n    return function(v) {\r\n      rotation.set(this.pitchObject.rotation.x, this.yawObject.rotation.y, 0);\r\n\r\n      v.copy(direction).applyEuler(rotation);\r\n\r\n      return v;\r\n    };\r\n  }(),\r\n\r\n  update: function(dt) {\r\n    if (this.enabled === false) {\r\n      return;\r\n    }\r\n\r\n    this.velocity.x -= this.velocity.x * 10.0 * dt;\r\n    this.velocity.z -= this.velocity.z * 10.0 * dt;\r\n\r\n    this.velocity.y -= 9.8 * this.mass * dt;\r\n\r\n    if (this.moveForward) {\r\n      this.velocity.z -= this.moveSpeed.z * dt;\r\n    }\r\n    if (this.moveBackward) {\r\n      this.velocity.z += this.moveSpeed.z * dt;\r\n    }\r\n\r\n    if (this.moveLeft) {\r\n      this.velocity.x -= this.moveSpeed.x * dt;\r\n    }\r\n    if (this.moveRight) {\r\n      this.velocity.x += this.moveSpeed.x * dt;\r\n    }\r\n\r\n    if (this.isOnObject === true) {\r\n      this.velocity.y = Math.max(0, this.velocity.y);\r\n    }\r\n\r\n    this.yawObject.translateX(this.velocity.x * dt);\r\n    this.yawObject.translateY(this.velocity.y * dt);\r\n    this.yawObject.translateZ(this.velocity.z * dt);\r\n\r\n    if (this.yawObject.position.y < this.minimumY) {\r\n      this.velocity.y = 0;\r\n      this.yawObject.position.y = this.minimumY;\r\n\r\n      this.canJump = true;\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    PI_2: Math.PI / 2\r\n  }\r\n});\r\n\r\n","Model = Class({\r\n  constructor: function(options) {\r\n    this.geometry = options.geometry;\r\n    this.material = options.material;\r\n  },\r\n\r\n  clone: function() {\r\n    return new Model({\r\n      geometry: this.geometry.clone(),\r\n      material: this.material.clone()\r\n    });\r\n  }\r\n});\r\n\r\nResourceManager = Class({\r\n  constructor: function() {\r\n    this.loadingManager = new THREE.LoadingManager();\r\n\r\n    this.jsonLoader = new THREE.JSONLoader(this.loadingManager);\r\n\r\n    this.textures = {};\r\n    this.models = {};\r\n  },\r\n\r\n  loadTexture: function(path, callback) {\r\n    if (path in this.textures) {\r\n      throw new Error(\"The texture located at \" + path + \" is already loaded\");\r\n    }\r\n\r\n    this.textures[path] = THREE.ImageUtils.loadTexture(path, undefined, callback, function(e) {\r\n      console.log(e);\r\n    });\r\n  },\r\n\r\n  getTexture: function(path) {\r\n    if (path === null || path === undefined) {\r\n      return null;\r\n    }\r\n    else if (path in this.textures) {\r\n      return this.textures[path];\r\n    }\r\n\r\n    throw new Error(\"The texture located at \" + path + \" is not loaded\");\r\n  },\r\n\r\n  loadModel: function(path, callback) {\r\n    if (path === null || path === undefined) {\r\n      return;\r\n    }\r\n    else if (path in this.models) {\r\n      callback(this.models[path]);\r\n\r\n      return;\r\n    }\r\n\r\n    this.jsonLoader.load(path, function(geometry, materials) {\r\n      var material = new THREE.MeshFaceMaterial(materials);\r\n\r\n      var model = new Model({\r\n        geometry: geometry,\r\n        material: material\r\n      });\r\n      this.models[path] = model;\r\n\r\n      callback(model);\r\n    }.bind(this));\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!ResourceManager._instance) {\r\n        ResourceManager._instance = new ResourceManager();\r\n      }\r\n      return ResourceManager._instance;\r\n    }\r\n  }\r\n});\r\n\r\n","var EntityManager = require('tiny-ecs').EntityManager;\r\nvar C = require('./Components.js');\r\nvar b3 = require('./../b3core.0.1.0.js');\r\n\r\nEntityFactory = Class({\r\n  constructor: function() {\r\n    this.entities = new EntityManager();\r\n  },\r\n\r\n  makePlayer: function(options) {\r\n    var player = this.entities.createEntity();\r\n\r\n    ResourceManager.instance.loadModel('models/character.json', function(model) {\r\n      player.addTag(\"player\");\r\n\r\n      player.addComponent(C.Identifier);\r\n      player.addComponent(C.Position);\r\n      player.addComponent(C.Velocity);\r\n      player.addComponent(C.Jump);\r\n      player.addComponent(C.Drawable);\r\n      player.addComponent(C.CameraFollow);\r\n      player.addComponent(C.ShootDelay);\r\n      player.addComponent(C.Health);\r\n      player.addComponent(C.Gun);\r\n\r\n      player.identifier.type = Globals.ENTITY_TYPES.player;\r\n\r\n      player.drawable.scene = options.scene;\r\n\r\n      player.drawable.mesh = new Physijs.CapsuleMesh(\r\n        model.geometry,\r\n        Physijs.createMaterial(new THREE.MeshBasicMaterial({\r\n          color: 0xffff00\r\n        }), 0.9, 0.01), EntityFactory.MASS.player);\r\n      player.drawable.mesh.entity = player;\r\n\r\n      player.drawable.mesh.position.copy(options.position);\r\n      //player.drawable.mesh.rotation.copy(options.rotation);\r\n\r\n      player.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.player;\r\n      player.drawable.mesh._physijs.collision_masks = (\r\n        EntityFactory.COLLISION_TYPES.obstacle |\r\n        EntityFactory.COLLISION_TYPES.enemy |\r\n        EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n      player.drawable.scene.add(player.drawable.mesh);\r\n\r\n      player.drawable.mesh.setDamping(0.99, 0);\r\n      player.drawable.mesh.setAngularFactor(new THREE.Vector3(0, 0, 0));\r\n\r\n      player.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n        if (contact_normal.y < 0 && other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n          player.jump.canJump = true;\r\n        }\r\n\r\n        if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy && player.hasComponent(C.Hurt) === false) {\r\n          player.addComponent(C.Hurt);\r\n          player.hurt.originalColor = player.drawable.mesh.material.color;\r\n\r\n          player.health.hp--;\r\n          player.health.changed = true;\r\n        }\r\n        else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && player.hasComponent(C.Hurt) === false) {\r\n          var hitSounds = [\r\n            Globals.DIR + \"sfx/hurt1.mp3\",\r\n            Globals.DIR + \"sfx/hurt2.mp3\",\r\n            Globals.DIR + \"sfx/hurt3.mp3\"\r\n          ];\r\n\r\n          var soundPos = new THREE.Vector3().setFromMatrixPosition(player.drawable.mesh.matrixWorld);\r\n          var soundVel = new THREE.Vector3(player.velocity.x, player.velocity.y, player.velocity.z);\r\n          var soundDir = new THREE.Vector3();\r\n          player.cameraFollow.controls.getDirection(soundDir);\r\n          var soundIndex = Math.floor(Utils.randomRange(0, hitSounds.length));\r\n\r\n          var sound = Globals.instance.sound.getSound(hitSounds[soundIndex]);\r\n          sound.setPosition(soundPos);\r\n          sound.setVelocity(soundVel);\r\n          sound.setOrientation(soundDir);\r\n          sound.play();\r\n        }\r\n      });\r\n\r\n      player.health.hp = player.health.maxHP = options.hp || 20;\r\n\r\n      player.position.x = options.position.x;\r\n      player.position.y = options.position.y;\r\n      player.position.z = options.position.z;\r\n\r\n      player.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(player.drawable.mesh.matrix);\r\n\r\n      player.cameraFollow.controls = options.controls;\r\n      player.cameraFollow.object = options.controlsObject;\r\n      player.cameraFollow.offset = options.cameraOffset;\r\n\r\n      player.shootDelay.delayTheshold = 1.5;\r\n\r\n      this.makeGun({\r\n        parent: player.drawable.mesh,\r\n        cameraControls: options.controls,\r\n        offset: options.gunOffset,\r\n        callback: function(gun) {\r\n          player.gun.entity = gun;\r\n          player.gun.mesh = gun.drawable.mesh;\r\n        }\r\n      });\r\n    }.bind(this));\r\n\r\n    return player;\r\n  },\r\n\r\n  makeEnemy: function(options) {\r\n    ResourceManager.instance.loadModel('models/character.json', function(model) {\r\n      var enemy = this.entities.createEntity();\r\n\r\n      enemy.addTag(\"enemy\");\r\n\r\n      enemy.addComponent(C.Identifier);\r\n      enemy.addComponent(C.Position);\r\n      enemy.addComponent(C.Velocity);\r\n      enemy.addComponent(C.Drawable);\r\n      enemy.addComponent(C.Health);\r\n      enemy.addComponent(C.ShootDelay);\r\n      enemy.addComponent(C.AI);\r\n\r\n      enemy.identifier.type = Globals.ENTITY_TYPES.enemy;\r\n\r\n      enemy.drawable.scene = options.scene;\r\n\r\n      enemy.drawable.mesh = new Physijs.CapsuleMesh(\r\n        model.geometry,\r\n        Physijs.createMaterial(new THREE.MeshPhongMaterial({\r\n          color: 0x0000ff\r\n        }), 0.9, 0.1), EntityFactory.MASS.enemy);\r\n      enemy.drawable.mesh.entity = enemy;\r\n\r\n      enemy.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemy;\r\n      enemy.drawable.mesh._physijs.collision_masks = (\r\n        EntityFactory.COLLISION_TYPES.obstacle |\r\n        EntityFactory.COLLISION_TYPES.player |\r\n        EntityFactory.COLLISION_TYPES.enemy |\r\n        EntityFactory.COLLISION_TYPES.playerBullet |\r\n        EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n      enemy.drawable.mesh.position.copy(options.position);\r\n      //enemy.drawable.mesh.rotation.copy(options.rotation);\r\n\r\n      enemy.drawable.scene.add(enemy.drawable.mesh);\r\n\r\n      enemy.drawable.mesh.setDamping(0.99, 0);\r\n      enemy.drawable.mesh.setAngularFactor(new THREE.Vector3(0, 1, 0));\r\n\r\n      enemy.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n        if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'player' && enemy.hasComponent(C.Hurt) === false) {\r\n          var hitSounds = [\r\n            Globals.DIR + \"sfx/hurt1.mp3\",\r\n            Globals.DIR + \"sfx/hurt2.mp3\",\r\n            Globals.DIR + \"sfx/hurt3.mp3\"\r\n          ];\r\n\r\n          var soundPos = new THREE.Vector3().setFromMatrixPosition(enemy.drawable.mesh.matrixWorld);\r\n          var soundVel = new THREE.Vector3(enemy.velocity.x, enemy.velocity.y, enemy.velocity.z);\r\n          var soundIndex = Math.floor(Utils.randomRange(0, hitSounds.length));\r\n\r\n          var direction = new THREE.Vector3(0, 0, -1);\r\n          var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n          rotation.set(enemy.drawable.mesh.rotation.x, enemy.drawable.mesh.rotation.y, 0);\r\n\r\n          var forward = new THREE.Vector3();\r\n          forward.copy(direction).applyEuler(rotation);\r\n\r\n          var sound = Globals.instance.sound.getSound(hitSounds[soundIndex]);\r\n          sound.setPosition(soundPos);\r\n          sound.setVelocity(soundVel);\r\n          sound.setOrientation(forward);\r\n          sound.play();\r\n        }\r\n      });\r\n\r\n      enemy.position.x = options.position.x;\r\n      enemy.position.y = options.position.y;\r\n      enemy.position.z = options.position.z;\r\n\r\n      enemy.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(enemy.drawable.mesh.matrix);\r\n\r\n      enemy.health.hp = enemy.health.maxHP = options.hp || 15;\r\n      enemy.health.healthBar = new THREE.Mesh(\r\n        new THREE.BoxGeometry(14, 1.5, 0.5),\r\n        new THREE.MeshBasicMaterial({\r\n          color: 0x00ff00\r\n        }));\r\n      enemy.health.healthBar.position.set(0, 25, 0);\r\n      enemy.drawable.mesh.add(enemy.health.healthBar);\r\n\r\n      enemy.shootDelay.delayTheshold = 1.5;\r\n\r\n      options.bulletSpeed = THREE.Math.clamp(options.bulletSpeed, EntityFactory.MIN_BULLET_SPEED.enemy, EntityFactory.MAX_BULLET_SPEED.enemy);\r\n\r\n      var FaceNode = b3.Class(b3.Action);\r\n      FaceNode.prototype.name = 'FaceNode';\r\n      FaceNode.prototype.parameters = {\r\n        'facing': null\r\n      };\r\n\r\n      FaceNode.prototype.__Action_initialize = FaceNode.prototype.initialize;\r\n      FaceNode.prototype.initialize = function(settings) {\r\n        settings = settings || {};\r\n\r\n        this.__Action_initialize();\r\n\r\n        this.facing = settings.facing;\r\n      };\r\n\r\n      FaceNode.prototype.tick = function(tick) {\r\n        if (this.facing._manager === null || this.facing._manager === undefined) {\r\n          return b3.FAILURE;\r\n        }\r\n\r\n        // http://forum.unity3d.com/threads/making-an-object-rotate-to-face-another.1211/\r\n        // http://answers.unity3d.com/questions/503934/chow-to-check-if-an-object-is-facing-another.html\r\n\r\n        var parentPos = tick.target.drawable.mesh.position.clone();\r\n        var followingPos = this.facing.drawable.mesh.position.clone();\r\n\r\n        var posDif = parentPos.clone();\r\n        posDif.sub(followingPos);\r\n\r\n        var forward = new THREE.Vector3(0, 0, -1);\r\n        forward.applyMatrix4(tick.target.velocity.rotationMatrix);\r\n\r\n        var angle = forward.angleTo(posDif) * 180 / Math.PI;\r\n\r\n        if (Math.abs(angle) <= 5) {\r\n          return b3.SUCCESS;\r\n        }\r\n\r\n        var lookAtMatrix = new THREE.Matrix4();\r\n        lookAtMatrix.lookAt(followingPos, parentPos, new THREE.Vector3(0, 1, 0));\r\n\r\n        var parentRotation = new THREE.Quaternion().setFromEuler(tick.target.drawable.mesh.rotation);\r\n        var targetRotation = new THREE.Quaternion().setFromRotationMatrix(lookAtMatrix);\r\n\r\n        var str = Math.min(3 * Globals.instance.dt, 5);\r\n\r\n        parentRotation.slerp(targetRotation, str);\r\n\r\n        tick.target.drawable.mesh.rotation.setFromQuaternion(parentRotation);\r\n        tick.target.drawable.mesh.__dirtyRotation = true;\r\n\r\n        return b3.RUNNING;\r\n      };\r\n\r\n      var RandomChildNode = b3.Class(b3.Composite);\r\n      RandomChildNode.prototype.name = 'RandomChildNode';\r\n\r\n      RandomChildNode.prototype.__Composite_initialize = RandomChildNode.prototype.initialize;\r\n      RandomChildNode.prototype.initialize = function(settings) {\r\n        settings = settings || {};\r\n\r\n        this.__Composite_initialize(settings);\r\n\r\n        this.chance = settings.chance;\r\n      };\r\n\r\n      RandomChildNode.prototype.tick = function(tick) {\r\n        //var chance = 1 / this.children.length;\r\n\r\n        for (var i = 0; i < this.children.length; i++) {\r\n          if (Math.random() <= this.chance[i]) {\r\n            var status = this.children[i]._execute(tick);\r\n\r\n            if (status !== b3.SUCCESS) {\r\n              return status;\r\n            }\r\n          }\r\n        }\r\n\r\n        return b3.SUCCESS;\r\n      };\r\n\r\n      var FollowNode = b3.Class(b3.Action);\r\n      FollowNode.prototype.name = 'FollowNode';\r\n      FollowNode.prototype.parameters = {\r\n        'following': null\r\n      };\r\n\r\n      FollowNode.prototype.__Action_initialize = FollowNode.prototype.initialize;\r\n      FollowNode.prototype.initialize = function(settings) {\r\n        settings = settings || {};\r\n\r\n        this.__Action_initialize();\r\n\r\n        this.following = settings.following;\r\n      };\r\n\r\n      FollowNode.prototype.tick = function(tick) {\r\n        if (this.following._manager === null || this.following._manager === undefined) {\r\n          return b3.FAILURE;\r\n        }\r\n\r\n        var parentPos = tick.target.drawable.mesh.position.clone();\r\n        var followingPos = this.following.drawable.mesh.position.clone();\r\n\r\n        var distance = parentPos.distanceTo(followingPos);\r\n\r\n        if (distance < 50) {\r\n          return b3.SUCCESS;\r\n        }\r\n\r\n        var difference = new THREE.Vector3();\r\n        difference.subVectors(followingPos, parentPos);\r\n\r\n        var normal = difference.normalize();\r\n        var velocity = new THREE.Vector3(tick.target.velocity.x, tick.target.velocity.y, tick.target.velocity.z);\r\n        var dv = new THREE.Vector3(EntityFactory.MOVE_SPEED.enemy * normal.x, 0, EntityFactory.MOVE_SPEED.enemy * normal.z);\r\n\r\n        velocity.add(dv);\r\n\r\n        tick.target.velocity.x = velocity.x;\r\n        tick.target.velocity.y = velocity.y;\r\n        tick.target.velocity.z = velocity.z;\r\n\r\n        return b3.RUNNING;\r\n      };\r\n\r\n      var ShootNode = b3.Class(b3.Action);\r\n      ShootNode.prototype.name = 'ShootNode';\r\n      ShootNode.prototype.parameters = {\r\n        'shootingAt': null\r\n      };\r\n\r\n      ShootNode.prototype.__Action_initialize = ShootNode.prototype.initialize;\r\n      ShootNode.prototype.initialize = function(settings) {\r\n        settings = settings || {};\r\n\r\n        this.__Action_initialize();\r\n\r\n        this.shootingAt = settings.shootingAt;\r\n        this.bulletSpeed = settings.bulletSpeed;\r\n      };\r\n\r\n      ShootNode.prototype.tick = function(tick) {\r\n        if (this.shootingAt._manager === null || this.shootingAt._manager === undefined) {\r\n          return b3.FAILURE;\r\n        }\r\n        else if (tick.target.shootDelay.canShoot === false) {\r\n          return b3.FAILURE;\r\n        }\r\n\r\n        var parentPos = tick.target.drawable.mesh.position.clone();\r\n        var followingPos = this.shootingAt.drawable.mesh.position.clone();\r\n\r\n        var spawnLocation = parentPos.clone();\r\n        var spawnOffset = new THREE.Vector3(0, 10, 20);\r\n        spawnOffset.applyMatrix4(tick.target.velocity.rotationMatrix);\r\n        spawnLocation.add(spawnOffset);\r\n\r\n        // the number of frames to \"look ahead\"\r\n        // this is used to lead the shot, making it easier to hit a moving target (in this case, the player)\r\n        var futureFrames = (EntityFactory.MAX_BULLET_SPEED.enemy - this.bulletSpeed) / 2.5;\r\n        futureFrames = THREE.Math.clamp(futureFrames, 2, 15);\r\n\r\n        var followingVel = new THREE.Vector3(this.shootingAt.velocity.x, this.shootingAt.velocity.y, this.shootingAt.velocity.z);\r\n        followingVel.multiplyScalar(Globals.instance.dt * futureFrames);\r\n        var predictedPos = followingPos.clone();\r\n        predictedPos.add(followingVel);\r\n\r\n        var posDif = spawnLocation.clone();\r\n        posDif.sub(predictedPos);\r\n\r\n        var distance = posDif.length();\r\n\r\n        var lookAtMatrix = new THREE.Matrix4();\r\n        lookAtMatrix.lookAt(predictedPos, spawnLocation, new THREE.Vector3(0, 1, 0));\r\n\r\n        var forward = new THREE.Vector3(0, 0, -1);\r\n        forward.applyMatrix4(lookAtMatrix);\r\n\r\n        var velocity = -this.bulletSpeed;\r\n\r\n        // I have no clue why this works, but it seems to generate an arc fairly consistently\r\n        var velOffset = 1 - (velocity / 100);\r\n        forward.y -= distance / ((velocity - (velocity * velOffset * EntityFactory.MASS.bullet)) * velocity);\r\n        forward.normalize();\r\n\r\n        EntityFactory.instance.makePotato({\r\n          scene: tick.target.drawable.scene,\r\n          position: spawnLocation,\r\n          rotation: tick.target.drawable.mesh.rotation.clone(),\r\n          direction: forward,\r\n          velocity: velocity,\r\n          owner: 'enemy'\r\n        });\r\n\r\n        tick.target.shootDelay.canShoot = false;\r\n\r\n        return b3.SUCCESS;\r\n      };\r\n\r\n      enemy.ai.tree = new b3.BehaviorTree();\r\n      enemy.ai.tree.root = new b3.Sequence({\r\n        children: [\r\n          new b3.Sequence({\r\n            children: [\r\n              new FaceNode({\r\n                facing: options.aiTarget\r\n              }),\r\n              new RandomChildNode({\r\n                children: [\r\n                  new FollowNode({\r\n                    following: options.aiTarget\r\n                  }),\r\n                  new ShootNode({\r\n                    shootingAt: options.aiTarget,\r\n                    bulletSpeed: options.bulletSpeed\r\n                  })\r\n                ],\r\n                chance: [\r\n                  0.9,\r\n                  0.1\r\n                ]\r\n              })\r\n            ]\r\n          })\r\n        ]\r\n      });\r\n\r\n      enemy.ai.target = enemy;\r\n      enemy.ai.blackboard = new b3.Blackboard();\r\n    }.bind(this));\r\n  },\r\n\r\n  makeGun: function(options) {\r\n    ResourceManager.instance.loadModel('models/potatoCannon.json', function(model) {\r\n      var gun = this.entities.createEntity();\r\n\r\n      gun.addComponent(C.Position);\r\n      gun.addComponent(C.Drawable);\r\n\r\n      gun.drawable.scene = options.parent;\r\n      gun.drawable.mesh = new THREE.Mesh(\r\n        model.geometry,\r\n        model.material.clone());\r\n\r\n      gun.drawable.mesh.position.copy(options.offset);\r\n\r\n      gun.drawable.scene.add(gun.drawable.mesh);\r\n\r\n      if (options.cameraControls) {\r\n        gun.addComponent(C.CameraPitch);\r\n\r\n        gun.cameraPitch.controls = options.cameraControls;\r\n      }\r\n\r\n      if (options.callback) {\r\n        options.callback(gun);\r\n      }\r\n    }.bind(this));\r\n  },\r\n\r\n  makePotato: function(options) {\r\n    ResourceManager.instance.loadModel('models/potato.json', function(model) {\r\n      var potato = this.entities.createEntity();\r\n\r\n      potato.addTag(\"bullet\");\r\n      potato.addTag(\"potato\");\r\n\r\n      potato.addComponent(C.Identifier);\r\n      potato.addComponent(C.Position);\r\n      potato.addComponent(C.Velocity);\r\n      potato.addComponent(C.Drawable);\r\n      potato.addComponent(C.Bullet);\r\n      potato.addComponent(C.Expirable);\r\n      potato.addComponent(C.OneTimeHit);\r\n      potato.addComponent(C.Steaming);\r\n\r\n      potato.identifier.type = Globals.ENTITY_TYPES.bullet;\r\n      potato.bullet.owner = options.owner;\r\n\r\n      potato.velocity.doMove = false;\r\n\r\n      potato.drawable.scene = options.scene;\r\n\r\n      potato.drawable.mesh = new Physijs.CapsuleMesh(\r\n        model.geometry,\r\n        Physijs.createMaterial(model.material.clone(), 0.7, 0.01),\r\n        0.3);\r\n      potato.drawable.mesh.entity = potato;\r\n\r\n      // potatos are \"hot\" when created, so tint them red\r\n      potato.drawable.mesh.material.materials.forEach(function(mat) {\r\n        mat.color.setHex(0xE34D4D);\r\n      });\r\n\r\n      if (options.owner === 'player') {\r\n        potato.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.playerBullet;\r\n      }\r\n      else {\r\n        potato.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemyBullet;\r\n      }\r\n\r\n      potato.drawable.mesh._physijs.collision_masks = (\r\n        EntityFactory.COLLISION_TYPES.obstacle |\r\n        EntityFactory.COLLISION_TYPES.enemy |\r\n        EntityFactory.COLLISION_TYPES.player |\r\n        EntityFactory.COLLISION_TYPES.playerBullet |\r\n        EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n      potato.drawable.mesh.position.copy(options.position);\r\n      potato.drawable.mesh.rotation.copy(options.rotation);\r\n      if (options.scale) {\r\n        potato.drawable.mesh.scale.copy(options.scale);\r\n      }\r\n\r\n      potato.drawable.scene.add(potato.drawable.mesh);\r\n\r\n      potato.drawable.mesh.setDamping(0.1, 0);\r\n\r\n      potato.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n        if (potato.bullet.isHot === false) {\r\n          return;\r\n        }\r\n\r\n        var hitPlayer = potato.bullet.owner === 'enemy' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.player;\r\n        var hitEnemy = potato.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy;\r\n\r\n        if ((hitPlayer || hitEnemy) && other_object.entity.hasComponent(C.Hurt) === false && potato.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          other_object.entity.addComponent(C.Hurt);\r\n          other_object.entity.hurt.originalColor = other_object.material.color.clone();\r\n\r\n          other_object.entity.health.hp -= 5;\r\n          other_object.entity.health.changed = true;\r\n\r\n          potato.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n        else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n          potato.bullet.touchedGround = true;\r\n        }\r\n        else if (potato.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && potato.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          Globals.instance.score += 5;\r\n\r\n          Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n          potato.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n\r\n        var soundPos = new THREE.Vector3().setFromMatrixPosition(potato.drawable.mesh.matrixWorld);\r\n        var soundVel = new THREE.Vector3(potato.velocity.x * Globals.instance.dt, potato.velocity.y * Globals.instance.dt, potato.velocity.z * Globals.instance.dt);\r\n        var soundForward = new THREE.Vector3(0, 0, 1);\r\n        soundForward.applyProjection(potato.drawable.mesh.matrixWorld);\r\n        soundForward.normalize();\r\n\r\n        var sound = Globals.instance.sound.getSound(Globals.DIR + 'sfx/hitSplat.wav');\r\n        sound.setPosition(soundPos);\r\n        sound.setVelocity(vel);\r\n        sound.setOrientation(soundForward);\r\n        sound.play();\r\n\r\n        potato.bullet.isHot = false;\r\n\r\n        // the potato is now \"cold,\" so tint it blue\r\n        potato.drawable.mesh.material.materials.forEach(function(mat) {\r\n          mat.color.setHex(0x45B7DE);\r\n        });\r\n      }.bind(this));\r\n\r\n      potato.position.x = options.position.x;\r\n      potato.position.y = options.position.y;\r\n      potato.position.z = options.position.z;\r\n\r\n      var vel = new THREE.Vector3(options.velocity, options.velocity, options.velocity);\r\n      vel.multiply(options.direction);\r\n      potato.drawable.mesh.applyCentralImpulse(vel);\r\n\r\n      potato.expirable.maxAge = 6;\r\n\r\n      potato.steaming.parent = potato.drawable.mesh;\r\n      potato.steaming.particles = new THREE.Geometry();\r\n      for (var i = 0; i < 25; i++) {\r\n        var particle = new THREE.Vector3(\r\n          Math.random() * Utils.randomRange(-2, 2),\r\n          Math.random() * 20,\r\n          Math.random() * Utils.randomRange(-2, 2));\r\n        potato.steaming.particles.vertices.push(particle);\r\n      }\r\n\r\n      var smokeTexture = ResourceManager.instance.getTexture(Globals.DIR + 'gfx/smoketex.jpg');\r\n      var smokeMaterial = new THREE.PointCloudMaterial({\r\n        map: smokeTexture,\r\n        transparent: true,\r\n        depthWrite: false,\r\n        blending: THREE.AdditiveBlending,\r\n        size: 2,\r\n        color: 0x111111\r\n      });\r\n\r\n      potato.steaming.system = new THREE.PointCloud(potato.steaming.particles, smokeMaterial);\r\n      potato.steaming.system.sortParticles = true;\r\n\r\n      potato.steaming.container = new THREE.Gyroscope();\r\n      potato.steaming.container.add(potato.steaming.system);\r\n      potato.drawable.mesh.add(potato.steaming.container);\r\n\r\n      if (options.callback) {\r\n        options.callback(potato);\r\n      }\r\n    }.bind(this));\r\n  },\r\n\r\n  makeFry: function(options) {\r\n    ResourceManager.instance.loadModel('models/fry.json', function(model) {\r\n      var fry = this.entities.createEntity();\r\n\r\n      fry.addTag(\"bullet\");\r\n      fry.addTag(\"fry\");\r\n\r\n      fry.addComponent(C.Identifier);\r\n      fry.addComponent(C.Position);\r\n      fry.addComponent(C.Drawable);\r\n      fry.addComponent(C.Bullet);\r\n      fry.addComponent(C.Expirable);\r\n      fry.addComponent(C.OneTimeHit);\r\n      fry.addComponent(C.Steaming);\r\n\r\n      fry.identifier.type = Globals.ENTITY_TYPES.bullet;\r\n      fry.bullet.owner = options.owner;\r\n\r\n      fry.drawable.scene = options.scene;\r\n\r\n      fry.drawable.mesh = new Physijs.BoxMesh(\r\n        model.geometry,\r\n        Physijs.createMaterial(model.material.clone(), 0.7, 0.01),\r\n        0.002);\r\n      fry.drawable.mesh.entity = fry;\r\n\r\n      // fries are \"hot\" when created, so tint them red\r\n      fry.drawable.mesh.material.materials.forEach(function(mat) {\r\n        mat.color.setHex(0xE34D4D);\r\n      });\r\n\r\n      if (options.owner === 'player') {\r\n        fry.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.playerBullet;\r\n      }\r\n      else {\r\n        fry.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemyBullet;\r\n      }\r\n\r\n      fry.drawable.mesh._physijs.collision_masks = (\r\n        EntityFactory.COLLISION_TYPES.obstacle |\r\n        EntityFactory.COLLISION_TYPES.enemy |\r\n        EntityFactory.COLLISION_TYPES.player |\r\n        EntityFactory.COLLISION_TYPES.playerBullet |\r\n        EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n      fry.drawable.mesh.position.copy(options.position);\r\n      fry.drawable.mesh.rotation.copy(options.rotation);\r\n      if (options.scale) {\r\n        fry.drawable.mesh.scale.copy(options.scale);\r\n      }\r\n\r\n      fry.drawable.scene.add(fry.drawable.mesh);\r\n\r\n      fry.drawable.mesh.setDamping(0.1, 0);\r\n\r\n      fry.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n        if (fry.bullet.isHot === false) {\r\n          return;\r\n        }\r\n\r\n        var hitPlayer = fry.bullet.owner === 'enemy' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.player;\r\n        var hitEnemy = fry.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy;\r\n\r\n        if ((hitPlayer || hitEnemy) && other_object.entity.hasComponent(C.Hurt) === false && fry.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          other_object.entity.addComponent(C.Hurt);\r\n          other_object.entity.hurt.originalColor = other_object.material.color.clone();\r\n\r\n          other_object.entity.health.hp -= 1;\r\n          other_object.entity.health.changed = true;\r\n\r\n          fry.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n        else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n          fry.bullet.touchedGround = true;\r\n        }\r\n        else if (fry.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && fry.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          Globals.instance.score += 5;\r\n\r\n          Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n          fry.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n\r\n        fry.bullet.isHot = other_object.entity.hasTag(\"fry\");\r\n\r\n        if (fry.bullet.isHot === false) {\r\n          // the fry is now \"cold,\" so tint it blue\r\n          fry.drawable.mesh.material.materials.forEach(function(mat) {\r\n            mat.color.setHex(0x45B7DE);\r\n          });\r\n        }\r\n      }.bind(this));\r\n\r\n      fry.position.x = options.position.x;\r\n      fry.position.y = options.position.y;\r\n      fry.position.z = options.position.z;\r\n\r\n      var vel = new THREE.Vector3(options.velocity, options.velocity, options.velocity);\r\n      vel.multiply(options.direction);\r\n      fry.drawable.mesh.applyCentralImpulse(vel);\r\n\r\n      fry.expirable.maxAge = 6;\r\n\r\n      fry.steaming.parent = fry.drawable.mesh;\r\n      fry.steaming.particles = new THREE.Geometry();\r\n      for (var i = 0; i < 25; i++) {\r\n        var particle = new THREE.Vector3(\r\n          Math.random() * Utils.randomRange(-2, 2),\r\n          Math.random() * 20,\r\n          Math.random() * Utils.randomRange(-2, 2));\r\n        fry.steaming.particles.vertices.push(particle);\r\n      }\r\n\r\n      var smokeTexture = ResourceManager.instance.getTexture(Globals.DIR + 'gfx/smoketex.jpg');\r\n      var smokeMaterial = new THREE.PointCloudMaterial({\r\n        map: smokeTexture,\r\n        transparent: true,\r\n        depthWrite: false,\r\n        blending: THREE.AdditiveBlending,\r\n        size: 2,\r\n        color: 0x111111\r\n      });\r\n\r\n      fry.steaming.system = new THREE.PointCloud(fry.steaming.particles, smokeMaterial);\r\n      fry.steaming.system.sortParticles = true;\r\n\r\n      fry.steaming.container = new THREE.Gyroscope();\r\n      fry.steaming.container.add(fry.steaming.system);\r\n      fry.drawable.mesh.add(fry.steaming.container);\r\n\r\n      if (options.callback) {\r\n        options.callback(fry);\r\n      }\r\n    }.bind(this));\r\n  },\r\n\r\n  makeGround: function(options) {\r\n    var ground = this.entities.createEntity();\r\n\r\n    ground.addComponent(C.Identifier);\r\n    ground.addComponent(C.Position);\r\n    ground.addComponent(C.Drawable);\r\n\r\n    ground.identifier.type = Globals.ENTITY_TYPES.ground;\r\n\r\n    ground.drawable.scene = options.scene;\r\n\r\n    var mainTex = ResourceManager.instance.getTexture(Globals.DIR + 'gfx/brick-floor-tileable_COLOR.jpg');\r\n    mainTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n    var diffuseTex = ResourceManager.instance.getTexture(Globals.DIR + 'gfx/brick-floor-tileable_DISP.jpg');\r\n    diffuseTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n    var specularTex = ResourceManager.instance.getTexture(Globals.DIR + 'gfx/brick-floor-tileable_SPEC.jpg');\r\n    specularTex.wrapS = mainTex.wrapT = THREE.RepeatWrapping;\r\n\r\n    ground.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(options.width, 1, options.height),\r\n      new THREE.MeshPhongMaterial({\r\n        map: mainTex,\r\n        displacementMap: diffuseTex,\r\n        specularMap: specularTex\r\n      }), 0);\r\n    ground.drawable.mesh.entity = ground;\r\n\r\n    ground.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.obstacle;\r\n    ground.drawable.mesh._physijs.collision_masks = (\r\n      EntityFactory.COLLISION_TYPES.obstacle |\r\n      EntityFactory.COLLISION_TYPES.player |\r\n      EntityFactory.COLLISION_TYPES.enemy |\r\n      EntityFactory.COLLISION_TYPES.playerBullet |\r\n      EntityFactory.COLLISION_TYPES.enemyBullet);\r\n\r\n    ground.drawable.scene.add(ground.drawable.mesh);\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!EntityFactory._instance) {\r\n        EntityFactory._instance = new EntityFactory();\r\n      }\r\n      return EntityFactory._instance;\r\n    },\r\n\r\n    COLLISION_TYPES: {\r\n      nothing: 0, // collide with nothing\r\n\r\n      obstacle: 1 << 0,\r\n      player: 1 << 2,\r\n      enemy: 1 << 3,\r\n\r\n      playerBullet: 1 << 4,\r\n      enemyBullet: 1 << 5\r\n    },\r\n\r\n    MOVE_SPEED: {\r\n      enemy: 160\r\n    },\r\n\r\n    MASS: {\r\n      player: 73,\r\n      enemy: 81,\r\n      bullet: 0.3\r\n    },\r\n\r\n    MIN_BULLET_SPEED: {\r\n      enemy: 25\r\n    },\r\n\r\n    MAX_BULLET_SPEED: {\r\n      enemy: 75\r\n    }\r\n  }\r\n});\r\n\r\n","var C = require('./Components.js');\r\n\r\nPlayerInputSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n\r\n    this.keyboard = new THREEx.KeyboardState();\r\n    this.jumped = false;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n      var dv = new THREE.Vector3(); // delta velocity\r\n\r\n      if (this.keyboard.pressed(\"w\")) {\r\n        dv.z = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"s\")) {\r\n        dv.z = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"a\")) {\r\n        dv.x = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"d\")) {\r\n        dv.x = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"space\") && entity.jump.canJump) {\r\n        dv.y = PlayerInputSystem.JUMP_FORCE;\r\n        entity.jump.canJump = false;\r\n      }\r\n\r\n      dv = dv.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      velocity.add(dv);\r\n\r\n      entity.velocity.x = velocity.x;\r\n      entity.velocity.y = velocity.y;\r\n      entity.velocity.z = velocity.z;\r\n\r\n      if (entity.shootDelay.canShoot) {\r\n        if (MouseController.instance.wasPressed.left) {\r\n          var direction = new THREE.Vector3();\r\n          entity.cameraFollow.controls.getDirection(direction);\r\n\r\n          var gunPos = new THREE.Vector3().setFromMatrixPosition(entity.gun.mesh.matrixWorld);\r\n          var bulletPos = gunPos.clone();\r\n          var bulletOffset = new THREE.Vector3(0, 0.4, -25);\r\n\r\n          var rotationMatrix = entity.velocity.rotationMatrix.clone();\r\n          var yMatrix = new THREE.Matrix4().extractRotation(entity.cameraFollow.controls.pitchObject.matrix);\r\n          rotationMatrix.multiply(yMatrix);\r\n\r\n          bulletOffset.applyMatrix4(rotationMatrix);\r\n          bulletPos.add(bulletOffset);\r\n\r\n          var bulletRot = entity.cameraFollow.object.rotation.clone();\r\n          bulletRot.y += 90 * Math.PI / 180;\r\n\r\n          EntityFactory.instance.makePotato({\r\n            scene: entity.drawable.scene,\r\n            position: bulletPos,\r\n            rotation: bulletRot,\r\n            direction: direction,\r\n            rotationMatrix: entity.velocity.rotationMatrix,\r\n            velocity: 35,\r\n            owner: 'player'\r\n          });\r\n\r\n          entity.shootDelay.canShoot = false;\r\n\r\n          Globals.instance.reloadImg.move_to(0);\r\n          Globals.instance.reloadImg.play();\r\n          Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n\r\n          var sound = Globals.instance.sound.getSound(Globals.DIR + 'sfx/arrowlessBow.mp3');\r\n          sound.setPosition(gunPos);\r\n          sound.setVelocity(velocity);\r\n          sound.setOrientation(direction);\r\n          sound.play();\r\n        }\r\n        else if (MouseController.instance.wasPressed.right) {\r\n          var baseDirection = new THREE.Vector3();\r\n          entity.cameraFollow.controls.getDirection(baseDirection);\r\n\r\n          var basePos = new THREE.Vector3().setFromMatrixPosition(entity.gun.mesh.matrixWorld);\r\n\r\n          var rotationMatrix = entity.velocity.rotationMatrix.clone();\r\n          var yMatrix = new THREE.Matrix4().extractRotation(entity.cameraFollow.controls.pitchObject.matrix);\r\n          rotationMatrix.multiply(yMatrix);\r\n\r\n          var bulletRot = entity.cameraFollow.object.rotation.clone();\r\n          bulletRot.y += 90 * Math.PI / 180;\r\n\r\n          for (var i = 0; i < Utils.randomRange(4, 9); i++) {\r\n            var bulletPos = basePos.clone();\r\n            var bulletOffset = new THREE.Vector3(Utils.randomRange(-1, 1), Utils.randomRange(-1, 1), -30);\r\n\r\n            bulletOffset.applyMatrix4(rotationMatrix);\r\n            bulletPos.add(bulletOffset);\r\n\r\n            var piOver2 = Math.PI / 2;\r\n\r\n            bulletRot.x += Utils.randomRange(-piOver2, piOver2);\r\n            bulletRot.z += Utils.randomRange(-piOver2, piOver2);\r\n\r\n            var bulletDirection = baseDirection.clone();\r\n            bulletDirection.x += Utils.randomRange(-0.2, 0.2);\r\n            bulletDirection.y += Utils.randomRange(-0.1, 0.2);\r\n            bulletDirection.z += Utils.randomRange(-0.2, 0.2);\r\n\r\n            EntityFactory.instance.makeFry({\r\n              scene: entity.drawable.scene,\r\n              position: bulletPos,\r\n              rotation: bulletRot,\r\n              direction: bulletDirection,\r\n              rotationMatrix: entity.velocity.rotationMatrix,\r\n              velocity: 0.5,\r\n              owner: 'player'\r\n            });\r\n          }\r\n\r\n          entity.shootDelay.canShoot = false;\r\n\r\n          Globals.instance.reloadImg.move_to(0);\r\n          Globals.instance.reloadImg.play();\r\n          Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n\r\n          var sound = Globals.instance.sound.getSound(Globals.DIR + 'sfx/arrowlessBow.mp3');\r\n          sound.setPosition(basePos);\r\n          sound.setVelocity(velocity);\r\n          sound.setOrientation(baseDirection);\r\n          sound.play();\r\n        }\r\n      }\r\n    }.bind(this));\r\n  }\r\n}, {\r\n  statics: {\r\n    MOVE_SPEED: 120,\r\n    JUMP_FORCE: 2500\r\n  }\r\n});\r\n\r\nMovementSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n\r\n      if (entity.velocity.doMove === false) {\r\n        return;\r\n      }\r\n\r\n      if (entity.hasComponent(C.Drawable)) {\r\n        entity.drawable.mesh.applyCentralImpulse(velocity);\r\n        //entity.drawable.mesh.setLinearVelocity(entity.velocity);\r\n      }\r\n      else {\r\n        entity.position.x += velocity.x * dt;\r\n        entity.position.y += velocity.y * dt;\r\n        entity.position.z += velocity.z * dt;\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nExpirableSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var expirables = this.entities.queryComponents([C.Expirable]);\r\n\r\n    expirables.forEach(function(entity) {\r\n      entity.expirable.age += dt;\r\n\r\n      if (entity.expirable.age >= entity.expirable.maxAge) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nCameraFollowSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var follows = this.entities.queryComponents([C.CameraFollow, C.Position, C.Velocity]);\r\n\r\n    if (follows.length > 1) {\r\n      throw new Error(\"The camera can only follow one object at a time!\");\r\n    }\r\n\r\n    follows.forEach(function(entity) {\r\n      if (entity.velocity.rotationMatrix === null) {\r\n        return;\r\n      }\r\n\r\n      var offset = entity.cameraFollow.offset.clone();\r\n      offset = offset.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      entity.cameraFollow.object.position.x = entity.position.x + offset.x;\r\n      entity.cameraFollow.object.position.y = entity.position.y + offset.y;\r\n      entity.cameraFollow.object.position.z = entity.position.z + offset.z;\r\n\r\n      entity.drawable.mesh.rotation.x = entity.cameraFollow.object.rotation.x;\r\n      entity.drawable.mesh.rotation.y = entity.cameraFollow.object.rotation.y;\r\n      entity.drawable.mesh.rotation.z = entity.cameraFollow.object.rotation.z;\r\n    });\r\n  }\r\n});\r\n\r\nShootDelaySystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var shooters = this.entities.queryComponents([C.ShootDelay]);\r\n\r\n    shooters.forEach(function(entity) {\r\n      if (entity.shootDelay.canShoot === false) {\r\n        entity.shootDelay.timer += dt;\r\n\r\n        if (entity.shootDelay.timer > entity.shootDelay.delayTheshold) {\r\n          entity.shootDelay.canShoot = true;\r\n          entity.shootDelay.timer = 0;\r\n\r\n          Globals.instance.reloadImg.pause();\r\n          Globals.instance.reloadingElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nHurtSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var hurtables = this.entities.queryComponents([C.Hurt, C.Drawable]);\r\n\r\n    hurtables.forEach(function(entity) {\r\n      entity.hurt.timer += dt;\r\n\r\n      if (entity.hurt.timer < entity.hurt.invulnerabilityFrames) {\r\n        entity.drawable.mesh.material.color = entity.hurt.hurtColor;\r\n\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.backgroundColor = \"#bb0000\";\r\n          Globals.instance.overlayElement.style.visibility = \"visible\";\r\n        }\r\n      }\r\n      else {\r\n        entity.drawable.mesh.material.color = entity.hurt.originalColor;\r\n\r\n        entity.removeComponent(C.Hurt);\r\n\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nPlayerHealthSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n\r\n    this.keyboard = new THREEx.KeyboardState();\r\n    this.jumped = false;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      if (entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n      var percentRounded = Math.round(percent * 100);\r\n\r\n      var healthElement = Globals.instance.healthElement;\r\n      var color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      healthElement.innerHTML = percentRounded + \"%\";\r\n      healthElement.style.color = \"#\" + color.getHexString();\r\n    });\r\n  }\r\n});\r\n\r\nHealthBarSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.healthBar === null || entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n\r\n      entity.health.healthBar.scale.x = percent;\r\n      entity.health.healthBar.material.color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      entity.health.changed = false;\r\n    });\r\n  }\r\n});\r\n\r\nDeathSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.hp <= 0) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          if (entity.drawable.mesh._physijs.collision_type === EntityFactory.COLLISION_TYPES.enemy) {\r\n            Globals.instance.score += 10;\r\n\r\n            Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n          }\r\n\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nAISystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var singularities = this.entities.queryComponents([C.AI]);\r\n\r\n    singularities.forEach(function(entity) {\r\n      if (entity.ai.tree === null || entity.ai.target === null || entity.ai.blackboard === null) {\r\n        return;\r\n      }\r\n\r\n      entity.ai.tree.tick(entity.ai.target, entity.ai.blackboard);\r\n    });\r\n  }\r\n});\r\n\r\nSteamUpdateSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var steaming = this.entities.queryComponents([C.Steaming]);\r\n\r\n    steaming.forEach(function(entity) {\r\n      var particles = entity.steaming.particles;\r\n\r\n      var particleCount = particles.vertices.length;\r\n      while (particleCount--) {\r\n        var particle = particles.vertices[particleCount];\r\n        particle.y += dt * 50;\r\n\r\n        if (particle.y >= 5 + Utils.randomRange(-2, 4)) {\r\n          particle.y = Math.random();\r\n          particle.x = Math.random() * Utils.randomRange(-2, 2);\r\n          particle.z = Math.random() * Utils.randomRange(-2, 2);\r\n        }\r\n      }\r\n\r\n      particles.verticesNeedUpdate = true;\r\n    });\r\n  }\r\n});\r\n\r\nSteamRemovalSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var steaming = this.entities.queryComponents([C.Steaming, C.Bullet, C.Drawable]);\r\n\r\n    steaming.forEach(function(entity) {\r\n      if (entity.bullet.isHot === false) {\r\n        entity.drawable.mesh.remove(entity.steaming.container);\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nCameraPitchSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var pitchables = this.entities.queryComponents([C.CameraPitch, C.Drawable]);\r\n\r\n    pitchables.forEach(function(entity) {\r\n      entity.drawable.mesh.rotation.x = entity.cameraPitch.controls.pitchObject.rotation.x + entity.cameraPitch.offset;\r\n    });\r\n  }\r\n});\r\n\r\nPhysicsUpdateSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity, C.Drawable]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      entity.position.x = entity.drawable.mesh.position.x;\r\n      entity.position.y = entity.drawable.mesh.position.y;\r\n      entity.position.z = entity.drawable.mesh.position.z;\r\n\r\n      entity.velocity.x = entity.drawable.mesh.getLinearVelocity().x;\r\n      entity.velocity.y = entity.drawable.mesh.getLinearVelocity().y;\r\n      entity.velocity.z = entity.drawable.mesh.getLinearVelocity().z;\r\n\r\n      entity.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(entity.drawable.mesh.matrix);\r\n    });\r\n  }\r\n});\r\n\r\n","// http://www.html5rocks.com/en/tutorials/webaudio/intro/\r\n// http://www.html5rocks.com/en/tutorials/webaudio/positional_audio/\r\n\r\nSound = Class({\r\n  constructor: function(options) {\r\n    this.context = options.context;\r\n    this.source = this.context.createBufferSource();\r\n    this.volume = this.context.createGain();\r\n    this.panner = this.context.createPanner();\r\n\r\n    this.volume.connect(this.panner);\r\n    this.panner.connect(options.mainVolume);\r\n\r\n    this.source.loop = options.loop || false;\r\n\r\n    var self = this;\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open(\"GET\", options.path, true);\r\n    request.responseType = \"arraybuffer\";\r\n    request.onload = function(e) {\r\n      self.context.decodeAudioData(this.response, function onSuccess(buffer) {\r\n        self.buffer = buffer;\r\n\r\n        self.source.buffer = self.buffer;\r\n\r\n        if (options.callback) {\r\n          options.callback(self);\r\n        }\r\n      }, function onFailure() {\r\n        alert(\"Decoding the audio buffer failed\");\r\n      });\r\n    };\r\n    request.send();\r\n  },\r\n\r\n  setPosition: function(position) {\r\n    this.panner.setPosition(position.x, position.y, position.z);\r\n  },\r\n\r\n  setVelocity: function(velocity) {\r\n    this.panner.setVelocity(velocity.x, velocity.y, velocity.z);\r\n  },\r\n\r\n  setOrientation: function(orientation) {\r\n    this.panner.setOrientation(orientation.x, orientation.y, orientation.z);\r\n  },\r\n\r\n  setVolume: function(volume) {\r\n    this.volume.gain = volume;\r\n  },\r\n\r\n  play: function(startTime) {\r\n    this.source = this.context.createBufferSource();\r\n    this.source.buffer = this.buffer;\r\n    this.source.connect(this.volume);\r\n    this.source.start(startTime || 0);\r\n  }\r\n});\r\n\r\nSoundController = Class({\r\n  constructor: function(options) {\r\n    this.context = options.context;\r\n\r\n    this.mainVolume = this.context.createGain();\r\n    this.mainVolume.connect(this.context.destination);\r\n\r\n    this.following = options.following;\r\n\r\n    this.sounds = {};\r\n  },\r\n\r\n  update: function(dt) {\r\n    var position = new THREE.Vector3().setFromMatrixPosition(this.following.matrixWorld);\r\n    this.setListenerPosition(position);\r\n\r\n    var orientation = new THREE.Vector3(0, 0, 1);\r\n    orientation.applyProjection(this.following.matrix);\r\n    orientation.normalize();\r\n\r\n    var up = new THREE.Vector3(0, -1, 0);\r\n    up.applyProjection(this.following.matrix);\r\n    up.normalize();\r\n\r\n    this.setListenerOrientation(orientation, up);\r\n  },\r\n\r\n  loadSound: function(path, callback) {\r\n    if (path in this.sounds) {\r\n      throw new Error(\"The sound located at \" + path + \" is already loaded\");\r\n    }\r\n\r\n    this.sounds[path] = new Sound({\r\n      context: this.context,\r\n      mainVolume: this.mainVolume,\r\n      path: path,\r\n      callback: callback\r\n    });\r\n  },\r\n\r\n  getSound: function(path) {\r\n    if (path in this.sounds) {\r\n      return this.sounds[path];\r\n    }\r\n\r\n    throw new Error(\"The sound located at \" + path + \" is not loaded\");\r\n  },\r\n\r\n  setListenerPosition: function(position) {\r\n    this.context.listener.setPosition(position.x, position.y, position.z);\r\n  },\r\n\r\n  setListenerOrientation: function(orientation, up) {\r\n    this.context.listener.setOrientation(orientation.x, orientation.y, orientation.z, up.x, up.y, up.z);\r\n  }\r\n});\r\n\r\n","MouseController = Class({\r\n  constructor: function() {\r\n    this.isDown = {\r\n      left: false,\r\n      right: false\r\n    };\r\n\r\n    this.wasPressed = {\r\n      left: false,\r\n      right: false\r\n    };\r\n  },\r\n\r\n  update: function(dt) {\r\n    this.wasPressed.left = false;\r\n    this.wasPressed.right = false;\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!MouseController._instance) {\r\n        MouseController._instance = new MouseController();\r\n      }\r\n      return MouseController._instance;\r\n    }\r\n  }\r\n});\r\n\r\n","/*!\n *  howler.js v1.1.28\n *  howlerjs.com\n *\n *  (c) 2013-2015, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n(function() {\n  // setup\n  var cache = {};\n\n  // setup the audio context\n  var ctx = null,\n    usingWebAudio = true,\n    noAudio = false;\n  try {\n    if (typeof AudioContext !== 'undefined') {\n      ctx = new AudioContext();\n    } else if (typeof webkitAudioContext !== 'undefined') {\n      ctx = new webkitAudioContext();\n    } else {\n      usingWebAudio = false;\n    }\n  } catch(e) {\n    usingWebAudio = false;\n  }\n\n  if (!usingWebAudio) {\n    if (typeof Audio !== 'undefined') {\n      try {\n        new Audio();\n      } catch(e) {\n        noAudio = true;\n      }\n    } else {\n      noAudio = true;\n    }\n  }\n\n  // create a master gain node\n  if (usingWebAudio) {\n    var masterGain = (typeof ctx.createGain === 'undefined') ? ctx.createGainNode() : ctx.createGain();\n    masterGain.gain.value = 1;\n    masterGain.connect(ctx.destination);\n  }\n\n  // create global controller\n  var HowlerGlobal = function(codecs) {\n    this._volume = 1;\n    this._muted = false;\n    this.usingWebAudio = usingWebAudio;\n    this.ctx = ctx;\n    this.noAudio = noAudio;\n    this._howls = [];\n    this._codecs = codecs;\n    this.iOSAutoEnable = true;\n  };\n  HowlerGlobal.prototype = {\n    /**\n     * Get/set the global volume for all sounds.\n     * @param  {Float} vol Volume from 0.0 to 1.0.\n     * @return {Howler/Float}     Returns self or current volume.\n     */\n    volume: function(vol) {\n      var self = this;\n\n      // make sure volume is a number\n      vol = parseFloat(vol);\n\n      if (vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        if (usingWebAudio) {\n          masterGain.gain.value = vol;\n        }\n\n        // loop through cache and change volume of all nodes that are using HTML5 Audio\n        for (var key in self._howls) {\n          if (self._howls.hasOwnProperty(key) && self._howls[key]._webAudio === false) {\n            // loop through the audio nodes\n            for (var i=0; i<self._howls[key]._audioNode.length; i++) {\n              self._howls[key]._audioNode[i].volume = self._howls[key]._volume * self._volume;\n            }\n          }\n        }\n\n        return self;\n      }\n\n      // return the current global volume\n      return (usingWebAudio) ? masterGain.gain.value : self._volume;\n    },\n\n    /**\n     * Mute all sounds.\n     * @return {Howler}\n     */\n    mute: function() {\n      this._setMuted(true);\n\n      return this;\n    },\n\n    /**\n     * Unmute all sounds.\n     * @return {Howler}\n     */\n    unmute: function() {\n      this._setMuted(false);\n\n      return this;\n    },\n\n    /**\n     * Handle muting and unmuting globally.\n     * @param  {Boolean} muted Is muted or not.\n     */\n    _setMuted: function(muted) {\n      var self = this;\n\n      self._muted = muted;\n\n      if (usingWebAudio) {\n        masterGain.gain.value = muted ? 0 : self._volume;\n      }\n\n      for (var key in self._howls) {\n        if (self._howls.hasOwnProperty(key) && self._howls[key]._webAudio === false) {\n          // loop through the audio nodes\n          for (var i=0; i<self._howls[key]._audioNode.length; i++) {\n            self._howls[key]._audioNode[i].muted = muted;\n          }\n        }\n      }\n    },\n\n    /**\n     * Check for codec support.\n     * @param  {String} ext Audio file extention.\n     * @return {Boolean}\n     */\n    codecs: function(ext) {\n      return this._codecs[ext];\n    },\n\n    /**\n     * iOS will only allow audio to be played after a user interaction.\n     * Attempt to automatically unlock audio on the first user interaction.\n     * Concept from: http://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     * @return {Howler}\n     */\n    _enableiOSAudio: function() {\n      var self = this;\n\n      // only run this on iOS if audio isn't already eanbled\n      if (ctx && (self._iOSEnabled || !/iPhone|iPad|iPod/i.test(navigator.userAgent))) {\n        return;\n      }\n\n      self._iOSEnabled = false;\n\n      // call this method on touch start to create and play a buffer,\n      // then check if the audio actually played to determine if\n      // audio has now been unlocked on iOS\n      var unlock = function() {\n        // create an empty buffer\n        var buffer = ctx.createBuffer(1, 1, 22050);\n        var source = ctx.createBufferSource();\n        source.buffer = buffer;\n        source.connect(ctx.destination);\n\n        // play the empty buffer\n        if (typeof source.start === 'undefined') {\n          source.noteOn(0);\n        } else {\n          source.start(0);\n        }\n\n        // setup a timeout to check that we are unlocked on the next event loop\n        setTimeout(function() {\n          if ((source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE)) {\n            // update the unlocked state and prevent this check from happening again\n            self._iOSEnabled = true;\n            self.iOSAutoEnable = false;\n\n            // remove the touch start listener\n            window.removeEventListener('touchend', unlock, false);\n          }\n        }, 0);\n      };\n\n      // setup a touch start listener to attempt an unlock in\n      window.addEventListener('touchend', unlock, false);\n\n      return self;\n    }\n  };\n\n  // check for browser codec support\n  var audioTest = null;\n  var codecs = {};\n  if (!noAudio) {\n    audioTest = new Audio();\n    codecs = {\n      mp3: !!audioTest.canPlayType('audio/mpeg;').replace(/^no$/, ''),\n      opus: !!audioTest.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\n      ogg: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n      wav: !!audioTest.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\n      aac: !!audioTest.canPlayType('audio/aac;').replace(/^no$/, ''),\n      m4a: !!(audioTest.canPlayType('audio/x-m4a;') || audioTest.canPlayType('audio/m4a;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n      mp4: !!(audioTest.canPlayType('audio/x-mp4;') || audioTest.canPlayType('audio/mp4;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n      weba: !!audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')\n    };\n  }\n\n  // allow access to the global audio controls\n  var Howler = new HowlerGlobal(codecs);\n\n  // setup the audio object\n  var Howl = function(o) {\n    var self = this;\n\n    // setup the defaults\n    self._autoplay = o.autoplay || false;\n    self._buffer = o.buffer || false;\n    self._duration = o.duration || 0;\n    self._format = o.format || null;\n    self._loop = o.loop || false;\n    self._loaded = false;\n    self._sprite = o.sprite || {};\n    self._src = o.src || '';\n    self._pos3d = o.pos3d || [0, 0, -0.5];\n    self._volume = o.volume !== undefined ? o.volume : 1;\n    self._urls = o.urls || [];\n    self._rate = o.rate || 1;\n\n    // allow forcing of a specific panningModel ('equalpower' or 'HRTF'),\n    // if none is specified, defaults to 'equalpower' and switches to 'HRTF'\n    // if 3d sound is used\n    self._model = o.model || null;\n\n    // setup event functions\n    self._onload = [o.onload || function() {}];\n    self._onloaderror = [o.onloaderror || function() {}];\n    self._onend = [o.onend || function() {}];\n    self._onpause = [o.onpause || function() {}];\n    self._onplay = [o.onplay || function() {}];\n\n    self._onendTimer = [];\n\n    // Web Audio or HTML5 Audio?\n    self._webAudio = usingWebAudio && !self._buffer;\n\n    // check if we need to fall back to HTML5 Audio\n    self._audioNode = [];\n    if (self._webAudio) {\n      self._setupAudioNode();\n    }\n\n    // automatically try to enable audio on iOS\n    if (typeof ctx !== 'undefined' && ctx && Howler.iOSAutoEnable) {\n      Howler._enableiOSAudio();\n    }\n\n    // add this to an array of Howl's to allow global control\n    Howler._howls.push(self);\n\n    // load the track\n    self.load();\n  };\n\n  // setup all of the methods\n  Howl.prototype = {\n    /**\n     * Load an audio file.\n     * @return {Howl}\n     */\n    load: function() {\n      var self = this,\n        url = null;\n\n      // if no audio is available, quit immediately\n      if (noAudio) {\n        self.on('loaderror');\n        return;\n      }\n\n      // loop through source URLs and pick the first one that is compatible\n      for (var i=0; i<self._urls.length; i++) {\n        var ext, urlItem;\n\n        if (self._format) {\n          // use specified audio format if available\n          ext = self._format;\n        } else {\n          // figure out the filetype (whether an extension or base64 data)\n          urlItem = self._urls[i];\n          ext = /^data:audio\\/([^;,]+);/i.exec(urlItem);\n          if (!ext) {\n            ext = /\\.([^.]+)$/.exec(urlItem.split('?', 1)[0]);\n          }\n\n          if (ext) {\n            ext = ext[1].toLowerCase();\n          } else {\n            self.on('loaderror');\n            return;\n          }\n        }\n\n        if (codecs[ext]) {\n          url = self._urls[i];\n          break;\n        }\n      }\n\n      if (!url) {\n        self.on('loaderror');\n        return;\n      }\n\n      self._src = url;\n\n      if (self._webAudio) {\n        loadBuffer(self, url);\n      } else {\n        var newNode = new Audio();\n\n        // listen for errors with HTML5 audio (http://dev.w3.org/html5/spec-author-view/spec.html#mediaerror)\n        newNode.addEventListener('error', function () {\n          if (newNode.error && newNode.error.code === 4) {\n            HowlerGlobal.noAudio = true;\n          }\n\n          self.on('loaderror', {type: newNode.error ? newNode.error.code : 0});\n        }, false);\n\n        self._audioNode.push(newNode);\n\n        // setup the new audio node\n        newNode.src = url;\n        newNode._pos = 0;\n        newNode.preload = 'auto';\n        newNode.volume = (Howler._muted) ? 0 : self._volume * Howler.volume();\n\n        // setup the event listener to start playing the sound\n        // as soon as it has buffered enough\n        var listener = function() {\n          // round up the duration when using HTML5 Audio to account for the lower precision\n          self._duration = Math.ceil(newNode.duration * 10) / 10;\n\n          // setup a sprite if none is defined\n          if (Object.getOwnPropertyNames(self._sprite).length === 0) {\n            self._sprite = {_default: [0, self._duration * 1000]};\n          }\n\n          if (!self._loaded) {\n            self._loaded = true;\n            self.on('load');\n          }\n\n          if (self._autoplay) {\n            self.play();\n          }\n\n          // clear the event listener\n          newNode.removeEventListener('canplaythrough', listener, false);\n        };\n        newNode.addEventListener('canplaythrough', listener, false);\n        newNode.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the URLs to be pulled from to play in this source.\n     * @param  {Array} urls  Arry of URLs to load from\n     * @return {Howl}        Returns self or the current URLs\n     */\n    urls: function(urls) {\n      var self = this;\n\n      if (urls) {\n        self.stop();\n        self._urls = (typeof urls === 'string') ? [urls] : urls;\n        self._loaded = false;\n        self.load();\n\n        return self;\n      } else {\n        return self._urls;\n      }\n    },\n\n    /**\n     * Play a sound from the current time (0 by default).\n     * @param  {String}   sprite   (optional) Plays from the specified position in the sound sprite definition.\n     * @param  {Function} callback (optional) Returns the unique playback id for this sound instance.\n     * @return {Howl}\n     */\n    play: function(sprite, callback) {\n      var self = this;\n\n      // if no sprite was passed but a callback was, update the variables\n      if (typeof sprite === 'function') {\n        callback = sprite;\n      }\n\n      // use the default sprite if none is passed\n      if (!sprite || typeof sprite === 'function') {\n        sprite = '_default';\n      }\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('load', function() {\n          self.play(sprite, callback);\n        });\n\n        return self;\n      }\n\n      // if the sprite doesn't exist, play nothing\n      if (!self._sprite[sprite]) {\n        if (typeof callback === 'function') callback();\n        return self;\n      }\n\n      // get the node to playback\n      self._inactiveNode(function(node) {\n        // persist the sprite being played\n        node._sprite = sprite;\n\n        // determine where to start playing from\n        var pos = (node._pos > 0) ? node._pos : self._sprite[sprite][0] / 1000;\n\n        // determine how long to play for\n        var duration = 0;\n        if (self._webAudio) {\n          duration = self._sprite[sprite][1] / 1000 - node._pos;\n          if (node._pos > 0) {\n            pos = self._sprite[sprite][0] / 1000 + pos;\n          }\n        } else {\n          duration = self._sprite[sprite][1] / 1000 - (pos - self._sprite[sprite][0] / 1000);\n        }\n\n        // determine if this sound should be looped\n        var loop = !!(self._loop || self._sprite[sprite][2]);\n\n        // set timer to fire the 'onend' event\n        var soundId = (typeof callback === 'string') ? callback : Math.round(Date.now() * Math.random()) + '',\n          timerId;\n        (function() {\n          var data = {\n            id: soundId,\n            sprite: sprite,\n            loop: loop\n          };\n          timerId = setTimeout(function() {\n            // if looping, restart the track\n            if (!self._webAudio && loop) {\n              self.stop(data.id).play(sprite, data.id);\n            }\n\n            // set web audio node to paused at end\n            if (self._webAudio && !loop) {\n              self._nodeById(data.id).paused = true;\n              self._nodeById(data.id)._pos = 0;\n\n              // clear the end timer\n              self._clearEndTimer(data.id);\n            }\n\n            // end the track if it is HTML audio and a sprite\n            if (!self._webAudio && !loop) {\n              self.stop(data.id);\n            }\n\n            // fire ended event\n            self.on('end', soundId);\n          }, duration * 1000);\n\n          // store the reference to the timer\n          self._onendTimer.push({timer: timerId, id: data.id});\n        })();\n\n        if (self._webAudio) {\n          var loopStart = self._sprite[sprite][0] / 1000,\n            loopEnd = self._sprite[sprite][1] / 1000;\n\n          // set the play id to this node and load into context\n          node.id = soundId;\n          node.paused = false;\n          refreshBuffer(self, [loop, loopStart, loopEnd], soundId);\n          self._playStart = ctx.currentTime;\n          node.gain.value = self._volume;\n\n          if (typeof node.bufferSource.start === 'undefined') {\n            loop ? node.bufferSource.noteGrainOn(0, pos, 86400) : node.bufferSource.noteGrainOn(0, pos, duration);\n          } else {\n            loop ? node.bufferSource.start(0, pos, 86400) : node.bufferSource.start(0, pos, duration);\n          }\n        } else {\n          if (node.readyState === 4 || !node.readyState && navigator.isCocoonJS) {\n            node.readyState = 4;\n            node.id = soundId;\n            node.currentTime = pos;\n            node.muted = Howler._muted || node.muted;\n            node.volume = self._volume * Howler.volume();\n            setTimeout(function() { node.play(); }, 0);\n          } else {\n            self._clearEndTimer(soundId);\n\n            (function(){\n              var sound = self,\n                playSprite = sprite,\n                fn = callback,\n                newNode = node;\n              var listener = function() {\n                sound.play(playSprite, fn);\n\n                // clear the event listener\n                newNode.removeEventListener('canplaythrough', listener, false);\n              };\n              newNode.addEventListener('canplaythrough', listener, false);\n            })();\n\n            return self;\n          }\n        }\n\n        // fire the play event and send the soundId back in the callback\n        self.on('play');\n        if (typeof callback === 'function') callback(soundId);\n\n        return self;\n      });\n\n      return self;\n    },\n\n    /**\n     * Pause playback and save the current position.\n     * @param {String} id (optional) The play instance ID.\n     * @return {Howl}\n     */\n    pause: function(id) {\n      var self = this;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('play', function() {\n          self.pause(id);\n        });\n\n        return self;\n      }\n\n      // clear 'onend' timer\n      self._clearEndTimer(id);\n\n      var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n      if (activeNode) {\n        activeNode._pos = self.pos(null, id);\n\n        if (self._webAudio) {\n          // make sure the sound has been created\n          if (!activeNode.bufferSource || activeNode.paused) {\n            return self;\n          }\n\n          activeNode.paused = true;\n          if (typeof activeNode.bufferSource.stop === 'undefined') {\n            activeNode.bufferSource.noteOff(0);\n          } else {\n            activeNode.bufferSource.stop(0);\n          }\n        } else {\n          activeNode.pause();\n        }\n      }\n\n      self.on('pause');\n\n      return self;\n    },\n\n    /**\n     * Stop playback and reset to start.\n     * @param  {String} id  (optional) The play instance ID.\n     * @return {Howl}\n     */\n    stop: function(id) {\n      var self = this;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('play', function() {\n          self.stop(id);\n        });\n\n        return self;\n      }\n\n      // clear 'onend' timer\n      self._clearEndTimer(id);\n\n      var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n      if (activeNode) {\n        activeNode._pos = 0;\n\n        if (self._webAudio) {\n          // make sure the sound has been created\n          if (!activeNode.bufferSource || activeNode.paused) {\n            return self;\n          }\n\n          activeNode.paused = true;\n\n          if (typeof activeNode.bufferSource.stop === 'undefined') {\n            activeNode.bufferSource.noteOff(0);\n          } else {\n            activeNode.bufferSource.stop(0);\n          }\n        } else if (!isNaN(activeNode.duration)) {\n          activeNode.pause();\n          activeNode.currentTime = 0;\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Mute this sound.\n     * @param  {String} id (optional) The play instance ID.\n     * @return {Howl}\n     */\n    mute: function(id) {\n      var self = this;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('play', function() {\n          self.mute(id);\n        });\n\n        return self;\n      }\n\n      var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n      if (activeNode) {\n        if (self._webAudio) {\n          activeNode.gain.value = 0;\n        } else {\n          activeNode.muted = true;\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Unmute this sound.\n     * @param  {String} id (optional) The play instance ID.\n     * @return {Howl}\n     */\n    unmute: function(id) {\n      var self = this;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('play', function() {\n          self.unmute(id);\n        });\n\n        return self;\n      }\n\n      var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n      if (activeNode) {\n        if (self._webAudio) {\n          activeNode.gain.value = self._volume;\n        } else {\n          activeNode.muted = false;\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set volume of this sound.\n     * @param  {Float}  vol Volume from 0.0 to 1.0.\n     * @param  {String} id  (optional) The play instance ID.\n     * @return {Howl/Float}     Returns self or current volume.\n     */\n    volume: function(vol, id) {\n      var self = this;\n\n      // make sure volume is a number\n      vol = parseFloat(vol);\n\n      if (vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        // if the sound hasn't been loaded, add it to the event queue\n        if (!self._loaded) {\n          self.on('play', function() {\n            self.volume(vol, id);\n          });\n\n          return self;\n        }\n\n        var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n        if (activeNode) {\n          if (self._webAudio) {\n            activeNode.gain.value = vol;\n          } else {\n            activeNode.volume = vol * Howler.volume();\n          }\n        }\n\n        return self;\n      } else {\n        return self._volume;\n      }\n    },\n\n    /**\n     * Get/set whether to loop the sound.\n     * @param  {Boolean} loop To loop or not to loop, that is the question.\n     * @return {Howl/Boolean}      Returns self or current looping value.\n     */\n    loop: function(loop) {\n      var self = this;\n\n      if (typeof loop === 'boolean') {\n        self._loop = loop;\n\n        return self;\n      } else {\n        return self._loop;\n      }\n    },\n\n    /**\n     * Get/set sound sprite definition.\n     * @param  {Object} sprite Example: {spriteName: [offset, duration, loop]}\n     *                @param {Integer} offset   Where to begin playback in milliseconds\n     *                @param {Integer} duration How long to play in milliseconds\n     *                @param {Boolean} loop     (optional) Set true to loop this sprite\n     * @return {Howl}        Returns current sprite sheet or self.\n     */\n    sprite: function(sprite) {\n      var self = this;\n\n      if (typeof sprite === 'object') {\n        self._sprite = sprite;\n\n        return self;\n      } else {\n        return self._sprite;\n      }\n    },\n\n    /**\n     * Get/set the position of playback.\n     * @param  {Float}  pos The position to move current playback to.\n     * @param  {String} id  (optional) The play instance ID.\n     * @return {Howl/Float}      Returns self or current playback position.\n     */\n    pos: function(pos, id) {\n      var self = this;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('load', function() {\n          self.pos(pos);\n        });\n\n        return typeof pos === 'number' ? self : self._pos || 0;\n      }\n\n      // make sure we are dealing with a number for pos\n      pos = parseFloat(pos);\n\n      var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n      if (activeNode) {\n        if (pos >= 0) {\n          self.pause(id);\n          activeNode._pos = pos;\n          self.play(activeNode._sprite, id);\n\n          return self;\n        } else {\n          return self._webAudio ? activeNode._pos + (ctx.currentTime - self._playStart) : activeNode.currentTime;\n        }\n      } else if (pos >= 0) {\n        return self;\n      } else {\n        // find the first inactive node to return the pos for\n        for (var i=0; i<self._audioNode.length; i++) {\n          if (self._audioNode[i].paused && self._audioNode[i].readyState === 4) {\n            return (self._webAudio) ? self._audioNode[i]._pos : self._audioNode[i].currentTime;\n          }\n        }\n      }\n    },\n\n    /**\n     * Get/set the 3D position of the audio source.\n     * The most common usage is to set the 'x' position\n     * to affect the left/right ear panning. Setting any value higher than\n     * 1.0 will begin to decrease the volume of the sound as it moves further away.\n     * NOTE: This only works with Web Audio API, HTML5 Audio playback\n     * will not be affected.\n     * @param  {Float}  x  The x-position of the playback from -1000.0 to 1000.0\n     * @param  {Float}  y  The y-position of the playback from -1000.0 to 1000.0\n     * @param  {Float}  z  The z-position of the playback from -1000.0 to 1000.0\n     * @param  {String} id (optional) The play instance ID.\n     * @return {Howl/Array}   Returns self or the current 3D position: [x, y, z]\n     */\n    pos3d: function(x, y, z, id) {\n      var self = this;\n\n      // set a default for the optional 'y' & 'z'\n      y = (typeof y === 'undefined' || !y) ? 0 : y;\n      z = (typeof z === 'undefined' || !z) ? -0.5 : z;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('play', function() {\n          self.pos3d(x, y, z, id);\n        });\n\n        return self;\n      }\n\n      if (x >= 0 || x < 0) {\n        if (self._webAudio) {\n          var activeNode = (id) ? self._nodeById(id) : self._activeNode();\n          if (activeNode) {\n            self._pos3d = [x, y, z];\n            activeNode.panner.setPosition(x, y, z);\n            activeNode.panner.panningModel = self._model || 'HRTF';\n          }\n        }\n      } else {\n        return self._pos3d;\n      }\n\n      return self;\n    },\n\n    /**\n     * Fade a currently playing sound between two volumes.\n     * @param  {Number}   from     The volume to fade from (0.0 to 1.0).\n     * @param  {Number}   to       The volume to fade to (0.0 to 1.0).\n     * @param  {Number}   len      Time in milliseconds to fade.\n     * @param  {Function} callback (optional) Fired when the fade is complete.\n     * @param  {String}   id       (optional) The play instance ID.\n     * @return {Howl}\n     */\n    fade: function(from, to, len, callback, id) {\n      var self = this,\n        diff = Math.abs(from - to),\n        dir = from > to ? 'down' : 'up',\n        steps = diff / 0.01,\n        stepTime = len / steps;\n\n      // if the sound hasn't been loaded, add it to the event queue\n      if (!self._loaded) {\n        self.on('load', function() {\n          self.fade(from, to, len, callback, id);\n        });\n\n        return self;\n      }\n\n      // set the volume to the start position\n      self.volume(from, id);\n\n      for (var i=1; i<=steps; i++) {\n        (function() {\n          var change = self._volume + (dir === 'up' ? 0.01 : -0.01) * i,\n            vol = Math.round(1000 * change) / 1000,\n            toVol = to;\n\n          setTimeout(function() {\n            self.volume(vol, id);\n\n            if (vol === toVol) {\n              if (callback) callback();\n            }\n          }, stepTime * i);\n        })();\n      }\n    },\n\n    /**\n     * [DEPRECATED] Fade in the current sound.\n     * @param  {Float}    to      Volume to fade to (0.0 to 1.0).\n     * @param  {Number}   len     Time in milliseconds to fade.\n     * @param  {Function} callback\n     * @return {Howl}\n     */\n    fadeIn: function(to, len, callback) {\n      return this.volume(0).play().fade(0, to, len, callback);\n    },\n\n    /**\n     * [DEPRECATED] Fade out the current sound and pause when finished.\n     * @param  {Float}    to       Volume to fade to (0.0 to 1.0).\n     * @param  {Number}   len      Time in milliseconds to fade.\n     * @param  {Function} callback\n     * @param  {String}   id       (optional) The play instance ID.\n     * @return {Howl}\n     */\n    fadeOut: function(to, len, callback, id) {\n      var self = this;\n\n      return self.fade(self._volume, to, len, function() {\n        if (callback) callback();\n        self.pause(id);\n\n        // fire ended event\n        self.on('end');\n      }, id);\n    },\n\n    /**\n     * Get an audio node by ID.\n     * @return {Howl} Audio node.\n     */\n    _nodeById: function(id) {\n      var self = this,\n        node = self._audioNode[0];\n\n      // find the node with this ID\n      for (var i=0; i<self._audioNode.length; i++) {\n        if (self._audioNode[i].id === id) {\n          node = self._audioNode[i];\n          break;\n        }\n      }\n\n      return node;\n    },\n\n    /**\n     * Get the first active audio node.\n     * @return {Howl} Audio node.\n     */\n    _activeNode: function() {\n      var self = this,\n        node = null;\n\n      // find the first playing node\n      for (var i=0; i<self._audioNode.length; i++) {\n        if (!self._audioNode[i].paused) {\n          node = self._audioNode[i];\n          break;\n        }\n      }\n\n      // remove excess inactive nodes\n      self._drainPool();\n\n      return node;\n    },\n\n    /**\n     * Get the first inactive audio node.\n     * If there is none, create a new one and add it to the pool.\n     * @param  {Function} callback Function to call when the audio node is ready.\n     */\n    _inactiveNode: function(callback) {\n      var self = this,\n        node = null;\n\n      // find first inactive node to recycle\n      for (var i=0; i<self._audioNode.length; i++) {\n        if (self._audioNode[i].paused && self._audioNode[i].readyState === 4) {\n          // send the node back for use by the new play instance\n          callback(self._audioNode[i]);\n          node = true;\n          break;\n        }\n      }\n\n      // remove excess inactive nodes\n      self._drainPool();\n\n      if (node) {\n        return;\n      }\n\n      // create new node if there are no inactives\n      var newNode;\n      if (self._webAudio) {\n        newNode = self._setupAudioNode();\n        callback(newNode);\n      } else {\n        self.load();\n        newNode = self._audioNode[self._audioNode.length - 1];\n\n        // listen for the correct load event and fire the callback\n        var listenerEvent = navigator.isCocoonJS ? 'canplaythrough' : 'loadedmetadata';\n        var listener = function() {\n          newNode.removeEventListener(listenerEvent, listener, false);\n          callback(newNode);\n        };\n        newNode.addEventListener(listenerEvent, listener, false);\n      }\n    },\n\n    /**\n     * If there are more than 5 inactive audio nodes in the pool, clear out the rest.\n     */\n    _drainPool: function() {\n      var self = this,\n        inactive = 0,\n        i;\n\n      // count the number of inactive nodes\n      for (i=0; i<self._audioNode.length; i++) {\n        if (self._audioNode[i].paused) {\n          inactive++;\n        }\n      }\n\n      // remove excess inactive nodes\n      for (i=self._audioNode.length-1; i>=0; i--) {\n        if (inactive <= 5) {\n          break;\n        }\n\n        if (self._audioNode[i].paused) {\n          // disconnect the audio source if using Web Audio\n          if (self._webAudio) {\n            self._audioNode[i].disconnect(0);\n          }\n\n          inactive--;\n          self._audioNode.splice(i, 1);\n        }\n      }\n    },\n\n    /**\n     * Clear 'onend' timeout before it ends.\n     * @param  {String} soundId  The play instance ID.\n     */\n    _clearEndTimer: function(soundId) {\n      var self = this,\n        index = 0;\n\n      // loop through the timers to find the one associated with this sound\n      for (var i=0; i<self._onendTimer.length; i++) {\n        if (self._onendTimer[i].id === soundId) {\n          index = i;\n          break;\n        }\n      }\n\n      var timer = self._onendTimer[index];\n      if (timer) {\n        clearTimeout(timer.timer);\n        self._onendTimer.splice(index, 1);\n      }\n    },\n\n    /**\n     * Setup the gain node and panner for a Web Audio instance.\n     * @return {Object} The new audio node.\n     */\n    _setupAudioNode: function() {\n      var self = this,\n        node = self._audioNode,\n        index = self._audioNode.length;\n\n      // create gain node\n      node[index] = (typeof ctx.createGain === 'undefined') ? ctx.createGainNode() : ctx.createGain();\n      node[index].gain.value = self._volume;\n      node[index].paused = true;\n      node[index]._pos = 0;\n      node[index].readyState = 4;\n      node[index].connect(masterGain);\n\n      // create the panner\n      node[index].panner = ctx.createPanner();\n      node[index].panner.panningModel = self._model || 'equalpower';\n      node[index].panner.setPosition(self._pos3d[0], self._pos3d[1], self._pos3d[2]);\n      node[index].panner.connect(node[index]);\n\n      return node[index];\n    },\n\n    /**\n     * Call/set custom events.\n     * @param  {String}   event Event type.\n     * @param  {Function} fn    Function to call.\n     * @return {Howl}\n     */\n    on: function(event, fn) {\n      var self = this,\n        events = self['_on' + event];\n\n      if (typeof fn === 'function') {\n        events.push(fn);\n      } else {\n        for (var i=0; i<events.length; i++) {\n          if (fn) {\n            events[i].call(self, fn);\n          } else {\n            events[i].call(self);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Remove a custom event.\n     * @param  {String}   event Event type.\n     * @param  {Function} fn    Listener to remove.\n     * @return {Howl}\n     */\n    off: function(event, fn) {\n      var self = this,\n        events = self['_on' + event],\n        fnString = fn ? fn.toString() : null;\n\n      if (fnString) {\n        // loop through functions in the event for comparison\n        for (var i=0; i<events.length; i++) {\n          if (fnString === events[i].toString()) {\n            events.splice(i, 1);\n            break;\n          }\n        }\n      } else {\n        self['_on' + event] = [];\n      }\n\n      return self;\n    },\n\n    /**\n     * Unload and destroy the current Howl object.\n     * This will immediately stop all play instances attached to this sound.\n     */\n    unload: function() {\n      var self = this;\n\n      // stop playing any active nodes\n      var nodes = self._audioNode;\n      for (var i=0; i<self._audioNode.length; i++) {\n        // stop the sound if it is currently playing\n        if (!nodes[i].paused) {\n          self.stop(nodes[i].id);\n          self.on('end', nodes[i].id);\n        }\n\n        if (!self._webAudio) {\n          // remove the source if using HTML5 Audio\n          nodes[i].src = '';\n        } else {\n          // disconnect the output from the master gain\n          nodes[i].disconnect(0);\n        }\n      }\n\n      // make sure all timeouts are cleared\n      for (i=0; i<self._onendTimer.length; i++) {\n        clearTimeout(self._onendTimer[i].timer);\n      }\n\n      // remove the reference in the global Howler object\n      var index = Howler._howls.indexOf(self);\n      if (index !== null && index >= 0) {\n        Howler._howls.splice(index, 1);\n      }\n\n      // delete this sound from the cache\n      delete cache[self._src];\n      self = null;\n    }\n\n  };\n\n  // only define these functions when using WebAudio\n  if (usingWebAudio) {\n\n    /**\n     * Buffer a sound from URL (or from cache) and decode to audio source (Web Audio API).\n     * @param  {Object} obj The Howl object for the sound to load.\n     * @param  {String} url The path to the sound file.\n     */\n    var loadBuffer = function(obj, url) {\n      // check if the buffer has already been cached\n      if (url in cache) {\n        // set the duration from the cache\n        obj._duration = cache[url].duration;\n\n        // load the sound into this object\n        loadSound(obj);\n        return;\n      }\n      \n      if (/^data:[^;]+;base64,/.test(url)) {\n        // Decode base64 data-URIs because some browsers cannot load data-URIs with XMLHttpRequest.\n        var data = atob(url.split(',')[1]);\n        var dataView = new Uint8Array(data.length);\n        for (var i=0; i<data.length; ++i) {\n          dataView[i] = data.charCodeAt(i);\n        }\n        \n        decodeAudioData(dataView.buffer, obj, url);\n      } else {\n        // load the buffer from the URL\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url, true);\n        xhr.responseType = 'arraybuffer';\n        xhr.onload = function() {\n          decodeAudioData(xhr.response, obj, url);\n        };\n        xhr.onerror = function() {\n          // if there is an error, switch the sound to HTML Audio\n          if (obj._webAudio) {\n            obj._buffer = true;\n            obj._webAudio = false;\n            obj._audioNode = [];\n            delete obj._gainNode;\n            delete cache[url];\n            obj.load();\n          }\n        };\n        try {\n          xhr.send();\n        } catch (e) {\n          xhr.onerror();\n        }\n      }\n    };\n\n    /**\n     * Decode audio data from an array buffer.\n     * @param  {ArrayBuffer} arraybuffer The audio data.\n     * @param  {Object} obj The Howl object for the sound to load.\n     * @param  {String} url The path to the sound file.\n     */\n    var decodeAudioData = function(arraybuffer, obj, url) {\n      // decode the buffer into an audio source\n      ctx.decodeAudioData(\n        arraybuffer,\n        function(buffer) {\n          if (buffer) {\n            cache[url] = buffer;\n            loadSound(obj, buffer);\n          }\n        },\n        function(err) {\n          obj.on('loaderror');\n        }\n      );\n    };\n\n    /**\n     * Finishes loading the Web Audio API sound and fires the loaded event\n     * @param  {Object}  obj    The Howl object for the sound to load.\n     * @param  {Objecct} buffer The decoded buffer sound source.\n     */\n    var loadSound = function(obj, buffer) {\n      // set the duration\n      obj._duration = (buffer) ? buffer.duration : obj._duration;\n\n      // setup a sprite if none is defined\n      if (Object.getOwnPropertyNames(obj._sprite).length === 0) {\n        obj._sprite = {_default: [0, obj._duration * 1000]};\n      }\n\n      // fire the loaded event\n      if (!obj._loaded) {\n        obj._loaded = true;\n        obj.on('load');\n      }\n\n      if (obj._autoplay) {\n        obj.play();\n      }\n    };\n\n    /**\n     * Load the sound back into the buffer source.\n     * @param  {Object} obj   The sound to load.\n     * @param  {Array}  loop  Loop boolean, pos, and duration.\n     * @param  {String} id    (optional) The play instance ID.\n     */\n    var refreshBuffer = function(obj, loop, id) {\n      // determine which node to connect to\n      var node = obj._nodeById(id);\n\n      // setup the buffer source for playback\n      node.bufferSource = ctx.createBufferSource();\n      node.bufferSource.buffer = cache[obj._src];\n      node.bufferSource.connect(node.panner);\n      node.bufferSource.loop = loop[0];\n      if (loop[0]) {\n        node.bufferSource.loopStart = loop[1];\n        node.bufferSource.loopEnd = loop[1] + loop[2];\n      }\n      node.bufferSource.playbackRate.value = obj._rate;\n    };\n\n  }\n\n  /**\n   * Add support for AMD (Asynchronous Module Definition) libraries such as require.js.\n   */\n  if (typeof define === 'function' && define.amd) {\n    define(function() {\n      return {\n        Howler: Howler,\n        Howl: Howl\n      };\n    });\n  }\n\n  /**\n   * Add support for CommonJS libraries such as browserify.\n   */\n  if (typeof exports !== 'undefined') {\n    exports.Howler = Howler;\n    exports.Howl = Howl;\n  }\n\n  // define globally in case AMD is not available or available but not used\n\n  if (typeof window !== 'undefined') {\n    window.Howler = Howler;\n    window.Howl = Howl;\n  }\n\n})();\n","module.exports = function(THREE) {\n  'use strict';\n\n  var SUPPORT_TRANSFERABLE,\n    _is_simulating = false,\n    _Physijs = Physijs, // used for noConflict method\n    Physijs = {}, // object assigned to window.Physijs\n    Eventable, // class to provide simple event methods\n    getObjectId, // returns a unique ID for a Physijs mesh object\n    getEulerXYZFromQuaternion, getQuatertionFromEuler,\n    convertWorldPositionToObject, // Converts a world-space position to object-space\n    addObjectChildren,\n\n    _temp1, _temp2,\n    _temp_vector3_1 = new THREE.Vector3,\n    _temp_vector3_2 = new THREE.Vector3,\n    _temp_matrix4_1 = new THREE.Matrix4,\n    _quaternion_1 = new THREE.Quaternion,\n\n    // constants\n    MESSAGE_TYPES = {\n      WORLDREPORT: 0,\n      COLLISIONREPORT: 1,\n      VEHICLEREPORT: 2,\n      CONSTRAINTREPORT: 3\n    },\n    REPORT_ITEMSIZE = 14,\n    COLLISIONREPORT_ITEMSIZE = 5,\n    VEHICLEREPORT_ITEMSIZE = 9,\n    CONSTRAINTREPORT_ITEMSIZE = 6;\n\n  Physijs.scripts = {};\n\n  Eventable = function() {\n    this._eventListeners = {};\n  };\n  Eventable.prototype.addEventListener = function(event_name, callback) {\n    if (!this._eventListeners.hasOwnProperty(event_name)) {\n      this._eventListeners[event_name] = [];\n    }\n    this._eventListeners[event_name].push(callback);\n  };\n  Eventable.prototype.removeEventListener = function(event_name, callback) {\n    var index;\n\n    if (!this._eventListeners.hasOwnProperty(event_name)) return false;\n\n    if ((index = this._eventListeners[event_name].indexOf(callback)) >= 0) {\n      this._eventListeners[event_name].splice(index, 1);\n      return true;\n    }\n\n    return false;\n  };\n  Eventable.prototype.dispatchEvent = function(event_name) {\n    var i,\n      parameters = Array.prototype.splice.call(arguments, 1);\n\n    if (this._eventListeners.hasOwnProperty(event_name)) {\n      for (i = 0; i < this._eventListeners[event_name].length; i++) {\n        this._eventListeners[event_name][i].apply(this, parameters);\n      }\n    }\n  };\n  Eventable.make = function(obj) {\n    obj.prototype.addEventListener = Eventable.prototype.addEventListener;\n    obj.prototype.removeEventListener = Eventable.prototype.removeEventListener;\n    obj.prototype.dispatchEvent = Eventable.prototype.dispatchEvent;\n  };\n\n  getObjectId = (function() {\n    var _id = 1;\n    return function() {\n      return _id++;\n    };\n  })();\n\n  getEulerXYZFromQuaternion = function(x, y, z, w) {\n    return new THREE.Vector3(\n      Math.atan2(2 * (x * w - y * z), (w * w - x * x - y * y + z * z)),\n      Math.asin(2 * (x * z + y * w)),\n      Math.atan2(2 * (z * w - x * y), (w * w + x * x - y * y - z * z))\n    );\n  };\n\n  getQuatertionFromEuler = function(x, y, z) {\n    var c1, s1, c2, s2, c3, s3, c1c2, s1s2;\n    c1 = Math.cos(y);\n    s1 = Math.sin(y);\n    c2 = Math.cos(-z);\n    s2 = Math.sin(-z);\n    c3 = Math.cos(x);\n    s3 = Math.sin(x);\n\n    c1c2 = c1 * c2;\n    s1s2 = s1 * s2;\n\n    return {\n      w: c1c2 * c3 - s1s2 * s3,\n      x: c1c2 * s3 + s1s2 * c3,\n      y: s1 * c2 * c3 + c1 * s2 * s3,\n      z: c1 * s2 * c3 - s1 * c2 * s3\n    };\n  };\n\n  convertWorldPositionToObject = function(position, object) {\n    _temp_matrix4_1.identity(); // reset temp matrix\n\n    // Set the temp matrix's rotation to the object's rotation\n    _temp_matrix4_1.identity().makeRotationFromQuaternion(object.quaternion);\n\n    // Invert rotation matrix in order to \"unrotate\" a point back to object space\n    _temp_matrix4_1.getInverse(_temp_matrix4_1);\n\n    // Yay! Temp vars!\n    _temp_vector3_1.copy(position);\n    _temp_vector3_2.copy(object.position);\n\n    // Apply the rotation\n\n    return _temp_vector3_1.sub(_temp_vector3_2).applyMatrix4(_temp_matrix4_1);\n  };\n\n\n\n  // Physijs.noConflict\n  Physijs.noConflict = function() {\n    window.Physijs = _Physijs;\n    return Physijs;\n  };\n\n\n  // Physijs.createMaterial\n  Physijs.createMaterial = function(material, friction, restitution) {\n    var physijs_material = function() {};\n    physijs_material.prototype = material;\n    physijs_material = new physijs_material;\n\n    physijs_material._physijs = {\n      id: material.id,\n      friction: friction === undefined ? .8 : friction,\n      restitution: restitution === undefined ? .2 : restitution\n    };\n\n    return physijs_material;\n  };\n\n\n  // Constraints\n  Physijs.PointConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'point';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.PointConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb\n    };\n  };\n\n  Physijs.HingeConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'hinge';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.position = position.clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.HingeConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  /*\n   * low = minimum angle in radians\n   * high = maximum angle in radians\n   * bias_factor = applied as a factor to constraint error\n   * relaxation_factor = controls bounce (0.0 == no bounce)\n   */\n  Physijs.HingeConstraint.prototype.setLimits = function(low, high, bias_factor, relaxation_factor) {\n    this.scene.execute('hinge_setLimits', {\n      constraint: this.id,\n      low: low,\n      high: high,\n      bias_factor: bias_factor,\n      relaxation_factor: relaxation_factor\n    });\n  };\n  Physijs.HingeConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.HingeConstraint.prototype.disableMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.SliderConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'slider';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.SliderConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  Physijs.SliderConstraint.prototype.setLimits = function(lin_lower, lin_upper, ang_lower, ang_upper) {\n    this.scene.execute('slider_setLimits', {\n      constraint: this.id,\n      lin_lower: lin_lower,\n      lin_upper: lin_upper,\n      ang_lower: ang_lower,\n      ang_upper: ang_upper\n    });\n  };\n  Physijs.SliderConstraint.prototype.setRestitution = function(linear, angular) {\n    this.scene.execute(\n      'slider_setRestitution', {\n        constraint: this.id,\n        linear: linear,\n        angular: angular\n      }\n    );\n  };\n  Physijs.SliderConstraint.prototype.enableLinearMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableLinearMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableLinearMotor = function() {\n    this.scene.execute('slider_disableLinearMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.SliderConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableAngularMotor = function() {\n    this.scene.execute('slider_disableAngularMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.ConeTwistConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      throw 'Both objects must be defined in a ConeTwistConstraint.';\n    }\n    this.type = 'conetwist';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.objectb = objectb._physijs.id;\n    this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n    this.axisb = {\n      x: objectb.rotation.x,\n      y: objectb.rotation.y,\n      z: objectb.rotation.z\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.setLimit = function(x, y, z) {\n    this.scene.execute('conetwist_setLimit', {\n      constraint: this.id,\n      x: x,\n      y: y,\n      z: z\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.enableMotor = function() {\n    this.scene.execute('conetwist_enableMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMaxMotorImpulse = function(max_impulse) {\n    this.scene.execute('conetwist_setMaxMotorImpulse', {\n      constraint: this.id,\n      max_impulse: max_impulse\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMotorTarget = function(target) {\n    if (target instanceof THREE.Vector3) {\n      target = new THREE.Quaternion().setFromEuler(new THREE.Euler(target.x, target.y, target.z));\n    }\n    else if (target instanceof THREE.Euler) {\n      target = new THREE.Quaternion().setFromEuler(target);\n    }\n    else if (target instanceof THREE.Matrix4) {\n      target = new THREE.Quaternion().setFromRotationMatrix(target);\n    }\n    this.scene.execute('conetwist_setMotorTarget', {\n      constraint: this.id,\n      x: target.x,\n      y: target.y,\n      z: target.z,\n      w: target.w\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.disableMotor = function() {\n    this.scene.execute('conetwist_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.DOFConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n    this.type = 'dof';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n      this.axisb = {\n        x: objectb.rotation.x,\n        y: objectb.rotation.y,\n        z: objectb.rotation.z\n      };\n    }\n  };\n  Physijs.DOFConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.DOFConstraint.prototype.setLinearLowerLimit = function(limit) {\n    this.scene.execute('dof_setLinearLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setLinearUpperLimit = function(limit) {\n    this.scene.execute('dof_setLinearUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularLowerLimit = function(limit) {\n    this.scene.execute('dof_setAngularLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularUpperLimit = function(limit) {\n    this.scene.execute('dof_setAngularUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.enableAngularMotor = function(which) {\n    this.scene.execute('dof_enableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n  Physijs.DOFConstraint.prototype.configureAngularMotor = function(which, low_angle, high_angle, velocity, max_force) {\n    this.scene.execute('dof_configureAngularMotor', {\n      constraint: this.id,\n      which: which,\n      low_angle: low_angle,\n      high_angle: high_angle,\n      velocity: velocity,\n      max_force: max_force\n    });\n  };\n  Physijs.DOFConstraint.prototype.disableAngularMotor = function(which) {\n    this.scene.execute('dof_disableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n\n  // Physijs.Scene\n  Physijs.Scene = function(params) {\n    var self = this;\n\n    Eventable.call(this);\n    THREE.Scene.call(this);\n\n    this._worker = new Worker(Physijs.scripts.worker || 'physijsWorker.js');\n    this._worker.transferableMessage = this._worker.webkitPostMessage || this._worker.postMessage;\n    this._materials_ref_counts = {};\n    this._objects = {};\n    this._vehicles = {};\n    this._constraints = {};\n\n    var ab = new ArrayBuffer(1);\n    this._worker.transferableMessage(ab, [ab]);\n    SUPPORT_TRANSFERABLE = (ab.byteLength === 0);\n\n    this._worker.onerror = function(event) {\n      console.log(event.message);\n      console.log(event.filename);\n      console.log(event.lineno);\n    };\n\n    this._worker.onmessage = function(event) {\n      var _temp,\n        data = event.data;\n\n      if (data instanceof ArrayBuffer && data.byteLength !== 1) { // byteLength === 1 is the worker making a SUPPORT_TRANSFERABLE test\n        data = new Float32Array(data);\n      }\n\n      if (data instanceof Float32Array) {\n\n        // transferable object\n        switch (data[0]) {\n          case MESSAGE_TYPES.WORLDREPORT:\n            self._updateScene(data);\n            break;\n\n          case MESSAGE_TYPES.COLLISIONREPORT:\n            self._updateCollisions(data);\n            break;\n\n          case MESSAGE_TYPES.VEHICLEREPORT:\n            self._updateVehicles(data);\n            break;\n\n          case MESSAGE_TYPES.CONSTRAINTREPORT:\n            self._updateConstraints(data);\n            break;\n        }\n\n      }\n      else {\n\n        if (data.cmd) {\n\n          // non-transferable object\n          switch (data.cmd) {\n            case 'objectReady':\n              _temp = data.params;\n              if (self._objects[_temp]) {\n                self._objects[_temp].dispatchEvent('ready');\n              }\n              break;\n\n            case 'worldReady':\n              self.dispatchEvent('ready');\n              break;\n\n            case 'vehicle':\n              window.test = data;\n              break;\n\n            default:\n              // Do nothing, just show the message\n              console.debug('Received: ' + data.cmd);\n              console.dir(data.params);\n              break;\n          }\n\n        }\n        else {\n\n          switch (data[0]) {\n            case MESSAGE_TYPES.WORLDREPORT:\n              self._updateScene(data);\n              break;\n\n            case MESSAGE_TYPES.COLLISIONREPORT:\n              self._updateCollisions(data);\n              break;\n\n            case MESSAGE_TYPES.VEHICLEREPORT:\n              self._updateVehicles(data);\n              break;\n\n            case MESSAGE_TYPES.CONSTRAINTREPORT:\n              self._updateConstraints(data);\n              break;\n          }\n\n        }\n\n      }\n    };\n\n\n    params = params || {};\n    params.ammo = Physijs.scripts.ammo || 'ammo.js';\n    params.fixedTimeStep = params.fixedTimeStep || 1 / 60;\n    params.rateLimit = params.rateLimit || true;\n    this.execute('init', params);\n  };\n  Physijs.Scene.prototype = new THREE.Scene;\n  Physijs.Scene.prototype.constructor = Physijs.Scene;\n  Eventable.make(Physijs.Scene);\n\n  Physijs.Scene.prototype._updateScene = function(data) {\n    var num_objects = data[1],\n      object,\n      i, offset;\n\n    for (i = 0; i < num_objects; i++) {\n      offset = 2 + i * REPORT_ITEMSIZE;\n      object = this._objects[data[offset]];\n\n      if (object === undefined) {\n        continue;\n      }\n\n      if (object.__dirtyPosition === false) {\n        object.position.set(\n          data[offset + 1],\n          data[offset + 2],\n          data[offset + 3]\n        );\n      }\n\n      if (object.__dirtyRotation === false) {\n        object.quaternion.set(\n          data[offset + 4],\n          data[offset + 5],\n          data[offset + 6],\n          data[offset + 7]\n        );\n      }\n\n      object._physijs.linearVelocity.set(\n        data[offset + 8],\n        data[offset + 9],\n        data[offset + 10]\n      );\n\n      object._physijs.angularVelocity.set(\n        data[offset + 11],\n        data[offset + 12],\n        data[offset + 13]\n      );\n\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n\n    _is_simulating = false;\n    this.dispatchEvent('update');\n  };\n\n  Physijs.Scene.prototype._updateVehicles = function(data) {\n    var vehicle, wheel,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / VEHICLEREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * VEHICLEREPORT_ITEMSIZE;\n      vehicle = this._vehicles[data[offset]];\n\n      if (vehicle === undefined) {\n        continue;\n      }\n\n      wheel = vehicle.wheels[data[offset + 1]];\n\n      wheel.position.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n\n      wheel.quaternion.set(\n        data[offset + 5],\n        data[offset + 6],\n        data[offset + 7],\n        data[offset + 8]\n      );\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateConstraints = function(data) {\n    var constraint, object,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / CONSTRAINTREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * CONSTRAINTREPORT_ITEMSIZE;\n      constraint = this._constraints[data[offset]];\n      object = this._objects[data[offset + 1]];\n\n      if (constraint === undefined || object === undefined) {\n        continue;\n      }\n\n      _temp_vector3_1.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n      _temp_matrix4_1.extractRotation(object.matrix);\n      _temp_vector3_1.applyMatrix4(_temp_matrix4_1);\n\n      constraint.positiona.addVectors(object.position, _temp_vector3_1);\n      constraint.appliedImpulse = data[offset + 5];\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateCollisions = function(data) {\n    /**\n     * #TODO\n     * This is probably the worst way ever to handle collisions. The inherent evilness is a residual\n     * effect from the previous version's evilness which mutated when switching to transferable objects.\n     *\n     * If you feel inclined to make this better, please do so.\n     */\n\n    var i, j, offset, object, object2, id1, id2,\n      collisions = {},\n      normal_offsets = {};\n\n    // Build collision manifest\n    for (i = 0; i < data[1]; i++) {\n      offset = 2 + i * COLLISIONREPORT_ITEMSIZE;\n      object = data[offset];\n      object2 = data[offset + 1];\n\n      normal_offsets[object + '-' + object2] = offset + 2;\n      normal_offsets[object2 + '-' + object] = -1 * (offset + 2);\n\n      // Register collisions for both the object colliding and the object being collided with\n      if (!collisions[object]) collisions[object] = [];\n      collisions[object].push(object2);\n\n      if (!collisions[object2]) collisions[object2] = [];\n      collisions[object2].push(object);\n    }\n\n    // Deal with collisions\n    for (id1 in this._objects) {\n      if (!this._objects.hasOwnProperty(id1)) continue;\n      object = this._objects[id1];\n\n      // If object touches anything, ...\n      if (collisions[id1]) {\n\n        // Clean up touches array\n        for (j = 0; j < object._physijs.touches.length; j++) {\n          if (collisions[id1].indexOf(object._physijs.touches[j]) === -1) {\n            object._physijs.touches.splice(j--, 1);\n          }\n        }\n\n        // Handle each colliding object\n        for (j = 0; j < collisions[id1].length; j++) {\n          id2 = collisions[id1][j];\n          object2 = this._objects[id2];\n\n          if (object2) {\n            // If object was not already touching object2, notify object\n            if (object._physijs.touches.indexOf(id2) === -1) {\n              object._physijs.touches.push(id2);\n\n              _temp_vector3_1.subVectors(object.getLinearVelocity(), object2.getLinearVelocity());\n              _temp1 = _temp_vector3_1.clone();\n\n              _temp_vector3_1.subVectors(object.getAngularVelocity(), object2.getAngularVelocity());\n              _temp2 = _temp_vector3_1.clone();\n\n              var normal_offset = normal_offsets[object._physijs.id + '-' + object2._physijs.id];\n              if (normal_offset > 0) {\n                _temp_vector3_1.set(-data[normal_offset], -data[normal_offset + 1], -data[normal_offset + 2]);\n              }\n              else {\n                normal_offset *= -1;\n                _temp_vector3_1.set(\n                  data[normal_offset],\n                  data[normal_offset + 1],\n                  data[normal_offset + 2]\n                );\n              }\n\n              object.dispatchEvent('collision', object2, _temp1, _temp2, _temp_vector3_1);\n            }\n          }\n        }\n\n      }\n      else {\n\n        // not touching other objects\n        object._physijs.touches.length = 0;\n\n      }\n\n    }\n\n    this.collisions = collisions;\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype.addConstraint = function(constraint, show_marker) {\n    this._constraints[constraint.id] = constraint;\n    this.execute('addConstraint', constraint.getDefinition());\n\n    if (show_marker) {\n      var marker;\n\n      switch (constraint.type) {\n        case 'point':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'hinge':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'slider':\n          marker = new THREE.Mesh(\n            new THREE.BoxGeometry(10, 1, 1),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          // This rotation isn't right if all three axis are non-0 values\n          // TODO: change marker's rotation order to ZYX\n          marker.rotation.set(\n            constraint.axis.y, // yes, y and\n            constraint.axis.x, // x axis are swapped\n            constraint.axis.z\n          );\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'conetwist':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'dof':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n      }\n    }\n\n    return constraint;\n  };\n\n  Physijs.Scene.prototype.onSimulationResume = function() {\n    this.execute('onSimulationResume', {});\n  };\n\n  Physijs.Scene.prototype.removeConstraint = function(constraint) {\n    if (this._constraints[constraint.id] !== undefined) {\n      this.execute('removeConstraint', {\n        id: constraint.id\n      });\n      delete this._constraints[constraint.id];\n    }\n  };\n\n  Physijs.Scene.prototype.execute = function(cmd, params) {\n    this._worker.postMessage({\n      cmd: cmd,\n      params: params\n    });\n  };\n\n  addObjectChildren = function(parent, object) {\n    var i;\n\n    for (i = 0; i < object.children.length; i++) {\n      if (object.children[i]._physijs) {\n        object.children[i].updateMatrix();\n        object.children[i].updateMatrixWorld();\n\n        _temp_vector3_1.setFromMatrixPosition(object.children[i].matrixWorld);\n        _quaternion_1.setFromRotationMatrix(object.children[i].matrixWorld);\n\n        object.children[i]._physijs.position_offset = {\n          x: _temp_vector3_1.x,\n          y: _temp_vector3_1.y,\n          z: _temp_vector3_1.z\n        };\n\n        object.children[i]._physijs.rotation = {\n          x: _quaternion_1.x,\n          y: _quaternion_1.y,\n          z: _quaternion_1.z,\n          w: _quaternion_1.w\n        };\n\n        parent._physijs.children.push(object.children[i]._physijs);\n      }\n\n      addObjectChildren(parent, object.children[i]);\n    }\n  };\n\n  Physijs.Scene.prototype.add = function(object) {\n    THREE.Mesh.prototype.add.call(this, object);\n\n    if (object._physijs) {\n\n      object.world = this;\n\n      if (object instanceof Physijs.Vehicle) {\n\n        this.add(object.mesh);\n        this._vehicles[object._physijs.id] = object;\n        this.execute('addVehicle', object._physijs);\n\n      }\n      else {\n\n        object.__dirtyPosition = false;\n        object.__dirtyRotation = false;\n        this._objects[object._physijs.id] = object;\n\n        if (object.children.length) {\n          object._physijs.children = [];\n          addObjectChildren(object, object);\n        }\n\n        if (object.material._physijs) {\n          if (!this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n            this.execute('registerMaterial', object.material._physijs);\n            object._physijs.materialId = object.material._physijs.id;\n            this._materials_ref_counts[object.material._physijs.id] = 1;\n          }\n          else {\n            this._materials_ref_counts[object.material._physijs.id]++;\n          }\n        }\n\n        // Object starting position + rotation\n        object._physijs.position = {\n          x: object.position.x,\n          y: object.position.y,\n          z: object.position.z\n        };\n        object._physijs.rotation = {\n          x: object.quaternion.x,\n          y: object.quaternion.y,\n          z: object.quaternion.z,\n          w: object.quaternion.w\n        };\n\n        // Check for scaling\n        var mass_scaling = new THREE.Vector3(1, 1, 1);\n        if (object._physijs.width) {\n          object._physijs.width *= object.scale.x;\n        }\n        if (object._physijs.height) {\n          object._physijs.height *= object.scale.y;\n        }\n        if (object._physijs.depth) {\n          object._physijs.depth *= object.scale.z;\n        }\n\n        this.execute('addObject', object._physijs);\n\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.remove = function(object) {\n    if (object instanceof Physijs.Vehicle) {\n      this.execute('removeVehicle', {\n        id: object._physijs.id\n      });\n      while (object.wheels.length) {\n        this.remove(object.wheels.pop());\n      }\n      this.remove(object.mesh);\n      delete this._vehicles[object._physijs.id];\n    }\n    else {\n      THREE.Mesh.prototype.remove.call(this, object);\n      if (object._physijs) {\n        delete this._objects[object._physijs.id];\n        this.execute('removeObject', {\n          id: object._physijs.id\n        });\n      }\n    }\n    if (object.material && object.material._physijs && this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n      this._materials_ref_counts[object.material._physijs.id]--;\n      if (this._materials_ref_counts[object.material._physijs.id] == 0) {\n        this.execute('unRegisterMaterial', object.material._physijs);\n        delete this._materials_ref_counts[object.material._physijs.id];\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.setFixedTimeStep = function(fixedTimeStep) {\n    if (fixedTimeStep) {\n      this.execute('setFixedTimeStep', fixedTimeStep);\n    }\n  };\n\n  Physijs.Scene.prototype.setGravity = function(gravity) {\n    if (gravity) {\n      this.execute('setGravity', gravity);\n    }\n  };\n\n  Physijs.Scene.prototype.simulate = function(timeStep, maxSubSteps) {\n    var object_id, object, update;\n\n    if (_is_simulating) {\n      return false;\n    }\n\n    _is_simulating = true;\n\n    for (object_id in this._objects) {\n      if (!this._objects.hasOwnProperty(object_id)) continue;\n\n      object = this._objects[object_id];\n\n      if (object.__dirtyPosition || object.__dirtyRotation) {\n        update = {\n          id: object._physijs.id\n        };\n\n        if (object.__dirtyPosition) {\n          update.pos = {\n            x: object.position.x,\n            y: object.position.y,\n            z: object.position.z\n          };\n          object.__dirtyPosition = false;\n        }\n\n        if (object.__dirtyRotation) {\n          update.quat = {\n            x: object.quaternion.x,\n            y: object.quaternion.y,\n            z: object.quaternion.z,\n            w: object.quaternion.w\n          };\n          object.__dirtyRotation = false;\n        }\n\n        this.execute('updateTransform', update);\n      }\n    }\n\n    this.execute('simulate', {\n      timeStep: timeStep,\n      maxSubSteps: maxSubSteps\n    });\n\n    return true;\n  };\n\n\n  // Phsijs.Mesh\n  Physijs.Mesh = function(geometry, material, mass) {\n    var index;\n\n    if (!geometry) {\n      return;\n    }\n\n    Eventable.call(this);\n    THREE.Mesh.call(this, geometry, material);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    this._physijs = {\n      type: null,\n      id: getObjectId(),\n      mass: mass || 0,\n      touches: [],\n      linearVelocity: new THREE.Vector3,\n      angularVelocity: new THREE.Vector3\n    };\n  };\n  Physijs.Mesh.prototype = new THREE.Mesh;\n  Physijs.Mesh.prototype.constructor = Physijs.Mesh;\n  Eventable.make(Physijs.Mesh);\n\n  // Physijs.Mesh.mass\n  Physijs.Mesh.prototype.__defineGetter__('mass', function() {\n    return this._physijs.mass;\n  });\n  Physijs.Mesh.prototype.__defineSetter__('mass', function(mass) {\n    this._physijs.mass = mass;\n    if (this.world) {\n      this.world.execute('updateMass', {\n        id: this._physijs.id,\n        mass: mass\n      });\n    }\n  });\n\n  // Physijs.Mesh.applyCentralImpulse\n  Physijs.Mesh.prototype.applyCentralImpulse = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralImpulse', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyImpulse\n  Physijs.Mesh.prototype.applyImpulse = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyImpulse', {\n        id: this._physijs.id,\n        impulse_x: force.x,\n        impulse_y: force.y,\n        impulse_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyTorque\n  Physijs.Mesh.prototype.applyTorque = function(force) {\n    if (this.world) {\n      this.world.execute('applyTorque', {\n        id: this._physijs.id,\n        torque_x: force.x,\n        torque_y: force.y,\n        torque_z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyCentralForce\n  Physijs.Mesh.prototype.applyCentralForce = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralForce', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyForce\n  Physijs.Mesh.prototype.applyForce = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyForce', {\n        id: this._physijs.id,\n        force_x: force.x,\n        force_y: force.y,\n        force_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getAngularVelocity\n  Physijs.Mesh.prototype.getAngularVelocity = function() {\n    return this._physijs.angularVelocity;\n  };\n\n  // Physijs.Mesh.setAngularVelocity\n  Physijs.Mesh.prototype.setAngularVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setAngularVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getLinearVelocity\n  Physijs.Mesh.prototype.getLinearVelocity = function() {\n    return this._physijs.linearVelocity;\n  };\n\n  // Physijs.Mesh.setLinearVelocity\n  Physijs.Mesh.prototype.setLinearVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setLinearVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setAngularFactor\n  Physijs.Mesh.prototype.setAngularFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setAngularFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setLinearFactor\n  Physijs.Mesh.prototype.setLinearFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setLinearFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setDamping\n  Physijs.Mesh.prototype.setDamping = function(linear, angular) {\n    if (this.world) {\n      this.world.execute('setDamping', {\n        id: this._physijs.id,\n        linear: linear,\n        angular: angular\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdMotionThreshold\n  Physijs.Mesh.prototype.setCcdMotionThreshold = function(threshold) {\n    if (this.world) {\n      this.world.execute('setCcdMotionThreshold', {\n        id: this._physijs.id,\n        threshold: threshold\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdSweptSphereRadius\n  Physijs.Mesh.prototype.setCcdSweptSphereRadius = function(radius) {\n    if (this.world) {\n      this.world.execute('setCcdSweptSphereRadius', {\n        id: this._physijs.id,\n        radius: radius\n      });\n    }\n  };\n\n\n  // Physijs.PlaneMesh\n  Physijs.PlaneMesh = function(geometry, material, mass) {\n    var width, height;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'plane';\n    this._physijs.normal = geometry.faces[0].normal.clone();\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.PlaneMesh.prototype = new Physijs.Mesh;\n  Physijs.PlaneMesh.prototype.constructor = Physijs.PlaneMesh;\n\n  // Physijs.HeightfieldMesh\n  Physijs.HeightfieldMesh = function(geometry, material, mass, xdiv, ydiv) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    this._physijs.type = 'heightfield';\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\n\n    var points = [];\n\n    var a, b;\n    for (var i = 0; i < geometry.vertices.length; i++) {\n\n      a = i % this._physijs.xpts;\n      b = Math.round((i / this._physijs.xpts) - ((i % this._physijs.xpts) / this._physijs.xpts));\n      points[i] = geometry.vertices[a + ((this._physijs.ypts - b - 1) * this._physijs.ypts)].z;\n\n      //points[i] = geometry.vertices[i];\n    }\n\n    this._physijs.points = points;\n  };\n  Physijs.HeightfieldMesh.prototype = new Physijs.Mesh;\n  Physijs.HeightfieldMesh.prototype.constructor = Physijs.HeightfieldMesh;\n\n  // Physijs.BoxMesh\n  Physijs.BoxMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'box';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.BoxMesh.prototype = new Physijs.Mesh;\n  Physijs.BoxMesh.prototype.constructor = Physijs.BoxMesh;\n\n\n  // Physijs.SphereMesh\n  Physijs.SphereMesh = function(geometry, material, mass) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingSphere) {\n      geometry.computeBoundingSphere();\n    }\n\n    this._physijs.type = 'sphere';\n    this._physijs.radius = geometry.boundingSphere.radius;\n    this._physijs.mass = (typeof mass === 'undefined') ? (4 / 3) * Math.PI * Math.pow(this._physijs.radius, 3) : mass;\n  };\n  Physijs.SphereMesh.prototype = new Physijs.Mesh;\n  Physijs.SphereMesh.prototype.constructor = Physijs.SphereMesh;\n\n\n  // Physijs.CylinderMesh\n  Physijs.CylinderMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'cylinder';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CylinderMesh.prototype = new Physijs.Mesh;\n  Physijs.CylinderMesh.prototype.constructor = Physijs.CylinderMesh;\n\n\n  // Physijs.CapsuleMesh\n  Physijs.CapsuleMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'capsule';\n    this._physijs.radius = Math.max(width / 2, depth / 2);\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CapsuleMesh.prototype = new Physijs.Mesh;\n  Physijs.CapsuleMesh.prototype.constructor = Physijs.CapsuleMesh;\n\n\n  // Physijs.ConeMesh\n  Physijs.ConeMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'cone';\n    this._physijs.radius = width / 2;\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.ConeMesh.prototype = new Physijs.Mesh;\n  Physijs.ConeMesh.prototype.constructor = Physijs.ConeMesh;\n\n\n  // Physijs.ConcaveMesh\n  Physijs.ConcaveMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      vertices, face, triangles = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    vertices = geometry.vertices;\n\n    for (i = 0; i < geometry.faces.length; i++) {\n      face = geometry.faces[i];\n      if (face instanceof THREE.Face3) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }]);\n\n      }\n      else if (face instanceof THREE.Face4) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n        triangles.push([{\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n\n      }\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'concave';\n    this._physijs.triangles = triangles;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConcaveMesh.prototype = new Physijs.Mesh;\n  Physijs.ConcaveMesh.prototype.constructor = Physijs.ConcaveMesh;\n\n\n  // Physijs.ConvexMesh\n  Physijs.ConvexMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      points = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    for (i = 0; i < geometry.vertices.length; i++) {\n      points.push({\n        x: geometry.vertices[i].x,\n        y: geometry.vertices[i].y,\n        z: geometry.vertices[i].z\n      });\n    }\n\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'convex';\n    this._physijs.points = points;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConvexMesh.prototype = new Physijs.Mesh;\n  Physijs.ConvexMesh.prototype.constructor = Physijs.ConvexMesh;\n\n\n  // Physijs.Vehicle\n  Physijs.Vehicle = function(mesh, tuning) {\n    tuning = tuning || new Physijs.VehicleTuning;\n    this.mesh = mesh;\n    this.wheels = [];\n    this._physijs = {\n      id: getObjectId(),\n      rigidBody: mesh._physijs.id,\n      suspension_stiffness: tuning.suspension_stiffness,\n      suspension_compression: tuning.suspension_compression,\n      suspension_damping: tuning.suspension_damping,\n      max_suspension_travel: tuning.max_suspension_travel,\n      friction_slip: tuning.friction_slip,\n      max_suspension_force: tuning.max_suspension_force\n    };\n  };\n  Physijs.Vehicle.prototype.addWheel = function(wheel_geometry, wheel_material, connection_point, wheel_direction, wheel_axle, suspension_rest_length, wheel_radius, is_front_wheel, tuning) {\n    var wheel = new THREE.Mesh(wheel_geometry, wheel_material);\n    wheel.castShadow = wheel.receiveShadow = true;\n    wheel.position.copy(wheel_direction).multiplyScalar(suspension_rest_length / 100).add(connection_point);\n    this.world.add(wheel);\n    this.wheels.push(wheel);\n\n    this.world.execute('addWheel', {\n      id: this._physijs.id,\n      connection_point: {\n        x: connection_point.x,\n        y: connection_point.y,\n        z: connection_point.z\n      },\n      wheel_direction: {\n        x: wheel_direction.x,\n        y: wheel_direction.y,\n        z: wheel_direction.z\n      },\n      wheel_axle: {\n        x: wheel_axle.x,\n        y: wheel_axle.y,\n        z: wheel_axle.z\n      },\n      suspension_rest_length: suspension_rest_length,\n      wheel_radius: wheel_radius,\n      is_front_wheel: is_front_wheel,\n      tuning: tuning\n    });\n  };\n  Physijs.Vehicle.prototype.setSteering = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setSteering', {\n        id: this._physijs.id,\n        wheel: wheel,\n        steering: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setSteering', {\n          id: this._physijs.id,\n          wheel: i,\n          steering: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.setBrake = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setBrake', {\n        id: this._physijs.id,\n        wheel: wheel,\n        brake: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setBrake', {\n          id: this._physijs.id,\n          wheel: i,\n          brake: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.applyEngineForce = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('applyEngineForce', {\n        id: this._physijs.id,\n        wheel: wheel,\n        force: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('applyEngineForce', {\n          id: this._physijs.id,\n          wheel: i,\n          force: amount\n        });\n      }\n    }\n  };\n\n  // Physijs.VehicleTuning\n  Physijs.VehicleTuning = function(suspension_stiffness, suspension_compression, suspension_damping, max_suspension_travel, friction_slip, max_suspension_force) {\n    this.suspension_stiffness = suspension_stiffness !== undefined ? suspension_stiffness : 5.88;\n    this.suspension_compression = suspension_compression !== undefined ? suspension_compression : 0.83;\n    this.suspension_damping = suspension_damping !== undefined ? suspension_damping : 0.88;\n    this.max_suspension_travel = max_suspension_travel !== undefined ? max_suspension_travel : 500;\n    this.friction_slip = friction_slip !== undefined ? friction_slip : 10.5;\n    this.max_suspension_force = max_suspension_force !== undefined ? max_suspension_force : 6000;\n  };\n\n  return Physijs;\n}\n\n","/** @preserve http://github.com/easeway/js-class */\n\n// Class Definition using ECMA5 prototype chain\n\nfunction inherit(dest, src, noParent) {\n    while (src && src !== Object.prototype) {\n        Object.getOwnPropertyNames(src).forEach(function (name) {\n            if (name != '.class' && !dest.hasOwnProperty(name)) {\n                var desc = Object.getOwnPropertyDescriptor(src, name);\n                Object.defineProperty(dest, name, desc);\n            }\n        });\n        if (noParent) {\n            break;\n        }\n        src = src.__proto__;\n    }\n    return dest;\n}\n\nvar Class = function (base, proto, options) {\n    if (typeof(base) != 'function') {\n        options = proto;\n        proto = base;\n        base = Object;\n    }\n    if (!proto) {\n        proto = {};\n    }\n    if (!options) {\n        options = {};\n    }\n    \n    var meta = {\n        name: options.name,\n        base: base,\n        implements: []\n    }\n    var classProto = Class.clone(proto);\n    if (options.implements) {\n        (Array.isArray(options.implements) ? options.implements : [options.implements])\n            .forEach(function (implementedType) {\n                if (typeof(implementedType) == 'function' && implementedType.prototype) {\n                    meta.implements.push(implementedType);\n                    Class.extend(classProto, implementedType.prototype);\n                }\n            });\n    }\n    classProto.__proto__ = base.prototype;\n    var theClass = function () {\n        if (typeof(this.constructor) == 'function') {\n            this.constructor.apply(this, arguments);\n        }\n    };\n    meta.type = theClass;\n    theClass.prototype = classProto;\n    Object.defineProperty(theClass, '.class.meta', { value: meta, enumerable: false, configurable: false, writable: false });\n    Object.defineProperty(classProto, '.class', { value: theClass, enumerable: false, configurable: false, writable: false });\n    if (options.statics) {\n        Class.extend(theClass, options.statics);\n    }\n    return theClass;\n};\n\nClass.extend = inherit;\n\nClass.clone = function (object) {\n    return inherit({}, object);\n};\n\nfunction findType(meta, type) {\n    while (meta) {\n        if (meta.type.prototype === type.prototype) {\n            return true;\n        }\n        for (var i in meta.implements) {\n            var implType = meta.implements[i];\n            var implMeta = implType['.class.meta'];\n            if (implMeta) {\n                if (findType(implMeta, type)) {\n                    return true;\n                }\n            } else {\n                for (var proto = implType.prototype; proto; proto = proto.__proto__) {\n                    if (proto === type.prototype) {\n                        return true;\n                    }\n                }\n            }\n        }\n        meta = meta.base ? meta.base['.class.meta'] : undefined;\n    }\n    return false;\n}\n\nvar Checker = Class({\n    constructor: function (object) {\n        this.object = object;\n    },\n    \n    typeOf: function (type) {\n        if (this.object instanceof type) {\n            return true;\n        }\n        var meta = Class.typeInfo(this.object);\n        return meta && findType(meta, type);\n    }\n});\n\n// aliases\nChecker.prototype.a = Checker.prototype.typeOf;\nChecker.prototype.an = Checker.prototype.typeOf;\n\nClass.is = function (object) {\n    return new Checker(object);\n};\n\nClass.typeInfo = function (object) {\n    var theClass = object.__proto__['.class'];\n    return theClass ? theClass['.class.meta'] : undefined;\n};\n\nClass.VERSION = [0, 0, 2];\n\nif (module) {\n    module.exports = Class;\n} else {\n    global.Class = Class;   // for browser\n}","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar Stats = function () {\n\n\tvar startTime = Date.now(), prevTime = startTime;\n\tvar ms = 0, msMin = Infinity, msMax = 0;\n\tvar fps = 0, fpsMin = Infinity, fpsMax = 0;\n\tvar frames = 0, mode = 0;\n\n\tvar container = document.createElement( 'div' );\n\tcontainer.id = 'stats';\n\tcontainer.addEventListener( 'mousedown', function ( event ) { event.preventDefault(); setMode( ++ mode % 2 ) }, false );\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar fpsDiv = document.createElement( 'div' );\n\tfpsDiv.id = 'fps';\n\tfpsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#002';\n\tcontainer.appendChild( fpsDiv );\n\n\tvar fpsText = document.createElement( 'div' );\n\tfpsText.id = 'fpsText';\n\tfpsText.style.cssText = 'color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tfpsText.innerHTML = 'FPS';\n\tfpsDiv.appendChild( fpsText );\n\n\tvar fpsGraph = document.createElement( 'div' );\n\tfpsGraph.id = 'fpsGraph';\n\tfpsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0ff';\n\tfpsDiv.appendChild( fpsGraph );\n\n\twhile ( fpsGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#113';\n\t\tfpsGraph.appendChild( bar );\n\n\t}\n\n\tvar msDiv = document.createElement( 'div' );\n\tmsDiv.id = 'ms';\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#020;display:none';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText = document.createElement( 'div' );\n\tmsText.id = 'msText';\n\tmsText.style.cssText = 'color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML = 'MS';\n\tmsDiv.appendChild( msText );\n\n\tvar msGraph = document.createElement( 'div' );\n\tmsGraph.id = 'msGraph';\n\tmsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0f0';\n\tmsDiv.appendChild( msGraph );\n\n\twhile ( msGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#131';\n\t\tmsGraph.appendChild( bar );\n\n\t}\n\n\tvar setMode = function ( value ) {\n\n\t\tmode = value;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 0:\n\t\t\t\tfpsDiv.style.display = 'block';\n\t\t\t\tmsDiv.style.display = 'none';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tfpsDiv.style.display = 'none';\n\t\t\t\tmsDiv.style.display = 'block';\n\t\t\t\tbreak;\n\t\t}\n\n\t};\n\n\tvar updateGraph = function ( dom, value ) {\n\n\t\tvar child = dom.appendChild( dom.firstChild );\n\t\tchild.style.height = value + 'px';\n\n\t};\n\n\treturn {\n\n\t\tREVISION: 12,\n\n\t\tdomElement: container,\n\n\t\tsetMode: setMode,\n\n\t\tbegin: function () {\n\n\t\t\tstartTime = Date.now();\n\n\t\t},\n\n\t\tend: function () {\n\n\t\t\tvar time = Date.now();\n\n\t\t\tms = time - startTime;\n\t\t\tmsMin = Math.min( msMin, ms );\n\t\t\tmsMax = Math.max( msMax, ms );\n\n\t\t\tmsText.textContent = ms + ' MS (' + msMin + '-' + msMax + ')';\n\t\t\tupdateGraph( msGraph, Math.min( 30, 30 - ( ms / 200 ) * 30 ) );\n\n\t\t\tframes ++;\n\n\t\t\tif ( time > prevTime + 1000 ) {\n\n\t\t\t\tfps = Math.round( ( frames * 1000 ) / ( time - prevTime ) );\n\t\t\t\tfpsMin = Math.min( fpsMin, fps );\n\t\t\t\tfpsMax = Math.max( fpsMax, fps );\n\n\t\t\t\tfpsText.textContent = fps + ' FPS (' + fpsMin + '-' + fpsMax + ')';\n\t\t\t\tupdateGraph( fpsGraph, Math.min( 30, 30 - ( fps / 100 ) * 30 ) );\n\n\t\t\t\tprevTime = time;\n\t\t\t\tframes = 0;\n\n\t\t\t}\n\n\t\t\treturn time;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tstartTime = this.end();\n\n\t\t}\n\n\t}\n\n};\n\nif ( typeof module === 'object' ) {\n\n\tmodule.exports = Stats;\n\n}","module.exports = {\r\n  Identifier: require('./components/Identifier.js'),\r\n  Position: require('./components/Position.js'),\r\n  Velocity: require('./components/Velocity.js'),\r\n  Jump: require('./components/Jump.js'),\r\n  Drawable: require('./components/Drawable.js'),\r\n  Expirable: require('./components/Expirable.js'),\r\n  CameraFollow: require('./components/CameraFollow.js'),\r\n  ShootDelay: require('./components/ShootDelay.js'),\r\n  OneTimeHit: require('./components/OneTimeHit.js'),\r\n  Hurt: require('./components/Hurt.js'),\r\n  Health: require('./components/Health.js'),\r\n  Bullet: require('./components/Bullet.js'),\r\n  AI: require('./components/Ai.js'),\r\n  Steaming: require('./components/Steaming.js'),\r\n  CameraPitch: require('./components/CameraPitch.js'),\r\n  Gun: require('./components/Gun.js')\r\n};\r\n\r\n","/**\r\n * b3\r\n * \r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\nvar b3 = b3 || {};\r\n\r\nmodule.exports = b3;\r\n\r\n/**\r\n * Behavior3JS\r\n * ===========\r\n *\r\n * * * *\r\n * \r\n * **Behavior3JS** is a Behavior Tree library written in JavaScript. It \r\n * provides structures and algorithms that assist you in the task of creating \r\n * intelligent agents for your game or application. Check it out some features \r\n * of Behavior3JS:\r\n * \r\n * - Based on the work of (Marzinotto et al., 2014), in which they propose a \r\n *   **formal**, **consistent** and **general** definition of Behavior Trees;\r\n * - **Optimized to control multiple agents**: you can use a single behavior \r\n *   tree instance to handle hundreds of agents;\r\n * - It was **designed to load and save trees in a JSON format**, in order to \r\n *   use, edit and test it in multiple environments, tools and languages;\r\n * - A **cool visual editor** which you can access online;\r\n * - Several **composite, decorator and action nodes** available within the \r\n *   library. You still can define your own nodes, including composites and \r\n *   decorators;\r\n * - **Completely free**, the core module and the visual editor are all published\r\n *   under the MIT License, which means that you can use them for your open source\r\n *   and commercial projects;\r\n * - **Lightweight**, only 11.5KB!\r\n * \r\n * Visit http://behavior3js.guineashots.com to know more!\r\n *\r\n * \r\n * Core Classes and Functions\r\n * --------------------------\r\n * \r\n * This library include the following core structures...\r\n *\r\n * **Public:**\r\n * \r\n * - **BehaviorTree**: the structure that represents a Behavior Tree;\r\n * - **Blackboard**: represents a \"memory\" in an agent and is required to to \r\n *   run a `BehaviorTree`;\r\n * - **Composite**: base class for all composite nodes;\r\n * - **Decorator**: base class for all decorator nodes;\r\n * - **Action**: base class for all action nodes;\r\n * - **Condition**: base class for all condition nodes;\r\n *\r\n * **Internal:**\r\n * \r\n * \r\n * - **Tick**: used as container and tracking object through the tree during \r\n *   the tick signal;\r\n * - **BaseNode**: the base class that provide all common node features;\r\n * \r\n * *Some classes are used internally on Behavior3JS, but you may need to access\r\n * its functionalities eventually, specially the `Tick` object.*\r\n *\r\n * \r\n * Nodes Included \r\n * --------------\r\n *\r\n * **Composite Nodes**: \r\n * \r\n * - Sequence;\r\n * - Priority;\r\n * - MemSequence;\r\n * - MemPriority;\r\n * \r\n * \r\n * **Decorators**: \r\n * \r\n * - Inverter;\r\n * - Limiter\r\n * - MaxTime;\r\n * - Repeater;\r\n * - RepeaterUntilFailure;\r\n * - RepeaterUntilSuccess;\r\n *\r\n * \r\n * **Actions**:\r\n * \r\n * - Succeeder;\r\n * - Failer;\r\n * - Error;\r\n * - Runner;\r\n * - Wait.\r\n * \r\n * @module Behavior3JS\r\n * @main Behavior3JS\r\n **/\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * List of all constants in Behavior3JS.\r\n   *\r\n   * @class Constants\r\n   **/\r\n\r\n  /**\r\n   * Version of the library.\r\n   * \r\n   * @property VERSION\r\n   * @type {String}\r\n   */\r\n  b3.VERSION = '0.1.0';\r\n\r\n  /**\r\n   * Returned when a criterion has been met by a condition node or an action node\r\n   * has been completed successfully.\r\n   * \r\n   * @property SUCCESS\r\n   * @type {Integer}\r\n   */\r\n  b3.SUCCESS = 1;\r\n\r\n  /**\r\n   * Returned when a criterion has not been met by a condition node or an action \r\n   * node could not finish its execution for any reason.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.FAILURE = 2;\r\n\r\n  /**\r\n   * Returned when an action node has been initialized but is still waiting the \r\n   * its resolution.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.RUNNING = 3;\r\n\r\n  /**\r\n   * Returned when some unexpected error happened in the tree, probably by a \r\n   * programming error (trying to verify an undefined variable). Its use depends \r\n   * on the final implementation of the leaf nodes.\r\n   * \r\n   * @property ERROR\r\n   * @type {Integer}\r\n   */\r\n  b3.ERROR = 4;\r\n\r\n\r\n  /**\r\n   * Describes the node category as Composite.\r\n   * \r\n   * @property COMPOSITE\r\n   * @type {String}\r\n   */\r\n  b3.COMPOSITE = 'composite';\r\n\r\n  /**\r\n   * Describes the node category as Decorator.\r\n   * \r\n   * @property DECORATOR\r\n   * @type {String}\r\n   */\r\n  b3.DECORATOR = 'decorator';\r\n\r\n  /**\r\n   * Describes the node category as Action.\r\n   * \r\n   * @property ACTION\r\n   * @type {String}\r\n   */\r\n  b3.ACTION = 'action';\r\n\r\n  /**\r\n   * Describes the node category as Condition.\r\n   * \r\n   * @property CONDITION\r\n   * @type {String}\r\n   */\r\n  b3.CONDITION = 'condition';\r\n\r\n\r\n  /**\r\n   * List of internal and helper functions in Behavior3JS.\r\n   * \r\n   * @class Utils\r\n   **/\r\n\r\n\r\n  /**\r\n   * This function is used to create unique IDs for trees and nodes.\r\n   * \r\n   * (consult http://www.ietf.org/rfc/rfc4122.txt).\r\n   *\r\n   * @method createUUID\r\n   * @return {String} A unique ID.\r\n   **/\r\n  b3.createUUID = function() {\r\n    var s = [];\r\n    var hexDigits = \"0123456789abcdef\";\r\n    for (var i = 0; i < 36; i++) {\r\n      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n    }\r\n    // bits 12-15 of the time_hi_and_version field to 0010\r\n    s[14] = \"4\";\r\n\r\n    // bits 6-7 of the clock_seq_hi_and_reserved to 01\r\n    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);\r\n\r\n    s[8] = s[13] = s[18] = s[23] = \"-\";\r\n\r\n    var uuid = s.join(\"\");\r\n    return uuid;\r\n  }\r\n\r\n  /**\r\n   * Class is a meta-factory function to create classes in JavaScript. It is a\r\n   * shortcut for the CreateJS syntax style. By default, the class created by \r\n   * this function have an initialize function (the constructor). Optionally, you\r\n   * can specify the inheritance by passing another class as parameter.\r\n   *\r\n   * By default, all classes created using this function, may receives only a\r\n   * settings parameter as argument. This pattern is commonly used by jQuery and \r\n   * its plugins.\r\n   *\r\n   * Usage\r\n   * -----\r\n   *\r\n   *     // Creating a simple class\r\n   *     var BaseClass = b3.Class();\r\n   *\r\n   *     // Using inheritance\r\n   *     var ChildClass = b3.Class(BaseClass);\r\n   *\r\n   *     // Defining the constructor\r\n   *     ChildClass.prototype.initialize = function(settings) { ... }\r\n   *\r\n   * @method Class\r\n   * @param {Object} [baseClass] The super class.\r\n   * @return {Object} A new class.\r\n   **/\r\n  b3.Class = function(baseClass) {\r\n    // create a new class\r\n    var cls = function(params) {\r\n      this.initialize(params);\r\n    }\r\n\r\n    // if base class is provided, inherit\r\n    if (baseClass) {\r\n      cls.prototype = new baseClass();\r\n      cls.prototype.constructor = cls;\r\n    }\r\n\r\n    // create initialize if does not exist on baseClass\r\n    cls.prototype.initialize = cls.prototype.initialize || function() {};\r\n\r\n    return cls;\r\n  }\r\n\r\n})();\r\n/**\r\n * Blackboard\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Blackboard is the memory structure required by `BehaviorTree` and its \r\n   * nodes. It only have 2 public methods: `set` and `get`. These methods works \r\n   * in 3 different contexts: global, per tree, and per node per tree.\r\n   * \r\n   * Suppose you have two different trees controlling a single object with a \r\n   * single blackboard, then:\r\n   *\r\n   * - In the global context, all nodes will access the stored information. \r\n   * - In per tree context, only nodes sharing the same tree share the stored \r\n   *   information.\r\n   * - In per node per tree context, the information stored in the blackboard can\r\n   *   only be accessed by the same node that wrote the data.\r\n   *   \r\n   * The context is selected indirectly by the parameters provided to these \r\n   * methods, for example:\r\n   * \r\n   *     // getting/setting variable in global context\r\n   *     blackboard.set('testKey', 'value');\r\n   *     var value = blackboard.get('testKey');\r\n   *     \r\n   *     // getting/setting variable in per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id);\r\n   *     var value = blackboard.get('testKey', tree.id);\r\n   *     \r\n   *     // getting/setting variable in per node per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id, node.id);\r\n   *     var value = blackboard.get('testKey', tree.id, node.id);\r\n   * \r\n   * Note: Internally, the blackboard store these memories in different objects,\r\n   *  being the global on `_baseMemory`, the per tree on `_treeMemory` and the \r\n   *  per node per tree dynamically create inside the per tree memory (it is \r\n   *  accessed via `_treeMemory[id].nodeMemory`). Avoid to use these variables \r\n   *  manually, use `get` and `set` instead.\r\n   *  \r\n   * @class Blackboard\r\n   **/\r\n  var Blackboard = b3.Class();\r\n\r\n  var p = Blackboard.prototype;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this._baseMemory = {};\r\n    this._treeMemory = {};\r\n  }\r\n\r\n  /**\r\n   * Internal method to retrieve the tree context memory. If the memory does\r\n   * not exist, this method creates it.\r\n   *\r\n   * @method _getTreeMemory\r\n   * @param {string} treeScope The id of the tree in scope.\r\n   * @returns {Object} The tree memory.\r\n   * @protected\r\n   **/\r\n  p._getTreeMemory = function(treeScope) {\r\n    if (!this._treeMemory[treeScope]) {\r\n      this._treeMemory[treeScope] = {\r\n        'nodeMemory': {},\r\n        'openNodes': [],\r\n        'traversalDepth': 0,\r\n        'traversalCycle': 0,\r\n      };\r\n    }\r\n    return this._treeMemory[treeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the node context memory, given the tree \r\n   * memory. If the memory does not exist, this method creates is.\r\n   *\r\n   * @method _getNodeMemory\r\n   * @param {String} treeMemory the tree memory.\r\n   * @param {String} nodeScope The id of the node in scope.\r\n   * @returns {Object} The node memory.\r\n   * @protected\r\n   **/\r\n  p._getNodeMemory = function(treeMemory, nodeScope) {\r\n    var memory = treeMemory['nodeMemory'];\r\n    if (!memory[nodeScope]) {\r\n      memory[nodeScope] = {};\r\n    }\r\n\r\n    return memory[nodeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the context memory. If treeScope and \r\n   * nodeScope are provided, this method returns the per node per tree \r\n   * memory. If only the treeScope is provided, it returns the per tree \r\n   * memory. If no parameter is provided, it returns the global memory. \r\n   * Notice that, if only nodeScope is provided, this method will still \r\n   * return the global memory.\r\n   *\r\n   * @method _getMemory\r\n   * @param {String} treeScope The id of the tree scope.\r\n   * @param {String} nodeScope The id of the node scope.\r\n   * @returns {Object} A memory object.\r\n   * @protected\r\n   **/\r\n  p._getMemory = function(treeScope, nodeScope) {\r\n    var memory = this._baseMemory;\r\n\r\n    if (treeScope) {\r\n      memory = this._getTreeMemory(treeScope);\r\n\r\n      if (nodeScope) {\r\n        memory = this._getNodeMemory(memory, nodeScope);\r\n      }\r\n    }\r\n\r\n    return memory;\r\n  };\r\n\r\n  /**\r\n   * Stores a value in the blackboard. If treeScope and nodeScope are \r\n   * provided, this method will save the value into the per node per tree \r\n   * memory. If only the treeScope is provided, it will save the value into \r\n   * the per tree memory. If no parameter is provided, this method will save \r\n   * the value into the global memory. Notice that, if only nodeScope is \r\n   * provided (but treeScope not), this method will still save the value into\r\n   * the global memory.\r\n   *\r\n   * @method set\r\n   * @param {String} key The key to be stored.\r\n   * @param {String} value The value to be stored.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   **/\r\n  p.set = function(key, value, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    memory[key] = value;\r\n  };\r\n\r\n  /**\r\n   * Retrieves a value in the blackboard. If treeScope and nodeScope are\r\n   * provided, this method will retrieve the value from the per node per tree\r\n   * memory. If only the treeScope is provided, it will retrieve the value\r\n   * from the per tree memory. If no parameter is provided, this method will\r\n   * retrieve from the global memory. If only nodeScope is provided (but\r\n   * treeScope not), this method will still try to retrieve from the global\r\n   * memory.\r\n   *\r\n   * @method get\r\n   * @param {String} key The key to be retrieved.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   * @returns {Object} The value stored or undefined.\r\n   **/\r\n  p.get = function(key, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    return memory[key];\r\n  };\r\n\r\n  b3.Blackboard = Blackboard;\r\n\r\n})();\r\n/**\r\n * Tick\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * A new Tick object is instantiated every tick by BehaviorTree. It is passed \r\n   * as parameter to the nodes through the tree during the traversal.\r\n   * \r\n   * The role of the Tick class is to store the instances of tree, debug, target\r\n   * and blackboard. So, all nodes can access these informations.\r\n   * \r\n   * For internal uses, the Tick also is useful to store the open node after the \r\n   * tick signal, in order to let `BehaviorTree` to keep track and close them \r\n   * when necessary.\r\n   *\r\n   * This class also makes a bridge between nodes and the debug, passing the node\r\n   * state to the debug if the last is provided.\r\n   *\r\n   * @class Tick\r\n   **/\r\n  var Tick = b3.Class();\r\n\r\n  var p = Tick.prototype;\r\n\r\n  /**\r\n   * The tree reference.\r\n   * \r\n   * @property tree\r\n   * @type {b3.BehaviorTree}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The debug reference.\r\n   * \r\n   * @property debug\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The target object reference.\r\n   * \r\n   * @property target\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The blackboard reference.\r\n   * \r\n   * @property blackboard\r\n   * @type {Blackboard}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The list of open nodes. Update during the tree traversal.\r\n   * \r\n   * @property _openNodes\r\n   * @type {Array}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The number of nodes entered during the tick. Update during the tree \r\n   * traversal.\r\n   * \r\n   * @property _nodeCount\r\n   * @type {Integer}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    // set by BehaviorTree\r\n    this.tree = null;\r\n    this.debug = null;\r\n    this.target = null;\r\n    this.blackboard = null;\r\n\r\n    // updated during the tick signal\r\n    this._openNodes = [];\r\n    this._nodeCount = 0;\r\n  }\r\n\r\n  /**\r\n   * Called when entering a node (called by BaseNode).\r\n   *\r\n   * @method _enterNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._enterNode = function(node) {\r\n    this._nodeCount++;\r\n    this._openNodes.push(node);\r\n\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when opening a node (called by BaseNode). \r\n   *\r\n   * @method _openNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._openNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when ticking a node (called by BaseNode).\r\n   *\r\n   * @method _tickNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._tickNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when closing a node (called by BaseNode).\r\n   *\r\n   * @method _closeNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._closeNode = function(node) {\r\n    // TODO: call debug here\r\n    this._openNodes.pop();\r\n  }\r\n\r\n  /**\r\n   * Callback when exiting a node (called by BaseNode).\r\n   *\r\n   * @method _exitNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._exitNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  b3.Tick = Tick;\r\n\r\n})();\r\n/**\r\n * BehaviorTree\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BehaviorTree class, as the name implies, represents the Behavior Tree \r\n   * structure.\r\n   * \r\n   * There are two ways to construct a Behavior Tree: by manually setting the \r\n   * root node, or by loading it from a data structure (which can be loaded from \r\n   * a JSON). Both methods are shown in the examples below and better explained \r\n   * in the user guide.\r\n   *\r\n   * The tick method must be called periodically, in order to send the tick \r\n   * signal to all nodes in the tree, starting from the root. The method \r\n   * `BehaviorTree.tick` receives a target object and a blackboard as parameters.\r\n   * The target object can be anything: a game agent, a system, a DOM object, \r\n   * etc. This target is not used by any piece of Behavior3JS, i.e., the target\r\n   * object will only be used by custom nodes.\r\n   * \r\n   * The blackboard is obligatory and must be an instance of `Blackboard`. This \r\n   * requirement is necessary due to the fact that neither `BehaviorTree` or any \r\n   * node will store the execution variables in its own object (e.g., the BT does\r\n   * not store the target, information about opened nodes or number of times the \r\n   * tree was called). But because of this, you only need a single tree instance \r\n   * to control multiple (maybe hundreds) objects.\r\n   * \r\n   * Manual construction of a Behavior Tree\r\n   * --------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *  \r\n   *     tree.root = new b3.Sequence({children:[\r\n   *         new b3.Priority({children:[\r\n   *             new MyCustomNode(),\r\n   *             new MyCustomNode()\r\n   *         ]}),\r\n   *         ...\r\n   *     ]});\r\n   *     \r\n   * \r\n   * Loading a Behavior Tree from data structure\r\n   * -------------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *\r\n   *     tree.load({\r\n   *         'title'       : 'Behavior Tree title'\r\n   *         'description' : 'My description'\r\n   *         'root'        : 'node-id-1'\r\n   *         'nodes'       : {\r\n   *             'node-id-1' : {\r\n   *                 'name'        : 'Priority', // this is the node type\r\n   *                 'title'       : 'Root Node', \r\n   *                 'description' : 'Description', \r\n   *                 'children'    : ['node-id-2', 'node-id-3'], \r\n   *             },\r\n   *             ...\r\n   *         }\r\n   *     })\r\n   *     \r\n   *\r\n   * @class BehaviorTree\r\n   **/\r\n  var BehaviorTree = b3.Class();\r\n\r\n  var p = BehaviorTree.prototype;\r\n\r\n  /**\r\n   * The tree id, must be unique. By default, created with `b3.createUUID`.\r\n   * \r\n   * @property id\r\n   * @type {String}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The tree title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * Description of the tree.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * A dictionary with (key-value) properties. Useful to define custom \r\n   * variables in the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * The reference to the root node. Must be an instance of `b3.BaseNode`.\r\n   *\r\n   * @property root\r\n   * @type {BaseNode}\r\n   */\r\n\r\n  /**\r\n   * The reference to the debug instance.\r\n   *\r\n   * @property debug\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = 'The behavior tree';\r\n    this.description = 'Default description';\r\n    this.properties = {};\r\n    this.root = null;\r\n    this.debug = null;\r\n  }\r\n\r\n  /**\r\n   * This method loads a Behavior Tree from a data structure, populating this\r\n   * object with the provided data. Notice that, the data structure must \r\n   * follow the format specified by Behavior3JS. Consult the guide to know \r\n   * more about this format.\r\n   *\r\n   * You probably want to use custom nodes in your BTs, thus, you need to \r\n   * provide the `names` object, in which this method can find the nodes by \r\n   * `names[NODE_NAME]`. This variable can be a namespace or a dictionary, \r\n   * as long as this method can find the node by its name, for example:\r\n   *\r\n   *     //json\r\n   *     ...\r\n   *     'node1': {\r\n   *       'name': MyCustomNode,\r\n   *       'title': ...\r\n   *     }\r\n   *     ...\r\n   *     \r\n   *     //code\r\n   *     var bt = new b3.BehaviorTree();\r\n   *     bt.load(data, {'MyCustomNode':MyCustomNode})\r\n   *     \r\n   * \r\n   * @method load\r\n   * @param {Object} data The data structure representing a Behavior Tree.\r\n   * @param {Object} [names] A namespace or dict containing custom nodes.\r\n   **/\r\n  p.load = function(data, names) {\r\n    names = names || {};\r\n\r\n    this.title = data.title || this.title;\r\n    this.description = data.description || this.description;\r\n    this.properties = data.properties || this.properties;\r\n\r\n    var nodes = {};\r\n    // Create the node list (without connection between them)\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n\r\n      if (spec.name in names) {\r\n        // Look for the name in custom nodes\r\n        var cls = names[spec.name];\r\n      }\r\n      else if (spec.name in b3) {\r\n        // Look for the name in default nodes\r\n        var cls = b3[spec.name];\r\n      }\r\n      else {\r\n        // Invalid node name\r\n        throw EvalError('BehaviorTree.load: Invalid node name + \"' +\r\n          spec.name + '\".');\r\n      }\r\n\r\n      var node = new cls(spec.parameters);\r\n      node.id = spec.id || node.id;\r\n      node.title = spec.title || node.title;\r\n      node.description = spec.description || node.description;\r\n      node.properties = spec.properties || node.properties;\r\n      node.parameters = spec.parameters || node.parameters;\r\n\r\n      nodes[id] = node;\r\n    }\r\n\r\n    // Connect the nodes\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n      var node = nodes[id];\r\n\r\n      if (node.category === b3.COMPOSITE && spec.children) {\r\n        for (var i = 0; i < spec.children.length; i++) {\r\n          var cid = spec.children[i];\r\n          node.children.push(nodes[cid]);\r\n        }\r\n      }\r\n      else if (node.category === b3.DECORATOR && spec.child) {\r\n        node.child = nodes[spec.child];\r\n      }\r\n    }\r\n\r\n    this.root = nodes[data.root];\r\n  };\r\n\r\n  /**\r\n   * This method dump the current BT into a data structure.\r\n   *\r\n   * Note: This method does not record the current node parameters. Thus, \r\n   * it may not be compatible with load for now.\r\n   * \r\n   * @method dump\r\n   * @returns {Object} A data object representing this tree.\r\n   **/\r\n  p.dump = function() {\r\n    var data = {};\r\n\r\n    data.title = this.title;\r\n    data.description = this.description;\r\n    data.root = (this.root) ? this.root.id : null;\r\n    data.properties = this.properties;\r\n    data.nodes = {};\r\n\r\n    if (!this.root) return data;\r\n\r\n    var stack = [this.root];\r\n    while (stack.length > 0) {\r\n      var node = stack.pop();\r\n\r\n      var spec = {};\r\n      spec.id = node.id;\r\n      spec.name = node.name;\r\n      spec.title = node.title;\r\n      spec.description = node.description;\r\n      spec.properties = node.properties;\r\n      spec.parameters = node.parameters;\r\n\r\n      if (node.category === b3.COMPOSITE && node.children) {\r\n        var children = []\r\n        for (var i = node.children.length - 1; i >= 0; i--) {\r\n          children.push(node.children[i].id);\r\n          stack.push(node.children[i]);\r\n        }\r\n        spec.children = children;\r\n      }\r\n      else if (node.category === b3.DECORATOR && node.child) {\r\n        stack.push(node.child);\r\n        spec.child = node.child.id;\r\n      }\r\n\r\n      data.nodes[node.id] = spec;\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  /**\r\n   * Propagates the tick signal through the tree, starting from the root.\r\n   * \r\n   * This method receives a target object of any type (Object, Array, \r\n   * DOMElement, whatever) and a `Blackboard` instance. The target object has\r\n   * no use at all for all Behavior3JS components, but surely is important \r\n   * for custom nodes. The blackboard instance is used by the tree and nodes \r\n   * to store execution variables (e.g., last node running) and is obligatory\r\n   * to be a `Blackboard` instance (or an object with the same interface).\r\n   * \r\n   * Internally, this method creates a Tick object, which will store the \r\n   * target and the blackboard objects.\r\n   * \r\n   * Note: BehaviorTree stores a list of open nodes from last tick, if these \r\n   * nodes weren't called after the current tick, this method will close them \r\n   * automatically.\r\n   * \r\n   * @method tick\r\n   * @param {Object} target A target object.\r\n   * @param {Blackboard} blackboard An instance of blackboard object.\r\n   * @returns {Constant} The tick signal state.\r\n   **/\r\n  p.tick = function(target, blackboard) {\r\n    if (!blackboard) {\r\n      throw 'The blackboard parameter is obligatory and must be an ' +\r\n      'instance of b3.Blackboard';\r\n    }\r\n\r\n    /* CREATE A TICK OBJECT */\r\n    var tick = new b3.Tick();\r\n    tick.debug = this.debug;\r\n    tick.target = target;\r\n    tick.blackboard = blackboard;\r\n    tick.tree = this;\r\n\r\n    /* TICK NODE */\r\n    var state = this.root._execute(tick);\r\n\r\n    /* CLOSE NODES FROM LAST TICK, IF NEEDED */\r\n    var lastOpenNodes = blackboard.get('openNodes', this.id);\r\n    var currOpenNodes = tick._openNodes.slice(0);\r\n\r\n    // does not close if it is still open in this tick\r\n    var start = 0;\r\n    for (var i = 0; i < Math.min(lastOpenNodes.length, currOpenNodes.length); i++) {\r\n      start = i + 1;\r\n      if (lastOpenNodes[i] !== currOpenNodes[i]) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    // close the nodes\r\n    for (var i = lastOpenNodes.length - 1; i >= start; i--) {\r\n      lastOpenNodes[i]._close(tick);\r\n    }\r\n\r\n    /* POPULATE BLACKBOARD */\r\n    blackboard.set('openNodes', currOpenNodes, this.id);\r\n    blackboard.set('nodeCount', tick._nodeCount, this.id);\r\n\r\n    return state;\r\n  };\r\n\r\n\r\n  b3.BehaviorTree = BehaviorTree;\r\n\r\n})();\r\n/**\r\n * BaseNode\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BaseNode class is used as super class to all nodes in BehaviorJS. It \r\n   * comprises all common variables and methods that a node must have to execute.\r\n   *\r\n   * **IMPORTANT:** Do not inherit from this class, use `b3.Composite`, \r\n   * `b3.Decorator`, `b3.Action` or `b3.Condition`, instead.\r\n   *\r\n   * The attributes are specially designed to serialization of the node in a JSON\r\n   * format. In special, the `parameters` attribute can be set into the visual \r\n   * editor (thus, in the JSON file), and it will be used as parameter on the \r\n   * node initialization at `BehaviorTree.load`.\r\n   * \r\n   * BaseNode also provide 5 callback methods, which the node implementations can\r\n   * override. They are `enter`, `open`, `tick`, `close` and `exit`. See their \r\n   * documentation to know more. These callbacks are called inside the `_execute`\r\n   * method, which is called in the tree traversal.\r\n   * \r\n   * @class BaseNode\r\n   **/\r\n  var BaseNode = b3.Class();\r\n\r\n  var p = BaseNode.prototype;\r\n\r\n  /**\r\n   * Node ID.\r\n   *\r\n   * @property id\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n\r\n  /**\r\n   * Node name. Must be a unique identifier, preferable the same name of the \r\n   * class. You have to set the node name in the prototype.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = null;\r\n\r\n  /**\r\n   * Node category. Must be `b3.COMPOSITE`, `b3.DECORATOR`, `b3.ACTION` or \r\n   * `b3.CONDITION`. This is defined automatically be inheriting the \r\n   * correspondent class.\r\n   *\r\n   * @property category\r\n   * @type constant\r\n   * @readonly\r\n   **/\r\n  p.category = null;\r\n\r\n  /**\r\n   * Node title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.title = null;\r\n\r\n  /**\r\n   * Node description.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.description = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node parameters. Useful for \r\n   * defining parameter values in the visual editor. Note: this is only \r\n   * useful for nodes when loading trees from JSON files.\r\n   *\r\n   * @property parameters\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.parameters = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node properties. Useful for \r\n   * defining custom variables inside the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.properties = null;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = this.title || this.name;\r\n    this.description = '';\r\n    this.parameters = {};\r\n    this.properties = {};\r\n  }\r\n\r\n  /**\r\n   * This is the main method to propagate the tick signal to this node. This \r\n   * method calls all callbacks: `enter`, `open`, `tick`, `close`, and \r\n   * `exit`. It only opens a node if it is not already open. In the same \r\n   * way, this method only close a node if the node  returned a status \r\n   * different of `b3.RUNNING`.\r\n   *\r\n   * @method _execute\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} The tick state.\r\n   * @protected\r\n   **/\r\n  p._execute = function(tick) {\r\n    /* ENTER */\r\n    this._enter(tick);\r\n\r\n    /* OPEN */\r\n    if (!tick.blackboard.get('isOpen', tick.tree.id, this.id)) {\r\n      this._open(tick);\r\n    }\r\n\r\n    /* TICK */\r\n    var status = this._tick(tick);\r\n\r\n    /* CLOSE */\r\n    if (status !== b3.RUNNING) {\r\n      this._close(tick);\r\n    }\r\n\r\n    /* EXIT */\r\n    this._exit(tick);\r\n\r\n    return status;\r\n  }\r\n\r\n  /**\r\n   * Wrapper for enter method.\r\n   *\r\n   * @method _enter\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._enter = function(tick) {\r\n    tick._enterNode(this);\r\n    this.enter(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for open method.\r\n   *\r\n   * @method _open\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._open = function(tick) {\r\n    tick._openNode(this);\r\n    tick.blackboard.set('isOpen', true, tick.tree.id, this.id);\r\n    this.open(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for tick method.\r\n   *\r\n   * @method _tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   * @protected\r\n   **/\r\n  p._tick = function(tick) {\r\n    tick._tickNode(this);\r\n    return this.tick(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for close method.\r\n   *\r\n   * @method _close\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._close = function(tick) {\r\n    tick._closeNode(this);\r\n    tick.blackboard.set('isOpen', false, tick.tree.id, this.id);\r\n    this.close(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for exit method.\r\n   *\r\n   * @method _exit\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._exit = function(tick) {\r\n    tick._exitNode(this);\r\n    this.exit(tick);\r\n  }\r\n\r\n  /**\r\n   * Enter method, override this to use. It is called every time a node is \r\n   * asked to execute, before the tick itself.\r\n   *\r\n   * @method enter\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.enter = function(tick) {}\r\n\r\n  /**\r\n   * Open method, override this to use. It is called only before the tick \r\n   * callback and only if the not isn't closed.\r\n   *\r\n   * Note: a node will be closed if it returned `b3.RUNNING` in the tick.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {}\r\n\r\n  /**\r\n   * Tick method, override this to use. This method must contain the real \r\n   * execution of node (perform a task, call children, etc.). It is called\r\n   * every time a node is asked to execute.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {}\r\n\r\n  /**\r\n   * Close method, override this to use. This method is called after the tick\r\n   * callback, and only if the tick return a state different from \r\n   * `b3.RUNNING`.\r\n   *\r\n   * @method close\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.close = function(tick) {}\r\n\r\n  /**\r\n   * Exit method, override this to use. Called every time in the end of the \r\n   * execution.\r\n   *\r\n   * @method exit\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.exit = function(tick) {}\r\n\r\n  b3.BaseNode = BaseNode;\r\n\r\n})();\r\n/**\r\n * Action\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Action is the base class for all action nodes. Thus, if you want to \r\n   * create new custom action nodes, you need to inherit from this class. \r\n   *\r\n   * For example, take a look at the Runner action:\r\n   * \r\n   *     var Runner = b3.Class(b3.Action);\r\n   *     var p = Runner.prototype;\r\n   *     \r\n   *         p.name = 'Runner';\r\n   *     \r\n   *         p.tick = function(tick) {\r\n   *             return b3.RUNNING;\r\n   *         }\r\n   *\r\n   * @class Action\r\n   * @extends BaseNode\r\n   **/\r\n  var Action = b3.Class(b3.BaseNode);\r\n\r\n  var p = Action.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.ACTION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.ACTION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Action = Action;\r\n\r\n})();\r\n/**\r\n * Composite\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Composite is the base class for all composite nodes. Thus, if you want to \r\n   * create new custom composite nodes, you need to inherit from this class. \r\n   * \r\n   * When creating composite nodes, you will need to propagate the tick signal to\r\n   * the children nodes manually. To do that, override the `tick` method and call \r\n   * the `_execute` method on all nodes. For instance, take a look at how the \r\n   * Sequence node inherit this class and how it call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Composite, using the util function Class.\r\n   *     var Sequence = b3.Class(b3.Composite);\r\n   *     var p = Sequence.prototype;\r\n   *\r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Sequence';\r\n   *         \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *\r\n   *             // Iterates over the children\r\n   *             for (var i=0; i<this.children.length; i++) {\r\n   *\r\n   *                 // Propagate the tick\r\n   *                 var status = this.children[i]._execute(tick);\r\n   * \r\n   *                 if (status !== b3.SUCCESS) {\r\n   *                     return status;\r\n   *                 }\r\n   *             }\r\n   *\r\n   *             return b3.SUCCESS;\r\n   *         }\r\n   *\r\n   * @class Composite\r\n   * @extends BaseNode\r\n   **/\r\n  var Composite = b3.Class(b3.BaseNode);\r\n\r\n  var p = Composite.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.COMPOSITE`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.COMPOSITE;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.children = (settings.children || []).slice(0);\r\n  };\r\n\r\n  b3.Composite = Composite;\r\n\r\n})();\r\n/**\r\n * Decorator\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Decorator is the base class for all decorator nodes. Thus, if you want to \r\n   * create new custom decorator nodes, you need to inherit from this class. \r\n   * \r\n   * When creating decorator nodes, you will need to propagate the tick signal to\r\n   * the child node manually, just like the composite nodes. To do that, override\r\n   * the `tick` method and call the `_execute` method on the child node. For \r\n   * instance, take a look at how the Inverter node inherit this class and how it\r\n   * call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Decorator, using the util function Class.\r\n   *     var Inverter = b3.Class(b3.Decorator);\r\n   *     var p = Inverter.prototype;\r\n   *     \r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Inverter';\r\n   *     \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *             if (!this.child) {\r\n   *                 return b3.ERROR;\r\n   *             }\r\n   *     \r\n   *             // Propagate the tick\r\n   *             var status = this.child._execute(tick);\r\n   *     \r\n   *             if (status == b3.SUCCESS)\r\n   *                 status = b3.FAILURE;\r\n   *             else if (status == b3.FAILURE)\r\n   *                 status = b3.SUCCESS;\r\n   *     \r\n   *             return status;\r\n   *         };\r\n   *\r\n   * @class Decorator\r\n   * @extends BaseNode\r\n   **/\r\n  var Decorator = b3.Class(b3.BaseNode);\r\n\r\n  var p = Decorator.prototype;\r\n\r\n  /**\r\n   * Node category. Default to b3.DECORATOR.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.DECORATOR;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.child = settings.child || null;\r\n  };\r\n\r\n  b3.Decorator = Decorator;\r\n\r\n})();\r\n/**\r\n * Condition\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Condition is the base class for all condition nodes. Thus, if you want to \r\n   * create new custom condition nodes, you need to inherit from this class. \r\n   *\r\n   * @class Condition\r\n   * @extends BaseNode\r\n   **/\r\n  var Condition = b3.Class(b3.BaseNode);\r\n\r\n  var p = Condition.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.CONDITION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.CONDITION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Condition = Condition;\r\n\r\n})();\r\n/**\r\n * Sequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Sequence node ticks its children sequentially until one of them returns \r\n   * `FAILURE`, `RUNNING` or `ERROR`. If all children return the success state, \r\n   * the sequence also returns `SUCCESS`.\r\n   *\r\n   * @class Sequence\r\n   * @extends Composite\r\n   **/\r\n  var Sequence = b3.Class(b3.Composite);\r\n\r\n  var p = Sequence.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Sequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Sequence';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Sequence = Sequence;\r\n\r\n})();\r\n/**\r\n * Priority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Priority ticks its children sequentially until one of them returns \r\n   * `SUCCESS`, `RUNNING` or `ERROR`. If all children return the failure state, \r\n   * the priority also returns `FAILURE`.\r\n   *\r\n   * @class Priority\r\n   * @extends Composite\r\n   **/\r\n  var Priority = b3.Class(b3.Composite);\r\n\r\n  var p = Priority.prototype\r\n\r\n  /**\r\n   * Node name. Default to `Priority`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Priority';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Priority = Priority;\r\n\r\n})();\r\n/**\r\n * MemSequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemSequence is similar to Sequence node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the MemPriority \r\n   * call the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemSequence = b3.Class(b3.Composite);\r\n\r\n  var p = MemSequence.prototype\r\n\r\n  /**\r\n   * Node name. Default to `MemSequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemSequence';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.MemSequence = MemSequence;\r\n\r\n})();\r\n/**\r\n * MemPriority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemPriority is similar to Priority node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the, MemPriority \r\n   * calls the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemPriority = b3.Class(b3.Composite);\r\n\r\n  var p = MemPriority.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MemPriority`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemPriority';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.MemPriority = MemPriority;\r\n\r\n})();\r\n/**\r\n * Inverter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Inverter decorator inverts the result of the child, returning `SUCCESS`\r\n   * for `FAILURE` and `FAILURE` for `SUCCESS`.\r\n   *\r\n   * @class Inverter\r\n   * @extends Decorator\r\n   **/\r\n  var Inverter = b3.Class(b3.Decorator);\r\n\r\n  var p = Inverter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Inverter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Inverter';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var status = this.child._execute(tick);\r\n\r\n    if (status == b3.SUCCESS)\r\n      status = b3.FAILURE;\r\n    else if (status == b3.FAILURE)\r\n      status = b3.SUCCESS;\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.Inverter = Inverter;\r\n\r\n})();\r\n/**\r\n * Limiter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This decorator limit the number of times its child can be called. After a\r\n   * certain number of times, the Limiter decorator returns `FAILURE` without \r\n   * executing the child.\r\n   *\r\n   * @class Limiter\r\n   * @extends Decorator\r\n   **/\r\n  var Limiter = b3.Class(b3.Decorator);\r\n\r\n  var p = Limiter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Limiter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Limiter';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method. \r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxLoop) {\r\n      throw \"maxLoop parameter in Limiter decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxLoop = settings.maxLoop;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    if (i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        tick.blackboard.set('i', i + 1, tick.tree.id, this.id);\r\n\r\n      return status;\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Limiter = Limiter;\r\n\r\n})();\r\n/**\r\n * MaxTime\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The MaxTime decorator limits the maximum time the node child can execute. \r\n   * Notice that it does not interrupt the execution itself (i.e., the child must\r\n   * be non-preemptive), it only interrupts the node after a `RUNNING` status.\r\n   *\r\n   * @class MaxTime\r\n   * @extends Decorator\r\n   **/\r\n  var MaxTime = b3.Class(b3.Decorator);\r\n\r\n  var p = MaxTime.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MaxTime`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MaxTime';\r\n\r\n  /**\r\n   * Node title. Default to `Max Time`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Max Time';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxTime': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxTime** (*Integer*) Maximum time a child can execute.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxTime) {\r\n      throw \"maxTime parameter in MaxTime decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxTime = settings.maxTime;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    var status = this.child._execute(tick);\r\n    if (currTime - startTime > this.maxTime) {\r\n      return b3.FAILURE;\r\n    }\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.MaxTime = MaxTime;\r\n\r\n})();\r\n/**\r\n * Repeater\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Repeater is a decorator that repeats the tick signal until the child node \r\n   * return `RUNNING` or `ERROR`. Optionally, a maximum number of repetitions \r\n   * can be defined.\r\n   *\r\n   * @class Repeater\r\n   * @extends Decorator\r\n   **/\r\n  var Repeater = b3.Class(b3.Decorator);\r\n\r\n  var p = Repeater.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Repeater`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Repeater';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   * \r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n    var status = b3.SUCCESS;\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  };\r\n\r\n  b3.Repeater = Repeater;\r\n\r\n})();\r\n/**\r\n * RepeatUntilFailure\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilFailure is a decorator that repeats the tick signal until the \r\n   * node child returns `FAILURE`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilFailure\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilFailure = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilFailure.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilFailure`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilFailure';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Failure`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Failure';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilFailure = RepeatUntilFailure;\r\n\r\n})();\r\n/**\r\n * RepeatUntilSuccess\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilSuccess is a decorator that repeats the tick signal until the \r\n   * node child returns `SUCCESS`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilSuccess\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilSuccess = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilSuccess.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilSuccess`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilSuccess';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Success`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Success';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilSuccess = RepeatUntilSuccess;\r\n\r\n})();\r\n/**\r\n * Error\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `ERROR` always.\r\n   *\r\n   * @class Error\r\n   * @extends Action\r\n   **/\r\n  var Error = b3.Class(b3.Action);\r\n\r\n  var p = Error.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Error`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Error';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.ERROR`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.ERROR;\r\n  }\r\n\r\n  b3.Error = Error;\r\n\r\n})();\r\n/**\r\n * Failer\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `FAILURE` always.\r\n   *\r\n   * @class Failer\r\n   * @extends Action\r\n   **/\r\n  var Failer = b3.Class(b3.Action);\r\n\r\n  var p = Failer.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Failer`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Failer';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.FAILURE`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Failer = Failer;\r\n\r\n})();\r\n/**\r\n * Runner\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns RUNNING always.\r\n   *\r\n   * @class Runner\r\n   * @extends Action\r\n   **/\r\n  var Runner = b3.Class(b3.Action);\r\n\r\n  var p = Runner.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Runner`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Runner';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.RUNNING`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Runner = Runner;\r\n\r\n})();\r\n/**\r\n * Succeeder\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `SUCCESS` always.\r\n   *\r\n   * @class Succeeder\r\n   * @extends Action\r\n   **/\r\n  var Succeeder = b3.Class(b3.Action);\r\n\r\n  var p = Succeeder.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Succeeder`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Succeeder';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.SUCCESS`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Succeeder = Succeeder;\r\n\r\n})();\r\n/**\r\n * Wait\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Wait a few seconds.\r\n   *\r\n   * @class Wait\r\n   * @extends Action\r\n   **/\r\n  var Wait = b3.Class(b3.Action);\r\n\r\n  var p = Wait.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Wait`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Wait';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'milliseconds': 0\r\n  };\r\n\r\n  p.__Action_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **milliseconds** (*Integer*) Maximum time, in milliseconds, a child\r\n   *                                can execute.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Action_initialize();\r\n\r\n    this.endTime = settings.milliseconds || 0;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    if (currTime - startTime > this.endTime) {\r\n      return b3.SUCCESS;\r\n    }\r\n\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Wait = Wait;\r\n\r\n})();\r\n\r\n","var self = self || {}; // File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = {\r\n  REVISION: '71'\r\n};\r\n\r\n// browserify support\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREE;\r\n\r\n}\r\n\r\n// polyfills\r\n\r\nif (Math.sign === undefined) {\r\n\r\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n  Math.sign = function(x) {\r\n\r\n    return (x < 0) ? -1 : (x > 0) ? 1 : +x;\r\n\r\n  };\r\n\r\n}\r\n\r\n\r\n// set the default log handlers\r\nTHREE.log = function() {\r\n  console.log.apply(console, arguments);\r\n}\r\nTHREE.warn = function() {\r\n  console.warn.apply(console, arguments);\r\n}\r\nTHREE.error = function() {\r\n  console.error.apply(console, arguments);\r\n}\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = {\r\n  LEFT: 0,\r\n  MIDDLE: 1,\r\n  RIGHT: 2\r\n};\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.NoShading = 0;\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n//  mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n\r\n// DEPRECATED\r\n\r\nTHREE.Projector = function() {\r\n\r\n  THREE.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.');\r\n\r\n  this.projectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .projectVector() is now vector.project().');\r\n    vector.project(camera);\r\n\r\n  };\r\n\r\n  this.unprojectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .unprojectVector() is now vector.unproject().');\r\n    vector.unproject(camera);\r\n\r\n  };\r\n\r\n  this.pickingRay = function(vector, camera) {\r\n\r\n    THREE.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().');\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CanvasRenderer = function() {\r\n\r\n  THREE.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js');\r\n\r\n  this.domElement = document.createElement('canvas');\r\n  this.clear = function() {};\r\n  this.render = function() {};\r\n  this.setClearColor = function() {};\r\n  this.setSize = function() {};\r\n\r\n};\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function(color) {\r\n\r\n  if (arguments.length === 3) {\r\n\r\n    return this.setRGB(arguments[0], arguments[1], arguments[2]);\r\n\r\n  }\r\n\r\n  return this.set(color)\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n  constructor: THREE.Color,\r\n\r\n  r: 1,\r\n  g: 1,\r\n  b: 1,\r\n\r\n  set: function(value) {\r\n\r\n    if (value instanceof THREE.Color) {\r\n\r\n      this.copy(value);\r\n\r\n    }\r\n    else if (typeof value === 'number') {\r\n\r\n      this.setHex(value);\r\n\r\n    }\r\n    else if (typeof value === 'string') {\r\n\r\n      this.setStyle(value);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHex: function(hex) {\r\n\r\n    hex = Math.floor(hex);\r\n\r\n    this.r = (hex >> 16 & 255) / 255;\r\n    this.g = (hex >> 8 & 255) / 255;\r\n    this.b = (hex & 255) / 255;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRGB: function(r, g, b) {\r\n\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHSL: function(h, s, l) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    if (s === 0) {\r\n\r\n      this.r = this.g = this.b = l;\r\n\r\n    }\r\n    else {\r\n\r\n      var hue2rgb = function(p, q, t) {\r\n\r\n        if (t < 0) t += 1;\r\n        if (t > 1) t -= 1;\r\n        if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n        if (t < 1 / 2) return q;\r\n        if (t < 2 / 3) return p + (q - p) * 6 * (2 / 3 - t);\r\n        return p;\r\n\r\n      };\r\n\r\n      var p = l <= 0.5 ? l * (1 + s) : l + s - (l * s);\r\n      var q = (2 * l) - p;\r\n\r\n      this.r = hue2rgb(q, p, h + 1 / 3);\r\n      this.g = hue2rgb(q, p, h);\r\n      this.b = hue2rgb(q, p, h - 1 / 3);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setStyle: function(style) {\r\n\r\n    // rgb(255,0,0)\r\n\r\n    if (/^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(255, parseInt(color[1], 10)) / 255;\r\n      this.g = Math.min(255, parseInt(color[2], 10)) / 255;\r\n      this.b = Math.min(255, parseInt(color[3], 10)) / 255;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // rgb(100%,0%,0%)\r\n\r\n    if (/^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(100, parseInt(color[1], 10)) / 100;\r\n      this.g = Math.min(100, parseInt(color[2], 10)) / 100;\r\n      this.b = Math.min(100, parseInt(color[3], 10)) / 100;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #ff0000\r\n\r\n    if (/^\\#([0-9a-f]{6})$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f]{6})$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #f00\r\n\r\n    if (/^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1] + color[1] + color[2] + color[2] + color[3] + color[3], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // red\r\n\r\n    if (/^(\\w+)$/i.test(style)) {\r\n\r\n      this.setHex(THREE.ColorKeywords[style]);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n  },\r\n\r\n  copy: function(color) {\r\n\r\n    this.r = color.r;\r\n    this.g = color.g;\r\n    this.b = color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyGammaToLinear: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    this.r = Math.pow(color.r, gammaFactor);\r\n    this.g = Math.pow(color.g, gammaFactor);\r\n    this.b = Math.pow(color.b, gammaFactor);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyLinearToGamma: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    var safeInverse = (gammaFactor > 0) ? (1.0 / gammaFactor) : 1.0;\r\n\r\n    this.r = Math.pow(color.r, safeInverse);\r\n    this.g = Math.pow(color.g, safeInverse);\r\n    this.b = Math.pow(color.b, safeInverse);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertGammaToLinear: function() {\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    this.r = r * r;\r\n    this.g = g * g;\r\n    this.b = b * b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertLinearToGamma: function() {\r\n\r\n    this.r = Math.sqrt(this.r);\r\n    this.g = Math.sqrt(this.g);\r\n    this.b = Math.sqrt(this.b);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getHex: function() {\r\n\r\n    return (this.r * 255) << 16 ^ (this.g * 255) << 8 ^ (this.b * 255) << 0;\r\n\r\n  },\r\n\r\n  getHexString: function() {\r\n\r\n    return ('000000' + this.getHex().toString(16)).slice(-6);\r\n\r\n  },\r\n\r\n  getHSL: function(optionalTarget) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    var hsl = optionalTarget || {\r\n      h: 0,\r\n      s: 0,\r\n      l: 0\r\n    };\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    var max = Math.max(r, g, b);\r\n    var min = Math.min(r, g, b);\r\n\r\n    var hue, saturation;\r\n    var lightness = (min + max) / 2.0;\r\n\r\n    if (min === max) {\r\n\r\n      hue = 0;\r\n      saturation = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      var delta = max - min;\r\n\r\n      saturation = lightness <= 0.5 ? delta / (max + min) : delta / (2 - max - min);\r\n\r\n      switch (max) {\r\n\r\n        case r:\r\n          hue = (g - b) / delta + (g < b ? 6 : 0);\r\n          break;\r\n        case g:\r\n          hue = (b - r) / delta + 2;\r\n          break;\r\n        case b:\r\n          hue = (r - g) / delta + 4;\r\n          break;\r\n\r\n      }\r\n\r\n      hue /= 6;\r\n\r\n    }\r\n\r\n    hsl.h = hue;\r\n    hsl.s = saturation;\r\n    hsl.l = lightness;\r\n\r\n    return hsl;\r\n\r\n  },\r\n\r\n  getStyle: function() {\r\n\r\n    return 'rgb(' + ((this.r * 255) | 0) + ',' + ((this.g * 255) | 0) + ',' + ((this.b * 255) | 0) + ')';\r\n\r\n  },\r\n\r\n  offsetHSL: function(h, s, l) {\r\n\r\n    var hsl = this.getHSL();\r\n\r\n    hsl.h += h;\r\n    hsl.s += s;\r\n    hsl.l += l;\r\n\r\n    this.setHSL(hsl.h, hsl.s, hsl.l);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(color) {\r\n\r\n    this.r += color.r;\r\n    this.g += color.g;\r\n    this.b += color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addColors: function(color1, color2) {\r\n\r\n    this.r = color1.r + color2.r;\r\n    this.g = color1.g + color2.g;\r\n    this.b = color1.b + color2.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.r += s;\r\n    this.g += s;\r\n    this.b += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(color) {\r\n\r\n    this.r *= color.r;\r\n    this.g *= color.g;\r\n    this.b *= color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.r *= s;\r\n    this.g *= s;\r\n    this.b *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(color, alpha) {\r\n\r\n    this.r += (color.r - this.r) * alpha;\r\n    this.g += (color.g - this.g) * alpha;\r\n    this.b += (color.b - this.b) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(c) {\r\n\r\n    return (c.r === this.r) && (c.g === this.g) && (c.b === this.b);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.r = array[0];\r\n    this.g = array[1];\r\n    this.b = array[2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.r;\r\n    array[offset + 1] = this.g;\r\n    array[offset + 2] = this.b;\r\n\r\n    return array;\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Color().setRGB(this.r, this.g, this.b);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = {\r\n  'aliceblue': 0xF0F8FF,\r\n  'antiquewhite': 0xFAEBD7,\r\n  'aqua': 0x00FFFF,\r\n  'aquamarine': 0x7FFFD4,\r\n  'azure': 0xF0FFFF,\r\n  'beige': 0xF5F5DC,\r\n  'bisque': 0xFFE4C4,\r\n  'black': 0x000000,\r\n  'blanchedalmond': 0xFFEBCD,\r\n  'blue': 0x0000FF,\r\n  'blueviolet': 0x8A2BE2,\r\n  'brown': 0xA52A2A,\r\n  'burlywood': 0xDEB887,\r\n  'cadetblue': 0x5F9EA0,\r\n  'chartreuse': 0x7FFF00,\r\n  'chocolate': 0xD2691E,\r\n  'coral': 0xFF7F50,\r\n  'cornflowerblue': 0x6495ED,\r\n  'cornsilk': 0xFFF8DC,\r\n  'crimson': 0xDC143C,\r\n  'cyan': 0x00FFFF,\r\n  'darkblue': 0x00008B,\r\n  'darkcyan': 0x008B8B,\r\n  'darkgoldenrod': 0xB8860B,\r\n  'darkgray': 0xA9A9A9,\r\n  'darkgreen': 0x006400,\r\n  'darkgrey': 0xA9A9A9,\r\n  'darkkhaki': 0xBDB76B,\r\n  'darkmagenta': 0x8B008B,\r\n  'darkolivegreen': 0x556B2F,\r\n  'darkorange': 0xFF8C00,\r\n  'darkorchid': 0x9932CC,\r\n  'darkred': 0x8B0000,\r\n  'darksalmon': 0xE9967A,\r\n  'darkseagreen': 0x8FBC8F,\r\n  'darkslateblue': 0x483D8B,\r\n  'darkslategray': 0x2F4F4F,\r\n  'darkslategrey': 0x2F4F4F,\r\n  'darkturquoise': 0x00CED1,\r\n  'darkviolet': 0x9400D3,\r\n  'deeppink': 0xFF1493,\r\n  'deepskyblue': 0x00BFFF,\r\n  'dimgray': 0x696969,\r\n  'dimgrey': 0x696969,\r\n  'dodgerblue': 0x1E90FF,\r\n  'firebrick': 0xB22222,\r\n  'floralwhite': 0xFFFAF0,\r\n  'forestgreen': 0x228B22,\r\n  'fuchsia': 0xFF00FF,\r\n  'gainsboro': 0xDCDCDC,\r\n  'ghostwhite': 0xF8F8FF,\r\n  'gold': 0xFFD700,\r\n  'goldenrod': 0xDAA520,\r\n  'gray': 0x808080,\r\n  'green': 0x008000,\r\n  'greenyellow': 0xADFF2F,\r\n  'grey': 0x808080,\r\n  'honeydew': 0xF0FFF0,\r\n  'hotpink': 0xFF69B4,\r\n  'indianred': 0xCD5C5C,\r\n  'indigo': 0x4B0082,\r\n  'ivory': 0xFFFFF0,\r\n  'khaki': 0xF0E68C,\r\n  'lavender': 0xE6E6FA,\r\n  'lavenderblush': 0xFFF0F5,\r\n  'lawngreen': 0x7CFC00,\r\n  'lemonchiffon': 0xFFFACD,\r\n  'lightblue': 0xADD8E6,\r\n  'lightcoral': 0xF08080,\r\n  'lightcyan': 0xE0FFFF,\r\n  'lightgoldenrodyellow': 0xFAFAD2,\r\n  'lightgray': 0xD3D3D3,\r\n  'lightgreen': 0x90EE90,\r\n  'lightgrey': 0xD3D3D3,\r\n  'lightpink': 0xFFB6C1,\r\n  'lightsalmon': 0xFFA07A,\r\n  'lightseagreen': 0x20B2AA,\r\n  'lightskyblue': 0x87CEFA,\r\n  'lightslategray': 0x778899,\r\n  'lightslategrey': 0x778899,\r\n  'lightsteelblue': 0xB0C4DE,\r\n  'lightyellow': 0xFFFFE0,\r\n  'lime': 0x00FF00,\r\n  'limegreen': 0x32CD32,\r\n  'linen': 0xFAF0E6,\r\n  'magenta': 0xFF00FF,\r\n  'maroon': 0x800000,\r\n  'mediumaquamarine': 0x66CDAA,\r\n  'mediumblue': 0x0000CD,\r\n  'mediumorchid': 0xBA55D3,\r\n  'mediumpurple': 0x9370DB,\r\n  'mediumseagreen': 0x3CB371,\r\n  'mediumslateblue': 0x7B68EE,\r\n  'mediumspringgreen': 0x00FA9A,\r\n  'mediumturquoise': 0x48D1CC,\r\n  'mediumvioletred': 0xC71585,\r\n  'midnightblue': 0x191970,\r\n  'mintcream': 0xF5FFFA,\r\n  'mistyrose': 0xFFE4E1,\r\n  'moccasin': 0xFFE4B5,\r\n  'navajowhite': 0xFFDEAD,\r\n  'navy': 0x000080,\r\n  'oldlace': 0xFDF5E6,\r\n  'olive': 0x808000,\r\n  'olivedrab': 0x6B8E23,\r\n  'orange': 0xFFA500,\r\n  'orangered': 0xFF4500,\r\n  'orchid': 0xDA70D6,\r\n  'palegoldenrod': 0xEEE8AA,\r\n  'palegreen': 0x98FB98,\r\n  'paleturquoise': 0xAFEEEE,\r\n  'palevioletred': 0xDB7093,\r\n  'papayawhip': 0xFFEFD5,\r\n  'peachpuff': 0xFFDAB9,\r\n  'peru': 0xCD853F,\r\n  'pink': 0xFFC0CB,\r\n  'plum': 0xDDA0DD,\r\n  'powderblue': 0xB0E0E6,\r\n  'purple': 0x800080,\r\n  'red': 0xFF0000,\r\n  'rosybrown': 0xBC8F8F,\r\n  'royalblue': 0x4169E1,\r\n  'saddlebrown': 0x8B4513,\r\n  'salmon': 0xFA8072,\r\n  'sandybrown': 0xF4A460,\r\n  'seagreen': 0x2E8B57,\r\n  'seashell': 0xFFF5EE,\r\n  'sienna': 0xA0522D,\r\n  'silver': 0xC0C0C0,\r\n  'skyblue': 0x87CEEB,\r\n  'slateblue': 0x6A5ACD,\r\n  'slategray': 0x708090,\r\n  'slategrey': 0x708090,\r\n  'snow': 0xFFFAFA,\r\n  'springgreen': 0x00FF7F,\r\n  'steelblue': 0x4682B4,\r\n  'tan': 0xD2B48C,\r\n  'teal': 0x008080,\r\n  'thistle': 0xD8BFD8,\r\n  'tomato': 0xFF6347,\r\n  'turquoise': 0x40E0D0,\r\n  'violet': 0xEE82EE,\r\n  'wheat': 0xF5DEB3,\r\n  'white': 0xFFFFFF,\r\n  'whitesmoke': 0xF5F5F5,\r\n  'yellow': 0xFFFF00,\r\n  'yellowgreen': 0x9ACD32\r\n};\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Quaternion = function(x, y, z, w) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n  constructor: THREE.Quaternion,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _w: 0,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get w() {\r\n\r\n    return this._w;\r\n\r\n  },\r\n\r\n  set w(value) {\r\n\r\n    this._w = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._w = w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(quaternion) {\r\n\r\n    this._x = quaternion.x;\r\n    this._y = quaternion.y;\r\n    this._z = quaternion.z;\r\n    this._w = quaternion.w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromEuler: function(euler, update) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      throw new Error('THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n    }\r\n\r\n    // http://www.mathworks.com/matlabcentral/fileexchange/\r\n    // \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n    //\tcontent/SpinCalc.m\r\n\r\n    var c1 = Math.cos(euler._x / 2);\r\n    var c2 = Math.cos(euler._y / 2);\r\n    var c3 = Math.cos(euler._z / 2);\r\n    var s1 = Math.sin(euler._x / 2);\r\n    var s2 = Math.sin(euler._y / 2);\r\n    var s3 = Math.sin(euler._z / 2);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromAxisAngle: function(axis, angle) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n    // assumes axis is normalized\r\n\r\n    var halfAngle = angle / 2,\r\n      s = Math.sin(halfAngle);\r\n\r\n    this._x = axis.x * s;\r\n    this._y = axis.y * s;\r\n    this._z = axis.z * s;\r\n    this._w = Math.cos(halfAngle);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10],\r\n\r\n      trace = m11 + m22 + m33,\r\n      s;\r\n\r\n    if (trace > 0) {\r\n\r\n      s = 0.5 / Math.sqrt(trace + 1.0);\r\n\r\n      this._w = 0.25 / s;\r\n      this._x = (m32 - m23) * s;\r\n      this._y = (m13 - m31) * s;\r\n      this._z = (m21 - m12) * s;\r\n\r\n    }\r\n    else if (m11 > m22 && m11 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\r\n\r\n      this._w = (m32 - m23) / s;\r\n      this._x = 0.25 * s;\r\n      this._y = (m12 + m21) / s;\r\n      this._z = (m13 + m31) / s;\r\n\r\n    }\r\n    else if (m22 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\r\n\r\n      this._w = (m13 - m31) / s;\r\n      this._x = (m12 + m21) / s;\r\n      this._y = 0.25 * s;\r\n      this._z = (m23 + m32) / s;\r\n\r\n    }\r\n    else {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\r\n\r\n      this._w = (m21 - m12) / s;\r\n      this._x = (m13 + m31) / s;\r\n      this._y = (m23 + m32) / s;\r\n      this._z = 0.25 * s;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromUnitVectors: function() {\r\n\r\n    // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n    // assumes direction vectors vFrom and vTo are normalized\r\n\r\n    var v1, r;\r\n\r\n    var EPS = 0.000001;\r\n\r\n    return function(vFrom, vTo) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      r = vFrom.dot(vTo) + 1;\r\n\r\n      if (r < EPS) {\r\n\r\n        r = 0;\r\n\r\n        if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\r\n\r\n          v1.set(-vFrom.y, vFrom.x, 0);\r\n\r\n        }\r\n        else {\r\n\r\n          v1.set(0, -vFrom.z, vFrom.y);\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        v1.crossVectors(vFrom, vTo);\r\n\r\n      }\r\n\r\n      this._x = v1.x;\r\n      this._y = v1.y;\r\n      this._z = v1.z;\r\n      this._w = r;\r\n\r\n      this.normalize();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  inverse: function() {\r\n\r\n    this.conjugate().normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  conjugate: function() {\r\n\r\n    this._x *= -1;\r\n    this._y *= -1;\r\n    this._z *= -1;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    var l = this.length();\r\n\r\n    if (l === 0) {\r\n\r\n      this._x = 0;\r\n      this._y = 0;\r\n      this._z = 0;\r\n      this._w = 1;\r\n\r\n    }\r\n    else {\r\n\r\n      l = 1 / l;\r\n\r\n      this._x = this._x * l;\r\n      this._y = this._y * l;\r\n      this._z = this._z * l;\r\n      this._w = this._w * l;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(q, p) {\r\n\r\n    if (p !== undefined) {\r\n\r\n      THREE.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.');\r\n      return this.multiplyQuaternions(q, p);\r\n\r\n    }\r\n\r\n    return this.multiplyQuaternions(this, q);\r\n\r\n  },\r\n\r\n  multiplyQuaternions: function(a, b) {\r\n\r\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n    var qax = a._x,\r\n      qay = a._y,\r\n      qaz = a._z,\r\n      qaw = a._w;\r\n    var qbx = b._x,\r\n      qby = b._y,\r\n      qbz = b._z,\r\n      qbw = b._w;\r\n\r\n    this._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n    this._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n    this._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n    this._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.');\r\n    return vector.applyQuaternion(this);\r\n\r\n  },\r\n\r\n  slerp: function(qb, t) {\r\n\r\n    if (t === 0) return this;\r\n    if (t === 1) return this.copy(qb);\r\n\r\n    var x = this._x,\r\n      y = this._y,\r\n      z = this._z,\r\n      w = this._w;\r\n\r\n    // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n    var cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n    if (cosHalfTheta < 0) {\r\n\r\n      this._w = -qb._w;\r\n      this._x = -qb._x;\r\n      this._y = -qb._y;\r\n      this._z = -qb._z;\r\n\r\n      cosHalfTheta = -cosHalfTheta;\r\n\r\n    }\r\n    else {\r\n\r\n      this.copy(qb);\r\n\r\n    }\r\n\r\n    if (cosHalfTheta >= 1.0) {\r\n\r\n      this._w = w;\r\n      this._x = x;\r\n      this._y = y;\r\n      this._z = z;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var halfTheta = Math.acos(cosHalfTheta);\r\n    var sinHalfTheta = Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);\r\n\r\n    if (Math.abs(sinHalfTheta) < 0.001) {\r\n\r\n      this._w = 0.5 * (w + this._w);\r\n      this._x = 0.5 * (x + this._x);\r\n      this._y = 0.5 * (y + this._y);\r\n      this._z = 0.5 * (z + this._z);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\r\n      ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n    this._w = (w * ratioA + this._w * ratioB);\r\n    this._x = (x * ratioA + this._x * ratioB);\r\n    this._y = (y * ratioA + this._y * ratioB);\r\n    this._z = (z * ratioA + this._z * ratioB);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(quaternion) {\r\n\r\n    return (quaternion._x === this._x) && (quaternion._y === this._y) && (quaternion._z === this._z) && (quaternion._w === this._w);\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this._x = array[offset];\r\n    this._y = array[offset + 1];\r\n    this._z = array[offset + 2];\r\n    this._w = array[offset + 3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Quaternion(this._x, this._y, this._z, this._w);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Quaternion.slerp = function(qa, qb, qm, t) {\r\n\r\n  return qm.copy(qa).slerp(qb, t);\r\n\r\n}\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function(x, y) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n  constructor: THREE.Vector2,\r\n\r\n  set: function(x, y) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v) {\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.x *= s;\r\n    this.y *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector2();\r\n        max = new THREE.Vector2();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal);\r\n      max.set(maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x,\r\n      dy = this.y - v.y;\r\n    return dx * dx + dy * dy;\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector2(this.x, this.y);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function(x, y, z) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n  constructor: THREE.Vector3,\r\n\r\n  set: function(x, y, z) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.');\r\n      return this.multiplyVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n    this.z *= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVectors: function(a, b) {\r\n\r\n    this.x = a.x * b.x;\r\n    this.y = a.y * b.y;\r\n    this.z = a.z * b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyEuler: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(euler) {\r\n\r\n      if (euler instanceof THREE.Euler === false) {\r\n\r\n        THREE.error('THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n      }\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromEuler(euler));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyAxisAngle: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(axis, angle) {\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromAxisAngle(axis, angle));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix3: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[3] * y + e[6] * z;\r\n    this.y = e[1] * x + e[4] * y + e[7] * z;\r\n    this.z = e[2] * x + e[5] * y + e[8] * z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12];\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13];\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyProjection: function(m) {\r\n\r\n    // input: THREE.Matrix4 projection matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n    var d = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]); // perspective divide\r\n\r\n    this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * d;\r\n    this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * d;\r\n    this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * d;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyQuaternion: function(q) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var qx = q.x;\r\n    var qy = q.y;\r\n    var qz = q.z;\r\n    var qw = q.w;\r\n\r\n    // calculate quat * vector\r\n\r\n    var ix = qw * x + qy * z - qz * y;\r\n    var iy = qw * y + qz * x - qx * z;\r\n    var iz = qw * z + qx * y - qy * x;\r\n    var iw = -qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n\r\n    this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n    this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n    this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  project: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.projectionMatrix, matrix.getInverse(camera.matrixWorld));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  unproject: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.matrixWorld, matrix.getInverse(camera.projectionMatrix));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  transformDirection: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n    // vector interpreted as a direction\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z;\r\n\r\n    this.normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n    this.z /= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector3();\r\n        max = new THREE.Vector3();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  cross: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.');\r\n      return this.crossVectors(v, w);\r\n\r\n    }\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    this.x = y * v.z - z * v.y;\r\n    this.y = z * v.x - x * v.z;\r\n    this.z = x * v.y - y * v.x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  crossVectors: function(a, b) {\r\n\r\n    var ax = a.x,\r\n      ay = a.y,\r\n      az = a.z;\r\n    var bx = b.x,\r\n      by = b.y,\r\n      bz = b.z;\r\n\r\n    this.x = ay * bz - az * by;\r\n    this.y = az * bx - ax * bz;\r\n    this.z = ax * by - ay * bx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  projectOnVector: function() {\r\n\r\n    var v1, dot;\r\n\r\n    return function(vector) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(vector).normalize();\r\n\r\n      dot = this.dot(v1);\r\n\r\n      return this.copy(v1).multiplyScalar(dot);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  projectOnPlane: function() {\r\n\r\n    var v1;\r\n\r\n    return function(planeNormal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(this).projectOnVector(planeNormal);\r\n\r\n      return this.sub(v1);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  reflect: function() {\r\n\r\n    // reflect incident vector off plane orthogonal to normal\r\n    // normal is assumed to have unit length\r\n\r\n    var v1;\r\n\r\n    return function(normal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      return this.sub(v1.copy(normal).multiplyScalar(2 * this.dot(normal)));\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  angleTo: function(v) {\r\n\r\n    var theta = this.dot(v) / (this.length() * v.length());\r\n\r\n    // clamp, to handle numerical problems\r\n\r\n    return Math.acos(THREE.Math.clamp(theta, -1, 1));\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x;\r\n    var dy = this.y - v.y;\r\n    var dz = this.z - v.z;\r\n\r\n    return dx * dx + dy * dy + dz * dz;\r\n\r\n  },\r\n\r\n  setEulerFromRotationMatrix: function(m, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.');\r\n\r\n  },\r\n\r\n  setEulerFromQuaternion: function(q, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.');\r\n\r\n  },\r\n\r\n  getPositionFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().');\r\n\r\n    return this.setFromMatrixPosition(m);\r\n\r\n  },\r\n\r\n  getScaleFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().');\r\n\r\n    return this.setFromMatrixScale(m);\r\n  },\r\n\r\n  getColumnFromMatrix: function(index, matrix) {\r\n\r\n    THREE.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().');\r\n\r\n    return this.setFromMatrixColumn(index, matrix);\r\n\r\n  },\r\n\r\n  setFromMatrixPosition: function(m) {\r\n\r\n    this.x = m.elements[12];\r\n    this.y = m.elements[13];\r\n    this.z = m.elements[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrixScale: function(m) {\r\n\r\n    var sx = this.set(m.elements[0], m.elements[1], m.elements[2]).length();\r\n    var sy = this.set(m.elements[4], m.elements[5], m.elements[6]).length();\r\n    var sz = this.set(m.elements[8], m.elements[9], m.elements[10]).length();\r\n\r\n    this.x = sx;\r\n    this.y = sy;\r\n    this.z = sz;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromMatrixColumn: function(index, matrix) {\r\n\r\n    var offset = index * 4;\r\n\r\n    var me = matrix.elements;\r\n\r\n    this.x = me[offset];\r\n    this.y = me[offset + 1];\r\n    this.z = me[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector3(this.x, this.y, this.z);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function(x, y, z, w) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n  this.w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n  constructor: THREE.Vector4,\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setW: function(w) {\r\n\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      case 3:\r\n        this.w = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      case 3:\r\n        return this.w;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n    this.w = (v.w !== undefined) ? v.w : 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n    this.w += v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n    this.w += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n    this.w = a.w + b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n    this.w -= v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n    this.w -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n    this.w = a.w - b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n    this.w *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n    var w = this.w;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12] * w;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13] * w;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14] * w;\r\n    this.w = e[3] * x + e[7] * y + e[11] * z + e[15] * w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n      this.w *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n      this.w = 1;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromQuaternion: function(q) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n    // q is assumed to be normalized\r\n\r\n    this.w = 2 * Math.acos(q.w);\r\n\r\n    var s = Math.sqrt(1 - q.w * q.w);\r\n\r\n    if (s < 0.0001) {\r\n\r\n      this.x = 1;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = q.x / s;\r\n      this.y = q.y / s;\r\n      this.z = q.z / s;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var angle, x, y, z, // variables for result\r\n      epsilon = 0.01, // margin to allow for rounding errors\r\n      epsilon2 = 0.1, // margin to distinguish between 0 and 180 degrees\r\n\r\n      te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    if ((Math.abs(m12 - m21) < epsilon) && (Math.abs(m13 - m31) < epsilon) && (Math.abs(m23 - m32) < epsilon)) {\r\n\r\n      // singularity found\r\n      // first check for identity matrix which must have +1 for all terms\r\n      // in leading diagonal and zero in other terms\r\n\r\n      if ((Math.abs(m12 + m21) < epsilon2) && (Math.abs(m13 + m31) < epsilon2) && (Math.abs(m23 + m32) < epsilon2) && (Math.abs(m11 + m22 + m33 - 3) < epsilon2)) {\r\n\r\n        // this singularity is identity matrix so angle = 0\r\n\r\n        this.set(1, 0, 0, 0);\r\n\r\n        return this; // zero angle, arbitrary axis\r\n\r\n      }\r\n\r\n      // otherwise this singularity is angle = 180\r\n\r\n      angle = Math.PI;\r\n\r\n      var xx = (m11 + 1) / 2;\r\n      var yy = (m22 + 1) / 2;\r\n      var zz = (m33 + 1) / 2;\r\n      var xy = (m12 + m21) / 4;\r\n      var xz = (m13 + m31) / 4;\r\n      var yz = (m23 + m32) / 4;\r\n\r\n      if ((xx > yy) && (xx > zz)) { // m11 is the largest diagonal term\r\n\r\n        if (xx < epsilon) {\r\n\r\n          x = 0;\r\n          y = 0.707106781;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          x = Math.sqrt(xx);\r\n          y = xy / x;\r\n          z = xz / x;\r\n\r\n        }\r\n\r\n      }\r\n      else if (yy > zz) { // m22 is the largest diagonal term\r\n\r\n        if (yy < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          y = Math.sqrt(yy);\r\n          x = xy / y;\r\n          z = yz / y;\r\n\r\n        }\r\n\r\n      }\r\n      else { // m33 is the largest diagonal term so base result on this\r\n\r\n        if (zz < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0.707106781;\r\n          z = 0;\r\n\r\n        }\r\n        else {\r\n\r\n          z = Math.sqrt(zz);\r\n          x = xz / z;\r\n          y = yz / z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.set(x, y, z, angle);\r\n\r\n      return this; // return 180 deg rotation\r\n\r\n    }\r\n\r\n    // as we have reached here there are no singularities so we can handle normally\r\n\r\n    var s = Math.sqrt((m32 - m23) * (m32 - m23) + (m13 - m31) * (m13 - m31) + (m21 - m12) * (m21 - m12)); // used to normalize\r\n\r\n    if (Math.abs(s) < 0.001) s = 1;\r\n\r\n    // prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n    // caught by singularity test above, but I've left it in just in case\r\n\r\n    this.x = (m32 - m23) / s;\r\n    this.y = (m13 - m31) / s;\r\n    this.z = (m21 - m12) / s;\r\n    this.w = Math.acos((m11 + m22 + m33 - 1) / 2);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w > v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w < v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    if (this.w < min.w) {\r\n\r\n      this.w = min.w;\r\n\r\n    }\r\n    else if (this.w > max.w) {\r\n\r\n      this.w = max.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector4();\r\n        max = new THREE.Vector4();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n    this.w = Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n    this.w = Math.ceil(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n    this.w = Math.round(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n    this.w = (this.w < 0) ? Math.ceil(this.w) : Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n    this.w = -this.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n    this.w += (v.w - this.w) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z) && (v.w === this.w));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n    this.w = array[offset + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n    array[offset + 3] = this.w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n    this.w = attribute.array[index + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector4(this.x, this.y, this.z, this.w);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Euler = function(x, y, z, order) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n  constructor: THREE.Euler,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _order: THREE.Euler.DefaultOrder,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get order() {\r\n\r\n    return this._order;\r\n\r\n  },\r\n\r\n  set order(value) {\r\n\r\n    this._order = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, order) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._order = order || this._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(euler) {\r\n\r\n    this._x = euler._x;\r\n    this._y = euler._y;\r\n    this._z = euler._z;\r\n    this._order = euler._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m, order, update) {\r\n\r\n    var clamp = THREE.Math.clamp;\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements;\r\n    var m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8];\r\n    var m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9];\r\n    var m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    order = order || this._order;\r\n\r\n    if (order === 'XYZ') {\r\n\r\n      this._y = Math.asin(clamp(m13, -1, 1));\r\n\r\n      if (Math.abs(m13) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._z = Math.atan2(-m12, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YXZ') {\r\n\r\n      this._x = Math.asin(-clamp(m23, -1, 1));\r\n\r\n      if (Math.abs(m23) < 0.99999) {\r\n\r\n        this._y = Math.atan2(m13, m33);\r\n        this._z = Math.atan2(m21, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = Math.atan2(-m31, m11);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZXY') {\r\n\r\n      this._x = Math.asin(clamp(m32, -1, 1));\r\n\r\n      if (Math.abs(m32) < 0.99999) {\r\n\r\n        this._y = Math.atan2(-m31, m33);\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = 0;\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZYX') {\r\n\r\n      this._y = Math.asin(-clamp(m31, -1, 1));\r\n\r\n      if (Math.abs(m31) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m33);\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YZX') {\r\n\r\n      this._z = Math.asin(clamp(m21, -1, 1));\r\n\r\n      if (Math.abs(m21) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m22);\r\n        this._y = Math.atan2(-m31, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._y = Math.atan2(m13, m33);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'XZY') {\r\n\r\n      this._z = Math.asin(-clamp(m12, -1, 1));\r\n\r\n      if (Math.abs(m12) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._y = Math.atan2(m13, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._y = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order)\r\n\r\n    }\r\n\r\n    this._order = order;\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromQuaternion: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(q, order, update) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n      matrix.makeRotationFromQuaternion(q);\r\n      this.setFromRotationMatrix(matrix, order, update);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromVector3: function(v, order) {\r\n\r\n    return this.set(v.x, v.y, v.z, order || this._order);\r\n\r\n  },\r\n\r\n  reorder: function() {\r\n\r\n    // WARNING: this discards revolution information -bhouston\r\n\r\n    var q = new THREE.Quaternion();\r\n\r\n    return function(newOrder) {\r\n\r\n      q.setFromEuler(this);\r\n      this.setFromQuaternion(q, newOrder);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  equals: function(euler) {\r\n\r\n    return (euler._x === this._x) && (euler._y === this._y) && (euler._z === this._z) && (euler._order === this._order);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this._x = array[0];\r\n    this._y = array[1];\r\n    this._z = array[2];\r\n    if (array[3] !== undefined) this._order = array[3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._order;\r\n\r\n    return array;\r\n  },\r\n\r\n  toVector3: function(optionalResult) {\r\n\r\n    if (optionalResult) {\r\n\r\n      return optionalResult.set(this._x, this._y, this._z);\r\n\r\n    }\r\n    else {\r\n\r\n      return new THREE.Vector3(this._x, this._y, this._z);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Euler(this._x, this._y, this._z, this._order);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Line3 = function(start, end) {\r\n\r\n  this.start = (start !== undefined) ? start : new THREE.Vector3();\r\n  this.end = (end !== undefined) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n  constructor: THREE.Line3,\r\n\r\n  set: function(start, end) {\r\n\r\n    this.start.copy(start);\r\n    this.end.copy(end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(line) {\r\n\r\n    this.start.copy(line.start);\r\n    this.end.copy(line.end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.start, this.end).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  delta: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.end, this.start);\r\n\r\n  },\r\n\r\n  distanceSq: function() {\r\n\r\n    return this.start.distanceToSquared(this.end);\r\n\r\n  },\r\n\r\n  distance: function() {\r\n\r\n    return this.start.distanceTo(this.end);\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  closestPointToPointParameter: function() {\r\n\r\n    var startP = new THREE.Vector3();\r\n    var startEnd = new THREE.Vector3();\r\n\r\n    return function(point, clampToLine) {\r\n\r\n      startP.subVectors(point, this.start);\r\n      startEnd.subVectors(this.end, this.start);\r\n\r\n      var startEnd2 = startEnd.dot(startEnd);\r\n      var startEnd_startP = startEnd.dot(startP);\r\n\r\n      var t = startEnd_startP / startEnd2;\r\n\r\n      if (clampToLine) {\r\n\r\n        t = THREE.Math.clamp(t, 0, 1);\r\n\r\n      }\r\n\r\n      return t;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, clampToLine, optionalTarget) {\r\n\r\n    var t = this.closestPointToPointParameter(point, clampToLine);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.start.applyMatrix4(matrix);\r\n    this.end.applyMatrix4(matrix);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(line) {\r\n\r\n    return line.start.equals(this.start) && line.end.equals(this.end);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Line3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Box2 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector2(Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector2(-Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n  constructor: THREE.Box2,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = Infinity;\r\n    this.max.x = this.max.y = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box2().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector3(Infinity, Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector3(-Infinity, -Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n  constructor: THREE.Box3,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromObject: function() {\r\n\r\n    // Computes the world-axis-aligned bounding box of an object (including its children),\r\n    // accounting for both the object's, and childrens', world transforms\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(object) {\r\n\r\n      var scope = this;\r\n\r\n      object.updateMatrixWorld(true);\r\n\r\n      this.makeEmpty();\r\n\r\n      object.traverse(function(node) {\r\n\r\n        var geometry = node.geometry;\r\n\r\n        if (geometry !== undefined) {\r\n\r\n          if (geometry instanceof THREE.Geometry) {\r\n\r\n            var vertices = geometry.vertices;\r\n\r\n            for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n              v1.copy(vertices[i]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n          else if (geometry instanceof THREE.BufferGeometry && geometry.attributes['position'] !== undefined) {\r\n\r\n            var positions = geometry.attributes['position'].array;\r\n\r\n            for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n              v1.set(positions[i], positions[i + 1], positions[i + 2]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      });\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = this.min.z = Infinity;\r\n    this.max.x = this.max.y = this.max.z = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y) || (this.max.z < this.min.z);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y ||\r\n      point.z < this.min.z || point.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y) &&\r\n      (this.min.z <= box.min.z) && (box.max.z <= this.max.z)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y), (point.z - this.min.z) / (this.max.z - this.min.z)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y ||\r\n      box.max.z < this.min.z || box.min.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  getBoundingSphere: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Sphere();\r\n\r\n      result.center = this.center();\r\n      result.radius = this.size(v1).length() * 0.5;\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var points = [\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3()\r\n    ];\r\n\r\n    return function(matrix) {\r\n\r\n      // NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n      points[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(matrix); // 000\r\n      points[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(matrix); // 001\r\n      points[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(matrix); // 010\r\n      points[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(matrix); // 011\r\n      points[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(matrix); // 100\r\n      points[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(matrix); // 101\r\n      points[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(matrix); // 110\r\n      points[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(matrix); // 111\r\n\r\n      this.makeEmpty();\r\n      this.setFromPoints(points);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Matrix3 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0,\r\n    0, 1, 0,\r\n    0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n  constructor: THREE.Matrix3,\r\n\r\n  set: function(n11, n12, n13, n21, n22, n23, n31, n32, n33) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[3] = n12;\r\n    te[6] = n13;\r\n    te[1] = n21;\r\n    te[4] = n22;\r\n    te[7] = n23;\r\n    te[2] = n31;\r\n    te[5] = n32;\r\n    te[8] = n33;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0,\r\n      0, 1, 0,\r\n      0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    var me = m.elements;\r\n\r\n    this.set(\r\n\r\n      me[0], me[3], me[6],\r\n      me[1], me[4], me[7],\r\n      me[2], me[5], me[8]\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.');\r\n    return vector.applyMatrix3(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix3(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[3] *= s;\r\n    te[6] *= s;\r\n    te[1] *= s;\r\n    te[4] *= s;\r\n    te[7] *= s;\r\n    te[2] *= s;\r\n    te[5] *= s;\r\n    te[8] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var a = te[0],\r\n      b = te[1],\r\n      c = te[2],\r\n      d = te[3],\r\n      e = te[4],\r\n      f = te[5],\r\n      g = te[6],\r\n      h = te[7],\r\n      i = te[8];\r\n\r\n    return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n  },\r\n\r\n  getInverse: function(matrix, throwOnInvertible) {\r\n\r\n    // input: THREE.Matrix4\r\n    // ( based on http://code.google.com/p/webgl-mjs/ )\r\n\r\n    var me = matrix.elements;\r\n    var te = this.elements;\r\n\r\n    te[0] = me[10] * me[5] - me[6] * me[9];\r\n    te[1] = -me[10] * me[1] + me[2] * me[9];\r\n    te[2] = me[6] * me[1] - me[2] * me[5];\r\n    te[3] = -me[10] * me[4] + me[6] * me[8];\r\n    te[4] = me[10] * me[0] - me[2] * me[8];\r\n    te[5] = -me[6] * me[0] + me[2] * me[4];\r\n    te[6] = me[9] * me[4] - me[5] * me[8];\r\n    te[7] = -me[9] * me[0] + me[1] * me[8];\r\n    te[8] = me[5] * me[0] - me[1] * me[4];\r\n\r\n    var det = me[0] * te[0] + me[1] * te[3] + me[2] * te[6];\r\n\r\n    // no inverse\r\n\r\n    if (det === 0) {\r\n\r\n      var msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    this.multiplyScalar(1.0 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var tmp, m = this.elements;\r\n\r\n    tmp = m[1];\r\n    m[1] = m[3];\r\n    m[3] = tmp;\r\n    tmp = m[2];\r\n    m[2] = m[6];\r\n    m[6] = tmp;\r\n    tmp = m[5];\r\n    m[5] = m[7];\r\n    m[7] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n\r\n    array[offset + 3] = te[3];\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n    array[offset + 8] = te[8];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getNormalMatrix: function(m) {\r\n\r\n    // input: THREE.Matrix4\r\n\r\n    this.getInverse(m).transpose();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transposeIntoArray: function(r) {\r\n\r\n    var m = this.elements;\r\n\r\n    r[0] = m[0];\r\n    r[1] = m[3];\r\n    r[2] = m[6];\r\n    r[3] = m[1];\r\n    r[4] = m[4];\r\n    r[5] = m[7];\r\n    r[6] = m[2];\r\n    r[7] = m[5];\r\n    r[8] = m[8];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2],\r\n      te[3], te[4], te[5],\r\n      te[6], te[7], te[8]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix3().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n  constructor: THREE.Matrix4,\r\n\r\n  set: function(n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[4] = n12;\r\n    te[8] = n13;\r\n    te[12] = n14;\r\n    te[1] = n21;\r\n    te[5] = n22;\r\n    te[9] = n23;\r\n    te[13] = n24;\r\n    te[2] = n31;\r\n    te[6] = n32;\r\n    te[10] = n33;\r\n    te[14] = n34;\r\n    te[3] = n41;\r\n    te[7] = n42;\r\n    te[11] = n43;\r\n    te[15] = n44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, 1, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    this.elements.set(m.elements);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractPosition: function(m) {\r\n\r\n    THREE.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().');\r\n    return this.copyPosition(m);\r\n\r\n  },\r\n\r\n  copyPosition: function(m) {\r\n\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    te[12] = me[12];\r\n    te[13] = me[13];\r\n    te[14] = me[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    var te = this.elements;\r\n\r\n    xAxis.set(te[0], te[1], te[2]);\r\n    yAxis.set(te[4], te[5], te[6]);\r\n    zAxis.set(te[8], te[9], te[10]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    this.set(\r\n      xAxis.x, yAxis.x, zAxis.x, 0,\r\n      xAxis.y, yAxis.y, zAxis.y, 0,\r\n      xAxis.z, yAxis.z, zAxis.z, 0,\r\n      0, 0, 0, 1\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractRotation: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(m) {\r\n\r\n      var te = this.elements;\r\n      var me = m.elements;\r\n\r\n      var scaleX = 1 / v1.set(me[0], me[1], me[2]).length();\r\n      var scaleY = 1 / v1.set(me[4], me[5], me[6]).length();\r\n      var scaleZ = 1 / v1.set(me[8], me[9], me[10]).length();\r\n\r\n      te[0] = me[0] * scaleX;\r\n      te[1] = me[1] * scaleX;\r\n      te[2] = me[2] * scaleX;\r\n\r\n      te[4] = me[4] * scaleY;\r\n      te[5] = me[5] * scaleY;\r\n      te[6] = me[6] * scaleY;\r\n\r\n      te[8] = me[8] * scaleZ;\r\n      te[9] = me[9] * scaleZ;\r\n      te[10] = me[10] * scaleZ;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeRotationFromEuler: function(euler) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      THREE.error('THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n    }\r\n\r\n    var te = this.elements;\r\n\r\n    var x = euler.x,\r\n      y = euler.y,\r\n      z = euler.z;\r\n    var a = Math.cos(x),\r\n      b = Math.sin(x);\r\n    var c = Math.cos(y),\r\n      d = Math.sin(y);\r\n    var e = Math.cos(z),\r\n      f = Math.sin(z);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -c * f;\r\n      te[8] = d;\r\n\r\n      te[1] = af + be * d;\r\n      te[5] = ae - bf * d;\r\n      te[9] = -b * c;\r\n\r\n      te[2] = bf - ae * d;\r\n      te[6] = be + af * d;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce + df * b;\r\n      te[4] = de * b - cf;\r\n      te[8] = a * d;\r\n\r\n      te[1] = a * f;\r\n      te[5] = a * e;\r\n      te[9] = -b;\r\n\r\n      te[2] = cf * b - de;\r\n      te[6] = df + ce * b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce - df * b;\r\n      te[4] = -a * f;\r\n      te[8] = de + cf * b;\r\n\r\n      te[1] = cf + de * b;\r\n      te[5] = a * e;\r\n      te[9] = df - ce * b;\r\n\r\n      te[2] = -a * d;\r\n      te[6] = b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = be * d - af;\r\n      te[8] = ae * d + bf;\r\n\r\n      te[1] = c * f;\r\n      te[5] = bf * d + ae;\r\n      te[9] = af * d - be;\r\n\r\n      te[2] = -d;\r\n      te[6] = b * c;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = bd - ac * f;\r\n      te[8] = bc * f + ad;\r\n\r\n      te[1] = f;\r\n      te[5] = a * e;\r\n      te[9] = -b * e;\r\n\r\n      te[2] = -d * e;\r\n      te[6] = ad * f + bc;\r\n      te[10] = ac - bd * f;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -f;\r\n      te[8] = d * e;\r\n\r\n      te[1] = ac * f + bd;\r\n      te[5] = a * e;\r\n      te[9] = ad * f - bc;\r\n\r\n      te[2] = bc * f - ad;\r\n      te[6] = b * e;\r\n      te[10] = bd * f + ac;\r\n\r\n    }\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    THREE.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().');\r\n\r\n    return this.makeRotationFromQuaternion(q);\r\n\r\n  },\r\n\r\n  makeRotationFromQuaternion: function(q) {\r\n\r\n    var te = this.elements;\r\n\r\n    var x = q.x,\r\n      y = q.y,\r\n      z = q.z,\r\n      w = q.w;\r\n    var x2 = x + x,\r\n      y2 = y + y,\r\n      z2 = z + z;\r\n    var xx = x * x2,\r\n      xy = x * y2,\r\n      xz = x * z2;\r\n    var yy = y * y2,\r\n      yz = y * z2,\r\n      zz = z * z2;\r\n    var wx = w * x2,\r\n      wy = w * y2,\r\n      wz = w * z2;\r\n\r\n    te[0] = 1 - (yy + zz);\r\n    te[4] = xy - wz;\r\n    te[8] = xz + wy;\r\n\r\n    te[1] = xy + wz;\r\n    te[5] = 1 - (xx + zz);\r\n    te[9] = yz - wx;\r\n\r\n    te[2] = xz - wy;\r\n    te[6] = yz + wx;\r\n    te[10] = 1 - (xx + yy);\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lookAt: function() {\r\n\r\n    var x = new THREE.Vector3();\r\n    var y = new THREE.Vector3();\r\n    var z = new THREE.Vector3();\r\n\r\n    return function(eye, target, up) {\r\n\r\n      var te = this.elements;\r\n\r\n      z.subVectors(eye, target).normalize();\r\n\r\n      if (z.length() === 0) {\r\n\r\n        z.z = 1;\r\n\r\n      }\r\n\r\n      x.crossVectors(up, z).normalize();\r\n\r\n      if (x.length() === 0) {\r\n\r\n        z.x += 0.0001;\r\n        x.crossVectors(up, z).normalize();\r\n\r\n      }\r\n\r\n      y.crossVectors(z, x);\r\n\r\n\r\n      te[0] = x.x;\r\n      te[4] = y.x;\r\n      te[8] = z.x;\r\n      te[1] = x.y;\r\n      te[5] = y.y;\r\n      te[9] = z.y;\r\n      te[2] = x.z;\r\n      te[6] = y.z;\r\n      te[10] = z.z;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiply: function(m, n) {\r\n\r\n    if (n !== undefined) {\r\n\r\n      THREE.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.');\r\n      return this.multiplyMatrices(m, n);\r\n\r\n    }\r\n\r\n    return this.multiplyMatrices(this, m);\r\n\r\n  },\r\n\r\n  multiplyMatrices: function(a, b) {\r\n\r\n    var ae = a.elements;\r\n    var be = b.elements;\r\n    var te = this.elements;\r\n\r\n    var a11 = ae[0],\r\n      a12 = ae[4],\r\n      a13 = ae[8],\r\n      a14 = ae[12];\r\n    var a21 = ae[1],\r\n      a22 = ae[5],\r\n      a23 = ae[9],\r\n      a24 = ae[13];\r\n    var a31 = ae[2],\r\n      a32 = ae[6],\r\n      a33 = ae[10],\r\n      a34 = ae[14];\r\n    var a41 = ae[3],\r\n      a42 = ae[7],\r\n      a43 = ae[11],\r\n      a44 = ae[15];\r\n\r\n    var b11 = be[0],\r\n      b12 = be[4],\r\n      b13 = be[8],\r\n      b14 = be[12];\r\n    var b21 = be[1],\r\n      b22 = be[5],\r\n      b23 = be[9],\r\n      b24 = be[13];\r\n    var b31 = be[2],\r\n      b32 = be[6],\r\n      b33 = be[10],\r\n      b34 = be[14];\r\n    var b41 = be[3],\r\n      b42 = be[7],\r\n      b43 = be[11],\r\n      b44 = be[15];\r\n\r\n    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyToArray: function(a, b, r) {\r\n\r\n    var te = this.elements;\r\n\r\n    this.multiplyMatrices(a, b);\r\n\r\n    r[0] = te[0];\r\n    r[1] = te[1];\r\n    r[2] = te[2];\r\n    r[3] = te[3];\r\n    r[4] = te[4];\r\n    r[5] = te[5];\r\n    r[6] = te[6];\r\n    r[7] = te[7];\r\n    r[8] = te[8];\r\n    r[9] = te[9];\r\n    r[10] = te[10];\r\n    r[11] = te[11];\r\n    r[12] = te[12];\r\n    r[13] = te[13];\r\n    r[14] = te[14];\r\n    r[15] = te[15];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[4] *= s;\r\n    te[8] *= s;\r\n    te[12] *= s;\r\n    te[1] *= s;\r\n    te[5] *= s;\r\n    te[9] *= s;\r\n    te[13] *= s;\r\n    te[2] *= s;\r\n    te[6] *= s;\r\n    te[10] *= s;\r\n    te[14] *= s;\r\n    te[3] *= s;\r\n    te[7] *= s;\r\n    te[11] *= s;\r\n    te[15] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.');\r\n    return vector.applyProjection(this);\r\n\r\n  },\r\n\r\n  multiplyVector4: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix4(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateAxis: function(v) {\r\n\r\n    THREE.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.');\r\n\r\n    v.transformDirection(this);\r\n\r\n  },\r\n\r\n  crossVector: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var n11 = te[0],\r\n      n12 = te[4],\r\n      n13 = te[8],\r\n      n14 = te[12];\r\n    var n21 = te[1],\r\n      n22 = te[5],\r\n      n23 = te[9],\r\n      n24 = te[13];\r\n    var n31 = te[2],\r\n      n32 = te[6],\r\n      n33 = te[10],\r\n      n34 = te[14];\r\n    var n41 = te[3],\r\n      n42 = te[7],\r\n      n43 = te[11],\r\n      n44 = te[15];\r\n\r\n    //TODO: make this more efficient\r\n    //( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n    return (\r\n      n41 * (+n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34) +\r\n      n42 * (+n11 * n23 * n34 - n11 * n24 * n33 + n14 * n21 * n33 - n13 * n21 * n34 + n13 * n24 * n31 - n14 * n23 * n31) +\r\n      n43 * (+n11 * n24 * n32 - n11 * n22 * n34 - n14 * n21 * n32 + n12 * n21 * n34 + n14 * n22 * n31 - n12 * n24 * n31) +\r\n      n44 * (-n13 * n22 * n31 - n11 * n23 * n32 + n11 * n22 * n33 + n13 * n21 * n32 - n12 * n21 * n33 + n12 * n23 * n31)\r\n\r\n    );\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var te = this.elements;\r\n    var tmp;\r\n\r\n    tmp = te[1];\r\n    te[1] = te[4];\r\n    te[4] = tmp;\r\n    tmp = te[2];\r\n    te[2] = te[8];\r\n    te[8] = tmp;\r\n    tmp = te[6];\r\n    te[6] = te[9];\r\n    te[9] = tmp;\r\n\r\n    tmp = te[3];\r\n    te[3] = te[12];\r\n    te[12] = tmp;\r\n    tmp = te[7];\r\n    te[7] = te[13];\r\n    te[13] = tmp;\r\n    tmp = te[11];\r\n    te[11] = te[14];\r\n    te[14] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n    array[offset + 3] = te[3];\r\n\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n\r\n    array[offset + 8] = te[8];\r\n    array[offset + 9] = te[9];\r\n    array[offset + 10] = te[10];\r\n    array[offset + 11] = te[11];\r\n\r\n    array[offset + 12] = te[12];\r\n    array[offset + 13] = te[13];\r\n    array[offset + 14] = te[14];\r\n    array[offset + 15] = te[15];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getPosition: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      THREE.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.');\r\n\r\n      var te = this.elements;\r\n      return v1.set(te[12], te[13], te[14]);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setPosition: function(v) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[12] = v.x;\r\n    te[13] = v.y;\r\n    te[14] = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getInverse: function(m, throwOnInvertible) {\r\n\r\n    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    var n11 = me[0],\r\n      n12 = me[4],\r\n      n13 = me[8],\r\n      n14 = me[12];\r\n    var n21 = me[1],\r\n      n22 = me[5],\r\n      n23 = me[9],\r\n      n24 = me[13];\r\n    var n31 = me[2],\r\n      n32 = me[6],\r\n      n33 = me[10],\r\n      n34 = me[14];\r\n    var n41 = me[3],\r\n      n42 = me[7],\r\n      n43 = me[11],\r\n      n44 = me[15];\r\n\r\n    te[0] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n    te[4] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n    te[8] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n    te[12] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n    te[1] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n    te[5] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n    te[9] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n    te[13] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n    te[2] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n    te[6] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n    te[10] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n    te[14] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n    te[3] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n    te[7] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n    te[11] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n    te[15] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n    var det = n11 * te[0] + n21 * te[4] + n31 * te[8] + n41 * te[12];\r\n\r\n    if (det == 0) {\r\n\r\n      var msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n    }\r\n\r\n    this.multiplyScalar(1 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(v) {\r\n\r\n    THREE.error('THREE.Matrix4: .translate() has been removed.');\r\n\r\n  },\r\n\r\n  rotateX: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateX() has been removed.');\r\n\r\n  },\r\n\r\n  rotateY: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateY() has been removed.');\r\n\r\n  },\r\n\r\n  rotateZ: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateZ() has been removed.');\r\n\r\n  },\r\n\r\n  rotateByAxis: function(axis, angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateByAxis() has been removed.');\r\n\r\n  },\r\n\r\n  scale: function(v) {\r\n\r\n    var te = this.elements;\r\n    var x = v.x,\r\n      y = v.y,\r\n      z = v.z;\r\n\r\n    te[0] *= x;\r\n    te[4] *= y;\r\n    te[8] *= z;\r\n    te[1] *= x;\r\n    te[5] *= y;\r\n    te[9] *= z;\r\n    te[2] *= x;\r\n    te[6] *= y;\r\n    te[10] *= z;\r\n    te[3] *= x;\r\n    te[7] *= y;\r\n    te[11] *= z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getMaxScaleOnAxis: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var scaleXSq = te[0] * te[0] + te[1] * te[1] + te[2] * te[2];\r\n    var scaleYSq = te[4] * te[4] + te[5] * te[5] + te[6] * te[6];\r\n    var scaleZSq = te[8] * te[8] + te[9] * te[9] + te[10] * te[10];\r\n\r\n    return Math.sqrt(Math.max(scaleXSq, Math.max(scaleYSq, scaleZSq)));\r\n\r\n  },\r\n\r\n  makeTranslation: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, x,\r\n      0, 1, 0, y,\r\n      0, 0, 1, z,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationX: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, c, -s, 0,\r\n      0, s, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationY: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, 0, s, 0,\r\n      0, 1, 0, 0, -s, 0, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationZ: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, -s, 0, 0,\r\n      s, c, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationAxis: function(axis, angle) {\r\n\r\n    // Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n    var c = Math.cos(angle);\r\n    var s = Math.sin(angle);\r\n    var t = 1 - c;\r\n    var x = axis.x,\r\n      y = axis.y,\r\n      z = axis.z;\r\n    var tx = t * x,\r\n      ty = t * y;\r\n\r\n    this.set(\r\n\r\n      tx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n      tx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n      tx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeScale: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      x, 0, 0, 0,\r\n      0, y, 0, 0,\r\n      0, 0, z, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  compose: function(position, quaternion, scale) {\r\n\r\n    this.makeRotationFromQuaternion(quaternion);\r\n    this.scale(scale);\r\n    this.setPosition(position);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  decompose: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(position, quaternion, scale) {\r\n\r\n      var te = this.elements;\r\n\r\n      var sx = vector.set(te[0], te[1], te[2]).length();\r\n      var sy = vector.set(te[4], te[5], te[6]).length();\r\n      var sz = vector.set(te[8], te[9], te[10]).length();\r\n\r\n      // if determine is negative, we need to invert one scale\r\n      var det = this.determinant();\r\n      if (det < 0) {\r\n        sx = -sx;\r\n      }\r\n\r\n      position.x = te[12];\r\n      position.y = te[13];\r\n      position.z = te[14];\r\n\r\n      // scale the rotation part\r\n\r\n      matrix.elements.set(this.elements); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n      var invSX = 1 / sx;\r\n      var invSY = 1 / sy;\r\n      var invSZ = 1 / sz;\r\n\r\n      matrix.elements[0] *= invSX;\r\n      matrix.elements[1] *= invSX;\r\n      matrix.elements[2] *= invSX;\r\n\r\n      matrix.elements[4] *= invSY;\r\n      matrix.elements[5] *= invSY;\r\n      matrix.elements[6] *= invSY;\r\n\r\n      matrix.elements[8] *= invSZ;\r\n      matrix.elements[9] *= invSZ;\r\n      matrix.elements[10] *= invSZ;\r\n\r\n      quaternion.setFromRotationMatrix(matrix);\r\n\r\n      scale.x = sx;\r\n      scale.y = sy;\r\n      scale.z = sz;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeFrustum: function(left, right, bottom, top, near, far) {\r\n\r\n    var te = this.elements;\r\n    var x = 2 * near / (right - left);\r\n    var y = 2 * near / (top - bottom);\r\n\r\n    var a = (right + left) / (right - left);\r\n    var b = (top + bottom) / (top - bottom);\r\n    var c = -(far + near) / (far - near);\r\n    var d = -2 * far * near / (far - near);\r\n\r\n    te[0] = x;\r\n    te[4] = 0;\r\n    te[8] = a;\r\n    te[12] = 0;\r\n    te[1] = 0;\r\n    te[5] = y;\r\n    te[9] = b;\r\n    te[13] = 0;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = c;\r\n    te[14] = d;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = -1;\r\n    te[15] = 0;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makePerspective: function(fov, aspect, near, far) {\r\n\r\n    var ymax = near * Math.tan(THREE.Math.degToRad(fov * 0.5));\r\n    var ymin = -ymax;\r\n    var xmin = ymin * aspect;\r\n    var xmax = ymax * aspect;\r\n\r\n    return this.makeFrustum(xmin, xmax, ymin, ymax, near, far);\r\n\r\n  },\r\n\r\n  makeOrthographic: function(left, right, top, bottom, near, far) {\r\n\r\n    var te = this.elements;\r\n    var w = right - left;\r\n    var h = top - bottom;\r\n    var p = far - near;\r\n\r\n    var x = (right + left) / w;\r\n    var y = (top + bottom) / h;\r\n    var z = (far + near) / p;\r\n\r\n    te[0] = 2 / w;\r\n    te[4] = 0;\r\n    te[8] = 0;\r\n    te[12] = -x;\r\n    te[1] = 0;\r\n    te[5] = 2 / h;\r\n    te[9] = 0;\r\n    te[13] = -y;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = -2 / p;\r\n    te[14] = -z;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2], te[3],\r\n      te[4], te[5], te[6], te[7],\r\n      te[8], te[9], te[10], te[11],\r\n      te[12], te[13], te[14], te[15]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix4().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Ray = function(origin, direction) {\r\n\r\n  this.origin = (origin !== undefined) ? origin : new THREE.Vector3();\r\n  this.direction = (direction !== undefined) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n  constructor: THREE.Ray,\r\n\r\n  set: function(origin, direction) {\r\n\r\n    this.origin.copy(origin);\r\n    this.direction.copy(direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(ray) {\r\n\r\n    this.origin.copy(ray.origin);\r\n    this.direction.copy(ray.direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.copy(this.direction).multiplyScalar(t).add(this.origin);\r\n\r\n  },\r\n\r\n  recast: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(t) {\r\n\r\n      this.origin.copy(this.at(t, v1));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.subVectors(point, this.origin);\r\n    var directionDistance = result.dot(this.direction);\r\n\r\n    if (directionDistance < 0) {\r\n\r\n      return result.copy(this.origin);\r\n\r\n    }\r\n\r\n    return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var directionDistance = v1.subVectors(point, this.origin).dot(this.direction);\r\n\r\n      // point behind the ray\r\n\r\n      if (directionDistance < 0) {\r\n\r\n        return this.origin.distanceTo(point);\r\n\r\n      }\r\n\r\n      v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n      return v1.distanceTo(point);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  distanceSqToSegment: function() {\r\n\r\n    var segCenter = new THREE.Vector3();\r\n    var segDir = new THREE.Vector3();\r\n    var diff = new THREE.Vector3();\r\n\r\n    return function(v0, v1, optionalPointOnRay, optionalPointOnSegment) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n      // It returns the min distance between the ray and the segment\r\n      // defined by v0 and v1\r\n      // It can also set two optional targets :\r\n      // - The closest point on the ray\r\n      // - The closest point on the segment\r\n\r\n      segCenter.copy(v0).add(v1).multiplyScalar(0.5);\r\n      segDir.copy(v1).sub(v0).normalize();\r\n      diff.copy(this.origin).sub(segCenter);\r\n\r\n      var segExtent = v0.distanceTo(v1) * 0.5;\r\n      var a01 = -this.direction.dot(segDir);\r\n      var b0 = diff.dot(this.direction);\r\n      var b1 = -diff.dot(segDir);\r\n      var c = diff.lengthSq();\r\n      var det = Math.abs(1 - a01 * a01);\r\n      var s0, s1, sqrDist, extDet;\r\n\r\n      if (det > 0) {\r\n\r\n        // The ray and segment are not parallel.\r\n\r\n        s0 = a01 * b1 - b0;\r\n        s1 = a01 * b0 - b1;\r\n        extDet = segExtent * det;\r\n\r\n        if (s0 >= 0) {\r\n\r\n          if (s1 >= -extDet) {\r\n\r\n            if (s1 <= extDet) {\r\n\r\n              // region 0\r\n              // Minimum at interior points of ray and segment.\r\n\r\n              var invDet = 1 / det;\r\n              s0 *= invDet;\r\n              s1 *= invDet;\r\n              sqrDist = s0 * (s0 + a01 * s1 + 2 * b0) + s1 * (a01 * s0 + s1 + 2 * b1) + c;\r\n\r\n            }\r\n            else {\r\n\r\n              // region 1\r\n\r\n              s1 = segExtent;\r\n              s0 = Math.max(0, -(a01 * s1 + b0));\r\n              sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            // region 5\r\n\r\n            s1 = -segExtent;\r\n            s0 = Math.max(0, -(a01 * s1 + b0));\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          if (s1 <= -extDet) {\r\n\r\n            // region 4\r\n\r\n            s0 = Math.max(0, -(-a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? -segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else if (s1 <= extDet) {\r\n\r\n            // region 3\r\n\r\n            s0 = 0;\r\n            s1 = Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else {\r\n\r\n            // region 2\r\n\r\n            s0 = Math.max(0, -(a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // Ray and segment are parallel.\r\n\r\n        s1 = (a01 > 0) ? -segExtent : segExtent;\r\n        s0 = Math.max(0, -(a01 * s1 + b0));\r\n        sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n      }\r\n\r\n      if (optionalPointOnRay) {\r\n\r\n        optionalPointOnRay.copy(this.direction).multiplyScalar(s0).add(this.origin);\r\n\r\n      }\r\n\r\n      if (optionalPointOnSegment) {\r\n\r\n        optionalPointOnSegment.copy(segDir).multiplyScalar(s1).add(segCenter);\r\n\r\n      }\r\n\r\n      return sqrDist;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  isIntersectionSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) <= sphere.radius;\r\n\r\n  },\r\n\r\n  intersectSphere: function() {\r\n\r\n    // from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(sphere, optionalTarget) {\r\n\r\n      v1.subVectors(sphere.center, this.origin);\r\n\r\n      var tca = v1.dot(this.direction);\r\n\r\n      var d2 = v1.dot(v1) - tca * tca;\r\n\r\n      var radius2 = sphere.radius * sphere.radius;\r\n\r\n      if (d2 > radius2) return null;\r\n\r\n      var thc = Math.sqrt(radius2 - d2);\r\n\r\n      // t0 = first intersect point - entrance on front of sphere\r\n      var t0 = tca - thc;\r\n\r\n      // t1 = second intersect point - exit point on back of sphere\r\n      var t1 = tca + thc;\r\n\r\n      // test to see if both t0 and t1 are behind the ray - if so, return null\r\n      if (t0 < 0 && t1 < 0) return null;\r\n\r\n      // test to see if t0 is behind the ray:\r\n      // if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n      // in order to always return an intersect point that is in front of the ray.\r\n      if (t0 < 0) return this.at(t1, optionalTarget);\r\n\r\n      // else t0 is in front of the ray, so return the first collision point scaled by t0 \r\n      return this.at(t0, optionalTarget);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  isIntersectionPlane: function(plane) {\r\n\r\n    // check if the ray lies on the plane first\r\n\r\n    var distToPoint = plane.distanceToPoint(this.origin);\r\n\r\n    if (distToPoint === 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n\r\n    if (denominator * distToPoint < 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    // ray origin is behind the plane (and is pointing behind it)\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  distanceToPlane: function(plane) {\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n    if (denominator == 0) {\r\n\r\n      // line is coplanar, return origin\r\n      if (plane.distanceToPoint(this.origin) == 0) {\r\n\r\n        return 0;\r\n\r\n      }\r\n\r\n      // Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n      return null;\r\n\r\n    }\r\n\r\n    var t = -(this.origin.dot(plane.normal) + plane.constant) / denominator;\r\n\r\n    // Return if the ray never intersects the plane\r\n\r\n    return t >= 0 ? t : null;\r\n\r\n  },\r\n\r\n  intersectPlane: function(plane, optionalTarget) {\r\n\r\n    var t = this.distanceToPlane(plane);\r\n\r\n    if (t === null) {\r\n\r\n      return null;\r\n    }\r\n\r\n    return this.at(t, optionalTarget);\r\n\r\n  },\r\n\r\n  isIntersectionBox: function() {\r\n\r\n    var v = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      return this.intersectBox(box, v) !== null;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectBox: function(box, optionalTarget) {\r\n\r\n    // http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\r\n    var tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n    var invdirx = 1 / this.direction.x,\r\n      invdiry = 1 / this.direction.y,\r\n      invdirz = 1 / this.direction.z;\r\n\r\n    var origin = this.origin;\r\n\r\n    if (invdirx >= 0) {\r\n\r\n      tmin = (box.min.x - origin.x) * invdirx;\r\n      tmax = (box.max.x - origin.x) * invdirx;\r\n\r\n    }\r\n    else {\r\n\r\n      tmin = (box.max.x - origin.x) * invdirx;\r\n      tmax = (box.min.x - origin.x) * invdirx;\r\n    }\r\n\r\n    if (invdiry >= 0) {\r\n\r\n      tymin = (box.min.y - origin.y) * invdiry;\r\n      tymax = (box.max.y - origin.y) * invdiry;\r\n\r\n    }\r\n    else {\r\n\r\n      tymin = (box.max.y - origin.y) * invdiry;\r\n      tymax = (box.min.y - origin.y) * invdiry;\r\n    }\r\n\r\n    if ((tmin > tymax) || (tymin > tmax)) return null;\r\n\r\n    // These lines also handle the case where tmin or tmax is NaN\r\n    // (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n    if (tymin > tmin || tmin !== tmin) tmin = tymin;\r\n\r\n    if (tymax < tmax || tmax !== tmax) tmax = tymax;\r\n\r\n    if (invdirz >= 0) {\r\n\r\n      tzmin = (box.min.z - origin.z) * invdirz;\r\n      tzmax = (box.max.z - origin.z) * invdirz;\r\n\r\n    }\r\n    else {\r\n\r\n      tzmin = (box.max.z - origin.z) * invdirz;\r\n      tzmax = (box.min.z - origin.z) * invdirz;\r\n    }\r\n\r\n    if ((tmin > tzmax) || (tzmin > tmax)) return null;\r\n\r\n    if (tzmin > tmin || tmin !== tmin) tmin = tzmin;\r\n\r\n    if (tzmax < tmax || tmax !== tmax) tmax = tzmax;\r\n\r\n    //return point closest to the ray (positive side)\r\n\r\n    if (tmax < 0) return null;\r\n\r\n    return this.at(tmin >= 0 ? tmin : tmax, optionalTarget);\r\n\r\n  },\r\n\r\n  intersectTriangle: function() {\r\n\r\n    // Compute the offset origin, edges, and normal.\r\n    var diff = new THREE.Vector3();\r\n    var edge1 = new THREE.Vector3();\r\n    var edge2 = new THREE.Vector3();\r\n    var normal = new THREE.Vector3();\r\n\r\n    return function(a, b, c, backfaceCulling, optionalTarget) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n      edge1.subVectors(b, a);\r\n      edge2.subVectors(c, a);\r\n      normal.crossVectors(edge1, edge2);\r\n\r\n      // Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n      // E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n      //   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n      //   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n      //   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n      var DdN = this.direction.dot(normal);\r\n      var sign;\r\n\r\n      if (DdN > 0) {\r\n\r\n        if (backfaceCulling) return null;\r\n        sign = 1;\r\n\r\n      }\r\n      else if (DdN < 0) {\r\n\r\n        sign = -1;\r\n        DdN = -DdN;\r\n\r\n      }\r\n      else {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      diff.subVectors(this.origin, a);\r\n      var DdQxE2 = sign * this.direction.dot(edge2.crossVectors(diff, edge2));\r\n\r\n      // b1 < 0, no intersection\r\n      if (DdQxE2 < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      var DdE1xQ = sign * this.direction.dot(edge1.cross(diff));\r\n\r\n      // b2 < 0, no intersection\r\n      if (DdE1xQ < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // b1+b2 > 1, no intersection\r\n      if (DdQxE2 + DdE1xQ > DdN) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Line intersects triangle, check if ray does.\r\n      var QdN = -sign * diff.dot(normal);\r\n\r\n      // t < 0, no intersection\r\n      if (QdN < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Ray intersects triangle.\r\n      return this.at(QdN / DdN, optionalTarget);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix4: function(matrix4) {\r\n\r\n    this.direction.add(this.origin).applyMatrix4(matrix4);\r\n    this.origin.applyMatrix4(matrix4);\r\n    this.direction.sub(this.origin);\r\n    this.direction.normalize();\r\n\r\n    return this;\r\n  },\r\n\r\n  equals: function(ray) {\r\n\r\n    return ray.origin.equals(this.origin) && ray.direction.equals(this.direction);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Ray().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function(center, radius) {\r\n\r\n  this.center = (center !== undefined) ? center : new THREE.Vector3();\r\n  this.radius = (radius !== undefined) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n  constructor: THREE.Sphere,\r\n\r\n  set: function(center, radius) {\r\n\r\n    this.center.copy(center);\r\n    this.radius = radius;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromPoints: function() {\r\n\r\n    var box = new THREE.Box3();\r\n\r\n    return function(points, optionalCenter) {\r\n\r\n      var center = this.center;\r\n\r\n      if (optionalCenter !== undefined) {\r\n\r\n        center.copy(optionalCenter);\r\n\r\n      }\r\n      else {\r\n\r\n        box.setFromPoints(points).center(center);\r\n\r\n      }\r\n\r\n      var maxRadiusSq = 0;\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(points[i]));\r\n\r\n      }\r\n\r\n      this.radius = Math.sqrt(maxRadiusSq);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(sphere) {\r\n\r\n    this.center.copy(sphere.center);\r\n    this.radius = sphere.radius;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    return (this.radius <= 0);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return (point.distanceToSquared(this.center) <= (this.radius * this.radius));\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return (point.distanceTo(this.center) - this.radius);\r\n\r\n  },\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var radiusSum = this.radius + sphere.radius;\r\n\r\n    return sphere.center.distanceToSquared(this.center) <= (radiusSum * radiusSum);\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var deltaLengthSq = this.center.distanceToSquared(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.copy(point);\r\n\r\n    if (deltaLengthSq > (this.radius * this.radius)) {\r\n\r\n      result.sub(this.center).normalize();\r\n      result.multiplyScalar(this.radius).add(this.center);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  },\r\n\r\n  getBoundingBox: function(optionalTarget) {\r\n\r\n    var box = optionalTarget || new THREE.Box3();\r\n\r\n    box.set(this.center, this.center);\r\n    box.expandByScalar(this.radius);\r\n\r\n    return box;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.center.applyMatrix4(matrix);\r\n    this.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.center.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(sphere) {\r\n\r\n    return sphere.center.equals(this.center) && (sphere.radius === this.radius);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Sphere().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Frustum = function(p0, p1, p2, p3, p4, p5) {\r\n\r\n  this.planes = [\r\n\r\n    (p0 !== undefined) ? p0 : new THREE.Plane(), (p1 !== undefined) ? p1 : new THREE.Plane(), (p2 !== undefined) ? p2 : new THREE.Plane(), (p3 !== undefined) ? p3 : new THREE.Plane(), (p4 !== undefined) ? p4 : new THREE.Plane(), (p5 !== undefined) ? p5 : new THREE.Plane()\r\n\r\n  ];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n  constructor: THREE.Frustum,\r\n\r\n  set: function(p0, p1, p2, p3, p4, p5) {\r\n\r\n    var planes = this.planes;\r\n\r\n    planes[0].copy(p0);\r\n    planes[1].copy(p1);\r\n    planes[2].copy(p2);\r\n    planes[3].copy(p3);\r\n    planes[4].copy(p4);\r\n    planes[5].copy(p5);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(frustum) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      planes[i].copy(frustum.planes[i]);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrix: function(m) {\r\n\r\n    var planes = this.planes;\r\n    var me = m.elements;\r\n    var me0 = me[0],\r\n      me1 = me[1],\r\n      me2 = me[2],\r\n      me3 = me[3];\r\n    var me4 = me[4],\r\n      me5 = me[5],\r\n      me6 = me[6],\r\n      me7 = me[7];\r\n    var me8 = me[8],\r\n      me9 = me[9],\r\n      me10 = me[10],\r\n      me11 = me[11];\r\n    var me12 = me[12],\r\n      me13 = me[13],\r\n      me14 = me[14],\r\n      me15 = me[15];\r\n\r\n    planes[0].setComponents(me3 - me0, me7 - me4, me11 - me8, me15 - me12).normalize();\r\n    planes[1].setComponents(me3 + me0, me7 + me4, me11 + me8, me15 + me12).normalize();\r\n    planes[2].setComponents(me3 + me1, me7 + me5, me11 + me9, me15 + me13).normalize();\r\n    planes[3].setComponents(me3 - me1, me7 - me5, me11 - me9, me15 - me13).normalize();\r\n    planes[4].setComponents(me3 - me2, me7 - me6, me11 - me10, me15 - me14).normalize();\r\n    planes[5].setComponents(me3 + me2, me7 + me6, me11 + me10, me15 + me14).normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  intersectsObject: function() {\r\n\r\n    var sphere = new THREE.Sphere();\r\n\r\n    return function(object) {\r\n\r\n      var geometry = object.geometry;\r\n\r\n      if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n      sphere.copy(geometry.boundingSphere);\r\n      sphere.applyMatrix4(object.matrixWorld);\r\n\r\n      return this.intersectsSphere(sphere);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var planes = this.planes;\r\n    var center = sphere.center;\r\n    var negRadius = -sphere.radius;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      var distance = planes[i].distanceToPoint(center);\r\n\r\n      if (distance < negRadius) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  intersectsBox: function() {\r\n\r\n    var p1 = new THREE.Vector3(),\r\n      p2 = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      var planes = this.planes;\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        var plane = planes[i];\r\n\r\n        p1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n        p2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n        p1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n        p2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n        p1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n        p2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n        var d1 = plane.distanceToPoint(p1);\r\n        var d2 = plane.distanceToPoint(p2);\r\n\r\n        // if both outside plane, no intersection\r\n\r\n        if (d1 < 0 && d2 < 0) {\r\n\r\n          return false;\r\n\r\n        }\r\n      }\r\n\r\n      return true;\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  containsPoint: function(point) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      if (planes[i].distanceToPoint(point) < 0) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Frustum().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Plane = function(normal, constant) {\r\n\r\n  this.normal = (normal !== undefined) ? normal : new THREE.Vector3(1, 0, 0);\r\n  this.constant = (constant !== undefined) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n  constructor: THREE.Plane,\r\n\r\n  set: function(normal, constant) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponents: function(x, y, z, w) {\r\n\r\n    this.normal.set(x, y, z);\r\n    this.constant = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromNormalAndCoplanarPoint: function(normal, point) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = -point.dot(this.normal); // must be this.normal, not normal, as this.normal is normalized\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCoplanarPoints: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n\r\n    return function(a, b, c) {\r\n\r\n      var normal = v1.subVectors(c, b).cross(v2.subVectors(a, b)).normalize();\r\n\r\n      // Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n      this.setFromNormalAndCoplanarPoint(normal, a);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  copy: function(plane) {\r\n\r\n    this.normal.copy(plane.normal);\r\n    this.constant = plane.constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    // Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n    var inverseNormalLength = 1.0 / this.normal.length();\r\n    this.normal.multiplyScalar(inverseNormalLength);\r\n    this.constant *= inverseNormalLength;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.constant *= -1;\r\n    this.normal.negate();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return this.normal.dot(point) + this.constant;\r\n\r\n  },\r\n\r\n  distanceToSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) - sphere.radius;\r\n\r\n  },\r\n\r\n  projectPoint: function(point, optionalTarget) {\r\n\r\n    return this.orthoPoint(point, optionalTarget).sub(point).negate();\r\n\r\n  },\r\n\r\n  orthoPoint: function(point, optionalTarget) {\r\n\r\n    var perpendicularMagnitude = this.distanceToPoint(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(perpendicularMagnitude);\r\n\r\n  },\r\n\r\n  isIntersectionLine: function(line) {\r\n\r\n    // Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n    var startSign = this.distanceToPoint(line.start);\r\n    var endSign = this.distanceToPoint(line.end);\r\n\r\n    return (startSign < 0 && endSign > 0) || (endSign < 0 && startSign > 0);\r\n\r\n  },\r\n\r\n  intersectLine: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(line, optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      var direction = line.delta(v1);\r\n\r\n      var denominator = this.normal.dot(direction);\r\n\r\n      if (denominator == 0) {\r\n\r\n        // line is coplanar, return origin\r\n        if (this.distanceToPoint(line.start) == 0) {\r\n\r\n          return result.copy(line.start);\r\n\r\n        }\r\n\r\n        // Unsure if this is the correct method to handle this case.\r\n        return undefined;\r\n\r\n      }\r\n\r\n      var t = -(line.start.dot(this.normal) + this.constant) / denominator;\r\n\r\n      if (t < 0 || t > 1) {\r\n\r\n        return undefined;\r\n\r\n      }\r\n\r\n      return result.copy(direction).multiplyScalar(t).add(line.start);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  coplanarPoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(-this.constant);\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n    var m1 = new THREE.Matrix3();\r\n\r\n    return function(matrix, optionalNormalMatrix) {\r\n\r\n      // compute new normal based on theory here:\r\n      // http://www.songho.ca/opengl/gl_normaltransform.html\r\n      var normalMatrix = optionalNormalMatrix || m1.getNormalMatrix(matrix);\r\n      var newNormal = v1.copy(this.normal).applyMatrix3(normalMatrix);\r\n\r\n      var newCoplanarPoint = this.coplanarPoint(v2);\r\n      newCoplanarPoint.applyMatrix4(matrix);\r\n\r\n      this.setFromNormalAndCoplanarPoint(newNormal, newCoplanarPoint);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.constant = this.constant - offset.dot(this.normal);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(plane) {\r\n\r\n    return plane.normal.equals(this.normal) && (plane.constant == this.constant);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Plane().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n  generateUUID: function() {\r\n\r\n    // http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n    var uuid = new Array(36);\r\n    var rnd = 0,\r\n      r;\r\n\r\n    return function() {\r\n\r\n      for (var i = 0; i < 36; i++) {\r\n\r\n        if (i == 8 || i == 13 || i == 18 || i == 23) {\r\n\r\n          uuid[i] = '-';\r\n\r\n        }\r\n        else if (i == 14) {\r\n\r\n          uuid[i] = '4';\r\n\r\n        }\r\n        else {\r\n\r\n          if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;\r\n          r = rnd & 0xf;\r\n          rnd = rnd >> 4;\r\n          uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n\r\n        }\r\n      }\r\n\r\n      return uuid.join('');\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  // Clamp value to range <a, b>\r\n\r\n  clamp: function(x, a, b) {\r\n\r\n    return (x < a) ? a : ((x > b) ? b : x);\r\n\r\n  },\r\n\r\n  // Clamp value to range <a, inf)\r\n\r\n  clampBottom: function(x, a) {\r\n\r\n    return x < a ? a : x;\r\n\r\n  },\r\n\r\n  // Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n  mapLinear: function(x, a1, a2, b1, b2) {\r\n\r\n    return b1 + (x - a1) * (b2 - b1) / (a2 - a1);\r\n\r\n  },\r\n\r\n  // http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n  smoothstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * (3 - 2 * x);\r\n\r\n  },\r\n\r\n  smootherstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * x * (x * (x * 6 - 15) + 10);\r\n\r\n  },\r\n\r\n  // Random float from <0, 1> with 16 bits of randomness\r\n  // (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\r\n  random16: function() {\r\n\r\n    return (65280 * Math.random() + 255 * Math.random()) / 65535;\r\n\r\n  },\r\n\r\n  // Random integer from <low, high> interval\r\n\r\n  randInt: function(low, high) {\r\n\r\n    return Math.floor(this.randFloat(low, high));\r\n\r\n  },\r\n\r\n  // Random float from <low, high> interval\r\n\r\n  randFloat: function(low, high) {\r\n\r\n    return low + Math.random() * (high - low);\r\n\r\n  },\r\n\r\n  // Random float from <-range/2, range/2> interval\r\n\r\n  randFloatSpread: function(range) {\r\n\r\n    return range * (0.5 - Math.random());\r\n\r\n  },\r\n\r\n  degToRad: function() {\r\n\r\n    var degreeToRadiansFactor = Math.PI / 180;\r\n\r\n    return function(degrees) {\r\n\r\n      return degrees * degreeToRadiansFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  radToDeg: function() {\r\n\r\n    var radianToDegreesFactor = 180 / Math.PI;\r\n\r\n    return function(radians) {\r\n\r\n      return radians * radianToDegreesFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  isPowerOfTwo: function(value) {\r\n\r\n    return (value & (value - 1)) === 0 && value !== 0;\r\n\r\n  },\r\n\r\n  nextPowerOfTwo: function(value) {\r\n\r\n    value--;\r\n    value |= value >> 1;\r\n    value |= value >> 2;\r\n    value |= value >> 4;\r\n    value |= value >> 8;\r\n    value |= value >> 16;\r\n    value++;\r\n\r\n    return value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function(points) {\r\n\r\n  this.points = points;\r\n\r\n  var c = [],\r\n    v3 = {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n    },\r\n    point, intPoint, weight, w2, w3,\r\n    pa, pb, pc, pd;\r\n\r\n  this.initFromArray = function(a) {\r\n\r\n    this.points = [];\r\n\r\n    for (var i = 0; i < a.length; i++) {\r\n\r\n      this.points[i] = {\r\n        x: a[i][0],\r\n        y: a[i][1],\r\n        z: a[i][2]\r\n      };\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.getPoint = function(k) {\r\n\r\n    point = (this.points.length - 1) * k;\r\n    intPoint = Math.floor(point);\r\n    weight = point - intPoint;\r\n\r\n    c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n    c[1] = intPoint;\r\n    c[2] = intPoint > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n    c[3] = intPoint > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n    pa = this.points[c[0]];\r\n    pb = this.points[c[1]];\r\n    pc = this.points[c[2]];\r\n    pd = this.points[c[3]];\r\n\r\n    w2 = weight * weight;\r\n    w3 = weight * w2;\r\n\r\n    v3.x = interpolate(pa.x, pb.x, pc.x, pd.x, weight, w2, w3);\r\n    v3.y = interpolate(pa.y, pb.y, pc.y, pd.y, weight, w2, w3);\r\n    v3.z = interpolate(pa.z, pb.z, pc.z, pd.z, weight, w2, w3);\r\n\r\n    return v3;\r\n\r\n  };\r\n\r\n  this.getControlPointsArray = function() {\r\n\r\n    var i, p, l = this.points.length,\r\n      coords = [];\r\n\r\n    for (i = 0; i < l; i++) {\r\n\r\n      p = this.points[i];\r\n      coords[i] = [p.x, p.y, p.z];\r\n\r\n    }\r\n\r\n    return coords;\r\n\r\n  };\r\n\r\n  // approximate length by summing linear segments\r\n\r\n  this.getLength = function(nSubDivisions) {\r\n\r\n    var i, index, nSamples, position,\r\n      point = 0,\r\n      intPoint = 0,\r\n      oldIntPoint = 0,\r\n      oldPosition = new THREE.Vector3(),\r\n      tmpVec = new THREE.Vector3(),\r\n      chunkLengths = [],\r\n      totalLength = 0;\r\n\r\n    // first point has 0 length\r\n\r\n    chunkLengths[0] = 0;\r\n\r\n    if (!nSubDivisions) nSubDivisions = 100;\r\n\r\n    nSamples = this.points.length * nSubDivisions;\r\n\r\n    oldPosition.copy(this.points[0]);\r\n\r\n    for (i = 1; i < nSamples; i++) {\r\n\r\n      index = i / nSamples;\r\n\r\n      position = this.getPoint(index);\r\n      tmpVec.copy(position);\r\n\r\n      totalLength += tmpVec.distanceTo(oldPosition);\r\n\r\n      oldPosition.copy(position);\r\n\r\n      point = (this.points.length - 1) * index;\r\n      intPoint = Math.floor(point);\r\n\r\n      if (intPoint != oldIntPoint) {\r\n\r\n        chunkLengths[intPoint] = totalLength;\r\n        oldIntPoint = intPoint;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // last point ends with total length\r\n\r\n    chunkLengths[chunkLengths.length] = totalLength;\r\n\r\n    return {\r\n      chunks: chunkLengths,\r\n      total: totalLength\r\n    };\r\n\r\n  };\r\n\r\n  this.reparametrizeByArcLength = function(samplingCoef) {\r\n\r\n    var i, j,\r\n      index, indexCurrent, indexNext,\r\n      realDistance,\r\n      sampling, position,\r\n      newpoints = [],\r\n      tmpVec = new THREE.Vector3(),\r\n      sl = this.getLength();\r\n\r\n    newpoints.push(tmpVec.copy(this.points[0]).clone());\r\n\r\n    for (i = 1; i < this.points.length; i++) {\r\n\r\n      //tmpVec.copy( this.points[ i - 1 ] );\r\n      //linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n      realDistance = sl.chunks[i] - sl.chunks[i - 1];\r\n\r\n      sampling = Math.ceil(samplingCoef * realDistance / sl.total);\r\n\r\n      indexCurrent = (i - 1) / (this.points.length - 1);\r\n      indexNext = i / (this.points.length - 1);\r\n\r\n      for (j = 1; j < sampling - 1; j++) {\r\n\r\n        index = indexCurrent + j * (1 / sampling) * (indexNext - indexCurrent);\r\n\r\n        position = this.getPoint(index);\r\n        newpoints.push(tmpVec.copy(position).clone());\r\n\r\n      }\r\n\r\n      newpoints.push(tmpVec.copy(this.points[i]).clone());\r\n\r\n    }\r\n\r\n    this.points = newpoints;\r\n\r\n  };\r\n\r\n  // Catmull-Rom\r\n\r\n  function interpolate(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n    var v0 = (p2 - p0) * 0.5,\r\n      v1 = (p3 - p1) * 0.5;\r\n\r\n    return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function(a, b, c) {\r\n\r\n  this.a = (a !== undefined) ? a : new THREE.Vector3();\r\n  this.b = (b !== undefined) ? b : new THREE.Vector3();\r\n  this.c = (c !== undefined) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n\r\n  return function(a, b, c, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    result.subVectors(c, b);\r\n    v0.subVectors(a, b);\r\n    result.cross(v0);\r\n\r\n    var resultLengthSq = result.lengthSq();\r\n    if (resultLengthSq > 0) {\r\n\r\n      return result.multiplyScalar(1 / Math.sqrt(resultLengthSq));\r\n\r\n    }\r\n\r\n    return result.set(0, 0, 0);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycoordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c, optionalTarget) {\r\n\r\n    v0.subVectors(c, a);\r\n    v1.subVectors(b, a);\r\n    v2.subVectors(point, a);\r\n\r\n    var dot00 = v0.dot(v0);\r\n    var dot01 = v0.dot(v1);\r\n    var dot02 = v0.dot(v2);\r\n    var dot11 = v1.dot(v1);\r\n    var dot12 = v1.dot(v2);\r\n\r\n    var denom = (dot00 * dot11 - dot01 * dot01);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    // colinear or singular triangle\r\n    if (denom == 0) {\r\n      // arbitrary location outside of triangle?\r\n      // not sure if this is the best idea, maybe should be returning undefined\r\n      return result.set(-2, -1, -1);\r\n    }\r\n\r\n    var invDenom = 1 / denom;\r\n    var u = (dot11 * dot02 - dot01 * dot12) * invDenom;\r\n    var v = (dot00 * dot12 - dot01 * dot02) * invDenom;\r\n\r\n    // barycoordinates must always sum to 1\r\n    return result.set(1 - u - v, v, u);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c) {\r\n\r\n    var result = THREE.Triangle.barycoordFromPoint(point, a, b, c, v1);\r\n\r\n    return (result.x >= 0) && (result.y >= 0) && ((result.x + result.y) <= 1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n  constructor: THREE.Triangle,\r\n\r\n  set: function(a, b, c) {\r\n\r\n    this.a.copy(a);\r\n    this.b.copy(b);\r\n    this.c.copy(c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPointsAndIndices: function(points, i0, i1, i2) {\r\n\r\n    this.a.copy(points[i0]);\r\n    this.b.copy(points[i1]);\r\n    this.c.copy(points[i2]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(triangle) {\r\n\r\n    this.a.copy(triangle.a);\r\n    this.b.copy(triangle.b);\r\n    this.c.copy(triangle.c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  area: function() {\r\n\r\n    var v0 = new THREE.Vector3();\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      v0.subVectors(this.c, this.b);\r\n      v1.subVectors(this.a, this.b);\r\n\r\n      return v0.cross(v1).length() * 0.5;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  midpoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3);\r\n\r\n  },\r\n\r\n  normal: function(optionalTarget) {\r\n\r\n    return THREE.Triangle.normal(this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  plane: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Plane();\r\n\r\n    return result.setFromCoplanarPoints(this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  barycoordFromPoint: function(point, optionalTarget) {\r\n\r\n    return THREE.Triangle.barycoordFromPoint(point, this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return THREE.Triangle.containsPoint(point, this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  equals: function(triangle) {\r\n\r\n    return triangle.a.equals(this.a) && triangle.b.equals(this.b) && triangle.c.equals(this.c);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Triangle().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function(autoStart) {\r\n\r\n  this.autoStart = (autoStart !== undefined) ? autoStart : true;\r\n\r\n  this.startTime = 0;\r\n  this.oldTime = 0;\r\n  this.elapsedTime = 0;\r\n\r\n  this.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n  constructor: THREE.Clock,\r\n\r\n  start: function() {\r\n\r\n    this.startTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n    this.oldTime = this.startTime;\r\n    this.running = true;\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.getElapsedTime();\r\n    this.running = false;\r\n\r\n  },\r\n\r\n  getElapsedTime: function() {\r\n\r\n    this.getDelta();\r\n    return this.elapsedTime;\r\n\r\n  },\r\n\r\n  getDelta: function() {\r\n\r\n    var diff = 0;\r\n\r\n    if (this.autoStart && !this.running) {\r\n\r\n      this.start();\r\n\r\n    }\r\n\r\n    if (this.running) {\r\n\r\n      var newTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n      diff = 0.001 * (newTime - this.oldTime);\r\n      this.oldTime = newTime;\r\n\r\n      this.elapsedTime += diff;\r\n\r\n    }\r\n\r\n    return diff;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function() {}\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n  constructor: THREE.EventDispatcher,\r\n\r\n  apply: function(object) {\r\n\r\n    object.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n    object.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n    object.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n    object.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n  },\r\n\r\n  addEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) this._listeners = {};\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] === undefined) {\r\n\r\n      listeners[type] = [];\r\n\r\n    }\r\n\r\n    if (listeners[type].indexOf(listener) === -1) {\r\n\r\n      listeners[type].push(listener);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  hasEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return false;\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  removeEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      var index = listenerArray.indexOf(listener);\r\n\r\n      if (index !== -1) {\r\n\r\n        listenerArray.splice(index, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  dispatchEvent: function(event) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[event.type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      event.target = this;\r\n\r\n      var array = [];\r\n      var length = listenerArray.length;\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i] = listenerArray[i];\r\n\r\n      }\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i].call(this, event);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://exocortex.com/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n(function(THREE) {\r\n\r\n  THREE.Raycaster = function(origin, direction, near, far) {\r\n\r\n    this.ray = new THREE.Ray(origin, direction);\r\n    // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n    this.near = near || 0;\r\n    this.far = far || Infinity;\r\n\r\n    this.params = {\r\n      Sprite: {},\r\n      Mesh: {},\r\n      PointCloud: {\r\n        threshold: 1\r\n      },\r\n      LOD: {},\r\n      Line: {}\r\n    };\r\n\r\n  };\r\n\r\n  var descSort = function(a, b) {\r\n\r\n    return a.distance - b.distance;\r\n\r\n  };\r\n\r\n  var intersectObject = function(object, raycaster, intersects, recursive) {\r\n\r\n    object.raycast(raycaster, intersects);\r\n\r\n    if (recursive === true) {\r\n\r\n      var children = object.children;\r\n\r\n      for (var i = 0, l = children.length; i < l; i++) {\r\n\r\n        intersectObject(children[i], raycaster, intersects, true);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  //\r\n\r\n  THREE.Raycaster.prototype = {\r\n\r\n    constructor: THREE.Raycaster,\r\n\r\n    precision: 0.0001,\r\n    linePrecision: 1,\r\n\r\n    set: function(origin, direction) {\r\n\r\n      // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n      this.ray.set(origin, direction);\r\n\r\n    },\r\n\r\n    setFromCamera: function(coords, camera) {\r\n\r\n      // camera is assumed _not_ to be a child of a transformed object\r\n\r\n      if (camera instanceof THREE.PerspectiveCamera) {\r\n\r\n        this.ray.origin.copy(camera.position);\r\n        this.ray.direction.set(coords.x, coords.y, 0.5).unproject(camera).sub(camera.position).normalize();\r\n\r\n      }\r\n      else if (camera instanceof THREE.OrthographicCamera) {\r\n\r\n        this.ray.origin.set(coords.x, coords.y, -1).unproject(camera);\r\n        this.ray.direction.set(0, 0, -1).transformDirection(camera.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.Raycaster: Unsupported camera type.');\r\n\r\n      }\r\n\r\n    },\r\n\r\n    intersectObject: function(object, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      intersectObject(object, this, intersects, recursive);\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    },\r\n\r\n    intersectObjects: function(objects, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      if (objects instanceof Array === false) {\r\n\r\n        THREE.warn('THREE.Raycaster.intersectObjects: objects is not an Array.');\r\n        return intersects;\r\n\r\n      }\r\n\r\n      for (var i = 0, l = objects.length; i < l; i++) {\r\n\r\n        intersectObject(objects[i], this, intersects, recursive);\r\n\r\n      }\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    }\r\n\r\n  };\r\n\r\n}(THREE));\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Object3D = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.Object3DIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Object3D';\r\n\r\n  this.parent = undefined;\r\n  this.children = [];\r\n\r\n  this.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n  var position = new THREE.Vector3();\r\n  var rotation = new THREE.Euler();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3(1, 1, 1);\r\n\r\n  var onRotationChange = function() {\r\n    quaternion.setFromEuler(rotation, false);\r\n  };\r\n\r\n  var onQuaternionChange = function() {\r\n    rotation.setFromQuaternion(quaternion, undefined, false);\r\n  };\r\n\r\n  rotation.onChange(onRotationChange);\r\n  quaternion.onChange(onQuaternionChange);\r\n\r\n  Object.defineProperties(this, {\r\n    position: {\r\n      enumerable: true,\r\n      value: position\r\n    },\r\n    rotation: {\r\n      enumerable: true,\r\n      value: rotation\r\n    },\r\n    quaternion: {\r\n      enumerable: true,\r\n      value: quaternion\r\n    },\r\n    scale: {\r\n      enumerable: true,\r\n      value: scale\r\n    }\r\n  });\r\n\r\n  this.rotationAutoUpdate = true;\r\n\r\n  this.matrix = new THREE.Matrix4();\r\n  this.matrixWorld = new THREE.Matrix4();\r\n\r\n  this.matrixAutoUpdate = true;\r\n  this.matrixWorldNeedsUpdate = false;\r\n\r\n  this.visible = true;\r\n\r\n  this.castShadow = false;\r\n  this.receiveShadow = false;\r\n\r\n  this.frustumCulled = true;\r\n  this.renderOrder = 0;\r\n\r\n  this.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3(0, 1, 0);\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n  constructor: THREE.Object3D,\r\n\r\n  get eulerOrder() {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    return this.rotation.order;\r\n\r\n  },\r\n\r\n  set eulerOrder(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    this.rotation.order = value;\r\n\r\n  },\r\n\r\n  get useQuaternion() {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  set useQuaternion(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    this.matrix.multiplyMatrices(matrix, this.matrix);\r\n\r\n    this.matrix.decompose(this.position, this.quaternion, this.scale);\r\n\r\n  },\r\n\r\n  setRotationFromAxisAngle: function(axis, angle) {\r\n\r\n    // assumes axis is normalized\r\n\r\n    this.quaternion.setFromAxisAngle(axis, angle);\r\n\r\n  },\r\n\r\n  setRotationFromEuler: function(euler) {\r\n\r\n    this.quaternion.setFromEuler(euler, true);\r\n\r\n  },\r\n\r\n  setRotationFromMatrix: function(m) {\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    this.quaternion.setFromRotationMatrix(m);\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    // assumes q is normalized\r\n\r\n    this.quaternion.copy(q);\r\n\r\n  },\r\n\r\n  rotateOnAxis: function() {\r\n\r\n    // rotate object on axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var q1 = new THREE.Quaternion();\r\n\r\n    return function(axis, angle) {\r\n\r\n      q1.setFromAxisAngle(axis, angle);\r\n\r\n      this.quaternion.multiply(q1);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  rotateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateOnAxis: function() {\r\n\r\n    // translate object by distance along axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(axis, distance) {\r\n\r\n      v1.copy(axis).applyQuaternion(this.quaternion);\r\n\r\n      this.position.add(v1.multiplyScalar(distance));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  translate: function(distance, axis) {\r\n\r\n    THREE.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.');\r\n    return this.translateOnAxis(axis, distance);\r\n\r\n  },\r\n\r\n  translateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  localToWorld: function(vector) {\r\n\r\n    return vector.applyMatrix4(this.matrixWorld);\r\n\r\n  },\r\n\r\n  worldToLocal: function() {\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      return vector.applyMatrix4(m1.getInverse(this.matrixWorld));\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  lookAt: function() {\r\n\r\n    // This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      m1.lookAt(vector, this.position, this.up);\r\n\r\n      this.quaternion.setFromRotationMatrix(m1);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  add: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.add(arguments[i]);\r\n\r\n      }\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n    if (object === this) {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object can't be added as a child of itself.\", object);\r\n      return this;\r\n\r\n    }\r\n\r\n    if (object instanceof THREE.Object3D) {\r\n\r\n      if (object.parent !== undefined) {\r\n\r\n        object.parent.remove(object);\r\n\r\n      }\r\n\r\n      object.parent = this;\r\n      object.dispatchEvent({\r\n        type: 'added'\r\n      });\r\n\r\n      this.children.push(object);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  remove: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.remove(arguments[i]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    var index = this.children.indexOf(object);\r\n\r\n    if (index !== -1) {\r\n\r\n      object.parent = undefined;\r\n\r\n      object.dispatchEvent({\r\n        type: 'removed'\r\n      });\r\n\r\n      this.children.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getChildByName: function(name) {\r\n\r\n    THREE.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().');\r\n    return this.getObjectByName(name);\r\n\r\n  },\r\n\r\n  getObjectById: function(id) {\r\n\r\n    return this.getObjectByProperty('id', id);\r\n\r\n  },\r\n\r\n  getObjectByName: function(name) {\r\n\r\n    return this.getObjectByProperty('name', name);\r\n\r\n  },\r\n\r\n  getObjectByProperty: function(name, value) {\r\n\r\n    if (this[name] === value) return this;\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      var child = this.children[i];\r\n      var object = child.getObjectByProperty(name, value);\r\n\r\n      if (object !== undefined) {\r\n\r\n        return object;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return undefined;\r\n\r\n  },\r\n\r\n  getWorldPosition: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    return result.setFromMatrixPosition(this.matrixWorld);\r\n\r\n  },\r\n\r\n  getWorldQuaternion: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var scale = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Quaternion();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, result, scale);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldRotation: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Euler();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.setFromQuaternion(quaternion, this.rotation.order, false);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldScale: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, quaternion, result);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldDirection: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.set(0, 0, 1).applyQuaternion(quaternion);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  raycast: function() {},\r\n\r\n  traverse: function(callback) {\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverse(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseVisible: function(callback) {\r\n\r\n    if (this.visible === false) return;\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverseVisible(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseAncestors: function(callback) {\r\n\r\n    if (this.parent) {\r\n\r\n      callback(this.parent);\r\n\r\n      this.parent.traverseAncestors(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  updateMatrix: function() {\r\n\r\n    this.matrix.compose(this.position, this.quaternion, this.scale);\r\n\r\n    this.matrixWorldNeedsUpdate = true;\r\n\r\n  },\r\n\r\n  updateMatrixWorld: function(force) {\r\n\r\n    if (this.matrixAutoUpdate === true) this.updateMatrix();\r\n\r\n    if (this.matrixWorldNeedsUpdate === true || force === true) {\r\n\r\n      if (this.parent === undefined) {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n      }\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.3,\r\n        type: 'Object',\r\n        generator: 'ObjectExporter'\r\n      }\r\n    };\r\n\r\n    //\r\n\r\n    var geometries = {};\r\n\r\n    var parseGeometry = function(geometry) {\r\n\r\n      if (output.geometries === undefined) {\r\n\r\n        output.geometries = [];\r\n\r\n      }\r\n\r\n      if (geometries[geometry.uuid] === undefined) {\r\n\r\n        var json = geometry.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        geometries[geometry.uuid] = json;\r\n\r\n        output.geometries.push(json);\r\n\r\n      }\r\n\r\n      return geometry.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var materials = {};\r\n\r\n    var parseMaterial = function(material) {\r\n\r\n      if (output.materials === undefined) {\r\n\r\n        output.materials = [];\r\n\r\n      }\r\n\r\n      if (materials[material.uuid] === undefined) {\r\n\r\n        var json = material.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        materials[material.uuid] = json;\r\n\r\n        output.materials.push(json);\r\n\r\n      }\r\n\r\n      return material.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var parseObject = function(object) {\r\n\r\n      var data = {};\r\n\r\n      data.uuid = object.uuid;\r\n      data.type = object.type;\r\n\r\n      if (object.name !== '') data.name = object.name;\r\n      if (JSON.stringify(object.userData) !== '{}') data.userData = object.userData;\r\n      if (object.visible !== true) data.visible = object.visible;\r\n\r\n      if (object instanceof THREE.PerspectiveCamera) {\r\n\r\n        data.fov = object.fov;\r\n        data.aspect = object.aspect;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.OrthographicCamera) {\r\n\r\n        data.left = object.left;\r\n        data.right = object.right;\r\n        data.top = object.top;\r\n        data.bottom = object.bottom;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.AmbientLight) {\r\n\r\n        data.color = object.color.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.DirectionalLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n\r\n      }\r\n      else if (object instanceof THREE.PointLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.SpotLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.angle = object.angle;\r\n        data.exponent = object.exponent;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.HemisphereLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.groundColor = object.groundColor.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        data.geometry = parseGeometry(object.geometry);\r\n        data.material = parseMaterial(object.material);\r\n\r\n        if (object instanceof THREE.Line) data.mode = object.mode;\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        data.material = parseMaterial(object.material);\r\n\r\n      }\r\n\r\n      data.matrix = object.matrix.toArray();\r\n\r\n      if (object.children.length > 0) {\r\n\r\n        data.children = [];\r\n\r\n        for (var i = 0; i < object.children.length; i++) {\r\n\r\n          data.children.push(parseObject(object.children[i]));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return data;\r\n\r\n    }\r\n\r\n    output.object = parseObject(this);\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(object, recursive) {\r\n\r\n    if (object === undefined) object = new THREE.Object3D();\r\n    if (recursive === undefined) recursive = true;\r\n\r\n    object.name = this.name;\r\n\r\n    object.up.copy(this.up);\r\n\r\n    object.position.copy(this.position);\r\n    object.quaternion.copy(this.quaternion);\r\n    object.scale.copy(this.scale);\r\n\r\n    object.rotationAutoUpdate = this.rotationAutoUpdate;\r\n\r\n    object.matrix.copy(this.matrix);\r\n    object.matrixWorld.copy(this.matrixWorld);\r\n\r\n    object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n    object.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate;\r\n\r\n    object.visible = this.visible;\r\n\r\n    object.castShadow = this.castShadow;\r\n    object.receiveShadow = this.receiveShadow;\r\n\r\n    object.frustumCulled = this.frustumCulled;\r\n\r\n    object.userData = JSON.parse(JSON.stringify(this.userData));\r\n\r\n    if (recursive === true) {\r\n\r\n      for (var i = 0; i < this.children.length; i++) {\r\n\r\n        var child = this.children[i];\r\n        object.add(child.clone());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function(a, b, c, normal, color, materialIndex) {\r\n\r\n  this.a = a;\r\n  this.b = b;\r\n  this.c = c;\r\n\r\n  this.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n  this.vertexNormals = normal instanceof Array ? normal : [];\r\n\r\n  this.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n  this.vertexColors = color instanceof Array ? color : [];\r\n\r\n  this.vertexTangents = [];\r\n\r\n  this.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n  constructor: THREE.Face3,\r\n\r\n  clone: function() {\r\n\r\n    var face = new THREE.Face3(this.a, this.b, this.c);\r\n\r\n    face.normal.copy(this.normal);\r\n    face.color.copy(this.color);\r\n\r\n    face.materialIndex = this.materialIndex;\r\n\r\n    for (var i = 0, il = this.vertexNormals.length; i < il; i++) {\r\n\r\n      face.vertexNormals[i] = this.vertexNormals[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexColors.length; i < il; i++) {\r\n\r\n      face.vertexColors[i] = this.vertexColors[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexTangents.length; i < il; i++) {\r\n\r\n      face.vertexTangents[i] = this.vertexTangents[i].clone();\r\n\r\n    }\r\n\r\n    return face;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Face4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Face4 = function(a, b, c, d, normal, color, materialIndex) {\r\n\r\n  THREE.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.')\r\n  return new THREE.Face3(a, b, c, normal, color, materialIndex);\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function(array, itemSize) {\r\n\r\n  this.array = array;\r\n  this.itemSize = itemSize;\r\n\r\n  this.needsUpdate = false;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n  constructor: THREE.BufferAttribute,\r\n\r\n  get length() {\r\n\r\n    return this.array.length;\r\n\r\n  },\r\n\r\n  copyAt: function(index1, attribute, index2) {\r\n\r\n    index1 *= this.itemSize;\r\n    index2 *= attribute.itemSize;\r\n\r\n    for (var i = 0, l = this.itemSize; i < l; i++) {\r\n\r\n      this.array[index1 + i] = attribute.array[index2 + i];\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  set: function(value, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.array.set(value, offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(index, x) {\r\n\r\n    this.array[index * this.itemSize] = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(index, y) {\r\n\r\n    this.array[index * this.itemSize + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(index, z) {\r\n\r\n    this.array[index * this.itemSize + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXY: function(index, x, y) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZ: function(index, x, y, z) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZW: function(index, x, y, z, w) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n    this.array[index + 3] = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.BufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n  }\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\n// File:src/core/DynamicBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DynamicBufferAttribute = function(array, itemSize) {\r\n\r\n  THREE.BufferAttribute.call(this, array, itemSize);\r\n\r\n  this.updateRange = {\r\n    offset: 0,\r\n    count: -1\r\n  };\r\n\r\n};\r\n\r\nTHREE.DynamicBufferAttribute.prototype = Object.create(THREE.BufferAttribute.prototype);\r\nTHREE.DynamicBufferAttribute.prototype.constructor = THREE.DynamicBufferAttribute;\r\n\r\nTHREE.DynamicBufferAttribute.prototype.clone = function() {\r\n\r\n  return new THREE.DynamicBufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n};\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'BufferGeometry';\r\n\r\n  this.attributes = {};\r\n  this.attributesKeys = [];\r\n\r\n  this.drawcalls = [];\r\n  this.offsets = this.drawcalls; // backwards compatibility\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n  constructor: THREE.BufferGeometry,\r\n\r\n  addAttribute: function(name, attribute) {\r\n\r\n    if (attribute instanceof THREE.BufferAttribute === false) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).');\r\n\r\n      this.attributes[name] = {\r\n        array: arguments[1],\r\n        itemSize: arguments[2]\r\n      };\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    this.attributes[name] = attribute;\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n  },\r\n\r\n  getAttribute: function(name) {\r\n\r\n    return this.attributes[name];\r\n\r\n  },\r\n\r\n  addDrawCall: function(start, count, indexOffset) {\r\n\r\n    this.drawcalls.push({\r\n\r\n      start: start,\r\n      count: count,\r\n      index: indexOffset !== undefined ? indexOffset : 0\r\n\r\n    });\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var position = this.attributes.position;\r\n\r\n    if (position !== undefined) {\r\n\r\n      matrix.applyToVector3Array(position.array);\r\n      position.needsUpdate = true;\r\n\r\n    }\r\n\r\n    var normal = this.attributes.normal;\r\n\r\n    if (normal !== undefined) {\r\n\r\n      var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n      normalMatrix.applyToVector3Array(normal.array);\r\n      normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  fromGeometry: function(geometry, settings) {\r\n\r\n    settings = settings || {\r\n      'vertexColors': THREE.NoColors\r\n    };\r\n\r\n    var vertices = geometry.vertices;\r\n    var faces = geometry.faces;\r\n    var faceVertexUvs = geometry.faceVertexUvs;\r\n    var vertexColors = settings.vertexColors;\r\n    var hasFaceVertexUv = faceVertexUvs[0].length > 0;\r\n    var hasFaceVertexNormals = faces[0].vertexNormals.length == 3;\r\n\r\n    var positions = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('position', new THREE.BufferAttribute(positions, 3));\r\n\r\n    var normals = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n\r\n    if (vertexColors !== THREE.NoColors) {\r\n\r\n      var colors = new Float32Array(faces.length * 3 * 3);\r\n      this.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n    }\r\n\r\n    if (hasFaceVertexUv === true) {\r\n\r\n      var uvs = new Float32Array(faces.length * 3 * 2);\r\n      this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n    }\r\n\r\n    for (var i = 0, i2 = 0, i3 = 0; i < faces.length; i++, i2 += 6, i3 += 9) {\r\n\r\n      var face = faces[i];\r\n\r\n      var a = vertices[face.a];\r\n      var b = vertices[face.b];\r\n      var c = vertices[face.c];\r\n\r\n      positions[i3] = a.x;\r\n      positions[i3 + 1] = a.y;\r\n      positions[i3 + 2] = a.z;\r\n\r\n      positions[i3 + 3] = b.x;\r\n      positions[i3 + 4] = b.y;\r\n      positions[i3 + 5] = b.z;\r\n\r\n      positions[i3 + 6] = c.x;\r\n      positions[i3 + 7] = c.y;\r\n      positions[i3 + 8] = c.z;\r\n\r\n      if (hasFaceVertexNormals === true) {\r\n\r\n        var na = face.vertexNormals[0];\r\n        var nb = face.vertexNormals[1];\r\n        var nc = face.vertexNormals[2];\r\n\r\n        normals[i3] = na.x;\r\n        normals[i3 + 1] = na.y;\r\n        normals[i3 + 2] = na.z;\r\n\r\n        normals[i3 + 3] = nb.x;\r\n        normals[i3 + 4] = nb.y;\r\n        normals[i3 + 5] = nb.z;\r\n\r\n        normals[i3 + 6] = nc.x;\r\n        normals[i3 + 7] = nc.y;\r\n        normals[i3 + 8] = nc.z;\r\n\r\n      }\r\n      else {\r\n\r\n        var n = face.normal;\r\n\r\n        normals[i3] = n.x;\r\n        normals[i3 + 1] = n.y;\r\n        normals[i3 + 2] = n.z;\r\n\r\n        normals[i3 + 3] = n.x;\r\n        normals[i3 + 4] = n.y;\r\n        normals[i3 + 5] = n.z;\r\n\r\n        normals[i3 + 6] = n.x;\r\n        normals[i3 + 7] = n.y;\r\n        normals[i3 + 8] = n.z;\r\n\r\n      }\r\n\r\n      if (vertexColors === THREE.FaceColors) {\r\n\r\n        var fc = face.color;\r\n\r\n        colors[i3] = fc.r;\r\n        colors[i3 + 1] = fc.g;\r\n        colors[i3 + 2] = fc.b;\r\n\r\n        colors[i3 + 3] = fc.r;\r\n        colors[i3 + 4] = fc.g;\r\n        colors[i3 + 5] = fc.b;\r\n\r\n        colors[i3 + 6] = fc.r;\r\n        colors[i3 + 7] = fc.g;\r\n        colors[i3 + 8] = fc.b;\r\n\r\n      }\r\n      else if (vertexColors === THREE.VertexColors) {\r\n\r\n        var vca = face.vertexColors[0];\r\n        var vcb = face.vertexColors[1];\r\n        var vcc = face.vertexColors[2];\r\n\r\n        colors[i3] = vca.r;\r\n        colors[i3 + 1] = vca.g;\r\n        colors[i3 + 2] = vca.b;\r\n\r\n        colors[i3 + 3] = vcb.r;\r\n        colors[i3 + 4] = vcb.g;\r\n        colors[i3 + 5] = vcb.b;\r\n\r\n        colors[i3 + 6] = vcc.r;\r\n        colors[i3 + 7] = vcc.g;\r\n        colors[i3 + 8] = vcc.b;\r\n\r\n      }\r\n\r\n      if (hasFaceVertexUv === true) {\r\n\r\n        var uva = faceVertexUvs[0][i][0];\r\n        var uvb = faceVertexUvs[0][i][1];\r\n        var uvc = faceVertexUvs[0][i][2];\r\n\r\n        uvs[i2] = uva.x;\r\n        uvs[i2 + 1] = uva.y;\r\n\r\n        uvs[i2 + 2] = uvb.x;\r\n        uvs[i2 + 3] = uvb.y;\r\n\r\n        uvs[i2 + 4] = uvc.x;\r\n        uvs[i2 + 5] = uvc.y;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeBoundingSphere()\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingBox === null) {\r\n\r\n        this.boundingBox = new THREE.Box3();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        var bb = this.boundingBox;\r\n        bb.makeEmpty();\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          bb.expandByPoint(vector);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (positions === undefined || positions.length === 0) {\r\n\r\n        this.boundingBox.min.set(0, 0, 0);\r\n        this.boundingBox.max.set(0, 0, 0);\r\n\r\n      }\r\n\r\n      if (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) {\r\n\r\n        THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    var box = new THREE.Box3();\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingSphere === null) {\r\n\r\n        this.boundingSphere = new THREE.Sphere();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        box.makeEmpty();\r\n\r\n        var center = this.boundingSphere.center;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          box.expandByPoint(vector);\r\n\r\n        }\r\n\r\n        box.center(center);\r\n\r\n        // hoping to find a boundingSphere with a radius smaller than the\r\n        // boundingSphere of the boundingBox:  sqrt(3) smaller in the best case\r\n\r\n        var maxRadiusSq = 0;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n\r\n        }\r\n\r\n        this.boundingSphere.radius = Math.sqrt(maxRadiusSq);\r\n\r\n        if (isNaN(this.boundingSphere.radius)) {\r\n\r\n          THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.');\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    // backwards compatibility\r\n\r\n  },\r\n\r\n  computeVertexNormals: function() {\r\n\r\n    var attributes = this.attributes;\r\n\r\n    if (attributes.position) {\r\n\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.normal === undefined) {\r\n\r\n        this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(positions.length), 3));\r\n\r\n      }\r\n      else {\r\n\r\n        // reset existing normals to zero\r\n\r\n        var normals = attributes.normal.array;\r\n\r\n        for (var i = 0, il = normals.length; i < il; i++) {\r\n\r\n          normals[i] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var normals = attributes.normal.array;\r\n\r\n      var vA, vB, vC,\r\n\r\n        pA = new THREE.Vector3(),\r\n        pB = new THREE.Vector3(),\r\n        pC = new THREE.Vector3(),\r\n\r\n        cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      // indexed elements\r\n\r\n      if (attributes.index) {\r\n\r\n        var indices = attributes.index.array;\r\n\r\n        var offsets = (this.offsets.length > 0 ? this.offsets : [{\r\n          start: 0,\r\n          count: indices.length,\r\n          index: 0\r\n        }]);\r\n\r\n        for (var j = 0, jl = offsets.length; j < jl; ++j) {\r\n\r\n          var start = offsets[j].start;\r\n          var count = offsets[j].count;\r\n          var index = offsets[j].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            vA = (index + indices[i]) * 3;\r\n            vB = (index + indices[i + 1]) * 3;\r\n            vC = (index + indices[i + 2]) * 3;\r\n\r\n            pA.fromArray(positions, vA);\r\n            pB.fromArray(positions, vB);\r\n            pC.fromArray(positions, vC);\r\n\r\n            cb.subVectors(pC, pB);\r\n            ab.subVectors(pA, pB);\r\n            cb.cross(ab);\r\n\r\n            normals[vA] += cb.x;\r\n            normals[vA + 1] += cb.y;\r\n            normals[vA + 2] += cb.z;\r\n\r\n            normals[vB] += cb.x;\r\n            normals[vB + 1] += cb.y;\r\n            normals[vB + 2] += cb.z;\r\n\r\n            normals[vC] += cb.x;\r\n            normals[vC + 1] += cb.y;\r\n            normals[vC + 2] += cb.z;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed elements (unconnected triangle soup)\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 9) {\r\n\r\n          pA.fromArray(positions, i);\r\n          pB.fromArray(positions, i + 3);\r\n          pC.fromArray(positions, i + 6);\r\n\r\n          cb.subVectors(pC, pB);\r\n          ab.subVectors(pA, pB);\r\n          cb.cross(ab);\r\n\r\n          normals[i] = cb.x;\r\n          normals[i + 1] = cb.y;\r\n          normals[i + 2] = cb.z;\r\n\r\n          normals[i + 3] = cb.x;\r\n          normals[i + 4] = cb.y;\r\n          normals[i + 5] = cb.z;\r\n\r\n          normals[i + 6] = cb.x;\r\n          normals[i + 7] = cb.y;\r\n          normals[i + 8] = cb.z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.normalizeNormals();\r\n\r\n      attributes.normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // (per vertex tangents)\r\n\r\n    if (this.attributes.index === undefined ||\r\n      this.attributes.position === undefined ||\r\n      this.attributes.normal === undefined ||\r\n      this.attributes.uv === undefined) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');\r\n      return;\r\n\r\n    }\r\n\r\n    var indices = this.attributes.index.array;\r\n    var positions = this.attributes.position.array;\r\n    var normals = this.attributes.normal.array;\r\n    var uvs = this.attributes.uv.array;\r\n\r\n    var nVertices = positions.length / 3;\r\n\r\n    if (this.attributes.tangent === undefined) {\r\n\r\n      this.addAttribute('tangent', new THREE.BufferAttribute(new Float32Array(4 * nVertices), 4));\r\n\r\n    }\r\n\r\n    var tangents = this.attributes.tangent.array;\r\n\r\n    var tan1 = [],\r\n      tan2 = [];\r\n\r\n    for (var k = 0; k < nVertices; k++) {\r\n\r\n      tan1[k] = new THREE.Vector3();\r\n      tan2[k] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var vA = new THREE.Vector3(),\r\n      vB = new THREE.Vector3(),\r\n      vC = new THREE.Vector3(),\r\n\r\n      uvA = new THREE.Vector2(),\r\n      uvB = new THREE.Vector2(),\r\n      uvC = new THREE.Vector2(),\r\n\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r;\r\n\r\n    var sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3();\r\n\r\n    function handleTriangle(a, b, c) {\r\n\r\n      vA.fromArray(positions, a * 3);\r\n      vB.fromArray(positions, b * 3);\r\n      vC.fromArray(positions, c * 3);\r\n\r\n      uvA.fromArray(uvs, a * 2);\r\n      uvB.fromArray(uvs, b * 2);\r\n      uvC.fromArray(uvs, c * 2);\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n\r\n      sdir.set(\r\n        (t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r\r\n      );\r\n\r\n      tdir.set(\r\n        (s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r\r\n      );\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    var i, il;\r\n    var j, jl;\r\n    var iA, iB, iC;\r\n\r\n    if (this.drawcalls.length === 0) {\r\n\r\n      this.addDrawCall(0, indices.length, 0);\r\n\r\n    }\r\n\r\n    var drawcalls = this.drawcalls;\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleTriangle(iA, iB, iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3();\r\n    var n = new THREE.Vector3(),\r\n      n2 = new THREE.Vector3();\r\n    var w, t, test;\r\n\r\n    function handleVertex(v) {\r\n\r\n      n.fromArray(normals, v * 3);\r\n      n2.copy(n);\r\n\r\n      t = tan1[v];\r\n\r\n      // Gram-Schmidt orthogonalize\r\n\r\n      tmp.copy(t);\r\n      tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n      // Calculate handedness\r\n\r\n      tmp2.crossVectors(n2, t);\r\n      test = tmp2.dot(tan2[v]);\r\n      w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n      tangents[v * 4] = tmp.x;\r\n      tangents[v * 4 + 1] = tmp.y;\r\n      tangents[v * 4 + 2] = tmp.z;\r\n      tangents[v * 4 + 3] = w;\r\n\r\n    }\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleVertex(iA);\r\n        handleVertex(iB);\r\n        handleVertex(iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  Compute the draw offset for large models by chunking the index buffer into chunks of 65k addressable vertices.\r\n  This method will effectively rewrite the index buffer and remap all attributes to match the new indices.\r\n  WARNING: This method will also expand the vertex count to prevent sprawled triangles across draw offsets.\r\n  size - Defaults to 65535, but allows for larger or smaller chunks.\r\n  */\r\n  computeOffsets: function(size) {\r\n\r\n    if (size === undefined) size = 65535; // WebGL limits type of index buffer values to 16-bit.\r\n\r\n    var indices = this.attributes.index.array;\r\n    var vertices = this.attributes.position.array;\r\n\r\n    var facesCount = (indices.length / 3);\r\n\r\n    /*\r\n    console.log(\"Computing buffers in offsets of \"+size+\" -> indices:\"+indices.length+\" vertices:\"+vertices.length);\r\n    console.log(\"Faces to process: \"+(indices.length/3));\r\n    console.log(\"Reordering \"+verticesCount+\" vertices.\");\r\n    */\r\n\r\n    var sortedIndices = new Uint16Array(indices.length); //16-bit buffers\r\n    var indexPtr = 0;\r\n    var vertexPtr = 0;\r\n\r\n    var offsets = [{\r\n      start: 0,\r\n      count: 0,\r\n      index: 0\r\n    }];\r\n    var offset = offsets[0];\r\n\r\n    var duplicatedVertices = 0;\r\n    var newVerticeMaps = 0;\r\n    var faceVertices = new Int32Array(6);\r\n    var vertexMap = new Int32Array(vertices.length);\r\n    var revVertexMap = new Int32Array(vertices.length);\r\n    for (var j = 0; j < vertices.length; j++) {\r\n      vertexMap[j] = -1;\r\n      revVertexMap[j] = -1;\r\n    }\r\n\r\n    /*\r\n    \tTraverse every face and reorder vertices in the proper offsets of 65k.\r\n    \tWe can have more than 65k entries in the index buffer per offset, but only reference 65k values.\r\n    */\r\n    for (var findex = 0; findex < facesCount; findex++) {\r\n      newVerticeMaps = 0;\r\n\r\n      for (var vo = 0; vo < 3; vo++) {\r\n        var vid = indices[findex * 3 + vo];\r\n        if (vertexMap[vid] == -1) {\r\n          //Unmapped vertice\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          newVerticeMaps++;\r\n        }\r\n        else if (vertexMap[vid] < offset.index) {\r\n          //Reused vertices from previous block (duplicate)\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          duplicatedVertices++;\r\n        }\r\n        else {\r\n          //Reused vertice in the current block\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = vertexMap[vid];\r\n        }\r\n      }\r\n\r\n      var faceMax = vertexPtr + newVerticeMaps;\r\n      if (faceMax > (offset.index + size)) {\r\n        var new_offset = {\r\n          start: indexPtr,\r\n          count: 0,\r\n          index: vertexPtr\r\n        };\r\n        offsets.push(new_offset);\r\n        offset = new_offset;\r\n\r\n        //Re-evaluate reused vertices in light of new offset.\r\n        for (var v = 0; v < 6; v += 2) {\r\n          var new_vid = faceVertices[v + 1];\r\n          if (new_vid > -1 && new_vid < offset.index)\r\n            faceVertices[v + 1] = -1;\r\n        }\r\n      }\r\n\r\n      //Reindex the face.\r\n      for (var v = 0; v < 6; v += 2) {\r\n        var vid = faceVertices[v];\r\n        var new_vid = faceVertices[v + 1];\r\n\r\n        if (new_vid === -1)\r\n          new_vid = vertexPtr++;\r\n\r\n        vertexMap[vid] = new_vid;\r\n        revVertexMap[new_vid] = vid;\r\n        sortedIndices[indexPtr++] = new_vid - offset.index; //XXX overflows at 16bit\r\n        offset.count++;\r\n      }\r\n    }\r\n\r\n    /* Move all attribute values to map to the new computed indices , also expand the vertice stack to match our new vertexPtr. */\r\n    this.reorderBuffers(sortedIndices, revVertexMap, vertexPtr);\r\n    this.offsets = offsets; // TODO: Deprecate\r\n    this.drawcalls = offsets;\r\n\r\n    /*\r\n    var orderTime = Date.now();\r\n    console.log(\"Reorder time: \"+(orderTime-s)+\"ms\");\r\n    console.log(\"Duplicated \"+duplicatedVertices+\" vertices.\");\r\n    console.log(\"Compute Buffers time: \"+(Date.now()-s)+\"ms\");\r\n    console.log(\"Draw offsets: \"+offsets.length);\r\n    */\r\n\r\n    return offsets;\r\n\r\n  },\r\n\r\n  merge: function(geometry, offset) {\r\n\r\n    if (geometry instanceof THREE.BufferGeometry === false) {\r\n\r\n      THREE.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    var attributes = this.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      if (geometry.attributes[key] === undefined) continue;\r\n\r\n      var attribute1 = attributes[key];\r\n      var attributeArray1 = attribute1.array;\r\n\r\n      var attribute2 = geometry.attributes[key];\r\n      var attributeArray2 = attribute2.array;\r\n\r\n      var attributeSize = attribute2.itemSize;\r\n\r\n      for (var i = 0, j = attributeSize * offset; i < attributeArray2.length; i++, j++) {\r\n\r\n        attributeArray1[j] = attributeArray2[i];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalizeNormals: function() {\r\n\r\n    var normals = this.attributes.normal.array;\r\n\r\n    var x, y, z, n;\r\n\r\n    for (var i = 0, il = normals.length; i < il; i += 3) {\r\n\r\n      x = normals[i];\r\n      y = normals[i + 1];\r\n      z = normals[i + 2];\r\n\r\n      n = 1.0 / Math.sqrt(x * x + y * y + z * z);\r\n\r\n      normals[i] *= n;\r\n      normals[i + 1] *= n;\r\n      normals[i + 2] *= n;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  \treoderBuffers:\r\n  \tReorder attributes based on a new indexBuffer and indexMap.\r\n  \tindexBuffer - Uint16Array of the new ordered indices.\r\n  \tindexMap - Int32Array where the position is the new vertex ID and the value the old vertex ID for each vertex.\r\n  \tvertexCount - Amount of total vertices considered in this reordering (in case you want to grow the vertice stack).\r\n  */\r\n  reorderBuffers: function(indexBuffer, indexMap, vertexCount) {\r\n\r\n    /* Create a copy of all attributes for reordering. */\r\n    var sortedAttributes = {};\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      var sourceArray = this.attributes[attr].array;\r\n      sortedAttributes[attr] = new sourceArray.constructor(this.attributes[attr].itemSize * vertexCount);\r\n    }\r\n\r\n    /* Move attribute positions based on the new index map */\r\n    for (var new_vid = 0; new_vid < vertexCount; new_vid++) {\r\n      var vid = indexMap[new_vid];\r\n      for (var attr in this.attributes) {\r\n        if (attr == 'index')\r\n          continue;\r\n        var attrArray = this.attributes[attr].array;\r\n        var attrSize = this.attributes[attr].itemSize;\r\n        var sortedAttr = sortedAttributes[attr];\r\n        for (var k = 0; k < attrSize; k++)\r\n          sortedAttr[new_vid * attrSize + k] = attrArray[vid * attrSize + k];\r\n      }\r\n    }\r\n\r\n    /* Carry the new sorted buffers locally */\r\n    this.attributes['index'].array = indexBuffer;\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      this.attributes[attr].array = sortedAttributes[attr];\r\n      this.attributes[attr].numItems = this.attributes[attr].itemSize * vertexCount;\r\n    }\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      data: {\r\n        attributes: {}\r\n      }\r\n    };\r\n\r\n    var attributes = this.attributes;\r\n    var offsets = this.offsets;\r\n    var boundingSphere = this.boundingSphere;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n\r\n      var array = Array.prototype.slice.call(attribute.array);\r\n\r\n      output.data.attributes[key] = {\r\n        itemSize: attribute.itemSize,\r\n        type: attribute.array.constructor.name,\r\n        array: array\r\n      }\r\n\r\n    }\r\n\r\n    if (offsets.length > 0) {\r\n\r\n      output.data.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    if (boundingSphere !== null) {\r\n\r\n      output.data.boundingSphere = {\r\n        center: boundingSphere.center.toArray(),\r\n        radius: boundingSphere.radius\r\n      }\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    for (var attr in this.attributes) {\r\n\r\n      var sourceAttr = this.attributes[attr];\r\n      geometry.addAttribute(attr, sourceAttr.clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.offsets.length; i < il; i++) {\r\n\r\n      var offset = this.offsets[i];\r\n\r\n      geometry.offsets.push({\r\n\r\n        start: offset.start,\r\n        index: offset.index,\r\n        count: offset.count\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Geometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Geometry';\r\n\r\n  this.vertices = [];\r\n  this.colors = []; // one-to-one vertex colors, used in Points and Line\r\n\r\n  this.faces = [];\r\n\r\n  this.faceVertexUvs = [\r\n    []\r\n  ];\r\n\r\n  this.morphTargets = [];\r\n  this.morphColors = [];\r\n  this.morphNormals = [];\r\n\r\n  this.skinWeights = [];\r\n  this.skinIndices = [];\r\n\r\n  this.lineDistances = [];\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n  this.hasTangents = false;\r\n\r\n  this.dynamic = true; // the intermediate typed arrays will be deleted when set to false\r\n\r\n  // update flags\r\n\r\n  this.verticesNeedUpdate = false;\r\n  this.elementsNeedUpdate = false;\r\n  this.uvsNeedUpdate = false;\r\n  this.normalsNeedUpdate = false;\r\n  this.tangentsNeedUpdate = false;\r\n  this.colorsNeedUpdate = false;\r\n  this.lineDistancesNeedUpdate = false;\r\n\r\n  this.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n  constructor: THREE.Geometry,\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    for (var i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertex.applyMatrix4(matrix);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      var face = this.faces[i];\r\n      face.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        face.vertexNormals[j].applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n    this.verticesNeedUpdate = true;\r\n    this.normalsNeedUpdate = true;\r\n\r\n  },\r\n\r\n  fromBufferGeometry: function(geometry) {\r\n\r\n    var scope = this;\r\n\r\n    var attributes = geometry.attributes;\r\n\r\n    var vertices = attributes.position.array;\r\n    var indices = attributes.index !== undefined ? attributes.index.array : undefined;\r\n    var normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n    var colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n    var uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\r\n    var tempNormals = [];\r\n    var tempUVs = [];\r\n\r\n    for (var i = 0, j = 0; i < vertices.length; i += 3, j += 2) {\r\n\r\n      scope.vertices.push(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n      if (normals !== undefined) {\r\n\r\n        tempNormals.push(new THREE.Vector3(normals[i], normals[i + 1], normals[i + 2]));\r\n\r\n      }\r\n\r\n      if (colors !== undefined) {\r\n\r\n        scope.colors.push(new THREE.Color(colors[i], colors[i + 1], colors[i + 2]));\r\n\r\n      }\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        tempUVs.push(new THREE.Vector2(uvs[j], uvs[j + 1]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var addFace = function(a, b, c) {\r\n\r\n      var vertexNormals = normals !== undefined ? [tempNormals[a].clone(), tempNormals[b].clone(), tempNormals[c].clone()] : [];\r\n      var vertexColors = colors !== undefined ? [scope.colors[a].clone(), scope.colors[b].clone(), scope.colors[c].clone()] : [];\r\n\r\n      scope.faces.push(new THREE.Face3(a, b, c, vertexNormals, vertexColors));\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        scope.faceVertexUvs[0].push([tempUVs[a].clone(), tempUVs[b].clone(), tempUVs[c].clone()]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (indices !== undefined) {\r\n\r\n      var drawcalls = geometry.drawcalls;\r\n\r\n      if (drawcalls.length > 0) {\r\n\r\n        for (var i = 0; i < drawcalls.length; i++) {\r\n\r\n          var drawcall = drawcalls[i];\r\n\r\n          var start = drawcall.start;\r\n          var count = drawcall.count;\r\n          var index = drawcall.index;\r\n\r\n          for (var j = start, jl = start + count; j < jl; j += 3) {\r\n\r\n            addFace(index + indices[j], index + indices[j + 1], index + indices[j + 2]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        for (var i = 0; i < indices.length; i += 3) {\r\n\r\n          addFace(indices[i], indices[i + 1], indices[i + 2]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (var i = 0; i < vertices.length / 3; i += 3) {\r\n\r\n        addFace(i, i + 1, i + 2);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeFaceNormals();\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      this.boundingBox = geometry.boundingBox.clone();\r\n\r\n    }\r\n\r\n    if (geometry.boundingSphere !== null) {\r\n\r\n      this.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    var cb = new THREE.Vector3(),\r\n      ab = new THREE.Vector3();\r\n\r\n    for (var f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      var face = this.faces[f];\r\n\r\n      var vA = this.vertices[face.a];\r\n      var vB = this.vertices[face.b];\r\n      var vC = this.vertices[face.c];\r\n\r\n      cb.subVectors(vC, vB);\r\n      ab.subVectors(vA, vB);\r\n      cb.cross(ab);\r\n\r\n      cb.normalize();\r\n\r\n      face.normal.copy(cb);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeVertexNormals: function(areaWeighted) {\r\n\r\n    var v, vl, f, fl, face, vertices;\r\n\r\n    vertices = new Array(this.vertices.length);\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    if (areaWeighted) {\r\n\r\n      // vertex normals weighted by triangle areas\r\n      // http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n      var vA, vB, vC;\r\n      var cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vA = this.vertices[face.a];\r\n        vB = this.vertices[face.b];\r\n        vC = this.vertices[face.c];\r\n\r\n        cb.subVectors(vC, vB);\r\n        ab.subVectors(vA, vB);\r\n        cb.cross(ab);\r\n\r\n        vertices[face.a].add(cb);\r\n        vertices[face.b].add(cb);\r\n        vertices[face.c].add(cb);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vertices[face.a].add(face.normal);\r\n        vertices[face.b].add(face.normal);\r\n        vertices[face.c].add(face.normal);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v].normalize();\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.vertexNormals[0] = vertices[face.a].clone();\r\n      face.vertexNormals[1] = vertices[face.b].clone();\r\n      face.vertexNormals[2] = vertices[face.c].clone();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeMorphNormals: function() {\r\n\r\n    var i, il, f, fl, face;\r\n\r\n    // save original normals\r\n    // - create temp variables on first access\r\n    //   otherwise just copy (for faster repeated calls)\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      if (!face.__originalFaceNormal) {\r\n\r\n        face.__originalFaceNormal = face.normal.clone();\r\n\r\n      }\r\n      else {\r\n\r\n        face.__originalFaceNormal.copy(face.normal);\r\n\r\n      }\r\n\r\n      if (!face.__originalVertexNormals) face.__originalVertexNormals = [];\r\n\r\n      for (i = 0, il = face.vertexNormals.length; i < il; i++) {\r\n\r\n        if (!face.__originalVertexNormals[i]) {\r\n\r\n          face.__originalVertexNormals[i] = face.vertexNormals[i].clone();\r\n\r\n        }\r\n        else {\r\n\r\n          face.__originalVertexNormals[i].copy(face.vertexNormals[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // use temp geometry to compute face and vertex normals for each morph\r\n\r\n    var tmpGeo = new THREE.Geometry();\r\n    tmpGeo.faces = this.faces;\r\n\r\n    for (i = 0, il = this.morphTargets.length; i < il; i++) {\r\n\r\n      // create on first access\r\n\r\n      if (!this.morphNormals[i]) {\r\n\r\n        this.morphNormals[i] = {};\r\n        this.morphNormals[i].faceNormals = [];\r\n        this.morphNormals[i].vertexNormals = [];\r\n\r\n        var dstNormalsFace = this.morphNormals[i].faceNormals;\r\n        var dstNormalsVertex = this.morphNormals[i].vertexNormals;\r\n\r\n        var faceNormal, vertexNormals;\r\n\r\n        for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n          faceNormal = new THREE.Vector3();\r\n          vertexNormals = {\r\n            a: new THREE.Vector3(),\r\n            b: new THREE.Vector3(),\r\n            c: new THREE.Vector3()\r\n          };\r\n\r\n          dstNormalsFace.push(faceNormal);\r\n          dstNormalsVertex.push(vertexNormals);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var morphNormals = this.morphNormals[i];\r\n\r\n      // set vertices to morph target\r\n\r\n      tmpGeo.vertices = this.morphTargets[i].vertices;\r\n\r\n      // compute morph normals\r\n\r\n      tmpGeo.computeFaceNormals();\r\n      tmpGeo.computeVertexNormals();\r\n\r\n      // store morph normals\r\n\r\n      var faceNormal, vertexNormals;\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        faceNormal = morphNormals.faceNormals[f];\r\n        vertexNormals = morphNormals.vertexNormals[f];\r\n\r\n        faceNormal.copy(face.normal);\r\n\r\n        vertexNormals.a.copy(face.vertexNormals[0]);\r\n        vertexNormals.b.copy(face.vertexNormals[1]);\r\n        vertexNormals.c.copy(face.vertexNormals[2]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore original normals\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.normal = face.__originalFaceNormal;\r\n      face.vertexNormals = face.__originalVertexNormals;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // tangents go to vertices\r\n\r\n    var f, fl, v, vl, i, vertexIndex,\r\n      face, uv, vA, vB, vC, uvA, uvB, uvC,\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r, t, test,\r\n      tan1 = [],\r\n      tan2 = [],\r\n      sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3(),\r\n      tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3(),\r\n      n = new THREE.Vector3(),\r\n      w;\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      tan1[v] = new THREE.Vector3();\r\n      tan2[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    function handleTriangle(context, a, b, c, ua, ub, uc) {\r\n\r\n      vA = context.vertices[a];\r\n      vB = context.vertices[b];\r\n      vC = context.vertices[c];\r\n\r\n      uvA = uv[ua];\r\n      uvB = uv[ub];\r\n      uvC = uv[uc];\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n      sdir.set((t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r);\r\n      tdir.set((s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r);\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n      uv = this.faceVertexUvs[0][f]; // use UV layer 0 for tangents\r\n\r\n      handleTriangle(this, face.a, face.b, face.c, 0, 1, 2);\r\n\r\n    }\r\n\r\n    var faceIndex = ['a', 'b', 'c', 'd'];\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      for (i = 0; i < Math.min(face.vertexNormals.length, 3); i++) {\r\n\r\n        n.copy(face.vertexNormals[i]);\r\n\r\n        vertexIndex = face[faceIndex[i]];\r\n\r\n        t = tan1[vertexIndex];\r\n\r\n        // Gram-Schmidt orthogonalize\r\n\r\n        tmp.copy(t);\r\n        tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n        // Calculate handedness\r\n\r\n        tmp2.crossVectors(face.vertexNormals[i], t);\r\n        test = tmp2.dot(tan2[vertexIndex]);\r\n        w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n        face.vertexTangents[i] = new THREE.Vector4(tmp.x, tmp.y, tmp.z, w);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.hasTangents = true;\r\n\r\n  },\r\n\r\n  computeLineDistances: function() {\r\n\r\n    var d = 0;\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      if (i > 0) {\r\n\r\n        d += vertices[i].distanceTo(vertices[i - 1]);\r\n\r\n      }\r\n\r\n      this.lineDistances[i] = d;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    if (this.boundingBox === null) {\r\n\r\n      this.boundingBox = new THREE.Box3();\r\n\r\n    }\r\n\r\n    this.boundingBox.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    if (this.boundingSphere === null) {\r\n\r\n      this.boundingSphere = new THREE.Sphere();\r\n\r\n    }\r\n\r\n    this.boundingSphere.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  merge: function(geometry, matrix, materialIndexOffset) {\r\n\r\n    if (geometry instanceof THREE.Geometry === false) {\r\n\r\n      THREE.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    var normalMatrix,\r\n      vertexOffset = this.vertices.length,\r\n      vertices1 = this.vertices,\r\n      vertices2 = geometry.vertices,\r\n      faces1 = this.faces,\r\n      faces2 = geometry.faces,\r\n      uvs1 = this.faceVertexUvs[0],\r\n      uvs2 = geometry.faceVertexUvs[0];\r\n\r\n    if (materialIndexOffset === undefined) materialIndexOffset = 0;\r\n\r\n    if (matrix !== undefined) {\r\n\r\n      normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    for (var i = 0, il = vertices2.length; i < il; i++) {\r\n\r\n      var vertex = vertices2[i];\r\n\r\n      var vertexCopy = vertex.clone();\r\n\r\n      if (matrix !== undefined) vertexCopy.applyMatrix4(matrix);\r\n\r\n      vertices1.push(vertexCopy);\r\n\r\n    }\r\n\r\n    // faces\r\n\r\n    for (i = 0, il = faces2.length; i < il; i++) {\r\n\r\n      var face = faces2[i],\r\n        faceCopy, normal, color,\r\n        faceVertexNormals = face.vertexNormals,\r\n        faceVertexColors = face.vertexColors;\r\n\r\n      faceCopy = new THREE.Face3(face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset);\r\n      faceCopy.normal.copy(face.normal);\r\n\r\n      if (normalMatrix !== undefined) {\r\n\r\n        faceCopy.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexNormals.length; j < jl; j++) {\r\n\r\n        normal = faceVertexNormals[j].clone();\r\n\r\n        if (normalMatrix !== undefined) {\r\n\r\n          normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n        }\r\n\r\n        faceCopy.vertexNormals.push(normal);\r\n\r\n      }\r\n\r\n      faceCopy.color.copy(face.color);\r\n\r\n      for (var j = 0, jl = faceVertexColors.length; j < jl; j++) {\r\n\r\n        color = faceVertexColors[j];\r\n        faceCopy.vertexColors.push(color.clone());\r\n\r\n      }\r\n\r\n      faceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n      faces1.push(faceCopy);\r\n\r\n    }\r\n\r\n    // uvs\r\n\r\n    for (i = 0, il = uvs2.length; i < il; i++) {\r\n\r\n      var uv = uvs2[i],\r\n        uvCopy = [];\r\n\r\n      if (uv === undefined) {\r\n\r\n        continue;\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = uv.length; j < jl; j++) {\r\n\r\n        uvCopy.push(uv[j].clone());\r\n\r\n      }\r\n\r\n      uvs1.push(uvCopy);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  mergeMesh: function(mesh) {\r\n\r\n    if (mesh instanceof THREE.Mesh === false) {\r\n\r\n      THREE.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh);\r\n      return;\r\n\r\n    }\r\n\r\n    mesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n    this.merge(mesh.geometry, mesh.matrix);\r\n\r\n  },\r\n\r\n  /*\r\n   * Checks for duplicate vertices with hashmap.\r\n   * Duplicated vertices are removed\r\n   * and faces' vertices are updated.\r\n   */\r\n\r\n  mergeVertices: function() {\r\n\r\n    var verticesMap = {}; // Hashmap for looking up vertice by position coordinates (and making sure they are unique)\r\n    var unique = [],\r\n      changes = [];\r\n\r\n    var v, key;\r\n    var precisionPoints = 4; // number of decimal points, eg. 4 for epsilon of 0.0001\r\n    var precision = Math.pow(10, precisionPoints);\r\n    var i, il, face;\r\n    var indices, j, jl;\r\n\r\n    for (i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      v = this.vertices[i];\r\n      key = Math.round(v.x * precision) + '_' + Math.round(v.y * precision) + '_' + Math.round(v.z * precision);\r\n\r\n      if (verticesMap[key] === undefined) {\r\n\r\n        verticesMap[key] = i;\r\n        unique.push(this.vertices[i]);\r\n        changes[i] = unique.length - 1;\r\n\r\n      }\r\n      else {\r\n\r\n        //console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n        changes[i] = changes[verticesMap[key]];\r\n\r\n      }\r\n\r\n    };\r\n\r\n\r\n    // if faces are completely degenerate after merging vertices, we\r\n    // have to remove them from the geometry.\r\n    var faceIndicesToRemove = [];\r\n\r\n    for (i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      face = this.faces[i];\r\n\r\n      face.a = changes[face.a];\r\n      face.b = changes[face.b];\r\n      face.c = changes[face.c];\r\n\r\n      indices = [face.a, face.b, face.c];\r\n\r\n      var dupIndex = -1;\r\n\r\n      // if any duplicate vertices are found in a Face3\r\n      // we have to remove the face as nothing can be saved\r\n      for (var n = 0; n < 3; n++) {\r\n        if (indices[n] == indices[(n + 1) % 3]) {\r\n\r\n          dupIndex = n;\r\n          faceIndicesToRemove.push(i);\r\n          break;\r\n\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    for (i = faceIndicesToRemove.length - 1; i >= 0; i--) {\r\n      var idx = faceIndicesToRemove[i];\r\n\r\n      this.faces.splice(idx, 1);\r\n\r\n      for (j = 0, jl = this.faceVertexUvs.length; j < jl; j++) {\r\n\r\n        this.faceVertexUvs[j].splice(idx, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Use unique set of vertices\r\n\r\n    var diff = this.vertices.length - unique.length;\r\n    this.vertices = unique;\r\n    return diff;\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this.parameters !== undefined) {\r\n\r\n      var parameters = this.parameters;\r\n\r\n      for (var key in parameters) {\r\n\r\n        if (parameters[key] !== undefined) output[key] = parameters[key];\r\n\r\n      }\r\n\r\n      return output;\r\n\r\n    }\r\n\r\n    var vertices = [];\r\n\r\n    for (var i = 0; i < this.vertices.length; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertices.push(vertex.x, vertex.y, vertex.z);\r\n\r\n    }\r\n\r\n    var faces = [];\r\n    var normals = [];\r\n    var normalsHash = {};\r\n    var colors = [];\r\n    var colorsHash = {};\r\n    var uvs = [];\r\n    var uvsHash = {};\r\n\r\n    for (var i = 0; i < this.faces.length; i++) {\r\n\r\n      var face = this.faces[i];\r\n\r\n      var hasMaterial = false; // face.materialIndex !== undefined;\r\n      var hasFaceUv = false; // deprecated\r\n      var hasFaceVertexUv = this.faceVertexUvs[0][i] !== undefined;\r\n      var hasFaceNormal = face.normal.length() > 0;\r\n      var hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n      var hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n      var hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n      var faceType = 0;\r\n\r\n      faceType = setBit(faceType, 0, 0);\r\n      faceType = setBit(faceType, 1, hasMaterial);\r\n      faceType = setBit(faceType, 2, hasFaceUv);\r\n      faceType = setBit(faceType, 3, hasFaceVertexUv);\r\n      faceType = setBit(faceType, 4, hasFaceNormal);\r\n      faceType = setBit(faceType, 5, hasFaceVertexNormal);\r\n      faceType = setBit(faceType, 6, hasFaceColor);\r\n      faceType = setBit(faceType, 7, hasFaceVertexColor);\r\n\r\n      faces.push(faceType);\r\n      faces.push(face.a, face.b, face.c);\r\n\r\n\r\n      /*\r\n      if ( hasMaterial ) {\r\n\r\n      \tfaces.push( face.materialIndex );\r\n\r\n      }\r\n      */\r\n\r\n      if (hasFaceVertexUv) {\r\n\r\n        var faceVertexUvs = this.faceVertexUvs[0][i];\r\n\r\n        faces.push(\r\n          getUvIndex(faceVertexUvs[0]),\r\n          getUvIndex(faceVertexUvs[1]),\r\n          getUvIndex(faceVertexUvs[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceNormal) {\r\n\r\n        faces.push(getNormalIndex(face.normal));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexNormal) {\r\n\r\n        var vertexNormals = face.vertexNormals;\r\n\r\n        faces.push(\r\n          getNormalIndex(vertexNormals[0]),\r\n          getNormalIndex(vertexNormals[1]),\r\n          getNormalIndex(vertexNormals[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceColor) {\r\n\r\n        faces.push(getColorIndex(face.color));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexColor) {\r\n\r\n        var vertexColors = face.vertexColors;\r\n\r\n        faces.push(\r\n          getColorIndex(vertexColors[0]),\r\n          getColorIndex(vertexColors[1]),\r\n          getColorIndex(vertexColors[2])\r\n        );\r\n\r\n      }\r\n\r\n    }\r\n\r\n    function setBit(value, position, enabled) {\r\n\r\n      return enabled ? value | (1 << position) : value & (~(1 << position));\r\n\r\n    }\r\n\r\n    function getNormalIndex(normal) {\r\n\r\n      var hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n      if (normalsHash[hash] !== undefined) {\r\n\r\n        return normalsHash[hash];\r\n\r\n      }\r\n\r\n      normalsHash[hash] = normals.length / 3;\r\n      normals.push(normal.x, normal.y, normal.z);\r\n\r\n      return normalsHash[hash];\r\n\r\n    }\r\n\r\n    function getColorIndex(color) {\r\n\r\n      var hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n      if (colorsHash[hash] !== undefined) {\r\n\r\n        return colorsHash[hash];\r\n\r\n      }\r\n\r\n      colorsHash[hash] = colors.length;\r\n      colors.push(color.getHex());\r\n\r\n      return colorsHash[hash];\r\n\r\n    }\r\n\r\n    function getUvIndex(uv) {\r\n\r\n      var hash = uv.x.toString() + uv.y.toString();\r\n\r\n      if (uvsHash[hash] !== undefined) {\r\n\r\n        return uvsHash[hash];\r\n\r\n      }\r\n\r\n      uvsHash[hash] = uvs.length / 2;\r\n      uvs.push(uv.x, uv.y);\r\n\r\n      return uvsHash[hash];\r\n\r\n    }\r\n\r\n    output.data = {};\r\n\r\n    output.data.vertices = vertices;\r\n    output.data.normals = normals;\r\n    if (colors.length > 0) output.data.colors = colors;\r\n    if (uvs.length > 0) output.data.uvs = [uvs]; // temporal backward compatibility\r\n    output.data.faces = faces;\r\n\r\n    //\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.Geometry();\r\n\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      geometry.vertices.push(vertices[i].clone());\r\n\r\n    }\r\n\r\n    var faces = this.faces;\r\n\r\n    for (var i = 0, il = faces.length; i < il; i++) {\r\n\r\n      geometry.faces.push(faces[i].clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faceVertexUvs.length; i < il; i++) {\r\n\r\n      var faceVertexUvs = this.faceVertexUvs[i];\r\n\r\n      if (geometry.faceVertexUvs[i] === undefined) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexUvs.length; j < jl; j++) {\r\n\r\n        var uvs = faceVertexUvs[j],\r\n          uvsCopy = [];\r\n\r\n        for (var k = 0, kl = uvs.length; k < kl; k++) {\r\n\r\n          var uv = uvs[k];\r\n\r\n          uvsCopy.push(uv.clone());\r\n\r\n        }\r\n\r\n        geometry.faceVertexUvs[i].push(uvsCopy);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Camera = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Camera';\r\n\r\n  this.matrixWorldInverse = new THREE.Matrix4();\r\n  this.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function() {\r\n\r\n  var quaternion = new THREE.Quaternion();\r\n\r\n  return function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.getWorldQuaternion(quaternion);\r\n\r\n    return result.set(0, 0, -1).applyQuaternion(quaternion);\r\n\r\n  }\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function() {\r\n\r\n  // This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n  var m1 = new THREE.Matrix4();\r\n\r\n  return function(vector) {\r\n\r\n    m1.lookAt(this.position, vector, this.up);\r\n\r\n    this.quaternion.setFromRotationMatrix(m1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function(camera) {\r\n\r\n  if (camera === undefined) camera = new THREE.Camera();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, camera);\r\n\r\n  camera.matrixWorldInverse.copy(this.matrixWorldInverse);\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function(near, far, cubeResolution) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'CubeCamera';\r\n\r\n  var fov = 90,\r\n    aspect = 1;\r\n\r\n  var cameraPX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPX.up.set(0, -1, 0);\r\n  cameraPX.lookAt(new THREE.Vector3(1, 0, 0));\r\n  this.add(cameraPX);\r\n\r\n  var cameraNX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNX.up.set(0, -1, 0);\r\n  cameraNX.lookAt(new THREE.Vector3(-1, 0, 0));\r\n  this.add(cameraNX);\r\n\r\n  var cameraPY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPY.up.set(0, 0, 1);\r\n  cameraPY.lookAt(new THREE.Vector3(0, 1, 0));\r\n  this.add(cameraPY);\r\n\r\n  var cameraNY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNY.up.set(0, 0, -1);\r\n  cameraNY.lookAt(new THREE.Vector3(0, -1, 0));\r\n  this.add(cameraNY);\r\n\r\n  var cameraPZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPZ.up.set(0, -1, 0);\r\n  cameraPZ.lookAt(new THREE.Vector3(0, 0, 1));\r\n  this.add(cameraPZ);\r\n\r\n  var cameraNZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNZ.up.set(0, -1, 0);\r\n  cameraNZ.lookAt(new THREE.Vector3(0, 0, -1));\r\n  this.add(cameraNZ);\r\n\r\n  this.renderTarget = new THREE.WebGLRenderTargetCube(cubeResolution, cubeResolution, {\r\n    format: THREE.RGBFormat,\r\n    magFilter: THREE.LinearFilter,\r\n    minFilter: THREE.LinearFilter\r\n  });\r\n\r\n  this.updateCubeMap = function(renderer, scene) {\r\n\r\n    var renderTarget = this.renderTarget;\r\n    var generateMipmaps = renderTarget.generateMipmaps;\r\n\r\n    renderTarget.generateMipmaps = false;\r\n\r\n    renderTarget.activeCubeFace = 0;\r\n    renderer.render(scene, cameraPX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 1;\r\n    renderer.render(scene, cameraNX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 2;\r\n    renderer.render(scene, cameraPY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 3;\r\n    renderer.render(scene, cameraNY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 4;\r\n    renderer.render(scene, cameraPZ, renderTarget);\r\n\r\n    renderTarget.generateMipmaps = generateMipmaps;\r\n\r\n    renderTarget.activeCubeFace = 5;\r\n    renderer.render(scene, cameraNZ, renderTarget);\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function(left, right, top, bottom, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'OrthographicCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.left = left;\r\n  this.right = right;\r\n  this.top = top;\r\n  this.bottom = bottom;\r\n\r\n  this.near = (near !== undefined) ? near : 0.1;\r\n  this.far = (far !== undefined) ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var dx = (this.right - this.left) / (2 * this.zoom);\r\n  var dy = (this.top - this.bottom) / (2 * this.zoom);\r\n  var cx = (this.right + this.left) / 2;\r\n  var cy = (this.top + this.bottom) / 2;\r\n\r\n  this.projectionMatrix.makeOrthographic(cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far);\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.OrthographicCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.left = this.left;\r\n  camera.right = this.right;\r\n  camera.top = this.top;\r\n  camera.bottom = this.bottom;\r\n\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.PerspectiveCamera = function(fov, aspect, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'PerspectiveCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.fov = fov !== undefined ? fov : 50;\r\n  this.aspect = aspect !== undefined ? aspect : 1;\r\n  this.near = near !== undefined ? near : 0.1;\r\n  this.far = far !== undefined ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Uses Focal Length (in mm) to estimate and set FOV\r\n * 35mm (fullframe) camera is used if frame size is not specified;\r\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function(focalLength, frameHeight) {\r\n\r\n  if (frameHeight === undefined) frameHeight = 24;\r\n\r\n  this.fov = 2 * THREE.Math.radToDeg(Math.atan(frameHeight / (focalLength * 2)));\r\n  this.updateProjectionMatrix();\r\n\r\n}\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function(fullWidth, fullHeight, x, y, width, height) {\r\n\r\n  this.fullWidth = fullWidth;\r\n  this.fullHeight = fullHeight;\r\n  this.x = x;\r\n  this.y = y;\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var fov = THREE.Math.radToDeg(2 * Math.atan(Math.tan(THREE.Math.degToRad(this.fov) * 0.5) / this.zoom));\r\n\r\n  if (this.fullWidth) {\r\n\r\n    var aspect = this.fullWidth / this.fullHeight;\r\n    var top = Math.tan(THREE.Math.degToRad(fov * 0.5)) * this.near;\r\n    var bottom = -top;\r\n    var left = aspect * bottom;\r\n    var right = aspect * top;\r\n    var width = Math.abs(right - left);\r\n    var height = Math.abs(top - bottom);\r\n\r\n    this.projectionMatrix.makeFrustum(\r\n      left + this.x * width / this.fullWidth,\r\n      left + (this.x + this.width) * width / this.fullWidth,\r\n      top - (this.y + this.height) * height / this.fullHeight,\r\n      top - this.y * height / this.fullHeight,\r\n      this.near,\r\n      this.far\r\n    );\r\n\r\n  }\r\n  else {\r\n\r\n    this.projectionMatrix.makePerspective(fov, this.aspect, this.near, this.far);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.PerspectiveCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.fov = this.fov;\r\n  camera.aspect = this.aspect;\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function(color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Light';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nTHREE.Light.prototype.clone = function(light) {\r\n\r\n  if (light === undefined) light = new THREE.Light();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, light);\r\n\r\n  light.color.copy(this.color);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function(color) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AmbientLight';\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\nTHREE.AmbientLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.AmbientLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AreaLight.js\r\n\r\n/**\r\n * @author MPanknin / http://www.redplant.de/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.AreaLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AreaLight';\r\n\r\n  this.normal = new THREE.Vector3(0, -1, 0);\r\n  this.right = new THREE.Vector3(1, 0, 0);\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.width = 1.0;\r\n  this.height = 1.0;\r\n\r\n  this.constantAttenuation = 1.5;\r\n  this.linearAttenuation = 0.5;\r\n  this.quadraticAttenuation = 0.1;\r\n\r\n};\r\n\r\nTHREE.AreaLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AreaLight.prototype.constructor = THREE.AreaLight;\r\n\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'DirectionalLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n\r\n  this.shadowCameraLeft = -500;\r\n  this.shadowCameraRight = 500;\r\n  this.shadowCameraTop = 500;\r\n  this.shadowCameraBottom = -500;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowCascade = false;\r\n\r\n  this.shadowCascadeOffset = new THREE.Vector3(0, 0, -1000);\r\n  this.shadowCascadeCount = 2;\r\n\r\n  this.shadowCascadeBias = [0, 0, 0];\r\n  this.shadowCascadeWidth = [512, 512, 512];\r\n  this.shadowCascadeHeight = [512, 512, 512];\r\n\r\n  this.shadowCascadeNearZ = [-1.000, 0.990, 0.998];\r\n  this.shadowCascadeFarZ = [0.990, 0.998, 1.000];\r\n\r\n  this.shadowCascadeArray = [];\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.DirectionalLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n\r\n  light.shadowCameraLeft = this.shadowCameraLeft;\r\n  light.shadowCameraRight = this.shadowCameraRight;\r\n  light.shadowCameraTop = this.shadowCameraTop;\r\n  light.shadowCameraBottom = this.shadowCameraBottom;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  //\r\n\r\n  light.shadowCascade = this.shadowCascade;\r\n\r\n  light.shadowCascadeOffset.copy(this.shadowCascadeOffset);\r\n  light.shadowCascadeCount = this.shadowCascadeCount;\r\n\r\n  light.shadowCascadeBias = this.shadowCascadeBias.slice(0);\r\n  light.shadowCascadeWidth = this.shadowCascadeWidth.slice(0);\r\n  light.shadowCascadeHeight = this.shadowCascadeHeight.slice(0);\r\n\r\n  light.shadowCascadeNearZ = this.shadowCascadeNearZ.slice(0);\r\n  light.shadowCascadeFarZ = this.shadowCascadeFarZ.slice(0);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function(skyColor, groundColor, intensity) {\r\n\r\n  THREE.Light.call(this, skyColor);\r\n\r\n  this.type = 'HemisphereLight';\r\n\r\n  this.position.set(0, 100, 0);\r\n\r\n  this.groundColor = new THREE.Color(groundColor);\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.HemisphereLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.groundColor.copy(this.groundColor);\r\n  light.intensity = this.intensity;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLight = function(color, intensity, distance, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'PointLight';\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nTHREE.PointLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.PointLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.decay = this.decay;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function(color, intensity, distance, angle, exponent, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'SpotLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.angle = (angle !== undefined) ? angle : Math.PI / 3;\r\n  this.exponent = (exponent !== undefined) ? exponent : 10;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n  this.shadowCameraFov = 50;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nTHREE.SpotLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.SpotLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.angle = this.angle;\r\n  light.exponent = this.exponent;\r\n  light.decay = this.decay;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n  light.shadowCameraFov = this.shadowCameraFov;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n  files: {},\r\n\r\n  add: function(key, file) {\r\n\r\n    // console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n    this.files[key] = file;\r\n\r\n  },\r\n\r\n  get: function(key) {\r\n\r\n    // console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n    return this.files[key];\r\n\r\n  },\r\n\r\n  remove: function(key) {\r\n\r\n    delete this.files[key];\r\n\r\n  },\r\n\r\n  clear: function() {\r\n\r\n    this.files = {}\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function(showStatus) {\r\n\r\n  this.showStatus = showStatus;\r\n  this.statusDomElement = showStatus ? THREE.Loader.prototype.addStatusElement() : null;\r\n\r\n  this.imageLoader = new THREE.ImageLoader();\r\n\r\n  this.onLoadStart = function() {};\r\n  this.onLoadProgress = function() {};\r\n  this.onLoadComplete = function() {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n  constructor: THREE.Loader,\r\n\r\n  crossOrigin: undefined,\r\n\r\n  addStatusElement: function() {\r\n\r\n    var e = document.createElement('div');\r\n\r\n    e.style.position = 'absolute';\r\n    e.style.right = '0px';\r\n    e.style.top = '0px';\r\n    e.style.fontSize = '0.8em';\r\n    e.style.textAlign = 'left';\r\n    e.style.background = 'rgba(0,0,0,0.25)';\r\n    e.style.color = '#fff';\r\n    e.style.width = '120px';\r\n    e.style.padding = '0.5em 0.5em 0.5em 0.5em';\r\n    e.style.zIndex = 1000;\r\n\r\n    e.innerHTML = 'Loading ...';\r\n\r\n    return e;\r\n\r\n  },\r\n\r\n  updateProgress: function(progress) {\r\n\r\n    var message = 'Loaded ';\r\n\r\n    if (progress.total) {\r\n\r\n      message += (100 * progress.loaded / progress.total).toFixed(0) + '%';\r\n\r\n\r\n    }\r\n    else {\r\n\r\n      message += (progress.loaded / 1024).toFixed(2) + ' KB';\r\n\r\n    }\r\n\r\n    this.statusDomElement.innerHTML = message;\r\n\r\n  },\r\n\r\n  extractUrlBase: function(url) {\r\n\r\n    var parts = url.split('/');\r\n\r\n    if (parts.length === 1) return './';\r\n\r\n    parts.pop();\r\n\r\n    return parts.join('/') + '/';\r\n\r\n  },\r\n\r\n  initMaterials: function(materials, texturePath) {\r\n\r\n    var array = [];\r\n\r\n    for (var i = 0; i < materials.length; ++i) {\r\n\r\n      array[i] = this.createMaterial(materials[i], texturePath);\r\n\r\n    }\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  needsTangents: function(materials) {\r\n\r\n    for (var i = 0, il = materials.length; i < il; i++) {\r\n\r\n      var m = materials[i];\r\n\r\n      if (m instanceof THREE.ShaderMaterial) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  createMaterial: function(m, texturePath) {\r\n\r\n    var scope = this;\r\n\r\n    function nearest_pow2(n) {\r\n\r\n      var l = Math.log(n) / Math.LN2;\r\n      return Math.pow(2, Math.round(l));\r\n\r\n    }\r\n\r\n    function create_texture(where, name, sourceFile, repeat, offset, wrap, anisotropy) {\r\n\r\n      var fullPath = texturePath + sourceFile;\r\n\r\n      var texture;\r\n\r\n      var loader = THREE.Loader.Handlers.get(fullPath);\r\n\r\n      if (loader !== null) {\r\n\r\n        texture = loader.load(fullPath);\r\n\r\n      }\r\n      else {\r\n\r\n        texture = new THREE.Texture();\r\n\r\n        loader = scope.imageLoader;\r\n        loader.crossOrigin = scope.crossOrigin;\r\n        loader.load(fullPath, function(image) {\r\n\r\n          if (THREE.Math.isPowerOfTwo(image.width) === false ||\r\n            THREE.Math.isPowerOfTwo(image.height) === false) {\r\n\r\n            var width = nearest_pow2(image.width);\r\n            var height = nearest_pow2(image.height);\r\n\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n\r\n            var context = canvas.getContext('2d');\r\n            context.drawImage(image, 0, 0, width, height);\r\n\r\n            texture.image = canvas;\r\n\r\n          }\r\n          else {\r\n\r\n            texture.image = image;\r\n\r\n          }\r\n\r\n          texture.needsUpdate = true;\r\n\r\n        });\r\n\r\n      }\r\n\r\n      texture.sourceFile = sourceFile;\r\n\r\n      if (repeat) {\r\n\r\n        texture.repeat.set(repeat[0], repeat[1]);\r\n\r\n        if (repeat[0] !== 1) texture.wrapS = THREE.RepeatWrapping;\r\n        if (repeat[1] !== 1) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n      }\r\n\r\n      if (offset) {\r\n\r\n        texture.offset.set(offset[0], offset[1]);\r\n\r\n      }\r\n\r\n      if (wrap) {\r\n\r\n        var wrapMap = {\r\n          'repeat': THREE.RepeatWrapping,\r\n          'mirror': THREE.MirroredRepeatWrapping\r\n        }\r\n\r\n        if (wrapMap[wrap[0]] !== undefined) texture.wrapS = wrapMap[wrap[0]];\r\n        if (wrapMap[wrap[1]] !== undefined) texture.wrapT = wrapMap[wrap[1]];\r\n\r\n      }\r\n\r\n      if (anisotropy) {\r\n\r\n        texture.anisotropy = anisotropy;\r\n\r\n      }\r\n\r\n      where[name] = texture;\r\n\r\n    }\r\n\r\n    function rgb2hex(rgb) {\r\n\r\n      return (rgb[0] * 255 << 16) + (rgb[1] * 255 << 8) + rgb[2] * 255;\r\n\r\n    }\r\n\r\n    // defaults\r\n\r\n    var mtype = 'MeshLambertMaterial';\r\n    var mpars = {\r\n      color: 0xeeeeee,\r\n      opacity: 1.0,\r\n      map: null,\r\n      lightMap: null,\r\n      normalMap: null,\r\n      bumpMap: null,\r\n      wireframe: false\r\n    };\r\n\r\n    // parameters from model file\r\n\r\n    if (m.shading) {\r\n\r\n      var shading = m.shading.toLowerCase();\r\n\r\n      if (shading === 'phong') mtype = 'MeshPhongMaterial';\r\n      else if (shading === 'basic') mtype = 'MeshBasicMaterial';\r\n\r\n    }\r\n\r\n    if (m.blending !== undefined && THREE[m.blending] !== undefined) {\r\n\r\n      mpars.blending = THREE[m.blending];\r\n\r\n    }\r\n\r\n    if (m.transparent !== undefined) {\r\n\r\n      mpars.transparent = m.transparent;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined && m.opacity < 1.0) {\r\n\r\n      mpars.transparent = true;\r\n\r\n    }\r\n\r\n    if (m.depthTest !== undefined) {\r\n\r\n      mpars.depthTest = m.depthTest;\r\n\r\n    }\r\n\r\n    if (m.depthWrite !== undefined) {\r\n\r\n      mpars.depthWrite = m.depthWrite;\r\n\r\n    }\r\n\r\n    if (m.visible !== undefined) {\r\n\r\n      mpars.visible = m.visible;\r\n\r\n    }\r\n\r\n    if (m.flipSided !== undefined) {\r\n\r\n      mpars.side = THREE.BackSide;\r\n\r\n    }\r\n\r\n    if (m.doubleSided !== undefined) {\r\n\r\n      mpars.side = THREE.DoubleSide;\r\n\r\n    }\r\n\r\n    if (m.wireframe !== undefined) {\r\n\r\n      mpars.wireframe = m.wireframe;\r\n\r\n    }\r\n\r\n    if (m.vertexColors !== undefined) {\r\n\r\n      if (m.vertexColors === 'face') {\r\n\r\n        mpars.vertexColors = THREE.FaceColors;\r\n\r\n      }\r\n      else if (m.vertexColors) {\r\n\r\n        mpars.vertexColors = THREE.VertexColors;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // colors\r\n\r\n    if (m.colorDiffuse) {\r\n\r\n      mpars.color = rgb2hex(m.colorDiffuse);\r\n\r\n    }\r\n    else if (m.DbgColor) {\r\n\r\n      mpars.color = m.DbgColor;\r\n\r\n    }\r\n\r\n    if (m.colorSpecular) {\r\n\r\n      mpars.specular = rgb2hex(m.colorSpecular);\r\n\r\n    }\r\n\r\n    if (m.colorEmissive) {\r\n\r\n      mpars.emissive = rgb2hex(m.colorEmissive);\r\n\r\n    }\r\n\r\n    // modifiers\r\n\r\n    if (m.transparency !== undefined) {\r\n\r\n      console.warn('THREE.Loader: transparency has been renamed to opacity');\r\n      m.opacity = m.transparency;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined) {\r\n\r\n      mpars.opacity = m.opacity;\r\n\r\n    }\r\n\r\n    if (m.specularCoef) {\r\n\r\n      mpars.shininess = m.specularCoef;\r\n\r\n    }\r\n\r\n    // textures\r\n\r\n    if (m.mapDiffuse && texturePath) {\r\n\r\n      create_texture(mpars, 'map', m.mapDiffuse, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapLight && texturePath) {\r\n\r\n      create_texture(mpars, 'lightMap', m.mapLight, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapBump && texturePath) {\r\n\r\n      create_texture(mpars, 'bumpMap', m.mapBump, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapNormal && texturePath) {\r\n\r\n      create_texture(mpars, 'normalMap', m.mapNormal, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapSpecular && texturePath) {\r\n\r\n      create_texture(mpars, 'specularMap', m.mapSpecular, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapAlpha && texturePath) {\r\n\r\n      create_texture(mpars, 'alphaMap', m.mapAlpha, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy);\r\n\r\n    }\r\n\r\n    //\r\n\r\n    if (m.mapBumpScale) {\r\n\r\n      mpars.bumpScale = m.mapBumpScale;\r\n\r\n    }\r\n\r\n    if (m.mapNormalFactor) {\r\n\r\n      mpars.normalScale = new THREE.Vector2(m.mapNormalFactor, m.mapNormalFactor);\r\n\r\n    }\r\n\r\n    var material = new THREE[mtype](mpars);\r\n\r\n    if (m.DbgName !== undefined) material.name = m.DbgName;\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n  handlers: [],\r\n\r\n  add: function(regex, loader) {\r\n\r\n    this.handlers.push(regex, loader);\r\n\r\n  },\r\n\r\n  get: function(file) {\r\n\r\n    for (var i = 0, l = this.handlers.length; i < l; i += 2) {\r\n\r\n      var regex = this.handlers[i];\r\n      var loader = this.handlers[i + 1];\r\n\r\n      if (regex.test(file)) {\r\n\r\n        return loader;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return null;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n  constructor: THREE.XHRLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      if (onLoad) onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open('GET', url, true);\r\n\r\n    request.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this.response);\r\n\r\n      if (onLoad) onLoad(this.response);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      request.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      request.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) request.crossOrigin = this.crossOrigin;\r\n    if (this.responseType !== undefined) request.responseType = this.responseType;\r\n\r\n    request.send(null);\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n  },\r\n\r\n  setResponseType: function(value) {\r\n\r\n    this.responseType = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n  constructor: THREE.ImageLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var image = document.createElement('img');\r\n\r\n    image.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this);\r\n\r\n      if (onLoad) onLoad(this);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      image.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      image.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) image.crossOrigin = this.crossOrigin;\r\n\r\n    image.src = url;\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n    return image;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n}\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function(showStatus) {\r\n\r\n  THREE.Loader.call(this, showStatus);\r\n\r\n  this.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = Object.create(THREE.Loader.prototype);\r\nTHREE.JSONLoader.prototype.constructor = THREE.JSONLoader;\r\n\r\nTHREE.JSONLoader.prototype.load = function(url, callback, texturePath) {\r\n\r\n  // todo: unify load API to for easier SceneLoader use\r\n\r\n  texturePath = texturePath && (typeof texturePath === 'string') ? texturePath : this.extractUrlBase(url);\r\n\r\n  this.onLoadStart();\r\n  this.loadAjaxJSON(this, url, callback, texturePath);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.loadAjaxJSON = function(context, url, callback, texturePath, callbackProgress) {\r\n\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  var length = 0;\r\n\r\n  xhr.onreadystatechange = function() {\r\n\r\n    if (xhr.readyState === xhr.DONE) {\r\n\r\n      if (xhr.status === 200 || xhr.status === 0) {\r\n\r\n        if (xhr.responseText) {\r\n\r\n          var json = JSON.parse(xhr.responseText);\r\n          var metadata = json.metadata;\r\n\r\n          if (metadata !== undefined) {\r\n\r\n            if (metadata.type === 'object') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n            if (metadata.type === 'scene') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' seems to be a Scene. Use THREE.SceneLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          var result = context.parse(json, texturePath);\r\n          callback(result.geometry, result.materials);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error('THREE.JSONLoader: ' + url + ' seems to be unreachable or the file is empty.');\r\n\r\n        }\r\n\r\n        // in context of more complex asset initialization\r\n        // do not block on single failed file\r\n        // maybe should go even one more level up\r\n\r\n        context.onLoadComplete();\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.JSONLoader: Couldn\\'t load ' + url + ' (' + xhr.status + ')');\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.LOADING) {\r\n\r\n      if (callbackProgress) {\r\n\r\n        if (length === 0) {\r\n\r\n          length = xhr.getResponseHeader('Content-Length');\r\n\r\n        }\r\n\r\n        callbackProgress({\r\n          total: length,\r\n          loaded: xhr.responseText.length\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.HEADERS_RECEIVED) {\r\n\r\n      if (callbackProgress !== undefined) {\r\n\r\n        length = xhr.getResponseHeader('Content-Length');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  xhr.open('GET', url, true);\r\n  xhr.withCredentials = this.withCredentials;\r\n  xhr.send(null);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.parse = function(json, texturePath) {\r\n\r\n  var geometry = new THREE.Geometry(),\r\n    scale = (json.scale !== undefined) ? 1.0 / json.scale : 1.0;\r\n\r\n  parseModel(scale);\r\n\r\n  parseSkin();\r\n  parseMorphing(scale);\r\n\r\n  geometry.computeFaceNormals();\r\n  geometry.computeBoundingSphere();\r\n\r\n  function parseModel(scale) {\r\n\r\n    function isBitSet(value, position) {\r\n\r\n      return value & (1 << position);\r\n\r\n    }\r\n\r\n    var i, j, fi,\r\n\r\n      offset, zLength,\r\n\r\n      colorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n      type,\r\n      isQuad,\r\n      hasMaterial,\r\n      hasFaceVertexUv,\r\n      hasFaceNormal, hasFaceVertexNormal,\r\n      hasFaceColor, hasFaceVertexColor,\r\n\r\n      vertex, face, faceA, faceB, hex, normal,\r\n\r\n      uvLayer, uv, u, v,\r\n\r\n      faces = json.faces,\r\n      vertices = json.vertices,\r\n      normals = json.normals,\r\n      colors = json.colors,\r\n\r\n      nUvLayers = 0;\r\n\r\n    if (json.uvs !== undefined) {\r\n\r\n      // disregard empty arrays\r\n\r\n      for (i = 0; i < json.uvs.length; i++) {\r\n\r\n        if (json.uvs[i].length) nUvLayers++;\r\n\r\n      }\r\n\r\n      for (i = 0; i < nUvLayers; i++) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = vertices.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      vertex = new THREE.Vector3();\r\n\r\n      vertex.x = vertices[offset++] * scale;\r\n      vertex.y = vertices[offset++] * scale;\r\n      vertex.z = vertices[offset++] * scale;\r\n\r\n      geometry.vertices.push(vertex);\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = faces.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      type = faces[offset++];\r\n\r\n\r\n      isQuad = isBitSet(type, 0);\r\n      hasMaterial = isBitSet(type, 1);\r\n      hasFaceVertexUv = isBitSet(type, 3);\r\n      hasFaceNormal = isBitSet(type, 4);\r\n      hasFaceVertexNormal = isBitSet(type, 5);\r\n      hasFaceColor = isBitSet(type, 6);\r\n      hasFaceVertexColor = isBitSet(type, 7);\r\n\r\n      // console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n      if (isQuad) {\r\n\r\n        faceA = new THREE.Face3();\r\n        faceA.a = faces[offset];\r\n        faceA.b = faces[offset + 1];\r\n        faceA.c = faces[offset + 3];\r\n\r\n        faceB = new THREE.Face3();\r\n        faceB.a = faces[offset + 1];\r\n        faceB.b = faces[offset + 2];\r\n        faceB.c = faces[offset + 3];\r\n\r\n        offset += 4;\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          faceA.materialIndex = materialIndex;\r\n          faceB.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n            geometry.faceVertexUvs[i][fi + 1] = []\r\n\r\n            for (j = 0; j < 4; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              if (j !== 2) geometry.faceVertexUvs[i][fi].push(uv);\r\n              if (j !== 0) geometry.faceVertexUvs[i][fi + 1].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          faceA.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n          faceB.normal.copy(faceA.normal);\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n\r\n            if (i !== 2) faceA.vertexNormals.push(normal);\r\n            if (i !== 0) faceB.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          hex = colors[colorIndex];\r\n\r\n          faceA.color.setHex(hex);\r\n          faceB.color.setHex(hex);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            hex = colors[colorIndex];\r\n\r\n            if (i !== 2) faceA.vertexColors.push(new THREE.Color(hex));\r\n            if (i !== 0) faceB.vertexColors.push(new THREE.Color(hex));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(faceA);\r\n        geometry.faces.push(faceB);\r\n\r\n      }\r\n      else {\r\n\r\n        face = new THREE.Face3();\r\n        face.a = faces[offset++];\r\n        face.b = faces[offset++];\r\n        face.c = faces[offset++];\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          face.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n\r\n            for (j = 0; j < 3; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              geometry.faceVertexUvs[i][fi].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          face.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n            face.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          face.color.setHex(colors[colorIndex]);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            face.vertexColors.push(new THREE.Color(colors[colorIndex]));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(face);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function parseSkin() {\r\n    var influencesPerVertex = (json.influencesPerVertex !== undefined) ? json.influencesPerVertex : 2;\r\n\r\n    if (json.skinWeights) {\r\n\r\n      for (var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex) {\r\n\r\n        var x = json.skinWeights[i];\r\n        var y = (influencesPerVertex > 1) ? json.skinWeights[i + 1] : 0;\r\n        var z = (influencesPerVertex > 2) ? json.skinWeights[i + 2] : 0;\r\n        var w = (influencesPerVertex > 3) ? json.skinWeights[i + 3] : 0;\r\n\r\n        geometry.skinWeights.push(new THREE.Vector4(x, y, z, w));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.skinIndices) {\r\n\r\n      for (var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex) {\r\n\r\n        var a = json.skinIndices[i];\r\n        var b = (influencesPerVertex > 1) ? json.skinIndices[i + 1] : 0;\r\n        var c = (influencesPerVertex > 2) ? json.skinIndices[i + 2] : 0;\r\n        var d = (influencesPerVertex > 3) ? json.skinIndices[i + 3] : 0;\r\n\r\n        geometry.skinIndices.push(new THREE.Vector4(a, b, c, d));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.bones = json.bones;\r\n\r\n    if (geometry.bones && geometry.bones.length > 0 && (geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length)) {\r\n\r\n      THREE.warn('THREE.JSONLoader: When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n        geometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.');\r\n\r\n    }\r\n\r\n\r\n    // could change this to json.animations[0] or remove completely\r\n\r\n    geometry.animation = json.animation;\r\n    geometry.animations = json.animations;\r\n\r\n  };\r\n\r\n  function parseMorphing(scale) {\r\n\r\n    if (json.morphTargets !== undefined) {\r\n\r\n      var i, l, v, vl, dstVertices, srcVertices;\r\n\r\n      for (i = 0, l = json.morphTargets.length; i < l; i++) {\r\n\r\n        geometry.morphTargets[i] = {};\r\n        geometry.morphTargets[i].name = json.morphTargets[i].name;\r\n        geometry.morphTargets[i].vertices = [];\r\n\r\n        dstVertices = geometry.morphTargets[i].vertices;\r\n        srcVertices = json.morphTargets[i].vertices;\r\n\r\n        for (v = 0, vl = srcVertices.length; v < vl; v += 3) {\r\n\r\n          var vertex = new THREE.Vector3();\r\n          vertex.x = srcVertices[v] * scale;\r\n          vertex.y = srcVertices[v + 1] * scale;\r\n          vertex.z = srcVertices[v + 2] * scale;\r\n\r\n          dstVertices.push(vertex);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.morphColors !== undefined) {\r\n\r\n      var i, l, c, cl, dstColors, srcColors, color;\r\n\r\n      for (i = 0, l = json.morphColors.length; i < l; i++) {\r\n\r\n        geometry.morphColors[i] = {};\r\n        geometry.morphColors[i].name = json.morphColors[i].name;\r\n        geometry.morphColors[i].colors = [];\r\n\r\n        dstColors = geometry.morphColors[i].colors;\r\n        srcColors = json.morphColors[i].colors;\r\n\r\n        for (c = 0, cl = srcColors.length; c < cl; c += 3) {\r\n\r\n          color = new THREE.Color(0xffaa00);\r\n          color.setRGB(srcColors[c], srcColors[c + 1], srcColors[c + 2]);\r\n          dstColors.push(color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  if (json.materials === undefined || json.materials.length === 0) {\r\n\r\n    return {\r\n      geometry: geometry\r\n    };\r\n\r\n  }\r\n  else {\r\n\r\n    var materials = this.initMaterials(json.materials, texturePath);\r\n\r\n    if (this.needsTangents(materials)) {\r\n\r\n      geometry.computeTangents();\r\n\r\n    }\r\n\r\n    return {\r\n      geometry: geometry,\r\n      materials: materials\r\n    };\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function(onLoad, onProgress, onError) {\r\n\r\n  var scope = this;\r\n\r\n  var loaded = 0,\r\n    total = 0;\r\n\r\n  this.onLoad = onLoad;\r\n  this.onProgress = onProgress;\r\n  this.onError = onError;\r\n\r\n  this.itemStart = function(url) {\r\n\r\n    total++;\r\n\r\n  };\r\n\r\n  this.itemEnd = function(url) {\r\n\r\n    loaded++;\r\n\r\n    if (scope.onProgress !== undefined) {\r\n\r\n      scope.onProgress(url, loaded, total);\r\n\r\n    }\r\n\r\n    if (loaded === total && scope.onLoad !== undefined) {\r\n\r\n      scope.onLoad();\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n  constructor: THREE.BufferGeometryLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    var attributes = json.data.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n      var typedArray = new self[attribute.type](attribute.array);\r\n\r\n      geometry.addAttribute(key, new THREE.BufferAttribute(typedArray, attribute.itemSize));\r\n\r\n    }\r\n\r\n    var offsets = json.data.offsets;\r\n\r\n    if (offsets !== undefined) {\r\n\r\n      geometry.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    var boundingSphere = json.data.boundingSphere;\r\n\r\n    if (boundingSphere !== undefined) {\r\n\r\n      var center = new THREE.Vector3();\r\n\r\n      if (boundingSphere.center !== undefined) {\r\n\r\n        center.fromArray(boundingSphere.center);\r\n\r\n      }\r\n\r\n      geometry.boundingSphere = new THREE.Sphere(center, boundingSphere.radius);\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n  constructor: THREE.MaterialLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var material = new THREE[json.type];\r\n\r\n    if (json.color !== undefined) material.color.setHex(json.color);\r\n    if (json.emissive !== undefined) material.emissive.setHex(json.emissive);\r\n    if (json.specular !== undefined) material.specular.setHex(json.specular);\r\n    if (json.shininess !== undefined) material.shininess = json.shininess;\r\n    if (json.uniforms !== undefined) material.uniforms = json.uniforms;\r\n    if (json.vertexShader !== undefined) material.vertexShader = json.vertexShader;\r\n    if (json.fragmentShader !== undefined) material.fragmentShader = json.fragmentShader;\r\n    if (json.vertexColors !== undefined) material.vertexColors = json.vertexColors;\r\n    if (json.shading !== undefined) material.shading = json.shading;\r\n    if (json.blending !== undefined) material.blending = json.blending;\r\n    if (json.side !== undefined) material.side = json.side;\r\n    if (json.opacity !== undefined) material.opacity = json.opacity;\r\n    if (json.transparent !== undefined) material.transparent = json.transparent;\r\n    if (json.wireframe !== undefined) material.wireframe = json.wireframe;\r\n\r\n    // for PointCloudMaterial\r\n    if (json.size !== undefined) material.size = json.size;\r\n    if (json.sizeAttenuation !== undefined) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n    if (json.materials !== undefined) {\r\n\r\n      for (var i = 0, l = json.materials.length; i < l; i++) {\r\n\r\n        material.materials.push(this.parse(json.materials[i]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n  this.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n  constructor: THREE.ObjectLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    if (this.texturePath === '') {\r\n\r\n      this.texturePath = url.substring(0, url.lastIndexOf('/') + 1);\r\n\r\n    }\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      scope.parse(JSON.parse(text), onLoad);\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setTexturePath: function(value) {\r\n\r\n    this.texturePath = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json, onLoad) {\r\n\r\n    var geometries = this.parseGeometries(json.geometries);\r\n\r\n    var images = this.parseImages(json.images, function() {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    });\r\n    var textures = this.parseTextures(json.textures, images);\r\n    var materials = this.parseMaterials(json.materials, textures);\r\n    var object = this.parseObject(json.object, geometries, materials);\r\n\r\n    if (json.images === undefined || json.images.length === 0) {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  },\r\n\r\n  parseGeometries: function(json) {\r\n\r\n    var geometries = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var geometryLoader = new THREE.JSONLoader();\r\n      var bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var geometry;\r\n        var data = json[i];\r\n\r\n        switch (data.type) {\r\n\r\n          case 'PlaneGeometry':\r\n          case 'PlaneBufferGeometry':\r\n\r\n            geometry = new THREE[data.type](\r\n              data.width,\r\n              data.height,\r\n              data.widthSegments,\r\n              data.heightSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BoxGeometry':\r\n          case 'CubeGeometry': // backwards compatible\r\n\r\n            geometry = new THREE.BoxGeometry(\r\n              data.width,\r\n              data.height,\r\n              data.depth,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.depthSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CircleGeometry':\r\n\r\n            geometry = new THREE.CircleGeometry(\r\n              data.radius,\r\n              data.segments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CylinderGeometry':\r\n\r\n            geometry = new THREE.CylinderGeometry(\r\n              data.radiusTop,\r\n              data.radiusBottom,\r\n              data.height,\r\n              data.radialSegments,\r\n              data.heightSegments,\r\n              data.openEnded\r\n            );\r\n\r\n            break;\r\n\r\n          case 'SphereGeometry':\r\n\r\n            geometry = new THREE.SphereGeometry(\r\n              data.radius,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.phiStart,\r\n              data.phiLength,\r\n              data.thetaStart,\r\n              data.thetaLength\r\n            );\r\n\r\n            break;\r\n\r\n          case 'IcosahedronGeometry':\r\n\r\n            geometry = new THREE.IcosahedronGeometry(\r\n              data.radius,\r\n              data.detail\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusGeometry':\r\n\r\n            geometry = new THREE.TorusGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.arc\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusKnotGeometry':\r\n\r\n            geometry = new THREE.TorusKnotGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.p,\r\n              data.q,\r\n              data.heightScale\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BufferGeometry':\r\n\r\n            geometry = bufferGeometryLoader.parse(data);\r\n\r\n            break;\r\n\r\n          case 'Geometry':\r\n\r\n            geometry = geometryLoader.parse(data.data).geometry;\r\n\r\n            break;\r\n\r\n        }\r\n\r\n        geometry.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) geometry.name = data.name;\r\n\r\n        geometries[data.uuid] = geometry;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometries;\r\n\r\n  },\r\n\r\n  parseMaterials: function(json, textures) {\r\n\r\n    var materials = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var getTexture = function(name) {\r\n\r\n        if (textures[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined texture', name);\r\n\r\n        }\r\n\r\n        return textures[name];\r\n\r\n      };\r\n\r\n      var loader = new THREE.MaterialLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n        var material = loader.parse(data);\r\n\r\n        material.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) material.name = data.name;\r\n\r\n        if (data.map !== undefined) {\r\n\r\n          material.map = getTexture(data.map);\r\n\r\n        }\r\n\r\n        if (data.bumpMap !== undefined) {\r\n\r\n          material.bumpMap = getTexture(data.bumpMap);\r\n          if (data.bumpScale) {\r\n            material.bumpScale = new THREE.Vector2(data.bumpScale, data.bumpScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.alphaMap !== undefined) {\r\n\r\n          material.alphaMap = getTexture(data.alphaMap);\r\n\r\n        }\r\n\r\n        if (data.envMap !== undefined) {\r\n\r\n          material.envMap = getTexture(data.envMap);\r\n\r\n        }\r\n\r\n        if (data.normalMap !== undefined) {\r\n\r\n          material.normalMap = getTexture(data.normalMap);\r\n          if (data.normalScale) {\r\n            material.normalScale = new THREE.Vector2(data.normalScale, data.normalScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.lightMap !== undefined) {\r\n\r\n          material.lightMap = getTexture(data.lightMap);\r\n\r\n        }\r\n\r\n        if (data.specularMap !== undefined) {\r\n\r\n          material.specularMap = getTexture(data.specularMap);\r\n\r\n        }\r\n\r\n        materials[data.uuid] = material;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return materials;\r\n\r\n  },\r\n\r\n  parseImages: function(json, onLoad) {\r\n\r\n    var scope = this;\r\n    var images = {};\r\n\r\n    if (json !== undefined && json.length > 0) {\r\n\r\n      var manager = new THREE.LoadingManager(onLoad);\r\n\r\n      var loader = new THREE.ImageLoader(manager);\r\n      loader.setCrossOrigin(this.crossOrigin);\r\n\r\n      var loadImage = function(url) {\r\n\r\n        scope.manager.itemStart(url);\r\n\r\n        return loader.load(url, function() {\r\n\r\n          scope.manager.itemEnd(url);\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var image = json[i];\r\n        var path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(image.url) ? image.url : scope.texturePath + image.url;\r\n\r\n        images[image.uuid] = loadImage(path);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return images;\r\n\r\n  },\r\n\r\n  parseTextures: function(json, images) {\r\n\r\n    var textures = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n\r\n        if (data.image === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: No \"image\" speficied for', data.uuid);\r\n\r\n        }\r\n\r\n        if (images[data.image] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined image', data.image);\r\n\r\n        }\r\n\r\n        var texture = new THREE.Texture(images[data.image]);\r\n        texture.needsUpdate = true;\r\n\r\n        texture.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) texture.name = data.name;\r\n        if (data.repeat !== undefined) texture.repeat = new THREE.Vector2(data.repeat[0], data.repeat[1]);\r\n        if (data.minFilter !== undefined) texture.minFilter = THREE[data.minFilter];\r\n        if (data.magFilter !== undefined) texture.magFilter = THREE[data.magFilter];\r\n        if (data.anisotropy !== undefined) texture.anisotropy = data.anisotropy;\r\n        if (data.wrap instanceof Array) {\r\n\r\n          texture.wrapS = THREE[data.wrap[0]];\r\n          texture.wrapT = THREE[data.wrap[1]];\r\n\r\n        }\r\n\r\n        textures[data.uuid] = texture;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return textures;\r\n\r\n  },\r\n\r\n  parseObject: function() {\r\n\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(data, geometries, materials) {\r\n\r\n      var object;\r\n\r\n      var getGeometry = function(name) {\r\n\r\n        if (geometries[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined geometry', name);\r\n\r\n        }\r\n\r\n        return geometries[name];\r\n\r\n      };\r\n\r\n      var getMaterial = function(name) {\r\n\r\n        if (materials[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined material', name);\r\n\r\n        }\r\n\r\n        return materials[name];\r\n\r\n      };\r\n\r\n      switch (data.type) {\r\n\r\n        case 'Scene':\r\n\r\n          object = new THREE.Scene();\r\n\r\n          break;\r\n\r\n        case 'PerspectiveCamera':\r\n\r\n          object = new THREE.PerspectiveCamera(data.fov, data.aspect, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'OrthographicCamera':\r\n\r\n          object = new THREE.OrthographicCamera(data.left, data.right, data.top, data.bottom, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'AmbientLight':\r\n\r\n          object = new THREE.AmbientLight(data.color);\r\n\r\n          break;\r\n\r\n        case 'DirectionalLight':\r\n\r\n          object = new THREE.DirectionalLight(data.color, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'PointLight':\r\n\r\n          object = new THREE.PointLight(data.color, data.intensity, data.distance, data.decay);\r\n\r\n          break;\r\n\r\n        case 'SpotLight':\r\n\r\n          object = new THREE.SpotLight(data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay);\r\n\r\n          break;\r\n\r\n        case 'HemisphereLight':\r\n\r\n          object = new THREE.HemisphereLight(data.color, data.groundColor, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'Mesh':\r\n\r\n          object = new THREE.Mesh(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Line':\r\n\r\n          object = new THREE.Line(getGeometry(data.geometry), getMaterial(data.material), data.mode);\r\n\r\n          break;\r\n\r\n        case 'PointCloud':\r\n\r\n          object = new THREE.PointCloud(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Sprite':\r\n\r\n          object = new THREE.Sprite(getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Group':\r\n\r\n          object = new THREE.Group();\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          object = new THREE.Object3D();\r\n\r\n      }\r\n\r\n      object.uuid = data.uuid;\r\n\r\n      if (data.name !== undefined) object.name = data.name;\r\n      if (data.matrix !== undefined) {\r\n\r\n        matrix.fromArray(data.matrix);\r\n        matrix.decompose(object.position, object.quaternion, object.scale);\r\n\r\n      }\r\n      else {\r\n\r\n        if (data.position !== undefined) object.position.fromArray(data.position);\r\n        if (data.rotation !== undefined) object.rotation.fromArray(data.rotation);\r\n        if (data.scale !== undefined) object.scale.fromArray(data.scale);\r\n\r\n      }\r\n\r\n      if (data.visible !== undefined) object.visible = data.visible;\r\n      if (data.userData !== undefined) object.userData = data.userData;\r\n\r\n      if (data.children !== undefined) {\r\n\r\n        for (var child in data.children) {\r\n\r\n          object.add(this.parseObject(data.children[child], geometries, materials));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return object;\r\n\r\n    }\r\n\r\n  }()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n  constructor: THREE.TextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.ImageLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(image) {\r\n\r\n      var texture = new THREE.Texture(image);\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad !== undefined) {\r\n\r\n        onLoad(texture);\r\n\r\n      }\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n  constructor: THREE.BinaryTextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var texture = new THREE.DataTexture();\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    loader.load(url, function(buffer) {\r\n\r\n      var texData = scope._parser(buffer);\r\n\r\n      if (!texData) return;\r\n\r\n      if (undefined !== texData.image) {\r\n\r\n        texture.image = texData.image;\r\n\r\n      }\r\n      else if (undefined !== texData.data) {\r\n\r\n        texture.image.width = texData.width;\r\n        texture.image.height = texData.height;\r\n        texture.image.data = texData.data;\r\n\r\n      }\r\n\r\n      texture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n      texture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n      texture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n      texture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n      texture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n      if (undefined !== texData.format) {\r\n\r\n        texture.format = texData.format;\r\n\r\n      }\r\n      if (undefined !== texData.type) {\r\n\r\n        texture.type = texData.type;\r\n\r\n      }\r\n\r\n      if (undefined !== texData.mipmaps) {\r\n\r\n        texture.mipmaps = texData.mipmaps;\r\n\r\n      }\r\n\r\n      if (1 === texData.mipmapCount) {\r\n\r\n        texture.minFilter = THREE.LinearFilter;\r\n\r\n      }\r\n\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture, texData);\r\n\r\n    }, onProgress, onError);\r\n\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n  constructor: THREE.CompressedTextureLoader,\r\n\r\n  load: function(url, onLoad, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var images = [];\r\n\r\n    var texture = new THREE.CompressedTexture();\r\n    texture.image = images;\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    if (url instanceof Array) {\r\n\r\n      var loaded = 0;\r\n\r\n      var loadTexture = function(i) {\r\n\r\n        loader.load(url[i], function(buffer) {\r\n\r\n          var texDatas = scope._parser(buffer, true);\r\n\r\n          images[i] = {\r\n            width: texDatas.width,\r\n            height: texDatas.height,\r\n            format: texDatas.format,\r\n            mipmaps: texDatas.mipmaps\r\n          };\r\n\r\n          loaded += 1;\r\n\r\n          if (loaded === 6) {\r\n\r\n            if (texDatas.mipmapCount == 1)\r\n              texture.minFilter = THREE.LinearFilter;\r\n\r\n            texture.format = texDatas.format;\r\n            texture.needsUpdate = true;\r\n\r\n            if (onLoad) onLoad(texture);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, il = url.length; i < il; ++i) {\r\n\r\n        loadTexture(i);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // compressed cubemap texture stored in a single DDS file\r\n\r\n      loader.load(url, function(buffer) {\r\n\r\n        var texDatas = scope._parser(buffer, true);\r\n\r\n        if (texDatas.isCubemap) {\r\n\r\n          var faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n          for (var f = 0; f < faces; f++) {\r\n\r\n            images[f] = {\r\n              mipmaps: []\r\n            };\r\n\r\n            for (var i = 0; i < texDatas.mipmapCount; i++) {\r\n\r\n              images[f].mipmaps.push(texDatas.mipmaps[f * texDatas.mipmapCount + i]);\r\n              images[f].format = texDatas.format;\r\n              images[f].width = texDatas.width;\r\n              images[f].height = texDatas.height;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          texture.image.width = texDatas.width;\r\n          texture.image.height = texDatas.height;\r\n          texture.mipmaps = texDatas.mipmaps;\r\n\r\n        }\r\n\r\n        if (texDatas.mipmapCount === 1) {\r\n\r\n          texture.minFilter = THREE.LinearFilter;\r\n\r\n        }\r\n\r\n        texture.format = texDatas.format;\r\n        texture.needsUpdate = true;\r\n\r\n        if (onLoad) onLoad(texture);\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.MaterialIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Material';\r\n\r\n  this.side = THREE.FrontSide;\r\n\r\n  this.opacity = 1;\r\n  this.transparent = false;\r\n\r\n  this.blending = THREE.NormalBlending;\r\n\r\n  this.blendSrc = THREE.SrcAlphaFactor;\r\n  this.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n  this.blendEquation = THREE.AddEquation;\r\n  this.blendSrcAlpha = null;\r\n  this.blendDstAlpha = null;\r\n  this.blendEquationAlpha = null;\r\n\r\n  this.depthTest = true;\r\n  this.depthWrite = true;\r\n\r\n  this.colorWrite = true;\r\n\r\n  this.polygonOffset = false;\r\n  this.polygonOffsetFactor = 0;\r\n  this.polygonOffsetUnits = 0;\r\n\r\n  this.alphaTest = 0;\r\n\r\n  this.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n  this.visible = true;\r\n\r\n  this._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n  constructor: THREE.Material,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  setValues: function(values) {\r\n\r\n    if (values === undefined) return;\r\n\r\n    for (var key in values) {\r\n\r\n      var newValue = values[key];\r\n\r\n      if (newValue === undefined) {\r\n\r\n        THREE.warn(\"THREE.Material: '\" + key + \"' parameter is undefined.\");\r\n        continue;\r\n\r\n      }\r\n\r\n      if (key in this) {\r\n\r\n        var currentValue = this[key];\r\n\r\n        if (currentValue instanceof THREE.Color) {\r\n\r\n          currentValue.set(newValue);\r\n\r\n        }\r\n        else if (currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3) {\r\n\r\n          currentValue.copy(newValue);\r\n\r\n        }\r\n        else if (key == 'overdraw') {\r\n\r\n          // ensure overdraw is backwards-compatable with legacy boolean type\r\n          this[key] = Number(newValue);\r\n\r\n        }\r\n        else {\r\n\r\n          this[key] = newValue;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this instanceof THREE.MeshBasicMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshLambertMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshPhongMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      output.specular = this.specular.getHex();\r\n      output.shininess = this.shininess;\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshNormalMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshDepthMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.PointCloudMaterial) {\r\n\r\n      output.size = this.size;\r\n      output.sizeAttenuation = this.sizeAttenuation;\r\n      output.color = this.color.getHex();\r\n\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n\r\n    }\r\n    else if (this instanceof THREE.ShaderMaterial) {\r\n\r\n      output.uniforms = this.uniforms;\r\n      output.vertexShader = this.vertexShader;\r\n      output.fragmentShader = this.fragmentShader;\r\n\r\n    }\r\n    else if (this instanceof THREE.SpriteMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n\r\n    }\r\n\r\n    if (this.opacity < 1) output.opacity = this.opacity;\r\n    if (this.transparent !== false) output.transparent = this.transparent;\r\n    if (this.wireframe !== false) output.wireframe = this.wireframe;\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(material) {\r\n\r\n    if (material === undefined) material = new THREE.Material();\r\n\r\n    material.name = this.name;\r\n\r\n    material.side = this.side;\r\n\r\n    material.opacity = this.opacity;\r\n    material.transparent = this.transparent;\r\n\r\n    material.blending = this.blending;\r\n\r\n    material.blendSrc = this.blendSrc;\r\n    material.blendDst = this.blendDst;\r\n    material.blendEquation = this.blendEquation;\r\n    material.blendSrcAlpha = this.blendSrcAlpha;\r\n    material.blendDstAlpha = this.blendDstAlpha;\r\n    material.blendEquationAlpha = this.blendEquationAlpha;\r\n\r\n    material.depthTest = this.depthTest;\r\n    material.depthWrite = this.depthWrite;\r\n\r\n    material.polygonOffset = this.polygonOffset;\r\n    material.polygonOffsetFactor = this.polygonOffsetFactor;\r\n    material.polygonOffsetUnits = this.polygonOffsetUnits;\r\n\r\n    material.alphaTest = this.alphaTest;\r\n\r\n    material.overdraw = this.overdraw;\r\n\r\n    material.visible = this.visible;\r\n\r\n    return material;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Material.prototype);\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n  this.linecap = 'round';\r\n  this.linejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n  material.linecap = this.linecap;\r\n  material.linejoin = this.linejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineDashedMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.scale = 1;\r\n  this.dashSize = 3;\r\n  this.gapSize = 1;\r\n\r\n  this.vertexColors = false;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineDashedMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n\r\n  material.scale = this.scale;\r\n  material.dashSize = this.dashSize;\r\n  material.gapSize = this.gapSize;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // emissive\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshLambertMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshLambertMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshPhongMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n  this.specular = new THREE.Color(0x111111);\r\n  this.shininess = 30;\r\n\r\n  this.metal = false;\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.bumpMap = null;\r\n  this.bumpScale = 1;\r\n\r\n  this.normalMap = null;\r\n  this.normalScale = new THREE.Vector2(1, 1);\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshPhongMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n  material.specular.copy(this.specular);\r\n  material.shininess = this.shininess;\r\n\r\n  material.metal = this.metal;\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.bumpMap = this.bumpMap;\r\n  material.bumpScale = this.bumpScale;\r\n\r\n  material.normalMap = this.normalMap;\r\n  material.normalScale.copy(this.normalScale);\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshDepthMaterial';\r\n\r\n  this.morphTargets = false;\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshDepthMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  shading: THREE.FlatShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this, parameters);\r\n\r\n  this.type = 'MeshNormalMaterial';\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshNormalMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshFaceMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MeshFaceMaterial = function(materials) {\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.type = 'MeshFaceMaterial';\r\n\r\n  this.materials = materials instanceof Array ? materials : [];\r\n\r\n};\r\n\r\nTHREE.MeshFaceMaterial.prototype = {\r\n\r\n  constructor: THREE.MeshFaceMaterial,\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      materials: []\r\n    };\r\n\r\n    for (var i = 0, l = this.materials.length; i < l; i++) {\r\n\r\n      output.materials.push(this.materials[i].toJSON());\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var material = new THREE.MeshFaceMaterial();\r\n\r\n    for (var i = 0; i < this.materials.length; i++) {\r\n\r\n      material.materials.push(this.materials[i].clone());\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/PointCloudMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointCloudMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'PointCloudMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.map = null;\r\n\r\n  this.size = 1;\r\n  this.sizeAttenuation = true;\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.PointCloudMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.PointCloudMaterial.prototype.constructor = THREE.PointCloudMaterial;\r\n\r\nTHREE.PointCloudMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.PointCloudMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.size = this.size;\r\n  material.sizeAttenuation = this.sizeAttenuation;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.ParticleBasicMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\nTHREE.ParticleSystemMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'ShaderMaterial';\r\n\r\n  this.defines = {};\r\n  this.uniforms = {};\r\n  this.attributes = null;\r\n\r\n  this.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n  this.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.fog = false; // set to use scene fog\r\n\r\n  this.lights = false; // set to use scene lights\r\n\r\n  this.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n  this.skinning = false; // set to use skinning attribute streams\r\n\r\n  this.morphTargets = false; // set to use morph targets\r\n  this.morphNormals = false; // set to use morph normals\r\n\r\n  // When rendered geometry doesn't include these attributes but the material does,\r\n  // use these default values in WebGL. This avoids errors when buffer data is missing.\r\n  this.defaultAttributeValues = {\r\n    'color': [1, 1, 1],\r\n    'uv': [0, 0],\r\n    'uv2': [0, 0]\r\n  };\r\n\r\n  this.index0AttributeName = undefined;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.ShaderMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.fragmentShader = this.fragmentShader;\r\n  material.vertexShader = this.vertexShader;\r\n\r\n  material.uniforms = THREE.UniformsUtils.clone(this.uniforms);\r\n\r\n  material.attributes = this.attributes;\r\n  material.defines = this.defines;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.lights = this.lights;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function(parameters) {\r\n\r\n  THREE.ShaderMaterial.call(this, parameters);\r\n\r\n  this.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\nTHREE.RawShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.RawShaderMaterial();\r\n\r\n  THREE.ShaderMaterial.prototype.clone.call(this, material);\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'SpriteMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n  this.map = null;\r\n\r\n  this.rotation = 0;\r\n\r\n  this.fog = false;\r\n\r\n  // set parameters\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.SpriteMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.map = this.map;\r\n\r\n  material.rotation = this.rotation;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function(image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.TextureIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.sourceFile = '';\r\n\r\n  this.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n  this.mipmaps = [];\r\n\r\n  this.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n  this.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n  this.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n  this.format = format !== undefined ? format : THREE.RGBAFormat;\r\n  this.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.generateMipmaps = true;\r\n  this.premultiplyAlpha = false;\r\n  this.flipY = true;\r\n  this.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n  this._needsUpdate = false;\r\n  this.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n  constructor: THREE.Texture,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  clone: function(texture) {\r\n\r\n    if (texture === undefined) texture = new THREE.Texture();\r\n\r\n    texture.image = this.image;\r\n    texture.mipmaps = this.mipmaps.slice(0);\r\n\r\n    texture.mapping = this.mapping;\r\n\r\n    texture.wrapS = this.wrapS;\r\n    texture.wrapT = this.wrapT;\r\n\r\n    texture.magFilter = this.magFilter;\r\n    texture.minFilter = this.minFilter;\r\n\r\n    texture.anisotropy = this.anisotropy;\r\n\r\n    texture.format = this.format;\r\n    texture.type = this.type;\r\n\r\n    texture.offset.copy(this.offset);\r\n    texture.repeat.copy(this.repeat);\r\n\r\n    texture.generateMipmaps = this.generateMipmaps;\r\n    texture.premultiplyAlpha = this.premultiplyAlpha;\r\n    texture.flipY = this.flipY;\r\n    texture.unpackAlignment = this.unpackAlignment;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function(images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  mapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n  THREE.Texture.call(this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.images = images;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nTHREE.CubeTexture.clone = function(texture) {\r\n\r\n  if (texture === undefined) texture = new THREE.CubeTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  texture.images = this.images;\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function(mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    width: width,\r\n    height: height\r\n  };\r\n  this.mipmaps = mipmaps;\r\n\r\n  // no flipping for cube textures\r\n  // (also flipping doesn't work for compressed textures )\r\n\r\n  this.flipY = false;\r\n\r\n  // can't generate mipmaps for compressed textures\r\n  // mips must be embedded in DDS files\r\n\r\n  this.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\nTHREE.CompressedTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.CompressedTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function(data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    data: data,\r\n    width: width,\r\n    height: height\r\n  };\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\nTHREE.DataTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.DataTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function(video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  THREE.Texture.call(this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.generateMipmaps = false;\r\n\r\n  var scope = this;\r\n\r\n  var update = function() {\r\n\r\n    requestAnimationFrame(update);\r\n\r\n    if (video.readyState === video.HAVE_ENOUGH_DATA) {\r\n\r\n      scope.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  update();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n\r\n// File:src/objects/PointCloud.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.PointCloud = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'PointCloud';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.PointCloudMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n};\r\n\r\nTHREE.PointCloud.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.PointCloud.prototype.constructor = THREE.PointCloud;\r\n\r\nTHREE.PointCloud.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var object = this;\r\n    var geometry = object.geometry;\r\n    var threshold = raycaster.params.PointCloud.threshold;\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var localThreshold = threshold / ((this.scale.x + this.scale.y + this.scale.z) / 3);\r\n    var position = new THREE.Vector3();\r\n\r\n    var testPoint = function(point, index) {\r\n\r\n      var rayPointDistance = ray.distanceToPoint(point);\r\n\r\n      if (rayPointDistance < localThreshold) {\r\n\r\n        var intersectPoint = ray.closestPointToPoint(point);\r\n        intersectPoint.applyMatrix4(object.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectPoint);\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          distanceToRay: rayPointDistance,\r\n          point: intersectPoint.clone(),\r\n          index: index,\r\n          face: null,\r\n          object: object\r\n\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          var offset = {\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          };\r\n\r\n          offsets = [offset];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i++) {\r\n\r\n            var a = index + indices[i];\r\n\r\n            position.fromArray(positions, a * 3);\r\n\r\n            testPoint(position, a);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var pointCount = positions.length / 3;\r\n\r\n        for (var i = 0; i < pointCount; i++) {\r\n\r\n          position.set(\r\n            positions[3 * i],\r\n            positions[3 * i + 1],\r\n            positions[3 * i + 2]\r\n          );\r\n\r\n          testPoint(position, i);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      var vertices = this.geometry.vertices;\r\n\r\n      for (var i = 0; i < vertices.length; i++) {\r\n\r\n        testPoint(vertices[i], i);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.PointCloud.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.PointCloud(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.ParticleSystem = function(geometry, material) {\r\n\r\n  THREE.warn('THREE.ParticleSystem has been renamed to THREE.PointCloud.');\r\n  return new THREE.PointCloud(geometry, material);\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function(geometry, material, mode) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Line';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.LineBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.mode = mode !== undefined ? mode : THREE.LineStrip;\r\n\r\n};\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\nTHREE.Line.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var precision = raycaster.linePrecision;\r\n    var precisionSq = precision * precision;\r\n\r\n    var geometry = this.geometry;\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    var vStart = new THREE.Vector3();\r\n    var vEnd = new THREE.Vector3();\r\n    var interSegment = new THREE.Vector3();\r\n    var interRay = new THREE.Vector3();\r\n    var step = this.mode === THREE.LineStrip ? 1 : 2;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0; oi < offsets.length; oi++) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start; i < start + count - 1; i += step) {\r\n\r\n            var a = index + indices[i];\r\n            var b = index + indices[i + 1];\r\n\r\n            vStart.fromArray(positions, a * 3);\r\n            vEnd.fromArray(positions, b * 3);\r\n\r\n            var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n            if (distSq > precisionSq) continue;\r\n\r\n            var distance = ray.origin.distanceTo(interRay);\r\n\r\n            if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              // What do we want? intersection point on the ray or on the segment??\r\n              // point: raycaster.ray.at( distance ),\r\n              point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n              index: i,\r\n              offsetIndex: oi,\r\n              face: null,\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0; i < positions.length / 3 - 1; i += step) {\r\n\r\n          vStart.fromArray(positions, 3 * i);\r\n          vEnd.fromArray(positions, 3 * i + 3);\r\n\r\n          var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n          if (distSq > precisionSq) continue;\r\n\r\n          var distance = ray.origin.distanceTo(interRay);\r\n\r\n          if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            // What do we want? intersection point on the ray or on the segment??\r\n            // point: raycaster.ray.at( distance ),\r\n            point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n            index: i,\r\n            face: null,\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var vertices = geometry.vertices;\r\n      var nbVertices = vertices.length;\r\n\r\n      for (var i = 0; i < nbVertices - 1; i += step) {\r\n\r\n        var distSq = ray.distanceSqToSegment(vertices[i], vertices[i + 1], interRay, interSegment);\r\n\r\n        if (distSq > precisionSq) continue;\r\n\r\n        var distance = ray.origin.distanceTo(interRay);\r\n\r\n        if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          // What do we want? intersection point on the ray or on the segment??\r\n          // point: raycaster.ray.at( distance ),\r\n          point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n          index: i,\r\n          face: null,\r\n          faceIndex: null,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Line.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Line(this.geometry, this.material, this.mode);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Mesh';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.MeshBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function() {\r\n\r\n  if (this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0) {\r\n\r\n    this.morphTargetBase = -1;\r\n    this.morphTargetForcedOrder = [];\r\n    this.morphTargetInfluences = [];\r\n    this.morphTargetDictionary = {};\r\n\r\n    for (var m = 0, ml = this.geometry.morphTargets.length; m < ml; m++) {\r\n\r\n      this.morphTargetInfluences.push(0);\r\n      this.morphTargetDictionary[this.geometry.morphTargets[m].name] = m;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function(name) {\r\n\r\n  if (this.morphTargetDictionary[name] !== undefined) {\r\n\r\n    return this.morphTargetDictionary[name];\r\n\r\n  }\r\n\r\n  THREE.warn('THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.');\r\n\r\n  return 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  var vA = new THREE.Vector3();\r\n  var vB = new THREE.Vector3();\r\n  var vC = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var geometry = this.geometry;\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    // Check boundingBox before continuing\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var material = this.material;\r\n\r\n      if (material === undefined) return;\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            a = index + indices[i];\r\n            b = index + indices[i + 1];\r\n            c = index + indices[i + 2];\r\n\r\n            vA.fromArray(positions, a * 3);\r\n            vB.fromArray(positions, b * 3);\r\n            vC.fromArray(positions, c * 3);\r\n\r\n            if (material.side === THREE.BackSide) {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n            }\r\n            else {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n            }\r\n\r\n            if (intersectionPoint === null) continue;\r\n\r\n            intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n            var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n            if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              point: intersectionPoint,\r\n              face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0, j = 0, il = positions.length; i < il; i += 3, j += 9) {\r\n\r\n          a = i;\r\n          b = i + 1;\r\n          c = i + 2;\r\n\r\n          vA.fromArray(positions, j);\r\n          vB.fromArray(positions, j + 3);\r\n          vC.fromArray(positions, j + 6);\r\n\r\n          if (material.side === THREE.BackSide) {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n          }\r\n          else {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n          }\r\n\r\n          if (intersectionPoint === null) continue;\r\n\r\n          intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n          var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n          if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            point: intersectionPoint,\r\n            face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var isFaceMaterial = this.material instanceof THREE.MeshFaceMaterial;\r\n      var objectMaterials = isFaceMaterial === true ? this.material.materials : null;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      var vertices = geometry.vertices;\r\n\r\n      for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n        var face = geometry.faces[f];\r\n\r\n        var material = isFaceMaterial === true ? objectMaterials[face.materialIndex] : this.material;\r\n\r\n        if (material === undefined) continue;\r\n\r\n        a = vertices[face.a];\r\n        b = vertices[face.b];\r\n        c = vertices[face.c];\r\n\r\n        if (material.morphTargets === true) {\r\n\r\n          var morphTargets = geometry.morphTargets;\r\n          var morphInfluences = this.morphTargetInfluences;\r\n\r\n          vA.set(0, 0, 0);\r\n          vB.set(0, 0, 0);\r\n          vC.set(0, 0, 0);\r\n\r\n          for (var t = 0, tl = morphTargets.length; t < tl; t++) {\r\n\r\n            var influence = morphInfluences[t];\r\n\r\n            if (influence === 0) continue;\r\n\r\n            var targets = morphTargets[t].vertices;\r\n\r\n            vA.x += (targets[face.a].x - a.x) * influence;\r\n            vA.y += (targets[face.a].y - a.y) * influence;\r\n            vA.z += (targets[face.a].z - a.z) * influence;\r\n\r\n            vB.x += (targets[face.b].x - b.x) * influence;\r\n            vB.y += (targets[face.b].y - b.y) * influence;\r\n            vB.z += (targets[face.b].z - b.z) * influence;\r\n\r\n            vC.x += (targets[face.c].x - c.x) * influence;\r\n            vC.y += (targets[face.c].y - c.y) * influence;\r\n            vC.z += (targets[face.c].z - c.z) * influence;\r\n\r\n          }\r\n\r\n          vA.add(a);\r\n          vB.add(b);\r\n          vC.add(c);\r\n\r\n          a = vA;\r\n          b = vB;\r\n          c = vC;\r\n\r\n        }\r\n\r\n        if (material.side === THREE.BackSide) {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(c, b, a, true);\r\n\r\n        }\r\n        else {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(a, b, c, material.side !== THREE.DoubleSide);\r\n\r\n        }\r\n\r\n        if (intersectionPoint === null) continue;\r\n\r\n        intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n        if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          point: intersectionPoint,\r\n          face: face,\r\n          faceIndex: f,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Mesh.prototype.clone = function(object, recursive) {\r\n\r\n  if (object === undefined) object = new THREE.Mesh(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object, recursive);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function(skin) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Bone';\r\n\r\n  this.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function(bones, boneInverses, useVertexTexture) {\r\n\r\n  this.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n  this.identityMatrix = new THREE.Matrix4();\r\n\r\n  // copy the bone array\r\n\r\n  bones = bones || [];\r\n\r\n  this.bones = bones.slice(0);\r\n\r\n  // create a bone texture or an array of floats\r\n\r\n  if (this.useVertexTexture) {\r\n\r\n    // layout (1 matrix = 4 pixels)\r\n    //      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n    //  with  8x8  pixel texture max   16 bones  (8 * 8  / 4)\r\n    //       16x16 pixel texture max   64 bones (16 * 16 / 4)\r\n    //       32x32 pixel texture max  256 bones (32 * 32 / 4)\r\n    //       64x64 pixel texture max 1024 bones (64 * 64 / 4)\r\n\r\n    var size;\r\n\r\n    if (this.bones.length > 256)\r\n      size = 64;\r\n    else if (this.bones.length > 64)\r\n      size = 32;\r\n    else if (this.bones.length > 16)\r\n      size = 16;\r\n    else\r\n      size = 8;\r\n\r\n    this.boneTextureWidth = size;\r\n    this.boneTextureHeight = size;\r\n\r\n    this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4); // 4 floats per RGBA pixel\r\n    this.boneTexture = new THREE.DataTexture(this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType);\r\n    this.boneTexture.minFilter = THREE.NearestFilter;\r\n    this.boneTexture.magFilter = THREE.NearestFilter;\r\n    this.boneTexture.generateMipmaps = false;\r\n    this.boneTexture.flipY = false;\r\n\r\n  }\r\n  else {\r\n\r\n    this.boneMatrices = new Float32Array(16 * this.bones.length);\r\n\r\n  }\r\n\r\n  // use the supplied bone inverses or calculate the inverses\r\n\r\n  if (boneInverses === undefined) {\r\n\r\n    this.calculateInverses();\r\n\r\n  }\r\n  else {\r\n\r\n    if (this.bones.length === boneInverses.length) {\r\n\r\n      this.boneInverses = boneInverses.slice(0);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Skeleton bonInverses is the wrong length.');\r\n\r\n      this.boneInverses = [];\r\n\r\n      for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n        this.boneInverses.push(new THREE.Matrix4());\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function() {\r\n\r\n  this.boneInverses = [];\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    var inverse = new THREE.Matrix4();\r\n\r\n    if (this.bones[b]) {\r\n\r\n      inverse.getInverse(this.bones[b].matrixWorld);\r\n\r\n    }\r\n\r\n    this.boneInverses.push(inverse);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function() {\r\n\r\n  var bone;\r\n\r\n  // recover the bind-time world matrices\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      bone.matrixWorld.getInverse(this.boneInverses[b]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // compute the local matrices, positions, rotations and scales\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      if (bone.parent) {\r\n\r\n        bone.matrix.getInverse(bone.parent.matrixWorld);\r\n        bone.matrix.multiply(bone.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.matrix.copy(bone.matrixWorld);\r\n\r\n      }\r\n\r\n      bone.matrix.decompose(bone.position, bone.quaternion, bone.scale);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = (function() {\r\n\r\n  var offsetMatrix = new THREE.Matrix4();\r\n\r\n  return function() {\r\n\r\n    // flatten bone matrices to array\r\n\r\n    for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n      // compute the offset between the current and the original transform\r\n\r\n      var matrix = this.bones[b] ? this.bones[b].matrixWorld : this.identityMatrix;\r\n\r\n      offsetMatrix.multiplyMatrices(matrix, this.boneInverses[b]);\r\n      offsetMatrix.flattenToArrayOffset(this.boneMatrices, b * 16);\r\n\r\n    }\r\n\r\n    if (this.useVertexTexture) {\r\n\r\n      this.boneTexture.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n})();\r\n\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function(geometry, material, useVertexTexture) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'SkinnedMesh';\r\n\r\n  this.bindMode = \"attached\";\r\n  this.bindMatrix = new THREE.Matrix4();\r\n  this.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n  // init bones\r\n\r\n  // TODO: remove bone creation as there is no reason (other than\r\n  // convenience) for THREE.SkinnedMesh to do this.\r\n\r\n  var bones = [];\r\n\r\n  if (this.geometry && this.geometry.bones !== undefined) {\r\n\r\n    var bone, gbone, p, q, s;\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      p = gbone.pos;\r\n      q = gbone.rotq;\r\n      s = gbone.scl;\r\n\r\n      bone = new THREE.Bone(this);\r\n      bones.push(bone);\r\n\r\n      bone.name = gbone.name;\r\n      bone.position.set(p[0], p[1], p[2]);\r\n      bone.quaternion.set(q[0], q[1], q[2], q[3]);\r\n\r\n      if (s !== undefined) {\r\n\r\n        bone.scale.set(s[0], s[1], s[2]);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.scale.set(1, 1, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      if (gbone.parent !== -1) {\r\n\r\n        bones[gbone.parent].add(bones[b]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.add(bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.normalizeSkinWeights();\r\n\r\n  this.updateMatrixWorld(true);\r\n  this.bind(new THREE.Skeleton(bones, undefined, useVertexTexture));\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function(skeleton, bindMatrix) {\r\n\r\n  this.skeleton = skeleton;\r\n\r\n  if (bindMatrix === undefined) {\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    bindMatrix = this.matrixWorld;\r\n\r\n  }\r\n\r\n  this.bindMatrix.copy(bindMatrix);\r\n  this.bindMatrixInverse.getInverse(bindMatrix);\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function() {\r\n\r\n  this.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function() {\r\n\r\n  if (this.geometry instanceof THREE.Geometry) {\r\n\r\n    for (var i = 0; i < this.geometry.skinIndices.length; i++) {\r\n\r\n      var sw = this.geometry.skinWeights[i];\r\n\r\n      var scale = 1.0 / sw.lengthManhattan();\r\n\r\n      if (scale !== Infinity) {\r\n\r\n        sw.multiplyScalar(scale);\r\n\r\n      }\r\n      else {\r\n\r\n        sw.set(1); // this will be normalized by the shader anyway\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    // skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function(force) {\r\n\r\n  THREE.Mesh.prototype.updateMatrixWorld.call(this, true);\r\n\r\n  if (this.bindMode === \"attached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.matrixWorld);\r\n\r\n  }\r\n  else if (this.bindMode === \"detached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.bindMatrix);\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.SkinnedMesh unreckognized bindMode: ' + this.bindMode);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) {\r\n\r\n    object = new THREE.SkinnedMesh(this.geometry, this.material, this.useVertexTexture);\r\n\r\n  }\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n\r\n// File:src/objects/MorphAnimMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphAnimMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'MorphAnimMesh';\r\n\r\n  // API\r\n\r\n  this.duration = 1000; // milliseconds\r\n  this.mirroredLoop = false;\r\n  this.time = 0;\r\n\r\n  // internals\r\n\r\n  this.lastKeyframe = 0;\r\n  this.currentKeyframe = 0;\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n  this.setFrameRange(0, this.geometry.morphTargets.length - 1);\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;\r\n\r\nTHREE.MorphAnimMesh.prototype.setFrameRange = function(start, end) {\r\n\r\n  this.startKeyframe = start;\r\n  this.endKeyframe = end;\r\n\r\n  this.length = this.endKeyframe - this.startKeyframe + 1;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionForward = function() {\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionBackward = function() {\r\n\r\n  this.direction = -1;\r\n  this.directionBackwards = true;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.parseAnimations = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  if (!geometry.animations) geometry.animations = {};\r\n\r\n  var firstAnimation, animations = geometry.animations;\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var parts = morph.name.match(pattern);\r\n\r\n    if (parts && parts.length > 1) {\r\n\r\n      var label = parts[1];\r\n\r\n      if (!animations[label]) animations[label] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var animation = animations[label];\r\n\r\n      if (i < animation.start) animation.start = i;\r\n      if (i > animation.end) animation.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = label;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setAnimationLabel = function(label, start, end) {\r\n\r\n  if (!this.geometry.animations) this.geometry.animations = {};\r\n\r\n  this.geometry.animations[label] = {\r\n    start: start,\r\n    end: end\r\n  };\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.playAnimation = function(label, fps) {\r\n\r\n  var animation = this.geometry.animations[label];\r\n\r\n  if (animation) {\r\n\r\n    this.setFrameRange(animation.start, animation.end);\r\n    this.duration = 1000 * ((animation.end - animation.start) / fps);\r\n    this.time = 0;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.updateAnimation = function(delta) {\r\n\r\n  var frameTime = this.duration / this.length;\r\n\r\n  this.time += this.direction * delta;\r\n\r\n  if (this.mirroredLoop) {\r\n\r\n    if (this.time > this.duration || this.time < 0) {\r\n\r\n      this.direction *= -1;\r\n\r\n      if (this.time > this.duration) {\r\n\r\n        this.time = this.duration;\r\n        this.directionBackwards = true;\r\n\r\n      }\r\n\r\n      if (this.time < 0) {\r\n\r\n        this.time = 0;\r\n        this.directionBackwards = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    this.time = this.time % this.duration;\r\n\r\n    if (this.time < 0) this.time += this.duration;\r\n\r\n  }\r\n\r\n  var keyframe = this.startKeyframe + THREE.Math.clamp(Math.floor(this.time / frameTime), 0, this.length - 1);\r\n\r\n  if (keyframe !== this.currentKeyframe) {\r\n\r\n    this.morphTargetInfluences[this.lastKeyframe] = 0;\r\n    this.morphTargetInfluences[this.currentKeyframe] = 1;\r\n\r\n    this.morphTargetInfluences[keyframe] = 0;\r\n\r\n    this.lastKeyframe = this.currentKeyframe;\r\n    this.currentKeyframe = keyframe;\r\n\r\n  }\r\n\r\n  var mix = (this.time % frameTime) / frameTime;\r\n\r\n  if (this.directionBackwards) {\r\n\r\n    mix = 1 - mix;\r\n\r\n  }\r\n\r\n  this.morphTargetInfluences[this.currentKeyframe] = mix;\r\n  this.morphTargetInfluences[this.lastKeyframe] = 1 - mix;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.interpolateTargets = function(a, b, t) {\r\n\r\n  var influences = this.morphTargetInfluences;\r\n\r\n  for (var i = 0, l = influences.length; i < l; i++) {\r\n\r\n    influences[i] = 0;\r\n\r\n  }\r\n\r\n  if (a > -1) influences[a] = 1 - t;\r\n  if (b > -1) influences[b] = t;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.MorphAnimMesh(this.geometry, this.material);\r\n\r\n  object.duration = this.duration;\r\n  object.mirroredLoop = this.mirroredLoop;\r\n  object.time = this.time;\r\n\r\n  object.lastKeyframe = this.lastKeyframe;\r\n  object.currentKeyframe = this.currentKeyframe;\r\n\r\n  object.direction = this.direction;\r\n  object.directionBackwards = this.directionBackwards;\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.objects = [];\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function(object, distance) {\r\n\r\n  if (distance === undefined) distance = 0;\r\n\r\n  distance = Math.abs(distance);\r\n\r\n  for (var l = 0; l < this.objects.length; l++) {\r\n\r\n    if (distance < this.objects[l].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.objects.splice(l, 0, {\r\n    distance: distance,\r\n    object: object\r\n  });\r\n  this.add(object);\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function(distance) {\r\n\r\n  for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n    if (distance < this.objects[i].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  return this.objects[i - 1].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.origin.distanceTo(matrixPosition);\r\n\r\n    this.getObjectForDistance(distance).raycast(raycaster, intersects);\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.LOD.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(camera) {\r\n\r\n    if (this.objects.length > 1) {\r\n\r\n      v1.setFromMatrixPosition(camera.matrixWorld);\r\n      v2.setFromMatrixPosition(this.matrixWorld);\r\n\r\n      var distance = v1.distanceTo(v2);\r\n\r\n      this.objects[0].object.visible = true;\r\n\r\n      for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n        if (distance >= this.objects[i].distance) {\r\n\r\n          this.objects[i - 1].object.visible = false;\r\n          this.objects[i].object.visible = true;\r\n\r\n        }\r\n        else {\r\n\r\n          break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (; i < l; i++) {\r\n\r\n        this.objects[i].object.visible = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.LOD();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  for (var i = 0, l = this.objects.length; i < l; i++) {\r\n    var x = this.objects[i].object.clone();\r\n    x.visible = i === 0;\r\n    object.addLevel(x, this.objects[i].distance);\r\n  }\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = (function() {\r\n\r\n  var indices = new Uint16Array([0, 1, 2, 0, 2, 3]);\r\n  var vertices = new Float32Array([-0.5, -0.5, 0, 0.5, -0.5, 0, 0.5, 0.5, 0, -0.5, 0.5, 0]);\r\n  var uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n  return function(material) {\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    this.type = 'Sprite';\r\n\r\n    this.geometry = geometry;\r\n    this.material = (material !== undefined) ? material : new THREE.SpriteMaterial();\r\n\r\n  };\r\n\r\n})();\r\n\r\nTHREE.Sprite.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.distanceToPoint(matrixPosition);\r\n\r\n    if (distance > this.scale.x) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    intersects.push({\r\n\r\n      distance: distance,\r\n      point: this.position,\r\n      face: null,\r\n      object: this\r\n\r\n    });\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Sprite.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Sprite(this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function(texture, size, distance, blending, color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.lensFlares = [];\r\n\r\n  this.positionScreen = new THREE.Vector3();\r\n  this.customUpdateCallback = undefined;\r\n\r\n  if (texture !== undefined) {\r\n\r\n    this.add(texture, size, distance, blending, color);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function(texture, size, distance, blending, color, opacity) {\r\n\r\n  if (size === undefined) size = -1;\r\n  if (distance === undefined) distance = 0;\r\n  if (opacity === undefined) opacity = 1;\r\n  if (color === undefined) color = new THREE.Color(0xffffff);\r\n  if (blending === undefined) blending = THREE.NormalBlending;\r\n\r\n  distance = Math.min(distance, Math.max(0, distance));\r\n\r\n  this.lensFlares.push({\r\n    texture: texture, // THREE.Texture\r\n    size: size, // size in pixels (-1 = use texture.width)\r\n    distance: distance, // distance (0-1) from light source (0=at light source)\r\n    x: 0,\r\n    y: 0,\r\n    z: 0, // screen position (-1 => 1) z = 0 is ontop z = 1 is back\r\n    scale: 1, // scale\r\n    rotation: 1, // rotation\r\n    opacity: opacity, // opacity\r\n    color: color, // color\r\n    blending: blending // blending\r\n  });\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function() {\r\n\r\n  var f, fl = this.lensFlares.length;\r\n  var flare;\r\n  var vecX = -this.positionScreen.x * 2;\r\n  var vecY = -this.positionScreen.y * 2;\r\n\r\n  for (f = 0; f < fl; f++) {\r\n\r\n    flare = this.lensFlares[f];\r\n\r\n    flare.x = this.positionScreen.x + vecX * flare.distance;\r\n    flare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n    flare.wantedRotation = flare.x * Math.PI * 0.25;\r\n    flare.rotation += (flare.wantedRotation - flare.rotation) * 0.25;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Scene';\r\n\r\n  this.fog = null;\r\n  this.overrideMaterial = null;\r\n\r\n  this.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Scene();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  if (this.fog !== null) object.fog = this.fog.clone();\r\n  if (this.overrideMaterial !== null) object.overrideMaterial = this.overrideMaterial.clone();\r\n\r\n  object.autoUpdate = this.autoUpdate;\r\n  object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function(color, near, far) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n  this.near = (near !== undefined) ? near : 1;\r\n  this.far = (far !== undefined) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function() {\r\n\r\n  return new THREE.Fog(this.color.getHex(), this.near, this.far);\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function(color, density) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n  this.density = (density !== undefined) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function() {\r\n\r\n  return new THREE.FogExp2(this.color.getHex(), this.density);\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk['common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\nfloat square( in float a ) { return a*a; }\\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\\nfloat average( in float a ) { return a; }\\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n}\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\\n\treturn point - distance * planeNormal;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\\n}\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\tif ( decayExponent > 0.0 ) {\\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\\n\t}\\n\treturn 1.0;\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n#ifdef GAMMA_INPUT\\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\nvec3 linearToOutput( in vec3 a ) {\\n#ifdef GAMMA_OUTPUT\\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\ntransformedNormal = normalize( transformedNormal );\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\tfloat dotProduct = dot( transformedNormal, dirVector );\\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\t#ifdef WRAP_AROUND\\n\\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\\n\\n\t#endif\\n\\n}\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tlVector = normalize( lVector );\\n\\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\\n\\n\t\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/default_vertex.glsl\r\n\r\nTHREE.ShaderChunk['default_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#elif defined( USE_MORPHTARGETS )\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\\n\\n#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\t#ifdef USE_MORPHNORMALS\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\\n\\n\t#else\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\nvec3 viewPosition = normalize( vViewPosition );\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\\n\\n\t\t\t\t// specular\\n\\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t\t#else\\n\\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t\t#endif\\n\\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, dirVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\\n\\n\t\t// specular\\n\\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t/*\\n\t\t// fresnel term from skin shader\\n\t\tconst float F0 = 0.128;\\n\\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\\n\t\tfloat exponential = pow( base, 5.0 );\\n\\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\\n\t\t*/\\n\\n\t\t/*\\n\t\t// fresnel term from fresnel shader\\n\t\tconst float mFresnelBias = 0.08;\\n\t\tconst float mFresnelScale = 0.3;\\n\t\tconst float mFresnelPower = 5.0;\\n\\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\\n\t\t*/\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += hemiColor;\\n\\n\t\t// specular (sky light)\\n\\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\\n\\n\t\t// specular (ground light)\\n\\n\t\tvec3 lVectorGround = -lVector;\\n\\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\\n\\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tvec3 morphedNormal = vec3( 0.0 );\\n\\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n\tmorphedNormal += normal;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\tuniform sampler2D lightMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = inputToLinear( color.xyz );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\t#ifdef USE_MORPHTARGETS\\n\\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\r\nTHREE.ShaderChunk['linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\\n\t\tfogFactor = whiteCompliment( fogFactor );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['defaultnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec3 objectNormal = skinnedNormal.xyz;\\n\\n#elif defined( USE_MORPHNORMALS )\\n\\n\tvec3 objectNormal = morphedNormal;\\n\\n#else\\n\\n\tvec3 objectNormal = normal;\\n\\n#endif\\n\\n#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\tvec3 morphed = vec3( 0.0 );\\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n\tmorphed += position;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\tint inFrustumCount = 0;\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\t\t// don't shadow pixels outside of light frustum\\n\t\t\t\t// use just first frustum (for cascades)\\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\\n\\n\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\tinFrustumCount += int( inFrustum );\\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\\n\\n\t\t#else\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t#endif\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#else\\n\\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t}\\n\\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\\n\tshadowColor = inputToLinear( shadowColor );\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk['worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#elif defined( USE_MORPHTARGETS )\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\t#extension GL_EXT_frag_depth : enable\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n  merge: function(uniforms) {\r\n\r\n    var merged = {};\r\n\r\n    for (var u = 0; u < uniforms.length; u++) {\r\n\r\n      var tmp = this.clone(uniforms[u]);\r\n\r\n      for (var p in tmp) {\r\n\r\n        merged[p] = tmp[p];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return merged;\r\n\r\n  },\r\n\r\n  clone: function(uniforms_src) {\r\n\r\n    var uniforms_dst = {};\r\n\r\n    for (var u in uniforms_src) {\r\n\r\n      uniforms_dst[u] = {};\r\n\r\n      for (var p in uniforms_src[u]) {\r\n\r\n        var parameter_src = uniforms_src[u][p];\r\n\r\n        if (parameter_src instanceof THREE.Color ||\r\n          parameter_src instanceof THREE.Vector2 ||\r\n          parameter_src instanceof THREE.Vector3 ||\r\n          parameter_src instanceof THREE.Vector4 ||\r\n          parameter_src instanceof THREE.Matrix4 ||\r\n          parameter_src instanceof THREE.Texture) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.clone();\r\n\r\n        }\r\n        else if (parameter_src instanceof Array) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.slice();\r\n\r\n        }\r\n        else {\r\n\r\n          uniforms_dst[u][p] = parameter_src;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return uniforms_dst;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n  common: {\r\n\r\n    \"diffuse\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"lightMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"specularMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"alphaMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n\r\n    \"envMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"flipEnvMap\": {\r\n      type: \"f\",\r\n      value: -1\r\n    },\r\n    \"reflectivity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"refractionRatio\": {\r\n      type: \"f\",\r\n      value: 0.98\r\n    },\r\n\r\n    \"morphTargetInfluences\": {\r\n      type: \"f\",\r\n      value: 0\r\n    }\r\n\r\n  },\r\n\r\n  bump: {\r\n\r\n    \"bumpMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"bumpScale\": {\r\n      type: \"f\",\r\n      value: 1\r\n    }\r\n\r\n  },\r\n\r\n  normalmap: {\r\n\r\n    \"normalMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"normalScale\": {\r\n      type: \"v2\",\r\n      value: new THREE.Vector2(1, 1)\r\n    }\r\n  },\r\n\r\n  fog: {\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  lights: {\r\n\r\n    \"ambientLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"directionalLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"directionalLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"hemisphereLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightSkyColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightGroundColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"pointLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"pointLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"spotLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightAngleCos\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightExponent\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    }\r\n\r\n  },\r\n\r\n  particle: {\r\n\r\n    \"psColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"size\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"scale\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  shadowmap: {\r\n\r\n    \"shadowMap\": {\r\n      type: \"tv\",\r\n      value: []\r\n    },\r\n    \"shadowMapSize\": {\r\n      type: \"v2v\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowBias\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"shadowDarkness\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowMatrix\": {\r\n      type: \"m4v\",\r\n      value: []\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n  'basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n\r\n      \"\t#ifdef USE_ENVMAP\",\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"], // TODO: Light map on an otherwise unlit surface doesn't make sense.\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"], // TODO: Shadows on an otherwise unlit surface doesn't make sense.\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'lambert': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define LAMBERT\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\t#ifdef DOUBLE_SIDED\",\r\n\r\n      //\"float isFront = float( gl_FrontFacing );\",\r\n      //\"gl_FragColor.xyz *= isFront * vLightFront + ( 1.0 - isFront ) * vLightBack;\",\r\n\r\n      \"\t\tif ( gl_FrontFacing )\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n      \"\t\telse\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'phong': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"bump\"],\r\n      THREE.UniformsLib[\"normalmap\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"specular\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x111111)\r\n        },\r\n        \"shininess\": {\r\n          type: \"f\",\r\n          value: 30\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"varying vec3 vViewPosition;\",\r\n\r\n      \"#ifndef FLAT_SHADED\",\r\n\r\n      \"\tvarying vec3 vNormal;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n      \"\tvNormal = normalize( transformedNormal );\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"\tvViewPosition = -mvPosition.xyz;\",\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform vec3 specular;\",\r\n      \"uniform float shininess;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"bumpmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"normalmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lights_phong_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'particle_basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"particle\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float size;\",\r\n      \"uniform float scale;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      \"\t#ifdef USE_SIZEATTENUATION\",\r\n      \"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n      \"\t#else\",\r\n      \"\t\tgl_PointSize = size;\",\r\n      \"\t#endif\",\r\n\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 psColor;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'dashed': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n\r\n      {\r\n        \"scale\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"dashSize\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"totalSize\": {\r\n          type: \"f\",\r\n          value: 2\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float scale;\",\r\n      \"attribute float lineDistance;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvLineDistance = scale * lineDistance;\",\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"uniform float dashSize;\",\r\n      \"uniform float totalSize;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\r\n      \"\t\tdiscard;\",\r\n\r\n      \"\t}\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'depth': {\r\n\r\n    uniforms: {\r\n\r\n      \"mNear\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      },\r\n      \"mFar\": {\r\n        type: \"f\",\r\n        value: 2000.0\r\n      },\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float mNear;\",\r\n      \"uniform float mFar;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      \"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n      \"\tgl_FragColor = vec4( vec3( color ), opacity );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'normal': {\r\n\r\n    uniforms: {\r\n\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvNormal = normalize( normalMatrix * normal );\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float opacity;\",\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'cube': {\r\n\r\n    uniforms: {\r\n      \"tCube\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform samplerCube tCube;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'equirect': {\r\n\r\n    uniforms: {\r\n      \"tEquirect\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform sampler2D tEquirect;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      // \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n      \"vec3 direction = normalize( vWorldPosition );\",\r\n      \"vec2 sampleUV;\",\r\n      \"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n      \"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n      \"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* Depth encoding into RGBA texture\r\n   *\r\n   * based on SpiderGL shadow map example\r\n   * http://spidergl.org/example.php?id=6\r\n   *\r\n   * originally from\r\n   * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n   *\r\n   * see also\r\n   * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n   */\r\n\r\n  'depthRGBA': {\r\n\r\n    uniforms: {},\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"vec4 pack_depth( const in float depth ) {\",\r\n\r\n      \"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n      \"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n      \"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n      \"\tres -= res.xxyz * bit_mask;\",\r\n      \"\treturn res;\",\r\n\r\n      \"}\",\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\r\n      \"\t#endif\",\r\n\r\n      //\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n      //\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n      //\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n      //\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.WebGLRenderer = function(parameters) {\r\n\r\n  console.log('THREE.WebGLRenderer', THREE.REVISION);\r\n\r\n  parameters = parameters || {};\r\n\r\n  var _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement('canvas'),\r\n    _context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n    pixelRatio = 1,\r\n\r\n    _precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\r\n    _alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n    _depth = parameters.depth !== undefined ? parameters.depth : true,\r\n    _stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n    _antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n    _premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n    _preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n    _logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false,\r\n\r\n    _clearColor = new THREE.Color(0x000000),\r\n    _clearAlpha = 0;\r\n\r\n  var lights = [];\r\n\r\n  var _webglObjects = {};\r\n  var _webglObjectsImmediate = [];\r\n\r\n  var opaqueObjects = [];\r\n  var transparentObjects = [];\r\n\r\n  var sprites = [];\r\n  var lensFlares = [];\r\n\r\n  // public properties\r\n\r\n  this.domElement = _canvas;\r\n  this.context = null;\r\n\r\n  // clearing\r\n\r\n  this.autoClear = true;\r\n  this.autoClearColor = true;\r\n  this.autoClearDepth = true;\r\n  this.autoClearStencil = true;\r\n\r\n  // scene graph\r\n\r\n  this.sortObjects = true;\r\n\r\n  // physically based shading\r\n\r\n  this.gammaFactor = 2.0; // for backwards compatibility\r\n  this.gammaInput = false;\r\n  this.gammaOutput = false;\r\n\r\n  // shadow map\r\n\r\n  this.shadowMapEnabled = false;\r\n  this.shadowMapType = THREE.PCFShadowMap;\r\n  this.shadowMapCullFace = THREE.CullFaceFront;\r\n  this.shadowMapDebug = false;\r\n  this.shadowMapCascade = false;\r\n\r\n  // morphs\r\n\r\n  this.maxMorphTargets = 8;\r\n  this.maxMorphNormals = 4;\r\n\r\n  // flags\r\n\r\n  this.autoScaleCubemaps = true;\r\n\r\n  // info\r\n\r\n  this.info = {\r\n\r\n    memory: {\r\n\r\n      programs: 0,\r\n      geometries: 0,\r\n      textures: 0\r\n\r\n    },\r\n\r\n    render: {\r\n\r\n      calls: 0,\r\n      vertices: 0,\r\n      faces: 0,\r\n      points: 0\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // internal properties\r\n\r\n  var _this = this,\r\n\r\n    _programs = [],\r\n\r\n    // internal state cache\r\n\r\n    _currentProgram = null,\r\n    _currentFramebuffer = null,\r\n    _currentMaterialId = -1,\r\n    _currentGeometryProgram = '',\r\n    _currentCamera = null,\r\n\r\n    _usedTextureUnits = 0,\r\n\r\n    _viewportX = 0,\r\n    _viewportY = 0,\r\n    _viewportWidth = _canvas.width,\r\n    _viewportHeight = _canvas.height,\r\n    _currentWidth = 0,\r\n    _currentHeight = 0,\r\n\r\n    // frustum\r\n\r\n    _frustum = new THREE.Frustum(),\r\n\r\n    // camera matrices cache\r\n\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _vector3 = new THREE.Vector3(),\r\n\r\n    // light arrays cache\r\n\r\n    _direction = new THREE.Vector3(),\r\n\r\n    _lightsNeedUpdate = true,\r\n\r\n    _lights = {\r\n\r\n      ambient: [0, 0, 0],\r\n      directional: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: []\r\n      },\r\n      point: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        decays: []\r\n      },\r\n      spot: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        directions: [],\r\n        anglesCos: [],\r\n        exponents: [],\r\n        decays: []\r\n      },\r\n      hemi: {\r\n        length: 0,\r\n        skyColors: [],\r\n        groundColors: [],\r\n        positions: []\r\n      }\r\n\r\n    };\r\n\r\n  // initialize\r\n\r\n  var _gl;\r\n\r\n  try {\r\n\r\n    var attributes = {\r\n      alpha: _alpha,\r\n      depth: _depth,\r\n      stencil: _stencil,\r\n      antialias: _antialias,\r\n      premultipliedAlpha: _premultipliedAlpha,\r\n      preserveDrawingBuffer: _preserveDrawingBuffer\r\n    };\r\n\r\n    _gl = _context || _canvas.getContext('webgl', attributes) || _canvas.getContext('experimental-webgl', attributes);\r\n\r\n    if (_gl === null) {\r\n\r\n      if (_canvas.getContext('webgl') !== null) {\r\n\r\n        throw 'Error creating WebGL context with your selected attributes.';\r\n\r\n      }\r\n      else {\r\n\r\n        throw 'Error creating WebGL context.';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _canvas.addEventListener('webglcontextlost', function(event) {\r\n\r\n      event.preventDefault();\r\n\r\n      resetGLState();\r\n      setDefaultGLState();\r\n\r\n      _webglObjects = {};\r\n\r\n    }, false);\r\n\r\n  }\r\n  catch (error) {\r\n\r\n    THREE.error('THREE.WebGLRenderer: ' + error);\r\n\r\n  }\r\n\r\n  var state = new THREE.WebGLState(_gl, paramThreeToGL);\r\n\r\n  if (_gl.getShaderPrecisionFormat === undefined) {\r\n\r\n    _gl.getShaderPrecisionFormat = function() {\r\n\r\n      return {\r\n        'rangeMin': 1,\r\n        'rangeMax': 1,\r\n        'precision': 1\r\n      };\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var extensions = new THREE.WebGLExtensions(_gl);\r\n\r\n  extensions.get('OES_texture_float');\r\n  extensions.get('OES_texture_float_linear');\r\n  extensions.get('OES_texture_half_float');\r\n  extensions.get('OES_texture_half_float_linear');\r\n  extensions.get('OES_standard_derivatives');\r\n\r\n  if (_logarithmicDepthBuffer) {\r\n\r\n    extensions.get('EXT_frag_depth');\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var glClearColor = function(r, g, b, a) {\r\n\r\n    if (_premultipliedAlpha === true) {\r\n\r\n      r *= a;\r\n      g *= a;\r\n      b *= a;\r\n\r\n    }\r\n\r\n    _gl.clearColor(r, g, b, a);\r\n\r\n  };\r\n\r\n  var setDefaultGLState = function() {\r\n\r\n    _gl.clearColor(0, 0, 0, 1);\r\n    _gl.clearDepth(1);\r\n    _gl.clearStencil(0);\r\n\r\n    _gl.enable(_gl.DEPTH_TEST);\r\n    _gl.depthFunc(_gl.LEQUAL);\r\n\r\n    _gl.frontFace(_gl.CCW);\r\n    _gl.cullFace(_gl.BACK);\r\n    _gl.enable(_gl.CULL_FACE);\r\n\r\n    _gl.enable(_gl.BLEND);\r\n    _gl.blendEquation(_gl.FUNC_ADD);\r\n    _gl.blendFunc(_gl.SRC_ALPHA, _gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  var resetGLState = function() {\r\n\r\n    _currentProgram = null;\r\n    _currentCamera = null;\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n\r\n    _lightsNeedUpdate = true;\r\n\r\n    state.reset();\r\n\r\n  };\r\n\r\n  setDefaultGLState();\r\n\r\n  this.context = _gl;\r\n  this.state = state;\r\n\r\n  // GPU capabilities\r\n\r\n  var _maxTextures = _gl.getParameter(_gl.MAX_TEXTURE_IMAGE_UNITS);\r\n  var _maxVertexTextures = _gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n  var _maxTextureSize = _gl.getParameter(_gl.MAX_TEXTURE_SIZE);\r\n  var _maxCubemapSize = _gl.getParameter(_gl.MAX_CUBE_MAP_TEXTURE_SIZE);\r\n\r\n  var _supportsVertexTextures = _maxVertexTextures > 0;\r\n  var _supportsBoneTextures = _supportsVertexTextures && extensions.get('OES_texture_float');\r\n\r\n  //\r\n\r\n  var _vertexShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.HIGH_FLOAT);\r\n  var _vertexShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var _fragmentShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.HIGH_FLOAT);\r\n  var _fragmentShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var getCompressedTextureFormats = (function() {\r\n\r\n    var array;\r\n\r\n    return function() {\r\n\r\n      if (array !== undefined) {\r\n\r\n        return array;\r\n\r\n      }\r\n\r\n      array = [];\r\n\r\n      if (extensions.get('WEBGL_compressed_texture_pvrtc') || extensions.get('WEBGL_compressed_texture_s3tc')) {\r\n\r\n        var formats = _gl.getParameter(_gl.COMPRESSED_TEXTURE_FORMATS);\r\n\r\n        for (var i = 0; i < formats.length; i++) {\r\n\r\n          array.push(formats[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  })();\r\n\r\n  // clamp precision to maximum available\r\n\r\n  var highpAvailable = _vertexShaderPrecisionHighpFloat.precision > 0 && _fragmentShaderPrecisionHighpFloat.precision > 0;\r\n  var mediumpAvailable = _vertexShaderPrecisionMediumpFloat.precision > 0 && _fragmentShaderPrecisionMediumpFloat.precision > 0;\r\n\r\n  if (_precision === 'highp' && !highpAvailable) {\r\n\r\n    if (mediumpAvailable) {\r\n\r\n      _precision = 'mediump';\r\n      THREE.warn('THREE.WebGLRenderer: highp not supported, using mediump.');\r\n\r\n    }\r\n    else {\r\n\r\n      _precision = 'lowp';\r\n      THREE.warn('THREE.WebGLRenderer: highp and mediump not supported, using lowp.');\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if (_precision === 'mediump' && !mediumpAvailable) {\r\n\r\n    _precision = 'lowp';\r\n    THREE.warn('THREE.WebGLRenderer: mediump not supported, using lowp.');\r\n\r\n  }\r\n\r\n  // Plugins\r\n\r\n  var shadowMapPlugin = new THREE.ShadowMapPlugin(this, lights, _webglObjects, _webglObjectsImmediate);\r\n\r\n  var spritePlugin = new THREE.SpritePlugin(this, sprites);\r\n  var lensFlarePlugin = new THREE.LensFlarePlugin(this, lensFlares);\r\n\r\n  // API\r\n\r\n  this.getContext = function() {\r\n\r\n    return _gl;\r\n\r\n  };\r\n\r\n  this.forceContextLoss = function() {\r\n\r\n    extensions.get('WEBGL_lose_context').loseContext();\r\n\r\n  };\r\n\r\n  this.supportsVertexTextures = function() {\r\n\r\n    return _supportsVertexTextures;\r\n\r\n  };\r\n\r\n  this.supportsFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_float');\r\n\r\n  };\r\n\r\n  this.supportsHalfFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_half_float');\r\n\r\n  };\r\n\r\n  this.supportsStandardDerivatives = function() {\r\n\r\n    return extensions.get('OES_standard_derivatives');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTextureS3TC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTexturePVRTC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n  };\r\n\r\n  this.supportsBlendMinMax = function() {\r\n\r\n    return extensions.get('EXT_blend_minmax');\r\n\r\n  };\r\n\r\n  this.getMaxAnisotropy = (function() {\r\n\r\n    var value;\r\n\r\n    return function() {\r\n\r\n      if (value !== undefined) {\r\n\r\n        return value;\r\n\r\n      }\r\n\r\n      var extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n      value = extension !== null ? _gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\r\n\r\n      return value;\r\n\r\n    }\r\n\r\n  })();\r\n\r\n  this.getPrecision = function() {\r\n\r\n    return _precision;\r\n\r\n  };\r\n\r\n  this.getPixelRatio = function() {\r\n\r\n    return pixelRatio;\r\n\r\n  };\r\n\r\n  this.setPixelRatio = function(value) {\r\n\r\n    pixelRatio = value;\r\n\r\n  };\r\n\r\n  this.setSize = function(width, height, updateStyle) {\r\n\r\n    _canvas.width = width * pixelRatio;\r\n    _canvas.height = height * pixelRatio;\r\n\r\n    if (updateStyle !== false) {\r\n\r\n      _canvas.style.width = width + 'px';\r\n      _canvas.style.height = height + 'px';\r\n\r\n    }\r\n\r\n    this.setViewport(0, 0, width, height);\r\n\r\n  };\r\n\r\n  this.setViewport = function(x, y, width, height) {\r\n\r\n    _viewportX = x * pixelRatio;\r\n    _viewportY = y * pixelRatio;\r\n\r\n    _viewportWidth = width * pixelRatio;\r\n    _viewportHeight = height * pixelRatio;\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n  };\r\n\r\n  this.setScissor = function(x, y, width, height) {\r\n\r\n    _gl.scissor(\r\n      x * pixelRatio,\r\n      y * pixelRatio,\r\n      width * pixelRatio,\r\n      height * pixelRatio\r\n    );\r\n\r\n  };\r\n\r\n  this.enableScissorTest = function(enable) {\r\n\r\n    enable ? _gl.enable(_gl.SCISSOR_TEST) : _gl.disable(_gl.SCISSOR_TEST);\r\n\r\n  };\r\n\r\n  // Clearing\r\n\r\n  this.getClearColor = function() {\r\n\r\n    return _clearColor;\r\n\r\n  };\r\n\r\n  this.setClearColor = function(color, alpha) {\r\n\r\n    _clearColor.set(color);\r\n\r\n    _clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.getClearAlpha = function() {\r\n\r\n    return _clearAlpha;\r\n\r\n  };\r\n\r\n  this.setClearAlpha = function(alpha) {\r\n\r\n    _clearAlpha = alpha;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.clear = function(color, depth, stencil) {\r\n\r\n    var bits = 0;\r\n\r\n    if (color === undefined || color) bits |= _gl.COLOR_BUFFER_BIT;\r\n    if (depth === undefined || depth) bits |= _gl.DEPTH_BUFFER_BIT;\r\n    if (stencil === undefined || stencil) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n    _gl.clear(bits);\r\n\r\n  };\r\n\r\n  this.clearColor = function() {\r\n\r\n    _gl.clear(_gl.COLOR_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearDepth = function() {\r\n\r\n    _gl.clear(_gl.DEPTH_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearStencil = function() {\r\n\r\n    _gl.clear(_gl.STENCIL_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearTarget = function(renderTarget, color, depth, stencil) {\r\n\r\n    this.setRenderTarget(renderTarget);\r\n    this.clear(color, depth, stencil);\r\n\r\n  };\r\n\r\n  // Reset\r\n\r\n  this.resetGLState = resetGLState;\r\n\r\n  // Buffer allocation\r\n\r\n  function createParticleBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createLineBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n    geometry.__webglLineDistanceBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createMeshBuffers(geometryGroup) {\r\n\r\n    geometryGroup.__webglVertexBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglNormalBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglTangentBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglColorBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUVBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUV2Buffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglSkinIndicesBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglSkinWeightsBuffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglFaceBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglLineBuffer = _gl.createBuffer();\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__webglMorphTargetsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphTargetsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__webglMorphNormalsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphNormalsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  // Events\r\n\r\n  var onObjectRemoved = function(event) {\r\n\r\n    var object = event.target;\r\n\r\n    object.traverse(function(child) {\r\n\r\n      child.removeEventListener('remove', onObjectRemoved);\r\n\r\n      removeObject(child);\r\n\r\n    });\r\n\r\n  };\r\n\r\n  var onGeometryDispose = function(event) {\r\n\r\n    var geometry = event.target;\r\n\r\n    geometry.removeEventListener('dispose', onGeometryDispose);\r\n\r\n    deallocateGeometry(geometry);\r\n\r\n  };\r\n\r\n  var onTextureDispose = function(event) {\r\n\r\n    var texture = event.target;\r\n\r\n    texture.removeEventListener('dispose', onTextureDispose);\r\n\r\n    deallocateTexture(texture);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n\r\n  };\r\n\r\n  var onRenderTargetDispose = function(event) {\r\n\r\n    var renderTarget = event.target;\r\n\r\n    renderTarget.removeEventListener('dispose', onRenderTargetDispose);\r\n\r\n    deallocateRenderTarget(renderTarget);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n  };\r\n\r\n  var onMaterialDispose = function(event) {\r\n\r\n    var material = event.target;\r\n\r\n    material.removeEventListener('dispose', onMaterialDispose);\r\n\r\n    deallocateMaterial(material);\r\n\r\n  };\r\n\r\n  // Buffer deallocation\r\n\r\n  var deleteBuffers = function(geometry) {\r\n\r\n    var buffers = [\r\n      '__webglVertexBuffer',\r\n      '__webglNormalBuffer',\r\n      '__webglTangentBuffer',\r\n      '__webglColorBuffer',\r\n      '__webglUVBuffer',\r\n      '__webglUV2Buffer',\r\n\r\n      '__webglSkinIndicesBuffer',\r\n      '__webglSkinWeightsBuffer',\r\n\r\n      '__webglFaceBuffer',\r\n      '__webglLineBuffer',\r\n\r\n      '__webglLineDistanceBuffer'\r\n    ];\r\n\r\n    for (var i = 0, l = buffers.length; i < l; i++) {\r\n\r\n      var name = buffers[i];\r\n\r\n      if (geometry[name] !== undefined) {\r\n\r\n        _gl.deleteBuffer(geometry[name]);\r\n\r\n        delete geometry[name];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // custom attributes\r\n\r\n    if (geometry.__webglCustomAttributesList !== undefined) {\r\n\r\n      for (var name in geometry.__webglCustomAttributesList) {\r\n\r\n        _gl.deleteBuffer(geometry.__webglCustomAttributesList[name].buffer);\r\n\r\n      }\r\n\r\n      delete geometry.__webglCustomAttributesList;\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries--;\r\n\r\n  };\r\n\r\n  var deallocateGeometry = function(geometry) {\r\n\r\n    delete geometry.__webglInit;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      for (var name in geometry.attributes) {\r\n\r\n        var attribute = geometry.attributes[name];\r\n\r\n        if (attribute.buffer !== undefined) {\r\n\r\n          _gl.deleteBuffer(attribute.buffer);\r\n\r\n          delete attribute.buffer;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _this.info.memory.geometries--;\r\n\r\n    }\r\n    else {\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      if (geometryGroupsList !== undefined) {\r\n\r\n        for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n          var geometryGroup = geometryGroupsList[i];\r\n\r\n          if (geometryGroup.numMorphTargets !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphTargets; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphTargetsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphTargetsBuffers;\r\n\r\n          }\r\n\r\n          if (geometryGroup.numMorphNormals !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphNormals; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphNormalsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphNormalsBuffers;\r\n\r\n          }\r\n\r\n          deleteBuffers(geometryGroup);\r\n\r\n        }\r\n\r\n        delete geometryGroups[geometry.id];\r\n\r\n      }\r\n      else {\r\n\r\n        deleteBuffers(geometry);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // TOFIX: Workaround for deleted geometry being currently bound\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n  };\r\n\r\n  var deallocateTexture = function(texture) {\r\n\r\n    if (texture.image && texture.image.__webglTextureCube) {\r\n\r\n      // cube texture\r\n\r\n      _gl.deleteTexture(texture.image.__webglTextureCube);\r\n\r\n      delete texture.image.__webglTextureCube;\r\n\r\n    }\r\n    else {\r\n\r\n      // 2D texture\r\n\r\n      if (texture.__webglInit === undefined) return;\r\n\r\n      _gl.deleteTexture(texture.__webglTexture);\r\n\r\n      delete texture.__webglTexture;\r\n      delete texture.__webglInit;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  var deallocateRenderTarget = function(renderTarget) {\r\n\r\n    if (!renderTarget || renderTarget.__webglTexture === undefined) return;\r\n\r\n    _gl.deleteTexture(renderTarget.__webglTexture);\r\n\r\n    delete renderTarget.__webglTexture;\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        _gl.deleteFramebuffer(renderTarget.__webglFramebuffer[i]);\r\n        _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer[i]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.deleteFramebuffer(renderTarget.__webglFramebuffer);\r\n      _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer);\r\n\r\n    }\r\n\r\n    delete renderTarget.__webglFramebuffer;\r\n    delete renderTarget.__webglRenderbuffer;\r\n\r\n  };\r\n\r\n  var deallocateMaterial = function(material) {\r\n\r\n    var program = material.program.program;\r\n\r\n    if (program === undefined) return;\r\n\r\n    material.program = undefined;\r\n\r\n    // only deallocate GL program if this was the last use of shared program\r\n    // assumed there is only single copy of any program in the _programs list\r\n    // (that's how it's constructed)\r\n\r\n    var i, il, programInfo;\r\n    var deleteProgram = false;\r\n\r\n    for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n      programInfo = _programs[i];\r\n\r\n      if (programInfo.program === program) {\r\n\r\n        programInfo.usedTimes--;\r\n\r\n        if (programInfo.usedTimes === 0) {\r\n\r\n          deleteProgram = true;\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (deleteProgram === true) {\r\n\r\n      // avoid using array.splice, this is costlier than creating new array from scratch\r\n\r\n      var newPrograms = [];\r\n\r\n      for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n        programInfo = _programs[i];\r\n\r\n        if (programInfo.program !== program) {\r\n\r\n          newPrograms.push(programInfo);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _programs = newPrograms;\r\n\r\n      _gl.deleteProgram(program);\r\n\r\n      _this.info.memory.programs--;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer initialization\r\n\r\n  function initCustomAttributes(object) {\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometry.__webglCustomAttributesList === undefined) {\r\n\r\n        geometry.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        var attribute = material.attributes[name];\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          attribute.needsUpdate = true;\r\n\r\n        }\r\n\r\n        geometry.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function initParticleBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n\r\n    geometry.__webglParticleCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initLineBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n    geometry.__lineDistanceArray = new Float32Array(nvertices * 1);\r\n\r\n    geometry.__webglLineCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initMeshBuffers(geometryGroup, object) {\r\n\r\n    var geometry = object.geometry,\r\n      faces3 = geometryGroup.faces3,\r\n\r\n      nvertices = faces3.length * 3,\r\n      ntris = faces3.length * 1,\r\n      nlines = faces3.length * 3,\r\n\r\n      material = getBufferMaterial(object, geometryGroup);\r\n\r\n    geometryGroup.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__normalArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__colorArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__uvArray = new Float32Array(nvertices * 2);\r\n\r\n    if (geometry.faceVertexUvs.length > 1) {\r\n\r\n      geometryGroup.__uv2Array = new Float32Array(nvertices * 2);\r\n\r\n    }\r\n\r\n    if (geometry.hasTangents) {\r\n\r\n      geometryGroup.__tangentArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    if (object.geometry.skinWeights.length && object.geometry.skinIndices.length) {\r\n\r\n      geometryGroup.__skinIndexArray = new Float32Array(nvertices * 4);\r\n      geometryGroup.__skinWeightArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    var UintArray = extensions.get('OES_element_index_uint') !== null && ntris > 21845 ? Uint32Array : Uint16Array; // 65535 / 3\r\n\r\n    geometryGroup.__typeArray = UintArray;\r\n    geometryGroup.__faceArray = new UintArray(ntris * 3);\r\n    geometryGroup.__lineArray = new UintArray(nlines * 2);\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__morphTargetsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__morphTargetsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__morphNormalsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__morphNormalsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__webglFaceCount = ntris * 3;\r\n    geometryGroup.__webglLineCount = nlines * 2;\r\n\r\n\r\n    // custom attributes\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometryGroup.__webglCustomAttributesList === undefined) {\r\n\r\n        geometryGroup.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        // Do a shallow copy of the attribute object so different geometryGroup chunks use different\r\n        // attribute buffers which are correctly indexed in the setMeshBuffers function\r\n\r\n        var originalAttribute = material.attributes[name];\r\n\r\n        var attribute = {};\r\n\r\n        for (var property in originalAttribute) {\r\n\r\n          attribute[property] = originalAttribute[property];\r\n\r\n        }\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          originalAttribute.needsUpdate = true;\r\n          attribute.__original = originalAttribute;\r\n\r\n        }\r\n\r\n        geometryGroup.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__inittedArrays = true;\r\n\r\n  };\r\n\r\n  function getBufferMaterial(object, geometryGroup) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[geometryGroup.materialIndex] : object.material;\r\n\r\n  }\r\n\r\n  function materialNeedsFaceNormals(material) {\r\n\r\n    return material instanceof THREE.MeshPhongMaterial === false && material.shading === THREE.FlatShading;\r\n\r\n  }\r\n\r\n  // Buffer setting\r\n\r\n  function setParticleBuffers(geometry, hint, object) {\r\n\r\n    var v, c, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      vl = vertices.length,\r\n\r\n      colors = geometry.colors,\r\n      cl = colors.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          offset = 0;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n        customAttribute.needsUpdate = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setLineBuffers(geometry, hint) {\r\n\r\n    var v, c, d, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      colors = geometry.colors,\r\n      lineDistances = geometry.lineDistances,\r\n\r\n      vl = vertices.length,\r\n      cl = colors.length,\r\n      dl = lineDistances.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n      lineDistanceArray = geometry.__lineDistanceArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyLineDistances = geometry.lineDistancesNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyLineDistances) {\r\n\r\n      for (d = 0; d < dl; d++) {\r\n\r\n        lineDistanceArray[d] = lineDistances[d];\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglLineDistanceBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, lineDistanceArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          offset = 0;\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n          customAttribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMeshBuffers(geometryGroup, object, hint, dispose, material) {\r\n\r\n    if (!geometryGroup.__inittedArrays) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    var needsFaceNormals = materialNeedsFaceNormals(material);\r\n\r\n    var f, fl, fi, face,\r\n      vertexNormals, faceNormal,\r\n      vertexColors, faceColor,\r\n      vertexTangents,\r\n      uv, uv2, v1, v2, v3, t1, t2, t3, n1, n2, n3,\r\n      c1, c2, c3,\r\n      sw1, sw2, sw3,\r\n      si1, si2, si3,\r\n      i, il,\r\n      vn, uvi, uv2i,\r\n      vk, vkl, vka,\r\n      nka, chf, faceVertexNormals,\r\n\r\n      vertexIndex = 0,\r\n\r\n      offset = 0,\r\n      offset_uv = 0,\r\n      offset_uv2 = 0,\r\n      offset_face = 0,\r\n      offset_normal = 0,\r\n      offset_tangent = 0,\r\n      offset_line = 0,\r\n      offset_color = 0,\r\n      offset_skin = 0,\r\n      offset_morphTarget = 0,\r\n      offset_custom = 0,\r\n\r\n      value,\r\n\r\n      vertexArray = geometryGroup.__vertexArray,\r\n      uvArray = geometryGroup.__uvArray,\r\n      uv2Array = geometryGroup.__uv2Array,\r\n      normalArray = geometryGroup.__normalArray,\r\n      tangentArray = geometryGroup.__tangentArray,\r\n      colorArray = geometryGroup.__colorArray,\r\n\r\n      skinIndexArray = geometryGroup.__skinIndexArray,\r\n      skinWeightArray = geometryGroup.__skinWeightArray,\r\n\r\n      morphTargetsArrays = geometryGroup.__morphTargetsArrays,\r\n      morphNormalsArrays = geometryGroup.__morphNormalsArrays,\r\n\r\n      customAttributes = geometryGroup.__webglCustomAttributesList,\r\n      customAttribute,\r\n\r\n      faceArray = geometryGroup.__faceArray,\r\n      lineArray = geometryGroup.__lineArray,\r\n\r\n      geometry = object.geometry, // this is shared for all chunks\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyElements = geometry.elementsNeedUpdate,\r\n      dirtyUvs = geometry.uvsNeedUpdate,\r\n      dirtyNormals = geometry.normalsNeedUpdate,\r\n      dirtyTangents = geometry.tangentsNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyMorphTargets = geometry.morphTargetsNeedUpdate,\r\n\r\n      vertices = geometry.vertices,\r\n      chunk_faces3 = geometryGroup.faces3,\r\n      obj_faces = geometry.faces,\r\n\r\n      obj_uvs = geometry.faceVertexUvs[0],\r\n      obj_uvs2 = geometry.faceVertexUvs[1],\r\n\r\n      obj_skinIndices = geometry.skinIndices,\r\n      obj_skinWeights = geometry.skinWeights,\r\n\r\n      morphTargets = geometry.morphTargets,\r\n      morphNormals = geometry.morphNormals;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        v1 = vertices[face.a];\r\n        v2 = vertices[face.b];\r\n        v3 = vertices[face.c];\r\n\r\n        vertexArray[offset] = v1.x;\r\n        vertexArray[offset + 1] = v1.y;\r\n        vertexArray[offset + 2] = v1.z;\r\n\r\n        vertexArray[offset + 3] = v2.x;\r\n        vertexArray[offset + 4] = v2.y;\r\n        vertexArray[offset + 5] = v2.z;\r\n\r\n        vertexArray[offset + 6] = v3.x;\r\n        vertexArray[offset + 7] = v3.y;\r\n        vertexArray[offset + 8] = v3.z;\r\n\r\n        offset += 9;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyMorphTargets) {\r\n\r\n      for (vk = 0, vkl = morphTargets.length; vk < vkl; vk++) {\r\n\r\n        offset_morphTarget = 0;\r\n\r\n        for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n          chf = chunk_faces3[f];\r\n          face = obj_faces[chf];\r\n\r\n          // morph positions\r\n\r\n          v1 = morphTargets[vk].vertices[face.a];\r\n          v2 = morphTargets[vk].vertices[face.b];\r\n          v3 = morphTargets[vk].vertices[face.c];\r\n\r\n          vka = morphTargetsArrays[vk];\r\n\r\n          vka[offset_morphTarget] = v1.x;\r\n          vka[offset_morphTarget + 1] = v1.y;\r\n          vka[offset_morphTarget + 2] = v1.z;\r\n\r\n          vka[offset_morphTarget + 3] = v2.x;\r\n          vka[offset_morphTarget + 4] = v2.y;\r\n          vka[offset_morphTarget + 5] = v2.z;\r\n\r\n          vka[offset_morphTarget + 6] = v3.x;\r\n          vka[offset_morphTarget + 7] = v3.y;\r\n          vka[offset_morphTarget + 8] = v3.z;\r\n\r\n          // morph normals\r\n\r\n          if (material.morphNormals) {\r\n\r\n            if (needsFaceNormals) {\r\n\r\n              n1 = morphNormals[vk].faceNormals[chf];\r\n              n2 = n1;\r\n              n3 = n1;\r\n\r\n            }\r\n            else {\r\n\r\n              faceVertexNormals = morphNormals[vk].vertexNormals[chf];\r\n\r\n              n1 = faceVertexNormals.a;\r\n              n2 = faceVertexNormals.b;\r\n              n3 = faceVertexNormals.c;\r\n\r\n            }\r\n\r\n            nka = morphNormalsArrays[vk];\r\n\r\n            nka[offset_morphTarget] = n1.x;\r\n            nka[offset_morphTarget + 1] = n1.y;\r\n            nka[offset_morphTarget + 2] = n1.z;\r\n\r\n            nka[offset_morphTarget + 3] = n2.x;\r\n            nka[offset_morphTarget + 4] = n2.y;\r\n            nka[offset_morphTarget + 5] = n2.z;\r\n\r\n            nka[offset_morphTarget + 6] = n3.x;\r\n            nka[offset_morphTarget + 7] = n3.y;\r\n            nka[offset_morphTarget + 8] = n3.z;\r\n\r\n          }\r\n\r\n          //\r\n\r\n          offset_morphTarget += 9;\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[vk]);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, morphTargetsArrays[vk], hint);\r\n\r\n        if (material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[vk]);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, morphNormalsArrays[vk], hint);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (obj_skinWeights.length) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        // weights\r\n\r\n        sw1 = obj_skinWeights[face.a];\r\n        sw2 = obj_skinWeights[face.b];\r\n        sw3 = obj_skinWeights[face.c];\r\n\r\n        skinWeightArray[offset_skin] = sw1.x;\r\n        skinWeightArray[offset_skin + 1] = sw1.y;\r\n        skinWeightArray[offset_skin + 2] = sw1.z;\r\n        skinWeightArray[offset_skin + 3] = sw1.w;\r\n\r\n        skinWeightArray[offset_skin + 4] = sw2.x;\r\n        skinWeightArray[offset_skin + 5] = sw2.y;\r\n        skinWeightArray[offset_skin + 6] = sw2.z;\r\n        skinWeightArray[offset_skin + 7] = sw2.w;\r\n\r\n        skinWeightArray[offset_skin + 8] = sw3.x;\r\n        skinWeightArray[offset_skin + 9] = sw3.y;\r\n        skinWeightArray[offset_skin + 10] = sw3.z;\r\n        skinWeightArray[offset_skin + 11] = sw3.w;\r\n\r\n        // indices\r\n\r\n        si1 = obj_skinIndices[face.a];\r\n        si2 = obj_skinIndices[face.b];\r\n        si3 = obj_skinIndices[face.c];\r\n\r\n        skinIndexArray[offset_skin] = si1.x;\r\n        skinIndexArray[offset_skin + 1] = si1.y;\r\n        skinIndexArray[offset_skin + 2] = si1.z;\r\n        skinIndexArray[offset_skin + 3] = si1.w;\r\n\r\n        skinIndexArray[offset_skin + 4] = si2.x;\r\n        skinIndexArray[offset_skin + 5] = si2.y;\r\n        skinIndexArray[offset_skin + 6] = si2.z;\r\n        skinIndexArray[offset_skin + 7] = si2.w;\r\n\r\n        skinIndexArray[offset_skin + 8] = si3.x;\r\n        skinIndexArray[offset_skin + 9] = si3.y;\r\n        skinIndexArray[offset_skin + 10] = si3.z;\r\n        skinIndexArray[offset_skin + 11] = si3.w;\r\n\r\n        offset_skin += 12;\r\n\r\n      }\r\n\r\n      if (offset_skin > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinIndexArray, hint);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinWeightArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexColors = face.vertexColors;\r\n        faceColor = face.color;\r\n\r\n        if (vertexColors.length === 3 && material.vertexColors === THREE.VertexColors) {\r\n\r\n          c1 = vertexColors[0];\r\n          c2 = vertexColors[1];\r\n          c3 = vertexColors[2];\r\n\r\n        }\r\n        else {\r\n\r\n          c1 = faceColor;\r\n          c2 = faceColor;\r\n          c3 = faceColor;\r\n\r\n        }\r\n\r\n        colorArray[offset_color] = c1.r;\r\n        colorArray[offset_color + 1] = c1.g;\r\n        colorArray[offset_color + 2] = c1.b;\r\n\r\n        colorArray[offset_color + 3] = c2.r;\r\n        colorArray[offset_color + 4] = c2.g;\r\n        colorArray[offset_color + 5] = c2.b;\r\n\r\n        colorArray[offset_color + 6] = c3.r;\r\n        colorArray[offset_color + 7] = c3.g;\r\n        colorArray[offset_color + 8] = c3.b;\r\n\r\n        offset_color += 9;\r\n\r\n      }\r\n\r\n      if (offset_color > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyTangents && geometry.hasTangents) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexTangents = face.vertexTangents;\r\n\r\n        t1 = vertexTangents[0];\r\n        t2 = vertexTangents[1];\r\n        t3 = vertexTangents[2];\r\n\r\n        tangentArray[offset_tangent] = t1.x;\r\n        tangentArray[offset_tangent + 1] = t1.y;\r\n        tangentArray[offset_tangent + 2] = t1.z;\r\n        tangentArray[offset_tangent + 3] = t1.w;\r\n\r\n        tangentArray[offset_tangent + 4] = t2.x;\r\n        tangentArray[offset_tangent + 5] = t2.y;\r\n        tangentArray[offset_tangent + 6] = t2.z;\r\n        tangentArray[offset_tangent + 7] = t2.w;\r\n\r\n        tangentArray[offset_tangent + 8] = t3.x;\r\n        tangentArray[offset_tangent + 9] = t3.y;\r\n        tangentArray[offset_tangent + 10] = t3.z;\r\n        tangentArray[offset_tangent + 11] = t3.w;\r\n\r\n        offset_tangent += 12;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, tangentArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyNormals) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexNormals = face.vertexNormals;\r\n        faceNormal = face.normal;\r\n\r\n        if (vertexNormals.length === 3 && needsFaceNormals === false) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            vn = vertexNormals[i];\r\n\r\n            normalArray[offset_normal] = vn.x;\r\n            normalArray[offset_normal + 1] = vn.y;\r\n            normalArray[offset_normal + 2] = vn.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalArray[offset_normal] = faceNormal.x;\r\n            normalArray[offset_normal + 1] = faceNormal.y;\r\n            normalArray[offset_normal + 2] = faceNormal.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, normalArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv = obj_uvs[fi];\r\n\r\n        if (uv === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uvi = uv[i];\r\n\r\n          uvArray[offset_uv] = uvi.x;\r\n          uvArray[offset_uv + 1] = uvi.y;\r\n\r\n          offset_uv += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uvArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs2) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv2 = obj_uvs2[fi];\r\n\r\n        if (uv2 === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uv2i = uv2[i];\r\n\r\n          uv2Array[offset_uv2] = uv2i.x;\r\n          uv2Array[offset_uv2 + 1] = uv2i.y;\r\n\r\n          offset_uv2 += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv2 > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uv2Array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyElements) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        faceArray[offset_face] = vertexIndex;\r\n        faceArray[offset_face + 1] = vertexIndex + 1;\r\n        faceArray[offset_face + 2] = vertexIndex + 2;\r\n\r\n        offset_face += 3;\r\n\r\n        lineArray[offset_line] = vertexIndex;\r\n        lineArray[offset_line + 1] = vertexIndex + 1;\r\n\r\n        lineArray[offset_line + 2] = vertexIndex;\r\n        lineArray[offset_line + 3] = vertexIndex + 2;\r\n\r\n        lineArray[offset_line + 4] = vertexIndex + 1;\r\n        lineArray[offset_line + 5] = vertexIndex + 2;\r\n\r\n        offset_line += 6;\r\n\r\n        vertexIndex += 3;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, faceArray, hint);\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, lineArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (!customAttribute.__original.needsUpdate) continue;\r\n\r\n        offset_custom = 0;\r\n\r\n        if (customAttribute.size === 1) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = customAttribute.value[face.a];\r\n              customAttribute.array[offset_custom + 1] = customAttribute.value[face.b];\r\n              customAttribute.array[offset_custom + 2] = customAttribute.value[face.c];\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = value;\r\n              customAttribute.array[offset_custom + 1] = value;\r\n              customAttribute.array[offset_custom + 2] = value;\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 2) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 3) {\r\n\r\n          var pp;\r\n\r\n          if (customAttribute.type === 'c') {\r\n\r\n            pp = ['r', 'g', 'b'];\r\n\r\n          }\r\n          else {\r\n\r\n            pp = ['x', 'y', 'z'];\r\n\r\n          }\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 4) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dispose) {\r\n\r\n      delete geometryGroup.__inittedArrays;\r\n      delete geometryGroup.__colorArray;\r\n      delete geometryGroup.__normalArray;\r\n      delete geometryGroup.__tangentArray;\r\n      delete geometryGroup.__uvArray;\r\n      delete geometryGroup.__uv2Array;\r\n      delete geometryGroup.__faceArray;\r\n      delete geometryGroup.__vertexArray;\r\n      delete geometryGroup.__lineArray;\r\n      delete geometryGroup.__skinIndexArray;\r\n      delete geometryGroup.__skinWeightArray;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer rendering\r\n\r\n  this.renderBufferImmediate = function(object, program, material) {\r\n\r\n    state.initAttributes();\r\n\r\n    if (object.hasPositions && !object.__webglVertexBuffer) object.__webglVertexBuffer = _gl.createBuffer();\r\n    if (object.hasNormals && !object.__webglNormalBuffer) object.__webglNormalBuffer = _gl.createBuffer();\r\n    if (object.hasUvs && !object.__webglUvBuffer) object.__webglUvBuffer = _gl.createBuffer();\r\n    if (object.hasColors && !object.__webglColorBuffer) object.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    if (object.hasPositions) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.position);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasNormals) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglNormalBuffer);\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial === false &&\r\n        material.shading === THREE.FlatShading) {\r\n\r\n        var nx, ny, nz,\r\n          nax, nbx, ncx, nay, nby, ncy, naz, nbz, ncz,\r\n          normalArray,\r\n          i, il = object.count * 3;\r\n\r\n        for (i = 0; i < il; i += 9) {\r\n\r\n          normalArray = object.normalArray;\r\n\r\n          nax = normalArray[i];\r\n          nay = normalArray[i + 1];\r\n          naz = normalArray[i + 2];\r\n\r\n          nbx = normalArray[i + 3];\r\n          nby = normalArray[i + 4];\r\n          nbz = normalArray[i + 5];\r\n\r\n          ncx = normalArray[i + 6];\r\n          ncy = normalArray[i + 7];\r\n          ncz = normalArray[i + 8];\r\n\r\n          nx = (nax + nbx + ncx) / 3;\r\n          ny = (nay + nby + ncy) / 3;\r\n          nz = (naz + nbz + ncz) / 3;\r\n\r\n          normalArray[i] = nx;\r\n          normalArray[i + 1] = ny;\r\n          normalArray[i + 2] = nz;\r\n\r\n          normalArray[i + 3] = nx;\r\n          normalArray[i + 4] = ny;\r\n          normalArray[i + 5] = nz;\r\n\r\n          normalArray[i + 6] = nx;\r\n          normalArray[i + 7] = ny;\r\n          normalArray[i + 8] = nz;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.normal);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasUvs && material.map) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglUvBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.uv);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasColors && material.vertexColors !== THREE.NoColors) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.color);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    _gl.drawArrays(_gl.TRIANGLES, 0, object.count);\r\n\r\n    object.count = 0;\r\n\r\n  };\r\n\r\n  function setupVertexAttributes(material, program, geometry, startIndex) {\r\n\r\n    var geometryAttributes = geometry.attributes;\r\n\r\n    var programAttributes = program.attributes;\r\n    var programAttributesKeys = program.attributesKeys;\r\n\r\n    for (var i = 0, l = programAttributesKeys.length; i < l; i++) {\r\n\r\n      var key = programAttributesKeys[i];\r\n      var programAttribute = programAttributes[key];\r\n\r\n      if (programAttribute >= 0) {\r\n\r\n        var geometryAttribute = geometryAttributes[key];\r\n\r\n        if (geometryAttribute !== undefined) {\r\n\r\n          var size = geometryAttribute.itemSize;\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryAttribute.buffer);\r\n\r\n          state.enableAttribute(programAttribute);\r\n\r\n          _gl.vertexAttribPointer(programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4); // 4 bytes per Float32\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n          if (material.defaultAttributeValues[key].length === 2) {\r\n\r\n            _gl.vertexAttrib2fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n          else if (material.defaultAttributeValues[key].length === 3) {\r\n\r\n            _gl.vertexAttrib3fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n  }\r\n\r\n  this.renderBufferDirect = function(camera, lights, fog, material, geometry, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = 'direct_' + geometry.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var mode = material.wireframe === true ? _gl.LINES : _gl.TRIANGLES;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed triangles\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n          _this.info.render.faces += index.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed triangles\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n            _this.info.render.faces += offsets[i].count / 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed triangles\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes['position'];\r\n\r\n        // render non-indexed triangles\r\n\r\n        _gl.drawArrays(mode, 0, position.array.length / position.itemSize);\r\n\r\n        _this.info.render.calls++;\r\n        _this.info.render.vertices += position.array.length / position.itemSize;\r\n        _this.info.render.faces += position.array.length / (3 * position.itemSize);\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      // render particles\r\n\r\n      var mode = _gl.POINTS;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed points\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += index.array.length;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed points\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed points\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed lines\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0); // 2 bytes per Uint16Array\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed lines\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size); // 2 bytes per Uint16Array\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed lines\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.renderBuffer = function(camera, lights, fog, material, geometryGroup, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var attributes = program.attributes;\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = geometryGroup.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    if (!material.morphTargets && attributes.position >= 0) {\r\n\r\n      if (updateBuffers) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n        state.enableAttribute(attributes.position);\r\n\r\n        _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      if (object.morphTargetBase) {\r\n\r\n        setupMorphTargets(material, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n    if (updateBuffers) {\r\n\r\n      // custom attributes\r\n\r\n      // Use the per-geometryGroup custom attribute arrays which are setup in initMeshBuffers\r\n\r\n      if (geometryGroup.__webglCustomAttributesList) {\r\n\r\n        for (var i = 0, il = geometryGroup.__webglCustomAttributesList.length; i < il; i++) {\r\n\r\n          var attribute = geometryGroup.__webglCustomAttributesList[i];\r\n\r\n          if (attributes[attribute.buffer.belongsToAttribute] >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, attribute.buffer);\r\n\r\n            state.enableAttribute(attributes[attribute.buffer.belongsToAttribute]);\r\n\r\n            _gl.vertexAttribPointer(attributes[attribute.buffer.belongsToAttribute], attribute.size, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // colors\r\n\r\n      if (attributes.color >= 0) {\r\n\r\n        if (object.geometry.colors.length > 0 || object.geometry.faces.length > 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n\r\n          state.enableAttribute(attributes.color);\r\n\r\n          _gl.vertexAttribPointer(attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib3fv(attributes.color, material.defaultAttributeValues.color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // normals\r\n\r\n      if (attributes.normal >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n\r\n        state.enableAttribute(attributes.normal);\r\n\r\n        _gl.vertexAttribPointer(attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // tangents\r\n\r\n      if (attributes.tangent >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n\r\n        state.enableAttribute(attributes.tangent);\r\n\r\n        _gl.vertexAttribPointer(attributes.tangent, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // uvs\r\n\r\n      if (attributes.uv >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[0]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n\r\n          state.enableAttribute(attributes.uv);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv, material.defaultAttributeValues.uv);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (attributes.uv2 >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[1]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n\r\n          state.enableAttribute(attributes.uv2);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv2, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv2, material.defaultAttributeValues.uv2);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material.skinning &&\r\n        attributes.skinIndex >= 0 && attributes.skinWeight >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n\r\n        state.enableAttribute(attributes.skinIndex);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinIndex, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n\r\n        state.enableAttribute(attributes.skinWeight);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinWeight, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // line distances\r\n\r\n      if (attributes.lineDistance >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglLineDistanceBuffer);\r\n\r\n        state.enableAttribute(attributes.lineDistance);\r\n\r\n        _gl.vertexAttribPointer(attributes.lineDistance, 1, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var type = geometryGroup.__typeArray === Uint32Array ? _gl.UNSIGNED_INT : _gl.UNSIGNED_SHORT;\r\n\r\n      // wireframe\r\n\r\n      if (material.wireframe) {\r\n\r\n        state.setLineWidth(material.wireframeLinewidth * pixelRatio);\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n        _gl.drawElements(_gl.LINES, geometryGroup.__webglLineCount, type, 0);\r\n\r\n        // triangles\r\n\r\n      }\r\n      else {\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n        _gl.drawElements(_gl.TRIANGLES, geometryGroup.__webglFaceCount, type, 0);\r\n\r\n      }\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.vertices += geometryGroup.__webglFaceCount;\r\n      _this.info.render.faces += geometryGroup.__webglFaceCount / 3;\r\n\r\n      // render lines\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      _gl.drawArrays(mode, 0, geometryGroup.__webglLineCount);\r\n\r\n      _this.info.render.calls++;\r\n\r\n      // render particles\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      _gl.drawArrays(_gl.POINTS, 0, geometryGroup.__webglParticleCount);\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.points += geometryGroup.__webglParticleCount;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function setupMorphTargets(material, geometryGroup, object) {\r\n\r\n    // set base\r\n\r\n    var attributes = material.program.attributes;\r\n\r\n    if (object.morphTargetBase !== -1 && attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[object.morphTargetBase]);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n    else if (attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.morphTargetForcedOrder.length) {\r\n\r\n      // set forced order\r\n\r\n      var m = 0;\r\n      var order = object.morphTargetForcedOrder;\r\n      var influences = object.morphTargetInfluences;\r\n\r\n      var attribute;\r\n\r\n      while (m < material.numSupportedMorphTargets && m < order.length) {\r\n\r\n        attribute = attributes['morphTarget' + m];\r\n\r\n        if (attribute >= 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        attribute = attributes['morphNormal' + m];\r\n\r\n        if (attribute >= 0 && material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        object.__webglMorphTargetInfluences[m] = influences[order[m]];\r\n\r\n        m++;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // find the most influencing\r\n\r\n      var activeInfluenceIndices = [];\r\n      var influences = object.morphTargetInfluences;\r\n      var morphTargets = object.geometry.morphTargets;\r\n\r\n      if (influences.length > morphTargets.length) {\r\n\r\n        console.warn('THREE.WebGLRenderer: Influences array is bigger than morphTargets array.');\r\n        influences.length = morphTargets.length;\r\n\r\n      }\r\n\r\n      for (var i = 0, il = influences.length; i < il; i++) {\r\n\r\n        var influence = influences[i];\r\n\r\n        activeInfluenceIndices.push([influence, i]);\r\n\r\n      }\r\n\r\n      if (activeInfluenceIndices.length > material.numSupportedMorphTargets) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n        activeInfluenceIndices.length = material.numSupportedMorphTargets;\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length > material.numSupportedMorphNormals) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length === 0) {\r\n\r\n        activeInfluenceIndices.push([0, 0]);\r\n\r\n      }\r\n\r\n      var attribute;\r\n\r\n      for (var m = 0, ml = material.numSupportedMorphTargets; m < ml; m++) {\r\n\r\n        if (activeInfluenceIndices[m]) {\r\n\r\n          var influenceIndex = activeInfluenceIndices[m][1];\r\n\r\n          attribute = attributes['morphTarget' + m];\r\n\r\n          if (attribute >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          attribute = attributes['morphNormal' + m];\r\n\r\n          if (attribute >= 0 && material.morphNormals) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          object.__webglMorphTargetInfluences[m] = influences[influenceIndex];\r\n\r\n        }\r\n        else {\r\n\r\n          /*\r\n          _gl.vertexAttribPointer( attributes[ \"morphTarget\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          if ( material.morphNormals ) {\r\n\r\n          \t_gl.vertexAttribPointer( attributes[ \"morphNormal\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          }\r\n          */\r\n\r\n          object.__webglMorphTargetInfluences[m] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // load updated influences uniform\r\n\r\n    if (material.program.uniforms.morphTargetInfluences !== null) {\r\n\r\n      _gl.uniform1fv(material.program.uniforms.morphTargetInfluences, object.__webglMorphTargetInfluences);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Sorting\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    else if (a.material.id !== b.material.id) {\r\n\r\n      return a.material.id - b.material.id;\r\n\r\n    }\r\n    else if (a.z !== b.z) {\r\n\r\n      return a.z - b.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function reversePainterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function numericalSort(a, b) {\r\n\r\n    return b[0] - a[0];\r\n\r\n  }\r\n\r\n  // Rendering\r\n\r\n  this.render = function(scene, camera, renderTarget, forceClear) {\r\n\r\n    if (camera instanceof THREE.Camera === false) {\r\n\r\n      THREE.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');\r\n      return;\r\n\r\n    }\r\n\r\n    var fog = scene.fog;\r\n\r\n    // reset caching for this frame\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n    _currentCamera = null;\r\n    _lightsNeedUpdate = true;\r\n\r\n    // update scene graph\r\n\r\n    if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n    // update camera matrices and frustum\r\n\r\n    if (camera.parent === undefined) camera.updateMatrixWorld();\r\n\r\n    // update Skeleton objects\r\n\r\n    scene.traverse(function(object) {\r\n\r\n      if (object instanceof THREE.SkinnedMesh) {\r\n\r\n        object.skeleton.update();\r\n\r\n      }\r\n\r\n    });\r\n\r\n    camera.matrixWorldInverse.getInverse(camera.matrixWorld);\r\n\r\n    _projScreenMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\r\n    _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n    lights.length = 0;\r\n    opaqueObjects.length = 0;\r\n    transparentObjects.length = 0;\r\n\r\n    sprites.length = 0;\r\n    lensFlares.length = 0;\r\n\r\n    projectObject(scene);\r\n\r\n    if (_this.sortObjects === true) {\r\n\r\n      opaqueObjects.sort(painterSortStable);\r\n      transparentObjects.sort(reversePainterSortStable);\r\n\r\n    }\r\n\r\n    // custom render plugins (pre pass)\r\n\r\n    shadowMapPlugin.render(scene, camera);\r\n\r\n    //\r\n\r\n    _this.info.render.calls = 0;\r\n    _this.info.render.vertices = 0;\r\n    _this.info.render.faces = 0;\r\n    _this.info.render.points = 0;\r\n\r\n    this.setRenderTarget(renderTarget);\r\n\r\n    if (this.autoClear || forceClear) {\r\n\r\n      this.clear(this.autoClearColor, this.autoClearDepth, this.autoClearStencil);\r\n\r\n    }\r\n\r\n    // set matrices for immediate objects\r\n\r\n    for (var i = 0, il = _webglObjectsImmediate.length; i < il; i++) {\r\n\r\n      var webglObject = _webglObjectsImmediate[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        setupMatrices(object, camera);\r\n\r\n        unrollImmediateBufferMaterial(webglObject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (scene.overrideMaterial) {\r\n\r\n      var overrideMaterial = scene.overrideMaterial;\r\n\r\n      setMaterial(overrideMaterial);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjects(transparentObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjectsImmediate(_webglObjectsImmediate, '', camera, lights, fog, overrideMaterial);\r\n\r\n    }\r\n    else {\r\n\r\n      // opaque pass (front-to-back order)\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'opaque', camera, lights, fog, null);\r\n\r\n      // transparent pass (back-to-front order)\r\n\r\n      renderObjects(transparentObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'transparent', camera, lights, fog, null);\r\n\r\n    }\r\n\r\n    // custom render plugins (post pass)\r\n\r\n    spritePlugin.render(scene, camera);\r\n    lensFlarePlugin.render(scene, camera, _currentWidth, _currentHeight);\r\n\r\n    // Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n    if (renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter) {\r\n\r\n      updateRenderTargetMipmap(renderTarget);\r\n\r\n    }\r\n\r\n    // Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n    state.setDepthTest(true);\r\n    state.setDepthWrite(true);\r\n    state.setColorWrite(true);\r\n\r\n    // _gl.finish();\r\n\r\n  };\r\n\r\n  function projectObject(object) {\r\n\r\n    if (object.visible === false) return;\r\n\r\n    if (object instanceof THREE.Scene || object instanceof THREE.Group) {\r\n\r\n      // skip\r\n\r\n    }\r\n    else {\r\n\r\n      initObject(object);\r\n\r\n      if (object instanceof THREE.Light) {\r\n\r\n        lights.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        sprites.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.LensFlare) {\r\n\r\n        lensFlares.push(object);\r\n\r\n      }\r\n      else {\r\n\r\n        var webglObjects = _webglObjects[object.id];\r\n\r\n        if (webglObjects && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n          for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n            var webglObject = webglObjects[i];\r\n\r\n            unrollBufferMaterial(webglObject);\r\n\r\n            webglObject.render = true;\r\n\r\n            if (_this.sortObjects === true) {\r\n\r\n              _vector3.setFromMatrixPosition(object.matrixWorld);\r\n              _vector3.applyProjection(_projScreenMatrix);\r\n\r\n              webglObject.z = _vector3.z;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n      projectObject(object.children[i]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjects(renderList, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n\r\n      var object = webglObject.object;\r\n      var buffer = webglObject.buffer;\r\n\r\n      setupMatrices(object, camera);\r\n\r\n      if (overrideMaterial) {\r\n\r\n        material = overrideMaterial;\r\n\r\n      }\r\n      else {\r\n\r\n        material = webglObject.material;\r\n\r\n        if (!material) continue;\r\n\r\n        setMaterial(material);\r\n\r\n      }\r\n\r\n      _this.setMaterialFaces(material);\r\n\r\n      if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n        _this.renderBufferDirect(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n      else {\r\n\r\n        _this.renderBuffer(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjectsImmediate(renderList, materialType, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        if (overrideMaterial) {\r\n\r\n          material = overrideMaterial;\r\n\r\n        }\r\n        else {\r\n\r\n          material = webglObject[materialType];\r\n\r\n          if (!material) continue;\r\n\r\n          setMaterial(material);\r\n\r\n        }\r\n\r\n        _this.renderImmediateObject(camera, lights, fog, material, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.renderImmediateObject = function(camera, lights, fog, material, object) {\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n    _this.setMaterialFaces(material);\r\n\r\n    if (object.immediateRenderCallback) {\r\n\r\n      object.immediateRenderCallback(program, _gl, _frustum);\r\n\r\n    }\r\n    else {\r\n\r\n      object.render(function(object) {\r\n        _this.renderBufferImmediate(object, program, material);\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function unrollImmediateBufferMaterial(globject) {\r\n\r\n    var object = globject.object,\r\n      material = object.material;\r\n\r\n    if (material.transparent) {\r\n\r\n      globject.transparent = material;\r\n      globject.opaque = null;\r\n\r\n    }\r\n    else {\r\n\r\n      globject.opaque = material;\r\n      globject.transparent = null;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function unrollBufferMaterial(globject) {\r\n\r\n    var object = globject.object;\r\n    var buffer = globject.buffer;\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    if (material instanceof THREE.MeshFaceMaterial) {\r\n\r\n      var materialIndex = geometry instanceof THREE.BufferGeometry ? 0 : buffer.materialIndex;\r\n\r\n      material = material.materials[materialIndex];\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n    else if (material) {\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function initObject(object) {\r\n\r\n    if (object.__webglInit === undefined) {\r\n\r\n      object.__webglInit = true;\r\n      object._modelViewMatrix = new THREE.Matrix4();\r\n      object._normalMatrix = new THREE.Matrix3();\r\n\r\n      object.addEventListener('removed', onObjectRemoved);\r\n\r\n    }\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry === undefined) {\r\n\r\n      // ImmediateRenderObject\r\n\r\n    }\r\n    else if (geometry.__webglInit === undefined) {\r\n\r\n      geometry.__webglInit = true;\r\n      geometry.addEventListener('dispose', onGeometryDispose);\r\n\r\n      if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n        _this.info.memory.geometries++;\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n      else if (object instanceof THREE.Line) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createLineBuffers(geometry);\r\n          initLineBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n          geometry.lineDistancesNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.PointCloud) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createParticleBuffers(geometry);\r\n          initParticleBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (object.__webglActive === undefined) {\r\n\r\n      object.__webglActive = true;\r\n\r\n      if (object instanceof THREE.Mesh) {\r\n\r\n        if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n          addBuffer(_webglObjects, geometry, object);\r\n\r\n        }\r\n        else if (geometry instanceof THREE.Geometry) {\r\n\r\n          var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n          for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n            addBuffer(_webglObjects, geometryGroupsList[i], object);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        addBuffer(_webglObjects, geometry, object);\r\n\r\n      }\r\n      else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n        addBufferImmediate(_webglObjectsImmediate, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Geometry splitting\r\n\r\n  var geometryGroups = {};\r\n  var geometryGroupCounter = 0;\r\n\r\n  function makeGroups(geometry, usesFaceMaterial) {\r\n\r\n    var maxVerticesInGroup = extensions.get('OES_element_index_uint') ? 4294967296 : 65535;\r\n\r\n    var groupHash, hash_map = {};\r\n\r\n    var numMorphTargets = geometry.morphTargets.length;\r\n    var numMorphNormals = geometry.morphNormals.length;\r\n\r\n    var group;\r\n    var groups = {};\r\n    var groupsList = [];\r\n\r\n    for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n      var face = geometry.faces[f];\r\n      var materialIndex = usesFaceMaterial ? face.materialIndex : 0;\r\n\r\n      if (!(materialIndex in hash_map)) {\r\n\r\n        hash_map[materialIndex] = {\r\n          hash: materialIndex,\r\n          counter: 0\r\n        };\r\n\r\n      }\r\n\r\n      groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n      if (!(groupHash in groups)) {\r\n\r\n        group = {\r\n          id: geometryGroupCounter++,\r\n          faces3: [],\r\n          materialIndex: materialIndex,\r\n          vertices: 0,\r\n          numMorphTargets: numMorphTargets,\r\n          numMorphNormals: numMorphNormals\r\n        };\r\n\r\n        groups[groupHash] = group;\r\n        groupsList.push(group);\r\n\r\n      }\r\n\r\n      if (groups[groupHash].vertices + 3 > maxVerticesInGroup) {\r\n\r\n        hash_map[materialIndex].counter += 1;\r\n        groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n        if (!(groupHash in groups)) {\r\n\r\n          group = {\r\n            id: geometryGroupCounter++,\r\n            faces3: [],\r\n            materialIndex: materialIndex,\r\n            vertices: 0,\r\n            numMorphTargets: numMorphTargets,\r\n            numMorphNormals: numMorphNormals\r\n          };\r\n\r\n          groups[groupHash] = group;\r\n          groupsList.push(group);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      groups[groupHash].faces3.push(f);\r\n      groups[groupHash].vertices += 3;\r\n\r\n    }\r\n\r\n    return groupsList;\r\n\r\n  }\r\n\r\n  function initGeometryGroups(object, geometry) {\r\n\r\n    var material = object.material,\r\n      addBuffers = false;\r\n\r\n    if (geometryGroups[geometry.id] === undefined || geometry.groupsNeedUpdate === true) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n      geometryGroups[geometry.id] = makeGroups(geometry, material instanceof THREE.MeshFaceMaterial);\r\n\r\n      geometry.groupsNeedUpdate = false;\r\n\r\n    }\r\n\r\n    var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n    // create separate VBOs per geometry chunk\r\n\r\n    for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n      var geometryGroup = geometryGroupsList[i];\r\n\r\n      // initialise VBO on the first access\r\n\r\n      if (geometryGroup.__webglVertexBuffer === undefined) {\r\n\r\n        createMeshBuffers(geometryGroup);\r\n        initMeshBuffers(geometryGroup, object);\r\n\r\n        geometry.verticesNeedUpdate = true;\r\n        geometry.morphTargetsNeedUpdate = true;\r\n        geometry.elementsNeedUpdate = true;\r\n        geometry.uvsNeedUpdate = true;\r\n        geometry.normalsNeedUpdate = true;\r\n        geometry.tangentsNeedUpdate = true;\r\n        geometry.colorsNeedUpdate = true;\r\n\r\n        addBuffers = true;\r\n\r\n      }\r\n      else {\r\n\r\n        addBuffers = false;\r\n\r\n      }\r\n\r\n      if (addBuffers || object.__webglActive === undefined) {\r\n\r\n        addBuffer(_webglObjects, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    object.__webglActive = true;\r\n\r\n  }\r\n\r\n  function addBuffer(objlist, buffer, object) {\r\n\r\n    var id = object.id;\r\n    objlist[id] = objlist[id] || [];\r\n    objlist[id].push({\r\n      id: id,\r\n      buffer: buffer,\r\n      object: object,\r\n      material: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  function addBufferImmediate(objlist, object) {\r\n\r\n    objlist.push({\r\n      id: null,\r\n      object: object,\r\n      opaque: null,\r\n      transparent: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  // Objects updates\r\n\r\n  function updateObject(object) {\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var attributesKeys = geometry.attributesKeys;\r\n\r\n      for (var i = 0, l = attributesKeys.length; i < l; i++) {\r\n\r\n        var key = attributesKeys[i];\r\n        var attribute = attributes[key];\r\n        var bufferType = (key === 'index') ? _gl.ELEMENT_ARRAY_BUFFER : _gl.ARRAY_BUFFER;\r\n\r\n        if (attribute.buffer === undefined) {\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n          _gl.bufferData(bufferType, attribute.array, (attribute instanceof THREE.DynamicBufferAttribute) ? _gl.DYNAMIC_DRAW : _gl.STATIC_DRAW);\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n        else if (attribute.needsUpdate === true) {\r\n\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n\r\n          if (attribute.updateRange === undefined || attribute.updateRange.count === -1) { // Not using update ranges\r\n\r\n            _gl.bufferSubData(bufferType, 0, attribute.array);\r\n\r\n          }\r\n          else if (attribute.updateRange.count === 0) {\r\n\r\n            console.error('THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually.');\r\n\r\n          }\r\n          else {\r\n\r\n            _gl.bufferSubData(bufferType, attribute.updateRange.offset * attribute.array.BYTES_PER_ELEMENT,\r\n              attribute.array.subarray(attribute.updateRange.offset, attribute.updateRange.offset + attribute.updateRange.count));\r\n\r\n            attribute.updateRange.count = 0; // reset range\r\n\r\n          }\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Mesh) {\r\n\r\n      // check all geometry groups\r\n\r\n      if (geometry.groupsNeedUpdate === true) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n        var geometryGroup = geometryGroupsList[i];\r\n        var material = getBufferMaterial(object, geometryGroup);\r\n\r\n        var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n        if (geometry.verticesNeedUpdate || geometry.morphTargetsNeedUpdate || geometry.elementsNeedUpdate ||\r\n          geometry.uvsNeedUpdate || geometry.normalsNeedUpdate ||\r\n          geometry.colorsNeedUpdate || geometry.tangentsNeedUpdate || customAttributesDirty) {\r\n\r\n          setMeshBuffers(geometryGroup, object, _gl.DYNAMIC_DRAW, !geometry.dynamic, material);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.morphTargetsNeedUpdate = false;\r\n      geometry.elementsNeedUpdate = false;\r\n      geometry.uvsNeedUpdate = false;\r\n      geometry.normalsNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.tangentsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || geometry.lineDistancesNeedUpdate || customAttributesDirty) {\r\n\r\n        setLineBuffers(geometry, _gl.DYNAMIC_DRAW);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.lineDistancesNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || customAttributesDirty) {\r\n\r\n        setParticleBuffers(geometry, _gl.DYNAMIC_DRAW, object);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects updates - custom attributes check\r\n\r\n  function areCustomAttributesDirty(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      if (material.attributes[name].needsUpdate) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  function clearCustomAttributes(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      material.attributes[name].needsUpdate = false;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects removal\r\n\r\n  function removeObject(object) {\r\n\r\n    if (object instanceof THREE.Mesh ||\r\n      object instanceof THREE.PointCloud ||\r\n      object instanceof THREE.Line) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n    }\r\n    else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n      removeInstances(_webglObjectsImmediate, object);\r\n\r\n    }\r\n\r\n    delete object.__webglInit;\r\n    delete object._modelViewMatrix;\r\n    delete object._normalMatrix;\r\n\r\n    delete object.__webglActive;\r\n\r\n  }\r\n\r\n  function removeInstances(objlist, object) {\r\n\r\n    for (var o = objlist.length - 1; o >= 0; o--) {\r\n\r\n      if (objlist[o].object === object) {\r\n\r\n        objlist.splice(o, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Materials\r\n\r\n  var shaderIDs = {\r\n    MeshDepthMaterial: 'depth',\r\n    MeshNormalMaterial: 'normal',\r\n    MeshBasicMaterial: 'basic',\r\n    MeshLambertMaterial: 'lambert',\r\n    MeshPhongMaterial: 'phong',\r\n    LineBasicMaterial: 'basic',\r\n    LineDashedMaterial: 'dashed',\r\n    PointCloudMaterial: 'particle_basic'\r\n  };\r\n\r\n  function initMaterial(material, lights, fog, object) {\r\n\r\n    material.addEventListener('dispose', onMaterialDispose);\r\n\r\n    var shaderID = shaderIDs[material.type];\r\n\r\n    if (shaderID) {\r\n\r\n      var shader = THREE.ShaderLib[shaderID];\r\n\r\n      material.__webglShader = {\r\n        uniforms: THREE.UniformsUtils.clone(shader.uniforms),\r\n        vertexShader: shader.vertexShader,\r\n        fragmentShader: shader.fragmentShader\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      material.__webglShader = {\r\n        uniforms: material.uniforms,\r\n        vertexShader: material.vertexShader,\r\n        fragmentShader: material.fragmentShader\r\n      }\r\n\r\n    }\r\n\r\n    // heuristics to create shader parameters according to lights in the scene\r\n    // (not to blow over maxLights budget)\r\n\r\n    var maxLightCount = allocateLights(lights);\r\n    var maxShadows = allocateShadows(lights);\r\n    var maxBones = allocateBones(object);\r\n\r\n    var parameters = {\r\n\r\n      precision: _precision,\r\n      supportsVertexTextures: _supportsVertexTextures,\r\n\r\n      map: !!material.map,\r\n      envMap: !!material.envMap,\r\n      envMapMode: material.envMap && material.envMap.mapping,\r\n      lightMap: !!material.lightMap,\r\n      bumpMap: !!material.bumpMap,\r\n      normalMap: !!material.normalMap,\r\n      specularMap: !!material.specularMap,\r\n      alphaMap: !!material.alphaMap,\r\n\r\n      combine: material.combine,\r\n\r\n      vertexColors: material.vertexColors,\r\n\r\n      fog: fog,\r\n      useFog: material.fog,\r\n      fogExp: fog instanceof THREE.FogExp2,\r\n\r\n      flatShading: material.shading === THREE.FlatShading,\r\n\r\n      sizeAttenuation: material.sizeAttenuation,\r\n      logarithmicDepthBuffer: _logarithmicDepthBuffer,\r\n\r\n      skinning: material.skinning,\r\n      maxBones: maxBones,\r\n      useVertexTexture: _supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n      morphTargets: material.morphTargets,\r\n      morphNormals: material.morphNormals,\r\n      maxMorphTargets: _this.maxMorphTargets,\r\n      maxMorphNormals: _this.maxMorphNormals,\r\n\r\n      maxDirLights: maxLightCount.directional,\r\n      maxPointLights: maxLightCount.point,\r\n      maxSpotLights: maxLightCount.spot,\r\n      maxHemiLights: maxLightCount.hemi,\r\n\r\n      maxShadows: maxShadows,\r\n      shadowMapEnabled: _this.shadowMapEnabled && object.receiveShadow && maxShadows > 0,\r\n      shadowMapType: _this.shadowMapType,\r\n      shadowMapDebug: _this.shadowMapDebug,\r\n      shadowMapCascade: _this.shadowMapCascade,\r\n\r\n      alphaTest: material.alphaTest,\r\n      metal: material.metal,\r\n      wrapAround: material.wrapAround,\r\n      doubleSided: material.side === THREE.DoubleSide,\r\n      flipSided: material.side === THREE.BackSide\r\n\r\n    };\r\n\r\n    // Generate code\r\n\r\n    var chunks = [];\r\n\r\n    if (shaderID) {\r\n\r\n      chunks.push(shaderID);\r\n\r\n    }\r\n    else {\r\n\r\n      chunks.push(material.fragmentShader);\r\n      chunks.push(material.vertexShader);\r\n\r\n    }\r\n\r\n    if (material.defines !== undefined) {\r\n\r\n      for (var name in material.defines) {\r\n\r\n        chunks.push(name);\r\n        chunks.push(material.defines[name]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var name in parameters) {\r\n\r\n      chunks.push(name);\r\n      chunks.push(parameters[name]);\r\n\r\n    }\r\n\r\n    var code = chunks.join();\r\n\r\n    var program;\r\n\r\n    // Check if code has been already compiled\r\n\r\n    for (var p = 0, pl = _programs.length; p < pl; p++) {\r\n\r\n      var programInfo = _programs[p];\r\n\r\n      if (programInfo.code === code) {\r\n\r\n        program = programInfo;\r\n        program.usedTimes++;\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (program === undefined) {\r\n\r\n      program = new THREE.WebGLProgram(_this, code, material, parameters);\r\n      _programs.push(program);\r\n\r\n      _this.info.memory.programs = _programs.length;\r\n\r\n    }\r\n\r\n    material.program = program;\r\n\r\n    var attributes = program.attributes;\r\n\r\n    if (material.morphTargets) {\r\n\r\n      material.numSupportedMorphTargets = 0;\r\n\r\n      var id, base = 'morphTarget';\r\n\r\n      for (var i = 0; i < _this.maxMorphTargets; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphTargets++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (material.morphNormals) {\r\n\r\n      material.numSupportedMorphNormals = 0;\r\n\r\n      var id, base = 'morphNormal';\r\n\r\n      for (i = 0; i < _this.maxMorphNormals; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphNormals++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    material.uniformsList = [];\r\n\r\n    for (var u in material.__webglShader.uniforms) {\r\n\r\n      var location = material.program.uniforms[u];\r\n\r\n      if (location) {\r\n        material.uniformsList.push([material.__webglShader.uniforms[u], location]);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMaterial(material) {\r\n\r\n    if (material.transparent === true) {\r\n\r\n      state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha);\r\n\r\n    }\r\n    else {\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n    }\r\n\r\n    state.setDepthTest(material.depthTest);\r\n    state.setDepthWrite(material.depthWrite);\r\n    state.setColorWrite(material.colorWrite);\r\n    state.setPolygonOffset(material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits);\r\n\r\n  }\r\n\r\n  function setProgram(camera, lights, fog, material, object) {\r\n\r\n    _usedTextureUnits = 0;\r\n\r\n    if (material.needsUpdate) {\r\n\r\n      if (material.program) deallocateMaterial(material);\r\n\r\n      initMaterial(material, lights, fog, object);\r\n      material.needsUpdate = false;\r\n\r\n    }\r\n\r\n    if (material.morphTargets) {\r\n\r\n      if (!object.__webglMorphTargetInfluences) {\r\n\r\n        object.__webglMorphTargetInfluences = new Float32Array(_this.maxMorphTargets);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var refreshProgram = false;\r\n    var refreshMaterial = false;\r\n    var refreshLights = false;\r\n\r\n    var program = material.program,\r\n      p_uniforms = program.uniforms,\r\n      m_uniforms = material.__webglShader.uniforms;\r\n\r\n    if (program.id !== _currentProgram) {\r\n\r\n      _gl.useProgram(program.program);\r\n      _currentProgram = program.id;\r\n\r\n      refreshProgram = true;\r\n      refreshMaterial = true;\r\n      refreshLights = true;\r\n\r\n    }\r\n\r\n    if (material.id !== _currentMaterialId) {\r\n\r\n      if (_currentMaterialId === -1) refreshLights = true;\r\n      _currentMaterialId = material.id;\r\n\r\n      refreshMaterial = true;\r\n\r\n    }\r\n\r\n    if (refreshProgram || camera !== _currentCamera) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n      if (_logarithmicDepthBuffer) {\r\n\r\n        _gl.uniform1f(p_uniforms.logDepthBufFC, 2.0 / (Math.log(camera.far + 1.0) / Math.LN2));\r\n\r\n      }\r\n\r\n\r\n      if (camera !== _currentCamera) _currentCamera = camera;\r\n\r\n      // load material specific uniforms\r\n      // (shader material also gets them for the sake of genericity)\r\n\r\n      if (material instanceof THREE.ShaderMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial ||\r\n        material.envMap) {\r\n\r\n        if (p_uniforms.cameraPosition !== null) {\r\n\r\n          _vector3.setFromMatrixPosition(camera.matrixWorld);\r\n          _gl.uniform3f(p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.ShaderMaterial ||\r\n        material.skinning) {\r\n\r\n        if (p_uniforms.viewMatrix !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // skinning uniforms must be set even if material didn't change\r\n    // auto-setting of texture unit for bone texture must go before other textures\r\n    // not sure why, but otherwise weird things happen\r\n\r\n    if (material.skinning) {\r\n\r\n      if (object.bindMatrix && p_uniforms.bindMatrix !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrix, false, object.bindMatrix.elements);\r\n\r\n      }\r\n\r\n      if (object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements);\r\n\r\n      }\r\n\r\n      if (_supportsBoneTextures && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n        if (p_uniforms.boneTexture !== null) {\r\n\r\n          var textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(p_uniforms.boneTexture, textureUnit);\r\n          _this.setTexture(object.skeleton.boneTexture, textureUnit);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureWidth !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureHeight !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight);\r\n\r\n        }\r\n\r\n      }\r\n      else if (object.skeleton && object.skeleton.boneMatrices) {\r\n\r\n        if (p_uniforms.boneGlobalMatrices !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (refreshMaterial) {\r\n\r\n      // refresh uniforms common to several materials\r\n\r\n      if (fog && material.fog) {\r\n\r\n        refreshUniformsFog(m_uniforms, fog);\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material.lights) {\r\n\r\n        if (_lightsNeedUpdate) {\r\n\r\n          refreshLights = true;\r\n          setupLights(lights);\r\n          _lightsNeedUpdate = false;\r\n        }\r\n\r\n        if (refreshLights) {\r\n          refreshUniformsLights(m_uniforms, _lights);\r\n          markUniformsLightsNeedsUpdate(m_uniforms, true);\r\n        }\r\n        else {\r\n          markUniformsLightsNeedsUpdate(m_uniforms, false);\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsCommon(m_uniforms, material);\r\n\r\n      }\r\n\r\n      // refresh single material specific uniforms\r\n\r\n      if (material instanceof THREE.LineBasicMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.LineDashedMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n        refreshUniformsDash(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.PointCloudMaterial) {\r\n\r\n        refreshUniformsParticle(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsPhong(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshLambertMaterial) {\r\n\r\n        refreshUniformsLambert(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshDepthMaterial) {\r\n\r\n        m_uniforms.mNear.value = camera.near;\r\n        m_uniforms.mFar.value = camera.far;\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshNormalMaterial) {\r\n\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n\r\n      if (object.receiveShadow && !material._shadowPass) {\r\n\r\n        refreshUniformsShadow(m_uniforms, lights);\r\n\r\n      }\r\n\r\n      // load common uniforms\r\n\r\n      loadUniformsGeneric(material.uniformsList);\r\n\r\n    }\r\n\r\n    loadUniformsMatrices(p_uniforms, object);\r\n\r\n    if (p_uniforms.modelMatrix !== null) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.modelMatrix, false, object.matrixWorld.elements);\r\n\r\n    }\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n  // Uniforms (refresh uniforms objects)\r\n\r\n  function refreshUniformsCommon(uniforms, material) {\r\n\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n    uniforms.diffuse.value = material.color;\r\n\r\n    uniforms.map.value = material.map;\r\n    uniforms.lightMap.value = material.lightMap;\r\n    uniforms.specularMap.value = material.specularMap;\r\n    uniforms.alphaMap.value = material.alphaMap;\r\n\r\n    if (material.bumpMap) {\r\n\r\n      uniforms.bumpMap.value = material.bumpMap;\r\n      uniforms.bumpScale.value = material.bumpScale;\r\n\r\n    }\r\n\r\n    if (material.normalMap) {\r\n\r\n      uniforms.normalMap.value = material.normalMap;\r\n      uniforms.normalScale.value.copy(material.normalScale);\r\n\r\n    }\r\n\r\n    // uv repeat and offset setting priorities\r\n    //  1. color map\r\n    //  2. specular map\r\n    //  3. normal map\r\n    //  4. bump map\r\n    //  5. alpha map\r\n\r\n    var uvScaleMap;\r\n\r\n    if (material.map) {\r\n\r\n      uvScaleMap = material.map;\r\n\r\n    }\r\n    else if (material.specularMap) {\r\n\r\n      uvScaleMap = material.specularMap;\r\n\r\n    }\r\n    else if (material.normalMap) {\r\n\r\n      uvScaleMap = material.normalMap;\r\n\r\n    }\r\n    else if (material.bumpMap) {\r\n\r\n      uvScaleMap = material.bumpMap;\r\n\r\n    }\r\n    else if (material.alphaMap) {\r\n\r\n      uvScaleMap = material.alphaMap;\r\n\r\n    }\r\n\r\n    if (uvScaleMap !== undefined) {\r\n\r\n      var offset = uvScaleMap.offset;\r\n      var repeat = uvScaleMap.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n    uniforms.envMap.value = material.envMap;\r\n    uniforms.flipEnvMap.value = (material.envMap instanceof THREE.WebGLRenderTargetCube) ? 1 : -1;\r\n\r\n    uniforms.reflectivity.value = material.reflectivity;\r\n    uniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n  }\r\n\r\n  function refreshUniformsLine(uniforms, material) {\r\n\r\n    uniforms.diffuse.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n  }\r\n\r\n  function refreshUniformsDash(uniforms, material) {\r\n\r\n    uniforms.dashSize.value = material.dashSize;\r\n    uniforms.totalSize.value = material.dashSize + material.gapSize;\r\n    uniforms.scale.value = material.scale;\r\n\r\n  }\r\n\r\n  function refreshUniformsParticle(uniforms, material) {\r\n\r\n    uniforms.psColor.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n    uniforms.size.value = material.size;\r\n    uniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\r\n    uniforms.map.value = material.map;\r\n\r\n    if (material.map !== null) {\r\n\r\n      var offset = material.map.offset;\r\n      var repeat = material.map.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsFog(uniforms, fog) {\r\n\r\n    uniforms.fogColor.value = fog.color;\r\n\r\n    if (fog instanceof THREE.Fog) {\r\n\r\n      uniforms.fogNear.value = fog.near;\r\n      uniforms.fogFar.value = fog.far;\r\n\r\n    }\r\n    else if (fog instanceof THREE.FogExp2) {\r\n\r\n      uniforms.fogDensity.value = fog.density;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsPhong(uniforms, material) {\r\n\r\n    uniforms.shininess.value = material.shininess;\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n    uniforms.specular.value = material.specular;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLambert(uniforms, material) {\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLights(uniforms, lights) {\r\n\r\n    uniforms.ambientLightColor.value = lights.ambient;\r\n\r\n    uniforms.directionalLightColor.value = lights.directional.colors;\r\n    uniforms.directionalLightDirection.value = lights.directional.positions;\r\n\r\n    uniforms.pointLightColor.value = lights.point.colors;\r\n    uniforms.pointLightPosition.value = lights.point.positions;\r\n    uniforms.pointLightDistance.value = lights.point.distances;\r\n    uniforms.pointLightDecay.value = lights.point.decays;\r\n\r\n    uniforms.spotLightColor.value = lights.spot.colors;\r\n    uniforms.spotLightPosition.value = lights.spot.positions;\r\n    uniforms.spotLightDistance.value = lights.spot.distances;\r\n    uniforms.spotLightDirection.value = lights.spot.directions;\r\n    uniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n    uniforms.spotLightExponent.value = lights.spot.exponents;\r\n    uniforms.spotLightDecay.value = lights.spot.decays;\r\n\r\n    uniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n    uniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n    uniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\r\n  }\r\n\r\n  // If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n  function markUniformsLightsNeedsUpdate(uniforms, value) {\r\n\r\n    uniforms.ambientLightColor.needsUpdate = value;\r\n\r\n    uniforms.directionalLightColor.needsUpdate = value;\r\n    uniforms.directionalLightDirection.needsUpdate = value;\r\n\r\n    uniforms.pointLightColor.needsUpdate = value;\r\n    uniforms.pointLightPosition.needsUpdate = value;\r\n    uniforms.pointLightDistance.needsUpdate = value;\r\n    uniforms.pointLightDecay.needsUpdate = value;\r\n\r\n    uniforms.spotLightColor.needsUpdate = value;\r\n    uniforms.spotLightPosition.needsUpdate = value;\r\n    uniforms.spotLightDistance.needsUpdate = value;\r\n    uniforms.spotLightDirection.needsUpdate = value;\r\n    uniforms.spotLightAngleCos.needsUpdate = value;\r\n    uniforms.spotLightExponent.needsUpdate = value;\r\n    uniforms.spotLightDecay.needsUpdate = value;\r\n\r\n    uniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n    uniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n    uniforms.hemisphereLightDirection.needsUpdate = value;\r\n\r\n  }\r\n\r\n  function refreshUniformsShadow(uniforms, lights) {\r\n\r\n    if (uniforms.shadowMatrix) {\r\n\r\n      var j = 0;\r\n\r\n      for (var i = 0, il = lights.length; i < il; i++) {\r\n\r\n        var light = lights[i];\r\n\r\n        if (!light.castShadow) continue;\r\n\r\n        if (light instanceof THREE.SpotLight || (light instanceof THREE.DirectionalLight && !light.shadowCascade)) {\r\n\r\n          uniforms.shadowMap.value[j] = light.shadowMap;\r\n          uniforms.shadowMapSize.value[j] = light.shadowMapSize;\r\n\r\n          uniforms.shadowMatrix.value[j] = light.shadowMatrix;\r\n\r\n          uniforms.shadowDarkness.value[j] = light.shadowDarkness;\r\n          uniforms.shadowBias.value[j] = light.shadowBias;\r\n\r\n          j++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Uniforms (load to GPU)\r\n\r\n  function loadUniformsMatrices(uniforms, object) {\r\n\r\n    _gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, object._modelViewMatrix.elements);\r\n\r\n    if (uniforms.normalMatrix) {\r\n\r\n      _gl.uniformMatrix3fv(uniforms.normalMatrix, false, object._normalMatrix.elements);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function getTextureUnit() {\r\n\r\n    var textureUnit = _usedTextureUnits;\r\n\r\n    if (textureUnit >= _maxTextures) {\r\n\r\n      THREE.warn('WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + _maxTextures);\r\n\r\n    }\r\n\r\n    _usedTextureUnits += 1;\r\n\r\n    return textureUnit;\r\n\r\n  }\r\n\r\n  function loadUniformsGeneric(uniforms) {\r\n\r\n    var texture, textureUnit, offset;\r\n\r\n    for (var j = 0, jl = uniforms.length; j < jl; j++) {\r\n\r\n      var uniform = uniforms[j][0];\r\n\r\n      // needsUpdate property is not added to all uniforms.\r\n      if (uniform.needsUpdate === false) continue;\r\n\r\n      var type = uniform.type;\r\n      var value = uniform.value;\r\n      var location = uniforms[j][1];\r\n\r\n      switch (type) {\r\n\r\n        case '1i':\r\n          _gl.uniform1i(location, value);\r\n          break;\r\n\r\n        case '1f':\r\n          _gl.uniform1f(location, value);\r\n          break;\r\n\r\n        case '2f':\r\n          _gl.uniform2f(location, value[0], value[1]);\r\n          break;\r\n\r\n        case '3f':\r\n          _gl.uniform3f(location, value[0], value[1], value[2]);\r\n          break;\r\n\r\n        case '4f':\r\n          _gl.uniform4f(location, value[0], value[1], value[2], value[3]);\r\n          break;\r\n\r\n        case '1iv':\r\n          _gl.uniform1iv(location, value);\r\n          break;\r\n\r\n        case '3iv':\r\n          _gl.uniform3iv(location, value);\r\n          break;\r\n\r\n        case '1fv':\r\n          _gl.uniform1fv(location, value);\r\n          break;\r\n\r\n        case '2fv':\r\n          _gl.uniform2fv(location, value);\r\n          break;\r\n\r\n        case '3fv':\r\n          _gl.uniform3fv(location, value);\r\n          break;\r\n\r\n        case '4fv':\r\n          _gl.uniform4fv(location, value);\r\n          break;\r\n\r\n        case 'Matrix3fv':\r\n          _gl.uniformMatrix3fv(location, false, value);\r\n          break;\r\n\r\n        case 'Matrix4fv':\r\n          _gl.uniformMatrix4fv(location, false, value);\r\n          break;\r\n\r\n          //\r\n\r\n        case 'i':\r\n\r\n          // single integer\r\n          _gl.uniform1i(location, value);\r\n\r\n          break;\r\n\r\n        case 'f':\r\n\r\n          // single float\r\n          _gl.uniform1f(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2':\r\n\r\n          // single THREE.Vector2\r\n          _gl.uniform2f(location, value.x, value.y);\r\n\r\n          break;\r\n\r\n        case 'v3':\r\n\r\n          // single THREE.Vector3\r\n          _gl.uniform3f(location, value.x, value.y, value.z);\r\n\r\n          break;\r\n\r\n        case 'v4':\r\n\r\n          // single THREE.Vector4\r\n          _gl.uniform4f(location, value.x, value.y, value.z, value.w);\r\n\r\n          break;\r\n\r\n        case 'c':\r\n\r\n          // single THREE.Color\r\n          _gl.uniform3f(location, value.r, value.g, value.b);\r\n\r\n          break;\r\n\r\n        case 'iv1':\r\n\r\n          // flat array of integers (JS or typed array)\r\n          _gl.uniform1iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'iv':\r\n\r\n          // flat array of integers with 3 x N size (JS or typed array)\r\n          _gl.uniform3iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv1':\r\n\r\n          // flat array of floats (JS or typed array)\r\n          _gl.uniform1fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv':\r\n\r\n          // flat array of floats with 3 x N size (JS or typed array)\r\n          _gl.uniform3fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2v':\r\n\r\n          // array of THREE.Vector2\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(2 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 2;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n\r\n          }\r\n\r\n          _gl.uniform2fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v3v':\r\n\r\n          // array of THREE.Vector3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(3 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 3;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n\r\n          }\r\n\r\n          _gl.uniform3fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v4v':\r\n\r\n          // array of THREE.Vector4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(4 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 4;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n            uniform._array[offset + 3] = value[i].w;\r\n\r\n          }\r\n\r\n          _gl.uniform4fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm3':\r\n\r\n          // single THREE.Matrix3\r\n          _gl.uniformMatrix3fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm3v':\r\n\r\n          // array of THREE.Matrix3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(9 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 9);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix3fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm4':\r\n\r\n          // single THREE.Matrix4\r\n          _gl.uniformMatrix4fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm4v':\r\n\r\n          // array of THREE.Matrix4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(16 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 16);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix4fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 't':\r\n\r\n          // single THREE.Texture (2d or cube)\r\n\r\n          texture = value;\r\n          textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(location, textureUnit);\r\n\r\n          if (!texture) continue;\r\n\r\n          if (texture instanceof THREE.CubeTexture ||\r\n            (texture.image instanceof Array && texture.image.length === 6)) { // CompressedTexture can have Array in image :/\r\n\r\n            setCubeTexture(texture, textureUnit);\r\n\r\n          }\r\n          else if (texture instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n            setCubeTextureDynamic(texture, textureUnit);\r\n\r\n          }\r\n          else {\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        case 'tv':\r\n\r\n          // array of THREE.Texture (2d)\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = [];\r\n\r\n          }\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            uniform._array[i] = getTextureUnit();\r\n\r\n          }\r\n\r\n          _gl.uniform1iv(location, uniform._array);\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            texture = uniform.value[i];\r\n            textureUnit = uniform._array[i];\r\n\r\n            if (!texture) continue;\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          THREE.warn('THREE.WebGLRenderer: Unknown uniform type: ' + type);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setupMatrices(object, camera) {\r\n\r\n    object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, object.matrixWorld);\r\n    object._normalMatrix.getNormalMatrix(object._modelViewMatrix);\r\n\r\n  }\r\n\r\n  function setColorLinear(array, offset, color, intensity) {\r\n\r\n    array[offset] = color.r * intensity;\r\n    array[offset + 1] = color.g * intensity;\r\n    array[offset + 2] = color.b * intensity;\r\n\r\n  }\r\n\r\n  function setupLights(lights) {\r\n\r\n    var l, ll, light,\r\n      r = 0,\r\n      g = 0,\r\n      b = 0,\r\n      color, skyColor, groundColor,\r\n      intensity,\r\n      distance,\r\n\r\n      zlights = _lights,\r\n\r\n      dirColors = zlights.directional.colors,\r\n      dirPositions = zlights.directional.positions,\r\n\r\n      pointColors = zlights.point.colors,\r\n      pointPositions = zlights.point.positions,\r\n      pointDistances = zlights.point.distances,\r\n      pointDecays = zlights.point.decays,\r\n\r\n      spotColors = zlights.spot.colors,\r\n      spotPositions = zlights.spot.positions,\r\n      spotDistances = zlights.spot.distances,\r\n      spotDirections = zlights.spot.directions,\r\n      spotAnglesCos = zlights.spot.anglesCos,\r\n      spotExponents = zlights.spot.exponents,\r\n      spotDecays = zlights.spot.decays,\r\n\r\n      hemiSkyColors = zlights.hemi.skyColors,\r\n      hemiGroundColors = zlights.hemi.groundColors,\r\n      hemiPositions = zlights.hemi.positions,\r\n\r\n      dirLength = 0,\r\n      pointLength = 0,\r\n      spotLength = 0,\r\n      hemiLength = 0,\r\n\r\n      dirCount = 0,\r\n      pointCount = 0,\r\n      spotCount = 0,\r\n      hemiCount = 0,\r\n\r\n      dirOffset = 0,\r\n      pointOffset = 0,\r\n      spotOffset = 0,\r\n      hemiOffset = 0;\r\n\r\n    for (l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      light = lights[l];\r\n\r\n      if (light.onlyShadow) continue;\r\n\r\n      color = light.color;\r\n      intensity = light.intensity;\r\n      distance = light.distance;\r\n\r\n      if (light instanceof THREE.AmbientLight) {\r\n\r\n        if (!light.visible) continue;\r\n\r\n        r += color.r;\r\n        g += color.g;\r\n        b += color.b;\r\n\r\n      }\r\n      else if (light instanceof THREE.DirectionalLight) {\r\n\r\n        dirCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        dirOffset = dirLength * 3;\r\n\r\n        dirPositions[dirOffset] = _direction.x;\r\n        dirPositions[dirOffset + 1] = _direction.y;\r\n        dirPositions[dirOffset + 2] = _direction.z;\r\n\r\n        setColorLinear(dirColors, dirOffset, color, intensity);\r\n\r\n        dirLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.PointLight) {\r\n\r\n        pointCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        pointOffset = pointLength * 3;\r\n\r\n        setColorLinear(pointColors, pointOffset, color, intensity);\r\n\r\n        _vector3.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        pointPositions[pointOffset] = _vector3.x;\r\n        pointPositions[pointOffset + 1] = _vector3.y;\r\n        pointPositions[pointOffset + 2] = _vector3.z;\r\n\r\n        // distance is 0 if decay is 0, because there is no attenuation at all.\r\n        pointDistances[pointLength] = distance;\r\n        pointDecays[pointLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        pointLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.SpotLight) {\r\n\r\n        spotCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        spotOffset = spotLength * 3;\r\n\r\n        setColorLinear(spotColors, spotOffset, color, intensity);\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        spotPositions[spotOffset] = _direction.x;\r\n        spotPositions[spotOffset + 1] = _direction.y;\r\n        spotPositions[spotOffset + 2] = _direction.z;\r\n\r\n        spotDistances[spotLength] = distance;\r\n\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        spotDirections[spotOffset] = _direction.x;\r\n        spotDirections[spotOffset + 1] = _direction.y;\r\n        spotDirections[spotOffset + 2] = _direction.z;\r\n\r\n        spotAnglesCos[spotLength] = Math.cos(light.angle);\r\n        spotExponents[spotLength] = light.exponent;\r\n        spotDecays[spotLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        spotLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.HemisphereLight) {\r\n\r\n        hemiCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _direction.normalize();\r\n\r\n        hemiOffset = hemiLength * 3;\r\n\r\n        hemiPositions[hemiOffset] = _direction.x;\r\n        hemiPositions[hemiOffset + 1] = _direction.y;\r\n        hemiPositions[hemiOffset + 2] = _direction.z;\r\n\r\n        skyColor = light.color;\r\n        groundColor = light.groundColor;\r\n\r\n        setColorLinear(hemiSkyColors, hemiOffset, skyColor, intensity);\r\n        setColorLinear(hemiGroundColors, hemiOffset, groundColor, intensity);\r\n\r\n        hemiLength += 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // null eventual remains from removed lights\r\n    // (this is to avoid if in shader)\r\n\r\n    for (l = dirLength * 3, ll = Math.max(dirColors.length, dirCount * 3); l < ll; l++) dirColors[l] = 0.0;\r\n    for (l = pointLength * 3, ll = Math.max(pointColors.length, pointCount * 3); l < ll; l++) pointColors[l] = 0.0;\r\n    for (l = spotLength * 3, ll = Math.max(spotColors.length, spotCount * 3); l < ll; l++) spotColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiSkyColors.length, hemiCount * 3); l < ll; l++) hemiSkyColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiGroundColors.length, hemiCount * 3); l < ll; l++) hemiGroundColors[l] = 0.0;\r\n\r\n    zlights.directional.length = dirLength;\r\n    zlights.point.length = pointLength;\r\n    zlights.spot.length = spotLength;\r\n    zlights.hemi.length = hemiLength;\r\n\r\n    zlights.ambient[0] = r;\r\n    zlights.ambient[1] = g;\r\n    zlights.ambient[2] = b;\r\n\r\n  }\r\n\r\n  // GL state setting\r\n\r\n  this.setFaceCulling = function(cullFace, frontFaceDirection) {\r\n\r\n    if (cullFace === THREE.CullFaceNone) {\r\n\r\n      _gl.disable(_gl.CULL_FACE);\r\n\r\n    }\r\n    else {\r\n\r\n      if (frontFaceDirection === THREE.FrontFaceDirectionCW) {\r\n\r\n        _gl.frontFace(_gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.frontFace(_gl.CCW);\r\n\r\n      }\r\n\r\n      if (cullFace === THREE.CullFaceBack) {\r\n\r\n        _gl.cullFace(_gl.BACK);\r\n\r\n      }\r\n      else if (cullFace === THREE.CullFaceFront) {\r\n\r\n        _gl.cullFace(_gl.FRONT);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.cullFace(_gl.FRONT_AND_BACK);\r\n\r\n      }\r\n\r\n      _gl.enable(_gl.CULL_FACE);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setMaterialFaces = function(material) {\r\n\r\n    state.setDoubleSided(material.side === THREE.DoubleSide);\r\n    state.setFlipSided(material.side === THREE.BackSide);\r\n\r\n  };\r\n\r\n  // Textures\r\n\r\n  function setTextureParameters(textureType, texture, isImagePowerOfTwo) {\r\n\r\n    var extension;\r\n\r\n    if (isImagePowerOfTwo) {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL(texture.wrapS));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL(texture.wrapT));\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL(texture.minFilter));\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);\r\n\r\n      if (texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, filterFallback(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, filterFallback(texture.minFilter));\r\n\r\n      if (texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n    if (extension && texture.type !== THREE.FloatType && texture.type !== THREE.HalfFloatType) {\r\n\r\n      if (texture.anisotropy > 1 || texture.__currentAnisotropy) {\r\n\r\n        _gl.texParameterf(textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(texture.anisotropy, _this.getMaxAnisotropy()));\r\n        texture.__currentAnisotropy = texture.anisotropy;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.uploadTexture = function(texture) {\r\n\r\n    if (texture.__webglInit === undefined) {\r\n\r\n      texture.__webglInit = true;\r\n\r\n      texture.addEventListener('dispose', onTextureDispose);\r\n\r\n      texture.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n    }\r\n\r\n    _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n    _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha);\r\n    _gl.pixelStorei(_gl.UNPACK_ALIGNMENT, texture.unpackAlignment);\r\n\r\n    texture.image = clampToMaxSize(texture.image, _maxTextureSize);\r\n\r\n    var image = texture.image,\r\n      isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n      glFormat = paramThreeToGL(texture.format),\r\n      glType = paramThreeToGL(texture.type);\r\n\r\n    setTextureParameters(_gl.TEXTURE_2D, texture, isImagePowerOfTwo);\r\n\r\n    var mipmap, mipmaps = texture.mipmaps;\r\n\r\n    if (texture instanceof THREE.DataTexture) {\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data);\r\n\r\n      }\r\n\r\n    }\r\n    else if (texture instanceof THREE.CompressedTexture) {\r\n\r\n      for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n        mipmap = mipmaps[i];\r\n\r\n        if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n          if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n            _gl.compressedTexImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n          }\r\n          else {\r\n\r\n            THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\");\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else { // regular Texture (image, video, canvas)\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (texture.generateMipmaps && isImagePowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n    texture.needsUpdate = false;\r\n\r\n    if (texture.onUpdate) texture.onUpdate();\r\n\r\n  };\r\n\r\n  this.setTexture = function(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n\r\n    if (texture.needsUpdate) {\r\n\r\n      _this.uploadTexture(texture);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function clampToMaxSize(image, maxSize) {\r\n\r\n    if (image.width > maxSize || image.height > maxSize) {\r\n\r\n      // Warning: Scaling through the canvas will only work with images that use\r\n      // premultiplied alpha.\r\n\r\n      var scale = maxSize / Math.max(image.width, image.height);\r\n\r\n      var canvas = document.createElement('canvas');\r\n      canvas.width = Math.floor(image.width * scale);\r\n      canvas.height = Math.floor(image.height * scale);\r\n\r\n      var context = canvas.getContext('2d');\r\n      context.drawImage(image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height);\r\n\r\n      THREE.warn('THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image);\r\n\r\n      return canvas;\r\n\r\n    }\r\n\r\n    return image;\r\n\r\n  }\r\n\r\n  function setCubeTexture(texture, slot) {\r\n\r\n    if (texture.image.length === 6) {\r\n\r\n      if (texture.needsUpdate) {\r\n\r\n        if (!texture.image.__webglTextureCube) {\r\n\r\n          texture.addEventListener('dispose', onTextureDispose);\r\n\r\n          texture.image.__webglTextureCube = _gl.createTexture();\r\n\r\n          _this.info.memory.textures++;\r\n\r\n        }\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n\r\n        var isCompressed = texture instanceof THREE.CompressedTexture;\r\n        var isDataTexture = texture.image[0] instanceof THREE.DataTexture;\r\n\r\n        var cubeImage = [];\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (_this.autoScaleCubemaps && !isCompressed && !isDataTexture) {\r\n\r\n            cubeImage[i] = clampToMaxSize(texture.image[i], _maxCubemapSize);\r\n\r\n          }\r\n          else {\r\n\r\n            cubeImage[i] = isDataTexture ? texture.image[i].image : texture.image[i];\r\n\r\n          }\r\n\r\n        }\r\n\r\n        var image = cubeImage[0],\r\n          isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n          glFormat = paramThreeToGL(texture.format),\r\n          glType = paramThreeToGL(texture.type);\r\n\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (!isCompressed) {\r\n\r\n            if (isDataTexture) {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[i].width, cubeImage[i].height, 0, glFormat, glType, cubeImage[i].data);\r\n\r\n            }\r\n            else {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[i]);\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            var mipmap, mipmaps = cubeImage[i].mipmaps;\r\n\r\n            for (var j = 0, jl = mipmaps.length; j < jl; j++) {\r\n\r\n              mipmap = mipmaps[j];\r\n\r\n              if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n                if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n                  _gl.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n                }\r\n                else {\r\n\r\n                  THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\");\r\n\r\n                }\r\n\r\n              }\r\n              else {\r\n\r\n                _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (texture.generateMipmaps && isImagePowerOfTwo) {\r\n\r\n          _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n        }\r\n\r\n        texture.needsUpdate = false;\r\n\r\n        if (texture.onUpdate) texture.onUpdate();\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setCubeTextureDynamic(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n    _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.__webglTexture);\r\n\r\n  }\r\n\r\n  // Render targets\r\n\r\n  function setupFrameBuffer(framebuffer, renderTarget, textureTarget) {\r\n\r\n    _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n    _gl.framebufferTexture2D(_gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, renderTarget.__webglTexture, 0);\r\n\r\n  }\r\n\r\n  function setupRenderBuffer(renderbuffer, renderTarget) {\r\n\r\n    _gl.bindRenderbuffer(_gl.RENDERBUFFER, renderbuffer);\r\n\r\n    if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n      /* For some reason this is not working. Defaulting to RGBA4.\r\n      } else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n      \t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n      \t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n      */\r\n    }\r\n    else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.setRenderTarget = function(renderTarget) {\r\n\r\n    var isCube = (renderTarget instanceof THREE.WebGLRenderTargetCube);\r\n\r\n    if (renderTarget && renderTarget.__webglFramebuffer === undefined) {\r\n\r\n      if (renderTarget.depthBuffer === undefined) renderTarget.depthBuffer = true;\r\n      if (renderTarget.stencilBuffer === undefined) renderTarget.stencilBuffer = true;\r\n\r\n      renderTarget.addEventListener('dispose', onRenderTargetDispose);\r\n\r\n      renderTarget.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n      // Setup texture, create render and frame buffers\r\n\r\n      var isTargetPowerOfTwo = THREE.Math.isPowerOfTwo(renderTarget.width) && THREE.Math.isPowerOfTwo(renderTarget.height),\r\n        glFormat = paramThreeToGL(renderTarget.format),\r\n        glType = paramThreeToGL(renderTarget.type);\r\n\r\n      if (isCube) {\r\n\r\n        renderTarget.__webglFramebuffer = [];\r\n        renderTarget.__webglRenderbuffer = [];\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, renderTarget, isTargetPowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          renderTarget.__webglFramebuffer[i] = _gl.createFramebuffer();\r\n          renderTarget.__webglRenderbuffer[i] = _gl.createRenderbuffer();\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n          setupFrameBuffer(renderTarget.__webglFramebuffer[i], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i);\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer[i], renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n      }\r\n      else {\r\n\r\n        renderTarget.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          renderTarget.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\r\n        }\r\n        else {\r\n\r\n          renderTarget.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\r\n        }\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_2D, renderTarget, isTargetPowerOfTwo);\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n        setupFrameBuffer(renderTarget.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D);\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n          else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer, renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n      }\r\n\r\n      // Release everything\r\n\r\n      if (isCube) {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n      }\r\n\r\n      _gl.bindRenderbuffer(_gl.RENDERBUFFER, null);\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, null);\r\n\r\n    }\r\n\r\n    var framebuffer, width, height, vx, vy;\r\n\r\n    if (renderTarget) {\r\n\r\n      if (isCube) {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer[renderTarget.activeCubeFace];\r\n\r\n      }\r\n      else {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer;\r\n\r\n      }\r\n\r\n      width = renderTarget.width;\r\n      height = renderTarget.height;\r\n\r\n      vx = 0;\r\n      vy = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      framebuffer = null;\r\n\r\n      width = _viewportWidth;\r\n      height = _viewportHeight;\r\n\r\n      vx = _viewportX;\r\n      vy = _viewportY;\r\n\r\n    }\r\n\r\n    if (framebuffer !== _currentFramebuffer) {\r\n\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n      _gl.viewport(vx, vy, width, height);\r\n\r\n      _currentFramebuffer = framebuffer;\r\n\r\n    }\r\n\r\n    _currentWidth = width;\r\n    _currentHeight = height;\r\n\r\n  };\r\n\r\n  this.readRenderTargetPixels = function(renderTarget, x, y, width, height, buffer) {\r\n\r\n    if (!(renderTarget instanceof THREE.WebGLRenderTarget)) {\r\n\r\n      console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');\r\n      return;\r\n\r\n    }\r\n\r\n    if (renderTarget.__webglFramebuffer) {\r\n\r\n      if (renderTarget.format !== THREE.RGBAFormat) {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.');\r\n        return;\r\n\r\n      }\r\n\r\n      var restore = false;\r\n\r\n      if (renderTarget.__webglFramebuffer !== _currentFramebuffer) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, renderTarget.__webglFramebuffer);\r\n\r\n        restore = true;\r\n\r\n      }\r\n\r\n      if (_gl.checkFramebufferStatus(_gl.FRAMEBUFFER) === _gl.FRAMEBUFFER_COMPLETE) {\r\n\r\n        _gl.readPixels(x, y, width, height, _gl.RGBA, _gl.UNSIGNED_BYTE, buffer);\r\n\r\n      }\r\n      else {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.');\r\n\r\n      }\r\n\r\n      if (restore) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, _currentFramebuffer);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function updateRenderTargetMipmap(renderTarget) {\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_2D);\r\n      _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Fallback filters for non-power-of-2 textures\r\n\r\n  function filterFallback(f) {\r\n\r\n    if (f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter) {\r\n\r\n      return _gl.NEAREST;\r\n\r\n    }\r\n\r\n    return _gl.LINEAR;\r\n\r\n  }\r\n\r\n  // Map three.js constants to WebGL constants\r\n\r\n  function paramThreeToGL(p) {\r\n\r\n    var extension;\r\n\r\n    if (p === THREE.RepeatWrapping) return _gl.REPEAT;\r\n    if (p === THREE.ClampToEdgeWrapping) return _gl.CLAMP_TO_EDGE;\r\n    if (p === THREE.MirroredRepeatWrapping) return _gl.MIRRORED_REPEAT;\r\n\r\n    if (p === THREE.NearestFilter) return _gl.NEAREST;\r\n    if (p === THREE.NearestMipMapNearestFilter) return _gl.NEAREST_MIPMAP_NEAREST;\r\n    if (p === THREE.NearestMipMapLinearFilter) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.LinearFilter) return _gl.LINEAR;\r\n    if (p === THREE.LinearMipMapNearestFilter) return _gl.LINEAR_MIPMAP_NEAREST;\r\n    if (p === THREE.LinearMipMapLinearFilter) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.UnsignedByteType) return _gl.UNSIGNED_BYTE;\r\n    if (p === THREE.UnsignedShort4444Type) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n    if (p === THREE.UnsignedShort5551Type) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n    if (p === THREE.UnsignedShort565Type) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n    if (p === THREE.ByteType) return _gl.BYTE;\r\n    if (p === THREE.ShortType) return _gl.SHORT;\r\n    if (p === THREE.UnsignedShortType) return _gl.UNSIGNED_SHORT;\r\n    if (p === THREE.IntType) return _gl.INT;\r\n    if (p === THREE.UnsignedIntType) return _gl.UNSIGNED_INT;\r\n    if (p === THREE.FloatType) return _gl.FLOAT;\r\n\r\n    extension = extensions.get('OES_texture_half_float');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.HalfFloatType) return extension.HALF_FLOAT_OES;\r\n\r\n    }\r\n\r\n    if (p === THREE.AlphaFormat) return _gl.ALPHA;\r\n    if (p === THREE.RGBFormat) return _gl.RGB;\r\n    if (p === THREE.RGBAFormat) return _gl.RGBA;\r\n    if (p === THREE.LuminanceFormat) return _gl.LUMINANCE;\r\n    if (p === THREE.LuminanceAlphaFormat) return _gl.LUMINANCE_ALPHA;\r\n\r\n    if (p === THREE.AddEquation) return _gl.FUNC_ADD;\r\n    if (p === THREE.SubtractEquation) return _gl.FUNC_SUBTRACT;\r\n    if (p === THREE.ReverseSubtractEquation) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n    if (p === THREE.ZeroFactor) return _gl.ZERO;\r\n    if (p === THREE.OneFactor) return _gl.ONE;\r\n    if (p === THREE.SrcColorFactor) return _gl.SRC_COLOR;\r\n    if (p === THREE.OneMinusSrcColorFactor) return _gl.ONE_MINUS_SRC_COLOR;\r\n    if (p === THREE.SrcAlphaFactor) return _gl.SRC_ALPHA;\r\n    if (p === THREE.OneMinusSrcAlphaFactor) return _gl.ONE_MINUS_SRC_ALPHA;\r\n    if (p === THREE.DstAlphaFactor) return _gl.DST_ALPHA;\r\n    if (p === THREE.OneMinusDstAlphaFactor) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n    if (p === THREE.DstColorFactor) return _gl.DST_COLOR;\r\n    if (p === THREE.OneMinusDstColorFactor) return _gl.ONE_MINUS_DST_COLOR;\r\n    if (p === THREE.SrcAlphaSaturateFactor) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_S3TC_DXT1_Format) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT1_Format) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT3_Format) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT5_Format) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n    }\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGB_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_blend_minmax');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.MinEquation) return extension.MIN_EXT;\r\n      if (p === THREE.MaxEquation) return extension.MAX_EXT;\r\n\r\n    }\r\n\r\n    return 0;\r\n\r\n  }\r\n\r\n  // Allocations\r\n\r\n  function allocateBones(object) {\r\n\r\n    if (_supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n      return 1024;\r\n\r\n    }\r\n    else {\r\n\r\n      // default for when object is not specified\r\n      // ( for example when prebuilding shader\r\n      //   to be used with multiple objects )\r\n      //\r\n      //  - leave some extra space for other uniforms\r\n      //  - limit here is ANGLE's 254 max uniform vectors\r\n      //    (up to 54 should be safe)\r\n\r\n      var nVertexUniforms = _gl.getParameter(_gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n      var nVertexMatrices = Math.floor((nVertexUniforms - 20) / 4);\r\n\r\n      var maxBones = nVertexMatrices;\r\n\r\n      if (object !== undefined && object instanceof THREE.SkinnedMesh) {\r\n\r\n        maxBones = Math.min(object.skeleton.bones.length, maxBones);\r\n\r\n        if (maxBones < object.skeleton.bones.length) {\r\n\r\n          THREE.warn('WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return maxBones;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function allocateLights(lights) {\r\n\r\n    var dirLights = 0;\r\n    var pointLights = 0;\r\n    var spotLights = 0;\r\n    var hemiLights = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (light.onlyShadow || light.visible === false) continue;\r\n\r\n      if (light instanceof THREE.DirectionalLight) dirLights++;\r\n      if (light instanceof THREE.PointLight) pointLights++;\r\n      if (light instanceof THREE.SpotLight) spotLights++;\r\n      if (light instanceof THREE.HemisphereLight) hemiLights++;\r\n\r\n    }\r\n\r\n    return {\r\n      'directional': dirLights,\r\n      'point': pointLights,\r\n      'spot': spotLights,\r\n      'hemi': hemiLights\r\n    };\r\n\r\n  }\r\n\r\n  function allocateShadows(lights) {\r\n\r\n    var maxShadows = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if (light instanceof THREE.SpotLight) maxShadows++;\r\n      if (light instanceof THREE.DirectionalLight && !light.shadowCascade) maxShadows++;\r\n\r\n    }\r\n\r\n    return maxShadows;\r\n\r\n  }\r\n\r\n  // DEPRECATED\r\n\r\n  this.initMaterial = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .initMaterial() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPrePlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPostPlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.updateShadowMap = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.');\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.WebGLRenderTarget = function(width, height, options) {\r\n\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  options = options || {};\r\n\r\n  this.wrapS = options.wrapS !== undefined ? options.wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = options.wrapT !== undefined ? options.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = options.magFilter !== undefined ? options.magFilter : THREE.LinearFilter;\r\n  this.minFilter = options.minFilter !== undefined ? options.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = options.anisotropy !== undefined ? options.anisotropy : 1;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.format = options.format !== undefined ? options.format : THREE.RGBAFormat;\r\n  this.type = options.type !== undefined ? options.type : THREE.UnsignedByteType;\r\n\r\n  this.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n  this.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\r\n  this.generateMipmaps = true;\r\n\r\n  this.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n  constructor: THREE.WebGLRenderTarget,\r\n\r\n  setSize: function(width, height) {\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var tmp = new THREE.WebGLRenderTarget(this.width, this.height);\r\n\r\n    tmp.wrapS = this.wrapS;\r\n    tmp.wrapT = this.wrapT;\r\n\r\n    tmp.magFilter = this.magFilter;\r\n    tmp.minFilter = this.minFilter;\r\n\r\n    tmp.anisotropy = this.anisotropy;\r\n\r\n    tmp.offset.copy(this.offset);\r\n    tmp.repeat.copy(this.repeat);\r\n\r\n    tmp.format = this.format;\r\n    tmp.type = this.type;\r\n\r\n    tmp.depthBuffer = this.depthBuffer;\r\n    tmp.stencilBuffer = this.stencilBuffer;\r\n\r\n    tmp.generateMipmaps = this.generateMipmaps;\r\n\r\n    tmp.shareDepthFrom = this.shareDepthFrom;\r\n\r\n    return tmp;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function(width, height, options) {\r\n\r\n  THREE.WebGLRenderTarget.call(this, width, height, options);\r\n\r\n  this.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create(THREE.WebGLRenderTarget.prototype);\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLExtensions = function(gl) {\r\n\r\n  var extensions = {};\r\n\r\n  this.get = function(name) {\r\n\r\n    if (extensions[name] !== undefined) {\r\n\r\n      return extensions[name];\r\n\r\n    }\r\n\r\n    var extension;\r\n\r\n    switch (name) {\r\n\r\n      case 'EXT_texture_filter_anisotropic':\r\n        extension = gl.getExtension('EXT_texture_filter_anisotropic') || gl.getExtension('MOZ_EXT_texture_filter_anisotropic') || gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_s3tc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_s3tc') || gl.getExtension('MOZ_WEBGL_compressed_texture_s3tc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_pvrtc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_pvrtc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');\r\n        break;\r\n\r\n      default:\r\n        extension = gl.getExtension(name);\r\n\r\n    }\r\n\r\n    if (extension === null) {\r\n\r\n      THREE.warn('THREE.WebGLRenderer: ' + name + ' extension not supported.');\r\n\r\n    }\r\n\r\n    extensions[name] = extension;\r\n\r\n    return extension;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = (function() {\r\n\r\n  var programIdCount = 0;\r\n\r\n  var generateDefines = function(defines) {\r\n\r\n    var value, chunk, chunks = [];\r\n\r\n    for (var d in defines) {\r\n\r\n      value = defines[d];\r\n      if (value === false) continue;\r\n\r\n      chunk = '#define ' + d + ' ' + value;\r\n      chunks.push(chunk);\r\n\r\n    }\r\n\r\n    return chunks.join('\\n');\r\n\r\n  };\r\n\r\n  var cacheUniformLocations = function(gl, program, identifiers) {\r\n\r\n    var uniforms = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      uniforms[id] = gl.getUniformLocation(program, id);\r\n\r\n    }\r\n\r\n    return uniforms;\r\n\r\n  };\r\n\r\n  var cacheAttributeLocations = function(gl, program, identifiers) {\r\n\r\n    var attributes = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      attributes[id] = gl.getAttribLocation(program, id);\r\n\r\n    }\r\n\r\n    return attributes;\r\n\r\n  };\r\n\r\n  return function(renderer, code, material, parameters) {\r\n\r\n    var _this = renderer;\r\n    var _gl = _this.context;\r\n\r\n    var defines = material.defines;\r\n    var uniforms = material.__webglShader.uniforms;\r\n    var attributes = material.attributes;\r\n\r\n    var vertexShader = material.__webglShader.vertexShader;\r\n    var fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n    var index0AttributeName = material.index0AttributeName;\r\n\r\n    if (index0AttributeName === undefined && parameters.morphTargets === true) {\r\n\r\n      // programs with morphTargets displace position out of attribute 0\r\n\r\n      index0AttributeName = 'position';\r\n\r\n    }\r\n\r\n    var shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n    if (parameters.shadowMapType === THREE.PCFShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n    }\r\n    else if (parameters.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n    }\r\n\r\n    var envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n    var envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n    var envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n    if (parameters.envMap) {\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeReflectionMapping:\r\n        case THREE.CubeRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n          break;\r\n\r\n        case THREE.EquirectangularReflectionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n          break;\r\n\r\n        case THREE.SphericalReflectionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeRefractionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.combine) {\r\n\r\n        case THREE.MultiplyOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n          break;\r\n\r\n        case THREE.MixOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n          break;\r\n\r\n        case THREE.AddOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n          break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var gammaFactorDefine = (renderer.gammaFactor > 0) ? renderer.gammaFactor : 1.0;\r\n\r\n    // console.log( 'building new program ' );\r\n\r\n    //\r\n\r\n    var customDefines = generateDefines(defines);\r\n\r\n    //\r\n\r\n    var program = _gl.createProgram();\r\n\r\n    var prefix_vertex, prefix_fragment;\r\n\r\n    if (material instanceof THREE.RawShaderMaterial) {\r\n\r\n      prefix_vertex = '';\r\n      prefix_fragment = '';\r\n\r\n    }\r\n    else {\r\n\r\n      prefix_vertex = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        customDefines,\r\n\r\n        parameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        '#define MAX_BONES ' + parameters.maxBones,\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.skinning ? '#define USE_SKINNING' : '',\r\n        parameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n        parameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n        parameters.morphNormals ? '#define USE_MORPHNORMALS' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\r\n        'uniform mat4 modelMatrix;',\r\n        'uniform mat4 modelViewMatrix;',\r\n        'uniform mat4 projectionMatrix;',\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform mat3 normalMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n\r\n        'attribute vec3 position;',\r\n        'attribute vec3 normal;',\r\n        'attribute vec2 uv;',\r\n        'attribute vec2 uv2;',\r\n\r\n        '#ifdef USE_COLOR',\r\n\r\n        '\tattribute vec3 color;',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_MORPHTARGETS',\r\n\r\n        '\tattribute vec3 morphTarget0;',\r\n        '\tattribute vec3 morphTarget1;',\r\n        '\tattribute vec3 morphTarget2;',\r\n        '\tattribute vec3 morphTarget3;',\r\n\r\n        '\t#ifdef USE_MORPHNORMALS',\r\n\r\n        '\t\tattribute vec3 morphNormal0;',\r\n        '\t\tattribute vec3 morphNormal1;',\r\n        '\t\tattribute vec3 morphNormal2;',\r\n        '\t\tattribute vec3 morphNormal3;',\r\n\r\n        '\t#else',\r\n\r\n        '\t\tattribute vec3 morphTarget4;',\r\n        '\t\tattribute vec3 morphTarget5;',\r\n        '\t\tattribute vec3 morphTarget6;',\r\n        '\t\tattribute vec3 morphTarget7;',\r\n\r\n        '\t#endif',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_SKINNING',\r\n\r\n        '\tattribute vec4 skinIndex;',\r\n        '\tattribute vec4 skinWeight;',\r\n\r\n        '#endif',\r\n\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n      prefix_fragment = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        (parameters.bumpMap || parameters.normalMap || parameters.flatShading) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\r\n        customDefines,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        parameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        (parameters.useFog && parameters.fog) ? '#define USE_FOG' : '', (parameters.useFog && parameters.fogExp) ? '#define FOG_EXP2' : '',\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.metal ? '#define METAL' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n    }\r\n\r\n    var glVertexShader = new THREE.WebGLShader(_gl, _gl.VERTEX_SHADER, prefix_vertex + vertexShader);\r\n    var glFragmentShader = new THREE.WebGLShader(_gl, _gl.FRAGMENT_SHADER, prefix_fragment + fragmentShader);\r\n\r\n    _gl.attachShader(program, glVertexShader);\r\n    _gl.attachShader(program, glFragmentShader);\r\n\r\n    if (index0AttributeName !== undefined) {\r\n\r\n      // Force a particular attribute to index 0.\r\n      // because potentially expensive emulation is done by browser if attribute 0 is disabled.\r\n      // And, color, for example is often automatically bound to index 0 so disabling it\r\n\r\n      _gl.bindAttribLocation(program, 0, index0AttributeName);\r\n\r\n    }\r\n\r\n    _gl.linkProgram(program);\r\n\r\n    var programLogInfo = _gl.getProgramInfoLog(program);\r\n\r\n    if (_gl.getProgramParameter(program, _gl.LINK_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLProgram: shader error: ' + _gl.getError(), 'gl.VALIDATE_STATUS', _gl.getProgramParameter(program, _gl.VALIDATE_STATUS), 'gl.getPRogramInfoLog', programLogInfo);\r\n\r\n    }\r\n\r\n    if (programLogInfo !== '') {\r\n\r\n      THREE.warn('THREE.WebGLProgram: gl.getProgramInfoLog()' + programLogInfo);\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n    }\r\n\r\n    // clean up\r\n\r\n    _gl.deleteShader(glVertexShader);\r\n    _gl.deleteShader(glFragmentShader);\r\n\r\n    // cache uniform locations\r\n\r\n    var identifiers = [\r\n\r\n      'viewMatrix',\r\n      'modelViewMatrix',\r\n      'projectionMatrix',\r\n      'normalMatrix',\r\n      'modelMatrix',\r\n      'cameraPosition',\r\n      'morphTargetInfluences',\r\n      'bindMatrix',\r\n      'bindMatrixInverse'\r\n\r\n    ];\r\n\r\n    if (parameters.useVertexTexture) {\r\n\r\n      identifiers.push('boneTexture');\r\n      identifiers.push('boneTextureWidth');\r\n      identifiers.push('boneTextureHeight');\r\n\r\n    }\r\n    else {\r\n\r\n      identifiers.push('boneGlobalMatrices');\r\n\r\n    }\r\n\r\n    if (parameters.logarithmicDepthBuffer) {\r\n\r\n      identifiers.push('logDepthBufFC');\r\n\r\n    }\r\n\r\n\r\n    for (var u in uniforms) {\r\n\r\n      identifiers.push(u);\r\n\r\n    }\r\n\r\n    this.uniforms = cacheUniformLocations(_gl, program, identifiers);\r\n\r\n    // cache attributes locations\r\n\r\n    identifiers = [\r\n\r\n      'position',\r\n      'normal',\r\n      'uv',\r\n      'uv2',\r\n      'tangent',\r\n      'color',\r\n      'skinIndex',\r\n      'skinWeight',\r\n      'lineDistance'\r\n\r\n    ];\r\n\r\n    for (var i = 0; i < parameters.maxMorphTargets; i++) {\r\n\r\n      identifiers.push('morphTarget' + i);\r\n\r\n    }\r\n\r\n    for (var i = 0; i < parameters.maxMorphNormals; i++) {\r\n\r\n      identifiers.push('morphNormal' + i);\r\n\r\n    }\r\n\r\n    for (var a in attributes) {\r\n\r\n      identifiers.push(a);\r\n\r\n    }\r\n\r\n    this.attributes = cacheAttributeLocations(_gl, program, identifiers);\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n    //\r\n\r\n    this.id = programIdCount++;\r\n    this.code = code;\r\n    this.usedTimes = 1;\r\n    this.program = program;\r\n    this.vertexShader = glVertexShader;\r\n    this.fragmentShader = glFragmentShader;\r\n\r\n    return this;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = (function() {\r\n\r\n  var addLineNumbers = function(string) {\r\n\r\n    var lines = string.split('\\n');\r\n\r\n    for (var i = 0; i < lines.length; i++) {\r\n\r\n      lines[i] = (i + 1) + ': ' + lines[i];\r\n\r\n    }\r\n\r\n    return lines.join('\\n');\r\n\r\n  };\r\n\r\n  return function(gl, type, string) {\r\n\r\n    var shader = gl.createShader(type);\r\n\r\n    gl.shaderSource(shader, string);\r\n    gl.compileShader(shader);\r\n\r\n    if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLShader: Shader couldn\\'t compile.');\r\n\r\n    }\r\n\r\n    if (gl.getShaderInfoLog(shader) !== '') {\r\n\r\n      THREE.warn('THREE.WebGLShader: gl.getShaderInfoLog()', gl.getShaderInfoLog(shader), addLineNumbers(string));\r\n\r\n    }\r\n\r\n    // --enable-privileged-webgl-extension\r\n    // console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n    return shader;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLState = function(gl, paramThreeToGL) {\r\n\r\n  var newAttributes = new Uint8Array(16);\r\n  var enabledAttributes = new Uint8Array(16);\r\n\r\n  var currentBlending = null;\r\n  var currentBlendEquation = null;\r\n  var currentBlendSrc = null;\r\n  var currentBlendDst = null;\r\n  var currentBlendEquationAlpha = null;\r\n  var currentBlendSrcAlpha = null;\r\n  var currentBlendDstAlpha = null;\r\n\r\n  var currentDepthTest = null;\r\n  var currentDepthWrite = null;\r\n\r\n  var currentColorWrite = null;\r\n\r\n  var currentDoubleSided = null;\r\n  var currentFlipSided = null;\r\n\r\n  var currentLineWidth = null;\r\n\r\n  var currentPolygonOffset = null;\r\n  var currentPolygonOffsetFactor = null;\r\n  var currentPolygonOffsetUnits = null;\r\n\r\n  this.initAttributes = function() {\r\n\r\n    for (var i = 0, l = newAttributes.length; i < l; i++) {\r\n\r\n      newAttributes[i] = 0;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.enableAttribute = function(attribute) {\r\n\r\n    newAttributes[attribute] = 1;\r\n\r\n    if (enabledAttributes[attribute] === 0) {\r\n\r\n      gl.enableVertexAttribArray(attribute);\r\n      enabledAttributes[attribute] = 1;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.disableUnusedAttributes = function() {\r\n\r\n    for (var i = 0, l = enabledAttributes.length; i < l; i++) {\r\n\r\n      if (enabledAttributes[i] !== newAttributes[i]) {\r\n\r\n        gl.disableVertexAttribArray(i);\r\n        enabledAttributes[i] = 0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setBlending = function(blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha) {\r\n\r\n    if (blending !== currentBlending) {\r\n\r\n      if (blending === THREE.NoBlending) {\r\n\r\n        gl.disable(gl.BLEND);\r\n\r\n      }\r\n      else if (blending === THREE.AdditiveBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\r\n\r\n      }\r\n      else if (blending === THREE.SubtractiveBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.MultiplyBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.CustomBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      }\r\n\r\n      currentBlending = blending;\r\n\r\n    }\r\n\r\n    if (blending === THREE.CustomBlending) {\r\n\r\n      blendEquationAlpha = blendEquationAlpha || blendEquation;\r\n      blendSrcAlpha = blendSrcAlpha || blendSrc;\r\n      blendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n      if (blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha) {\r\n\r\n        gl.blendEquationSeparate(paramThreeToGL(blendEquation), paramThreeToGL(blendEquationAlpha));\r\n\r\n        currentBlendEquation = blendEquation;\r\n        currentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n      }\r\n\r\n      if (blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha) {\r\n\r\n        gl.blendFuncSeparate(paramThreeToGL(blendSrc), paramThreeToGL(blendDst), paramThreeToGL(blendSrcAlpha), paramThreeToGL(blendDstAlpha));\r\n\r\n        currentBlendSrc = blendSrc;\r\n        currentBlendDst = blendDst;\r\n        currentBlendSrcAlpha = blendSrcAlpha;\r\n        currentBlendDstAlpha = blendDstAlpha;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      currentBlendEquation = null;\r\n      currentBlendSrc = null;\r\n      currentBlendDst = null;\r\n      currentBlendEquationAlpha = null;\r\n      currentBlendSrcAlpha = null;\r\n      currentBlendDstAlpha = null;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthTest = function(depthTest) {\r\n\r\n    if (currentDepthTest !== depthTest) {\r\n\r\n      if (depthTest) {\r\n\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n      }\r\n\r\n      currentDepthTest = depthTest;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthWrite = function(depthWrite) {\r\n\r\n    if (currentDepthWrite !== depthWrite) {\r\n\r\n      gl.depthMask(depthWrite);\r\n      currentDepthWrite = depthWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setColorWrite = function(colorWrite) {\r\n\r\n    if (currentColorWrite !== colorWrite) {\r\n\r\n      gl.colorMask(colorWrite, colorWrite, colorWrite, colorWrite);\r\n      currentColorWrite = colorWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDoubleSided = function(doubleSided) {\r\n\r\n    if (currentDoubleSided !== doubleSided) {\r\n\r\n      if (doubleSided) {\r\n\r\n        gl.disable(gl.CULL_FACE);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.CULL_FACE);\r\n\r\n      }\r\n\r\n      currentDoubleSided = doubleSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setFlipSided = function(flipSided) {\r\n\r\n    if (currentFlipSided !== flipSided) {\r\n\r\n      if (flipSided) {\r\n\r\n        gl.frontFace(gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.frontFace(gl.CCW);\r\n\r\n      }\r\n\r\n      currentFlipSided = flipSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setLineWidth = function(width) {\r\n\r\n    if (width !== currentLineWidth) {\r\n\r\n      gl.lineWidth(width);\r\n\r\n      currentLineWidth = width;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setPolygonOffset = function(polygonoffset, factor, units) {\r\n\r\n    if (currentPolygonOffset !== polygonoffset) {\r\n\r\n      if (polygonoffset) {\r\n\r\n        gl.enable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n\r\n      currentPolygonOffset = polygonoffset;\r\n\r\n    }\r\n\r\n    if (polygonoffset && (currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units)) {\r\n\r\n      gl.polygonOffset(factor, units);\r\n\r\n      currentPolygonOffsetFactor = factor;\r\n      currentPolygonOffsetUnits = units;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.reset = function() {\r\n\r\n    for (var i = 0; i < enabledAttributes.length; i++) {\r\n\r\n      enabledAttributes[i] = 0;\r\n\r\n    }\r\n\r\n    currentBlending = null;\r\n    currentDepthTest = null;\r\n    currentDepthWrite = null;\r\n    currentColorWrite = null;\r\n    currentDoubleSided = null;\r\n    currentFlipSided = null;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function(renderer, flares) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n  var hasVertexTexture;\r\n\r\n  var tempTexture, occlusionTexture;\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-1, -1, 0, 0,\r\n      1, -1, 1, 0,\r\n      1, 1, 1, 1, -1, 1, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    // buffers\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    // textures\r\n\r\n    tempTexture = gl.createTexture();\r\n    occlusionTexture = gl.createTexture();\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    hasVertexTexture = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;\r\n\r\n    var shader;\r\n\r\n    if (hasVertexTexture) {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"uniform sampler2D occlusionMap;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n          \"vVisibility =        visibility.r / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n          \"vVisibility *=       visibility.b / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * vVisibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n    else {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"precision mediump float;\",\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform sampler2D occlusionMap;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n          \"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * visibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n\r\n    program = createProgram(shader);\r\n\r\n    attributes = {\r\n      vertex: gl.getAttribLocation(program, \"position\"),\r\n      uv: gl.getAttribLocation(program, \"uv\")\r\n    }\r\n\r\n    uniforms = {\r\n      renderType: gl.getUniformLocation(program, \"renderType\"),\r\n      map: gl.getUniformLocation(program, \"map\"),\r\n      occlusionMap: gl.getUniformLocation(program, \"occlusionMap\"),\r\n      opacity: gl.getUniformLocation(program, \"opacity\"),\r\n      color: gl.getUniformLocation(program, \"color\"),\r\n      scale: gl.getUniformLocation(program, \"scale\"),\r\n      rotation: gl.getUniformLocation(program, \"rotation\"),\r\n      screenPosition: gl.getUniformLocation(program, \"screenPosition\")\r\n    };\r\n\r\n  };\r\n\r\n  /*\r\n   * Render lens flares\r\n   * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n   *         reads these back and calculates occlusion.\r\n   */\r\n\r\n  this.render = function(scene, camera, viewportWidth, viewportHeight) {\r\n\r\n    if (flares.length === 0) return;\r\n\r\n    var tempPosition = new THREE.Vector3();\r\n\r\n    var invAspect = viewportHeight / viewportWidth,\r\n      halfViewportWidth = viewportWidth * 0.5,\r\n      halfViewportHeight = viewportHeight * 0.5;\r\n\r\n    var size = 16 / viewportHeight,\r\n      scale = new THREE.Vector2(size * invAspect, size);\r\n\r\n    var screenPosition = new THREE.Vector3(1, 1, 0),\r\n      screenPositionPixels = new THREE.Vector2(1, 1);\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.vertex);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    // loop through all lens flares to update their occlusion and positions\r\n    // setup gl and common used attribs/unforms\r\n\r\n    gl.uniform1i(uniforms.occlusionMap, 0);\r\n    gl.uniform1i(uniforms.map, 1);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.depthMask(false);\r\n\r\n    for (var i = 0, l = flares.length; i < l; i++) {\r\n\r\n      size = 16 / viewportHeight;\r\n      scale.set(size * invAspect, size);\r\n\r\n      // calc object screen position\r\n\r\n      var flare = flares[i];\r\n\r\n      tempPosition.set(flare.matrixWorld.elements[12], flare.matrixWorld.elements[13], flare.matrixWorld.elements[14]);\r\n\r\n      tempPosition.applyMatrix4(camera.matrixWorldInverse);\r\n      tempPosition.applyProjection(camera.projectionMatrix);\r\n\r\n      // setup arrays for gl programs\r\n\r\n      screenPosition.copy(tempPosition)\r\n\r\n      screenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n      screenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\r\n      // screen cull\r\n\r\n      if (hasVertexTexture || (\r\n          screenPositionPixels.x > 0 &&\r\n          screenPositionPixels.x < viewportWidth &&\r\n          screenPositionPixels.y > 0 &&\r\n          screenPositionPixels.y < viewportHeight)) {\r\n\r\n        // save current RGB to temp texture\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // render pink quad\r\n\r\n        gl.uniform1i(uniforms.renderType, 0);\r\n        gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n        gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n\r\n        gl.disable(gl.BLEND);\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // copy result to occlusionMap\r\n\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // restore graphics\r\n\r\n        gl.uniform1i(uniforms.renderType, 1);\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // update object positions\r\n\r\n        flare.positionScreen.copy(screenPosition)\r\n\r\n        if (flare.customUpdateCallback) {\r\n\r\n          flare.customUpdateCallback(flare);\r\n\r\n        }\r\n        else {\r\n\r\n          flare.updateLensFlares();\r\n\r\n        }\r\n\r\n        // render flares\r\n\r\n        gl.uniform1i(uniforms.renderType, 2);\r\n        gl.enable(gl.BLEND);\r\n\r\n        for (var j = 0, jl = flare.lensFlares.length; j < jl; j++) {\r\n\r\n          var sprite = flare.lensFlares[j];\r\n\r\n          if (sprite.opacity > 0.001 && sprite.scale > 0.001) {\r\n\r\n            screenPosition.x = sprite.x;\r\n            screenPosition.y = sprite.y;\r\n            screenPosition.z = sprite.z;\r\n\r\n            size = sprite.size * sprite.scale / viewportHeight;\r\n\r\n            scale.x = size * invAspect;\r\n            scale.y = size;\r\n\r\n            gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n            gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n            gl.uniform1f(uniforms.rotation, sprite.rotation);\r\n\r\n            gl.uniform1f(uniforms.opacity, sprite.opacity);\r\n            gl.uniform3f(uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b);\r\n\r\n            renderer.state.setBlending(sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst);\r\n            renderer.setTexture(sprite.texture, 1);\r\n\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.enable(gl.DEPTH_TEST);\r\n    gl.depthMask(true);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram(shader) {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n\r\n    var prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n    gl.shaderSource(fragmentShader, prefix + shader.fragmentShader);\r\n    gl.shaderSource(vertexShader, prefix + shader.vertexShader);\r\n\r\n    gl.compileShader(fragmentShader);\r\n    gl.compileShader(vertexShader);\r\n\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.attachShader(program, vertexShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/ShadowMapPlugin.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ShadowMapPlugin = function(_renderer, _lights, _webglObjects, _webglObjectsImmediate) {\r\n\r\n  var _gl = _renderer.context;\r\n\r\n  var _depthMaterial, _depthMaterialMorph, _depthMaterialSkin, _depthMaterialMorphSkin,\r\n\r\n    _frustum = new THREE.Frustum(),\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _min = new THREE.Vector3(),\r\n    _max = new THREE.Vector3(),\r\n\r\n    _matrixPosition = new THREE.Vector3(),\r\n\r\n    _renderList = [];\r\n\r\n  // init\r\n\r\n  var depthShader = THREE.ShaderLib[\"depthRGBA\"];\r\n  var depthUniforms = THREE.UniformsUtils.clone(depthShader.uniforms);\r\n\r\n  _depthMaterial = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader\r\n  });\r\n\r\n  _depthMaterialMorph = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true\r\n  });\r\n\r\n  _depthMaterialSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterialMorphSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterial._shadowPass = true;\r\n  _depthMaterialMorph._shadowPass = true;\r\n  _depthMaterialSkin._shadowPass = true;\r\n  _depthMaterialMorphSkin._shadowPass = true;\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (_renderer.shadowMapEnabled === false) return;\r\n\r\n    var i, il, j, jl, n,\r\n\r\n      shadowMap, shadowMatrix, shadowCamera,\r\n      buffer, material,\r\n      webglObject, object, light,\r\n\r\n      lights = [],\r\n      k = 0,\r\n\r\n      fog = null;\r\n\r\n    // set GL state for depth map\r\n\r\n    _gl.clearColor(1, 1, 1, 1);\r\n    _gl.disable(_gl.BLEND);\r\n\r\n    _gl.enable(_gl.CULL_FACE);\r\n    _gl.frontFace(_gl.CCW);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.FRONT);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.state.setDepthTest(true);\r\n\r\n    // preprocess lights\r\n    // \t- skip lights that are not casting shadows\r\n    //\t- create virtual lights for cascaded shadow maps\r\n\r\n    for (i = 0, il = _lights.length; i < il; i++) {\r\n\r\n      light = _lights[i];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if ((light instanceof THREE.DirectionalLight) && light.shadowCascade) {\r\n\r\n        for (n = 0; n < light.shadowCascadeCount; n++) {\r\n\r\n          var virtualLight;\r\n\r\n          if (!light.shadowCascadeArray[n]) {\r\n\r\n            virtualLight = createVirtualLight(light, n);\r\n            virtualLight.originalCamera = camera;\r\n\r\n            var gyro = new THREE.Gyroscope();\r\n            gyro.position.copy(light.shadowCascadeOffset);\r\n\r\n            gyro.add(virtualLight);\r\n            gyro.add(virtualLight.target);\r\n\r\n            camera.add(gyro);\r\n\r\n            light.shadowCascadeArray[n] = virtualLight;\r\n\r\n            //console.log( \"Created virtualLight\", virtualLight );\r\n\r\n          }\r\n          else {\r\n\r\n            virtualLight = light.shadowCascadeArray[n];\r\n\r\n          }\r\n\r\n          updateVirtualLight(light, n);\r\n\r\n          lights[k] = virtualLight;\r\n          k++;\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        lights[k] = light;\r\n        k++;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // render depth map\r\n\r\n    for (i = 0, il = lights.length; i < il; i++) {\r\n\r\n      light = lights[i];\r\n\r\n      if (!light.shadowMap) {\r\n\r\n        var shadowFilter = THREE.LinearFilter;\r\n\r\n        if (_renderer.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n          shadowFilter = THREE.NearestFilter;\r\n\r\n        }\r\n\r\n        var pars = {\r\n          minFilter: shadowFilter,\r\n          magFilter: shadowFilter,\r\n          format: THREE.RGBAFormat\r\n        };\r\n\r\n        light.shadowMap = new THREE.WebGLRenderTarget(light.shadowMapWidth, light.shadowMapHeight, pars);\r\n        light.shadowMapSize = new THREE.Vector2(light.shadowMapWidth, light.shadowMapHeight);\r\n\r\n        light.shadowMatrix = new THREE.Matrix4();\r\n\r\n      }\r\n\r\n      if (!light.shadowCamera) {\r\n\r\n        if (light instanceof THREE.SpotLight) {\r\n\r\n          light.shadowCamera = new THREE.PerspectiveCamera(light.shadowCameraFov, light.shadowMapWidth / light.shadowMapHeight, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else if (light instanceof THREE.DirectionalLight) {\r\n\r\n          light.shadowCamera = new THREE.OrthographicCamera(light.shadowCameraLeft, light.shadowCameraRight, light.shadowCameraTop, light.shadowCameraBottom, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error(\"THREE.ShadowMapPlugin: Unsupported light type for shadow\", light);\r\n          continue;\r\n\r\n        }\r\n\r\n        scene.add(light.shadowCamera);\r\n\r\n        if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n      }\r\n\r\n      if (light.shadowCameraVisible && !light.cameraHelper) {\r\n\r\n        light.cameraHelper = new THREE.CameraHelper(light.shadowCamera);\r\n        scene.add(light.cameraHelper);\r\n\r\n      }\r\n\r\n      if (light.isVirtual && virtualLight.originalCamera == camera) {\r\n\r\n        updateShadowCamera(camera, light);\r\n\r\n      }\r\n\r\n      shadowMap = light.shadowMap;\r\n      shadowMatrix = light.shadowMatrix;\r\n      shadowCamera = light.shadowCamera;\r\n\r\n      //\r\n\r\n      shadowCamera.position.setFromMatrixPosition(light.matrixWorld);\r\n      _matrixPosition.setFromMatrixPosition(light.target.matrixWorld);\r\n      shadowCamera.lookAt(_matrixPosition);\r\n      shadowCamera.updateMatrixWorld();\r\n\r\n      shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld);\r\n\r\n      //\r\n\r\n      if (light.cameraHelper) light.cameraHelper.visible = light.shadowCameraVisible;\r\n      if (light.shadowCameraVisible) light.cameraHelper.update();\r\n\r\n      // compute shadow matrix\r\n\r\n      shadowMatrix.set(\r\n        0.5, 0.0, 0.0, 0.5,\r\n        0.0, 0.5, 0.0, 0.5,\r\n        0.0, 0.0, 0.5, 0.5,\r\n        0.0, 0.0, 0.0, 1.0\r\n      );\r\n\r\n      shadowMatrix.multiply(shadowCamera.projectionMatrix);\r\n      shadowMatrix.multiply(shadowCamera.matrixWorldInverse);\r\n\r\n      // update camera matrices and frustum\r\n\r\n      _projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse);\r\n      _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n      // render shadow map\r\n\r\n      _renderer.setRenderTarget(shadowMap);\r\n      _renderer.clear();\r\n\r\n      // set object matrices & frustum culling\r\n\r\n      _renderList.length = 0;\r\n\r\n      projectObject(scene, scene, shadowCamera);\r\n\r\n\r\n      // render regular objects\r\n\r\n      var objectMaterial, useMorphing, useSkinning;\r\n\r\n      for (j = 0, jl = _renderList.length; j < jl; j++) {\r\n\r\n        webglObject = _renderList[j];\r\n\r\n        object = webglObject.object;\r\n        buffer = webglObject.buffer;\r\n\r\n        // culling is overriden globally for all objects\r\n        // while rendering depth map\r\n\r\n        // need to deal with MeshFaceMaterial somehow\r\n        // in that case just use the first of material.materials for now\r\n        // (proper solution would require to break objects by materials\r\n        //  similarly to regular rendering and then set corresponding\r\n        //  depth materials per each chunk instead of just once per object)\r\n\r\n        objectMaterial = getObjectMaterial(object);\r\n\r\n        useMorphing = object.geometry.morphTargets !== undefined && object.geometry.morphTargets.length > 0 && objectMaterial.morphTargets;\r\n        useSkinning = object instanceof THREE.SkinnedMesh && objectMaterial.skinning;\r\n\r\n        if (object.customDepthMaterial) {\r\n\r\n          material = object.customDepthMaterial;\r\n\r\n        }\r\n        else if (useSkinning) {\r\n\r\n          material = useMorphing ? _depthMaterialMorphSkin : _depthMaterialSkin;\r\n\r\n        }\r\n        else if (useMorphing) {\r\n\r\n          material = _depthMaterialMorph;\r\n\r\n        }\r\n        else {\r\n\r\n          material = _depthMaterial;\r\n\r\n        }\r\n\r\n        _renderer.setMaterialFaces(objectMaterial);\r\n\r\n        if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n          _renderer.renderBufferDirect(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n        else {\r\n\r\n          _renderer.renderBuffer(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // set matrices and render immediate objects\r\n\r\n      for (j = 0, jl = _webglObjectsImmediate.length; j < jl; j++) {\r\n\r\n        webglObject = _webglObjectsImmediate[j];\r\n        object = webglObject.object;\r\n\r\n        if (object.visible && object.castShadow) {\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n\r\n          _renderer.renderImmediateObject(shadowCamera, _lights, fog, _depthMaterial, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore GL state\r\n\r\n    var clearColor = _renderer.getClearColor(),\r\n      clearAlpha = _renderer.getClearAlpha();\r\n\r\n    _gl.clearColor(clearColor.r, clearColor.g, clearColor.b, clearAlpha);\r\n    _gl.enable(_gl.BLEND);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function projectObject(scene, object, shadowCamera) {\r\n\r\n    if (object.visible) {\r\n\r\n      var webglObjects = _webglObjects[object.id];\r\n\r\n      if (webglObjects && object.castShadow && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n        for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n          var webglObject = webglObjects[i];\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n          _renderList.push(webglObject);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n        projectObject(scene, object.children[i], shadowCamera);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function createVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = new THREE.DirectionalLight();\r\n\r\n    virtualLight.isVirtual = true;\r\n\r\n    virtualLight.onlyShadow = true;\r\n    virtualLight.castShadow = true;\r\n\r\n    virtualLight.shadowCameraNear = light.shadowCameraNear;\r\n    virtualLight.shadowCameraFar = light.shadowCameraFar;\r\n\r\n    virtualLight.shadowCameraLeft = light.shadowCameraLeft;\r\n    virtualLight.shadowCameraRight = light.shadowCameraRight;\r\n    virtualLight.shadowCameraBottom = light.shadowCameraBottom;\r\n    virtualLight.shadowCameraTop = light.shadowCameraTop;\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n    virtualLight.shadowMapWidth = light.shadowCascadeWidth[cascade];\r\n    virtualLight.shadowMapHeight = light.shadowCascadeHeight[cascade];\r\n\r\n    virtualLight.pointsWorld = [];\r\n    virtualLight.pointsFrustum = [];\r\n\r\n    var pointsWorld = virtualLight.pointsWorld,\r\n      pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      pointsWorld[i] = new THREE.Vector3();\r\n      pointsFrustum[i] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    pointsFrustum[0].set(-1, -1, nearZ);\r\n    pointsFrustum[1].set(1, -1, nearZ);\r\n    pointsFrustum[2].set(-1, 1, nearZ);\r\n    pointsFrustum[3].set(1, 1, nearZ);\r\n\r\n    pointsFrustum[4].set(-1, -1, farZ);\r\n    pointsFrustum[5].set(1, -1, farZ);\r\n    pointsFrustum[6].set(-1, 1, farZ);\r\n    pointsFrustum[7].set(1, 1, farZ);\r\n\r\n    return virtualLight;\r\n\r\n  }\r\n\r\n  // Synchronize virtual light with the original light\r\n\r\n  function updateVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = light.shadowCascadeArray[cascade];\r\n\r\n    virtualLight.position.copy(light.position);\r\n    virtualLight.target.position.copy(light.target.position);\r\n    virtualLight.lookAt(virtualLight.target);\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    var pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    pointsFrustum[0].z = nearZ;\r\n    pointsFrustum[1].z = nearZ;\r\n    pointsFrustum[2].z = nearZ;\r\n    pointsFrustum[3].z = nearZ;\r\n\r\n    pointsFrustum[4].z = farZ;\r\n    pointsFrustum[5].z = farZ;\r\n    pointsFrustum[6].z = farZ;\r\n    pointsFrustum[7].z = farZ;\r\n\r\n  }\r\n\r\n  // Fit shadow camera's ortho frustum to camera frustum\r\n\r\n  function updateShadowCamera(camera, light) {\r\n\r\n    var shadowCamera = light.shadowCamera,\r\n      pointsFrustum = light.pointsFrustum,\r\n      pointsWorld = light.pointsWorld;\r\n\r\n    _min.set(Infinity, Infinity, Infinity);\r\n    _max.set(-Infinity, -Infinity, -Infinity);\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      var p = pointsWorld[i];\r\n\r\n      p.copy(pointsFrustum[i]);\r\n      p.unproject(camera);\r\n\r\n      p.applyMatrix4(shadowCamera.matrixWorldInverse);\r\n\r\n      if (p.x < _min.x) _min.x = p.x;\r\n      if (p.x > _max.x) _max.x = p.x;\r\n\r\n      if (p.y < _min.y) _min.y = p.y;\r\n      if (p.y > _max.y) _max.y = p.y;\r\n\r\n      if (p.z < _min.z) _min.z = p.z;\r\n      if (p.z > _max.z) _max.z = p.z;\r\n\r\n    }\r\n\r\n    shadowCamera.left = _min.x;\r\n    shadowCamera.right = _max.x;\r\n    shadowCamera.top = _max.y;\r\n    shadowCamera.bottom = _min.y;\r\n\r\n    // can't really fit near/far\r\n    //shadowCamera.near = _min.z;\r\n    //shadowCamera.far = _max.z;\r\n\r\n    shadowCamera.updateProjectionMatrix();\r\n\r\n  }\r\n\r\n  // For the moment just ignore objects that have multiple materials with different animation methods\r\n  // Only the first material will be taken into account for deciding which depth material to use for shadow maps\r\n\r\n  function getObjectMaterial(object) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[0] : object.material;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function(renderer, sprites) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n\r\n  var texture;\r\n\r\n  // decompose matrixWorld\r\n\r\n  var spritePosition = new THREE.Vector3();\r\n  var spriteRotation = new THREE.Quaternion();\r\n  var spriteScale = new THREE.Vector3();\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-0.5, -0.5, 0, 0,\r\n      0.5, -0.5, 1, 0,\r\n      0.5, 0.5, 1, 1, -0.5, 0.5, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    program = createProgram();\r\n\r\n    attributes = {\r\n      position: gl.getAttribLocation(program, 'position'),\r\n      uv: gl.getAttribLocation(program, 'uv')\r\n    };\r\n\r\n    uniforms = {\r\n      uvOffset: gl.getUniformLocation(program, 'uvOffset'),\r\n      uvScale: gl.getUniformLocation(program, 'uvScale'),\r\n\r\n      rotation: gl.getUniformLocation(program, 'rotation'),\r\n      scale: gl.getUniformLocation(program, 'scale'),\r\n\r\n      color: gl.getUniformLocation(program, 'color'),\r\n      map: gl.getUniformLocation(program, 'map'),\r\n      opacity: gl.getUniformLocation(program, 'opacity'),\r\n\r\n      modelViewMatrix: gl.getUniformLocation(program, 'modelViewMatrix'),\r\n      projectionMatrix: gl.getUniformLocation(program, 'projectionMatrix'),\r\n\r\n      fogType: gl.getUniformLocation(program, 'fogType'),\r\n      fogDensity: gl.getUniformLocation(program, 'fogDensity'),\r\n      fogNear: gl.getUniformLocation(program, 'fogNear'),\r\n      fogFar: gl.getUniformLocation(program, 'fogFar'),\r\n      fogColor: gl.getUniformLocation(program, 'fogColor'),\r\n\r\n      alphaTest: gl.getUniformLocation(program, 'alphaTest')\r\n    };\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 8;\r\n    canvas.height = 8;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.fillStyle = 'white';\r\n    context.fillRect(0, 0, 8, 8);\r\n\r\n    texture = new THREE.Texture(canvas);\r\n    texture.needsUpdate = true;\r\n\r\n  };\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (sprites.length === 0) return;\r\n\r\n    // setup gl\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.position);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.enable(gl.BLEND);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.position, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.uniformMatrix4fv(uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n    gl.activeTexture(gl.TEXTURE0);\r\n    gl.uniform1i(uniforms.map, 0);\r\n\r\n    var oldFogType = 0;\r\n    var sceneFogType = 0;\r\n    var fog = scene.fog;\r\n\r\n    if (fog) {\r\n\r\n      gl.uniform3f(uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b);\r\n\r\n      if (fog instanceof THREE.Fog) {\r\n\r\n        gl.uniform1f(uniforms.fogNear, fog.near);\r\n        gl.uniform1f(uniforms.fogFar, fog.far);\r\n\r\n        gl.uniform1i(uniforms.fogType, 1);\r\n        oldFogType = 1;\r\n        sceneFogType = 1;\r\n\r\n      }\r\n      else if (fog instanceof THREE.FogExp2) {\r\n\r\n        gl.uniform1f(uniforms.fogDensity, fog.density);\r\n\r\n        gl.uniform1i(uniforms.fogType, 2);\r\n        oldFogType = 2;\r\n        sceneFogType = 2;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      gl.uniform1i(uniforms.fogType, 0);\r\n      oldFogType = 0;\r\n      sceneFogType = 0;\r\n\r\n    }\r\n\r\n\r\n    // update positions and sort\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n\r\n      sprite._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, sprite.matrixWorld);\r\n      sprite.z = -sprite._modelViewMatrix.elements[14];\r\n\r\n    }\r\n\r\n    sprites.sort(painterSortStable);\r\n\r\n    // render all sprites\r\n\r\n    var scale = [];\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n      var material = sprite.material;\r\n\r\n      gl.uniform1f(uniforms.alphaTest, material.alphaTest);\r\n      gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, sprite._modelViewMatrix.elements);\r\n\r\n      sprite.matrixWorld.decompose(spritePosition, spriteRotation, spriteScale);\r\n\r\n      scale[0] = spriteScale.x;\r\n      scale[1] = spriteScale.y;\r\n\r\n      var fogType = 0;\r\n\r\n      if (scene.fog && material.fog) {\r\n\r\n        fogType = sceneFogType;\r\n\r\n      }\r\n\r\n      if (oldFogType !== fogType) {\r\n\r\n        gl.uniform1i(uniforms.fogType, fogType);\r\n        oldFogType = fogType;\r\n\r\n      }\r\n\r\n      if (material.map !== null) {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, material.map.offset.x, material.map.offset.y);\r\n        gl.uniform2f(uniforms.uvScale, material.map.repeat.x, material.map.repeat.y);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, 0, 0);\r\n        gl.uniform2f(uniforms.uvScale, 1, 1);\r\n\r\n      }\r\n\r\n      gl.uniform1f(uniforms.opacity, material.opacity);\r\n      gl.uniform3f(uniforms.color, material.color.r, material.color.g, material.color.b);\r\n\r\n      gl.uniform1f(uniforms.rotation, material.rotation);\r\n      gl.uniform2fv(uniforms.scale, scale);\r\n\r\n      renderer.state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst);\r\n      renderer.state.setDepthTest(material.depthTest);\r\n      renderer.state.setDepthWrite(material.depthWrite);\r\n\r\n      if (material.map && material.map.image && material.map.image.width) {\r\n\r\n        renderer.setTexture(material.map, 0);\r\n\r\n      }\r\n      else {\r\n\r\n        renderer.setTexture(texture, 0);\r\n\r\n      }\r\n\r\n      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram() {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n\r\n    gl.shaderSource(vertexShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform mat4 modelViewMatrix;',\r\n      'uniform mat4 projectionMatrix;',\r\n      'uniform float rotation;',\r\n      'uniform vec2 scale;',\r\n      'uniform vec2 uvOffset;',\r\n      'uniform vec2 uvScale;',\r\n\r\n      'attribute vec2 position;',\r\n      'attribute vec2 uv;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vUV = uvOffset + uv * uvScale;',\r\n\r\n      'vec2 alignedPosition = position * scale;',\r\n\r\n      'vec2 rotatedPosition;',\r\n      'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n      'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n      'vec4 finalPosition;',\r\n\r\n      'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n      'finalPosition.xy += rotatedPosition;',\r\n      'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n      'gl_Position = finalPosition;',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.shaderSource(fragmentShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform vec3 color;',\r\n      'uniform sampler2D map;',\r\n      'uniform float opacity;',\r\n\r\n      'uniform int fogType;',\r\n      'uniform vec3 fogColor;',\r\n      'uniform float fogDensity;',\r\n      'uniform float fogNear;',\r\n      'uniform float fogFar;',\r\n      'uniform float alphaTest;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vec4 texture = texture2D( map, vUV );',\r\n\r\n      'if ( texture.a < alphaTest ) discard;',\r\n\r\n      'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n      'if ( fogType > 0 ) {',\r\n\r\n      'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n      'float fogFactor = 0.0;',\r\n\r\n      'if ( fogType == 1 ) {',\r\n\r\n      'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n      '} else {',\r\n\r\n      'const float LOG2 = 1.442695;',\r\n      'float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n      'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n      '}',\r\n\r\n      'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n      '}',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.compileShader(vertexShader);\r\n    gl.compileShader(fragmentShader);\r\n\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  };\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return b.id - a.id;\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/extras/GeometryUtils.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n  merge: function(geometry1, geometry2, materialIndexOffset) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');\r\n\r\n    var matrix;\r\n\r\n    if (geometry2 instanceof THREE.Mesh) {\r\n\r\n      geometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n      matrix = geometry2.matrix;\r\n      geometry2 = geometry2.geometry;\r\n\r\n    }\r\n\r\n    geometry1.merge(geometry2, matrix, materialIndexOffset);\r\n\r\n  },\r\n\r\n  center: function(geometry) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.');\r\n    return geometry.center();\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/ImageUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n */\r\n\r\nTHREE.ImageUtils = {\r\n\r\n  crossOrigin: undefined,\r\n\r\n  loadTexture: function(url, mapping, onLoad, onError) {\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.Texture(undefined, mapping);\r\n\r\n    loader.load(url, function(image) {\r\n\r\n      texture.image = image;\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture);\r\n\r\n    }, undefined, function(event) {\r\n\r\n      if (onError) onError(event);\r\n\r\n    });\r\n\r\n    texture.sourceFile = url;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadTextureCube: function(array, mapping, onLoad, onError) {\r\n\r\n    var images = [];\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.CubeTexture(images, mapping);\r\n\r\n    // no flipping needed for cube textures\r\n\r\n    texture.flipY = false;\r\n\r\n    var loaded = 0;\r\n\r\n    var loadTexture = function(i) {\r\n\r\n      loader.load(array[i], function(image) {\r\n\r\n        texture.images[i] = image;\r\n\r\n        loaded += 1;\r\n\r\n        if (loaded === 6) {\r\n\r\n          texture.needsUpdate = true;\r\n\r\n          if (onLoad) onLoad(texture);\r\n\r\n        }\r\n\r\n      }, undefined, onError);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n\r\n      loadTexture(i);\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadCompressedTexture: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  loadCompressedTextureCube: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  getNormalMap: function(image, depth) {\r\n\r\n    // Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\r\n\r\n    var cross = function(a, b) {\r\n\r\n      return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\r\n\r\n    }\r\n\r\n    var subtract = function(a, b) {\r\n\r\n      return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\r\n\r\n    }\r\n\r\n    var normalize = function(a) {\r\n\r\n      var l = Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2]);\r\n      return [a[0] / l, a[1] / l, a[2] / l];\r\n\r\n    }\r\n\r\n    depth = depth | 1;\r\n\r\n    var width = image.width;\r\n    var height = image.height;\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.drawImage(image, 0, 0);\r\n\r\n    var data = context.getImageData(0, 0, width, height).data;\r\n    var imageData = context.createImageData(width, height);\r\n    var output = imageData.data;\r\n\r\n    for (var x = 0; x < width; x++) {\r\n\r\n      for (var y = 0; y < height; y++) {\r\n\r\n        var ly = y - 1 < 0 ? 0 : y - 1;\r\n        var uy = y + 1 > height - 1 ? height - 1 : y + 1;\r\n        var lx = x - 1 < 0 ? 0 : x - 1;\r\n        var ux = x + 1 > width - 1 ? width - 1 : x + 1;\r\n\r\n        var points = [];\r\n        var origin = [0, 0, data[(y * width + x) * 4] / 255 * depth];\r\n        points.push([-1, 0, data[(y * width + lx) * 4] / 255 * depth]);\r\n        points.push([-1, -1, data[(ly * width + lx) * 4] / 255 * depth]);\r\n        points.push([0, -1, data[(ly * width + x) * 4] / 255 * depth]);\r\n        points.push([1, -1, data[(ly * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 0, data[(y * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 1, data[(uy * width + ux) * 4] / 255 * depth]);\r\n        points.push([0, 1, data[(uy * width + x) * 4] / 255 * depth]);\r\n        points.push([-1, 1, data[(uy * width + lx) * 4] / 255 * depth]);\r\n\r\n        var normals = [];\r\n        var num_points = points.length;\r\n\r\n        for (var i = 0; i < num_points; i++) {\r\n\r\n          var v1 = points[i];\r\n          var v2 = points[(i + 1) % num_points];\r\n          v1 = subtract(v1, origin);\r\n          v2 = subtract(v2, origin);\r\n          normals.push(normalize(cross(v1, v2)));\r\n\r\n        }\r\n\r\n        var normal = [0, 0, 0];\r\n\r\n        for (var i = 0; i < normals.length; i++) {\r\n\r\n          normal[0] += normals[i][0];\r\n          normal[1] += normals[i][1];\r\n          normal[2] += normals[i][2];\r\n\r\n        }\r\n\r\n        normal[0] /= normals.length;\r\n        normal[1] /= normals.length;\r\n        normal[2] /= normals.length;\r\n\r\n        var idx = (y * width + x) * 4;\r\n\r\n        output[idx] = ((normal[0] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 1] = ((normal[1] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 2] = (normal[2] * 255) | 0;\r\n        output[idx + 3] = 255;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    return canvas;\r\n\r\n  },\r\n\r\n  generateDataTexture: function(width, height, color) {\r\n\r\n    var size = width * height;\r\n    var data = new Uint8Array(3 * size);\r\n\r\n    var r = Math.floor(color.r * 255);\r\n    var g = Math.floor(color.g * 255);\r\n    var b = Math.floor(color.b * 255);\r\n\r\n    for (var i = 0; i < size; i++) {\r\n\r\n      data[i * 3] = r;\r\n      data[i * 3 + 1] = g;\r\n      data[i * 3 + 2] = b;\r\n\r\n    }\r\n\r\n    var texture = new THREE.DataTexture(data, width, height, THREE.RGBFormat);\r\n    texture.needsUpdate = true;\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n  createMultiMaterialObject: function(geometry, materials) {\r\n\r\n    var group = new THREE.Object3D();\r\n\r\n    for (var i = 0, l = materials.length; i < l; i++) {\r\n\r\n      group.add(new THREE.Mesh(geometry, materials[i]));\r\n\r\n    }\r\n\r\n    return group;\r\n\r\n  },\r\n\r\n  detach: function(child, parent, scene) {\r\n\r\n    child.applyMatrix(parent.matrixWorld);\r\n    parent.remove(child);\r\n    scene.add(child);\r\n\r\n  },\r\n\r\n  attach: function(child, scene, parent) {\r\n\r\n    var matrixWorldInverse = new THREE.Matrix4();\r\n    matrixWorldInverse.getInverse(parent.matrixWorld);\r\n    child.applyMatrix(matrixWorldInverse);\r\n\r\n    scene.remove(child);\r\n    parent.add(child);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/FontUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For Text operations in three.js (See TextGeometry)\r\n *\r\n * It uses techniques used in:\r\n *\r\n * \ttypeface.js and canvastext\r\n * \t\tFor converting fonts and rendering with javascript\r\n *\t\thttp://typeface.neocracy.org\r\n *\r\n *\tTriangulation ported from AS3\r\n *\t\tSimple Polygon Triangulation\r\n *\t\thttp://actionsnippet.com/?p=1462\r\n *\r\n * \tA Method to triangulate shapes with holes\r\n *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\r\n *\r\n */\r\n\r\nTHREE.FontUtils = {\r\n\r\n  faces: {},\r\n\r\n  // Just for now. face[weight][style]\r\n\r\n  face: 'helvetiker',\r\n  weight: 'normal',\r\n  style: 'normal',\r\n  size: 150,\r\n  divisions: 10,\r\n\r\n  getFace: function() {\r\n\r\n    try {\r\n\r\n      return this.faces[this.face][this.weight][this.style];\r\n\r\n    }\r\n    catch (e) {\r\n\r\n      throw \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\"\r\n\r\n    };\r\n\r\n  },\r\n\r\n  loadFace: function(data) {\r\n\r\n    var family = data.familyName.toLowerCase();\r\n\r\n    var ThreeFont = this;\r\n\r\n    ThreeFont.faces[family] = ThreeFont.faces[family] || {};\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight] = ThreeFont.faces[family][data.cssFontWeight] || {};\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  drawText: function(text) {\r\n\r\n    // RenderText\r\n\r\n    var i,\r\n      face = this.getFace(),\r\n      scale = this.size / face.resolution,\r\n      offset = 0,\r\n      chars = String(text).split(''),\r\n      length = chars.length;\r\n\r\n    var fontPaths = [];\r\n\r\n    for (i = 0; i < length; i++) {\r\n\r\n      var path = new THREE.Path();\r\n\r\n      var ret = this.extractGlyphPoints(chars[i], face, scale, offset, path);\r\n      offset += ret.offset;\r\n\r\n      fontPaths.push(ret.path);\r\n\r\n    }\r\n\r\n    // get the width\r\n\r\n    var width = offset / 2;\r\n    //\r\n    // for ( p = 0; p < allPts.length; p++ ) {\r\n    //\r\n    // \tallPts[ p ].x -= width;\r\n    //\r\n    // }\r\n\r\n    //var extract = this.extractPoints( allPts, characterPts );\r\n    //extract.contour = allPts;\r\n\r\n    //extract.paths = fontPaths;\r\n    //extract.offset = width;\r\n\r\n    return {\r\n      paths: fontPaths,\r\n      offset: width\r\n    };\r\n\r\n  },\r\n\r\n\r\n\r\n\r\n  extractGlyphPoints: function(c, face, scale, offset, path) {\r\n\r\n    var pts = [];\r\n\r\n    var i, i2, divisions,\r\n      outline, action, length,\r\n      scaleX, scaleY,\r\n      x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2,\r\n      laste,\r\n      glyph = face.glyphs[c] || face.glyphs['?'];\r\n\r\n    if (!glyph) return;\r\n\r\n    if (glyph.o) {\r\n\r\n      outline = glyph._cachedOutline || (glyph._cachedOutline = glyph.o.split(' '));\r\n      length = outline.length;\r\n\r\n      scaleX = scale;\r\n      scaleY = scale;\r\n\r\n      for (i = 0; i < length;) {\r\n\r\n        action = outline[i++];\r\n\r\n        //console.log( action );\r\n\r\n        switch (action) {\r\n\r\n          case 'm':\r\n\r\n            // Move To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n\r\n            path.moveTo(x, y);\r\n            break;\r\n\r\n          case 'l':\r\n\r\n            // Line To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n            path.lineTo(x, y);\r\n            break;\r\n\r\n          case 'q':\r\n\r\n            // QuadraticCurveTo\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n\r\n            path.quadraticCurveTo(cpx1, cpy1, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n                THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n          case 'b':\r\n\r\n            // Cubic Bezier Curve\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n            cpx2 = outline[i++] * scaleX + offset;\r\n            cpy2 = outline[i++] * scaleY;\r\n\r\n            path.bezierCurveTo(cpx1, cpy1, cpx2, cpy2, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n                THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n\r\n\r\n    return {\r\n      offset: glyph.ha * scale,\r\n      path: path\r\n    };\r\n  }\r\n\r\n};\r\n\r\n\r\nTHREE.FontUtils.generateShapes = function(text, parameters) {\r\n\r\n  // Parameters \r\n\r\n  parameters = parameters || {};\r\n\r\n  var size = parameters.size !== undefined ? parameters.size : 100;\r\n  var curveSegments = parameters.curveSegments !== undefined ? parameters.curveSegments : 4;\r\n\r\n  var font = parameters.font !== undefined ? parameters.font : 'helvetiker';\r\n  var weight = parameters.weight !== undefined ? parameters.weight : 'normal';\r\n  var style = parameters.style !== undefined ? parameters.style : 'normal';\r\n\r\n  THREE.FontUtils.size = size;\r\n  THREE.FontUtils.divisions = curveSegments;\r\n\r\n  THREE.FontUtils.face = font;\r\n  THREE.FontUtils.weight = weight;\r\n  THREE.FontUtils.style = style;\r\n\r\n  // Get a Font data json object\r\n\r\n  var data = THREE.FontUtils.drawText(text);\r\n\r\n  var paths = data.paths;\r\n  var shapes = [];\r\n\r\n  for (var p = 0, pl = paths.length; p < pl; p++) {\r\n\r\n    Array.prototype.push.apply(shapes, paths[p].toShapes());\r\n\r\n  }\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n\r\n/**\r\n * This code is a quick port of code written in C++ which was submitted to\r\n * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n * See original code and more information here:\r\n * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n *\r\n * ported to actionscript by Zevan Rosser\r\n * www.actionsnippet.com\r\n *\r\n * ported to javascript by Joshua Koo\r\n * http://www.lab4games.net/zz85/blog\r\n *\r\n */\r\n\r\n\r\n(function(namespace) {\r\n\r\n  var EPSILON = 0.0000000001;\r\n\r\n  // takes in an contour array and returns\r\n\r\n  var process = function(contour, indices) {\r\n\r\n    var n = contour.length;\r\n\r\n    if (n < 3) return null;\r\n\r\n    var result = [],\r\n      verts = [],\r\n      vertIndices = [];\r\n\r\n    /* we want a counter-clockwise polygon in verts */\r\n\r\n    var u, v, w;\r\n\r\n    if (area(contour) > 0.0) {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = v;\r\n\r\n    }\r\n    else {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = (n - 1) - v;\r\n\r\n    }\r\n\r\n    var nv = n;\r\n\r\n    /*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n    var count = 2 * nv; /* error detection */\r\n\r\n    for (v = nv - 1; nv > 2;) {\r\n\r\n      /* if we loop, it is probably a non-simple polygon */\r\n\r\n      if ((count--) <= 0) {\r\n\r\n        //** Triangulate: ERROR - probable bad polygon!\r\n\r\n        //throw ( \"Warning, unable to triangulate polygon!\" );\r\n        //return null;\r\n        // Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n        THREE.warn('THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()');\r\n\r\n        if (indices) return vertIndices;\r\n        return result;\r\n\r\n      }\r\n\r\n      /* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n      u = v;\r\n      if (nv <= u) u = 0; /* previous */\r\n      v = u + 1;\r\n      if (nv <= v) v = 0; /* new v    */\r\n      w = v + 1;\r\n      if (nv <= w) w = 0; /* next     */\r\n\r\n      if (snip(contour, u, v, w, nv, verts)) {\r\n\r\n        var a, b, c, s, t;\r\n\r\n        /* true names of the vertices */\r\n\r\n        a = verts[u];\r\n        b = verts[v];\r\n        c = verts[w];\r\n\r\n        /* output Triangle */\r\n\r\n        result.push([contour[a],\r\n          contour[b],\r\n          contour[c]\r\n        ]);\r\n\r\n\r\n        vertIndices.push([verts[u], verts[v], verts[w]]);\r\n\r\n        /* remove v from the remaining polygon */\r\n\r\n        for (s = v, t = v + 1; t < nv; s++, t++) {\r\n\r\n          verts[s] = verts[t];\r\n\r\n        }\r\n\r\n        nv--;\r\n\r\n        /* reset error detection counter */\r\n\r\n        count = 2 * nv;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (indices) return vertIndices;\r\n    return result;\r\n\r\n  };\r\n\r\n  // calculate area of the contour polygon\r\n\r\n  var area = function(contour) {\r\n\r\n    var n = contour.length;\r\n    var a = 0.0;\r\n\r\n    for (var p = n - 1, q = 0; q < n; p = q++) {\r\n\r\n      a += contour[p].x * contour[q].y - contour[q].x * contour[p].y;\r\n\r\n    }\r\n\r\n    return a * 0.5;\r\n\r\n  };\r\n\r\n  var snip = function(contour, u, v, w, n, verts) {\r\n\r\n    var p;\r\n    var ax, ay, bx, by;\r\n    var cx, cy, px, py;\r\n\r\n    ax = contour[verts[u]].x;\r\n    ay = contour[verts[u]].y;\r\n\r\n    bx = contour[verts[v]].x;\r\n    by = contour[verts[v]].y;\r\n\r\n    cx = contour[verts[w]].x;\r\n    cy = contour[verts[w]].y;\r\n\r\n    if (EPSILON > (((bx - ax) * (cy - ay)) - ((by - ay) * (cx - ax)))) return false;\r\n\r\n    var aX, aY, bX, bY, cX, cY;\r\n    var apx, apy, bpx, bpy, cpx, cpy;\r\n    var cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n    aX = cx - bx;\r\n    aY = cy - by;\r\n    bX = ax - cx;\r\n    bY = ay - cy;\r\n    cX = bx - ax;\r\n    cY = by - ay;\r\n\r\n    for (p = 0; p < n; p++) {\r\n\r\n      px = contour[verts[p]].x\r\n      py = contour[verts[p]].y\r\n\r\n      if (((px === ax) && (py === ay)) ||\r\n        ((px === bx) && (py === by)) ||\r\n        ((px === cx) && (py === cy))) continue;\r\n\r\n      apx = px - ax;\r\n      apy = py - ay;\r\n      bpx = px - bx;\r\n      bpy = py - by;\r\n      cpx = px - cx;\r\n      cpy = py - cy;\r\n\r\n      // see if p is inside triangle abc\r\n\r\n      aCROSSbp = aX * bpy - aY * bpx;\r\n      cCROSSap = cX * apy - cY * apx;\r\n      bCROSScp = bX * cpy - bY * cpx;\r\n\r\n      if ((aCROSSbp >= -EPSILON) && (bCROSScp >= -EPSILON) && (cCROSSap >= -EPSILON)) return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n\r\n  namespace.Triangulate = process;\r\n  namespace.Triangulate.area = area;\r\n\r\n  return namespace;\r\n\r\n})(THREE.FontUtils);\r\n\r\n// To use the typeface.js face files, hook up the API\r\nself._typeface_js = {\r\n  faces: THREE.FontUtils.faces,\r\n  loadFace: THREE.FontUtils.loadFace\r\n};\r\nTHREE.typeface_js = self._typeface_js;\r\n\r\n// File:src/extras/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Audio = function(listener) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Audio';\r\n\r\n  this.context = listener.context;\r\n  this.source = this.context.createBufferSource();\r\n  this.source.onended = this.onEnded.bind(this);\r\n\r\n  this.gain = this.context.createGain();\r\n  this.gain.connect(this.context.destination);\r\n\r\n  this.panner = this.context.createPanner();\r\n  this.panner.connect(this.gain);\r\n\r\n  this.autoplay = false;\r\n\r\n  this.startTime = 0;\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.load = function(file) {\r\n\r\n  var scope = this;\r\n\r\n  var request = new XMLHttpRequest();\r\n  request.open('GET', file, true);\r\n  request.responseType = 'arraybuffer';\r\n  request.onload = function(e) {\r\n\r\n    scope.context.decodeAudioData(this.response, function(buffer) {\r\n\r\n      scope.source.buffer = buffer;\r\n\r\n      if (scope.autoplay) scope.play();\r\n\r\n    });\r\n\r\n  };\r\n  request.send();\r\n\r\n  return this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function() {\r\n\r\n  if (this.isPlaying === true) {\r\n\r\n    THREE.warn('THREE.Audio: Audio is already playing.');\r\n    return;\r\n\r\n  }\r\n\r\n  var source = this.context.createBufferSource();\r\n\r\n  source.buffer = this.source.buffer;\r\n  source.loop = this.source.loop;\r\n  source.onended = this.source.onended;\r\n  source.connect(this.panner);\r\n  source.start(0, this.startTime);\r\n\r\n  this.isPlaying = true;\r\n\r\n  this.source = source;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function() {\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function(value) {\r\n\r\n  this.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRefDistance = function(value) {\r\n\r\n  this.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRolloffFactor = function(value) {\r\n\r\n  this.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setVolume = function(value) {\r\n\r\n  this.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    position.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    this.panner.setPosition(position.x, position.y, position.z);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'AudioListener';\r\n\r\n  this.context = new(window.AudioContext || window.webkitAudioContext)();\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3();\r\n\r\n  var orientation = new THREE.Vector3();\r\n  var velocity = new THREE.Vector3();\r\n\r\n  var positionPrev = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    var listener = this.context.listener;\r\n    var up = this.up;\r\n\r\n    this.matrixWorld.decompose(position, quaternion, scale);\r\n\r\n    orientation.set(0, 0, -1).applyQuaternion(quaternion);\r\n    velocity.subVectors(position, positionPrev);\r\n\r\n    listener.setPosition(position.x, position.y, position.z);\r\n    listener.setOrientation(orientation.x, orientation.y, orientation.z, up.x, up.y, up.z);\r\n    listener.setVelocity(velocity.x, velocity.y, velocity.z);\r\n\r\n    positionPrev.copy(position);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n * THREE.ClosedSplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function() {\r\n\r\n};\r\n\r\n// Virtual base class method to overwrite and implement in subclasses\r\n//\t- t [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPoint = function(t) {\r\n\r\n  THREE.warn(\"THREE.Curve: Warning, getPoint() not implemented!\");\r\n  return null;\r\n\r\n};\r\n\r\n// Get point at relative position in curve according to arc length\r\n// - u [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPointAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getPoint(t);\r\n\r\n};\r\n\r\n// Get sequence of points using getPoint( t )\r\n\r\nTHREE.Curve.prototype.getPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPoint(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get sequence of points using getPointAt( u )\r\n\r\nTHREE.Curve.prototype.getSpacedPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPointAt(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get total curve arc length\r\n\r\nTHREE.Curve.prototype.getLength = function() {\r\n\r\n  var lengths = this.getLengths();\r\n  return lengths[lengths.length - 1];\r\n\r\n};\r\n\r\n// Get list of cumulative segment lengths\r\n\r\nTHREE.Curve.prototype.getLengths = function(divisions) {\r\n\r\n  if (!divisions) divisions = (this.__arcLengthDivisions) ? (this.__arcLengthDivisions) : 200;\r\n\r\n  if (this.cacheArcLengths && (this.cacheArcLengths.length == divisions + 1) && !this.needsUpdate) {\r\n\r\n    //console.log( \"cached\", this.cacheArcLengths );\r\n    return this.cacheArcLengths;\r\n\r\n  }\r\n\r\n  this.needsUpdate = false;\r\n\r\n  var cache = [];\r\n  var current, last = this.getPoint(0);\r\n  var p, sum = 0;\r\n\r\n  cache.push(0);\r\n\r\n  for (p = 1; p <= divisions; p++) {\r\n\r\n    current = this.getPoint(p / divisions);\r\n    sum += current.distanceTo(last);\r\n    cache.push(sum);\r\n    last = current;\r\n\r\n  }\r\n\r\n  this.cacheArcLengths = cache;\r\n\r\n  return cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.updateArcLengths = function() {\r\n  this.needsUpdate = true;\r\n  this.getLengths();\r\n};\r\n\r\n// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equi distance\r\n\r\nTHREE.Curve.prototype.getUtoTmapping = function(u, distance) {\r\n\r\n  var arcLengths = this.getLengths();\r\n\r\n  var i = 0,\r\n    il = arcLengths.length;\r\n\r\n  var targetArcLength; // The targeted u distance value to get\r\n\r\n  if (distance) {\r\n\r\n    targetArcLength = distance;\r\n\r\n  }\r\n  else {\r\n\r\n    targetArcLength = u * arcLengths[il - 1];\r\n\r\n  }\r\n\r\n  //var time = Date.now();\r\n\r\n  // binary search for the index with largest value smaller than target u distance\r\n\r\n  var low = 0,\r\n    high = il - 1,\r\n    comparison;\r\n\r\n  while (low <= high) {\r\n\r\n    i = Math.floor(low + (high - low) / 2); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n    comparison = arcLengths[i] - targetArcLength;\r\n\r\n    if (comparison < 0) {\r\n\r\n      low = i + 1;\r\n\r\n    }\r\n    else if (comparison > 0) {\r\n\r\n      high = i - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      high = i;\r\n      break;\r\n\r\n      // DONE\r\n\r\n    }\r\n\r\n  }\r\n\r\n  i = high;\r\n\r\n  //console.log('b' , i, low, high, Date.now()- time);\r\n\r\n  if (arcLengths[i] == targetArcLength) {\r\n\r\n    var t = i / (il - 1);\r\n    return t;\r\n\r\n  }\r\n\r\n  // we could get finer grain at lengths, or use simple interpolatation between two points\r\n\r\n  var lengthBefore = arcLengths[i];\r\n  var lengthAfter = arcLengths[i + 1];\r\n\r\n  var segmentLength = lengthAfter - lengthBefore;\r\n\r\n  // determine where we are between the 'before' and 'after' points\r\n\r\n  var segmentFraction = (targetArcLength - lengthBefore) / segmentLength;\r\n\r\n  // add that fractional amount to t\r\n\r\n  var t = (i + segmentFraction) / (il - 1);\r\n\r\n  return t;\r\n\r\n};\r\n\r\n// Returns a unit vector tangent at t\r\n// In case any sub curve does not implement its tangent derivation,\r\n// 2 points a small delta apart will be used to find its gradient\r\n// which seems to give a reasonable approximation\r\n\r\nTHREE.Curve.prototype.getTangent = function(t) {\r\n\r\n  var delta = 0.0001;\r\n  var t1 = t - delta;\r\n  var t2 = t + delta;\r\n\r\n  // Capping in case of danger\r\n\r\n  if (t1 < 0) t1 = 0;\r\n  if (t2 > 1) t2 = 1;\r\n\r\n  var pt1 = this.getPoint(t1);\r\n  var pt2 = this.getPoint(t2);\r\n\r\n  var vec = pt2.clone().sub(pt1);\r\n  return vec.normalize();\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.getTangentAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getTangent(t);\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Curve.Utils = {\r\n\r\n  tangentQuadraticBezier: function(t, p0, p1, p2) {\r\n\r\n    return 2 * (1 - t) * (p1 - p0) + 2 * t * (p2 - p1);\r\n\r\n  },\r\n\r\n  // Puay Bing, thanks for helping with this derivative!\r\n\r\n  tangentCubicBezier: function(t, p0, p1, p2, p3) {\r\n\r\n    return -3 * p0 * (1 - t) * (1 - t) +\r\n      3 * p1 * (1 - t) * (1 - t) - 6 * t * p1 * (1 - t) +\r\n      6 * t * p2 * (1 - t) - 3 * t * t * p2 +\r\n      3 * t * t * p3;\r\n\r\n  },\r\n\r\n  tangentSpline: function(t, p0, p1, p2, p3) {\r\n\r\n    // To check if my formulas are correct\r\n\r\n    var h00 = 6 * t * t - 6 * t; // derived from 2t^3 − 3t^2 + 1\r\n    var h10 = 3 * t * t - 4 * t + 1; // t^3 − 2t^2 + t\r\n    var h01 = -6 * t * t + 6 * t; // − 2t3 + 3t2\r\n    var h11 = 3 * t * t - 2 * t; // t3 − t2\r\n\r\n    return h00 + h10 + h01 + h11;\r\n\r\n  },\r\n\r\n  // Catmull-Rom\r\n\r\n  interpolate: function(p0, p1, p2, p3, t) {\r\n\r\n    var v0 = (p2 - p0) * 0.5;\r\n    var v1 = (p3 - p1) * 0.5;\r\n    var t2 = t * t;\r\n    var t3 = t * t2;\r\n    return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function(constructor, getPointFunc) {\r\n\r\n  constructor.prototype = Object.create(THREE.Curve.prototype);\r\n  constructor.prototype.constructor = constructor;\r\n  constructor.prototype.getPoint = getPointFunc;\r\n\r\n  return constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function() {\r\n\r\n  this.curves = [];\r\n  this.bends = [];\r\n\r\n  this.autoClose = false; // Automatically closes the path\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function(curve) {\r\n\r\n  this.curves.push(curve);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n  // TODO\r\n  // If the ending of curve is not connected to the starting\r\n  // or the next curve, then, this is not a real path\r\n};\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n  // TODO Test\r\n  // and verify for vector3 (needs to implement equals)\r\n  // Add a line curve if start and end of lines are not connected\r\n  var startPoint = this.curves[0].getPoint(0);\r\n  var endPoint = this.curves[this.curves.length - 1].getPoint(1);\r\n\r\n  if (!startPoint.equals(endPoint)) {\r\n    this.curves.push(new THREE.LineCurve(endPoint, startPoint));\r\n  }\r\n\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function(t) {\r\n\r\n  var d = t * this.getLength();\r\n  var curveLengths = this.getCurveLengths();\r\n  var i = 0,\r\n    diff, curve;\r\n\r\n  // To think about boundaries points.\r\n\r\n  while (i < curveLengths.length) {\r\n\r\n    if (curveLengths[i] >= d) {\r\n\r\n      diff = curveLengths[i] - d;\r\n      curve = this.curves[i];\r\n\r\n      var u = 1 - diff / curve.getLength();\r\n\r\n      return curve.getPointAt(u);\r\n\r\n    }\r\n\r\n    i++;\r\n\r\n  }\r\n\r\n  return null;\r\n\r\n  // loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};*/\r\n\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n  var lens = this.getCurveLengths();\r\n  return lens[lens.length - 1];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n  // We use cache values if curves and cache array are same length\r\n\r\n  if (this.cacheLengths && this.cacheLengths.length == this.curves.length) {\r\n\r\n    return this.cacheLengths;\r\n\r\n  };\r\n\r\n  // Get length of subsurve\r\n  // Push sums into cached array\r\n\r\n  var lengths = [],\r\n    sums = 0;\r\n  var i, il = this.curves.length;\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    sums += this.curves[i].getLength();\r\n    lengths.push(sums);\r\n\r\n  }\r\n\r\n  this.cacheLengths = lengths;\r\n\r\n  return lengths;\r\n\r\n};\r\n\r\n\r\n\r\n// Returns min and max coordinates\r\n\r\nTHREE.CurvePath.prototype.getBoundingBox = function() {\r\n\r\n  var points = this.getPoints();\r\n\r\n  var maxX, maxY, maxZ;\r\n  var minX, minY, minZ;\r\n\r\n  maxX = maxY = Number.NEGATIVE_INFINITY;\r\n  minX = minY = Number.POSITIVE_INFINITY;\r\n\r\n  var p, i, il, sum;\r\n\r\n  var v3 = points[0] instanceof THREE.Vector3;\r\n\r\n  sum = v3 ? new THREE.Vector3() : new THREE.Vector2();\r\n\r\n  for (i = 0, il = points.length; i < il; i++) {\r\n\r\n    p = points[i];\r\n\r\n    if (p.x > maxX) maxX = p.x;\r\n    else if (p.x < minX) minX = p.x;\r\n\r\n    if (p.y > maxY) maxY = p.y;\r\n    else if (p.y < minY) minY = p.y;\r\n\r\n    if (v3) {\r\n\r\n      if (p.z > maxZ) maxZ = p.z;\r\n      else if (p.z < minZ) minZ = p.z;\r\n\r\n    }\r\n\r\n    sum.add(p);\r\n\r\n  }\r\n\r\n  var ret = {\r\n\r\n    minX: minX,\r\n    minY: minY,\r\n    maxX: maxX,\r\n    maxY: maxY\r\n\r\n  };\r\n\r\n  if (v3) {\r\n\r\n    ret.maxZ = maxZ;\r\n    ret.minZ = minZ;\r\n\r\n  }\r\n\r\n  return ret;\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\n// Generate geometry from equidistance sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getSpacedPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function(points) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < points.length; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(points[i].x, points[i].y, points[i].z || 0));\r\n\r\n  }\r\n\r\n  return geometry;\r\n\r\n};\r\n\r\n\r\n/**************************************************************\r\n *\tBend / Wrap Helper Methods\r\n **************************************************************/\r\n\r\n// Wrap path / Bend modifiers?\r\n\r\nTHREE.CurvePath.prototype.addWrapPath = function(bendpath) {\r\n\r\n  this.bends.push(bendpath);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getPoints(segments); // getPoints getSpacedPoints\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedSpacedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getSpacedPoints(segments);\r\n\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n// This returns getPoints() bend/wrapped around the contour of a path.\r\n// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\r\n\r\nTHREE.CurvePath.prototype.getWrapPoints = function(oldPts, path) {\r\n\r\n  var bounds = this.getBoundingBox();\r\n\r\n  var i, il, p, oldX, oldY, xNorm;\r\n\r\n  for (i = 0, il = oldPts.length; i < il; i++) {\r\n\r\n    p = oldPts[i];\r\n\r\n    oldX = p.x;\r\n    oldY = p.y;\r\n\r\n    xNorm = oldX / bounds.maxX;\r\n\r\n    // If using actual distance, for length > path, requires line extrusions\r\n    //xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\r\n\r\n    xNorm = path.getUtoTmapping(xNorm, oldX);\r\n\r\n    // check for out of bounds?\r\n\r\n    var pathPt = path.getPoint(xNorm);\r\n    var normal = path.getTangent(xNorm);\r\n    normal.set(-normal.y, normal.x).multiplyScalar(oldY);\r\n\r\n    p.x = pathPt.x + normal.x;\r\n    p.y = pathPt.y + normal.y;\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/core/Gyroscope.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Gyroscope = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n};\r\n\r\nTHREE.Gyroscope.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Gyroscope.prototype.constructor = THREE.Gyroscope;\r\n\r\nTHREE.Gyroscope.prototype.updateMatrixWorld = (function() {\r\n\r\n  var translationObject = new THREE.Vector3();\r\n  var quaternionObject = new THREE.Quaternion();\r\n  var scaleObject = new THREE.Vector3();\r\n\r\n  var translationWorld = new THREE.Vector3();\r\n  var quaternionWorld = new THREE.Quaternion();\r\n  var scaleWorld = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    this.matrixAutoUpdate && this.updateMatrix();\r\n\r\n    // update matrixWorld\r\n\r\n    if (this.matrixWorldNeedsUpdate || force) {\r\n\r\n      if (this.parent) {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n        this.matrixWorld.decompose(translationWorld, quaternionWorld, scaleWorld);\r\n        this.matrix.decompose(translationObject, quaternionObject, scaleObject);\r\n\r\n        this.matrixWorld.compose(translationWorld, quaternionObject, scaleWorld);\r\n\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function(points) {\r\n\r\n  THREE.CurvePath.call(this);\r\n\r\n  this.actions = [];\r\n\r\n  if (points) {\r\n\r\n    this.fromPoints(points);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create(THREE.CurvePath.prototype);\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\nTHREE.PathActions = {\r\n\r\n  MOVE_TO: 'moveTo',\r\n  LINE_TO: 'lineTo',\r\n  QUADRATIC_CURVE_TO: 'quadraticCurveTo', // Bezier quadratic curve\r\n  BEZIER_CURVE_TO: 'bezierCurveTo', // Bezier cubic curve\r\n  CSPLINE_THRU: 'splineThru', // Catmull-rom spline\r\n  ARC: 'arc', // Circle\r\n  ELLIPSE: 'ellipse'\r\n};\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function(vectors) {\r\n\r\n  this.moveTo(vectors[0].x, vectors[0].y);\r\n\r\n  for (var v = 1, vlen = vectors.length; v < vlen; v++) {\r\n\r\n    this.lineTo(vectors[v].x, vectors[v].y);\r\n\r\n  };\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  this.actions.push({\r\n    action: THREE.PathActions.MOVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.LineCurve(new THREE.Vector2(x0, y0), new THREE.Vector2(x, y));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.LINE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.QuadraticBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCPx, aCPy),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.QUADRATIC_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function(aCP1x, aCP1y,\r\n  aCP2x, aCP2y,\r\n  aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.CubicBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCP1x, aCP1y),\r\n    new THREE.Vector2(aCP2x, aCP2y),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.BEZIER_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function(pts /*Array of Vector*/ ) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n  //---\r\n  var npts = [new THREE.Vector2(x0, y0)];\r\n  Array.prototype.push.apply(npts, pts);\r\n\r\n  var curve = new THREE.SplineCurve(npts);\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.CSPLINE_THRU,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absarc(aX + x0, aY + y0, aRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\nTHREE.Path.prototype.absarc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n  this.absellipse(aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.Path.prototype.ellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absellipse(aX + x0, aY + y0, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var curve = new THREE.EllipseCurve(aX, aY, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n  this.curves.push(curve);\r\n\r\n  var lastPoint = curve.getPoint(1);\r\n  args.push(lastPoint.x);\r\n  args.push(lastPoint.y);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.ELLIPSE,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function(divisions, closedPath) {\r\n\r\n  if (!divisions) divisions = 40;\r\n\r\n  var points = [];\r\n\r\n  for (var i = 0; i < divisions; i++) {\r\n\r\n    points.push(this.getPoint(i / divisions));\r\n\r\n    //if( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n  }\r\n\r\n  // if ( closedPath ) {\r\n  //\r\n  // \tpoints.push( points[ 0 ] );\r\n  //\r\n  // }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function(divisions, closedPath) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    console.log('tata');\r\n    return this.getSpacedPoints(divisions, closedPath);\r\n  }\r\n\r\n  divisions = divisions || 12;\r\n\r\n  var points = [];\r\n\r\n  var i, il, item, action, args;\r\n  var cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n    laste, j,\r\n    t, tx, ty;\r\n\r\n  for (i = 0, il = this.actions.length; i < il; i++) {\r\n\r\n    item = this.actions[i];\r\n\r\n    action = item.action;\r\n    args = item.args;\r\n\r\n    switch (action) {\r\n\r\n      case THREE.PathActions.MOVE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.LINE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.QUADRATIC_CURVE_TO:\r\n\r\n        cpx = args[2];\r\n        cpy = args[3];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n          ty = THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.BEZIER_CURVE_TO:\r\n\r\n        cpx = args[4];\r\n        cpy = args[5];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        cpx2 = args[2];\r\n        cpy2 = args[3];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n          ty = THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.CSPLINE_THRU:\r\n\r\n        laste = this.actions[i - 1].args;\r\n\r\n        var last = new THREE.Vector2(laste[laste.length - 2], laste[laste.length - 1]);\r\n        var spts = [last];\r\n\r\n        var n = divisions * args[0].length;\r\n\r\n        spts = spts.concat(args[0]);\r\n\r\n        var spline = new THREE.SplineCurve(spts);\r\n\r\n        for (j = 1; j <= n; j++) {\r\n\r\n          points.push(spline.getPointAt(j / n));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ARC:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          aRadius = args[2],\r\n          aStartAngle = args[3],\r\n          aEndAngle = args[4],\r\n          aClockwise = !!args[5];\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + aRadius * Math.cos(angle);\r\n          ty = aY + aRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ELLIPSE:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          xRadius = args[2],\r\n          yRadius = args[3],\r\n          aStartAngle = args[4],\r\n          aEndAngle = args[5],\r\n          aClockwise = !!args[6];\r\n\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + xRadius * Math.cos(angle);\r\n          ty = aY + yRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n    } // end switch\r\n\r\n  }\r\n\r\n\r\n\r\n  // Normalize to remove the closing point by default.\r\n  var lastPoint = points[points.length - 1];\r\n  var EPSILON = 0.0000000001;\r\n  if (Math.abs(lastPoint.x - points[0].x) < EPSILON &&\r\n    Math.abs(lastPoint.y - points[0].y) < EPSILON)\r\n    points.splice(points.length - 1, 1);\r\n  if (closedPath) {\r\n\r\n    points.push(points[0]);\r\n\r\n  }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function(isCCW, noHoles) {\r\n\r\n  function extractSubpaths(inActions) {\r\n\r\n    var i, il, item, action, args;\r\n\r\n    var subPaths = [],\r\n      lastPath = new THREE.Path();\r\n\r\n    for (i = 0, il = inActions.length; i < il; i++) {\r\n\r\n      item = inActions[i];\r\n\r\n      args = item.args;\r\n      action = item.action;\r\n\r\n      if (action == THREE.PathActions.MOVE_TO) {\r\n\r\n        if (lastPath.actions.length != 0) {\r\n\r\n          subPaths.push(lastPath);\r\n          lastPath = new THREE.Path();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      lastPath[action].apply(lastPath, args);\r\n\r\n    }\r\n\r\n    if (lastPath.actions.length != 0) {\r\n\r\n      subPaths.push(lastPath);\r\n\r\n    }\r\n\r\n    // console.log(subPaths);\r\n\r\n    return subPaths;\r\n  }\r\n\r\n  function toShapesNoHoles(inSubpaths) {\r\n\r\n    var shapes = [];\r\n\r\n    for (var i = 0, il = inSubpaths.length; i < il; i++) {\r\n\r\n      var tmpPath = inSubpaths[i];\r\n\r\n      var tmpShape = new THREE.Shape();\r\n      tmpShape.actions = tmpPath.actions;\r\n      tmpShape.curves = tmpPath.curves;\r\n\r\n      shapes.push(tmpShape);\r\n    }\r\n\r\n    //console.log(\"shape\", shapes);\r\n\r\n    return shapes;\r\n  };\r\n\r\n  function isPointInsidePolygon(inPt, inPolygon) {\r\n    var EPSILON = 0.0000000001;\r\n\r\n    var polyLen = inPolygon.length;\r\n\r\n    // inPt on polygon contour => immediate success    or\r\n    // toggling of inside/outside at every single! intersection point of an edge\r\n    //  with the horizontal line through inPt, left of inPt\r\n    //  not counting lowerY endpoints of edges and whole edges on that line\r\n    var inside = false;\r\n    for (var p = polyLen - 1, q = 0; q < polyLen; p = q++) {\r\n      var edgeLowPt = inPolygon[p];\r\n      var edgeHighPt = inPolygon[q];\r\n\r\n      var edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n      var edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n      if (Math.abs(edgeDy) > EPSILON) { // not parallel\r\n        if (edgeDy < 0) {\r\n          edgeLowPt = inPolygon[q];\r\n          edgeDx = -edgeDx;\r\n          edgeHighPt = inPolygon[p];\r\n          edgeDy = -edgeDy;\r\n        }\r\n        if ((inPt.y < edgeLowPt.y) || (inPt.y > edgeHighPt.y)) continue;\r\n\r\n        if (inPt.y == edgeLowPt.y) {\r\n          if (inPt.x == edgeLowPt.x) return true; // inPt is on contour ?\r\n          // continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n        }\r\n        else {\r\n          var perpEdge = edgeDy * (inPt.x - edgeLowPt.x) - edgeDx * (inPt.y - edgeLowPt.y);\r\n          if (perpEdge == 0) return true; // inPt is on contour ?\r\n          if (perpEdge < 0) continue;\r\n          inside = !inside; // true intersection left of inPt\r\n        }\r\n      }\r\n      else { // parallel or colinear\r\n        if (inPt.y != edgeLowPt.y) continue; // parallel\r\n        // egde lies on the same horizontal line as inPt\r\n        if (((edgeHighPt.x <= inPt.x) && (inPt.x <= edgeLowPt.x)) ||\r\n          ((edgeLowPt.x <= inPt.x) && (inPt.x <= edgeHighPt.x))) return true; // inPt: Point on contour !\r\n        // continue;\r\n      }\r\n    }\r\n\r\n    return inside;\r\n  }\r\n\r\n\r\n  var subPaths = extractSubpaths(this.actions);\r\n  if (subPaths.length == 0) return [];\r\n\r\n  if (noHoles === true) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  var solid, tmpPath, tmpShape, shapes = [];\r\n\r\n  if (subPaths.length == 1) {\r\n\r\n    tmpPath = subPaths[0];\r\n    tmpShape = new THREE.Shape();\r\n    tmpShape.actions = tmpPath.actions;\r\n    tmpShape.curves = tmpPath.curves;\r\n    shapes.push(tmpShape);\r\n    return shapes;\r\n\r\n  }\r\n\r\n  var holesFirst = !THREE.Shape.Utils.isClockWise(subPaths[0].getPoints());\r\n  holesFirst = isCCW ? !holesFirst : holesFirst;\r\n\r\n  // console.log(\"Holes first\", holesFirst);\r\n\r\n  var betterShapeHoles = [];\r\n  var newShapes = [];\r\n  var newShapeHoles = [];\r\n  var mainIdx = 0;\r\n  var tmpPoints;\r\n\r\n  newShapes[mainIdx] = undefined;\r\n  newShapeHoles[mainIdx] = [];\r\n\r\n  var i, il;\r\n\r\n  for (i = 0, il = subPaths.length; i < il; i++) {\r\n\r\n    tmpPath = subPaths[i];\r\n    tmpPoints = tmpPath.getPoints();\r\n    solid = THREE.Shape.Utils.isClockWise(tmpPoints);\r\n    solid = isCCW ? !solid : solid;\r\n\r\n    if (solid) {\r\n\r\n      if ((!holesFirst) && (newShapes[mainIdx])) mainIdx++;\r\n\r\n      newShapes[mainIdx] = {\r\n        s: new THREE.Shape(),\r\n        p: tmpPoints\r\n      };\r\n      newShapes[mainIdx].s.actions = tmpPath.actions;\r\n      newShapes[mainIdx].s.curves = tmpPath.curves;\r\n\r\n      if (holesFirst) mainIdx++;\r\n      newShapeHoles[mainIdx] = [];\r\n\r\n      //console.log('cw', i);\r\n\r\n    }\r\n    else {\r\n\r\n      newShapeHoles[mainIdx].push({\r\n        h: tmpPath,\r\n        p: tmpPoints[0]\r\n      });\r\n\r\n      //console.log('ccw', i);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // only Holes? -> probably all Shapes with wrong orientation\r\n  if (!newShapes[0]) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  if (newShapes.length > 1) {\r\n    var ambigious = false;\r\n    var toChange = [];\r\n\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      betterShapeHoles[sIdx] = [];\r\n    }\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      var sho = newShapeHoles[sIdx];\r\n      for (var hIdx = 0; hIdx < sho.length; hIdx++) {\r\n        var ho = sho[hIdx];\r\n        var hole_unassigned = true;\r\n        for (var s2Idx = 0; s2Idx < newShapes.length; s2Idx++) {\r\n          if (isPointInsidePolygon(ho.p, newShapes[s2Idx].p)) {\r\n            if (sIdx != s2Idx) toChange.push({\r\n              froms: sIdx,\r\n              tos: s2Idx,\r\n              hole: hIdx\r\n            });\r\n            if (hole_unassigned) {\r\n              hole_unassigned = false;\r\n              betterShapeHoles[s2Idx].push(ho);\r\n            }\r\n            else {\r\n              ambigious = true;\r\n            }\r\n          }\r\n        }\r\n        if (hole_unassigned) {\r\n          betterShapeHoles[sIdx].push(ho);\r\n        }\r\n      }\r\n    }\r\n    // console.log(\"ambigious: \", ambigious);\r\n    if (toChange.length > 0) {\r\n      // console.log(\"to change: \", toChange);\r\n      if (!ambigious) newShapeHoles = betterShapeHoles;\r\n    }\r\n  }\r\n\r\n  var tmpHoles, j, jl;\r\n  for (i = 0, il = newShapes.length; i < il; i++) {\r\n    tmpShape = newShapes[i].s;\r\n    shapes.push(tmpShape);\r\n    tmpHoles = newShapeHoles[i];\r\n    for (j = 0, jl = tmpHoles.length; j < jl; j++) {\r\n      tmpShape.holes.push(tmpHoles[j].h);\r\n    }\r\n  }\r\n\r\n  //console.log(\"shape\", shapes);\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function() {\r\n\r\n  THREE.Path.apply(this, arguments);\r\n  this.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create(THREE.Path.prototype);\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function(options) {\r\n\r\n  var extruded = new THREE.ExtrudeGeometry(this, options);\r\n  return extruded;\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function(options) {\r\n\r\n  var geometry = new THREE.ShapeGeometry(this, options);\r\n  return geometry;\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n// Get points of holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.getSpacedPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedSpacedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedPoints(divisions),\r\n    holes: this.getPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function(divisions) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    return this.extractAllSpacedPoints(divisions);\r\n  }\r\n\r\n  return this.extractAllPoints(divisions);\r\n\r\n};\r\n\r\n//\r\n// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\r\n//\r\n// \treturn {\r\n//\r\n// \t\tshape: this.transform( bend, divisions ),\r\n// \t\tholes: this.getPointsHoles( divisions, bend )\r\n//\r\n// \t};\r\n//\r\n// };\r\n\r\n// Get points of shape and holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.extractAllSpacedPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedSpacedPoints(divisions),\r\n    holes: this.getSpacedPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Shape.Utils = {\r\n\r\n  triangulateShape: function(contour, holes) {\r\n\r\n    function point_in_segment_2D_colin(inSegPt1, inSegPt2, inOtherPt) {\r\n      // inOtherPt needs to be colinear to the inSegment\r\n      if (inSegPt1.x != inSegPt2.x) {\r\n        if (inSegPt1.x < inSegPt2.x) {\r\n          return ((inSegPt1.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt2.x));\r\n        }\r\n        else {\r\n          return ((inSegPt2.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt1.x));\r\n        }\r\n      }\r\n      else {\r\n        if (inSegPt1.y < inSegPt2.y) {\r\n          return ((inSegPt1.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt2.y));\r\n        }\r\n        else {\r\n          return ((inSegPt2.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt1.y));\r\n        }\r\n      }\r\n    }\r\n\r\n    function intersect_segments_2D(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs) {\r\n      var EPSILON = 0.0000000001;\r\n\r\n      var seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,\r\n        seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n      var seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,\r\n        seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n      var seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n      var seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n      var limit = seg1dy * seg2dx - seg1dx * seg2dy;\r\n      var perpSeg1 = seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n      if (Math.abs(limit) > EPSILON) { // not parallel\r\n\r\n        var perpSeg2;\r\n        if (limit > 0) {\r\n          if ((perpSeg1 < 0) || (perpSeg1 > limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 < 0) || (perpSeg2 > limit)) return [];\r\n        }\r\n        else {\r\n          if ((perpSeg1 > 0) || (perpSeg1 < limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 > 0) || (perpSeg2 < limit)) return [];\r\n        }\r\n\r\n        // i.e. to reduce rounding errors\r\n        // intersection at endpoint of segment#1?\r\n        if (perpSeg2 == 0) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt1];\r\n        }\r\n        if (perpSeg2 == limit) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt2];\r\n        }\r\n        // intersection at endpoint of segment#2?\r\n        if (perpSeg1 == 0) return [inSeg2Pt1];\r\n        if (perpSeg1 == limit) return [inSeg2Pt2];\r\n\r\n        // return real intersection point\r\n        var factorSeg1 = perpSeg2 / limit;\r\n        return [{\r\n          x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n          y: inSeg1Pt1.y + factorSeg1 * seg1dy\r\n        }];\r\n\r\n      }\r\n      else { // parallel or colinear\r\n        if ((perpSeg1 != 0) ||\r\n          (seg2dy * seg1seg2dx != seg2dx * seg1seg2dy)) return [];\r\n\r\n        // they are collinear or degenerate\r\n        var seg1Pt = ((seg1dx == 0) && (seg1dy == 0)); // segment1 ist just a point?\r\n        var seg2Pt = ((seg2dx == 0) && (seg2dy == 0)); // segment2 ist just a point?\r\n        // both segments are points\r\n        if (seg1Pt && seg2Pt) {\r\n          if ((inSeg1Pt1.x != inSeg2Pt1.x) ||\r\n            (inSeg1Pt1.y != inSeg2Pt1.y)) return []; // they are distinct  points\r\n          return [inSeg1Pt1]; // they are the same point\r\n        }\r\n        // segment#1  is a single point\r\n        if (seg1Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg2Pt1, inSeg2Pt2, inSeg1Pt1)) return []; // but not in segment#2\r\n          return [inSeg1Pt1];\r\n        }\r\n        // segment#2  is a single point\r\n        if (seg2Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1)) return []; // but not in segment#1\r\n          return [inSeg2Pt1];\r\n        }\r\n\r\n        // they are collinear segments, which might overlap\r\n        var seg1min, seg1max, seg1minVal, seg1maxVal;\r\n        var seg2min, seg2max, seg2minVal, seg2maxVal;\r\n        if (seg1dx != 0) { // the segments are NOT on a vertical line\r\n          if (inSeg1Pt1.x < inSeg1Pt2.x) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.x;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.x;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.x;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.x;\r\n          }\r\n          if (inSeg2Pt1.x < inSeg2Pt2.x) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.x;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.x;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.x;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.x;\r\n          }\r\n        }\r\n        else { // the segments are on a vertical line\r\n          if (inSeg1Pt1.y < inSeg1Pt2.y) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.y;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.y;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.y;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.y;\r\n          }\r\n          if (inSeg2Pt1.y < inSeg2Pt2.y) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.y;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.y;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.y;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.y;\r\n          }\r\n        }\r\n        if (seg1minVal <= seg2minVal) {\r\n          if (seg1maxVal < seg2minVal) return [];\r\n          if (seg1maxVal == seg2minVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg2min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg2min, seg1max];\r\n          return [seg2min, seg2max];\r\n        }\r\n        else {\r\n          if (seg1minVal > seg2maxVal) return [];\r\n          if (seg1minVal == seg2maxVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg1min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg1min, seg1max];\r\n          return [seg1min, seg2max];\r\n        }\r\n      }\r\n    }\r\n\r\n    function isPointInsideAngle(inVertex, inLegFromPt, inLegToPt, inOtherPt) {\r\n      // The order of legs is important\r\n\r\n      var EPSILON = 0.0000000001;\r\n\r\n      // translation of all points, so that Vertex is at (0,0)\r\n      var legFromPtX = inLegFromPt.x - inVertex.x,\r\n        legFromPtY = inLegFromPt.y - inVertex.y;\r\n      var legToPtX = inLegToPt.x - inVertex.x,\r\n        legToPtY = inLegToPt.y - inVertex.y;\r\n      var otherPtX = inOtherPt.x - inVertex.x,\r\n        otherPtY = inOtherPt.y - inVertex.y;\r\n\r\n      // main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n      var from2toAngle = legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n      var from2otherAngle = legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n      if (Math.abs(from2toAngle) > EPSILON) { // angle != 180 deg.\r\n\r\n        var other2toAngle = otherPtX * legToPtY - otherPtY * legToPtX;\r\n        // console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n        if (from2toAngle > 0) { // main angle < 180 deg.\r\n          return ((from2otherAngle >= 0) && (other2toAngle >= 0));\r\n        }\r\n        else { // main angle > 180 deg.\r\n          return ((from2otherAngle >= 0) || (other2toAngle >= 0));\r\n        }\r\n      }\r\n      else { // angle == 180 deg.\r\n        // console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n        return (from2otherAngle > 0);\r\n      }\r\n    }\r\n\r\n\r\n    function removeHoles(contour, holes) {\r\n\r\n      var shape = contour.concat(); // work on this shape\r\n      var hole;\r\n\r\n      function isCutLineInsideAngles(inShapeIdx, inHoleIdx) {\r\n        // Check if hole point lies within angle around shape point\r\n        var lastShapeIdx = shape.length - 1;\r\n\r\n        var prevShapeIdx = inShapeIdx - 1;\r\n        if (prevShapeIdx < 0) prevShapeIdx = lastShapeIdx;\r\n\r\n        var nextShapeIdx = inShapeIdx + 1;\r\n        if (nextShapeIdx > lastShapeIdx) nextShapeIdx = 0;\r\n\r\n        var insideAngle = isPointInsideAngle(shape[inShapeIdx], shape[prevShapeIdx], shape[nextShapeIdx], hole[inHoleIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n          return false;\r\n        }\r\n\r\n        // Check if shape point lies within angle around hole point\r\n        var lastHoleIdx = hole.length - 1;\r\n\r\n        var prevHoleIdx = inHoleIdx - 1;\r\n        if (prevHoleIdx < 0) prevHoleIdx = lastHoleIdx;\r\n\r\n        var nextHoleIdx = inHoleIdx + 1;\r\n        if (nextHoleIdx > lastHoleIdx) nextHoleIdx = 0;\r\n\r\n        insideAngle = isPointInsideAngle(hole[inHoleIdx], hole[prevHoleIdx], hole[nextHoleIdx], shape[inShapeIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n          return false;\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      function intersectsShapeEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with shape edges\r\n        var sIdx, nextIdx, intersection;\r\n        for (sIdx = 0; sIdx < shape.length; sIdx++) {\r\n          nextIdx = sIdx + 1;\r\n          nextIdx %= shape.length;\r\n          intersection = intersect_segments_2D(inShapePt, inHolePt, shape[sIdx], shape[nextIdx], true);\r\n          if (intersection.length > 0) return true;\r\n        }\r\n\r\n        return false;\r\n      }\r\n\r\n      var indepHoles = [];\r\n\r\n      function intersectsHoleEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with hole edges\r\n        var ihIdx, chkHole,\r\n          hIdx, nextIdx, intersection;\r\n        for (ihIdx = 0; ihIdx < indepHoles.length; ihIdx++) {\r\n          chkHole = holes[indepHoles[ihIdx]];\r\n          for (hIdx = 0; hIdx < chkHole.length; hIdx++) {\r\n            nextIdx = hIdx + 1;\r\n            nextIdx %= chkHole.length;\r\n            intersection = intersect_segments_2D(inShapePt, inHolePt, chkHole[hIdx], chkHole[nextIdx], true);\r\n            if (intersection.length > 0) return true;\r\n          }\r\n        }\r\n        return false;\r\n      }\r\n\r\n      var holeIndex, shapeIndex,\r\n        shapePt, holePt,\r\n        holeIdx, cutKey, failedCuts = [],\r\n        tmpShape1, tmpShape2,\r\n        tmpHole1, tmpHole2;\r\n\r\n      for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n        indepHoles.push(h);\r\n\r\n      }\r\n\r\n      var minShapeIndex = 0;\r\n      var counter = indepHoles.length * 2;\r\n      while (indepHoles.length > 0) {\r\n        counter--;\r\n        if (counter < 0) {\r\n          console.log(\"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\");\r\n          break;\r\n        }\r\n\r\n        // search for shape-vertex and hole-vertex,\r\n        // which can be connected without intersections\r\n        for (shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex++) {\r\n\r\n          shapePt = shape[shapeIndex];\r\n          holeIndex = -1;\r\n\r\n          // search for hole which can be reached without intersections\r\n          for (var h = 0; h < indepHoles.length; h++) {\r\n            holeIdx = indepHoles[h];\r\n\r\n            // prevent multiple checks\r\n            cutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n            if (failedCuts[cutKey] !== undefined) continue;\r\n\r\n            hole = holes[holeIdx];\r\n            for (var h2 = 0; h2 < hole.length; h2++) {\r\n              holePt = hole[h2];\r\n              if (!isCutLineInsideAngles(shapeIndex, h2)) continue;\r\n              if (intersectsShapeEdge(shapePt, holePt)) continue;\r\n              if (intersectsHoleEdge(shapePt, holePt)) continue;\r\n\r\n              holeIndex = h2;\r\n              indepHoles.splice(h, 1);\r\n\r\n              tmpShape1 = shape.slice(0, shapeIndex + 1);\r\n              tmpShape2 = shape.slice(shapeIndex);\r\n              tmpHole1 = hole.slice(holeIndex);\r\n              tmpHole2 = hole.slice(0, holeIndex + 1);\r\n\r\n              shape = tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2);\r\n\r\n              minShapeIndex = shapeIndex;\r\n\r\n              // Debug only, to show the selected cuts\r\n              // glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n              break;\r\n            }\r\n            if (holeIndex >= 0) break; // hole-vertex found\r\n\r\n            failedCuts[cutKey] = true; // remember failure\r\n          }\r\n          if (holeIndex >= 0) break; // hole-vertex found\r\n        }\r\n      }\r\n\r\n      return shape; /* shape with no holes */\r\n    }\r\n\r\n\r\n    var i, il, f, face,\r\n      key, index,\r\n      allPointsMap = {};\r\n\r\n    // To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n    var allpoints = contour.concat();\r\n\r\n    for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      Array.prototype.push.apply(allpoints, holes[h]);\r\n\r\n    }\r\n\r\n    //console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n    // prepare all points map\r\n\r\n    for (i = 0, il = allpoints.length; i < il; i++) {\r\n\r\n      key = allpoints[i].x + \":\" + allpoints[i].y;\r\n\r\n      if (allPointsMap[key] !== undefined) {\r\n\r\n        THREE.warn(\"THREE.Shape: Duplicate point\", key);\r\n\r\n      }\r\n\r\n      allPointsMap[key] = i;\r\n\r\n    }\r\n\r\n    // remove holes by cutting paths to holes and adding them to the shape\r\n    var shapeWithoutHoles = removeHoles(contour, holes);\r\n\r\n    var triangles = THREE.FontUtils.Triangulate(shapeWithoutHoles, false); // True returns indices for points of spooled shape\r\n    //console.log( \"triangles\",triangles, triangles.length );\r\n\r\n    // check all face vertices against all points map\r\n\r\n    for (i = 0, il = triangles.length; i < il; i++) {\r\n\r\n      face = triangles[i];\r\n\r\n      for (f = 0; f < 3; f++) {\r\n\r\n        key = face[f].x + \":\" + face[f].y;\r\n\r\n        index = allPointsMap[key];\r\n\r\n        if (index !== undefined) {\r\n\r\n          face[f] = index;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return triangles.concat();\r\n\r\n  },\r\n\r\n  isClockWise: function(pts) {\r\n\r\n    return THREE.FontUtils.Triangulate.area(pts) < 0;\r\n\r\n  },\r\n\r\n  // Bezier Curves formulas obtained from\r\n  // http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n  // Quad Bezier Functions\r\n\r\n  b2p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * p;\r\n\r\n  },\r\n\r\n  b2p1: function(t, p) {\r\n\r\n    return 2 * (1 - t) * t * p;\r\n\r\n  },\r\n\r\n  b2p2: function(t, p) {\r\n\r\n    return t * t * p;\r\n\r\n  },\r\n\r\n  b2: function(t, p0, p1, p2) {\r\n\r\n    return this.b2p0(t, p0) + this.b2p1(t, p1) + this.b2p2(t, p2);\r\n\r\n  },\r\n\r\n  // Cubic Bezier Functions\r\n\r\n  b3p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * k * p;\r\n\r\n  },\r\n\r\n  b3p1: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * k * t * p;\r\n\r\n  },\r\n\r\n  b3p2: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * t * t * p;\r\n\r\n  },\r\n\r\n  b3p3: function(t, p) {\r\n\r\n    return t * t * t * p;\r\n\r\n  },\r\n\r\n  b3: function(t, p0, p1, p2, p3) {\r\n\r\n    return this.b3p0(t, p0) + this.b3p1(t, p1) + this.b3p2(t, p2) + this.b3p3(t, p3);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function(v1, v2) {\r\n\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function(t) {\r\n\r\n  var point = this.v2.clone().sub(this.v1);\r\n  point.multiplyScalar(t).add(this.v1);\r\n\r\n  return point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function(u) {\r\n\r\n  return this.getPoint(u);\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function(t) {\r\n\r\n  var tangent = this.v2.clone().sub(this.v1);\r\n\r\n  return tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function(v0, v1, v2) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  // returns unit vector\r\n\r\n  return vector.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function(v0, v1, v2, v3) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n  this.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  return new THREE.Vector2(tx, ty);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  var tangent = new THREE.Vector2(tx, ty);\r\n  tangent.normalize();\r\n\r\n  return tangent;\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function(points /* array of Vector2 */ ) {\r\n\r\n  this.points = (points == undefined) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function(t) {\r\n\r\n  var points = this.points;\r\n  var point = (points.length - 1) * t;\r\n\r\n  var intPoint = Math.floor(point);\r\n  var weight = point - intPoint;\r\n\r\n  var point0 = points[intPoint == 0 ? intPoint : intPoint - 1]\r\n  var point1 = points[intPoint]\r\n  var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1]\r\n  var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2]\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n  vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function(aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  this.aX = aX;\r\n  this.aY = aY;\r\n\r\n  this.xRadius = xRadius;\r\n  this.yRadius = yRadius;\r\n\r\n  this.aStartAngle = aStartAngle;\r\n  this.aEndAngle = aEndAngle;\r\n\r\n  this.aClockwise = aClockwise;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function(t) {\r\n\r\n  var deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n  if (deltaAngle < 0) deltaAngle += Math.PI * 2;\r\n  if (deltaAngle > Math.PI * 2) deltaAngle -= Math.PI * 2;\r\n\r\n  var angle;\r\n\r\n  if (this.aClockwise === true) {\r\n\r\n    angle = this.aEndAngle + (1 - t) * (Math.PI * 2 - deltaAngle);\r\n\r\n  }\r\n  else {\r\n\r\n    angle = this.aStartAngle + t * deltaAngle;\r\n\r\n  }\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = this.aX + this.xRadius * Math.cos(angle);\r\n  vector.y = this.aY + this.yRadius * Math.sin(angle);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function(aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  THREE.EllipseCurve.call(this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create(THREE.EllipseCurve.prototype);\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n  function(v1, v2) {\r\n\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.subVectors(this.v2, this.v1); // diff\r\n    vector.multiplyScalar(t);\r\n    vector.add(this.v1);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n    vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n    vector.z = THREE.Shape.Utils.b2(t, this.v0.z, this.v1.z, this.v2.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2, v3) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n    this.v3 = v3;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n    vector.y = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n    vector.z = THREE.Shape.Utils.b3(t, this.v0.z, this.v1.z, this.v2.z, this.v3.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 1) * t;\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    var point0 = points[intPoint == 0 ? intPoint : intPoint - 1];\r\n    var point1 = points[intPoint];\r\n    var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1];\r\n    var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 0) * t; // This needs to be from 0-length +1\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    intPoint += intPoint > 0 ? 0 : (Math.floor(Math.abs(intPoint) / points.length) + 1) * points.length;\r\n\r\n    var point0 = points[(intPoint - 1) % points.length];\r\n    var point1 = points[(intPoint) % points.length];\r\n    var point2 = points[(intPoint + 1) % points.length];\r\n    var point3 = points[(intPoint + 2) % points.length];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/animation/AnimationHandler.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\nTHREE.AnimationHandler = {\r\n\r\n  LINEAR: 0,\r\n  CATMULLROM: 1,\r\n  CATMULLROM_FORWARD: 2,\r\n\r\n  //\r\n\r\n  add: function() {\r\n    THREE.warn('THREE.AnimationHandler.add() has been deprecated.');\r\n  },\r\n  get: function() {\r\n    THREE.warn('THREE.AnimationHandler.get() has been deprecated.');\r\n  },\r\n  remove: function() {\r\n    THREE.warn('THREE.AnimationHandler.remove() has been deprecated.');\r\n  },\r\n\r\n  //\r\n\r\n  animations: [],\r\n\r\n  init: function(data) {\r\n\r\n    if (data.initialized === true) return data;\r\n\r\n    // loop through all keys\r\n\r\n    for (var h = 0; h < data.hierarchy.length; h++) {\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        // remove minus times\r\n\r\n        if (data.hierarchy[h].keys[k].time < 0) {\r\n\r\n          data.hierarchy[h].keys[k].time = 0;\r\n\r\n        }\r\n\r\n        // create quaternions\r\n\r\n        if (data.hierarchy[h].keys[k].rot !== undefined &&\r\n          !(data.hierarchy[h].keys[k].rot instanceof THREE.Quaternion)) {\r\n\r\n          var quat = data.hierarchy[h].keys[k].rot;\r\n          data.hierarchy[h].keys[k].rot = new THREE.Quaternion().fromArray(quat);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // prepare morph target keys\r\n\r\n      if (data.hierarchy[h].keys.length && data.hierarchy[h].keys[0].morphTargets !== undefined) {\r\n\r\n        // get all used\r\n\r\n        var usedMorphTargets = {};\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n            var morphTargetName = data.hierarchy[h].keys[k].morphTargets[m];\r\n            usedMorphTargets[morphTargetName] = -1;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        data.hierarchy[h].usedMorphTargets = usedMorphTargets;\r\n\r\n\r\n        // set all used on all frames\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          var influences = {};\r\n\r\n          for (var morphTargetName in usedMorphTargets) {\r\n\r\n            for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n              if (data.hierarchy[h].keys[k].morphTargets[m] === morphTargetName) {\r\n\r\n                influences[morphTargetName] = data.hierarchy[h].keys[k].morphTargetsInfluences[m];\r\n                break;\r\n\r\n              }\r\n\r\n            }\r\n\r\n            if (m === data.hierarchy[h].keys[k].morphTargets.length) {\r\n\r\n              influences[morphTargetName] = 0;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          data.hierarchy[h].keys[k].morphTargetsInfluences = influences;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // remove all keys that are on the same time\r\n\r\n      for (var k = 1; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        if (data.hierarchy[h].keys[k].time === data.hierarchy[h].keys[k - 1].time) {\r\n\r\n          data.hierarchy[h].keys.splice(k, 1);\r\n          k--;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // set index\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        data.hierarchy[h].keys[k].index = k;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    data.initialized = true;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  parse: function(root) {\r\n\r\n    var parseRecurseHierarchy = function(root, hierarchy) {\r\n\r\n      hierarchy.push(root);\r\n\r\n      for (var c = 0; c < root.children.length; c++)\r\n        parseRecurseHierarchy(root.children[c], hierarchy);\r\n\r\n    };\r\n\r\n    // setup hierarchy\r\n\r\n    var hierarchy = [];\r\n\r\n    if (root instanceof THREE.SkinnedMesh) {\r\n\r\n      for (var b = 0; b < root.skeleton.bones.length; b++) {\r\n\r\n        hierarchy.push(root.skeleton.bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      parseRecurseHierarchy(root, hierarchy);\r\n\r\n    }\r\n\r\n    return hierarchy;\r\n\r\n  },\r\n\r\n  play: function(animation) {\r\n\r\n    if (this.animations.indexOf(animation) === -1) {\r\n\r\n      this.animations.push(animation);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  stop: function(animation) {\r\n\r\n    var index = this.animations.indexOf(animation);\r\n\r\n    if (index !== -1) {\r\n\r\n      this.animations.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(deltaTimeMS) {\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].resetBlendWeights();\r\n\r\n    }\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].update(deltaTimeMS);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/Animation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Animation = function(root, data) {\r\n\r\n  this.root = root;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(root);\r\n\r\n  this.currentTime = 0;\r\n  this.timeScale = 1;\r\n\r\n  this.isPlaying = false;\r\n  this.loop = true;\r\n  this.weight = 0;\r\n\r\n  this.interpolationType = THREE.AnimationHandler.LINEAR;\r\n\r\n};\r\n\r\nTHREE.Animation.prototype = {\r\n\r\n  constructor: THREE.Animation,\r\n\r\n  keyTypes: [\"pos\", \"rot\", \"scl\"],\r\n\r\n  play: function(startTime, weight) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n    this.weight = weight !== undefined ? weight : 1;\r\n\r\n    this.isPlaying = true;\r\n\r\n    this.reset();\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n  },\r\n\r\n  reset: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n\r\n      if (object.animationCache === undefined) {\r\n\r\n        object.animationCache = {\r\n          animations: {},\r\n          blending: {\r\n            positionWeight: 0.0,\r\n            quaternionWeight: 0.0,\r\n            scaleWeight: 0.0\r\n          }\r\n        };\r\n      }\r\n\r\n      var name = this.data.name;\r\n      var animations = object.animationCache.animations;\r\n      var animationCache = animations[name];\r\n\r\n      if (animationCache === undefined) {\r\n\r\n        animationCache = {\r\n          prevKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          nextKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          originalMatrix: object.matrix\r\n        };\r\n\r\n        animations[name] = animationCache;\r\n\r\n      }\r\n\r\n      // Get keys to match our current time\r\n\r\n      for (var t = 0; t < 3; t++) {\r\n\r\n        var type = this.keyTypes[t];\r\n\r\n        var prevKey = this.data.hierarchy[h].keys[0];\r\n        var nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n        while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n          prevKey = nextKey;\r\n          nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n        }\r\n\r\n        animationCache.prevKey[type] = prevKey;\r\n        animationCache.nextKey[type] = nextKey;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  resetBlendWeights: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var animationCache = object.animationCache;\r\n\r\n      if (animationCache !== undefined) {\r\n\r\n        var blending = animationCache.blending;\r\n\r\n        blending.positionWeight = 0.0;\r\n        blending.quaternionWeight = 0.0;\r\n        blending.scaleWeight = 0.0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: (function() {\r\n\r\n    var points = [];\r\n    var target = new THREE.Vector3();\r\n    var newVector = new THREE.Vector3();\r\n    var newQuat = new THREE.Quaternion();\r\n\r\n    // Catmull-Rom spline\r\n\r\n    var interpolateCatmullRom = function(points, scale) {\r\n\r\n      var c = [],\r\n        v3 = [],\r\n        point, intPoint, weight, w2, w3,\r\n        pa, pb, pc, pd;\r\n\r\n      point = (points.length - 1) * scale;\r\n      intPoint = Math.floor(point);\r\n      weight = point - intPoint;\r\n\r\n      c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n      c[1] = intPoint;\r\n      c[2] = intPoint > points.length - 2 ? intPoint : intPoint + 1;\r\n      c[3] = intPoint > points.length - 3 ? intPoint : intPoint + 2;\r\n\r\n      pa = points[c[0]];\r\n      pb = points[c[1]];\r\n      pc = points[c[2]];\r\n      pd = points[c[3]];\r\n\r\n      w2 = weight * weight;\r\n      w3 = weight * w2;\r\n\r\n      v3[0] = interpolate(pa[0], pb[0], pc[0], pd[0], weight, w2, w3);\r\n      v3[1] = interpolate(pa[1], pb[1], pc[1], pd[1], weight, w2, w3);\r\n      v3[2] = interpolate(pa[2], pb[2], pc[2], pd[2], weight, w2, w3);\r\n\r\n      return v3;\r\n\r\n    };\r\n\r\n    var interpolate = function(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n      var v0 = (p2 - p0) * 0.5,\r\n        v1 = (p3 - p1) * 0.5;\r\n\r\n      return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n    };\r\n\r\n    return function(delta) {\r\n\r\n      if (this.isPlaying === false) return;\r\n\r\n      this.currentTime += delta * this.timeScale;\r\n\r\n      if (this.weight === 0)\r\n        return;\r\n\r\n      //\r\n\r\n      var duration = this.data.length;\r\n\r\n      if (this.currentTime > duration || this.currentTime < 0) {\r\n\r\n        if (this.loop) {\r\n\r\n          this.currentTime %= duration;\r\n\r\n          if (this.currentTime < 0)\r\n            this.currentTime += duration;\r\n\r\n          this.reset();\r\n\r\n        }\r\n        else {\r\n\r\n          this.stop();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n        var object = this.hierarchy[h];\r\n        var animationCache = object.animationCache.animations[this.data.name];\r\n        var blending = object.animationCache.blending;\r\n\r\n        // loop through pos/rot/scl\r\n\r\n        for (var t = 0; t < 3; t++) {\r\n\r\n          // get keys\r\n\r\n          var type = this.keyTypes[t];\r\n          var prevKey = animationCache.prevKey[type];\r\n          var nextKey = animationCache.nextKey[type];\r\n\r\n          if ((this.timeScale > 0 && nextKey.time <= this.currentTime) ||\r\n            (this.timeScale < 0 && prevKey.time >= this.currentTime)) {\r\n\r\n            prevKey = this.data.hierarchy[h].keys[0];\r\n            nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n            while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n              prevKey = nextKey;\r\n              nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n            }\r\n\r\n            animationCache.prevKey[type] = prevKey;\r\n            animationCache.nextKey[type] = nextKey;\r\n\r\n          }\r\n\r\n          var scale = (this.currentTime - prevKey.time) / (nextKey.time - prevKey.time);\r\n\r\n          var prevXYZ = prevKey[type];\r\n          var nextXYZ = nextKey[type];\r\n\r\n          if (scale < 0) scale = 0;\r\n          if (scale > 1) scale = 1;\r\n\r\n          // interpolate\r\n\r\n          if (type === \"pos\") {\r\n\r\n            if (this.interpolationType === THREE.AnimationHandler.LINEAR) {\r\n\r\n              newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n              newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n              newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n              // blend\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              object.position.lerp(newVector, proportionalWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n            }\r\n            else if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n              this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n              points[0] = this.getPrevKeyWith(\"pos\", h, prevKey.index - 1)[\"pos\"];\r\n              points[1] = prevXYZ;\r\n              points[2] = nextXYZ;\r\n              points[3] = this.getNextKeyWith(\"pos\", h, nextKey.index + 1)[\"pos\"];\r\n\r\n              scale = scale * 0.33 + 0.33;\r\n\r\n              var currentPoint = interpolateCatmullRom(points, scale);\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n              // blend\r\n\r\n              var vector = object.position;\r\n\r\n              vector.x = vector.x + (currentPoint[0] - vector.x) * proportionalWeight;\r\n              vector.y = vector.y + (currentPoint[1] - vector.y) * proportionalWeight;\r\n              vector.z = vector.z + (currentPoint[2] - vector.z) * proportionalWeight;\r\n\r\n              if (this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n                var forwardPoint = interpolateCatmullRom(points, scale * 1.01);\r\n\r\n                target.set(forwardPoint[0], forwardPoint[1], forwardPoint[2]);\r\n                target.sub(vector);\r\n                target.y = 0;\r\n                target.normalize();\r\n\r\n                var angle = Math.atan2(target.x, target.z);\r\n                object.rotation.set(0, angle, 0);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"rot\") {\r\n\r\n            THREE.Quaternion.slerp(prevXYZ, nextXYZ, newQuat, scale);\r\n\r\n            // Avoid paying the cost of an additional slerp if we don't have to\r\n            if (blending.quaternionWeight === 0) {\r\n\r\n              object.quaternion.copy(newQuat);\r\n              blending.quaternionWeight = this.weight;\r\n\r\n            }\r\n            else {\r\n\r\n              var proportionalWeight = this.weight / (this.weight + blending.quaternionWeight);\r\n              THREE.Quaternion.slerp(object.quaternion, newQuat, object.quaternion, proportionalWeight);\r\n              blending.quaternionWeight += this.weight;\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"scl\") {\r\n\r\n            newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n            newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n            newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n            var proportionalWeight = this.weight / (this.weight + blending.scaleWeight);\r\n            object.scale.lerp(newVector, proportionalWeight);\r\n            blending.scaleWeight += this.weight;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  getNextKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key < keys.length - 1 ? key : keys.length - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key % keys.length;\r\n\r\n    }\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key > 0 ? key : 0;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key >= 0 ? key : key + keys.length;\r\n\r\n    }\r\n\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/KeyFrameAnimation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author khang duong\r\n * @author erik kitson\r\n */\r\n\r\nTHREE.KeyFrameAnimation = function(data) {\r\n\r\n  this.root = data.node;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(this.root);\r\n  this.currentTime = 0;\r\n  this.timeScale = 0.001;\r\n  this.isPlaying = false;\r\n  this.isPaused = true;\r\n  this.loop = true;\r\n\r\n  // initialize to first keyframes\r\n\r\n  for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n    var keys = this.data.hierarchy[h].keys,\r\n      sids = this.data.hierarchy[h].sids,\r\n      obj = this.hierarchy[h];\r\n\r\n    if (keys.length && sids) {\r\n\r\n      for (var s = 0; s < sids.length; s++) {\r\n\r\n        var sid = sids[s],\r\n          next = this.getNextKeyWith(sid, h, 0);\r\n\r\n        if (next) {\r\n\r\n          next.apply(sid);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      obj.matrixAutoUpdate = false;\r\n      this.data.hierarchy[h].node.updateMatrix();\r\n      obj.matrixWorldNeedsUpdate = true;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.KeyFrameAnimation.prototype = {\r\n\r\n  constructor: THREE.KeyFrameAnimation,\r\n\r\n  play: function(startTime) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n\r\n    if (this.isPlaying === false) {\r\n\r\n      this.isPlaying = true;\r\n\r\n      // reset key cache\r\n\r\n      var h, hl = this.hierarchy.length,\r\n        object,\r\n        node;\r\n\r\n      for (h = 0; h < hl; h++) {\r\n\r\n        object = this.hierarchy[h];\r\n        node = this.data.hierarchy[h];\r\n\r\n        if (node.animationCache === undefined) {\r\n\r\n          node.animationCache = {};\r\n          node.animationCache.prevKey = null;\r\n          node.animationCache.nextKey = null;\r\n          node.animationCache.originalMatrix = object.matrix;\r\n\r\n        }\r\n\r\n        var keys = this.data.hierarchy[h].keys;\r\n\r\n        if (keys.length) {\r\n\r\n          node.animationCache.prevKey = keys[0];\r\n          node.animationCache.nextKey = keys[1];\r\n\r\n          this.startTime = Math.min(keys[0].time, this.startTime);\r\n          this.endTime = Math.max(keys[keys.length - 1].time, this.endTime);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.update(0);\r\n\r\n    }\r\n\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n    // reset JIT matrix and remove cache\r\n\r\n    for (var h = 0; h < this.data.hierarchy.length; h++) {\r\n\r\n      var obj = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      if (node.animationCache !== undefined) {\r\n\r\n        var original = node.animationCache.originalMatrix;\r\n\r\n        original.copy(obj.matrix);\r\n        obj.matrix = original;\r\n\r\n        delete node.animationCache;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta * this.timeScale;\r\n\r\n    //\r\n\r\n    var duration = this.data.length;\r\n\r\n    if (this.loop === true && this.currentTime > duration) {\r\n\r\n      this.currentTime %= duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, duration);\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      var keys = node.keys,\r\n        animationCache = node.animationCache;\r\n\r\n\r\n      if (keys.length) {\r\n\r\n        var prevKey = animationCache.prevKey;\r\n        var nextKey = animationCache.nextKey;\r\n\r\n        if (nextKey.time <= this.currentTime) {\r\n\r\n          while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n            prevKey = nextKey;\r\n            nextKey = keys[prevKey.index + 1];\r\n\r\n          }\r\n\r\n          animationCache.prevKey = prevKey;\r\n          animationCache.nextKey = nextKey;\r\n\r\n        }\r\n\r\n        if (nextKey.time >= this.currentTime) {\r\n\r\n          prevKey.interpolate(nextKey, this.currentTime);\r\n\r\n        }\r\n        else {\r\n\r\n          prevKey.interpolate(nextKey, nextKey.time);\r\n\r\n        }\r\n\r\n        this.data.hierarchy[h].node.updateMatrix();\r\n        object.matrixWorldNeedsUpdate = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getNextKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key % keys.length;\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key >= 0 ? key : key + keys.length;\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/MorphAnimation.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com\r\n * @author willy-vvu / http://willy-vvu.github.io\r\n */\r\n\r\nTHREE.MorphAnimation = function(mesh) {\r\n\r\n  this.mesh = mesh;\r\n  this.frames = mesh.morphTargetInfluences.length;\r\n  this.currentTime = 0;\r\n  this.duration = 1000;\r\n  this.loop = true;\r\n  this.lastFrame = 0;\r\n  this.currentFrame = 0;\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimation.prototype = {\r\n\r\n  constructor: THREE.MorphAnimation,\r\n\r\n  play: function() {\r\n\r\n    this.isPlaying = true;\r\n\r\n  },\r\n\r\n  pause: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta;\r\n\r\n    if (this.loop === true && this.currentTime > this.duration) {\r\n\r\n      this.currentTime %= this.duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, this.duration);\r\n\r\n    var interpolation = this.duration / this.frames;\r\n    var frame = Math.floor(this.currentTime / interpolation);\r\n\r\n    var influences = this.mesh.morphTargetInfluences;\r\n\r\n    if (frame != this.currentFrame) {\r\n\r\n      influences[this.lastFrame] = 0;\r\n      influences[this.currentFrame] = 1;\r\n      influences[frame] = 0;\r\n\r\n      this.lastFrame = this.currentFrame;\r\n      this.currentFrame = frame;\r\n\r\n    }\r\n\r\n    influences[frame] = (this.currentTime % interpolation) / interpolation;\r\n    influences[this.lastFrame] = 1 - influences[frame];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'BoxGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    depth: depth,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    depthSegments: depthSegments\r\n  };\r\n\r\n  this.widthSegments = widthSegments || 1;\r\n  this.heightSegments = heightSegments || 1;\r\n  this.depthSegments = depthSegments || 1;\r\n\r\n  var scope = this;\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n  var depth_half = depth / 2;\r\n\r\n  buildPlane('z', 'y', -1, -1, depth, height, width_half, 0); // px\r\n  buildPlane('z', 'y', 1, -1, depth, height, -width_half, 1); // nx\r\n  buildPlane('x', 'z', 1, 1, width, depth, height_half, 2); // py\r\n  buildPlane('x', 'z', 1, -1, width, depth, -height_half, 3); // ny\r\n  buildPlane('x', 'y', 1, -1, width, height, depth_half, 4); // pz\r\n  buildPlane('x', 'y', -1, -1, width, height, -depth_half, 5); // nz\r\n\r\n  function buildPlane(u, v, udir, vdir, width, height, depth, materialIndex) {\r\n\r\n    var w, ix, iy,\r\n      gridX = scope.widthSegments,\r\n      gridY = scope.heightSegments,\r\n      width_half = width / 2,\r\n      height_half = height / 2,\r\n      offset = scope.vertices.length;\r\n\r\n    if ((u === 'x' && v === 'y') || (u === 'y' && v === 'x')) {\r\n\r\n      w = 'z';\r\n\r\n    }\r\n    else if ((u === 'x' && v === 'z') || (u === 'z' && v === 'x')) {\r\n\r\n      w = 'y';\r\n      gridY = scope.depthSegments;\r\n\r\n    }\r\n    else if ((u === 'z' && v === 'y') || (u === 'y' && v === 'z')) {\r\n\r\n      w = 'x';\r\n      gridX = scope.depthSegments;\r\n\r\n    }\r\n\r\n    var gridX1 = gridX + 1,\r\n      gridY1 = gridY + 1,\r\n      segment_width = width / gridX,\r\n      segment_height = height / gridY,\r\n      normal = new THREE.Vector3();\r\n\r\n    normal[w] = depth > 0 ? 1 : -1;\r\n\r\n    for (iy = 0; iy < gridY1; iy++) {\r\n\r\n      for (ix = 0; ix < gridX1; ix++) {\r\n\r\n        var vector = new THREE.Vector3();\r\n        vector[u] = (ix * segment_width - width_half) * udir;\r\n        vector[v] = (iy * segment_height - height_half) * vdir;\r\n        vector[w] = depth;\r\n\r\n        scope.vertices.push(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (iy = 0; iy < gridY; iy++) {\r\n\r\n      for (ix = 0; ix < gridX; ix++) {\r\n\r\n        var a = ix + gridX1 * iy;\r\n        var b = ix + gridX1 * (iy + 1);\r\n        var c = (ix + 1) + gridX1 * (iy + 1);\r\n        var d = (ix + 1) + gridX1 * iy;\r\n\r\n        var uva = new THREE.Vector2(ix / gridX, 1 - iy / gridY);\r\n        var uvb = new THREE.Vector2(ix / gridX, 1 - (iy + 1) / gridY);\r\n        var uvc = new THREE.Vector2((ix + 1) / gridX, 1 - (iy + 1) / gridY);\r\n        var uvd = new THREE.Vector2((ix + 1) / gridX, 1 - iy / gridY);\r\n\r\n        var face = new THREE.Face3(a + offset, b + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n        face = new THREE.Face3(b + offset, c + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function(radius, segments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CircleGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    segments: segments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n  segments = segments !== undefined ? Math.max(3, segments) : 8;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  var i, uvs = [],\r\n    center = new THREE.Vector3(),\r\n    centerUV = new THREE.Vector2(0.5, 0.5);\r\n\r\n  this.vertices.push(center);\r\n  uvs.push(centerUV);\r\n\r\n  for (i = 0; i <= segments; i++) {\r\n\r\n    var vertex = new THREE.Vector3();\r\n    var segment = thetaStart + i / segments * thetaLength;\r\n\r\n    vertex.x = radius * Math.cos(segment);\r\n    vertex.y = radius * Math.sin(segment);\r\n\r\n    this.vertices.push(vertex);\r\n    uvs.push(new THREE.Vector2((vertex.x / radius + 1) / 2, (vertex.y / radius + 1) / 2));\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 1; i <= segments; i++) {\r\n\r\n    this.faces.push(new THREE.Face3(i, i + 1, 0, [n.clone(), n.clone(), n.clone()]));\r\n    this.faceVertexUvs[0].push([uvs[i].clone(), uvs[i + 1].clone(), centerUV.clone()]);\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CubeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.CubeGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.warn('THREE.CubeGeometry has been renamed to THREE.BoxGeometry.');\r\n  return new THREE.BoxGeometry(width, height, depth, widthSegments, heightSegments, depthSegments);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function(radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CylinderGeometry';\r\n\r\n  this.parameters = {\r\n    radiusTop: radiusTop,\r\n    radiusBottom: radiusBottom,\r\n    height: height,\r\n    radialSegments: radialSegments,\r\n    heightSegments: heightSegments,\r\n    openEnded: openEnded,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n  radiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n  height = height !== undefined ? height : 100;\r\n\r\n  radialSegments = radialSegments || 8;\r\n  heightSegments = heightSegments || 1;\r\n\r\n  openEnded = openEnded !== undefined ? openEnded : false;\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n  var heightHalf = height / 2;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    var v = y / heightSegments;\r\n    var radius = v * (radiusBottom - radiusTop) + radiusTop;\r\n\r\n    for (x = 0; x <= radialSegments; x++) {\r\n\r\n      var u = x / radialSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = radius * Math.sin(u * thetaLength + thetaStart);\r\n      vertex.y = -v * height + heightHalf;\r\n      vertex.z = radius * Math.cos(u * thetaLength + thetaStart);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  var tanTheta = (radiusBottom - radiusTop) / height;\r\n  var na, nb;\r\n\r\n  for (x = 0; x < radialSegments; x++) {\r\n\r\n    if (radiusTop !== 0) {\r\n\r\n      na = this.vertices[vertices[0][x]].clone();\r\n      nb = this.vertices[vertices[0][x + 1]].clone();\r\n\r\n    }\r\n    else {\r\n\r\n      na = this.vertices[vertices[1][x]].clone();\r\n      nb = this.vertices[vertices[1][x + 1]].clone();\r\n\r\n    }\r\n\r\n    na.setY(Math.sqrt(na.x * na.x + na.z * na.z) * tanTheta).normalize();\r\n    nb.setY(Math.sqrt(nb.x * nb.x + nb.z * nb.z) * tanTheta).normalize();\r\n\r\n    for (y = 0; y < heightSegments; y++) {\r\n\r\n      var v1 = vertices[y][x];\r\n      var v2 = vertices[y + 1][x];\r\n      var v3 = vertices[y + 1][x + 1];\r\n      var v4 = vertices[y][x + 1];\r\n\r\n      var n1 = na.clone();\r\n      var n2 = na.clone();\r\n      var n3 = nb.clone();\r\n      var n4 = nb.clone();\r\n\r\n      var uv1 = uvs[y][x].clone();\r\n      var uv2 = uvs[y + 1][x].clone();\r\n      var uv3 = uvs[y + 1][x + 1].clone();\r\n      var uv4 = uvs[y][x + 1].clone();\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n      this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n      this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // top cap\r\n\r\n  if (openEnded === false && radiusTop > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[0][x];\r\n      var v2 = vertices[0][x + 1];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, 1, 0);\r\n      var n2 = new THREE.Vector3(0, 1, 0);\r\n      var n3 = new THREE.Vector3(0, 1, 0);\r\n\r\n      var uv1 = uvs[0][x].clone();\r\n      var uv2 = uvs[0][x + 1].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 0);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // bottom cap\r\n\r\n  if (openEnded === false && radiusBottom > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, -heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[heightSegments][x + 1];\r\n      var v2 = vertices[heightSegments][x];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, -1, 0);\r\n      var n2 = new THREE.Vector3(0, -1, 0);\r\n      var n3 = new THREE.Vector3(0, -1, 0);\r\n\r\n      var uv1 = uvs[heightSegments][x + 1].clone();\r\n      var uv2 = uvs[heightSegments][x].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 1);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segements of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  material: <int> // material index for front and back faces\r\n *  extrudeMaterial: <int> // material index for extrusion and beveled faces\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function(shapes, options) {\r\n\r\n  if (typeof(shapes) === \"undefined\") {\r\n    shapes = [];\r\n    return;\r\n  }\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ExtrudeGeometry';\r\n\r\n  shapes = shapes instanceof Array ? shapes : [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n  // can't really use automatic vertex normals\r\n  // as then front and back sides get smoothed too\r\n  // should do separate smoothing just for sides\r\n\r\n  //this.computeVertexNormals();\r\n\r\n  //console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function(shapes, options) {\r\n  var sl = shapes.length;\r\n\r\n  for (var s = 0; s < sl; s++) {\r\n    var shape = shapes[s];\r\n    this.addShape(shape, options);\r\n  }\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  var amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n  var bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n  var bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n  var bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n  var bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n  var extrudePath = options.extrudePath;\r\n  var extrudePts, extrudeByPath = false;\r\n\r\n  var material = options.material;\r\n  var extrudeMaterial = options.extrudeMaterial;\r\n\r\n  // Use default WorldUVGenerator if no UV generators are specified.\r\n  var uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n  var splineTube, binormal, normal, position2;\r\n  if (extrudePath) {\r\n\r\n    extrudePts = extrudePath.getSpacedPoints(steps);\r\n\r\n    extrudeByPath = true;\r\n    bevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n    // SETUP TNB variables\r\n\r\n    // Reuse TNB from TubeGeomtry for now.\r\n    // TODO1 - have a .isClosed in spline?\r\n\r\n    splineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames(extrudePath, steps, false);\r\n\r\n    // console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n    binormal = new THREE.Vector3();\r\n    normal = new THREE.Vector3();\r\n    position2 = new THREE.Vector3();\r\n\r\n  }\r\n\r\n  // Safeguards if bevels are not enabled\r\n\r\n  if (!bevelEnabled) {\r\n\r\n    bevelSegments = 0;\r\n    bevelThickness = 0;\r\n    bevelSize = 0;\r\n\r\n  }\r\n\r\n  // Variables initalization\r\n\r\n  var ahole, h, hl; // looping of holes\r\n  var scope = this;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(ahole)) {\r\n\r\n        holes[h] = ahole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n  }\r\n\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  /* Vertices */\r\n\r\n  var contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    vertices = vertices.concat(ahole);\r\n\r\n  }\r\n\r\n\r\n  function scalePt2(pt, vec, size) {\r\n\r\n    if (!vec) THREE.error(\"THREE.ExtrudeGeometry: vec does not exist\");\r\n\r\n    return vec.clone().multiplyScalar(size).add(pt);\r\n\r\n  }\r\n\r\n  var b, bs, t, z,\r\n    vert, vlen = vertices.length,\r\n    face, flen = faces.length;\r\n\r\n\r\n  // Find directions for point movement\r\n\r\n\r\n  function getBevelVec(inPt, inPrev, inNext) {\r\n\r\n    var EPSILON = 0.0000000001;\r\n\r\n    // computes for inPt the corresponding point inPt' on a new contour\r\n    //   shiftet by 1 unit (length of normalized vector) to the left\r\n    // if we walk along contour clockwise, this new contour is outside the old one\r\n    //\r\n    // inPt' is the intersection of the two lines parallel to the two\r\n    //  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n    var v_trans_x, v_trans_y, shrink_by = 1; // resulting translation vector for inPt\r\n\r\n    // good reading for geometry algorithms (here: line-line intersection)\r\n    // http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n    var v_prev_x = inPt.x - inPrev.x,\r\n      v_prev_y = inPt.y - inPrev.y;\r\n    var v_next_x = inNext.x - inPt.x,\r\n      v_next_y = inNext.y - inPt.y;\r\n\r\n    var v_prev_lensq = (v_prev_x * v_prev_x + v_prev_y * v_prev_y);\r\n\r\n    // check for colinear edges\r\n    var colinear0 = (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n    if (Math.abs(colinear0) > EPSILON) { // not colinear\r\n\r\n      // length of vectors for normalizing\r\n\r\n      var v_prev_len = Math.sqrt(v_prev_lensq);\r\n      var v_next_len = Math.sqrt(v_next_x * v_next_x + v_next_y * v_next_y);\r\n\r\n      // shift adjacent points by unit vectors to the left\r\n\r\n      var ptPrevShift_x = (inPrev.x - v_prev_y / v_prev_len);\r\n      var ptPrevShift_y = (inPrev.y + v_prev_x / v_prev_len);\r\n\r\n      var ptNextShift_x = (inNext.x - v_next_y / v_next_len);\r\n      var ptNextShift_y = (inNext.y + v_next_x / v_next_len);\r\n\r\n      // scaling factor for v_prev to intersection point\r\n\r\n      var sf = ((ptNextShift_x - ptPrevShift_x) * v_next_y -\r\n          (ptNextShift_y - ptPrevShift_y) * v_next_x) /\r\n        (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n      // vector from inPt to intersection point\r\n\r\n      v_trans_x = (ptPrevShift_x + v_prev_x * sf - inPt.x);\r\n      v_trans_y = (ptPrevShift_y + v_prev_y * sf - inPt.y);\r\n\r\n      // Don't normalize!, otherwise sharp corners become ugly\r\n      //  but prevent crazy spikes\r\n      var v_trans_lensq = (v_trans_x * v_trans_x + v_trans_y * v_trans_y)\r\n      if (v_trans_lensq <= 2) {\r\n        return new THREE.Vector2(v_trans_x, v_trans_y);\r\n      }\r\n      else {\r\n        shrink_by = Math.sqrt(v_trans_lensq / 2);\r\n      }\r\n\r\n    }\r\n    else { // handle special case of colinear edges\r\n\r\n      var direction_eq = false; // assumes: opposite\r\n      if (v_prev_x > EPSILON) {\r\n        if (v_next_x > EPSILON) {\r\n          direction_eq = true;\r\n        }\r\n      }\r\n      else {\r\n        if (v_prev_x < -EPSILON) {\r\n          if (v_next_x < -EPSILON) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n        else {\r\n          if (Math.sign(v_prev_y) == Math.sign(v_next_y)) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (direction_eq) {\r\n        // console.log(\"Warning: lines are a straight sequence\");\r\n        v_trans_x = -v_prev_y;\r\n        v_trans_y = v_prev_x;\r\n        shrink_by = Math.sqrt(v_prev_lensq);\r\n      }\r\n      else {\r\n        // console.log(\"Warning: lines are a straight spike\");\r\n        v_trans_x = v_prev_x;\r\n        v_trans_y = v_prev_y;\r\n        shrink_by = Math.sqrt(v_prev_lensq / 2);\r\n      }\r\n\r\n    }\r\n\r\n    return new THREE.Vector2(v_trans_x / shrink_by, v_trans_y / shrink_by);\r\n\r\n  }\r\n\r\n\r\n  var contourMovements = [];\r\n\r\n  for (var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n    if (j === il) j = 0;\r\n    if (k === il) k = 0;\r\n\r\n    //  (j)---(i)---(k)\r\n    // console.log('i,j,k', i, j , k)\r\n\r\n    contourMovements[i] = getBevelVec(contour[i], contour[j], contour[k]);\r\n\r\n  }\r\n\r\n  var holesMovements = [],\r\n    oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    oneHoleMovements = [];\r\n\r\n    for (i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n      if (j === il) j = 0;\r\n      if (k === il) k = 0;\r\n\r\n      //  (j)---(i)---(k)\r\n      oneHoleMovements[i] = getBevelVec(ahole[i], ahole[j], ahole[k]);\r\n\r\n    }\r\n\r\n    holesMovements.push(oneHoleMovements);\r\n    verticesMovements = verticesMovements.concat(oneHoleMovements);\r\n\r\n  }\r\n\r\n\r\n  // Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n  for (b = 0; b < bevelSegments; b++) {\r\n    //for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n\r\n    //z = bevelThickness * t;\r\n    bs = bevelSize * (Math.sin(t * Math.PI / 2)); // curved\r\n    //bs = bevelSize * t ; // linear\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n\r\n      v(vert.x, vert.y, -z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        v(vert.x, vert.y, -z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  bs = bevelSize;\r\n\r\n  // Back facing vertices\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n    if (!extrudeByPath) {\r\n\r\n      v(vert.x, vert.y, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      // v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n      normal.copy(splineTube.normals[0]).multiplyScalar(vert.x);\r\n      binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y);\r\n\r\n      position2.copy(extrudePts[0]).add(normal).add(binormal);\r\n\r\n      v(position2.x, position2.y, position2.z);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Add stepped vertices...\r\n  // Including front facing vertices\r\n\r\n  var s;\r\n\r\n  for (s = 1; s <= steps; s++) {\r\n\r\n    for (i = 0; i < vlen; i++) {\r\n\r\n      vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n      if (!extrudeByPath) {\r\n\r\n        v(vert.x, vert.y, amount / steps * s);\r\n\r\n      }\r\n      else {\r\n\r\n        // v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n        normal.copy(splineTube.normals[s]).multiplyScalar(vert.x);\r\n        binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y);\r\n\r\n        position2.copy(extrudePts[s]).add(normal).add(binormal);\r\n\r\n        v(position2.x, position2.y, position2.z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Add bevel segments planes\r\n\r\n  //for ( b = 1; b <= bevelSegments; b ++ ) {\r\n  for (b = bevelSegments - 1; b >= 0; b--) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n    //bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n    bs = bevelSize * Math.sin(t * Math.PI / 2);\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n      v(vert.x, vert.y, amount + z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        if (!extrudeByPath) {\r\n\r\n          v(vert.x, vert.y, amount + z);\r\n\r\n        }\r\n        else {\r\n\r\n          v(vert.x, vert.y + extrudePts[steps - 1].y, extrudePts[steps - 1].x + z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  /* Faces */\r\n\r\n  // Top and bottom faces\r\n\r\n  buildLidFaces();\r\n\r\n  // Sides faces\r\n\r\n  buildSideFaces();\r\n\r\n\r\n  /////  Internal functions\r\n\r\n  function buildLidFaces() {\r\n\r\n    if (bevelEnabled) {\r\n\r\n      var layer = 0; // steps + 1\r\n      var offset = vlen * layer;\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2] + offset, face[1] + offset, face[0] + offset);\r\n\r\n      }\r\n\r\n      layer = steps + bevelSegments * 2;\r\n      offset = vlen * layer;\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + offset, face[1] + offset, face[2] + offset);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2], face[1], face[0]);\r\n\r\n      }\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + vlen * steps, face[1] + vlen * steps, face[2] + vlen * steps);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  // Create faces for the z-sides of the shape\r\n\r\n  function buildSideFaces() {\r\n\r\n    var layeroffset = 0;\r\n    sidewalls(contour, layeroffset);\r\n    layeroffset += contour.length;\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      sidewalls(ahole, layeroffset);\r\n\r\n      //, true\r\n      layeroffset += ahole.length;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function sidewalls(contour, layeroffset) {\r\n\r\n    var j, k;\r\n    i = contour.length;\r\n\r\n    while (--i >= 0) {\r\n\r\n      j = i;\r\n      k = i - 1;\r\n      if (k < 0) k = contour.length - 1;\r\n\r\n      //console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n      var s = 0,\r\n        sl = steps + bevelSegments * 2;\r\n\r\n      for (s = 0; s < sl; s++) {\r\n\r\n        var slen1 = vlen * s;\r\n        var slen2 = vlen * (s + 1);\r\n\r\n        var a = layeroffset + j + slen1,\r\n          b = layeroffset + k + slen1,\r\n          c = layeroffset + k + slen2,\r\n          d = layeroffset + j + slen2;\r\n\r\n        f4(a, b, c, d, contour, s, sl, j, k);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n\r\n  function v(x, y, z) {\r\n\r\n    scope.vertices.push(new THREE.Vector3(x, y, z));\r\n\r\n  }\r\n\r\n  function f3(a, b, c) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n\r\n    // normal, color, material\r\n    scope.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n\r\n    var uvs = uvgen.generateTopUV(scope, a, b, c);\r\n\r\n    scope.faceVertexUvs[0].push(uvs);\r\n\r\n  }\r\n\r\n  function f4(a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n    d += shapesOffset;\r\n\r\n    scope.faces.push(new THREE.Face3(a, b, d, null, null, extrudeMaterial));\r\n    scope.faces.push(new THREE.Face3(b, c, d, null, null, extrudeMaterial));\r\n\r\n    var uvs = uvgen.generateSideWallUV(scope, a, b, c, d);\r\n\r\n    scope.faceVertexUvs[0].push([uvs[0], uvs[1], uvs[3]]);\r\n    scope.faceVertexUvs[0].push([uvs[1], uvs[2], uvs[3]]);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n  generateTopUV: function(geometry, indexA, indexB, indexC) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n\r\n    return [\r\n      new THREE.Vector2(a.x, a.y),\r\n      new THREE.Vector2(b.x, b.y),\r\n      new THREE.Vector2(c.x, c.y)\r\n    ];\r\n\r\n  },\r\n\r\n  generateSideWallUV: function(geometry, indexA, indexB, indexC, indexD) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n    var d = vertices[indexD];\r\n\r\n    if (Math.abs(a.y - b.y) < 0.01) {\r\n      return [\r\n        new THREE.Vector2(a.x, 1 - a.z),\r\n        new THREE.Vector2(b.x, 1 - b.z),\r\n        new THREE.Vector2(c.x, 1 - c.z),\r\n        new THREE.Vector2(d.x, 1 - d.z)\r\n      ];\r\n    }\r\n    else {\r\n      return [\r\n        new THREE.Vector2(a.y, 1 - a.z),\r\n        new THREE.Vector2(b.y, 1 - b.z),\r\n        new THREE.Vector2(c.y, 1 - c.z),\r\n        new THREE.Vector2(d.y, 1 - d.z)\r\n      ];\r\n    }\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function(shapes, options) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ShapeGeometry';\r\n\r\n  if (shapes instanceof Array === false) shapes = [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function(shapes, options) {\r\n\r\n  for (var i = 0, l = shapes.length; i < l; i++) {\r\n\r\n    this.addShape(shapes[i], options);\r\n\r\n  }\r\n\r\n  return this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  if (options === undefined) options = {};\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var material = options.material;\r\n  var uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n  //\r\n\r\n  var i, l, hole;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n    for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n      hole = holes[i];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(hole)) {\r\n\r\n        holes[i] = hole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false;\r\n\r\n  }\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  // Vertices\r\n\r\n  var contour = vertices;\r\n\r\n  for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n    hole = holes[i];\r\n    vertices = vertices.concat(hole);\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var vert, vlen = vertices.length;\r\n  var face, flen = faces.length;\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = vertices[i];\r\n\r\n    this.vertices.push(new THREE.Vector3(vert.x, vert.y, 0));\r\n\r\n  }\r\n\r\n  for (i = 0; i < flen; i++) {\r\n\r\n    face = faces[i];\r\n\r\n    var a = face[0] + shapesOffset;\r\n    var b = face[1] + shapesOffset;\r\n    var c = face[2] + shapesOffset;\r\n\r\n    this.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n    this.faceVertexUvs[0].push(uvgen.generateTopUV(this, a, b, c));\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points \r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function(points, segments, phiStart, phiLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'LatheGeometry';\r\n\r\n  this.parameters = {\r\n    points: points,\r\n    segments: segments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength\r\n  };\r\n\r\n  segments = segments || 12;\r\n  phiStart = phiStart || 0;\r\n  phiLength = phiLength || 2 * Math.PI;\r\n\r\n  var inversePointLength = 1.0 / (points.length - 1);\r\n  var inverseSegments = 1.0 / segments;\r\n\r\n  for (var i = 0, il = segments; i <= il; i++) {\r\n\r\n    var phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n    var c = Math.cos(phi),\r\n      s = Math.sin(phi);\r\n\r\n    for (var j = 0, jl = points.length; j < jl; j++) {\r\n\r\n      var pt = points[j];\r\n\r\n      var vertex = new THREE.Vector3();\r\n\r\n      vertex.x = c * pt.x - s * pt.y;\r\n      vertex.y = s * pt.x + c * pt.y;\r\n      vertex.z = pt.z;\r\n\r\n      this.vertices.push(vertex);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var np = points.length;\r\n\r\n  for (var i = 0, il = segments; i < il; i++) {\r\n\r\n    for (var j = 0, jl = points.length - 1; j < jl; j++) {\r\n\r\n      var base = j + np * i;\r\n      var a = base;\r\n      var b = base + np;\r\n      var c = base + 1 + np;\r\n      var d = base + 1;\r\n\r\n      var u0 = i * inverseSegments;\r\n      var v0 = j * inversePointLength;\r\n      var u1 = u0 + inverseSegments;\r\n      var v1 = v0 + inversePointLength;\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u0, v0),\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u1, v1),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  console.info('THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.');\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PlaneGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  this.fromBufferGeometry(new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments));\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  THREE.BufferGeometry.call(this);\r\n\r\n  this.type = 'PlaneBufferGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n\r\n  var gridX = widthSegments || 1;\r\n  var gridY = heightSegments || 1;\r\n\r\n  var gridX1 = gridX + 1;\r\n  var gridY1 = gridY + 1;\r\n\r\n  var segment_width = width / gridX;\r\n  var segment_height = height / gridY;\r\n\r\n  var vertices = new Float32Array(gridX1 * gridY1 * 3);\r\n  var normals = new Float32Array(gridX1 * gridY1 * 3);\r\n  var uvs = new Float32Array(gridX1 * gridY1 * 2);\r\n\r\n  var offset = 0;\r\n  var offset2 = 0;\r\n\r\n  for (var iy = 0; iy < gridY1; iy++) {\r\n\r\n    var y = iy * segment_height - height_half;\r\n\r\n    for (var ix = 0; ix < gridX1; ix++) {\r\n\r\n      var x = ix * segment_width - width_half;\r\n\r\n      vertices[offset] = x;\r\n      vertices[offset + 1] = -y;\r\n\r\n      normals[offset + 2] = 1;\r\n\r\n      uvs[offset2] = ix / gridX;\r\n      uvs[offset2 + 1] = 1 - (iy / gridY);\r\n\r\n      offset += 3;\r\n      offset2 += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  offset = 0;\r\n\r\n  var indices = new((vertices.length / 3) > 65535 ? Uint32Array : Uint16Array)(gridX * gridY * 6);\r\n\r\n  for (var iy = 0; iy < gridY; iy++) {\r\n\r\n    for (var ix = 0; ix < gridX; ix++) {\r\n\r\n      var a = ix + gridX1 * iy;\r\n      var b = ix + gridX1 * (iy + 1);\r\n      var c = (ix + 1) + gridX1 * (iy + 1);\r\n      var d = (ix + 1) + gridX1 * iy;\r\n\r\n      indices[offset] = a;\r\n      indices[offset + 1] = b;\r\n      indices[offset + 2] = d;\r\n\r\n      indices[offset + 3] = b;\r\n      indices[offset + 4] = c;\r\n      indices[offset + 5] = d;\r\n\r\n      offset += 6;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  this.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n  this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function(innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'RingGeometry';\r\n\r\n  this.parameters = {\r\n    innerRadius: innerRadius,\r\n    outerRadius: outerRadius,\r\n    thetaSegments: thetaSegments,\r\n    phiSegments: phiSegments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  innerRadius = innerRadius || 0;\r\n  outerRadius = outerRadius || 50;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  thetaSegments = thetaSegments !== undefined ? Math.max(3, thetaSegments) : 8;\r\n  phiSegments = phiSegments !== undefined ? Math.max(1, phiSegments) : 8;\r\n\r\n  var i, o, uvs = [],\r\n    radius = innerRadius,\r\n    radiusStep = ((outerRadius - innerRadius) / phiSegments);\r\n\r\n  for (i = 0; i < phiSegments + 1; i++) { // concentric circles inside ring\r\n\r\n    for (o = 0; o < thetaSegments + 1; o++) { // number of segments per circle\r\n\r\n      var vertex = new THREE.Vector3();\r\n      var segment = thetaStart + o / thetaSegments * thetaLength;\r\n      vertex.x = radius * Math.cos(segment);\r\n      vertex.y = radius * Math.sin(segment);\r\n\r\n      this.vertices.push(vertex);\r\n      uvs.push(new THREE.Vector2((vertex.x / outerRadius + 1) / 2, (vertex.y / outerRadius + 1) / 2));\r\n    }\r\n\r\n    radius += radiusStep;\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 0; i < phiSegments; i++) { // concentric circles inside ring\r\n\r\n    var thetaSegment = i * (thetaSegments + 1);\r\n\r\n    for (o = 0; o < thetaSegments; o++) { // number of segments per circle\r\n\r\n      var segment = o + thetaSegment;\r\n\r\n      var v1 = segment;\r\n      var v2 = segment + thetaSegments + 1;\r\n      var v3 = segment + thetaSegments + 2;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n      v1 = segment;\r\n      v2 = segment + thetaSegments + 2;\r\n      v3 = segment + 1;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'SphereGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n\r\n  widthSegments = Math.max(3, Math.floor(widthSegments) || 8);\r\n  heightSegments = Math.max(2, Math.floor(heightSegments) || 6);\r\n\r\n  phiStart = phiStart !== undefined ? phiStart : 0;\r\n  phiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    for (x = 0; x <= widthSegments; x++) {\r\n\r\n      var u = x / widthSegments;\r\n      var v = y / heightSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = -radius * Math.cos(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n      vertex.y = radius * Math.cos(thetaStart + v * thetaLength);\r\n      vertex.z = radius * Math.sin(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  for (y = 0; y < heightSegments; y++) {\r\n\r\n    for (x = 0; x < widthSegments; x++) {\r\n\r\n      var v1 = vertices[y][x + 1];\r\n      var v2 = vertices[y][x];\r\n      var v3 = vertices[y + 1][x];\r\n      var v4 = vertices[y + 1][x + 1];\r\n\r\n      var n1 = this.vertices[v1].clone().normalize();\r\n      var n2 = this.vertices[v2].clone().normalize();\r\n      var n3 = this.vertices[v3].clone().normalize();\r\n      var n4 = this.vertices[v4].clone().normalize();\r\n\r\n      var uv1 = uvs[y][x + 1].clone();\r\n      var uv2 = uvs[y][x].clone();\r\n      var uv3 = uvs[y + 1][x].clone();\r\n      var uv4 = uvs[y + 1][x + 1].clone();\r\n\r\n      if (Math.abs(this.vertices[v1].y) === radius) {\r\n\r\n        uv1.x = (uv1.x + uv2.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v3, v4, [n1, n3, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv3, uv4]);\r\n\r\n      }\r\n      else if (Math.abs(this.vertices[v3].y) === radius) {\r\n\r\n        uv3.x = (uv3.x + uv4.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n        this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n        this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For creating 3D text geometry in three.js\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  size: \t\t\t<float>, \t// size of the text\r\n *  height: \t\t<float>, \t// thickness to extrude text\r\n *  curveSegments: \t<int>,\t\t// number of points on the curves\r\n *\r\n *  font: \t\t\t<string>,\t\t// font name\r\n *  weight: \t\t<string>,\t\t// font weight (normal, bold)\r\n *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\r\n *\r\n *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\r\n *  bevelThickness: <float>, \t\t// how deep into text bevel goes\r\n *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\r\n *  }\r\n *\r\n */\r\n\r\n/*\tUsage Examples\r\n\r\n\t// TextGeometry wrapper\r\n\r\n\tvar text3d = new TextGeometry( text, options );\r\n\r\n\t// Complete manner\r\n\r\n\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\r\n\tvar text3d = new ExtrudeGeometry( textShapes, options );\r\n\r\n*/\r\n\r\n\r\nTHREE.TextGeometry = function(text, parameters) {\r\n\r\n  parameters = parameters || {};\r\n\r\n  var textShapes = THREE.FontUtils.generateShapes(text, parameters);\r\n\r\n  // translate parameters to ExtrudeGeometry API\r\n\r\n  parameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n  // defaults\r\n\r\n  if (parameters.bevelThickness === undefined) parameters.bevelThickness = 10;\r\n  if (parameters.bevelSize === undefined) parameters.bevelSize = 8;\r\n  if (parameters.bevelEnabled === undefined) parameters.bevelEnabled = false;\r\n\r\n  THREE.ExtrudeGeometry.call(this, textShapes, parameters);\r\n\r\n  this.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create(THREE.ExtrudeGeometry.prototype);\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function(radius, tube, radialSegments, tubularSegments, arc) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    arc: arc\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 8;\r\n  tubularSegments = tubularSegments || 6;\r\n  arc = arc || Math.PI * 2;\r\n\r\n  var center = new THREE.Vector3(),\r\n    uvs = [],\r\n    normals = [];\r\n\r\n  for (var j = 0; j <= radialSegments; j++) {\r\n\r\n    for (var i = 0; i <= tubularSegments; i++) {\r\n\r\n      var u = i / tubularSegments * arc;\r\n      var v = j / radialSegments * Math.PI * 2;\r\n\r\n      center.x = radius * Math.cos(u);\r\n      center.y = radius * Math.sin(u);\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = (radius + tube * Math.cos(v)) * Math.cos(u);\r\n      vertex.y = (radius + tube * Math.cos(v)) * Math.sin(u);\r\n      vertex.z = tube * Math.sin(v);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      uvs.push(new THREE.Vector2(i / tubularSegments, j / radialSegments));\r\n      normals.push(vertex.clone().sub(center).normalize());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var j = 1; j <= radialSegments; j++) {\r\n\r\n    for (var i = 1; i <= tubularSegments; i++) {\r\n\r\n      var a = (tubularSegments + 1) * j + i - 1;\r\n      var b = (tubularSegments + 1) * (j - 1) + i - 1;\r\n      var c = (tubularSegments + 1) * (j - 1) + i;\r\n      var d = (tubularSegments + 1) * j + i;\r\n\r\n      var face = new THREE.Face3(a, b, d, [normals[a].clone(), normals[b].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[a].clone(), uvs[b].clone(), uvs[d].clone()]);\r\n\r\n      face = new THREE.Face3(b, c, d, [normals[b].clone(), normals[c].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[b].clone(), uvs[c].clone(), uvs[d].clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function(radius, tube, radialSegments, tubularSegments, p, q, heightScale) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusKnotGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    p: p,\r\n    q: q,\r\n    heightScale: heightScale\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 64;\r\n  tubularSegments = tubularSegments || 8;\r\n  p = p || 2;\r\n  q = q || 3;\r\n  heightScale = heightScale || 1;\r\n\r\n  var grid = new Array(radialSegments);\r\n  var tang = new THREE.Vector3();\r\n  var n = new THREE.Vector3();\r\n  var bitan = new THREE.Vector3();\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    grid[i] = new Array(tubularSegments);\r\n    var u = i / radialSegments * 2 * p * Math.PI;\r\n    var p1 = getPos(u, q, p, radius, heightScale);\r\n    var p2 = getPos(u + 0.01, q, p, radius, heightScale);\r\n    tang.subVectors(p2, p1);\r\n    n.addVectors(p2, p1);\r\n\r\n    bitan.crossVectors(tang, n);\r\n    n.crossVectors(bitan, tang);\r\n    bitan.normalize();\r\n    n.normalize();\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var v = j / tubularSegments * 2 * Math.PI;\r\n      var cx = -tube * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      var cy = tube * Math.sin(v);\r\n\r\n      var pos = new THREE.Vector3();\r\n      pos.x = p1.x + cx * n.x + cy * bitan.x;\r\n      pos.y = p1.y + cx * n.y + cy * bitan.y;\r\n      pos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\r\n      grid[i][j] = this.vertices.push(pos) - 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var ip = (i + 1) % radialSegments;\r\n      var jp = (j + 1) % tubularSegments;\r\n\r\n      var a = grid[i][j];\r\n      var b = grid[ip][j];\r\n      var c = grid[ip][jp];\r\n      var d = grid[i][jp];\r\n\r\n      var uva = new THREE.Vector2(i / radialSegments, j / tubularSegments);\r\n      var uvb = new THREE.Vector2((i + 1) / radialSegments, j / tubularSegments);\r\n      var uvc = new THREE.Vector2((i + 1) / radialSegments, (j + 1) / tubularSegments);\r\n      var uvd = new THREE.Vector2(i / radialSegments, (j + 1) / tubularSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n  function getPos(u, in_q, in_p, radius, heightScale) {\r\n\r\n    var cu = Math.cos(u);\r\n    var su = Math.sin(u);\r\n    var quOverP = in_q / in_p * u;\r\n    var cs = Math.cos(quOverP);\r\n\r\n    var tx = radius * (2 + cs) * 0.5 * cu;\r\n    var ty = radius * (2 + cs) * su * 0.5;\r\n    var tz = heightScale * radius * Math.sin(quOverP) * 0.5;\r\n\r\n    return new THREE.Vector3(tx, ty, tz);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function(path, segments, radius, radialSegments, closed, taper) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TubeGeometry';\r\n\r\n  this.parameters = {\r\n    path: path,\r\n    segments: segments,\r\n    radius: radius,\r\n    radialSegments: radialSegments,\r\n    closed: closed\r\n  };\r\n\r\n  segments = segments || 64;\r\n  radius = radius || 1;\r\n  radialSegments = radialSegments || 8;\r\n  closed = closed || false;\r\n  taper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n  var grid = [];\r\n\r\n  var scope = this,\r\n\r\n    tangent,\r\n    normal,\r\n    binormal,\r\n\r\n    numpoints = segments + 1,\r\n\r\n    u, v, r,\r\n\r\n    cx, cy,\r\n    pos, pos2 = new THREE.Vector3(),\r\n    i, j,\r\n    ip, jp,\r\n    a, b, c, d,\r\n    uva, uvb, uvc, uvd;\r\n\r\n  var frames = new THREE.TubeGeometry.FrenetFrames(path, segments, closed),\r\n    tangents = frames.tangents,\r\n    normals = frames.normals,\r\n    binormals = frames.binormals;\r\n\r\n  // proxy internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  function vert(x, y, z) {\r\n\r\n    return scope.vertices.push(new THREE.Vector3(x, y, z)) - 1;\r\n\r\n  }\r\n\r\n  // consruct the grid\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    grid[i] = [];\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    pos = path.getPointAt(u);\r\n\r\n    tangent = tangents[i];\r\n    normal = normals[i];\r\n    binormal = binormals[i];\r\n\r\n    r = radius * taper(u);\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      v = j / radialSegments * 2 * Math.PI;\r\n\r\n      cx = -r * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      cy = r * Math.sin(v);\r\n\r\n      pos2.copy(pos);\r\n      pos2.x += cx * normal.x + cy * binormal.x;\r\n      pos2.y += cx * normal.y + cy * binormal.y;\r\n      pos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n      grid[i][j] = vert(pos2.x, pos2.y, pos2.z);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  // construct the mesh\r\n\r\n  for (i = 0; i < segments; i++) {\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      ip = (closed) ? (i + 1) % segments : i + 1;\r\n      jp = (j + 1) % radialSegments;\r\n\r\n      a = grid[i][j]; // *** NOT NECESSARILY PLANAR ! ***\r\n      b = grid[ip][j];\r\n      c = grid[ip][jp];\r\n      d = grid[i][jp];\r\n\r\n      uva = new THREE.Vector2(i / segments, j / radialSegments);\r\n      uvb = new THREE.Vector2((i + 1) / segments, j / radialSegments);\r\n      uvc = new THREE.Vector2((i + 1) / segments, (j + 1) / radialSegments);\r\n      uvd = new THREE.Vector2(i / segments, (j + 1) / radialSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function(u) {\r\n\r\n  return 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function(u) {\r\n\r\n  return Math.sin(Math.PI * u);\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function(path, segments, closed) {\r\n\r\n  var normal = new THREE.Vector3(),\r\n\r\n    tangents = [],\r\n    normals = [],\r\n    binormals = [],\r\n\r\n    vec = new THREE.Vector3(),\r\n    mat = new THREE.Matrix4(),\r\n\r\n    numpoints = segments + 1,\r\n    theta,\r\n    epsilon = 0.0001,\r\n    smallest,\r\n\r\n    tx, ty, tz,\r\n    i, u;\r\n\r\n\r\n  // expose internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  // compute the tangent vectors for each segment on the path\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    tangents[i] = path.getTangentAt(u);\r\n    tangents[i].normalize();\r\n\r\n  }\r\n\r\n  initialNormal3();\r\n\r\n  /*\r\n  function initialNormal1(lastBinormal) {\r\n  \t// fixed start binormal. Has dangers of 0 vectors\r\n  \tnormals[ 0 ] = new THREE.Vector3();\r\n  \tbinormals[ 0 ] = new THREE.Vector3();\r\n  \tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n  \tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n  }\r\n\r\n  function initialNormal2() {\r\n\r\n  \t// This uses the Frenet-Serret formula for deriving binormal\r\n  \tvar t2 = path.getTangentAt( epsilon );\r\n\r\n  \tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n  \tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n  }\r\n  */\r\n\r\n  function initialNormal3() {\r\n    // select an initial normal vector perpenicular to the first tangent vector,\r\n    // and in the direction of the smallest tangent xyz component\r\n\r\n    normals[0] = new THREE.Vector3();\r\n    binormals[0] = new THREE.Vector3();\r\n    smallest = Number.MAX_VALUE;\r\n    tx = Math.abs(tangents[0].x);\r\n    ty = Math.abs(tangents[0].y);\r\n    tz = Math.abs(tangents[0].z);\r\n\r\n    if (tx <= smallest) {\r\n      smallest = tx;\r\n      normal.set(1, 0, 0);\r\n    }\r\n\r\n    if (ty <= smallest) {\r\n      smallest = ty;\r\n      normal.set(0, 1, 0);\r\n    }\r\n\r\n    if (tz <= smallest) {\r\n      normal.set(0, 0, 1);\r\n    }\r\n\r\n    vec.crossVectors(tangents[0], normal).normalize();\r\n\r\n    normals[0].crossVectors(tangents[0], vec);\r\n    binormals[0].crossVectors(tangents[0], normals[0]);\r\n  }\r\n\r\n\r\n  // compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n  for (i = 1; i < numpoints; i++) {\r\n\r\n    normals[i] = normals[i - 1].clone();\r\n\r\n    binormals[i] = binormals[i - 1].clone();\r\n\r\n    vec.crossVectors(tangents[i - 1], tangents[i]);\r\n\r\n    if (vec.length() > epsilon) {\r\n\r\n      vec.normalize();\r\n\r\n      theta = Math.acos(THREE.Math.clamp(tangents[i - 1].dot(tangents[i]), -1, 1)); // clamp for floating pt errors\r\n\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(vec, theta));\r\n\r\n    }\r\n\r\n    binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n  }\r\n\r\n\r\n  // if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n  if (closed) {\r\n\r\n    theta = Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints - 1]), -1, 1));\r\n    theta /= (numpoints - 1);\r\n\r\n    if (tangents[0].dot(vec.crossVectors(normals[0], normals[numpoints - 1])) > 0) {\r\n\r\n      theta = -theta;\r\n\r\n    }\r\n\r\n    for (i = 1; i < numpoints; i++) {\r\n\r\n      // twist a little...\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(tangents[i], theta * i));\r\n      binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.PolyhedronGeometry = function(vertices, indices, radius, detail) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PolyhedronGeometry';\r\n\r\n  this.parameters = {\r\n    vertices: vertices,\r\n    indices: indices,\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  radius = radius || 1;\r\n  detail = detail || 0;\r\n\r\n  var that = this;\r\n\r\n  for (var i = 0, l = vertices.length; i < l; i += 3) {\r\n\r\n    prepare(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n  }\r\n\r\n  var p = this.vertices;\r\n\r\n  var faces = [];\r\n\r\n  for (var i = 0, j = 0, l = indices.length; i < l; i += 3, j++) {\r\n\r\n    var v1 = p[indices[i]];\r\n    var v2 = p[indices[i + 1]];\r\n    var v3 = p[indices[i + 2]];\r\n\r\n    faces[j] = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n\r\n  }\r\n\r\n  var centroid = new THREE.Vector3();\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    subdivide(faces[i], detail);\r\n\r\n  }\r\n\r\n\r\n  // Handle case when face straddles the seam\r\n\r\n  for (var i = 0, l = this.faceVertexUvs[0].length; i < l; i++) {\r\n\r\n    var uvs = this.faceVertexUvs[0][i];\r\n\r\n    var x0 = uvs[0].x;\r\n    var x1 = uvs[1].x;\r\n    var x2 = uvs[2].x;\r\n\r\n    var max = Math.max(x0, Math.max(x1, x2));\r\n    var min = Math.min(x0, Math.min(x1, x2));\r\n\r\n    if (max > 0.9 && min < 0.1) { // 0.9 is somewhat arbitrary\r\n\r\n      if (x0 < 0.2) uvs[0].x += 1;\r\n      if (x1 < 0.2) uvs[1].x += 1;\r\n      if (x2 < 0.2) uvs[2].x += 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Apply radius\r\n\r\n  for (var i = 0, l = this.vertices.length; i < l; i++) {\r\n\r\n    this.vertices[i].multiplyScalar(radius);\r\n\r\n  }\r\n\r\n\r\n  // Merge vertices\r\n\r\n  this.mergeVertices();\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n\r\n  // Project vector onto sphere's surface\r\n\r\n  function prepare(vector) {\r\n\r\n    var vertex = vector.normalize().clone();\r\n    vertex.index = that.vertices.push(vertex) - 1;\r\n\r\n    // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n    var u = azimuth(vector) / 2 / Math.PI + 0.5;\r\n    var v = inclination(vector) / Math.PI + 0.5;\r\n    vertex.uv = new THREE.Vector2(u, 1 - v);\r\n\r\n    return vertex;\r\n\r\n  }\r\n\r\n\r\n  // Approximate a curved face with recursively sub-divided triangles.\r\n\r\n  function make(v1, v2, v3) {\r\n\r\n    var face = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n    that.faces.push(face);\r\n\r\n    centroid.copy(v1).add(v2).add(v3).divideScalar(3);\r\n\r\n    var azi = azimuth(centroid);\r\n\r\n    that.faceVertexUvs[0].push([\r\n      correctUV(v1.uv, v1, azi),\r\n      correctUV(v2.uv, v2, azi),\r\n      correctUV(v3.uv, v3, azi)\r\n    ]);\r\n\r\n  }\r\n\r\n\r\n  // Analytically subdivide a face to the required detail level.\r\n\r\n  function subdivide(face, detail) {\r\n\r\n    var cols = Math.pow(2, detail);\r\n    var a = prepare(that.vertices[face.a]);\r\n    var b = prepare(that.vertices[face.b]);\r\n    var c = prepare(that.vertices[face.c]);\r\n    var v = [];\r\n\r\n    // Construct all of the vertices for this subdivision.\r\n\r\n    for (var i = 0; i <= cols; i++) {\r\n\r\n      v[i] = [];\r\n\r\n      var aj = prepare(a.clone().lerp(c, i / cols));\r\n      var bj = prepare(b.clone().lerp(c, i / cols));\r\n      var rows = cols - i;\r\n\r\n      for (var j = 0; j <= rows; j++) {\r\n\r\n        if (j == 0 && i == cols) {\r\n\r\n          v[i][j] = aj;\r\n\r\n        }\r\n        else {\r\n\r\n          v[i][j] = prepare(aj.clone().lerp(bj, j / rows));\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Construct all of the faces.\r\n\r\n    for (var i = 0; i < cols; i++) {\r\n\r\n      for (var j = 0; j < 2 * (cols - i) - 1; j++) {\r\n\r\n        var k = Math.floor(j / 2);\r\n\r\n        if (j % 2 == 0) {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k],\r\n            v[i][k]\r\n          );\r\n\r\n        }\r\n        else {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k + 1],\r\n            v[i + 1][k]\r\n          );\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n  function azimuth(vector) {\r\n\r\n    return Math.atan2(vector.z, -vector.x);\r\n\r\n  }\r\n\r\n\r\n  // Angle above the XZ plane.\r\n\r\n  function inclination(vector) {\r\n\r\n    return Math.atan2(-vector.y, Math.sqrt((vector.x * vector.x) + (vector.z * vector.z)));\r\n\r\n  }\r\n\r\n\r\n  // Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n  function correctUV(uv, vector, azimuth) {\r\n\r\n    if ((azimuth < 0) && (uv.x === 1)) uv = new THREE.Vector2(uv.x - 1, uv.y);\r\n    if ((vector.x === 0) && (vector.z === 0)) uv = new THREE.Vector2(azimuth / 2 / Math.PI + 0.5, uv.y);\r\n    return uv.clone();\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n  var r = 1 / t;\r\n\r\n  var vertices = [\r\n\r\n    // (±1, ±1, ±1)\r\n    -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1,\r\n    1, -1, -1, 1, -1, 1,\r\n    1, 1, -1, 1, 1, 1,\r\n\r\n    // (0, ±1/φ, ±φ)\r\n    0, -r, -t, 0, -r, t,\r\n    0, r, -t, 0, r, t,\r\n\r\n    // (±1/φ, ±φ, 0)\r\n    -r, -t, 0, -r, t, 0,\r\n    r, -t, 0, r, t, 0,\r\n\r\n    // (±φ, 0, ±1/φ)\r\n    -t, 0, -r, t, 0, -r, -t, 0, r, t, 0, r\r\n  ];\r\n\r\n  var indices = [\r\n    3, 11, 7, 3, 7, 15, 3, 15, 13,\r\n    7, 19, 17, 7, 17, 6, 7, 6, 15,\r\n    17, 4, 8, 17, 8, 10, 17, 10, 6,\r\n    8, 0, 16, 8, 16, 2, 8, 2, 10,\r\n    0, 12, 1, 0, 1, 18, 0, 18, 16,\r\n    6, 10, 2, 6, 2, 13, 6, 13, 15,\r\n    2, 16, 18, 2, 18, 3, 2, 3, 13,\r\n    18, 1, 9, 18, 9, 11, 18, 11, 3,\r\n    4, 14, 12, 4, 12, 0, 4, 0, 8,\r\n    11, 9, 5, 11, 5, 19, 11, 19, 7,\r\n    19, 5, 14, 19, 14, 4, 19, 4, 17,\r\n    1, 12, 14, 1, 14, 5, 1, 5, 9\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function(radius, detail) {\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n\r\n  var vertices = [-1, t, 0, 1, t, 0, -1, -t, 0, 1, -t, 0,\r\n    0, -1, t, 0, 1, t, 0, -1, -t, 0, 1, -t,\r\n    t, 0, -1, t, 0, 1, -t, 0, -1, -t, 0, 1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11,\r\n    1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8,\r\n    3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9,\r\n    4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'IcosahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var vertices = [\r\n    1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'OctahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function(radius, detail) {\r\n\r\n  var vertices = [\r\n    1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1\r\n  ];\r\n\r\n  var indices = [\r\n    2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'TetrahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function(func, slices, stacks) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ParametricGeometry';\r\n\r\n  this.parameters = {\r\n    func: func,\r\n    slices: slices,\r\n    stacks: stacks\r\n  };\r\n\r\n  var verts = this.vertices;\r\n  var faces = this.faces;\r\n  var uvs = this.faceVertexUvs[0];\r\n\r\n  var i, j, p;\r\n  var u, v;\r\n\r\n  var sliceCount = slices + 1;\r\n\r\n  for (i = 0; i <= stacks; i++) {\r\n\r\n    v = i / stacks;\r\n\r\n    for (j = 0; j <= slices; j++) {\r\n\r\n      u = j / slices;\r\n\r\n      p = func(u, v);\r\n      verts.push(p);\r\n\r\n    }\r\n  }\r\n\r\n  var a, b, c, d;\r\n  var uva, uvb, uvc, uvd;\r\n\r\n  for (i = 0; i < stacks; i++) {\r\n\r\n    for (j = 0; j < slices; j++) {\r\n\r\n      a = i * sliceCount + j;\r\n      b = i * sliceCount + j + 1;\r\n      c = (i + 1) * sliceCount + j + 1;\r\n      d = (i + 1) * sliceCount + j;\r\n\r\n      uva = new THREE.Vector2(j / slices, i / stacks);\r\n      uvb = new THREE.Vector2((j + 1) / slices, i / stacks);\r\n      uvc = new THREE.Vector2((j + 1) / slices, (i + 1) / stacks);\r\n      uvd = new THREE.Vector2(j / slices, (i + 1) / stacks);\r\n\r\n      faces.push(new THREE.Face3(a, b, d));\r\n      uvs.push([uva, uvb, uvd]);\r\n\r\n      faces.push(new THREE.Face3(b, c, d));\r\n      uvs.push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // console.log(this);\r\n\r\n  // magic bullet\r\n  // var diff = this.mergeVertices();\r\n  // console.log('removed ', diff, ' vertices by merging');\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function(size) {\r\n\r\n  size = size || 1;\r\n\r\n  var vertices = new Float32Array([\r\n    0, 0, 0, size, 0, 0,\r\n    0, 0, 0, 0, size, 0,\r\n    0, 0, 0, 0, 0, size\r\n  ]);\r\n\r\n  var colors = new Float32Array([\r\n    1, 0, 0, 1, 0.6, 0,\r\n    0, 1, 0, 0.6, 1, 0,\r\n    0, 0, 1, 0, 0.6, 1\r\n  ]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = (function() {\r\n\r\n  var lineGeometry = new THREE.Geometry();\r\n  lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0));\r\n\r\n  var coneGeometry = new THREE.CylinderGeometry(0, 0.5, 1, 5, 1);\r\n  coneGeometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n\r\n  return function(dir, origin, length, color, headLength, headWidth) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    if (color === undefined) color = 0xffff00;\r\n    if (length === undefined) length = 1;\r\n    if (headLength === undefined) headLength = 0.2 * length;\r\n    if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n    this.position.copy(origin);\r\n\r\n    this.line = new THREE.Line(lineGeometry, new THREE.LineBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.line.matrixAutoUpdate = false;\r\n    this.add(this.line);\r\n\r\n    this.cone = new THREE.Mesh(coneGeometry, new THREE.MeshBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.cone.matrixAutoUpdate = false;\r\n    this.add(this.cone);\r\n\r\n    this.setDirection(dir);\r\n    this.setLength(length, headLength, headWidth);\r\n\r\n  }\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = (function() {\r\n\r\n  var axis = new THREE.Vector3();\r\n  var radians;\r\n\r\n  return function(dir) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    if (dir.y > 0.99999) {\r\n\r\n      this.quaternion.set(0, 0, 0, 1);\r\n\r\n    }\r\n    else if (dir.y < -0.99999) {\r\n\r\n      this.quaternion.set(1, 0, 0, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      axis.set(dir.z, 0, -dir.x).normalize();\r\n\r\n      radians = Math.acos(dir.y);\r\n\r\n      this.quaternion.setFromAxisAngle(axis, radians);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function(length, headLength, headWidth) {\r\n\r\n  if (headLength === undefined) headLength = 0.2 * length;\r\n  if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n  this.line.scale.set(1, length - headLength, 1);\r\n  this.line.updateMatrix();\r\n\r\n  this.cone.scale.set(headWidth, headLength, headWidth);\r\n  this.cone.position.y = length;\r\n  this.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function(color) {\r\n\r\n  this.line.material.color.set(color);\r\n  this.cone.material.color.set(color);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function(object) {\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(new Float32Array(72), 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: 0xffff00\r\n  }), THREE.LinePieces);\r\n\r\n  if (object !== undefined) {\r\n\r\n    this.update(object);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = function(object) {\r\n\r\n  var geometry = object.geometry;\r\n\r\n  if (geometry.boundingBox === null) {\r\n\r\n    geometry.computeBoundingBox();\r\n\r\n  }\r\n\r\n  var min = geometry.boundingBox.min;\r\n  var max = geometry.boundingBox.max;\r\n\r\n  /*\r\n    5____4\r\n  1/___0/|\r\n  | 6__|_7\r\n  2/___3/\r\n\r\n  0: max.x, max.y, max.z\r\n  1: min.x, max.y, max.z\r\n  2: min.x, min.y, max.z\r\n  3: max.x, min.y, max.z\r\n  4: max.x, max.y, min.z\r\n  5: min.x, max.y, min.z\r\n  6: min.x, min.y, min.z\r\n  7: max.x, min.y, min.z\r\n  */\r\n\r\n  var vertices = this.geometry.attributes.position.array;\r\n\r\n  vertices[0] = max.x;\r\n  vertices[1] = max.y;\r\n  vertices[2] = max.z;\r\n  vertices[3] = min.x;\r\n  vertices[4] = max.y;\r\n  vertices[5] = max.z;\r\n\r\n  vertices[6] = min.x;\r\n  vertices[7] = max.y;\r\n  vertices[8] = max.z;\r\n  vertices[9] = min.x;\r\n  vertices[10] = min.y;\r\n  vertices[11] = max.z;\r\n\r\n  vertices[12] = min.x;\r\n  vertices[13] = min.y;\r\n  vertices[14] = max.z;\r\n  vertices[15] = max.x;\r\n  vertices[16] = min.y;\r\n  vertices[17] = max.z;\r\n\r\n  vertices[18] = max.x;\r\n  vertices[19] = min.y;\r\n  vertices[20] = max.z;\r\n  vertices[21] = max.x;\r\n  vertices[22] = max.y;\r\n  vertices[23] = max.z;\r\n\r\n  //\r\n\r\n  vertices[24] = max.x;\r\n  vertices[25] = max.y;\r\n  vertices[26] = min.z;\r\n  vertices[27] = min.x;\r\n  vertices[28] = max.y;\r\n  vertices[29] = min.z;\r\n\r\n  vertices[30] = min.x;\r\n  vertices[31] = max.y;\r\n  vertices[32] = min.z;\r\n  vertices[33] = min.x;\r\n  vertices[34] = min.y;\r\n  vertices[35] = min.z;\r\n\r\n  vertices[36] = min.x;\r\n  vertices[37] = min.y;\r\n  vertices[38] = min.z;\r\n  vertices[39] = max.x;\r\n  vertices[40] = min.y;\r\n  vertices[41] = min.z;\r\n\r\n  vertices[42] = max.x;\r\n  vertices[43] = min.y;\r\n  vertices[44] = min.z;\r\n  vertices[45] = max.x;\r\n  vertices[46] = max.y;\r\n  vertices[47] = min.z;\r\n\r\n  //\r\n\r\n  vertices[48] = max.x;\r\n  vertices[49] = max.y;\r\n  vertices[50] = max.z;\r\n  vertices[51] = max.x;\r\n  vertices[52] = max.y;\r\n  vertices[53] = min.z;\r\n\r\n  vertices[54] = min.x;\r\n  vertices[55] = max.y;\r\n  vertices[56] = max.z;\r\n  vertices[57] = min.x;\r\n  vertices[58] = max.y;\r\n  vertices[59] = min.z;\r\n\r\n  vertices[60] = min.x;\r\n  vertices[61] = min.y;\r\n  vertices[62] = max.z;\r\n  vertices[63] = min.x;\r\n  vertices[64] = min.y;\r\n  vertices[65] = min.z;\r\n\r\n  vertices[66] = max.x;\r\n  vertices[67] = min.y;\r\n  vertices[68] = max.z;\r\n  vertices[69] = max.x;\r\n  vertices[70] = min.y;\r\n  vertices[71] = min.z;\r\n\r\n  this.geometry.attributes.position.needsUpdate = true;\r\n\r\n  this.geometry.computeBoundingSphere();\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0x888888;\r\n\r\n  this.object = object;\r\n\r\n  this.box = new THREE.Box3();\r\n\r\n  THREE.Mesh.call(this, new THREE.BoxGeometry(1, 1, 1), new THREE.MeshBasicMaterial({\r\n    color: color,\r\n    wireframe: true\r\n  }));\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function() {\r\n\r\n  this.box.setFromObject(this.object);\r\n\r\n  this.box.size(this.scale);\r\n\r\n  this.box.center(this.position);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function(camera) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    color: 0xffffff,\r\n    vertexColors: THREE.FaceColors\r\n  });\r\n\r\n  var pointMap = {};\r\n\r\n  // colors\r\n\r\n  var hexFrustum = 0xffaa00;\r\n  var hexCone = 0xff0000;\r\n  var hexUp = 0x00aaff;\r\n  var hexTarget = 0xffffff;\r\n  var hexCross = 0x333333;\r\n\r\n  // near\r\n\r\n  addLine(\"n1\", \"n2\", hexFrustum);\r\n  addLine(\"n2\", \"n4\", hexFrustum);\r\n  addLine(\"n4\", \"n3\", hexFrustum);\r\n  addLine(\"n3\", \"n1\", hexFrustum);\r\n\r\n  // far\r\n\r\n  addLine(\"f1\", \"f2\", hexFrustum);\r\n  addLine(\"f2\", \"f4\", hexFrustum);\r\n  addLine(\"f4\", \"f3\", hexFrustum);\r\n  addLine(\"f3\", \"f1\", hexFrustum);\r\n\r\n  // sides\r\n\r\n  addLine(\"n1\", \"f1\", hexFrustum);\r\n  addLine(\"n2\", \"f2\", hexFrustum);\r\n  addLine(\"n3\", \"f3\", hexFrustum);\r\n  addLine(\"n4\", \"f4\", hexFrustum);\r\n\r\n  // cone\r\n\r\n  addLine(\"p\", \"n1\", hexCone);\r\n  addLine(\"p\", \"n2\", hexCone);\r\n  addLine(\"p\", \"n3\", hexCone);\r\n  addLine(\"p\", \"n4\", hexCone);\r\n\r\n  // up\r\n\r\n  addLine(\"u1\", \"u2\", hexUp);\r\n  addLine(\"u2\", \"u3\", hexUp);\r\n  addLine(\"u3\", \"u1\", hexUp);\r\n\r\n  // target\r\n\r\n  addLine(\"c\", \"t\", hexTarget);\r\n  addLine(\"p\", \"c\", hexCross);\r\n\r\n  // cross\r\n\r\n  addLine(\"cn1\", \"cn2\", hexCross);\r\n  addLine(\"cn3\", \"cn4\", hexCross);\r\n\r\n  addLine(\"cf1\", \"cf2\", hexCross);\r\n  addLine(\"cf3\", \"cf4\", hexCross);\r\n\r\n  function addLine(a, b, hex) {\r\n\r\n    addPoint(a, hex);\r\n    addPoint(b, hex);\r\n\r\n  }\r\n\r\n  function addPoint(id, hex) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3());\r\n    geometry.colors.push(new THREE.Color(hex));\r\n\r\n    if (pointMap[id] === undefined) {\r\n\r\n      pointMap[id] = [];\r\n\r\n    }\r\n\r\n    pointMap[id].push(geometry.vertices.length - 1);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.camera = camera;\r\n  this.matrix = camera.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.pointMap = pointMap;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function() {\r\n\r\n  var geometry, pointMap;\r\n\r\n  var vector = new THREE.Vector3();\r\n  var camera = new THREE.Camera();\r\n\r\n  var setPoint = function(point, x, y, z) {\r\n\r\n    vector.set(x, y, z).unproject(camera);\r\n\r\n    var points = pointMap[point];\r\n\r\n    if (points !== undefined) {\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        geometry.vertices[points[i]].copy(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  return function() {\r\n\r\n    geometry = this.geometry;\r\n    pointMap = this.pointMap;\r\n\r\n    var w = 1,\r\n      h = 1;\r\n\r\n    // we need just camera projection matrix\r\n    // world matrix must be identity\r\n\r\n    camera.projectionMatrix.copy(this.camera.projectionMatrix);\r\n\r\n    // center / target\r\n\r\n    setPoint(\"c\", 0, 0, -1);\r\n    setPoint(\"t\", 0, 0, 1);\r\n\r\n    // near\r\n\r\n    setPoint(\"n1\", -w, -h, -1);\r\n    setPoint(\"n2\", w, -h, -1);\r\n    setPoint(\"n3\", -w, h, -1);\r\n    setPoint(\"n4\", w, h, -1);\r\n\r\n    // far\r\n\r\n    setPoint(\"f1\", -w, -h, 1);\r\n    setPoint(\"f2\", w, -h, 1);\r\n    setPoint(\"f3\", -w, h, 1);\r\n    setPoint(\"f4\", w, h, 1);\r\n\r\n    // up\r\n\r\n    setPoint(\"u1\", w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u2\", -w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u3\", 0, h * 2, -1);\r\n\r\n    // cross\r\n\r\n    setPoint(\"cf1\", -w, 0, 1);\r\n    setPoint(\"cf2\", w, 0, 1);\r\n    setPoint(\"cf3\", 0, -h, 1);\r\n    setPoint(\"cf4\", 0, h, 1);\r\n\r\n    setPoint(\"cn1\", -w, 0, -1);\r\n    setPoint(\"cn2\", w, 0, -1);\r\n    setPoint(\"cn3\", 0, -h, -1);\r\n    setPoint(\"cn4\", 0, h, -1);\r\n\r\n    geometry.verticesNeedUpdate = true;\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function(light, size) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  size = size || 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(-size, size, 0),\r\n    new THREE.Vector3(size, size, 0),\r\n    new THREE.Vector3(size, -size, 0),\r\n    new THREE.Vector3(-size, -size, 0),\r\n    new THREE.Vector3(-size, size, 0)\r\n  );\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.lightPlane = new THREE.Line(geometry, material);\r\n  this.add(this.lightPlane);\r\n\r\n  geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(),\r\n    new THREE.Vector3()\r\n  );\r\n\r\n  material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.targetLine = new THREE.Line(geometry, material);\r\n  this.add(this.targetLine);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function() {\r\n\r\n  this.lightPlane.geometry.dispose();\r\n  this.lightPlane.material.dispose();\r\n  this.targetLine.geometry.dispose();\r\n  this.targetLine.material.dispose();\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n  var v3 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    v1.setFromMatrixPosition(this.light.matrixWorld);\r\n    v2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n    v3.subVectors(v2, v1);\r\n\r\n    this.lightPlane.lookAt(v3);\r\n    this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n    this.targetLine.geometry.vertices[1].copy(v3);\r\n    this.targetLine.geometry.verticesNeedUpdate = true;\r\n    this.targetLine.material.color.copy(this.lightPlane.material.color);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimim angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function(object, hex, thresholdAngle) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n  thresholdAngle = (thresholdAngle !== undefined) ? thresholdAngle : 1;\r\n\r\n  var thresholdDot = Math.cos(THREE.Math.degToRad(thresholdAngle));\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  var geometry2;\r\n\r\n  if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    geometry2 = new THREE.Geometry();\r\n    geometry2.fromBufferGeometry(object.geometry);\r\n\r\n  }\r\n  else {\r\n\r\n    geometry2 = object.geometry.clone();\r\n\r\n  }\r\n\r\n  geometry2.mergeVertices();\r\n  geometry2.computeFaceNormals();\r\n\r\n  var vertices = geometry2.vertices;\r\n  var faces = geometry2.faces;\r\n  var numEdges = 0;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0; j < 3; j++) {\r\n\r\n      edge[0] = face[keys[j]];\r\n      edge[1] = face[keys[(j + 1) % 3]];\r\n      edge.sort(sortFunction);\r\n\r\n      var key = edge.toString();\r\n\r\n      if (hash[key] === undefined) {\r\n\r\n        hash[key] = {\r\n          vert1: edge[0],\r\n          vert2: edge[1],\r\n          face1: i,\r\n          face2: undefined\r\n        };\r\n        numEdges++;\r\n\r\n      }\r\n      else {\r\n\r\n        hash[key].face2 = i;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n  var index = 0;\r\n\r\n  for (var key in hash) {\r\n\r\n    var h = hash[key];\r\n\r\n    if (h.face2 === undefined || faces[h.face1].normal.dot(faces[h.face2].normal) <= thresholdDot) {\r\n\r\n      var vertex = vertices[h.vert1];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n      vertex = vertices[h.vert2];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.FaceNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffff00;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = this.object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = function() {\r\n\r\n  var vertices = this.geometry.vertices;\r\n\r\n  var object = this.object;\r\n  var objectVertices = object.geometry.vertices;\r\n  var objectFaces = object.geometry.faces;\r\n  var objectWorldMatrix = object.matrixWorld;\r\n\r\n  object.updateMatrixWorld(true);\r\n\r\n  this.normalMatrix.getNormalMatrix(objectWorldMatrix);\r\n\r\n  for (var i = 0, i2 = 0, l = objectFaces.length; i < l; i++, i2 += 2) {\r\n\r\n    var face = objectFaces[i];\r\n\r\n    vertices[i2].copy(objectVertices[face.a])\r\n      .add(objectVertices[face.b])\r\n      .add(objectVertices[face.c])\r\n      .divideScalar(3)\r\n      .applyMatrix4(objectWorldMatrix);\r\n\r\n    vertices[i2 + 1].copy(face.normal)\r\n      .applyMatrix3(this.normalMatrix)\r\n      .normalize()\r\n      .multiplyScalar(this.size)\r\n      .add(vertices[i2]);\r\n\r\n  }\r\n\r\n  this.geometry.verticesNeedUpdate = true;\r\n\r\n  return this;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function(size, step) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  this.color1 = new THREE.Color(0x444444);\r\n  this.color2 = new THREE.Color(0x888888);\r\n\r\n  for (var i = -size; i <= size; i += step) {\r\n\r\n    geometry.vertices.push(\r\n      new THREE.Vector3(-size, 0, i), new THREE.Vector3(size, 0, i),\r\n      new THREE.Vector3(i, 0, -size), new THREE.Vector3(i, 0, size)\r\n    );\r\n\r\n    var color = i === 0 ? this.color1 : this.color2;\r\n\r\n    geometry.colors.push(color, color, color, color);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function(colorCenterLine, colorGrid) {\r\n\r\n  this.color1.set(colorCenterLine);\r\n  this.color2.set(colorGrid);\r\n\r\n  this.geometry.colorsNeedUpdate = true;\r\n\r\n}\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function(light, sphereSize) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.colors = [new THREE.Color(), new THREE.Color()];\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  for (var i = 0, il = 8; i < il; i++) {\r\n\r\n    geometry.faces[i].color = this.colors[i < 4 ? 0 : 1];\r\n\r\n  }\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    vertexColors: THREE.FaceColors,\r\n    wireframe: true\r\n  });\r\n\r\n  this.lightSphere = new THREE.Mesh(geometry, material);\r\n  this.add(this.lightSphere);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function() {\r\n  this.lightSphere.geometry.dispose();\r\n  this.lightSphere.material.dispose();\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);\r\n    this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);\r\n\r\n    this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate());\r\n    this.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n  }\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function(light, sphereSize) {\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.matrix = this.light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  /*\r\n  var distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n  var distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n  this.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n  this.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n  var d = light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n\r\n  this.add( this.lightDistance );\r\n  */\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function() {\r\n\r\n  this.geometry.dispose();\r\n  this.material.dispose();\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function() {\r\n\r\n  this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  /*\r\n  var d = this.light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.visible = true;\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n  */\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function(object) {\r\n\r\n  this.bones = this.getBoneList(object);\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.colors.push(new THREE.Color(0, 0, 1));\r\n      geometry.colors.push(new THREE.Color(0, 1, 0));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors,\r\n    depthTest: false,\r\n    depthWrite: false,\r\n    transparent: true\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.root = object;\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function(object) {\r\n\r\n  var boneList = [];\r\n\r\n  if (object instanceof THREE.Bone) {\r\n\r\n    boneList.push(object);\r\n\r\n  }\r\n\r\n  for (var i = 0; i < object.children.length; i++) {\r\n\r\n    boneList.push.apply(boneList, this.getBoneList(object.children[i]));\r\n\r\n  }\r\n\r\n  return boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  var matrixWorldInv = new THREE.Matrix4().getInverse(this.root.matrixWorld);\r\n\r\n  var boneMatrix = new THREE.Matrix4();\r\n\r\n  var j = 0;\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.matrixWorld);\r\n      geometry.vertices[j].setFromMatrixPosition(boneMatrix);\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.parent.matrixWorld);\r\n      geometry.vertices[j + 1].setFromMatrixPosition(boneMatrix);\r\n\r\n      j += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.verticesNeedUpdate = true;\r\n\r\n  geometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.SpotLightHelper = function(light) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  var geometry = new THREE.CylinderGeometry(0, 1, 1, 8, 1, true);\r\n\r\n  geometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n\r\n  this.cone = new THREE.Mesh(geometry, material);\r\n  this.add(this.cone);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function() {\r\n  this.cone.geometry.dispose();\r\n  this.cone.material.dispose();\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n  var vector2 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    var coneLength = this.light.distance ? this.light.distance : 10000;\r\n    var coneWidth = coneLength * Math.tan(this.light.angle);\r\n\r\n    this.cone.scale.set(coneWidth, coneWidth, coneLength);\r\n\r\n    vector.setFromMatrixPosition(this.light.matrixWorld);\r\n    vector2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n\r\n    this.cone.lookAt(vector2.sub(vector));\r\n\r\n    this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xff0000;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    this.normalMatrix.getNormalMatrix(this.object.matrixWorld);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var normal = face.vertexNormals[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/VertexTangentsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexTangentsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0x0000ff;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexTangentsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexTangentsHelper.prototype.constructor = THREE.VertexTangentsHelper;\r\n\r\nTHREE.VertexTangentsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var tangent = face.vertexTangents[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(tangent).transformDirection(worldMatrix).multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  if (object.geometry instanceof THREE.Geometry) {\r\n\r\n    var vertices = object.geometry.vertices;\r\n    var faces = object.geometry.faces;\r\n    var numEdges = 0;\r\n\r\n    // allocate maximal size\r\n    var edges = new Uint32Array(6 * faces.length);\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0; j < 3; j++) {\r\n\r\n        edge[0] = face[keys[j]];\r\n        edge[1] = face[keys[(j + 1) % 3]];\r\n        edge.sort(sortFunction);\r\n\r\n        var key = edge.toString();\r\n\r\n        if (hash[key] === undefined) {\r\n\r\n          edges[2 * numEdges] = edge[0];\r\n          edges[2 * numEdges + 1] = edge[1];\r\n          hash[key] = true;\r\n          numEdges++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n    for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n      for (var j = 0; j < 2; j++) {\r\n\r\n        var vertex = vertices[edges[2 * i + j]];\r\n\r\n        var index = 6 * i + 3 * j;\r\n        coords[index + 0] = vertex.x;\r\n        coords[index + 1] = vertex.y;\r\n        coords[index + 2] = vertex.z;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  }\r\n  else if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    if (object.geometry.attributes.index !== undefined) { // Indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var indices = object.geometry.attributes.index.array;\r\n      var drawcalls = object.geometry.drawcalls;\r\n      var numEdges = 0;\r\n\r\n      if (drawcalls.length === 0) {\r\n\r\n        drawcalls = [{\r\n          count: indices.length,\r\n          index: 0,\r\n          start: 0\r\n        }];\r\n\r\n      }\r\n\r\n      // allocate maximal size\r\n      var edges = new Uint32Array(2 * indices.length);\r\n\r\n      for (var o = 0, ol = drawcalls.length; o < ol; ++o) {\r\n\r\n        var start = drawcalls[o].start;\r\n        var count = drawcalls[o].count;\r\n        var index = drawcalls[o].index;\r\n\r\n        for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n          for (var j = 0; j < 3; j++) {\r\n\r\n            edge[0] = index + indices[i + j];\r\n            edge[1] = index + indices[i + (j + 1) % 3];\r\n            edge.sort(sortFunction);\r\n\r\n            var key = edge.toString();\r\n\r\n            if (hash[key] === undefined) {\r\n\r\n              edges[2 * numEdges] = edge[0];\r\n              edges[2 * numEdges + 1] = edge[1];\r\n              hash[key] = true;\r\n              numEdges++;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n        for (var j = 0; j < 2; j++) {\r\n\r\n          var index = 6 * i + 3 * j;\r\n          var index2 = 3 * edges[2 * i + j];\r\n          coords[index + 0] = vertices[index2];\r\n          coords[index + 1] = vertices[index2 + 1];\r\n          coords[index + 2] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n    else { // non-indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var numEdges = vertices.length / 3;\r\n      var numTris = numEdges / 3;\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numTris; i < l; i++) {\r\n\r\n        for (var j = 0; j < 3; j++) {\r\n\r\n          var index = 18 * i + 6 * j;\r\n\r\n          var index1 = 9 * i + 3 * j;\r\n          coords[index + 0] = vertices[index1];\r\n          coords[index + 1] = vertices[index1 + 1];\r\n          coords[index + 2] = vertices[index1 + 2];\r\n\r\n          var index2 = 9 * i + 3 * ((j + 1) % 3);\r\n          coords[index + 3] = vertices[index2];\r\n          coords[index + 4] = vertices[index2 + 1];\r\n          coords[index + 5] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.render = function(renderCallback) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.animationsMap = {};\r\n  this.animationsList = [];\r\n\r\n  // prepare default animation\r\n  // (all frames played together in 1 second)\r\n\r\n  var numFrames = this.geometry.morphTargets.length;\r\n\r\n  var name = \"__default\";\r\n\r\n  var startFrame = 0;\r\n  var endFrame = numFrames - 1;\r\n\r\n  var fps = numFrames / 1;\r\n\r\n  this.createAnimation(name, startFrame, endFrame, fps);\r\n  this.setAnimationWeight(name, 1);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function(name, start, end, fps) {\r\n\r\n  var animation = {\r\n\r\n    startFrame: start,\r\n    endFrame: end,\r\n\r\n    length: end - start + 1,\r\n\r\n    fps: fps,\r\n    duration: (end - start) / fps,\r\n\r\n    lastFrame: 0,\r\n    currentFrame: 0,\r\n\r\n    active: false,\r\n\r\n    time: 0,\r\n    direction: 1,\r\n    weight: 1,\r\n\r\n    directionBackwards: false,\r\n    mirroredLoop: false\r\n\r\n  };\r\n\r\n  this.animationsMap[name] = animation;\r\n  this.animationsList.push(animation);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function(fps) {\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  var firstAnimation, frameRanges = {};\r\n\r\n  var geometry = this.geometry;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var chunks = morph.name.match(pattern);\r\n\r\n    if (chunks && chunks.length > 1) {\r\n\r\n      var name = chunks[1];\r\n\r\n      if (!frameRanges[name]) frameRanges[name] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var range = frameRanges[name];\r\n\r\n      if (i < range.start) range.start = i;\r\n      if (i > range.end) range.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = name;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var name in frameRanges) {\r\n\r\n    var range = frameRanges[name];\r\n    this.createAnimation(name, range.start, range.end, fps);\r\n\r\n  }\r\n\r\n  this.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = 1;\r\n    animation.directionBackwards = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = -1;\r\n    animation.directionBackwards = true;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function(name, fps) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.fps = fps;\r\n    animation.duration = (animation.end - animation.start) / animation.fps;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function(name, duration) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.duration = duration;\r\n    animation.fps = (animation.end - animation.start) / animation.duration;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function(name, weight) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.weight = weight;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function(name, time) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = time;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function(name) {\r\n\r\n  var time = 0;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    time = animation.time;\r\n\r\n  }\r\n\r\n  return time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function(name) {\r\n\r\n  var duration = -1;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    duration = animation.duration;\r\n\r\n  }\r\n\r\n  return duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = 0;\r\n    animation.active = true;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn(\"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\");\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.active = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function(delta) {\r\n\r\n  for (var i = 0, il = this.animationsList.length; i < il; i++) {\r\n\r\n    var animation = this.animationsList[i];\r\n\r\n    if (!animation.active) continue;\r\n\r\n    var frameTime = animation.duration / animation.length;\r\n\r\n    animation.time += animation.direction * delta;\r\n\r\n    if (animation.mirroredLoop) {\r\n\r\n      if (animation.time > animation.duration || animation.time < 0) {\r\n\r\n        animation.direction *= -1;\r\n\r\n        if (animation.time > animation.duration) {\r\n\r\n          animation.time = animation.duration;\r\n          animation.directionBackwards = true;\r\n\r\n        }\r\n\r\n        if (animation.time < 0) {\r\n\r\n          animation.time = 0;\r\n          animation.directionBackwards = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      animation.time = animation.time % animation.duration;\r\n\r\n      if (animation.time < 0) animation.time += animation.duration;\r\n\r\n    }\r\n\r\n    var keyframe = animation.startFrame + THREE.Math.clamp(Math.floor(animation.time / frameTime), 0, animation.length - 1);\r\n    var weight = animation.weight;\r\n\r\n    if (keyframe !== animation.currentFrame) {\r\n\r\n      this.morphTargetInfluences[animation.lastFrame] = 0;\r\n      this.morphTargetInfluences[animation.currentFrame] = 1 * weight;\r\n\r\n      this.morphTargetInfluences[keyframe] = 0;\r\n\r\n      animation.lastFrame = animation.currentFrame;\r\n      animation.currentFrame = keyframe;\r\n\r\n    }\r\n\r\n    var mix = (animation.time % frameTime) / frameTime;\r\n\r\n    if (animation.directionBackwards) mix = 1 - mix;\r\n\r\n    this.morphTargetInfluences[animation.currentFrame] = mix * weight;\r\n    this.morphTargetInfluences[animation.lastFrame] = (1 - mix) * weight;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n}\r\nelse {\r\n  this['THREE'] = THREE;\r\n}\r\n\r\n","module.exports = {\n\n  Entity         : require('./lib/Entity.js'),\n  EntityManager  : require('./lib/EntityManager.js'),\n  Messanger      : require('./lib/Messanger.js'),\n  ObjectPool     : require('./lib/ObjectPool.js'),\n  QuadTree       : require('./lib/QuadTree.js'),\n  Spatial        : require('./lib/Spatial.js'),\n  Vec2           : require('./lib/Vec2.js')\n\n};\n","module.exports = Identifier;\r\n\r\nfunction Identifier() {\r\n  this.type = null;\r\n}\r\n\r\n","module.exports = Position;\r\n\r\nfunction Position() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n}\r\n\r\n","module.exports = Velocity;\r\n\r\nfunction Velocity() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n\r\n  this.rotationMatrix = null;\r\n\r\n  this.doMove = true;\r\n}\r\n\r\n","module.exports = Jump;\r\n\r\nfunction Jump() {\r\n  this.canJump = true;\r\n}\r\n\r\n","module.exports = CameraFollow;\r\n\r\nfunction CameraFollow() {\r\n  this.controls = null;\r\n  this.object = null;\r\n  this.offset = new THREE.Vector3();\r\n}\r\n\r\n","module.exports = ShootDelay;\r\n\r\nfunction ShootDelay() {\r\n  this.canShoot = true;\r\n\r\n  this.timer = 0;\r\n  this.delayTheshold = 0.2;\r\n}\r\n\r\n","module.exports = Expirable;\r\n\r\nfunction Expirable() {\r\n  this.age = 0;\r\n  this.maxAge = 5;\r\n}\r\n\r\n","module.exports = Drawable;\r\n\r\nfunction Drawable() {\r\n  this.mesh = null;\r\n  this.scene = null;\r\n}\r\n\r\n","module.exports = Hurt;\r\n\r\nfunction Hurt() {\r\n  this.timer = 0;\r\n  this.invulnerabilityFrames = 1;\r\n\r\n  this.hurtColor = new THREE.Color(0xdd0000);\r\n  this.originalColor = 0xffffff;\r\n}\r\n\r\n","module.exports = OneTimeHit;\r\n\r\nfunction OneTimeHit() {\r\n  this.alreadyHit = [];\r\n}\r\n\r\n","module.exports = Health;\r\n\r\nfunction Health() {\r\n  this.hp = 3;\r\n  this.maxHP = 3;\r\n\r\n  this.healthBar = null;\r\n\r\n  this.changed = false;\r\n}\r\n\r\n","module.exports = Steaming;\r\n\r\nfunction Steaming() {\r\n  this.particles = null;\r\n  this.system = null;\r\n  this.parent = null;\r\n  this.container = null;\r\n}\r\n\r\n","module.exports = Bullet;\r\n\r\nfunction Bullet() {\r\n  this.isHot = true;\r\n  this.owner = null;\r\n}\r\n\r\n","module.exports = Ai;\r\n\r\nfunction Ai() {\r\n  this.tree = null;\r\n  this.target = null;\r\n  this.blackboard = null;\r\n}\r\n\r\n","module.exports = CameraPitch;\r\n\r\nfunction CameraPitch() {\r\n  this.controls = null;\r\n  this.offset = 0;\r\n}\r\n\r\n","module.exports = Gun;\r\n\r\nfunction Gun() {\r\n  this.entity = null;\r\n  this.mesh = null;\r\n}\r\n\r\n","module.exports = Entity;\n\n/**\n * Basic component-driven object with facade functions for interacting with the\n * injected EntityManager object.\n * @constructor\n */\nfunction Entity()\n{\n  // Injected by EntityManager\n  this._manager    = null;\n\n  /**\n   * @type {Array.<Function>}\n   * @private\n   */\n  this._Components = [];\n\n  /**\n   * @type {Array.<String>}\n   * @private\n   */\n  this._tags       = [];\n}\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.addComponent = function(TComponent)\n{\n  this._manager.entityAddComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.removeComponent = function(TComponent)\n{\n  this._manager.entityRemoveComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {boolean} True if this entity has TComponent.\n */\nEntity.prototype.hasComponent = function(TComponent)\n{\n  return !!~this._Components.indexOf(TComponent);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {boolean} True if entity has all Components.\n */\nEntity.prototype.hasAllComponents = function(Components)\n{\n  var b = true;\n\n  for (var i = 0; i < Components.length; i++) {\n    var C = Components[i];\n    b &= !!~this._Components.indexOf(C);\n  }\n\n  return b;\n};\n\n/**\n * @param {String} tag\n * @return {boolean} True if entity has tag.\n */\nEntity.prototype.hasTag = function(tag)\n{\n  return !!~this._tags.indexOf(tag);\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.addTag = function(tag)\n{\n  this._manager.entityAddTag(this, tag);\n  return this;\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.removeTag = function(tag)\n{\n  this._manager.entityRemoveTag(this, tag);\n  return this;\n};\n\n/**\n * @return {void}\n */\nEntity.prototype.remove = function()\n{\n  return this._manager.removeEntity(this);\n};\n\n","module.exports = EntityManager;\n\nvar Entity     = require('./Entity.js');\nvar ObjectPool = require('./ObjectPool.js');\nvar Messanger  = require('./Messanger.js');\nvar getName    = require('typedef').getName;\n\n/**\n * Manage, create, and destroy entities. Can use methods to mutate entities\n * (tags, components) directly or via the facade on the Entity.\n * @param {Messanger} messanger\n * @constructor\n */\nfunction EntityManager(messanger)\n{\n  this.messanger = messanger;\n  this._tags = {};\n\n  /**\n   * @type {Array.<Entity>}\n   */\n  this._entities = [];\n\n  /**\n   * @type {Array.<Group>}\n   */\n  this._groups = {};\n\n  this._entityPool = new ObjectPool(Entity);\n\n  this._componentPools = {};\n}\n\n/**\n * Fired AFTER an entity has be created.\n * @event\n */\nEntityManager.ENTITY_CREATED = 'EntityManager#ENTITY_CREATED';\n\n/**\n * Fired BEFORE an entity has been removed.\n * @event\n */\nEntityManager.ENTITY_REMOVE = 'EntityManager#ENTITY_REMOVE';\n\n/**\n * Fired AFTER a component has been removed.\n * @event\n */\nEntityManager.COMPONENT_ADDED = 'EntityManager#COMPONENT_ADDED';\n\n/**\n * Fired BEFORE a component has been removedt\n * @event\n */\nEntityManager.COMPONENT_REMOVE = 'EntityManager#COMPONENT_REMOVE';\n\n/**\n * @constructor\n * @param {Array.<Function>} Components\n * @param {Array<Entity>} entities\n */\nfunction Group(Components, entities)\n{\n  this.Components = Components || [];\n  this.entities = entities || [];\n}\n\n/**\n * Get a new entity.\n * @return {Entity}\n */\nEntityManager.prototype.createEntity = function()\n{\n  var entity = this._entityPool.aquire();\n\n  this._entities.push(entity);\n  entity._manager = this;\n  this._trigger(EntityManager.ENTITY_CREATED, entity);\n  return entity;\n};\n\n/**\n * Cleanly remove entities based on tag. Avoids loop issues.\n * @param {String} tag\n */\nEntityManager.prototype.removeEntitiesByTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities) return;\n\n  for (var x = entities.length - 1; x >= 0; x--) {\n    var entity = entities[x];\n    entity.remove();\n  }\n};\n\n/**\n * Dump all entities out of the manager. Avoids loop issues.\n */\nEntityManager.prototype.removeAllEntities = function()\n{\n  for (var x = this._entities.length - 1; x >= 0; x--) {\n    this._entities[x].remove();\n  }\n};\n\n/**\n * Drop an entity. Returns it to the pool and fires all events for removing\n * components as well.\n * @param {Entity} entity\n */\nEntityManager.prototype.removeEntity = function(entity)\n{\n  var index = this._entities.indexOf(entity);\n\n  if (!~index)\n    throw new Error('Tried to remove entity not in list');\n\n  this.entityRemoveAllComponents(entity);\n\n  // Remove from entity list\n  this._trigger(EntityManager.ENTITY_REMOVE, entity);\n  this._entities.splice(index, 1);\n\n  // Remove entity from any tag groups\n  entity._tags = null;\n  for (var tag in this._tags) {\n    var entities = this._tags[tag];\n    var n = entities.indexOf(entity);\n    if (~n) entities.splice(n, 1);\n  }\n\n  // Prevent any acecss and free\n  entity._manager = null;\n  this._entityPool.release(entity);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityAddTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities)\n    entities = this._tags[tag] = [];\n\n  // Don't add if already there\n  if (~entities.indexOf(entity)) return;\n\n  entities.push(entity);\n  entity._tags.push(tag);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityRemoveTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n  if (!entities) return;\n\n  var index = entities.indexOf(entity);\n  if (!~index) return;\n\n  entities.splice(index, 1);\n  entity._tags.splice(entity._tags.indexOf(tag), 1);\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityAddComponent = function(entity, Component)\n{\n  if (~entity._Components.indexOf(Component)) return;\n\n  entity._Components.push(Component);\n\n  // Create the reference on the entity to this (aquired) component\n  var cName = componentPropertyName(Component);\n  var cPool = this._componentPools[cName];\n  if (!cPool)\n    cPool = this._componentPools[cName] = new ObjectPool(Component);\n  var component = cPool.aquire();\n  entity[cName] = component;\n\n  // Check each indexed group to see if we need to add this entity to the list\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n    if (~group.entities.indexOf(entity))\n      continue;\n\n    group.entities.push(entity);\n  }\n\n  this._trigger(EntityManager.COMPONENT_ADDED, entity, Component);\n};\n\n/**\n * Drop all components on an entity.\n * @param {Entity} entity\n */\nEntityManager.prototype.entityRemoveAllComponents = function(entity)\n{\n  var Cs = entity._Components;\n\n  for (var j = Cs.length - 1; j >= 0; j--) {\n    var C = Cs[j];\n    entity.removeComponent(C);\n  }\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityRemoveComponent = function(entity, Component)\n{\n  var index = entity._Components.indexOf(Component);\n  if (!~index) return;\n\n  this._trigger(EntityManager.COMPONENT_REMOVE, entity, Component);\n\n  // Check each indexed group to see if we need to remove it\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n\n    var loc = group.entities.indexOf(entity);\n    if (~loc) {\n      group.entities.splice(loc, 1);\n    }\n  }\n\n  // Remove T listing on entity and property ref, then free the component.\n  var propName = componentPropertyName(Component);\n  entity._Components.splice(index, 1);\n  var component = entity[propName];\n  delete entity[propName];\n  this._componentPools[propName].release(component);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryComponents = function(Components)\n{\n  var group = this._groups[groupKey(Components)];\n\n  if (!group) {\n    group = this._indexGroup(Components);\n  }\n\n  return group.entities;\n};\n\n/**\n * @param {String} tag\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (entities === undefined)\n    entities = this._tags[tag] = [];\n\n  return entities;\n};\n\n/**\n * @return {Number} Total number of entities.\n */\nEntityManager.prototype.count = function()\n{\n  return this._entities.length;\n};\n\n/**\n * Get information about the object pools of the entities and the various\n * components.\n * @return {Object}\n */\nEntityManager.prototype.poolStats = function()\n{\n  var stats = {};\n  var e = this._entityPool;\n  stats.entity = {\n    used: this._entityPool.totalUsed(),\n    size: this._entityPool.count\n  };\n\n  for (var cName in this._componentPools) {\n    var pool = this._componentPools[cName];\n    stats[cName] = {\n      used: pool.totalUsed(),\n      size: pool.count\n    };\n  }\n\n  return stats;\n};\n\n/**\n * Create an index of entities with a set of components.\n * @param {Array.<Function>} Components\n * @private\n */\nEntityManager.prototype._indexGroup = function(Components)\n{\n  var key = groupKey(Components);\n\n  if (this._groups[key]) return;\n\n  var group = this._groups[key] = new Group(Components);\n\n  for (var n = 0; n < this._entities.length; n++) {\n    var entity = this._entities[n];\n    if (entity.hasAllComponents(Components)) {\n      group.entities.push(entity);\n    }\n  }\n\n  return group;\n};\n\n/**\n * Trigger the messanger if we have one.\n * @param {String} event\n * @param {Object=} a\n * @param {Object=} b\n */\nEntityManager.prototype._trigger = function(event, a, b)\n{\n  if (this.messanger)\n    this.messanger.trigger(event, a, b);\n};\n\n/**\n * @param {Function} Component\n * @return {String}\n * @private\n */\nfunction componentPropertyName(Component)\n{\n  var name = getName(Component);\n  return name.charAt(0).toLowerCase() + name.slice(1);\n}\n\n/**\n * @param {Array.<Function>} Components\n * @return {String}\n * @private\n */\nfunction groupKey(Components)\n{\n  var names = [];\n  for (var n = 0; n < Components.length; n++) {\n    var T = Components[n];\n    names.push(getName(T));\n  }\n\n  return names\n    .map(function(x) { return x.toLowerCase(); })\n    .sort()\n    .join('-');\n}\n\n","module.exports = Messanger;\n\nvar Event = require('./Event.js');\n\n/**\n * General event aggregation with filtering on components or tags.\n * @constructor\n */\nfunction Messanger()\n{\n  this._events = {};\n  this.fired   = 0;\n  this.handled = 0;\n}\n\n/**\n * @param {String} eventName\n * @param {Function} callback\n * @return {Event}\n */\nMessanger.prototype.listenTo = function(eventName, callback)\n{\n  if (!this._events[eventName])\n    this._events[eventName] = [];\n\n  var event = new Event(eventName, callback);\n\n  // Dump and chump\n  this._events[eventName].push(event);\n  return event;\n};\n\n/**\n * @param {String} eventName\n * @param {Object=} entity\n * @param {Option=} option\n */\nMessanger.prototype.trigger = function(eventName, entity, option)\n{\n  this.fired++;\n\n  var events = this._events[eventName];\n  if (!events) return;\n\n  // Try all events\n  for (var n = 0; n < events.length; n++) {\n    var event = events[n];\n    if (event.fire(eventName, entity, option))\n      this.handled++;\n  }\n};\n\n","module.exports = ObjectPool;\n\n/**\n * Minimize garbage collector thrashing by re-using existing objects instead of\n * creating new ones. Requires manually lifecycle management.\n * @constructor\n * @param {Function} T\n */\nfunction ObjectPool(T)\n{\n  this.freeList = [];\n  this.count    = 0;\n  this.T        = T;\n}\n\n/**\n * Get a pooled object\n */\nObjectPool.prototype.aquire = function()\n{\n  // Grow the list by 20%ish if we're out\n  if (this.freeList.length <= 0) {\n    this.expand(Math.round(this.count*0.2) + 1);\n  }\n\n  var item = this.freeList.pop();\n\n  // We can provide explicit initing, otherwise re-call constructor (hackish)\n  if (item.__init)\n    item.__init();\n  else\n    this.T.call(item);\n\n  return item;\n};\n\n/**\n * Return an object back to the pool.\n */\nObjectPool.prototype.release = function(item)\n{\n  this.freeList.push(item);\n};\n\n/**\n * @param {Number} Amount of new objects to allocate for this pool.\n */\nObjectPool.prototype.expand = function(count)\n{\n  for (var n = 0; n < count; n++)\n    this.freeList.push(new this.T());\n  this.count += count;\n};\n\n/**\n * @return {Number} Total amount of allocated objects (available and in-use).\n */\nObjectPool.prototype.totalSize = function()\n{\n  return this.count;\n};\n\n/**\n * @return {Number} Total number of objects currently available.\n */\nObjectPool.prototype.totalFree = function()\n{\n  return this.freeList.length;\n};\n\n/**\n * @return {Number} Total number of objects currently in-use.\n */\nObjectPool.prototype.totalUsed = function()\n{\n  return this.count - this.freeList.length;\n};\n\n","module.exports = Spatial;\n\nvar Vec2 = require('./Vec2.js');\n\n/**\n * Basic component giving an entity the concept of being located somewhere.\n * Creates basic spatial heirachy, positions, rotation, etc.\n * @constructor\n */\nfunction Spatial()\n{\n  // Alloc our types\n  this.position     = new Vec2();\n  this.scale        = new Vec2();\n  this.hwidth       = new Vec2();\n\n  this._absScale    = new Vec2();\n  this._absPosition = new Vec2();\n  this._absHwidth   = new Vec2();\n\n  // Setup\n  this.__init();\n}\n\n/**\n * Setup called by pool.\n * @private\n */\nSpatial.prototype.__init = function()\n{\n  this.rotation = 0;\n\n  // Ref to quad tree node this component is in\n  this._node = null;\n\n  // Parent component\n  this.parent = null;\n\n  this.position.clear();\n  this.scale.set(1, 1);\n  this.hwidth.clear();\n  this._absPosition.clear();\n  this._absScale.set(1, 1);\n  this._absHwidth.clear();\n};\n\n/**\n * Fired when spatials overlap.\n * @event\n */\nSpatial.COINCIDENT = 'Spatial#COINCIDENT';\n\n/**\n * Attach this component to another entity's Spatial.\n * @param {{spatial: Spatial}} entity An entity with a Spatial component\n */\nSpatial.prototype.attachTo = function(entity)\n{\n  if (this.parent)\n    throw new Error ('Entity already attached');\n\n  if (!entity || !entity.spatial)\n    throw new Error('Invalid / missing entity');\n\n  this.parent = entity.spatial;\n};\n\n/**\n * The absolute world position of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absPosition = function()\n{\n  var v = this._absPosition.assign(this.position);\n\n  // Trivial case, no parent\n  if (!this.parent) {\n    return v;\n  }\n\n  var parent = this.parent;\n\n  // Rotate our angle by parent's angle\n  var r = this.absRotation();\n  v.rotate(parent.absRotation());\n\n  // Scale by parents scale\n  var pScale = parent.absScale();\n  v.set(v.x * pScale.x, v.y * pScale.y);\n\n  // Add parent's position\n  return v.add(parent.absPosition());\n};\n\n/**\n * The absolute world rotation of this component.\n * @return {Number}\n */\nSpatial.prototype.absRotation = function()\n{\n  // Trivial case\n  if (!this.parent)\n    return this.rotation;\n\n  // This + parent\n  var r = this.rotation + this.parent.absRotation();\n\n  return r % (Math.PI*2);\n};\n\n/**\n * The absolute world hwidth for this component.\n * @return {Vec2}\n */\nSpatial.prototype.absHwidth = function()\n{\n  var h = this._absHwidth.assign(this.hwidth);\n\n  if (!this.parent)\n    return h;\n\n  var scale = this.absScale();\n\n  return h.set(h.x * scale.x, h.y * scale.y);\n};\n\n/**\n * The absolute world scale of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absScale = function()\n{\n  var v = this._absScale.assign(this.scale);\n\n  // Trivial case\n  if (!this.parent) {\n    return v;\n  }\n\n  var pScale = this.parent.absScale();\n\n  return v.set(v.x * pScale.x, v.y * pScale.y);\n};\n\n","module.exports = Vec2;\n\nvar ObjectPool = require('./ObjectPool.js');\n\n/**\n * 2-dimension Cartesian vector with built-in (optional) object pool.\n * @constructor\n * @param {Number} x\n * @param {Number} y\n */\nfunction Vec2(x, y)\n{\n  this.x = +x || 0.0;\n  this.y = +y || 0.0;\n}\n\n/**\n * Reset for pool.\n * @private\n */\nVec2.prototype.__init = function()\n{\n  this.clear();\n};\n\n// Interal static object pool\nvar pool = new ObjectPool(Vec2);\n\n/**\n * Get a vector from the pool.\n * @return {Vec2}\n */\nVec2.aquire = function()\n{\n  return pool.aquire();\n};\n\n/**\n * Return a vector to the pool.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.release = function(v)\n{\n  if (v) pool.release(v);\n  return pool.count - pool.freeList.length;\n};\n\n/**\n * Reset this vector to (0,0).\n * @return {Vec2} This vector.\n */\nVec2.prototype.clear = function()\n{\n  this.x = this.y = 0.0;\n  return this;\n};\n\n/**\n * Assign this vector the value of another.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.assign = function(v)\n{\n  this.x = v.x;\n  this.y = v.y;\n  return this;\n};\n\n/**\n * Determine if this vector is equal to another.\n * @param {Vec2} v\n * @return {Boolean} True if vectors are equal.\n */\nVec2.prototype.equals = function(v)\n{\n  return this.x === v.x && this.y === v.y;\n};\n\n/**\n * Set this vector to a set of coordinates.\n * @param {Number} x\n * @param {Number} y\n * @return {Vec2} This vector.\n */\nVec2.prototype.set = function(x, y)\n{\n  this.x = +x;\n  this.y = +y;\n  return this;\n};\n\n/**\n * Limit this vector to a specific magnitude.\n * @param {Number} size\n * @return {Vec2} This vector.\n */\nVec2.prototype.limit = function(size)\n{\n  size = +size;\n  if (!size)\n    return this;\n  else if (this.magnitude() > size)\n    return this.normalize(size);\n  else\n    return this;\n};\n\n/**\n * Normalize this vector.\n * @param {Number=} m Length.\n * @return {Vec2} This vector.\n */\nVec2.prototype.normalize = function(m)\n{\n  m = m || +1.0;\n  var length = Math.sqrt(this.x * this.x + this.y * this.y);\n  this.x = m * this.x / length;\n  this.y = m * this.y / length;\n  return this;\n};\n\n/**\n * Subtract some vector from this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.sub = function(v)\n{\n  this.x -= v.x;\n  this.y -= v.y;\n  return this;\n};\n\n/**\n * Add some vector to this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.add = function(v)\n{\n  this.x += v.x;\n  this.y += v.y;\n  return this;\n};\n\n/**\n * Scalar multiply this vector by a value.\n * @param {Number} n\n * @return {Vec2} This vector.\n */\nVec2.prototype.smult = function(n)\n{\n  n = +n;\n  this.x *= n;\n  this.y *= n;\n  return this;\n};\n\n/**\n * Rotate this vector clockwise about the origin by a certain angle.\n * @param {Number} theta\n * @return {Vec2} This vector.\n */\nVec2.prototype.rotate = function(theta)\n{\n  return this.set(\n    this.x * Math.cos(theta) - this.y * Math.sin(theta),\n    this.x * Math.sin(theta) + this.y * Math.cos(theta)\n  );\n};\n\n/**\n * Get the dot product of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.dot = function(v)\n{\n  return +(this.x * v.x + this.y * v.y);\n};\n\n/**\n * Get the determinate of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.det = function(v)\n{\n  return +(this.x * v.y - this.y * v.x);\n};\n\n/**\n * Get the magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude = function()\n{\n  return Math.sqrt(this.x * this.x + this.y * this.y);\n};\n\n/**\n * Get the squared magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude2 = function()\n{\n  return this.x * this.x + this.y * this.y;\n};\n\n/**\n * Get the angle of this vector.\n * @return {Number}\n */\nVec2.prototype.angle = function()\n{\n  return Math.atan2(this.y, this.x);\n};\n\n/**\n * Get the angle between this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.angleBetween = function(v)\n{\n  return Math.atan2(this.det(v), this.dot(v));\n};\n\n/**\n * Make a pooled copy of this vector\n * @return {Vec2} A new vector.\n */\nVec2.prototype.pcopy = function()\n{\n  return Vec2.aquire().assign(this);\n};\n\n/**\n * Make a copy of this vector.\n * @return {Vec2} A new vector.\n */\nVec2.prototype.copy = function()\n{\n  return new Vec2().assign(this);\n};\n\n/**\n * Create a vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number=} m\n * @return {Vec2} A new vector.\n */\nVec2.fromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return new Vec2(Math.cos(theta) * m, Math.sin(theta) * m);\n};\n\n/**\n * Create a pooled vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number} m\n * @return {Vec2} A new vector.\n */\nVec2.pfromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return Vec2.aquire().set(\n    Math.cos(theta) * m,\n    Math.sin(theta) * m\n  );\n};\n\n/**\n * Determine if two rectangles, defined by a position and a halfwidth vector,\n * overlap.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they intersect\n */\nVec2.rectIntersect = function(p1, r1, p2, r2)\n{\n  // Basically, rectangles dont intersect if one's bottom is higher than ones\n  // top, ones left is more left than ones right, etc\n  var a = p1.x + r1.x < p2.x - r2.x;\n  var b = p1.x - r1.x > p2.x + r2.x;\n  var c = p1.y + r1.y < p2.y - r2.y;\n  var d = p1.y - r1.y > p2.y + r2.y;\n\n  // We want if they do\n  return !(a || b || c || d);\n};\n\n/**\n * Determines if rectangle 1 is entirely inside of rectangle 2.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they rectangle 1 is inside of rectangle 2\n */\nVec2.rectContains = function(p1, r1, p2, r2)\n{\n  if (p1.x - r1.x < p2.x - r2.x) return false;\n  if (p1.x + r1.x > p2.x + r2.x) return false;\n  if (p1.y - r1.y < p2.y - r2.y) return false;\n  if (p1.y + r1.y > p2.y + r2.y) return false;\n\n  return true;\n};\n\n/**\n * Convert a rectangle specified by top-left point + size into center location\n * + halfwidths.\n * @param {Vec2} position\n * @param {Vec2} size\n * @param {Vec2} out__position Output position\n * @param {Vec2} out__hwidth Output hwidths\n */\nVec2.sizeToHwidth = function(position, size, out__position, out__hwidth)\n{\n  out__hwidth.assign(size).smult(0.5);\n  out__position.assign(position).add(out__hwidth);\n};\n\n/**\n * Output this vector.\n */\nVec2.prototype.toString = function()\n{\n  return '' + (this.x.toFixed(2)) + ',' + (this.y.toFixed(2));\n};\n\n","module.exports = QuadTree;\n\nvar ObjectPool = require('./ObjectPool.js');\nvar Spatial    = require('./Spatial.js');\nvar Vec2       = require('./Vec2.js');\n\n/**\n * Effectively store positional and sized objects. Each tree has a position and\n * size, as well as up to 4 child nodes (other trees) and an array of entries.\n * @constructor\n */\nfunction QuadTree()\n{\n  this.level       = 0;\n  this.position    = new Vec2();\n  this.size        = new Vec2();\n  this.maxEntities = 15;\n  this.maxLevels   = 10;\n\n  /**\n   * Pool that is used for all internal quad trees. Only root node has one, all\n   * others have a refence.\n   */\n  this.pool = new ObjectPool(QuadTree);\n\n  /**\n   * @type {Array.<QuadTree>}\n   */\n  this.nodes = [];\n\n  /**\n   * @type {Array.<{spatial: Spatial}>}\n   */\n  this.entities = [];\n}\n\n/**\n * Reset for pool.\n * @private\n */\nQuadTree.prototype.__init = function()\n{\n  this.level = 0;\n  this.position.clear();\n  this.size.clear();\n  this.nodes.length = 0;\n  this.entities.length = 0;\n\n  // Only root node has actual ref to pool\n  this.pool = null;\n};\n\n/**\n * Add an entity to the tree\n * @param {{spatial: Spatial}} entity\n */\nQuadTree.prototype.insert = function(entity)\n{\n  // Recurse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].insert(entity);\n  }\n\n  // Actually add the entity\n  this.entities.push(entity);\n  this._splitAndRedistributeIfNeeded();\n  entity.spatial._node = this;\n  return entity;\n};\n\n/**\n * Remove an entity from this tree.\n * @param {{spatial: Spatial}} param\n */\nQuadTree.prototype.remove = function(entity)\n{\n  // Remove if we can\n  var n = this.entities.indexOf(entity);\n  if (~n) {\n    this.entities.splice(n, 1);\n    entity.spatial._node = null;\n    if (!this.totalSize())\n      this.clear();\n    return;\n  }\n\n  // Recuse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].remove(entity);\n  }\n};\n\n/**\n * Total recursive size of this tree.\n * @return {Number}\n */\nQuadTree.prototype.totalSize = function()\n{\n  var size = this.entities.length;\n\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    size += node.totalSize();\n  }\n\n  return size;\n};\n\n/**\n * Empty the tree recursively.\n */\nQuadTree.prototype.clear = function()\n{\n  // Clear entity area\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n    entity.spatial._node = null;\n  }\n  this.entities.length = 0;\n\n  // Recurse, free the node, and wipe out our node length\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    node.clear();\n    this.pool.release(node);\n  }\n  this.nodes.length = 0;\n};\n\n/**\n * Get all tree entries that are interesected by a rectangle defined with\n * position and hwidth.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @param {Array.<{spatial: Spatial}>=} out__objects Return objects.\n * @return {Array.<{spatial: Spatial}>} The out__objects parameter (filled up now)\n */\nQuadTree.prototype.queryArea = function(position, hwidth, out__entities)\n{\n  var entities = out__entities || [];\n\n  // If query belongs in ONLY a single node, then recurse\n  var index = this._getIndex(position, hwidth);\n  if (~index && this.nodes.length) {\n    this.nodes[index].queryArea(position, hwidth, entities);\n\n  // Otherwise, we have to add ALL of the nodes as it may be overlapping one\n  } else {\n    for (var j = 0; j < this.nodes.length; j++) {\n      var node = this.nodes[j];\n      node.queryArea(position, hwidth, entities);\n    }\n  }\n\n  // Also add everything from this node itself\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n\n    var overlapping = Vec2.rectIntersect(\n      entity.spatial.absPosition(),\n      entity.spatial.absHwidth(),\n      position,\n      hwidth);\n\n    if (overlapping) {\n      entities.push(entity);\n    }\n  }\n\n  return entities;\n};\n\n/**\n * Do a complete reset of the tree.\n */\nQuadTree.prototype.reIndex = function()\n{\n  this._combine();\n  this._splitAndRedistributeIfNeeded();\n};\n\nvar tSize = new Vec2();\nvar tPos  = new Vec2();\n\n/**\n * Check to see if an entity is still valid.\n * @param {{spatial: Spatial}} entity\n * @return {Boolean} True if the entity is in this tree (non-recursive) in its\n * correct place. False implies we need to re-add it.\n */\nQuadTree.prototype.validateEntity = function(entity)\n{\n  var pos = entity.spatial.position;\n  var hw  = entity.spatial.hwidth;\n\n  // Check to see if we're still inside this node\n  tSize.assign(this.size).smult(0.5);\n  tPos.assign(tSize).add(this.position);\n  var inside = Vec2.rectContains(pos, hw, tPos, tSize);\n\n  if (!inside) return false;\n\n  // No children nodes, then we're good\n  if (!this.nodes.length)\n    return true;\n\n  // Or if children nodes and we overlap, still good\n  var index = this._getIndex(entity.spatial.absPosition(),\n    entity.spatial.absHwidth());\n  if (this.nodes.length && !~index)\n    return true;\n\n  // Didnt make it\n  return false;\n};\n\n/**\n * Return which of the 4 quandrants of this tree an object would go into.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @return {Number} Which quandrant, or -1 if won't fit.\n * @private\n */\nQuadTree.prototype._getIndex = function(position, hwidth)\n{\n  var midX = this.position.x + this.size.x / 2;\n  var midY = this.position.y + this.size.y / 2;\n\n  var left   = position.x - hwidth.x < midX && position.x + hwidth.x < midX;\n  var right  = position.x - hwidth.x > midX && position.x + hwidth.x > midX;\n  var top    = position.y - hwidth.y < midY && position.y + hwidth.y < midY;\n  var bottom = position.y - hwidth.y > midY && position.y + hwidth.y > midY;\n\n  if (top && right) return 0;\n  if (top && left) return 1;\n  if (bottom && left) return 2;\n  if (bottom && right) return 3;\n\n  return -1;\n};\n\n/**\n * If we've overpacked this tree, then split into 4 smaller trees (if we\n * haven't already) and redistribute.\n * @private\n */\nQuadTree.prototype._splitAndRedistributeIfNeeded = function()\n{\n  if (this.entities.length > this.maxEntities &&\n    this.level < this.maxLevels)\n  {\n    this._split();\n    this._redistribute();\n  }\n};\n\n/**\n * Create a sub quad tree\n * @return {QuadTree}\n * @private\n */\nQuadTree.prototype._factory = function()\n{\n  var node = this.pool.aquire();\n\n  node.pool        = this.pool;\n  node.level       = this.level + 1;\n  node.maxEntities = this.maxEntities;\n  node.maxLevels   = this.maxLevels;\n\n  return node;\n};\n\n/**\n * Create 4 sub nodes for the tree (does not populate tho)\n * @private\n */\nQuadTree.prototype._split = function()\n{\n  if (this.nodes.length) return;\n\n  var x = this.position.x;\n  var y = this.position.y;\n\n  var w = this.size.x / 2;\n  var h = this.size.y / 2;\n\n  // Create the seperate nodes\n  for (var n = 0; n < 4; n++) {\n    var node = this._factory();\n    node.size.set(w, h);\n\n    switch(n) {\n      case 0:\n        node.position.set(x + w, y);\n        break;\n      case 1:\n        node.position.set(x, y);\n        break;\n      case 2:\n        node.position.set(x, y + h);\n        break;\n      case 3:\n        node.position.set(x + w, y + h);\n        break;\n    }\n\n    this.nodes.push(node);\n  }\n};\n\n/**\n * Distrubute all entities into child nodes if we can.\n * @private\n */\nQuadTree.prototype._redistribute = function()\n{\n  // Loop through all of our entries and if they can fit into a child node,\n  // move them there\n  var i = 0;\n  while (i < this.entities.length) {\n    var entity = this.entities[i];\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n\n    // Insert into child, remove from our array if they belong in another node\n    if (~index) {\n      this.nodes[index].insert(entity);\n      this.entities.splice(i, 1);\n    } else {\n      i++;\n    }\n  }\n};\n\n/**\n * Unwinds this node. Move all child nodes into this node and remove child\n * nodes.\n * @private\n */\nQuadTree.prototype._combine = function()\n{\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n\n    // Combine all children first\n    node._combine();\n\n    // All entries combined on node, now add it to US\n    for (var m = 0; m < node.entities.length; m++) {\n      var entity = node.entities[m];\n      this.entities.push(entity);\n    }\n\n    // Clear out and ensure we release it\n    node.entities.length = 0;\n    node.clear();\n    this.pool.release(node);\n  }\n\n  // Clear nodes array\n  this.nodes.length = 0;\n};\n\n","module.exports = Event;\n\n/**\n * @constructor\n */\nfunction Event(name, callback)\n{\n  this._name     = name || 'name';\n  this._callback = callback || null;\n\n  // Additional filters\n  this._Components = [];\n}\n\n/**\n * @param {String} eventName\n * @param {{hasAllComponents:Function}} entity\n * @param {Object=} option\n * @return {Boolean} True if fired.\n */\nEvent.prototype.fire = function(eventName, entity, option)\n{\n  // Name check\n  if (eventName !== this._name)\n    return false;\n\n  // Component filters\n  var Comps = this._Components;\n  if (entity && entity.hasAllComponents && Comps.length) {\n    if (!entity || !entity.hasAllComponents(Comps))\n      return false;\n  }\n\n  // Made it\n  this._callback(entity, option);\n  return true;\n};\n\n/**\n * @param {Function} T\n * @return {Event} This object.\n */\nEvent.prototype.whereComponent = function(T)\n{\n  this._Components.push(T);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Event} This object.\n */\nEvent.prototype.whereComponents = function(Components)\n{\n  this._Components = this._Components.concat(Components);\n  return this;\n};\n\n","module.exports = {\n\n  'extends'      : require('./lib/extends.js'),\n  'mixin'        : require('./lib/mixin.js'),\n  'getArguments' : require('./lib/getArguments.js'),\n  'getName'      : require('./lib/getName.js')\n\n};\n\n\n","module.exports = mixin_;\n\n/**\n * Add all own properties of mixin to the prototype property of class T\n * @param {Function} T Class we want to mix into.\n * @param {Function|Object} mixin Mixin we want to mixt\n */\nfunction mixin_(T, mixin)\n{\n  // If we're mixing in a class (constructor function), then first mix in all\n  // things hanging directly off the mixin as \"statics\", then switch the mixin\n  // ref to point to the prototype\n  if (mixin instanceof Function) {\n    for (var k in mixin) {\n      T[k] = mixin[k];\n    }\n    mixin = mixin.prototype;\n  }\n\n  // Dump everything on the mixin into the prototype of our class\n  for (var key in mixin) {\n    if (mixin.hasOwnProperty(key)) {\n      T.prototype[key] = mixin[key];\n    }\n  }\n}\n\n","module.exports = extends_;\n\n/**\n * The well documented, oft-used (Coffeescript, Typescript, ES6... etc) extends\n * pattern to get some sort of single-inheritance in Javascript.  Modify a\n * Child class to have inherited the static members via copying and link the\n * prototypes.\n * @param {Function} Child Child constructor function.\n * @param {Function} Parent Parent contrusctor function.\n * @return {Function} The Child constructor.\n */\nfunction extends_(Child, Parent)\n{\n  // Drop in statics\n  for (var key in Parent) {\n    if (!Child.hasOwnProperty(key) && Parent.hasOwnProperty(key)) {\n      Child[key] = Parent[key];\n    }\n  }\n\n  // Give static to access parent\n  Child.Super = Parent;\n\n  // Child's prototype property is an object with the parent's prototype\n  // property its [[prototype]] + constructor\n  if (Object.create instanceof Function) {\n    Child.prototype = Object.create(Parent.prototype, {\n      constructor: { value: Child }\n    });\n  } else {\n    // IE8 and below shim\n    var T = makeT(Child);\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n  }\n\n  return Child;\n}\n\n/**\n * @param {Function} Child\n * @return {Function}\n */\nfunction makeT(Child)\n{\n  return function T() { this.constructor = Child; };\n}\n\n","module.exports = getName;\n\nvar FUNCTION_NAME = /function\\s+([^\\s(]+)/;\n\n/**\n * Get the name of a function (e.g. constructor)\n * @param {Function} f\n * @return {String} The function name.\n */\nfunction getName(f)\n{\n  var name = '';\n\n  if (f instanceof Function) {\n    if (f.name) {\n      return f.name;\n    }\n\n    var match = f.toString().match(FUNCTION_NAME);\n\n    if (match) {\n      name = match[1];\n    }\n  } else if (f && f.constructor instanceof Function) {\n    name = getName(f.constructor);\n  }\n\n  return name;\n}\n","module.exports = getArguments;\n\nvar FUNCTION_ARGS = /^\\w*function[^\\(]*\\(([^\\)]+)/;\n\n/**\n * Get the parameter names of a function.\n * @param {Function} f A function.\n * @return {Array.<String>} An array of the argument names of a function.\n */\nfunction getArguments(f)\n{\n  var ret = [];\n  var args = f.toString().match(FUNCTION_ARGS);\n\n  if (args) {\n    args = args[1]\n      .replace(/[ ]*,[ ]*/, ',')\n      .split(',');\n    for (var n = 0; n < args.length; n++) {\n      var a = args[n].replace(/^\\s+|\\s+$/g, '');\n      if (a) ret.push(a);\n    }\n  }\n\n  return ret;\n}\n\n"]}