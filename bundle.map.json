{"version":3,"sources":["../../../../AppData/Roaming/npm/node_modules/browserify/node_modules/browser-pack/_prelude.js","main.js","RequestAnimationFrame.js","js/THREEx.KeyboardState.js","rubbable.js","libgif.js","js/Game.js","js/ResourceManager.js","js/EntityFactory.js","js/Globals.js","js/PointerLockControls.js","js/Systems.js","js/MouseController.js","node_modules/physijs-browserify/physi.js","node_modules/js-class/class.js","node_modules/stats.js/src/Stats.js","node_modules/three/three.js","js/Components.js","b3core.0.1.0.js","node_modules/tiny-ecs/index.js","js/components/Identifier.js","js/components/Position.js","js/components/Velocity.js","js/components/Jump.js","js/components/Hurt.js","js/components/Drawable.js","js/components/ShootDelay.js","js/components/Expirable.js","js/components/Bullet.js","js/components/OneTimeHit.js","js/components/CameraFollow.js","js/components/Health.js","js/components/Ai.js","node_modules/tiny-ecs/lib/Entity.js","node_modules/tiny-ecs/lib/Messanger.js","node_modules/tiny-ecs/lib/EntityManager.js","node_modules/tiny-ecs/lib/QuadTree.js","node_modules/tiny-ecs/lib/Vec2.js","node_modules/tiny-ecs/lib/ObjectPool.js","node_modules/tiny-ecs/lib/Spatial.js","node_modules/tiny-ecs/lib/Event.js","node_modules/tiny-ecs/node_modules/typedef/index.js","node_modules/tiny-ecs/node_modules/typedef/lib/extends.js","node_modules/tiny-ecs/node_modules/typedef/lib/mixin.js","node_modules/tiny-ecs/node_modules/typedef/lib/getArguments.js","node_modules/tiny-ecs/node_modules/typedef/lib/getName.js"],"names":["init","Globals","instance","hudElement","document","getElementById","healthElement","scoreElement","reloadingElement","reloadImg","SuperGif","gif","load","overlayElement","gameOptions","container","loadingContainer","blocker","instructions","crosshair","modelsToPreload","game","Game","start","global","Class","require","THREE","THREEx","Physijs","Stats","scripts","worker","ammo","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","module","exports","KeyboardState","domElement","this","keyCodes","modifiers","_this","_onKeyDown","event","_onKeyChange","_onKeyUp","addEventListener","_onBlur","prop","prototype","destroy","removeEventListener","MODIFIERS","ALIAS","left","up","right","down","space","pageup","pagedown","tab","escape","keyCode","pressed","type","shiftKey","ctrlKey","altKey","metaKey","keyDesc","keys","split","i","length","key","indexOf","Object","toUpperCase","charCodeAt","eventMatches","aliases","aliasKeys","root","factory","define","amd","RubbableGif","options","sup","register_canvas_handers","isvp","x","vp_l","canvas","get_canvas","w","vp_w","width","maxDistance","Math","floor","get_length","startX","startTime","cantouch","aj","last_played","e","preventDefault","get_auto_play","pause","pos","touches","layerX","progress","move_to","timeStamp","pageX","play","currentX","currentDistance","abs","currentTime","get_current_frame","move_relative","orig_load","bitsToNum","ba","reduce","s","n","byteToBitArr","bite","a","push","Stream","data","len","readByte","Error","Uint8Array","readBytes","bytes","read","String","fromCharCode","readUnsigned","lzwDecode","minCodeSize","code","last","readCode","size","output","clearCode","eoiCode","codeSize","dict","clear","concat","apply","parseGIF","st","handler","parseCT","entries","ct","readSubBlocks","parseHeader","hdr","sig","ver","height","bits","gctFlag","shift","colorRes","splice","sorted","gctSize","bgColor","pixelAspectRatio","gct","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","iterations","app","NETSCAPE","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","img","deinterlace","pixels","newPixels","Array","rows","cpRow","toRow","fromRow","fromPixels","slice","offsets","steps","pass","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","parseBlock","sentinel","eof","toString","parse","opts","vp_t","vp_h","c_w","c_h","is_vp","stream","loadError","loading","transparency","delay","disposalRestoreFromIdx","lastDisposalMethod","frame","lastImg","playing","forward","ctx_scaled","frames","frameOffsets","auto_play","getAttribute","ctx","toolbar","tmpCanvas","onEndListener","hasOwnProperty","on_end","loopDelay","loop_delay","overrideLoopMode","loop_mode","drawWhileLoading","draw_while_loading","showProgressBar","show_progress_bar","doParse","err","doLoadError","setSizes","h","get_canvas_scale","style","minWidth","getContext","setTransform","setFrameOffset","offset","y","doShowProgress","draw","mid","top","fillStyle","fillRect","originOfError","drawError","strokeStyle","lineWidth","moveTo","lineTo","stroke","doHdr","_hdr","doGCE","pushFrame","getImageData","doImg","currIdx","putImageData","clearRect","imgData","cdd","forEach","pixel","set","scale","drawImage","player","iterationCount","getNextFrameNo","delta","stepFrame","amount","putFrame","completeLoop","step","stepping","doStep","nextFrameNo","parseInt","globalCompositeOperation","current_frame","frame_idx","doDecodeProgress","doNothing","withProgress","fn","load_callback","parent","parentNode","span","createElement","className","appendChild","insertBefore","removeChild","initialized","max_width","load_setup","get_playing","get_loading","load_url","src","XMLHttpRequest","overrideMimeType","onloadstart","onload","responseText","onprogress","lengthComputable","loaded","total","onerror","open","send","load_raw","arr","set_frame_offset","constructor","stats","prevTime","performance","now","renderer","scene","camera","paused","controlsEnabled","controls","systems","postPhysicsSystems","percentModelsLoaded","runImmediately","undefined","onResize","bind","onkeydown","onKeyDown","onMouseDown","onMouseUp","WebGLRenderer","antialias","setSize","innerWidth","innerHeight","setClearColor","setMode","position","bottom","body","Scene","setGravity","Vector3","aspectRatio","PerspectiveCamera","add","PointerLockControls","getObject","ambientLight","AmbientLight","dirLight","DirectionalLight","EntityFactory","makeGround","makePlayer","controlsObject","cameraOffset","makeEnemy","aiTarget","CameraRotationSystem","entities","PlayerInputSystem","AISystem","MovementSystem","ExpirableSystem","CameraFollowSystem","ShootDelaySystem","HurtSystem","PlayerHealthSystem","HealthBarSystem","DeathSystem","PhysicsUpdateSystem","loadModels","model","ResourceManager","loadModel","modelLoaded","percentPerModel","visibility","display","scrollTop","documentElement","initPointerLock","run","update","time","dt","system","simulate","MouseController","render","aspect","updateProjectionMatrix","which","KEY_CODES","button","isDown","wasPressed","havePointerLock","pointerlockchange","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","enabled","pointerlockerror","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","test","navigator","userAgent","fullscreenchange","fullscreenElement","mozFullscreenElement","mozFullScreenElement","requestFullscreen","mozRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","innerHTML","statics","Model","geometry","material","loadingManager","LoadingManager","jsonLoader","JSONLoader","textures","models","getTexture","path","ImageUtils","loadTexture","materials","MeshFaceMaterial",{"end":{"file":"?","comments_before":[],"nlb":false,"endpos":1264,"endcol":16,"endline":55,"pos":1256,"col":8,"line":55,"value":"instance","type":"name"},"start":{"file":"?","comments_before":[],"nlb":false,"endpos":1264,"endcol":16,"endline":55,"pos":1256,"col":8,"line":55,"value":"instance","type":"name"},"name":"instance"},"_instance","EntityManager","C","b3","createEntity","addTag","addComponent","Identifier","Position","Velocity","Jump","Drawable","CameraFollow","ShootDelay","Health","ENTITY_TYPES","drawable","mesh","BoxMesh","BoxGeometry","createMaterial","MeshBasicMaterial","color","entity","copy","_physijs","collision_type","COLLISION_TYPES","collision_masks","obstacle","enemy","enemyBullet","setDamping","setAngularFactor","other_object","relative_velocity","relative_rotation","contact_normal","ground","jump","canJump","hasComponent","Hurt","hurt","originalColor","health","hp","changed","z","cameraFollow","object","shootDelay","delayTheshold","AI","MeshPhongMaterial","playerBullet","healthBar","Mesh","FaceNode","Action","name","parameters","facing","__Action_initialize","initialize","settings","tick","_manager","FAILURE","parentPos","target","clone","followingPos","posDif","sub","direction","rotation","Euler","applyEuler","angle","angleTo","SUCCESS","lookAtMatrix","Matrix4","lookAt","parentRotation","Quaternion","setFromEuler","targetRotation","setFromRotationMatrix","str","min","slerp","setFromQuaternion","__dirtyRotation","RUNNING","RandomChildNode","Composite","__Composite_initialize","chance","children","random","status","_execute","FollowNode","following","distance","distanceTo","difference","subVectors","normal","normalize","velocity","dv","MOVE_SPEED","ShootNode","shootingAt","canShoot","makeBullet","rotationMatrix","owner","ai","tree","BehaviorTree","Sequence","blackboard","Blackboard","bullet","Bullet","Expirable","OneTimeHit","ConvexMesh","isHot","hitPlayer","hitEnemy","oneTimeHit","alreadyHit","uuid","touchedGround","score","vel","multiply","applyCentralImpulse","expirable","maxAge","nothing","pitchObject","Object3D","yawObject","moveForward","moveBackward","moveLeft","moveRight","isOnObject","mass","moveSpeed","minimumY","onMouseMove","onKeyUp","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","max","PI_2","bool","getDirection","v","translateX","translateY","translateZ","PI","keyboard","jumped","players","queryTag","JUMP_FORCE","applyMatrix4","moveables","queryComponents","expirables","age","remove","follows","extractRotation","matrix","shooters","timer","hurtables","invulnerabilityFrames","hurtColor","hasTag","backgroundColor","removeComponent","percent","maxHP","percentRounded","round","Color","getHexString","mortals","singularities","getLinearVelocity","SUPPORT_TRANSFERABLE","Eventable","getObjectId","getEulerXYZFromQuaternion","getQuatertionFromEuler","convertWorldPositionToObject","addObjectChildren","_temp1","_temp2","_is_simulating","_Physijs","_temp_vector3_1","_temp_vector3_2","_temp_matrix4_1","_quaternion_1","MESSAGE_TYPES","WORLDREPORT","COLLISIONREPORT","VEHICLEREPORT","CONSTRAINTREPORT","REPORT_ITEMSIZE","COLLISIONREPORT_ITEMSIZE","VEHICLEREPORT_ITEMSIZE","CONSTRAINTREPORT_ITEMSIZE","_eventListeners","event_name","index","dispatchEvent","call","arguments","make","obj","_id","atan2","asin","c1","s1","c2","s2","c3","s3","c1c2","s1s2","cos","sin","identity","makeRotationFromQuaternion","quaternion","getInverse","noConflict","friction","restitution","physijs_material","id","PointConstraint","objecta","objectb","appliedImpulse","positiona","positionb","getDefinition","HingeConstraint","axis","setLimits","low","high","bias_factor","relaxation_factor","execute","constraint","enableAngularMotor","acceleration","disableMotor","SliderConstraint","lin_lower","lin_upper","ang_lower","ang_upper","setRestitution","linear","angular","enableLinearMotor","disableLinearMotor","disableAngularMotor","ConeTwistConstraint","axisa","axisb","setLimit","enableMotor","setMaxMotorImpulse","max_impulse","setMotorTarget","DOFConstraint","setLinearLowerLimit","limit","setLinearUpperLimit","setAngularLowerLimit","setAngularUpperLimit","configureAngularMotor","low_angle","high_angle","max_force","params","self","_worker","Worker","transferableMessage","webkitPostMessage","postMessage","_materials_ref_counts","_objects","_vehicles","_constraints","ab","ArrayBuffer","byteLength","console","log","message","filename","lineno","onmessage","_temp","Float32Array","_updateScene","_updateCollisions","_updateVehicles","_updateConstraints","cmd","debug","dir","fixedTimeStep","rateLimit","num_objects","__dirtyPosition","linearVelocity","angularVelocity","buffer","vehicle","wheel","wheels","addVectors","j","object2","id1","id2","collisions","normal_offsets","getAngularVelocity","normal_offset","addConstraint","show_marker","marker","SphereGeometry","MeshNormalMaterial","onSimulationResume","removeConstraint","updateMatrix","updateMatrixWorld","setFromMatrixPosition","matrixWorld","position_offset","world","Vehicle","materialId","depth","pop","setFixedTimeStep","gravity","timeStep","maxSubSteps","object_id","quat","boundingBox","computeBoundingBox","__defineGetter__","__defineSetter__","force","applyImpulse","impulse_x","impulse_y","impulse_z","applyTorque","torque_x","torque_y","torque_z","applyCentralForce","applyForce","force_x","force_y","force_z","setAngularVelocity","setLinearVelocity","factor","setLinearFactor","setCcdMotionThreshold","threshold","setCcdSweptSphereRadius","radius","PlaneMesh","faces","HeightfieldMesh","xdiv","ydiv","xsize","ysize","xpts","sqrt","vertices","ypts","absMaxHeight","b","points","SphereMesh","boundingSphere","computeBoundingSphere","pow","CylinderMesh","CapsuleMesh","ConeMesh","ConcaveMesh","face","triangles","Face3","c","Face4","d","tuning","VehicleTuning","rigidBody","suspension_stiffness","suspension_compression","suspension_damping","max_suspension_travel","friction_slip","max_suspension_force","addWheel","wheel_geometry","wheel_material","connection_point","wheel_direction","wheel_axle","suspension_rest_length","wheel_radius","is_front_wheel","castShadow","receiveShadow","multiplyScalar","setSteering","steering","setBrake","brake","applyEngineForce","inherit","dest","noParent","getOwnPropertyNames","desc","getOwnPropertyDescriptor","defineProperty","__proto__","findType","meta","implType","implMeta","proto","base","implements","classProto","isArray","implementedType","extend","theClass","value","enumerable","configurable","writable","Checker","typeOf","typeInfo","an","is","VERSION","Date","ms","msMin","Infinity","msMax","fps","fpsMin","fpsMax","mode","cssText","fpsDiv","fpsText","fpsGraph","bar","msDiv","msText","msGraph","updateGraph","dom","child","firstChild","REVISION","begin","end","textContent","sign","warn","error","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","NoShading","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","Projector","projectVector","vector","project","unprojectVector","unproject","pickingRay","CanvasRenderer","setRGB","r","g","setHex","setStyle","hex","setHSL","l","hue2rgb","p","q","t","exec","ColorKeywords","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","getHex","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","lerp","alpha","equals","fromArray","array","toArray","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","_x","_y","_z","_w","onChangeCallback","euler","order","setFromAxisAngle","halfAngle","m","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","dot","crossVectors","inverse","conjugate","lengthSq","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","qa","qm","Vector2","setX","setY","setComponent","getComponent","subScalar","divide","divideScalar","scalar","invScalar","clamp","clampScalar","minVal","maxVal","ceil","roundToZero","negate","distanceToSquared","dx","dy","setLength","oldLength","lerpVectors","v2","fromAttribute","attribute","itemSize","setZ","multiplyVectors","applyAxisAngle","applyMatrix3","applyProjection","qx","qy","qz","qw","ix","iy","iz","iw","multiplyMatrices","projectionMatrix","transformDirection","lengthManhattan","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","line","center","result","distanceSq","at","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","setFromPoints","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromObject","scope","traverse","node","Geometry","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","multiplyVector3Array","applyToVector3Array","determinant","f","throwOnInvertible","det","msg","transpose","tmp","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","eye","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","setPosition","rotateX","rotateY","rotateZ","rotateByAxis","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","decompose","invSX","invSY","invSZ","makeFrustum","near","far","makePerspective","fov","ymax","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","origin","ray","recast","directionDistance","distanceSqToSegment","segCenter","segDir","diff","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","rnd","join","clampBottom","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nextPowerOfTwo","Spline","interpolate","t2","t3","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","Clock","autoStart","oldTime","elapsedTime","running","stop","getElapsedTime","getDelta","newTime","EventDispatcher","hasEventListener","listener","_listeners","listeners","listenerArray","Raycaster","Sprite","PointCloud","LOD","Line","descSort","intersectObject","raycaster","intersects","recursive","raycast","precision","linePrecision","setFromCamera","OrthographicCamera","sort","intersectObjects","objects","Object3DIdCount","DefaultUp","onRotationChange","onQuaternionChange","defineProperties","rotationAutoUpdate","matrixAutoUpdate","matrixWorldNeedsUpdate","visible","frustumCulled","renderOrder","userData","eulerOrder","useQuaternion","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","localToWorld","worldToLocal","getChildByName","getObjectByName","getObjectById","getObjectByProperty","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","toJSON","metadata","version","generator","geometries","parseGeometry","json","parseMaterial","parseObject","JSON","stringify","intensity","PointLight","decay","SpotLight","exponent","HemisphereLight","groundColor","materialIndex","vertexNormals","vertexColors","vertexTangents","BufferAttribute","needsUpdate","copyAt","index1","index2","setXY","setXYZ","setXYZW","Int8Attribute","Uint8Attribute","Uint8ClampedAttribute","Int16Attribute","Uint16Attribute","Int32Attribute","Uint32Attribute","Float32Attribute","Float64Attribute","DynamicBufferAttribute","updateRange","count","create","GeometryIdCount","attributesKeys","drawcalls","addAttribute","addDrawCall","indexOffset","fromGeometry","faceVertexUvs","hasFaceVertexUv","hasFaceVertexNormals","normals","colors","uvs","i3","na","nb","nc","fc","vca","vcb","vcc","uva","uvb","uvc","bb","isNaN","computeFaceNormals","computeVertexNormals","vA","vB","vC","pA","pB","pC","cb","indices","jl","normalizeNormals","computeTangents","handleTriangle","uvA","uvB","uvC","x1","y1","z1","sdir","tdir","tan1","tan2","handleVertex","n2","tmp2","tangents","uv","nVertices","tangent","iA","iB","iC","computeOffsets","facesCount","sortedIndices","Uint16Array","indexPtr","vertexPtr","duplicatedVertices","newVerticeMaps","faceVertices","Int32Array","vertexMap","revVertexMap","findex","vo","vid","faceMax","new_offset","new_vid","reorderBuffers","merge","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","indexBuffer","indexMap","vertexCount","sortedAttributes","attr","sourceArray","attrArray","attrSize","sortedAttr","numItems","sourceAttr","dispose","morphTargets","morphColors","morphNormals","skinWeights","skinIndices","lineDistances","hasTangents","dynamic","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","tangentsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","fromBufferGeometry","tempNormals","tempUVs","addFace","drawcall","fl","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","context","ua","ub","uc","vertexIndex","faceIndex","computeLineDistances","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","uvs2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mergeVertices","verticesMap","unique","changes","precisionPoints","faceIndicesToRemove","dupIndex","idx","setBit","getNormalIndex","hash","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","hasMaterial","hasFaceUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","format","magFilter","minFilter","updateCubeMap","generateMipmaps","activeCubeFace","zoom","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","Light","light","AreaLight","constantAttenuation","linearAttenuation","quadraticAttenuation","onlyShadow","shadowCameraNear","shadowCameraFar","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","shadowCascade","shadowCascadeOffset","shadowCascadeCount","shadowCascadeBias","shadowCascadeWidth","shadowCascadeHeight","shadowCascadeNearZ","shadowCascadeFarZ","shadowCascadeArray","shadowMap","shadowMapSize","shadowCamera","shadowMatrix","skyColor","shadowCameraFov","Cache","files","file","get","Loader","showStatus","statusDomElement","addStatusElement","imageLoader","ImageLoader","onLoadStart","onLoadProgress","onLoadComplete","crossOrigin","fontSize","textAlign","background","padding","zIndex","updateProgress","toFixed","extractUrlBase","url","parts","initMaterials","texturePath","needsTangents","ShaderMaterial","nearest_pow2","LN2","create_texture","where","sourceFile","repeat","wrap","anisotropy","texture","fullPath","loader","Handlers","Texture","image","wrapS","wrapT","wrapMap","mirror","rgb2hex","rgb","mtype","mpars","opacity","map","lightMap","normalMap","bumpMap","wireframe","shading","toLowerCase","blending","transparent","depthTest","depthWrite","flipSided","side","doubleSided","colorDiffuse","DbgColor","colorSpecular","specular","colorEmissive","emissive","specularCoef","shininess","mapDiffuse","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLight","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapBump","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormal","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecular","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlpha","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","mapBumpScale","bumpScale","mapNormalFactor","normalScale","DbgName","handlers","regex","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","request","response","itemEnd","responseType","itemStart","setResponseType","setCrossOrigin","withCredentials","loadAjaxJSON","callbackProgress","xhr","onreadystatechange","readyState","DONE","LOADING","getResponseHeader","HEADERS_RECEIVED","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","bones","animation","animations","parseMorphing","dstVertices","srcVertices","cl","dstColors","srcColors","BufferGeometryLoader","text","typedArray","MaterialLoader","uniforms","vertexShader","fragmentShader","sizeAttenuation","ObjectLoader","substring","lastIndexOf","setTexturePath","parseGeometries","images","parseImages","parseTextures","parseMaterials","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","depthSegments","CircleGeometry","segments","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","phiStart","phiLength","thetaStart","thetaLength","IcosahedronGeometry","detail","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","alphaMap","envMap","specularMap","loadImage","getGeometry","getMaterial","Group","TextureLoader","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","texDatas","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","alphaTest","overdraw","_needsUpdate","setValues","values","newValue","currentValue","Number","MeshLambertMaterial","MeshDepthMaterial","PointCloudMaterial","SpriteMaterial","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","combine","reflectivity","refractionRatio","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","wrapAround","wrapRGB","metal","ParticleBasicMaterial","ParticleSystemMaterial","defines","lights","defaultAttributeValues","uv2","index0AttributeName","UniformsUtils","RawShaderMaterial","mapping","TextureIdCount","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","CubeTexture","VideoTexture","video","HAVE_ENOUGH_DATA","inverseMatrix","localThreshold","testPoint","rayPointDistance","intersectPoint","distanceToRay","oi","ol","pointCount","ParticleSystem","LineStrip","LinePieces","precisionSq","vStart","vEnd","interSegment","interRay","distSq","offsetIndex","nbVertices","updateMorphTargets","morphTargetBase","morphTargetForcedOrder","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","intersectionPoint","isFaceMaterial","objectMaterials","morphInfluences","tl","influence","targets","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","bone","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","rotq","scl","normalizeSkinWeights","skeleton","sw","MorphAnimMesh","duration","mirroredLoop","lastKeyframe","currentKeyframe","directionBackwards","setFrameRange","startKeyframe","endKeyframe","setDirectionForward","setDirectionBackward","parseAnimations","firstAnimation","pattern","morph","match","setAnimationLabel","playAnimation","updateAnimation","frameTime","keyframe","mix","interpolateTargets","influences","addLevel","getObjectForDistance","matrixPosition","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","diffuse","offsetRepeat","flipEnvMap","bump","normalmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLightDirection","directionalLightColor","hemisphereLightDirection","hemisphereLightSkyColor","hemisphereLightGroundColor","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDirection","spotLightDistance","spotLightAngleCos","spotLightExponent","spotLightDecay","particle","psColor","shadowmap","ShaderLib","basic","lambert","phong","particle_basic","dashed","totalSize","mNear","mFar","cube","tCube","tFlip","equirect","tEquirect","depthRGBA","createParticleBuffers","__webglVertexBuffer","_gl","createBuffer","__webglColorBuffer","info","memory","createLineBuffers","__webglLineDistanceBuffer","createMeshBuffers","geometryGroup","__webglNormalBuffer","__webglTangentBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","numMorphTargets","__webglMorphTargetsBuffers","numMorphNormals","__webglMorphNormalsBuffers","initCustomAttributes","nvertices","__webglCustomAttributesList","__webglInitialized","createUniqueBuffers","belongsToAttribute","initParticleBuffers","__vertexArray","__colorArray","__webglParticleCount","initLineBuffers","__lineDistanceArray","__webglLineCount","initMeshBuffers","faces3","ntris","nlines","getBufferMaterial","__normalArray","__uvArray","__uv2Array","__tangentArray","__skinIndexArray","__skinWeightArray","UintArray","extensions","Uint32Array","__typeArray","__faceArray","__lineArray","__morphTargetsArrays","__morphNormalsArrays","__webglFaceCount","originalAttribute","property","__original","__inittedArrays","materialNeedsFaceNormals","setParticleBuffers","hint","ca","cal","customAttribute","vertexArray","colorArray","dirtyVertices","dirtyColors","customAttributes","bindBuffer","ARRAY_BUFFER","bufferData","boundTo","setLineBuffers","dl","lineDistanceArray","dirtyLineDistances","setMeshBuffers","faceColor","n1","n3","sw1","sw2","sw3","si1","si2","si3","vn","uvi","uv2i","vk","vkl","vka","nka","chf","needsFaceNormals","offset_uv","offset_uv2","offset_face","offset_normal","offset_tangent","offset_line","offset_color","offset_skin","offset_morphTarget","offset_custom","uvArray","uv2Array","normalArray","tangentArray","skinIndexArray","skinWeightArray","morphTargetsArrays","morphNormalsArrays","faceArray","lineArray","dirtyElements","dirtyUvs","dirtyNormals","dirtyTangents","dirtyMorphTargets","morphTargetsNeedUpdate","chunk_faces3","obj_faces","obj_uvs","obj_uvs2","obj_skinIndices","obj_skinWeights","ELEMENT_ARRAY_BUFFER","pp","setupVertexAttributes","program","startIndex","geometryAttributes","programAttributes","programAttributesKeys","programAttribute","geometryAttribute","state","enableAttribute","vertexAttribPointer","FLOAT","vertexAttrib2fv","vertexAttrib3fv","disableUnusedAttributes","setupMorphTargets","numSupportedMorphTargets","__webglMorphTargetInfluences","activeInfluenceIndices","numericalSort","numSupportedMorphNormals","influenceIndex","uniform1fv","painterSortStable","reversePainterSortStable","projectObject","initObject","sprites","webglObjects","_webglObjects","_frustum","webglObject","unrollBufferMaterial","sortObjects","_vector3","_projScreenMatrix","renderObjects","renderList","setupMatrices","setMaterial","setMaterialFaces","renderBufferDirect","renderBuffer","renderObjectsImmediate","materialType","renderImmediateObject","unrollImmediateBufferMaterial","globject","opaque","transparentObjects","opaqueObjects","__webglInit","_modelViewMatrix","_normalMatrix","onObjectRemoved","onGeometryDispose","initGeometryGroups","__webglActive","addBuffer","geometryGroupsList","geometryGroups","ImmediateRenderObject","immediateRenderCallback","addBufferImmediate","_webglObjectsImmediate","makeGroups","usesFaceMaterial","groupHash","group","maxVerticesInGroup","hash_map","groups","groupsList","counter","geometryGroupCounter","addBuffers","objlist","updateObject","bufferType","DYNAMIC_DRAW","STATIC_DRAW","bufferSubData","BYTES_PER_ELEMENT","subarray","customAttributesDirty","areCustomAttributesDirty","clearCustomAttributes","removeObject","removeInstances","o","initMaterial","onMaterialDispose","shaderID","shaderIDs","shader","__webglShader","maxLightCount","allocateLights","maxShadows","allocateShadows","maxBones","allocateBones","_precision","supportsVertexTextures","_supportsVertexTextures","envMapMode","useFog","fogExp","flatShading","logarithmicDepthBuffer","_logarithmicDepthBuffer","_supportsBoneTextures","maxMorphTargets","maxMorphNormals","maxDirLights","directional","maxPointLights","maxSpotLights","spot","maxHemiLights","hemi","shadowMapEnabled","shadowMapType","shadowMapDebug","shadowMapCascade","pl","_programs","programInfo","usedTimes","WebGLProgram","programs","uniformsList","location","setBlending","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","setProgram","_usedTextureUnits","deallocateMaterial","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","_currentProgram","useProgram","_currentMaterialId","_currentCamera","uniformMatrix4fv","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","_lightsNeedUpdate","setupLights","refreshUniformsLights","_lights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","refreshUniformsLambert","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","uvScaleMap","_canvas","ambient","distances","decays","directions","anglesCos","exponents","skyColors","groundColors","modelViewMatrix","uniformMatrix3fv","_maxTextures","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform2fv","uniform3fv","uniform4fv","_array","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","_direction","setTextureParameters","textureType","isImagePowerOfTwo","extension","texParameteri","TEXTURE_WRAP_S","paramThreeToGL","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","clampToMaxSize","maxSize","slot","__webglTextureCube","onTextureDispose","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_CUBE_MAP","pixelStorei","UNPACK_FLIP_Y_WEBGL","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","_maxCubemapSize","glFormat","glType","mipmap","getCompressedTextureFormats","compressedTexImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","texImage2D","generateMipmap","__webglTexture","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","updateRenderTargetMipmap","TEXTURE_2D","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","nVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","nVertexMatrices","dirLights","pointLights","spotLights","hemiLights","_context","pixelRatio","_alpha","_depth","_stencil","stencil","_antialias","_premultipliedAlpha","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_clearColor","_clearAlpha","autoClear","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","shadowMapCullFace","calls","_currentFramebuffer","_currentGeometryProgram","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_currentWidth","_currentHeight","resetGLState","setDefaultGLState","WebGLState","getShaderPrecisionFormat","rangeMin","rangeMax","WebGLExtensions","glClearColor","clearColor","clearDepth","clearStencil","enable","DEPTH_TEST","depthFunc","LEQUAL","frontFace","CCW","cullFace","BACK","CULL_FACE","BLEND","blendFunc","viewport","reset","MAX_TEXTURE_IMAGE_UNITS","_maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","_maxTextureSize","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","_vertexShaderPrecisionHighpFloat","VERTEX_SHADER","HIGH_FLOAT","_vertexShaderPrecisionMediumpFloat","MEDIUM_FLOAT","_fragmentShaderPrecisionHighpFloat","FRAGMENT_SHADER","_fragmentShaderPrecisionMediumpFloat","formats","COMPRESSED_TEXTURE_FORMATS","highpAvailable","mediumpAvailable","shadowMapPlugin","ShadowMapPlugin","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","forceContextLoss","loseContext","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","updateStyle","setViewport","setScissor","scissor","enableScissorTest","SCISSOR_TEST","disable","getClearColor","getClearAlpha","setClearAlpha","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearTarget","setRenderTarget","deallocateGeometry","deallocateTexture","onRenderTargetDispose","deallocateRenderTarget","deleteBuffers","buffers","deleteBuffer","deleteTexture","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","deleteProgram","newPrograms","renderBufferImmediate","initAttributes","hasPositions","hasNormals","hasUvs","__webglUvBuffer","hasColors","positionArray","nx","ny","nz","nax","nbx","ncx","nay","nby","ncy","naz","nbz","ncz","drawArrays","TRIANGLES","updateBuffers","wireframeBit","geometryProgram","LINES","drawElements","POINTS","LINE_STRIP","setLineWidth","skinIndex","skinWeight","lineDistance","forceClear","setFaceCulling","frontFaceDirection","CW","FRONT","FRONT_AND_BACK","setDoubleSided","setFlipSided","uploadTexture","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","isCube","isTargetPowerOfTwo","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","WebGLRenderTarget","restore","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","addPrePlugin","addPostPlugin","updateShadowMap","gl","getExtension","programIdCount","generateDefines","chunk","cacheUniformLocations","identifiers","getUniformLocation","cacheAttributeLocations","getAttribLocation","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefix_vertex","prefix_fragment","gammaFactorDefine","customDefines","createProgram","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLogInfo","getProgramInfoLog","getProgramParameter","LINK_STATUS","getError","VALIDATE_STATUS","deleteShader","addLineNumbers","string","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","newAttributes","enabledAttributes","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthTest","currentDepthWrite","currentColorWrite","currentDoubleSided","currentFlipSided","currentLineWidth","currentPolygonOffset","currentPolygonOffsetFactor","currentPolygonOffsetUnits","enableVertexAttribArray","disableVertexAttribArray","blendEquationSeparate","blendFuncSeparate","depthMask","colorMask","polygonoffset","units","POLYGON_OFFSET_FILL","flares","prefix","vertexBuffer","elementBuffer","hasVertexTexture","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","sprite","_renderer","_renderList","createVirtualLight","cascade","virtualLight","isVirtual","pointsWorld","pointsFrustum","nearZ","farZ","updateVirtualLight","updateShadowCamera","_min","_max","getObjectMaterial","_depthMaterial","_depthMaterialMorph","_depthMaterialSkin","_depthMaterialMorphSkin","_matrixPosition","depthShader","depthUniforms","originalCamera","gyro","Gyroscope","shadowFilter","pars","cameraHelper","CameraHelper","objectMaterial","useMorphing","useSkinning","customDepthMaterial","clearAlpha","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","oldFogType","sceneFogType","GeometryUtils","geometry1","geometry2","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","getNormalMap","subtract","imageData","createImageData","ly","uy","lx","ux","num_points","generateDataTexture","SceneUtils","createMultiMaterialObject","detach","attach","FontUtils","divisions","getFace","loadFace","family","familyName","ThreeFont","cssFontWeight","cssFontStyle","drawText","resolution","fontPaths","Path","ret","extractGlyphPoints","paths","outline","action","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","pts","glyph","glyphs","_cachedOutline","quadraticCurveTo","Shape","Utils","bezierCurveTo","ha","generateShapes","curveSegments","font","shapes","toShapes","namespace","EPSILON","process","contour","verts","vertIndices","nv","snip","px","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cCROSSap","bCROSScp","aCROSSbp","Triangulate","_typeface_js","typeface_js","Audio","source","createBufferSource","onended","onEnded","gain","createGain","connect","destination","panner","createPanner","autoplay","isPlaying","decodeAudioData","loop","setLoop","setRefDistance","refDistance","setRolloffFactor","rolloffFactor","setVolume","AudioListener","AudioContext","webkitAudioContext","orientation","positionPrev","setOrientation","setVelocity","Curve","getPointAt","getUtoTmapping","getPoints","getSpacedPoints","lengths","getLengths","cacheArcLengths","current","cache","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","getPointFunc","CurvePath","curves","bends","autoClose","curve","checkConnection","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","maxX","maxY","maxZ","minX","minY","minZ","NEGATIVE_INFINITY","POSITIVE_INFINITY","createPointsGeometry","createGeometry","createSpacedPointsGeometry","addWrapPath","bendpath","getTransformedPoints","oldPts","getWrapPoints","getTransformedSpacedPoints","oldX","oldY","xNorm","bounds","pathPt","translationObject","quaternionObject","scaleObject","translationWorld","quaternionWorld","scaleWorld","actions","fromPoints","PathActions","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","BEZIER_CURVE_TO","CSPLINE_THRU","ARC","ELLIPSE","vectors","vlen","args","lastargs","x0","y0","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","EllipseCurve","lastPoint","closedPath","useSpacedPoints","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","isClockWise","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambigious","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","hole","tmpHoles","holes","extrude","extruded","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","getSpacedPointsHoles","extractAllPoints","shape","extractPoints","extractAllSpacedPoints","triangulateShape","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","nextIdx","intersection","intersectsHoleEdge","ihIdx","chkHole","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","h2","allPointsMap","allpoints","shapeWithoutHoles","b2p0","b2p1","b2p2","b3p0","b3p1","b3p2","b3p3","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","ClosedSplineCurve3","AnimationHandler","CATMULLROM","CATMULLROM_FORWARD","hierarchy","rot","usedMorphTargets","morphTargetName","morphTargetsInfluences","parseRecurseHierarchy","deltaTimeMS","resetBlendWeights","Animation","timeScale","interpolationType","keyTypes","animationCache","positionWeight","quaternionWeight","scaleWeight","prevKey","nextKey","originalMatrix","getNextKeyWith","newVector","newQuat","interpolateCatmullRom","prevXYZ","nextXYZ","proportionalWeight","getPrevKeyWith","currentPoint","forwardPoint","KeyFrameAnimation","isPaused","sids","sid","next","endTime","original","hasTarget","MorphAnimation","lastFrame","currentFrame","interpolation","buildPlane","udir","vdir","gridX","gridY","width_half","height_half","gridX1","gridY1","segment_width","segment_height","uvd","depth_half","centerUV","segment","CubeGeometry","heightHalf","verticesRow","uvsRow","tanTheta","v4","n4","uv1","uv3","uv4","addShapeList","addShape","scalePt2","pt","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","colinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","layer","flen","f3","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","extrudeMaterial","generateSideWallUV","extrudePts","splineTube","binormal","position2","bevelThickness","bevelSize","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","TubeGeometry","FrenetFrames","shapePoints","reverse","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","radiusStep","thetaSegment","TextGeometry","textShapes","getPos","in_q","in_p","cu","su","quOverP","cs","tz","grid","tang","bitan","ip","jp","closed","taper","NoTaper","numpoints","pos2","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","mat","PolyhedronGeometry","prepare","that","azimuth","inclination","centroid","azi","correctUV","subdivide","cols","bj","DodecahedronGeometry","OctahedronGeometry","TetrahedronGeometry","ParametricGeometry","func","slices","stacks","sliceCount","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","thresholdAngle","thresholdDot","edge","sortFunction","numEdges","vert1","vert2","face1","face2","FaceNormalsHelper","objectVertices","objectFaces","objectWorldMatrix","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","worldMatrix","vertexId","VertexTangentsHelper","WireframeHelper","edges","numTris","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","active","autoCreateAnimations","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","ERROR","COMPOSITE","DECORATOR","ACTION","CONDITION","createUUID","hexDigits","substr","baseClass","cls","_baseMemory","_treeMemory","_getTreeMemory","treeScope","nodeMemory","openNodes","traversalDepth","traversalCycle","_getNodeMemory","treeMemory","nodeScope","_getMemory","Tick","_openNodes","_nodeCount","_enterNode","_openNode","_tickNode","_closeNode","_exitNode","title","description","properties","names","nodes","spec","EvalError","category","cid","dump","stack","lastOpenNodes","currOpenNodes","_close","BaseNode","_enter","_open","_tick","_exit","enter","close","exit","__BaseNode_initialize","Decorator","Condition","Priority","MemSequence","MemPriority","Inverter","Limiter","maxLoop","__Decorator_initialize","MaxTime","maxTime","getTime","currTime","Repeater","RepeatUntilFailure","RepeatUntilSuccess","Failer","Runner","Succeeder","Wait","milliseconds","Entity","Messanger","ObjectPool","QuadTree","Spatial","Vec2","Ai","_Components","_tags","TComponent","entityAddComponent","entityRemoveComponent","hasAllComponents","Components","tag","entityAddTag","removeTag","entityRemoveTag","removeEntity","_events","fired","handled","Event","listenTo","eventName","trigger","option","events","fire","messanger","_entities","_groups","_entityPool","_componentPools","componentPropertyName","Component","getName","charAt","groupKey","T","ENTITY_CREATED","ENTITY_REMOVE","COMPONENT_ADDED","COMPONENT_REMOVE","aquire","_trigger","removeEntitiesByTag","removeAllEntities","entityRemoveAllComponents","release","cName","cPool","component","groupName","Cs","loc","propName","_indexGroup","poolStats","used","totalUsed","pool","level","maxEntities","maxLevels","__init","insert","_getIndex","spatial","absPosition","absHwidth","_splitAndRedistributeIfNeeded","_node","queryArea","hwidth","out__entities","overlapping","rectIntersect","reIndex","_combine","tSize","tPos","validateEntity","hw","assign","smult","rectContains","midX","midY","_split","_redistribute","_factory","freeList","magnitude","rotate","magnitude2","angleBetween","pcopy","fromAngle","pfromAngle","r1","r2","sizeToHwidth","out__position","out__hwidth","expand","totalFree","_absScale","_absPosition","_absHwidth","COINCIDENT","attachTo","absRotation","pScale","absScale","_name","_callback","Comps","whereComponent","whereComponents","extends","mixin","getArguments","extends_","Child","Parent","Super","Function","makeT","mixin_","FUNCTION_ARGS","replace","FUNCTION_NAME"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","global.Class = require('js-class');\r\nglobal.THREE = require('three');\r\nglobal.THREEx = require('./js/THREEx.KeyboardState.js');\r\nglobal.Physijs = require('physijs-browserify')(THREE);\r\nglobal.Stats = require('stats.js');\r\n\r\nrequire('./RequestAnimationFrame.js');\r\nrequire('./rubbable.js');\r\nglobal.SuperGif = require('./libgif.js');\r\n\r\nrequire('./js/Game.js');\r\nrequire('./js/Globals.js');\r\nrequire('./js/ResourceManager.js');\r\nrequire('./js/PointerLockControls.js');\r\nrequire('./js/EntityFactory.js');\r\nrequire('./js/Systems.js');\r\nrequire('./js/MouseController.js');\r\n\r\nPhysijs.scripts.worker = './libs/physijsWorker.js';\r\nPhysijs.scripts.ammo = './ammo.js';\r\n\r\n// purpose: function as a basic FPS game using an ECS (entity-component system) pattern\r\n//\r\n// requires: RequestAnimationFrame.js, three.js, three-pointerlockcontrols.js, stats.js, js-class.js, physijs, tiny-ecs\r\n//           Game.js, ResourceManager.js\r\n//\r\n// author: Cornell Daly\r\n//\r\n// date: November 3, 2015\r\n//\r\n// additional notes: code is separated into multiple files\r\n\r\nvar game = null;\r\n\r\nfunction init() {\r\n  Globals.instance.hudElement = document.getElementById(\"hud\");\r\n\r\n  Globals.instance.healthElement = document.getElementById(\"health\");\r\n  Globals.instance.scoreElement = document.getElementById(\"score\");\r\n\r\n  Globals.instance.reloadingElement = document.getElementById(\"reloading\");\r\n  Globals.instance.reloadImg = new SuperGif({\r\n    gif: document.getElementById(\"reloadImg\")\r\n  });\r\n  Globals.instance.reloadImg.load();\r\n\r\n  Globals.instance.overlayElement = document.getElementById(\"overlay\");\r\n\r\n  var gameOptions = {\r\n    container: document.getElementById(\"container\"),\r\n    loadingContainer: document.getElementById(\"loadingContainer\"),\r\n    blocker: document.getElementById(\"blocker\"),\r\n    instructions: document.getElementById(\"instructions\"),\r\n    crosshair: document.getElementById(\"crosshair\"),\r\n    modelsToPreload: [\r\n      \"models/potato.json\"\r\n    ]\r\n  };\r\n  game = new Game(gameOptions);\r\n\r\n  game.start();\r\n}\r\n\r\ninit();\r\n\r\n","/**\n * Provides requestAnimationFrame in a cross browser way.\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\n\nif ( !window.requestAnimationFrame ) {\n\n\twindow.requestAnimationFrame = ( function() {\n\n\t\treturn window.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\twindow.oRequestAnimationFrame ||\n\t\twindow.msRequestAnimationFrame ||\n\t\tfunction( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {\n\n\t\t\twindow.setTimeout( callback, 1000 / 60 );\n\n\t\t};\n\n\t} )();\n\n}\n","// THREEx.KeyboardState.js keep the current state of the keyboard.\r\n// It is possible to query it at any time. No need of an event.\r\n// This is particularly convenient in loop driven case, like in\r\n// 3D demos or games.\r\n//\r\n// # Usage\r\n//\r\n// **Step 1**: Create the object\r\n//\r\n// ```var keyboard  = new THREEx.KeyboardState();```\r\n//\r\n// **Step 2**: Query the keyboard state\r\n//\r\n// This will return true if shift and A are pressed, false otherwise\r\n//\r\n// ```keyboard.pressed(\"shift+A\")```\r\n//\r\n// **Step 3**: Stop listening to the keyboard\r\n//\r\n// ```keyboard.destroy()```\r\n//\r\n// NOTE: this library may be nice as standaline. independant from three.js\r\n// - rename it keyboardForGame\r\n//\r\n// # Code\r\n//\r\n\r\n/** @namespace */\r\nvar THREEx = THREEx || {};\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREEx;\r\n\r\n}\r\n\r\n/**\r\n * - NOTE: it would be quite easy to push event-driven too\r\n *   - microevent.js for events handling\r\n *   - in this._onkeyChange, generate a string from the DOM event\r\n *   - use this as event name\r\n */\r\nTHREEx.KeyboardState = function(domElement) {\r\n  this.domElement = domElement || document;\r\n  // to store the current state\r\n  this.keyCodes = {};\r\n  this.modifiers = {};\r\n\r\n  // create callback to bind/unbind keyboard events\r\n  var _this = this;\r\n  this._onKeyDown = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n  this._onKeyUp = function(event) {\r\n    _this._onKeyChange(event)\r\n  };\r\n\r\n  // bind keyEvents\r\n  this.domElement.addEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.addEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // create callback to bind/unbind window blur event\r\n  this._onBlur = function() {\r\n    for (var prop in _this.keyCodes) _this.keyCodes[prop] = false;\r\n    for (var prop in _this.modifiers) _this.modifiers[prop] = false;\r\n  };\r\n\r\n  // bind window blur\r\n  window.addEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\n/**\r\n * To stop listening of the keyboard events\r\n */\r\nTHREEx.KeyboardState.prototype.destroy = function() {\r\n  // unbind keyEvents\r\n  this.domElement.removeEventListener(\"keydown\", this._onKeyDown, false);\r\n  this.domElement.removeEventListener(\"keyup\", this._onKeyUp, false);\r\n\r\n  // unbind window blur event\r\n  window.removeEventListener(\"blur\", this._onBlur, false);\r\n};\r\n\r\nTHREEx.KeyboardState.MODIFIERS = ['shift', 'ctrl', 'alt', 'meta'];\r\nTHREEx.KeyboardState.ALIAS = {\r\n  'left': 37,\r\n  'up': 38,\r\n  'right': 39,\r\n  'down': 40,\r\n  'space': 32,\r\n  'pageup': 33,\r\n  'pagedown': 34,\r\n  'tab': 9,\r\n  'escape': 27\r\n};\r\n\r\n/**\r\n * to process the keyboard dom event\r\n */\r\nTHREEx.KeyboardState.prototype._onKeyChange = function(event) {\r\n  // log to debug\r\n  //console.log(\"onKeyChange\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n\r\n  // update this.keyCodes\r\n  var keyCode = event.keyCode\r\n  var pressed = event.type === 'keydown' ? true : false\r\n  this.keyCodes[keyCode] = pressed\r\n    // update this.modifiers\r\n  this.modifiers['shift'] = event.shiftKey\r\n  this.modifiers['ctrl'] = event.ctrlKey\r\n  this.modifiers['alt'] = event.altKey\r\n  this.modifiers['meta'] = event.metaKey\r\n};\r\n\r\n/**\r\n * query keyboard state to know if a key is pressed of not\r\n *\r\n * @param {String} keyDesc the description of the key. format : modifiers+key e.g shift+A\r\n * @returns {Boolean} true if the key is pressed, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.pressed = function(keyDesc) {\r\n  var keys = keyDesc.split(\"+\");\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i]\r\n    var pressed = false\r\n    if (THREEx.KeyboardState.MODIFIERS.indexOf(key) !== -1) {\r\n      pressed = this.modifiers[key];\r\n    }\r\n    else if (Object.keys(THREEx.KeyboardState.ALIAS).indexOf(key) != -1) {\r\n      pressed = this.keyCodes[THREEx.KeyboardState.ALIAS[key]];\r\n    }\r\n    else {\r\n      pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)]\r\n    }\r\n    if (!pressed) return false;\r\n  };\r\n  return true;\r\n};\r\n\r\n/**\r\n * return true if an event match a keyDesc\r\n * @param  {KeyboardEvent} event   keyboard event\r\n * @param  {String} keyDesc string description of the key\r\n * @return {Boolean}         true if the event match keyDesc, false otherwise\r\n */\r\nTHREEx.KeyboardState.prototype.eventMatches = function(event, keyDesc) {\r\n  var aliases = THREEx.KeyboardState.ALIAS\r\n  var aliasKeys = Object.keys(aliases)\r\n  var keys = keyDesc.split(\"+\")\r\n    // log to debug\r\n    // console.log(\"eventMatches\", event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\r\n  for (var i = 0; i < keys.length; i++) {\r\n    var key = keys[i];\r\n    var pressed = false;\r\n    if (key === 'shift') {\r\n      pressed = (event.shiftKey ? true : false)\r\n    }\r\n    else if (key === 'ctrl') {\r\n      pressed = (event.ctrlKey ? true : false)\r\n    }\r\n    else if (key === 'alt') {\r\n      pressed = (event.altKey ? true : false)\r\n    }\r\n    else if (key === 'meta') {\r\n      pressed = (event.metaKey ? true : false)\r\n    }\r\n    else if (aliasKeys.indexOf(key) !== -1) {\r\n      pressed = (event.keyCode === aliases[key] ? true : false);\r\n    }\r\n    else if (event.keyCode === key.toUpperCase().charCodeAt(0)) {\r\n      pressed = true;\r\n    }\r\n    if (!pressed) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREEx;\r\n  }\r\n  else {\r\n    exports.THREEx = THREEx;\r\n  }\r\n}\r\nelse {\r\n  this['THREEx'] = THREEx;\r\n}\r\n\r\n","/*\n\tRubbableGif\n\n\tExample usage:\n\n\t\t<img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n\t\t<script type=\"text/javascript\">\n\t\t\t$$('img').each(function (img_tag) {\n\t\t\t\tif (/.*\\.gif/.test(img_tag.src)) {\n\t\t\t\t\tvar rub = new RubbableGif({ gif: img_tag } );\n\t\t\t\t\trub.load();\n\t\t\t\t}\n\t\t\t});\n\t\t</script>\n\n\tImage tag attributes:\n\n\t\trel:animated_src -\tIf this url is specified, it's loaded into the player instead of src.\n\t\t\t\t\t\t\tThis allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n\t\trel:auto_play -\t\tDefaults to 1 if not specified. If set to zero, the gif will be rubbable but will not \n\t\t\t\t\t\t\tanimate unless the user is rubbing it.\n\n\tConstructor options args\n\n\t\tgif \t\t\t\tRequired. The DOM element of an img tag.\n\t\tauto_play \t\t\tOptional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n\t\tmax_width\t\t\tOptional. Scale images over max_width down to max_width. Helpful with mobile.\n\n\tInstance methods\n\n\t\t// loading\n\t\tload( callback )\tLoads the gif into a canvas element and then calls callback if one is passed\n\n\t\t// play controls\n\t\tplay -\t\t\t\tStart playing the gif\n\t\tpause -\t\t\t\tStop playing the gif\n\t\tmove_to(i) -\t\tMove to frame i of the gif\n\t\tmove_relative(i) -\tMove i frames ahead (or behind if i < 0)\n\n\t\t// getters\n\t\tget_canvas\t\t\tThe canvas element that the gif is playing in.\n\t\tget_playing\t\t\tWhether or not the gif is currently playing\n\t\tget_loading\t\t\tWhether or not the gif has finished loading/parsing\n\t\tget_auto_play\t\tWhether or not the gif is set to play automatically\n\t\tget_length\t\t\tThe number of frames in the gif\n\t\tget_current_frame\tThe index of the currently displayed frame of the gif\n\n\t\tFor additional customization (viewport inside iframe) these params may be passed:\n\t\tc_w, c_h - width and height of canvas\n\t\tvp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n*/\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(['./libgif'], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('./libgif'));\n    } else {\n        root.RubbableGif = factory(root.SuperGif);\n    }\n}(this, function (SuperGif) {\n    var RubbableGif = function( options ) {\n        var sup = new SuperGif( options );\n\n        var register_canvas_handers = function () {\n\n            var isvp = function(x) {\n                return (options.vp_l ? ( x - options.vp_l ) : x );\n            }\n\n            var canvas = sup.get_canvas();\n            var maxTime = 1000,\n            // allow movement if < 1000 ms (1 sec)\n                w = ( options.vp_w ? options.vp_w : canvas.width ),\n                maxDistance = Math.floor(w / (sup.get_length() * 2)),\n            // swipe movement of 50 pixels triggers the swipe\n                startX = 0,\n                startTime = 0;\n\n            var cantouch = \"ontouchend\" in document;\n\n            var aj = 0;\n            var last_played = 0;\n\n            canvas.addEventListener((cantouch) ? 'touchstart' : 'mousedown', function (e) {\n                // prevent image drag (Firefox)\n                e.preventDefault();\n                if (sup.get_auto_play()) sup.pause();\n\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var x = (pos.layerX > 0) ? isvp(pos.layerX) : w / 2;\n                var progress = x / w;\n\n                sup.move_to( Math.floor(progress * (sup.get_length() - 1)) );\n\n                startTime = e.timeStamp;\n                startX = isvp(pos.pageX);\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchend' : 'mouseup', function (e) {\n                startTime = 0;\n                startX = 0;\n                if (sup.get_auto_play()) sup.play();\n            });\n\n            canvas.addEventListener((cantouch) ? 'touchmove' : 'mousemove', function (e) {\n                e.preventDefault();\n                var pos = (e.touches && e.touches.length > 0) ? e.touches[0] : e;\n\n                var currentX = isvp(pos.pageX);\n                currentDistance = (startX === 0) ? 0 : Math.abs(currentX - startX);\n                // allow if movement < 1 sec\n                currentTime = e.timeStamp;\n                if (startTime !== 0 && currentDistance > maxDistance) {\n                    if (currentX < startX && sup.get_current_frame() > 0) {\n                        sup.move_relative(-1);\n                    }\n                    if (currentX > startX && sup.get_current_frame() < sup.get_length() - 1) {\n                        sup.move_relative(1);\n                    }\n                    startTime = e.timeStamp;\n                    startX = isvp(pos.pageX);\n                }\n\n                var time_since_last_play = e.timeStamp - last_played;\n                {\n                    aj++;\n                    if (document.getElementById('tickles' + ((aj % 5) + 1))) document.getElementById('tickles' + ((aj % 5) + 1)).play();\n                    last_played = e.timeStamp;\n                }\n\n\n            });\n        };\n\n        sup.orig_load = sup.load;\n        sup.load = function(callback) {\n            sup.orig_load( function() {\n                if (callback) callback();\n                register_canvas_handers( sup );\n            } );\n        }\n\n        return sup;\n    }\n\n    return RubbableGif;\n}));","/*\n    SuperGif\n\n    Example usage:\n\n        <img src=\"./example1_preview.gif\" rel:animated_src=\"./example1.gif\" width=\"360\" height=\"360\" rel:auto_play=\"1\" />\n\n        <script type=\"text/javascript\">\n            $$('img').each(function (img_tag) {\n                if (/.*\\.gif/.test(img_tag.src)) {\n                    var rub = new SuperGif({ gif: img_tag } );\n                    rub.load();\n                }\n            });\n        </script>\n\n    Image tag attributes:\n\n        rel:animated_src -  If this url is specified, it's loaded into the player instead of src.\n                            This allows a preview frame to be shown until animated gif data is streamed into the canvas\n\n        rel:auto_play -     Defaults to 1 if not specified. If set to zero, a call to the play() method is needed\n\n    Constructor options args\n\n        gif                 Required. The DOM element of an img tag.\n        loop_mode           Optional. Setting this to false will force disable looping of the gif.\n        auto_play           Optional. Same as the rel:auto_play attribute above, this arg overrides the img tag info.\n        max_width           Optional. Scale images over max_width down to max_width. Helpful with mobile.\n        on_end              Optional. Add a callback for when the gif reaches the end of a single loop (one iteration). The first argument passed will be the gif HTMLElement.\n        loop_delay          Optional. The amount of time to pause (in ms) after each single loop (iteration).\n        draw_while_loading  Optional. Determines whether the gif will be drawn to the canvas whilst it is loaded.\n        show_progress_bar   Optional. Only applies when draw_while_loading is set to true.\n\n    Instance methods\n\n        // loading\n        load( callback )        Loads the gif specified by the src or rel:animated_src sttributie of the img tag into a canvas element and then calls callback if one is passed\n        load_url( src, callback )   Loads the gif file specified in the src argument into a canvas element and then calls callback if one is passed\n\n        // play controls\n        play -              Start playing the gif\n        pause -             Stop playing the gif\n        move_to(i) -        Move to frame i of the gif\n        move_relative(i) -  Move i frames ahead (or behind if i < 0)\n\n        // getters\n        get_canvas          The canvas element that the gif is playing in. Handy for assigning event handlers to.\n        get_playing         Whether or not the gif is currently playing\n        get_loading         Whether or not the gif has finished loading/parsing\n        get_auto_play       Whether or not the gif is set to play automatically\n        get_length          The number of frames in the gif\n        get_current_frame   The index of the currently displayed frame of the gif\n\n        For additional customization (viewport inside iframe) these params may be passed:\n        c_w, c_h - width and height of canvas\n        vp_t, vp_l, vp_ w, vp_h - top, left, width and height of the viewport\n\n        A bonus: few articles to understand what is going on\n            http://enthusiasms.org/post/16976438906\n            http://www.matthewflickinger.com/lab/whatsinagif/bits_and_bytes.asp\n            http://humpy77.deviantart.com/journal/Frame-Delay-Times-for-Animated-GIFs-214150546\n\n*/\n\n// Generic functions\nvar bitsToNum = function(ba) {\n  return ba.reduce(function(s, n) {\n    return s * 2 + n;\n  }, 0);\n};\n\nvar byteToBitArr = function(bite) {\n  var a = [];\n  for (var i = 7; i >= 0; i--) {\n    a.push(!!(bite & (1 << i)));\n  }\n  return a;\n};\n\n// Stream\n/**\n * @constructor\n */\n// Make compiler happy.\nvar Stream = function(data) {\n  this.data = data;\n  this.len = this.data.length;\n  this.pos = 0;\n\n  this.readByte = function() {\n    if (this.pos >= this.data.length) {\n      throw new Error('Attempted to read past end of stream.');\n    }\n    if (data instanceof Uint8Array)\n      return data[this.pos++];\n    else\n      return data.charCodeAt(this.pos++) & 0xFF;\n  };\n\n  this.readBytes = function(n) {\n    var bytes = [];\n    for (var i = 0; i < n; i++) {\n      bytes.push(this.readByte());\n    }\n    return bytes;\n  };\n\n  this.read = function(n) {\n    var s = '';\n    for (var i = 0; i < n; i++) {\n      s += String.fromCharCode(this.readByte());\n    }\n    return s;\n  };\n\n  this.readUnsigned = function() { // Little-endian.\n    var a = this.readBytes(2);\n    return (a[1] << 8) + a[0];\n  };\n};\n\nvar lzwDecode = function(minCodeSize, data) {\n  // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\n  var pos = 0; // Maybe this streaming thing should be merged with the Stream?\n  var readCode = function(size) {\n    var code = 0;\n    for (var i = 0; i < size; i++) {\n      if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\n        code |= 1 << i;\n      }\n      pos++;\n    }\n    return code;\n  };\n\n  var output = [];\n\n  var clearCode = 1 << minCodeSize;\n  var eoiCode = clearCode + 1;\n\n  var codeSize = minCodeSize + 1;\n\n  var dict = [];\n\n  var clear = function() {\n    dict = [];\n    codeSize = minCodeSize + 1;\n    for (var i = 0; i < clearCode; i++) {\n      dict[i] = [i];\n    }\n    dict[clearCode] = [];\n    dict[eoiCode] = null;\n\n  };\n\n  var code;\n  var last;\n\n  while (true) {\n    last = code;\n    code = readCode(codeSize);\n\n    if (code === clearCode) {\n      clear();\n      continue;\n    }\n    if (code === eoiCode) break;\n\n    if (code < dict.length) {\n      if (last !== clearCode) {\n        dict.push(dict[last].concat(dict[code][0]));\n      }\n    }\n    else {\n      if (code !== dict.length) throw new Error('Invalid LZW code.');\n      dict.push(dict[last].concat(dict[last][0]));\n    }\n    output.push.apply(output, dict[code]);\n\n    if (dict.length === (1 << codeSize) && codeSize < 12) {\n      // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\n      codeSize++;\n    }\n  }\n\n  // I don't know if this is technically an error, but some GIFs do it.\n  //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\n  return output;\n};\n\n\n// The actual parsing; returns an object with properties.\nvar parseGIF = function(st, handler) {\n  handler || (handler = {});\n\n  // LZW (GIF-specific)\n  var parseCT = function(entries) { // Each entry is 3 bytes, for RGB.\n    var ct = [];\n    for (var i = 0; i < entries; i++) {\n      ct.push(st.readBytes(3));\n    }\n    return ct;\n  };\n\n  var readSubBlocks = function() {\n    var size, data;\n    data = '';\n    do {\n      size = st.readByte();\n      data += st.read(size);\n    } while (size !== 0);\n    return data;\n  };\n\n  var parseHeader = function() {\n    var hdr = {};\n    hdr.sig = st.read(3);\n    hdr.ver = st.read(3);\n    if (hdr.sig !== 'GIF') throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\n    hdr.width = st.readUnsigned();\n    hdr.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    hdr.gctFlag = bits.shift();\n    hdr.colorRes = bitsToNum(bits.splice(0, 3));\n    hdr.sorted = bits.shift();\n    hdr.gctSize = bitsToNum(bits.splice(0, 3));\n\n    hdr.bgColor = st.readByte();\n    hdr.pixelAspectRatio = st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n    if (hdr.gctFlag) {\n      hdr.gct = parseCT(1 << (hdr.gctSize + 1));\n    }\n    handler.hdr && handler.hdr(hdr);\n  };\n\n  var parseExt = function(block) {\n    var parseGCExt = function(block) {\n      var blockSize = st.readByte(); // Always 4\n      var bits = byteToBitArr(st.readByte());\n      block.reserved = bits.splice(0, 3); // Reserved; should be 000.\n      block.disposalMethod = bitsToNum(bits.splice(0, 3));\n      block.userInput = bits.shift();\n      block.transparencyGiven = bits.shift();\n\n      block.delayTime = st.readUnsigned();\n\n      block.transparencyIndex = st.readByte();\n\n      block.terminator = st.readByte();\n\n      handler.gce && handler.gce(block);\n    };\n\n    var parseComExt = function(block) {\n      block.comment = readSubBlocks();\n      handler.com && handler.com(block);\n    };\n\n    var parsePTExt = function(block) {\n      // No one *ever* uses this. If you use it, deal with parsing it yourself.\n      var blockSize = st.readByte(); // Always 12\n      block.ptHeader = st.readBytes(12);\n      block.ptData = readSubBlocks();\n      handler.pte && handler.pte(block);\n    };\n\n    var parseAppExt = function(block) {\n      var parseNetscapeExt = function(block) {\n        var blockSize = st.readByte(); // Always 3\n        block.unknown = st.readByte(); // ??? Always 1? What is this?\n        block.iterations = st.readUnsigned();\n        block.terminator = st.readByte();\n        handler.app && handler.app.NETSCAPE && handler.app.NETSCAPE(block);\n      };\n\n      var parseUnknownAppExt = function(block) {\n        block.appData = readSubBlocks();\n        // FIXME: This won't work if a handler wants to match on any identifier.\n        handler.app && handler.app[block.identifier] && handler.app[block.identifier](block);\n      };\n\n      var blockSize = st.readByte(); // Always 11\n      block.identifier = st.read(8);\n      block.authCode = st.read(3);\n      switch (block.identifier) {\n        case 'NETSCAPE':\n          parseNetscapeExt(block);\n          break;\n        default:\n          parseUnknownAppExt(block);\n          break;\n      }\n    };\n\n    var parseUnknownExt = function(block) {\n      block.data = readSubBlocks();\n      handler.unknown && handler.unknown(block);\n    };\n\n    block.label = st.readByte();\n    switch (block.label) {\n      case 0xF9:\n        block.extType = 'gce';\n        parseGCExt(block);\n        break;\n      case 0xFE:\n        block.extType = 'com';\n        parseComExt(block);\n        break;\n      case 0x01:\n        block.extType = 'pte';\n        parsePTExt(block);\n        break;\n      case 0xFF:\n        block.extType = 'app';\n        parseAppExt(block);\n        break;\n      default:\n        block.extType = 'unknown';\n        parseUnknownExt(block);\n        break;\n    }\n  };\n\n  var parseImg = function(img) {\n    var deinterlace = function(pixels, width) {\n      // Of course this defeats the purpose of interlacing. And it's *probably*\n      // the least efficient way it's ever been implemented. But nevertheless...\n      var newPixels = new Array(pixels.length);\n      var rows = pixels.length / width;\n      var cpRow = function(toRow, fromRow) {\n        var fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n        newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n      };\n\n      // See appendix E.\n      var offsets = [0, 4, 2, 1];\n      var steps = [8, 8, 4, 2];\n\n      var fromRow = 0;\n      for (var pass = 0; pass < 4; pass++) {\n        for (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n          cpRow(toRow, fromRow)\n          fromRow++;\n        }\n      }\n\n      return newPixels;\n    };\n\n    img.leftPos = st.readUnsigned();\n    img.topPos = st.readUnsigned();\n    img.width = st.readUnsigned();\n    img.height = st.readUnsigned();\n\n    var bits = byteToBitArr(st.readByte());\n    img.lctFlag = bits.shift();\n    img.interlaced = bits.shift();\n    img.sorted = bits.shift();\n    img.reserved = bits.splice(0, 2);\n    img.lctSize = bitsToNum(bits.splice(0, 3));\n\n    if (img.lctFlag) {\n      img.lct = parseCT(1 << (img.lctSize + 1));\n    }\n\n    img.lzwMinCodeSize = st.readByte();\n\n    var lzwData = readSubBlocks();\n\n    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\n\n    if (img.interlaced) { // Move\n      img.pixels = deinterlace(img.pixels, img.width);\n    }\n\n    handler.img && handler.img(img);\n  };\n\n  var parseBlock = function() {\n    var block = {};\n    block.sentinel = st.readByte();\n\n    switch (String.fromCharCode(block.sentinel)) { // For ease of matching\n      case '!':\n        block.type = 'ext';\n        parseExt(block);\n        break;\n      case ',':\n        block.type = 'img';\n        parseImg(block);\n        break;\n      case ';':\n        block.type = 'eof';\n        handler.eof && handler.eof(block);\n        break;\n      default:\n        throw new Error('Unknown block: 0x' + block.sentinel.toString(16)); // TODO: Pad this with a 0.\n    }\n\n    if (block.type !== 'eof') setTimeout(parseBlock, 0);\n  };\n\n  var parse = function() {\n    parseHeader();\n    setTimeout(parseBlock, 0);\n  };\n\n  parse();\n};\n\nvar SuperGif = function(opts) {\n  var options = {\n    //viewport position\n    vp_l: 0,\n    vp_t: 0,\n    vp_w: null,\n    vp_h: null,\n    //canvas sizes\n    c_w: null,\n    c_h: null\n  };\n  for (var i in opts) {\n    options[i] = opts[i]\n  }\n  if (options.vp_w && options.vp_h) options.is_vp = true;\n\n  var stream;\n  var hdr;\n\n  var loadError = null;\n  var loading = false;\n\n  var transparency = null;\n  var delay = null;\n  var disposalMethod = null;\n  var disposalRestoreFromIdx = 0;\n  var lastDisposalMethod = null;\n  var frame = null;\n  var lastImg = null;\n\n  var playing = true;\n  var forward = true;\n\n  var ctx_scaled = false;\n\n  var frames = [];\n  var frameOffsets = []; // elements have .x and .y properties\n\n  var gif = options.gif;\n  if (typeof options.auto_play == 'undefined')\n    options.auto_play = (!gif.getAttribute('rel:auto_play') || gif.getAttribute('rel:auto_play') == '1');\n\n  var onEndListener = (options.hasOwnProperty('on_end') ? options.on_end : null);\n  var loopDelay = (options.hasOwnProperty('loop_delay') ? options.loop_delay : 0);\n  var overrideLoopMode = (options.hasOwnProperty('loop_mode') ? options.loop_mode : 'auto');\n  var drawWhileLoading = (options.hasOwnProperty('draw_while_loading') ? options.draw_while_loading : true);\n  var showProgressBar = drawWhileLoading ? (options.hasOwnProperty('show_progress_bar') ? options.show_progress_bar : true) : false;\n\n  var clear = function() {\n    transparency = null;\n    delay = null;\n    lastDisposalMethod = disposalMethod;\n    disposalMethod = null;\n    frame = null;\n  };\n\n  // XXX: There's probably a better way to handle catching exceptions when\n  // callbacks are involved.\n  var doParse = function() {\n    try {\n      parseGIF(stream, handler);\n    }\n    catch (err) {\n      doLoadError('parse');\n    }\n  };\n\n  var doText = function(text) {\n    toolbar.innerHTML = text; // innerText? Escaping? Whatever.\n    toolbar.style.visibility = 'visible';\n  };\n\n  var setSizes = function(w, h) {\n    canvas.width = w * get_canvas_scale();\n    canvas.height = h * get_canvas_scale();\n    toolbar.style.minWidth = (w * get_canvas_scale()) + 'px';\n\n    tmpCanvas.width = w;\n    tmpCanvas.height = h;\n    tmpCanvas.style.width = w + 'px';\n    tmpCanvas.style.height = h + 'px';\n    tmpCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n  };\n\n  var setFrameOffset = function(frame, offset) {\n    if (!frameOffsets[frame]) {\n      frameOffsets[frame] = offset;\n      return;\n    }\n    if (typeof offset.x !== 'undefined') {\n      frameOffsets[frame].x = offset.x;\n    }\n    if (typeof offset.y !== 'undefined') {\n      frameOffsets[frame].y = offset.y;\n    }\n  };\n\n  var doShowProgress = function(pos, length, draw) {\n    if (draw && showProgressBar) {\n      var height = 25;\n      var left, mid, top, width;\n      if (options.is_vp) {\n        if (!ctx_scaled) {\n          top = (options.vp_t + options.vp_h - height);\n          height = height;\n          left = options.vp_l;\n          mid = left + (pos / length) * options.vp_w;\n          width = canvas.width;\n        }\n        else {\n          top = (options.vp_t + options.vp_h - height) / get_canvas_scale();\n          height = height / get_canvas_scale();\n          left = (options.vp_l / get_canvas_scale());\n          mid = left + (pos / length) * (options.vp_w / get_canvas_scale());\n          width = canvas.width / get_canvas_scale();\n        }\n        //some debugging, draw rect around viewport\n        if (false) {\n          if (!ctx_scaled) {\n            var l = options.vp_l,\n              t = options.vp_t;\n            var w = options.vp_w,\n              h = options.vp_h;\n          }\n          else {\n            var l = options.vp_l / get_canvas_scale(),\n              t = options.vp_t / get_canvas_scale();\n            var w = options.vp_w / get_canvas_scale(),\n              h = options.vp_h / get_canvas_scale();\n          }\n          ctx.rect(l, t, w, h);\n          ctx.stroke();\n        }\n      }\n      else {\n        top = (canvas.height - height) / (ctx_scaled ? get_canvas_scale() : 1);\n        mid = ((pos / length) * canvas.width) / (ctx_scaled ? get_canvas_scale() : 1);\n        width = canvas.width / (ctx_scaled ? get_canvas_scale() : 1);\n        height /= ctx_scaled ? get_canvas_scale() : 1;\n      }\n      // XXX Figure out alpha fillRect.\n      //ctx.fillStyle = 'salmon';\n      ctx.fillStyle = 'rgba(255,255,255,0.4)';\n      ctx.fillRect(mid, top, width - mid, height);\n\n      //ctx.fillStyle = 'teal';\n      ctx.fillStyle = 'rgba(255,0,22,.8)';\n      ctx.fillRect(0, top, mid, height);\n    }\n  };\n\n  var doLoadError = function(originOfError) {\n    var drawError = function() {\n      ctx.fillStyle = 'black';\n      ctx.fillRect(0, 0, options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.strokeStyle = 'red';\n      ctx.lineWidth = 3;\n      ctx.moveTo(0, 0);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, options.c_h ? options.c_h : hdr.height);\n      ctx.moveTo(0, options.c_h ? options.c_h : hdr.height);\n      ctx.lineTo(options.c_w ? options.c_w : hdr.width, 0);\n      ctx.stroke();\n    };\n\n    loadError = originOfError;\n    hdr = {\n      width: gif.width,\n      height: gif.height\n    }; // Fake header.\n    frames = [];\n    drawError();\n  };\n\n  var doHdr = function(_hdr) {\n    hdr = _hdr;\n    setSizes(hdr.width, hdr.height)\n  };\n\n  var doGCE = function(gce) {\n    pushFrame();\n    clear();\n    transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\n    delay = gce.delayTime;\n    disposalMethod = gce.disposalMethod;\n    // We don't have much to do with the rest of GCE.\n  };\n\n  var pushFrame = function() {\n    if (!frame) return;\n    frames.push({\n      data: frame.getImageData(0, 0, hdr.width, hdr.height),\n      delay: delay\n    });\n    frameOffsets.push({\n      x: 0,\n      y: 0\n    });\n  };\n\n  var doImg = function(img) {\n    if (!frame) frame = tmpCanvas.getContext('2d');\n\n    var currIdx = frames.length;\n\n    //ct = color table, gct = global color table\n    var ct = img.lctFlag ? img.lct : hdr.gct; // TODO: What if neither exists?\n\n    /*\n    Disposal method indicates the way in which the graphic is to\n    be treated after being displayed.\n\n    Values :    0 - No disposal specified. The decoder is\n                    not required to take any action.\n                1 - Do not dispose. The graphic is to be left\n                    in place.\n                2 - Restore to background color. The area used by the\n                    graphic must be restored to the background color.\n                3 - Restore to previous. The decoder is required to\n                    restore the area overwritten by the graphic with\n                    what was there prior to rendering the graphic.\n\n                    Importantly, \"previous\" means the frame state\n                    after the last disposal of method 0, 1, or 2.\n    */\n    if (currIdx > 0) {\n      if (lastDisposalMethod === 3) {\n        // Restore to previous\n        frame.putImageData(frames[disposalRestoreFromIdx].data, 0, 0);\n      }\n      else {\n        disposalRestoreFromIdx = currIdx - 1;\n      }\n\n      if (lastDisposalMethod === 2) {\n        // Restore to background color\n        // Browser implementations historically restore to transparent; we do the same.\n        // http://www.wizards-toolkit.org/discourse-server/viewtopic.php?f=1&t=21172#p86079\n        frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\n      }\n    }\n    // else, Undefined/Do not dispose.\n    // frame contains final pixel data from the last frame; do nothing\n\n    //Get existing pixels for img region after applying disposal method\n    var imgData = frame.getImageData(img.leftPos, img.topPos, img.width, img.height);\n\n    //apply color table colors\n    var cdd = imgData.data;\n    img.pixels.forEach(function(pixel, i) {\n      // imgData.data === [R,G,B,A,R,G,B,A,...]\n      if (pixel !== transparency) {\n        cdd[i * 4 + 0] = ct[pixel][0];\n        cdd[i * 4 + 1] = ct[pixel][1];\n        cdd[i * 4 + 2] = ct[pixel][2];\n        cdd[i * 4 + 3] = 255; // Opaque.\n      }\n    });\n    imgData.data.set(cdd);\n\n    frame.putImageData(imgData, img.leftPos, img.topPos);\n\n    if (!ctx_scaled) {\n      ctx.scale(get_canvas_scale(), get_canvas_scale());\n      ctx_scaled = true;\n    }\n\n    // We could use the on-page canvas directly, except that we draw a progress\n    // bar for each image chunk (not just the final image).\n    if (drawWhileLoading)\n      ctx.drawImage(tmpCanvas, 0, 0);\n\n    lastImg = img;\n  };\n\n  var player = (function() {\n    var i = -1;\n    var iterationCount = 0;\n\n    var showingInfo = false;\n    var pinned = false;\n\n    /**\n     * Gets the index of the frame \"up next\".\n     * @returns {number}\n     */\n    var getNextFrameNo = function() {\n      var delta = (forward ? 1 : -1);\n      return (i + delta + frames.length) % frames.length;\n    };\n\n    var stepFrame = function(amount) { // XXX: Name is confusing.\n      i = i + amount;\n\n      putFrame();\n    };\n\n    var completeLoop = function() {\n      if (onEndListener !== null)\n        onEndListener(gif);\n      iterationCount++;\n    };\n\n    var step = (function() {\n      var stepping = false;\n\n      var doStep = function() {\n        stepping = playing;\n        if (!stepping) return;\n\n        stepFrame(1);\n        var delay = frames[i].delay * 10;\n        if (!delay) delay = 100; // FIXME: Should this even default at all? What should it be?\n\n        var nextFrameNo = getNextFrameNo();\n        if (nextFrameNo === 0) {\n          delay += loopDelay;\n          setTimeout(completeLoop, delay - 1);\n        }\n\n        if ((overrideLoopMode !== false || nextFrameNo !== 0 || iterationCount < 0))\n          setTimeout(doStep, delay);\n\n      };\n\n      return function() {\n        if (!stepping) setTimeout(doStep, 0);\n      };\n    }());\n\n    var putFrame = function() {\n      var offset;\n      i = parseInt(i, 10);\n\n      if (i > frames.length - 1) {\n        i = 0;\n      }\n\n      if (i < 0) {\n        i = 0;\n      }\n\n      offset = frameOffsets[i];\n\n      tmpCanvas.getContext(\"2d\").putImageData(frames[i].data, offset.x, offset.y);\n      ctx.globalCompositeOperation = \"copy\";\n      ctx.drawImage(tmpCanvas, 0, 0);\n    };\n\n    var play = function() {\n      playing = true;\n      step();\n    };\n\n    var pause = function() {\n      playing = false;\n    };\n\n\n    return {\n      init: function() {\n        if (loadError) return;\n\n        if (!(options.c_w && options.c_h)) {\n          ctx.scale(get_canvas_scale(), get_canvas_scale());\n        }\n\n        if (options.auto_play) {\n          step();\n        }\n        else {\n          i = 0;\n          putFrame();\n        }\n      },\n      step: step,\n      play: play,\n      pause: pause,\n      playing: playing,\n      move_relative: stepFrame,\n      current_frame: function() {\n        return i;\n      },\n      length: function() {\n        return frames.length\n      },\n      move_to: function(frame_idx) {\n        i = frame_idx;\n        putFrame();\n      }\n    }\n  }());\n\n  var doDecodeProgress = function(draw) {\n    doShowProgress(stream.pos, stream.data.length, draw);\n  };\n\n  var doNothing = function() {};\n  /**\n   * @param{boolean=} draw Whether to draw progress bar or not; this is not idempotent because of translucency.\n   *                       Note that this means that the text will be unsynchronized with the progress bar on non-frames;\n   *                       but those are typically so small (GCE etc.) that it doesn't really matter. TODO: Do this properly.\n   */\n  var withProgress = function(fn, draw) {\n    return function(block) {\n      fn(block);\n      doDecodeProgress(draw);\n    };\n  };\n\n\n  var handler = {\n    hdr: withProgress(doHdr),\n    gce: withProgress(doGCE),\n    com: withProgress(doNothing),\n    // I guess that's all for now.\n    app: {\n      // TODO: Is there much point in actually supporting iterations?\n      NETSCAPE: withProgress(doNothing)\n    },\n    img: withProgress(doImg, true),\n    eof: function(block) {\n      //toolbar.style.display = '';\n      pushFrame();\n      doDecodeProgress(false);\n      if (!(options.c_w && options.c_h)) {\n        canvas.width = hdr.width * get_canvas_scale();\n        canvas.height = hdr.height * get_canvas_scale();\n      }\n      player.init();\n      loading = false;\n      if (load_callback) {\n        load_callback(gif);\n      }\n\n    }\n  };\n\n  var init = function() {\n    var parent = gif.parentNode;\n\n    var span = document.createElement('span');\n    canvas = document.createElement('canvas');\n    ctx = canvas.getContext('2d');\n    toolbar = document.createElement('div');\n\n    tmpCanvas = document.createElement('canvas');\n\n    span.width = canvas.width = gif.width;\n    span.height = canvas.height = gif.height;\n    toolbar.style.minWidth = gif.width + 'px';\n\n    span.className = 'jsgif';\n    toolbar.className = 'jsgif_toolbar';\n    span.appendChild(canvas);\n    span.appendChild(toolbar);\n\n    parent.insertBefore(span, gif);\n    parent.removeChild(gif);\n\n    if (options.c_w && options.c_h) setSizes(options.c_w, options.c_h);\n    initialized = true;\n  };\n\n  var get_canvas_scale = function() {\n    var scale;\n    if (options.max_width && hdr && hdr.width > options.max_width) {\n      scale = options.max_width / hdr.width;\n    }\n    else {\n      scale = 1;\n    }\n    return scale;\n  }\n\n  var canvas, ctx, toolbar, tmpCanvas;\n  var initialized = false;\n  var load_callback = false;\n\n  var load_setup = function(callback) {\n    if (loading) return false;\n    if (callback) load_callback = callback;\n    else load_callback = false;\n\n    loading = true;\n    frames = [];\n    clear();\n    disposalRestoreFromIdx = 0;\n    lastDisposalMethod = null;\n    frame = null;\n    lastImg = null;\n\n    return true;\n  }\n\n  return {\n    // play controls\n    play: player.play,\n    pause: player.pause,\n    move_relative: player.move_relative,\n    move_to: player.move_to,\n\n    // getters for instance vars\n    get_playing: function() {\n      return player.playing\n    },\n    get_canvas: function() {\n      return canvas\n    },\n    get_canvas_scale: function() {\n      return get_canvas_scale()\n    },\n    get_loading: function() {\n      return loading\n    },\n    get_auto_play: function() {\n      return options.auto_play\n    },\n    get_length: function() {\n      return player.length()\n    },\n    get_current_frame: function() {\n      return player.current_frame()\n    },\n    load_url: function(src, callback) {\n      if (!load_setup(callback)) return;\n\n      var h = new XMLHttpRequest();\n      h.overrideMimeType('text/plain; charset=x-user-defined');\n      h.onloadstart = function() {\n        // Wait until connection is opened to replace the gif element with a canvas to avoid a blank img\n        if (!initialized) init();\n      };\n      h.onload = function(e) {\n        stream = new Stream(h.responseText);\n        setTimeout(doParse, 0);\n      };\n      h.onprogress = function(e) {\n        if (e.lengthComputable) doShowProgress(e.loaded, e.total, true);\n      };\n      h.onerror = function() {\n        doLoadError('xhr');\n      };\n      h.open('GET', src, true);\n      h.send();\n    },\n    load: function(callback) {\n      this.load_url(gif.getAttribute('rel:animated_src') || gif.src, callback);\n    },\n    load_raw: function(arr, callback) {\n      if (!load_setup(callback)) return;\n      if (!initialized) init();\n      stream = new Stream(arr);\n      setTimeout(doParse, 0);\n    },\n    set_frame_offset: setFrameOffset\n  };\n};\n\nmodule.exports = SuperGif;\n\n","Game = Class({\r\n  constructor: function(options) {\r\n    this.container = options.container;\r\n    this.loadingContainer = options.loadingContainer;\r\n    this.blocker = options.blocker;\r\n    this.instructions = options.instructions;\r\n    this.crosshair = options.crosshair;\r\n\r\n    this.stats = null;\r\n\r\n    this.prevTime = performance.now();\r\n\r\n    this.renderer = null;\r\n    this.scene = null;\r\n    this.camera = null;\r\n\r\n    this.paused = true;\r\n\r\n    this.controlsEnabled = false;\r\n    this.controls = null;\r\n\r\n    this.systems = [];\r\n    this.postPhysicsSystems = [];\r\n\r\n    this.modelsToPreload = options.modelsToPreload;\r\n    this.percentModelsLoaded = 0;\r\n  },\r\n\r\n  start: function(runImmediately) {\r\n    if (runImmediately === undefined || runImmediately === null) {\r\n      runImmediately = true;\r\n    }\r\n\r\n    window.addEventListener('resize', this.onResize.bind(this));\r\n    window.onkeydown = this.onKeyDown.bind(this); // prevent spacebar from scrolling the page\r\n    window.addEventListener('mousedown', this.onMouseDown.bind(this));\r\n    window.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n\r\n    this.renderer = new THREE.WebGLRenderer({\r\n      antialias: true\r\n    });\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.renderer.setClearColor(0xffffff, 1);\r\n    this.container.appendChild(this.renderer.domElement);\r\n\r\n    /* Stats.js Setup */\r\n    this.stats = new Stats();\r\n    this.stats.setMode(0);\r\n\r\n    this.stats.domElement.style.position = 'absolute';\r\n    this.stats.domElement.style.left = '10px';\r\n    this.stats.domElement.style.bottom = '10px';\r\n\r\n    document.body.appendChild(this.stats.domElement);\r\n\r\n    // Create a new Three.js scene\r\n    this.scene = new Physijs.Scene();\r\n    this.scene.setGravity(new THREE.Vector3(0, -32, 0));\r\n\r\n    // Put in a camera\r\n    var aspectRatio = window.innerWidth / window.innerHeight;\r\n    this.camera = new THREE.PerspectiveCamera(45, aspectRatio, 0.1, 1000);\r\n    this.scene.add(this.camera);\r\n\r\n    /* Camera Controller */\r\n    this.controls = new PointerLockControls({\r\n      camera: this.camera\r\n    });\r\n    this.scene.add(this.controls.getObject());\r\n\r\n    /* Setup Crosshair */\r\n\r\n    this.crosshair.style.left = ((window.innerWidth / 2) - 32) + 'px';\r\n    this.crosshair.style.top = ((window.innerHeight / 2) - 32) + 'px';\r\n\r\n    var ambientLight = new THREE.AmbientLight(0xcbcbcb);\r\n    this.scene.add(ambientLight);\r\n\r\n    var dirLight = new THREE.DirectionalLight(0xdcdcdc, 0.5);\r\n    this.scene.add(dirLight);\r\n\r\n    /* Create Entities */\r\n\r\n    EntityFactory.instance.makeGround({\r\n      scene: this.scene\r\n    });\r\n\r\n    this.player = EntityFactory.instance.makePlayer({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(0, 20, 0),\r\n      controls: this.controls,\r\n      controlsObject: this.controls.getObject(),\r\n      cameraOffset: new THREE.Vector3(0, 3, 0)\r\n    });\r\n\r\n    EntityFactory.instance.makeEnemy({\r\n      scene: this.scene,\r\n      position: new THREE.Vector3(0, 10, -200),\r\n      aiTarget: this.player\r\n    });\r\n\r\n    /* Setup Systems */\r\n\r\n    this.systems.push(new CameraRotationSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new PlayerInputSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new AISystem(EntityFactory.instance.entities));\r\n    this.systems.push(new MovementSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ExpirableSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new CameraFollowSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new ShootDelaySystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HurtSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new PlayerHealthSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new HealthBarSystem(EntityFactory.instance.entities));\r\n    this.systems.push(new DeathSystem(EntityFactory.instance.entities));\r\n\r\n    this.postPhysicsSystems.push(new PhysicsUpdateSystem(EntityFactory.instance.entities));\r\n\r\n    this.loadModels();\r\n  },\r\n\r\n  loadModels: function() {\r\n    this.modelsToPreload.forEach(function(model) {\r\n      ResourceManager.instance.loadModel(model, this.modelLoaded.bind(this));\r\n    }.bind(this));\r\n  },\r\n\r\n  modelLoaded: function(model) {\r\n    var percentPerModel = 100.0 / this.modelsToPreload.length;\r\n    this.percentModelsLoaded += percentPerModel;\r\n\r\n    if (this.percentModelsLoaded > 99.0) {\r\n      // hide loading indicator and show instructions\r\n      this.loadingContainer.style.visibility = \"hidden\";\r\n      this.blocker.style.visibility = \"visible\";\r\n      this.instructions.style.visibility = \"visible\";\r\n      Globals.instance.hudElement.style.display = 'block';\r\n      this.crosshair.style.display = 'block';\r\n\r\n      // ensure the user is at the top of the page\r\n      document.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\r\n      this.initPointerLock();\r\n\r\n      this.run();\r\n    }\r\n  },\r\n\r\n  run: function() {\r\n    requestAnimationFrame(this.update.bind(this));\r\n  },\r\n\r\n  update: function() {\r\n    requestAnimationFrame(this.update.bind(this));\r\n\r\n    var time = performance.now();\r\n    var dt = (time - this.prevTime) / 1000;\r\n    Globals.instance.dt = dt;\r\n\r\n    if (!this.paused) {\r\n      if (dt > 0.5) {\r\n        dt = 0.5;\r\n      }\r\n\r\n      this.systems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      this.scene.simulate();\r\n\r\n      this.postPhysicsSystems.forEach(function(system) {\r\n        system.update(dt);\r\n      });\r\n\r\n      MouseController.instance.update(dt);\r\n    }\r\n\r\n    this.renderer.render(this.scene, this.camera);\r\n    this.stats.update();\r\n\r\n    this.prevTime = time;\r\n  },\r\n\r\n  onResize: function(e) {\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n\r\n    this.camera.aspect = (window.innerWidth / window.innerHeight);\r\n    this.camera.updateProjectionMatrix();\r\n\r\n    this.crosshair.style.left = ((window.innerWidth / 2) - 32) + 'px';\r\n    this.crosshair.style.top = ((window.innerHeight / 2) - 32) + 'px';\r\n  },\r\n\r\n  onKeyDown: function(e) {\r\n    var keyCode = ('which' in event) ? event.which : event.keyCode;\r\n\r\n    return (keyCode !== Game.KEY_CODES.space);\r\n  },\r\n\r\n  onMouseDown: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = true;\r\n    }\r\n  },\r\n\r\n  onMouseUp: function(e) {\r\n    if (this.paused) {\r\n      return;\r\n    }\r\n\r\n    if (e.button === 0) {\r\n      MouseController.instance.isDown.left = false;\r\n      MouseController.instance.wasPressed.left = true;\r\n    }\r\n    else if (e.button === 2) {\r\n      MouseController.instance.isDown.right = false;\r\n      MouseController.instance.wasPressed.right = true;\r\n    }\r\n  },\r\n\r\n  initPointerLock: function() {\r\n    var havePointerLock = 'pointerLockElement' in document || 'mozPointerLockElement' in document || 'webkitPointerLockElement' in document;\r\n\r\n    if (havePointerLock) {\r\n\r\n      var element = document.body;\r\n\r\n      var pointerlockchange = function(event) {\r\n\r\n        if (document.pointerLockElement === element || document.mozPointerLockElement === element || document.webkitPointerLockElement === element) {\r\n\r\n          this.controlsEnabled = true;\r\n          this.controls.enabled = true;\r\n\r\n          this.blocker.style.display = 'none';\r\n\r\n          if (Globals.instance.reloadingElement.style.visibility === 'visible') {\r\n            Globals.instance.reloadImg.play();\r\n          }\r\n\r\n          this.paused = false;\r\n\r\n        }\r\n        else {\r\n\r\n          this.controls.enabled = false;\r\n\r\n          this.blocker.style.display = '-webkit-box';\r\n          this.blocker.style.display = '-moz-box';\r\n          this.blocker.style.display = 'box';\r\n\r\n          this.instructions.style.display = '';\r\n\r\n          if (Globals.instance.reloadImg.get_playing()) {\r\n            Globals.instance.reloadImg.pause();\r\n          }\r\n\r\n          this.paused = true;\r\n\r\n        }\r\n\r\n      }.bind(this);\r\n\r\n      var pointerlockerror = function(event) {\r\n\r\n        this.instructions.style.display = '';\r\n\r\n      }.bind(this);\r\n\r\n      // Hook pointer lock state change events\r\n      document.addEventListener('pointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('mozpointerlockchange', pointerlockchange, false);\r\n      document.addEventListener('webkitpointerlockchange', pointerlockchange, false);\r\n\r\n      document.addEventListener('pointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('mozpointerlockerror', pointerlockerror, false);\r\n      document.addEventListener('webkitpointerlockerror', pointerlockerror, false);\r\n\r\n      this.instructions.addEventListener('click', function(event) {\r\n\r\n        this.instructions.style.display = 'none';\r\n\r\n        // Ask the browser to lock the pointer\r\n        element.requestPointerLock = element.requestPointerLock || element.mozRequestPointerLock || element.webkitRequestPointerLock;\r\n\r\n        if (/Firefox/i.test(navigator.userAgent)) {\r\n\r\n          var fullscreenchange = function(event) {\r\n\r\n            if (document.fullscreenElement === element || document.mozFullscreenElement === element || document.mozFullScreenElement === element) {\r\n\r\n              document.removeEventListener('fullscreenchange', fullscreenchange);\r\n              document.removeEventListener('mozfullscreenchange', fullscreenchange);\r\n\r\n              element.requestPointerLock();\r\n            }\r\n\r\n          };\r\n\r\n          document.addEventListener('fullscreenchange', fullscreenchange, false);\r\n          document.addEventListener('mozfullscreenchange', fullscreenchange, false);\r\n\r\n          element.requestFullscreen = element.requestFullscreen || element.mozRequestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;\r\n\r\n          element.requestFullscreen();\r\n\r\n        }\r\n        else {\r\n\r\n          element.requestPointerLock();\r\n\r\n        }\r\n\r\n      }.bind(this), false);\r\n\r\n    }\r\n    else {\r\n\r\n      this.instructions.innerHTML = 'Your browser doesn\\'t seem to support Pointer Lock API';\r\n\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    KEY_CODES: {\r\n      space: 32\r\n    }\r\n  }\r\n});\r\n\r\n","Model = Class({\r\n  constructor: function(options) {\r\n    this.geometry = options.geometry;\r\n    this.material = options.material;\r\n  }\r\n});\r\n\r\nResourceManager = Class({\r\n  constructor: function() {\r\n    this.loadingManager = new THREE.LoadingManager();\r\n\r\n    this.jsonLoader = new THREE.JSONLoader(this.loadingManager);\r\n\r\n    this.textures = {};\r\n    this.models = {};\r\n  },\r\n\r\n  getTexture: function(path, callback) {\r\n    if (path === null || path === undefined) {\r\n      return null;\r\n    }\r\n    else if (path in this.textures) {\r\n      return this.textures[path];\r\n    }\r\n\r\n    this.textures[path] = THREE.ImageUtils.loadTexture(path, undefined, callback);\r\n\r\n    return this.textures[path];\r\n  },\r\n\r\n  loadModel: function(path, callback) {\r\n    if (path === null || path === undefined) {\r\n      return;\r\n    }\r\n    else if (path in this.models) {\r\n      callback(this.models[path]);\r\n\r\n      return;\r\n    }\r\n\r\n    this.jsonLoader.load(path, function(geometry, materials) {\r\n      var material = new THREE.MeshFaceMaterial(materials);\r\n\r\n      var model = new Model({\r\n        geometry: geometry,\r\n        material: material\r\n      });\r\n      this.models[path] = model;\r\n\r\n      callback(model);\r\n    }.bind(this));\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!ResourceManager._instance) {\r\n        ResourceManager._instance = new ResourceManager();\r\n      }\r\n      return ResourceManager._instance;\r\n    }\r\n  }\r\n});\r\n\r\n","var EntityManager = require('tiny-ecs').EntityManager;\r\nvar C = require('./Components.js');\r\nvar b3 = require('./../b3core.0.1.0.js');\r\n\r\nEntityFactory = Class({\r\n  constructor: function() {\r\n    this.entities = new EntityManager();\r\n  },\r\n\r\n  makePlayer: function(options) {\r\n    var player = this.entities.createEntity();\r\n\r\n    player.addTag(\"player\");\r\n\r\n    player.addComponent(C.Identifier);\r\n    player.addComponent(C.Position);\r\n    player.addComponent(C.Velocity);\r\n    player.addComponent(C.Jump);\r\n    player.addComponent(C.Drawable);\r\n    player.addComponent(C.CameraFollow);\r\n    player.addComponent(C.ShootDelay);\r\n    player.addComponent(C.Health);\r\n\r\n    player.identifier.type = Globals.ENTITY_TYPES.player;\r\n\r\n    player.drawable.scene = options.scene;\r\n\r\n    player.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(2, 8, 2),\r\n      Physijs.createMaterial(new THREE.MeshBasicMaterial({\r\n        color: 0xffff00\r\n      }), 0.9, 0.01), 73);\r\n    player.drawable.mesh.entity = player;\r\n\r\n    player.drawable.mesh.position.copy(options.position);\r\n    //player.drawable.mesh.rotation.copy(options.rotation);\r\n\r\n    player.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.player;\r\n    player.drawable.mesh._physijs.collision_masks = EntityFactory.COLLISION_TYPES.obstacle | EntityFactory.COLLISION_TYPES.enemy | EntityFactory.COLLISION_TYPES.enemyBullet;\r\n\r\n    player.drawable.scene.add(player.drawable.mesh);\r\n\r\n    player.drawable.mesh.setDamping(0.99, 0);\r\n    player.drawable.mesh.setAngularFactor(new THREE.Vector3(0, 0, 0));\r\n\r\n    player.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n      if (contact_normal.y < 0 && other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n        player.jump.canJump = true;\r\n      }\r\n\r\n      if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy && player.hasComponent(C.Hurt) === false) {\r\n        player.addComponent(C.Hurt);\r\n        player.hurt.originalColor = player.drawable.mesh.material.color;\r\n\r\n        player.health.hp--;\r\n        player.health.changed = true;\r\n      }\r\n    });\r\n\r\n    player.position.x = options.position.x;\r\n    player.position.y = options.position.y;\r\n    player.position.z = options.position.z;\r\n\r\n    player.cameraFollow.controls = options.controls;\r\n    player.cameraFollow.object = options.controlsObject;\r\n    player.cameraFollow.offset = options.cameraOffset;\r\n\r\n    player.shootDelay.delayTheshold = 1.5;\r\n\r\n    return player;\r\n  },\r\n\r\n  makeEnemy: function(options) {\r\n    var enemy = this.entities.createEntity();\r\n\r\n    enemy.addTag(\"enemy\");\r\n\r\n    enemy.addComponent(C.Identifier);\r\n    enemy.addComponent(C.Position);\r\n    enemy.addComponent(C.Velocity);\r\n    enemy.addComponent(C.Drawable);\r\n    enemy.addComponent(C.Health);\r\n    enemy.addComponent(C.ShootDelay);\r\n    enemy.addComponent(C.AI);\r\n\r\n    enemy.identifier.type = Globals.ENTITY_TYPES.enemy;\r\n\r\n    enemy.drawable.scene = options.scene;\r\n\r\n    enemy.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(10, 10, 10),\r\n      Physijs.createMaterial(new THREE.MeshPhongMaterial({\r\n        color: 0x0000ff\r\n      }), 0.9, 0.1), 81);\r\n    enemy.drawable.mesh.entity = enemy;\r\n\r\n    enemy.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemy;\r\n    enemy.drawable.mesh._physijs.collision_masks = EntityFactory.COLLISION_TYPES.obstacle | EntityFactory.COLLISION_TYPES.player | EntityFactory.COLLISION_TYPES.playerBullet;\r\n\r\n    enemy.drawable.mesh.position.copy(options.position);\r\n    //enemy.drawable.mesh.rotation.copy(options.rotation);\r\n\r\n    enemy.drawable.scene.add(enemy.drawable.mesh);\r\n\r\n    enemy.drawable.mesh.setDamping(0.99, 0);\r\n\r\n    enemy.position.x = options.position.x;\r\n    enemy.position.y = options.position.y;\r\n    enemy.position.z = options.position.z;\r\n\r\n    enemy.health.healthBar = new THREE.Mesh(\r\n      new THREE.BoxGeometry(10, 1.5, 0.5),\r\n      new THREE.MeshBasicMaterial({\r\n        color: 0x00ff00\r\n      }));\r\n    enemy.health.healthBar.position.set(0, 7, 0);\r\n    enemy.drawable.mesh.add(enemy.health.healthBar);\r\n\r\n    enemy.shootDelay.delayTheshold = 1.5;\r\n\r\n    var FaceNode = b3.Class(b3.Action);\r\n    FaceNode.prototype.name = 'FaceNode';\r\n    FaceNode.prototype.parameters = {\r\n      'facing': null\r\n    };\r\n\r\n    FaceNode.prototype.__Action_initialize = FaceNode.prototype.initialize;\r\n    FaceNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.facing = settings.facing;\r\n    };\r\n\r\n    FaceNode.prototype.tick = function(tick) {\r\n      if (this.facing._manager === null || this.facing._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      // http://forum.unity3d.com/threads/making-an-object-rotate-to-face-another.1211/\r\n      // http://answers.unity3d.com/questions/503934/chow-to-check-if-an-object-is-facing-another.html\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.facing.drawable.mesh.position.clone();\r\n\r\n      parentPos.y = 0;\r\n      followingPos.y = 0;\r\n\r\n      var posDif = parentPos.clone();\r\n      posDif.sub(followingPos);\r\n\r\n      var direction = new THREE.Vector3(0, 0, -1);\r\n      var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n      rotation.set(tick.target.drawable.mesh.rotation.x, tick.target.drawable.mesh.rotation.y, 0);\r\n\r\n      var forward = new THREE.Vector3();\r\n      forward.copy(direction).applyEuler(rotation);\r\n\r\n      var angle = forward.angleTo(posDif);\r\n\r\n      if (angle <= 0.02) {\r\n        return b3.SUCCESS;\r\n      }\r\n\r\n      var lookAtMatrix = new THREE.Matrix4();\r\n      lookAtMatrix.lookAt(followingPos, parentPos, new THREE.Vector3(0, 1, 0));\r\n\r\n      var parentRotation = new THREE.Quaternion().setFromEuler(tick.target.drawable.mesh.rotation);\r\n      var targetRotation = new THREE.Quaternion().setFromRotationMatrix(lookAtMatrix);\r\n\r\n      var str = Math.min(3 * Globals.instance.dt, 5);\r\n\r\n      parentRotation.slerp(targetRotation, str);\r\n\r\n      tick.target.drawable.mesh.rotation.setFromQuaternion(parentRotation);\r\n      tick.target.drawable.mesh.__dirtyRotation = true;\r\n\r\n      return b3.RUNNING;\r\n    };\r\n\r\n    var RandomChildNode = b3.Class(b3.Composite);\r\n    RandomChildNode.prototype.name = 'RandomChildNode';\r\n\r\n    RandomChildNode.prototype.__Composite_initialize = RandomChildNode.prototype.initialize;\r\n    RandomChildNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Composite_initialize(settings);\r\n\r\n      this.chance = settings.chance;\r\n    };\r\n\r\n    RandomChildNode.prototype.tick = function(tick) {\r\n      //var chance = 1 / this.children.length;\r\n\r\n      for (var i = 0; i < this.children.length; i++) {\r\n        if (Math.random() <= this.chance[i]) {\r\n          var status = this.children[i]._execute(tick);\r\n\r\n          if (status !== b3.SUCCESS) {\r\n            return status;\r\n          }\r\n        }\r\n      }\r\n\r\n      return b3.SUCCESS;\r\n    };\r\n\r\n    var FollowNode = b3.Class(b3.Action);\r\n    FollowNode.prototype.name = 'FollowNode';\r\n    FollowNode.prototype.parameters = {\r\n      'following': null\r\n    };\r\n\r\n    FollowNode.prototype.__Action_initialize = FollowNode.prototype.initialize;\r\n    FollowNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.following = settings.following;\r\n    };\r\n\r\n    FollowNode.prototype.tick = function(tick) {\r\n      if (this.following._manager === null || this.following._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.following.drawable.mesh.position.clone();\r\n\r\n      var distance = parentPos.distanceTo(followingPos);\r\n\r\n      if (distance < 0.5) {\r\n        return b3.SUCCESS;\r\n      }\r\n\r\n      var difference = new THREE.Vector3();\r\n      difference.subVectors(followingPos, parentPos);\r\n\r\n      var normal = difference.normalize();\r\n      var velocity = new THREE.Vector3(tick.target.velocity.x, tick.target.velocity.y, tick.target.velocity.z);\r\n      var dv = new THREE.Vector3(EntityFactory.MOVE_SPEED.enemy * normal.x, 0, EntityFactory.MOVE_SPEED.enemy * normal.z);\r\n\r\n      velocity.add(dv);\r\n\r\n      tick.target.velocity.x = velocity.x;\r\n      tick.target.velocity.y = velocity.y;\r\n      tick.target.velocity.z = velocity.z;\r\n\r\n      return b3.RUNNING;\r\n    };\r\n\r\n    var ShootNode = b3.Class(b3.Action);\r\n    ShootNode.prototype.name = 'ShootNode';\r\n    ShootNode.prototype.parameters = {\r\n      'shootingAt': null\r\n    };\r\n\r\n    ShootNode.prototype.__Action_initialize = ShootNode.prototype.initialize;\r\n    ShootNode.prototype.initialize = function(settings) {\r\n      settings = settings || {};\r\n\r\n      this.__Action_initialize();\r\n\r\n      this.shootingAt = settings.shootingAt;\r\n    };\r\n\r\n    ShootNode.prototype.tick = function(tick) {\r\n      if (this.shootingAt._manager === null || this.shootingAt._manager === undefined) {\r\n        return b3.FAILURE;\r\n      }\r\n      else if (tick.target.shootDelay.canShoot === false) {\r\n        return b3.FAILURE;\r\n      }\r\n\r\n      var direction = new THREE.Vector3(0, 0, 1);\r\n      var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n      rotation.set(tick.target.drawable.mesh.rotation.x, tick.target.drawable.mesh.rotation.y, 0);\r\n\r\n      var forward = new THREE.Vector3();\r\n      forward.copy(direction).applyEuler(rotation);\r\n\r\n      var parentPos = tick.target.drawable.mesh.position.clone();\r\n      var followingPos = this.shootingAt.drawable.mesh.position.clone();\r\n\r\n      var distance = parentPos.distanceTo(followingPos);\r\n\r\n      forward.y += distance / 800;\r\n\r\n      EntityFactory.instance.makeBullet({\r\n        scene: tick.target.drawable.scene,\r\n        position: tick.target.drawable.mesh.position.clone(),\r\n        rotation: tick.target.drawable.mesh.rotation.clone(),\r\n        scale: new THREE.Vector3(0.5, 0.5, 0.5),\r\n        direction: forward,\r\n        rotationMatrix: tick.target.velocity.rotationMatrix,\r\n        velocity: 35,\r\n        owner: 'enemy'\r\n      });\r\n\r\n      tick.target.shootDelay.canShoot = false;\r\n\r\n      return b3.SUCCESS;\r\n    };\r\n\r\n    enemy.ai.tree = new b3.BehaviorTree();\r\n    enemy.ai.tree.root = new b3.Sequence({\r\n      children: [\r\n        new b3.Sequence({\r\n          children: [\r\n            new FaceNode({\r\n              facing: options.aiTarget\r\n            }),\r\n            new RandomChildNode({\r\n              children: [\r\n                new FollowNode({\r\n                  following: options.aiTarget\r\n                }),\r\n                new ShootNode({\r\n                  shootingAt: options.aiTarget\r\n                })\r\n              ],\r\n              chance: [\r\n                0.9,\r\n                0.1\r\n              ]\r\n            })\r\n          ]\r\n        })\r\n      ]\r\n    });\r\n\r\n    enemy.ai.target = enemy;\r\n    enemy.ai.blackboard = new b3.Blackboard();\r\n  },\r\n\r\n  makeBullet: function(options) {\r\n    ResourceManager.instance.loadModel('models/potato.json', function(model) {\r\n      var bullet = this.entities.createEntity();\r\n\r\n      bullet.addTag(\"bullet\");\r\n\r\n      bullet.addComponent(C.Identifier);\r\n      bullet.addComponent(C.Position);\r\n      bullet.addComponent(C.Drawable);\r\n      bullet.addComponent(C.Bullet);\r\n      bullet.addComponent(C.Expirable);\r\n      bullet.addComponent(C.OneTimeHit);\r\n\r\n      bullet.identifier.type = Globals.ENTITY_TYPES.bullet;\r\n      bullet.bullet.owner = options.owner;\r\n\r\n      bullet.drawable.scene = options.scene;\r\n\r\n      bullet.drawable.mesh = new Physijs.ConvexMesh(\r\n        model.geometry,\r\n        Physijs.createMaterial(model.material, 0.7, 0.01),\r\n        0.3);\r\n      bullet.drawable.mesh.entity = bullet;\r\n\r\n      if (options.owner === 'player') {\r\n        bullet.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.playerBullet;\r\n        bullet.drawable.mesh._physijs.collision_masks = EntityFactory.COLLISION_TYPES.obstacle | EntityFactory.COLLISION_TYPES.enemy | EntityFactory.COLLISION_TYPES.playerBullet | EntityFactory.COLLISION_TYPES.enemyBullet;\r\n      }\r\n      else {\r\n        bullet.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.enemyBullet;\r\n        bullet.drawable.mesh._physijs.collision_masks = EntityFactory.COLLISION_TYPES.obstacle | EntityFactory.COLLISION_TYPES.player | EntityFactory.COLLISION_TYPES.playerBullet | EntityFactory.COLLISION_TYPES.enemyBullet;\r\n      }\r\n\r\n      bullet.drawable.mesh.position.copy(options.position);\r\n      bullet.drawable.mesh.rotation.copy(options.rotation);\r\n      bullet.drawable.mesh.scale.copy(options.scale);\r\n\r\n      bullet.drawable.scene.add(bullet.drawable.mesh);\r\n\r\n      bullet.drawable.mesh.setDamping(0.1, 0);\r\n\r\n      bullet.drawable.mesh.addEventListener('collision', function(other_object, relative_velocity, relative_rotation, contact_normal) {\r\n        if (bullet.bullet.isHot === false) {\r\n          return;\r\n        }\r\n\r\n        var hitPlayer = bullet.bullet.owner === 'enemy' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.player;\r\n        var hitEnemy = bullet.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.enemy;\r\n\r\n        if ((hitPlayer || hitEnemy) && bullet.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          other_object.entity.addComponent(C.Hurt);\r\n          other_object.entity.hurt.originalColor = other_object.material.color;\r\n\r\n          other_object.entity.health.hp--;\r\n          other_object.entity.health.changed = true;\r\n\r\n          bullet.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n        else if (other_object.entity.identifier.type === Globals.ENTITY_TYPES.ground) {\r\n          bullet.bullet.touchedGround = true;\r\n        }\r\n        else if (bullet.bullet.owner === 'player' && other_object.entity.identifier.type === Globals.ENTITY_TYPES.bullet && other_object.entity.bullet.owner === 'enemy' && bullet.oneTimeHit.alreadyHit.indexOf(other_object.uuid) < 0) {\r\n          Globals.instance.score += 5;\r\n\r\n          Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n\r\n          bullet.oneTimeHit.alreadyHit.push(other_object.uuid);\r\n        }\r\n\r\n        bullet.bullet.isHot = false;\r\n      }.bind(this));\r\n\r\n      if (options.position) {\r\n        bullet.position.x = options.position.x;\r\n        bullet.position.y = options.position.y;\r\n        bullet.position.z = options.position.z;\r\n      }\r\n\r\n      var vel = new THREE.Vector3(options.velocity, options.velocity, options.velocity);\r\n      vel.multiply(options.direction);\r\n      //var vel = new THREE.Vector3(0, 0, -options.velocity).applyMatrix4(options.rotationMatrix);\r\n      bullet.drawable.mesh.applyCentralImpulse(vel);\r\n      //console.log(vel, options.direction, options.position);\r\n\r\n      bullet.expirable.maxAge = 5;\r\n    }.bind(this));\r\n  },\r\n\r\n  makeGround: function(options) {\r\n    var ground = this.entities.createEntity();\r\n\r\n    ground.addComponent(C.Identifier);\r\n    ground.addComponent(C.Position);\r\n    ground.addComponent(C.Drawable);\r\n\r\n    ground.identifier.type = Globals.ENTITY_TYPES.ground;\r\n\r\n    ground.drawable.scene = options.scene;\r\n\r\n    ground.drawable.mesh = new Physijs.BoxMesh(\r\n      new THREE.BoxGeometry(500, 1, 500),\r\n      new THREE.MeshBasicMaterial({\r\n        color: 0x00dd00\r\n      }), 0);\r\n    ground.drawable.mesh.entity = ground;\r\n\r\n    ground.drawable.mesh._physijs.collision_type = EntityFactory.COLLISION_TYPES.obstacle;\r\n    ground.drawable.mesh._physijs.collision_masks = EntityFactory.COLLISION_TYPES.player | EntityFactory.COLLISION_TYPES.enemy | EntityFactory.COLLISION_TYPES.playerBullet | EntityFactory.COLLISION_TYPES.enemyBullet;\r\n\r\n    ground.drawable.scene.add(ground.drawable.mesh);\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!EntityFactory._instance) {\r\n        EntityFactory._instance = new EntityFactory();\r\n      }\r\n      return EntityFactory._instance;\r\n    },\r\n\r\n    COLLISION_TYPES: {\r\n      nothing: 0, // collide with nothing\r\n\r\n      obstacle: 1 << 0,\r\n      player: 1 << 2,\r\n      enemy: 1 << 3,\r\n\r\n      playerBullet: 1 << 4,\r\n      enemyBullet: 1 << 5\r\n    },\r\n\r\n    MOVE_SPEED: {\r\n      enemy: 70\r\n    }\r\n  }\r\n});\r\n\r\n","Globals = Class({\r\n  constructor: function() {\r\n    this.dt = 0;\r\n\r\n    this.hudElement = null;\r\n\r\n    this.healthElement = null;\r\n\r\n    this.scoreElement = null;\r\n    this.score = 0;\r\n\r\n    this.reloadingElement = null;\r\n    this.reloadImg = null;\r\n\r\n    this.overlayElement = null;\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!Globals._instance) {\r\n        Globals._instance = new Globals();\r\n      }\r\n      return Globals._instance;\r\n    },\r\n\r\n    ENTITY_TYPES: {\r\n      player: 0,\r\n      enemy: 1,\r\n\r\n      ground: 2,\r\n      obstacle: 3,\r\n\r\n      bullet: 4\r\n    }\r\n  }\r\n});\r\n\r\n","PointerLockControls = Class({\r\n  constructor: function(options) {\r\n    this.camera = options.camera;\r\n    this.camera.rotation.set(0, 0, 0);\r\n\r\n    this.pitchObject = new THREE.Object3D();\r\n    this.pitchObject.add(this.camera);\r\n\r\n    this.yawObject = new THREE.Object3D();\r\n    this.yawObject.position.y = 10;\r\n    this.yawObject.add(this.pitchObject);\r\n\r\n    this.moveForward = false;\r\n    this.moveBackward = false;\r\n    this.moveLeft = false;\r\n    this.moveRight = false;\r\n\r\n    this.isOnObject = false;\r\n    this.canJump = false;\r\n\r\n    this.prevTime = performance.now();\r\n\r\n    this.velocity = new THREE.Vector3();\r\n\r\n    this.enabled = false;\r\n\r\n    this.mass = options.mass || 100.0;\r\n    this.moveSpeed = options.moveSpeed || new THREE.Vector3(400.0, 350.0, 400.0);\r\n    this.minimumY = options.minimumY || 10;\r\n\r\n    document.addEventListener('mousemove', this.onMouseMove.bind(this), false);\r\n    document.addEventListener('keydown', this.onKeyDown.bind(this), false);\r\n    document.addEventListener('keyup', this.onKeyUp.bind(this), false);\r\n  },\r\n\r\n  onMouseMove: function(event) {\r\n    if (this.enabled === false) {\r\n      return;\r\n    }\r\n\r\n    var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\r\n    var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\r\n\r\n    this.yawObject.rotation.y -= movementX * 0.002;\r\n    this.pitchObject.rotation.x -= movementY * 0.002;\r\n\r\n    this.pitchObject.rotation.x = Math.max(-PointerLockControls.PI_2, Math.min(PointerLockControls.PI_2, this.pitchObject.rotation.x));\r\n  },\r\n\r\n  onKeyDown: function(event) {\r\n    switch (event.keyCode) {\r\n      case 38: // up\r\n      case 87: // w\r\n        this.moveForward = true;\r\n        break;\r\n\r\n      case 37: // left\r\n      case 65: // a\r\n        this.moveLeft = true;\r\n        break;\r\n\r\n      case 40: // down\r\n      case 83: // s\r\n        this.moveBackward = true;\r\n        break;\r\n\r\n      case 39: // right\r\n      case 68: // d\r\n        this.moveRight = true;\r\n        break;\r\n\r\n      case 32: // space\r\n        if (this.canJump === true) {\r\n          this.velocity.y += this.moveSpeed.y;\r\n        }\r\n\r\n        this.canJump = false;\r\n\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  },\r\n\r\n  onKeyUp: function(event) {\r\n    switch (event.keyCode) {\r\n      case 38: // up\r\n      case 87: // w\r\n        this.moveForward = false;\r\n        break;\r\n\r\n      case 37: // left\r\n      case 65: // a\r\n        this.moveLeft = false;\r\n        break;\r\n\r\n      case 40: // down\r\n      case 83: // s\r\n        this.moveBackward = false;\r\n        break;\r\n\r\n      case 39: // right\r\n      case 68: // d\r\n        this.moveRight = false;\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  },\r\n\r\n  getObject: function() {\r\n    return this.yawObject;\r\n  },\r\n\r\n  isOnObject: function(bool) {\r\n    this.isOnObject = bool;\r\n    this.canJump = bool;\r\n  },\r\n\r\n  getDirection: function() {\r\n    // assumes the camera itself is not rotated\r\n    var direction = new THREE.Vector3(0, 0, -1);\r\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n\r\n    return function(v) {\r\n      rotation.set(this.pitchObject.rotation.x, this.yawObject.rotation.y, 0);\r\n\r\n      v.copy(direction).applyEuler(rotation);\r\n\r\n      return v;\r\n    };\r\n  }(),\r\n\r\n  update: function(dt) {\r\n    if (this.enabled === false) {\r\n      return;\r\n    }\r\n\r\n    this.velocity.x -= this.velocity.x * 10.0 * dt;\r\n    this.velocity.z -= this.velocity.z * 10.0 * dt;\r\n\r\n    this.velocity.y -= 9.8 * this.mass * dt;\r\n\r\n    if (this.moveForward) {\r\n      this.velocity.z -= this.moveSpeed.z * dt;\r\n    }\r\n    if (this.moveBackward) {\r\n      this.velocity.z += this.moveSpeed.z * dt;\r\n    }\r\n\r\n    if (this.moveLeft) {\r\n      this.velocity.x -= this.moveSpeed.x * dt;\r\n    }\r\n    if (this.moveRight) {\r\n      this.velocity.x += this.moveSpeed.x * dt;\r\n    }\r\n\r\n    if (this.isOnObject === true) {\r\n      this.velocity.y = Math.max(0, this.velocity.y);\r\n    }\r\n\r\n    this.yawObject.translateX(this.velocity.x * dt);\r\n    this.yawObject.translateY(this.velocity.y * dt);\r\n    this.yawObject.translateZ(this.velocity.z * dt);\r\n\r\n    if (this.yawObject.position.y < this.minimumY) {\r\n      this.velocity.y = 0;\r\n      this.yawObject.position.y = this.minimumY;\r\n\r\n      this.canJump = true;\r\n    }\r\n  }\r\n}, {\r\n  statics: {\r\n    PI_2: Math.PI / 2\r\n  }\r\n});\r\n\r\n","var C = require('./Components.js');\r\n\r\nPlayerInputSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n\r\n    this.keyboard = new THREEx.KeyboardState();\r\n    this.jumped = false;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n      var dv = new THREE.Vector3(); // delta velocity\r\n\r\n      if (this.keyboard.pressed(\"w\")) {\r\n        dv.z = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"s\")) {\r\n        dv.z = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"a\")) {\r\n        dv.x = -PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n      else if (this.keyboard.pressed(\"d\")) {\r\n        dv.x = PlayerInputSystem.MOVE_SPEED;\r\n      }\r\n\r\n      if (this.keyboard.pressed(\"space\") && entity.jump.canJump) {\r\n        dv.y = PlayerInputSystem.JUMP_FORCE;\r\n        entity.jump.canJump = false;\r\n      }\r\n\r\n      dv = dv.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      velocity.add(dv);\r\n\r\n      entity.velocity.x = velocity.x;\r\n      entity.velocity.y = velocity.y;\r\n      entity.velocity.z = velocity.z;\r\n\r\n      if (entity.shootDelay.canShoot) {\r\n        if (MouseController.instance.wasPressed.left) {\r\n          var direction = new THREE.Vector3();\r\n          entity.cameraFollow.controls.getDirection(direction);\r\n\r\n          EntityFactory.instance.makeBullet({\r\n            scene: entity.drawable.scene,\r\n            position: entity.cameraFollow.object.position.clone(),\r\n            rotation: entity.cameraFollow.object.rotation.clone(),\r\n            scale: new THREE.Vector3(0.5, 0.5, 0.5),\r\n            direction: direction,\r\n            rotationMatrix: entity.velocity.rotationMatrix,\r\n            velocity: 35,\r\n            owner: 'player'\r\n          });\r\n\r\n          entity.shootDelay.canShoot = false;\r\n\r\n          Globals.instance.reloadImg.move_to(0);\r\n          Globals.instance.reloadImg.play();\r\n          Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n        }\r\n        else if (MouseController.instance.wasPressed.right) {\r\n          var direction = new THREE.Vector3();\r\n          entity.cameraFollow.controls.getDirection(direction);\r\n\r\n          EntityFactory.instance.makeBullet({\r\n            scene: entity.drawable.scene,\r\n            position: entity.cameraFollow.object.position.clone(),\r\n            rotation: entity.cameraFollow.object.rotation.clone(),\r\n            scale: new THREE.Vector3(0.5, 0.5, 0.5),\r\n            direction: direction,\r\n            rotationMatrix: entity.velocity.rotationMatrix,\r\n            velocity: 6,\r\n            owner: 'player'\r\n          });\r\n\r\n          entity.shootDelay.canShoot = false;\r\n\r\n          Globals.instance.reloadImg.move_to(0);\r\n          Globals.instance.reloadImg.play();\r\n          Globals.instance.reloadingElement.style.visibility = \"visible\";\r\n        }\r\n      }\r\n    }.bind(this));\r\n  }\r\n}, {\r\n  statics: {\r\n    MOVE_SPEED: 50,\r\n    JUMP_FORCE: 2500\r\n  }\r\n});\r\n\r\nMovementSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      var velocity = new THREE.Vector3(entity.velocity.x, entity.velocity.y, entity.velocity.z);\r\n\r\n      if (entity.hasComponent(C.Drawable)) {\r\n        entity.drawable.mesh.applyCentralImpulse(velocity);\r\n        //entity.drawable.mesh.setLinearVelocity(entity.velocity);\r\n      }\r\n      else {\r\n        entity.position.x += velocity.x * dt;\r\n        entity.position.y += velocity.y * dt;\r\n        entity.position.z += velocity.z * dt;\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nExpirableSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var expirables = this.entities.queryComponents([C.Expirable]);\r\n\r\n    expirables.forEach(function(entity) {\r\n      entity.expirable.age += dt;\r\n\r\n      if (entity.expirable.age >= entity.expirable.maxAge) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nCameraRotationSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var follows = this.entities.queryComponents([C.CameraFollow, C.Velocity]);\r\n\r\n    follows.forEach(function(entity) {\r\n      entity.velocity.rotationMatrix = new THREE.Matrix4().extractRotation(entity.cameraFollow.object.matrix);\r\n    });\r\n  }\r\n});\r\n\r\nCameraFollowSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var follows = this.entities.queryComponents([C.CameraFollow, C.Position, C.Velocity]);\r\n\r\n    /*if (follows.length > 1) {\r\n      throw new Error(\"The camera can only follow one object at a time!\");\r\n    }*/\r\n\r\n    follows.forEach(function(entity) {\r\n      if (entity.velocity.rotationMatrix === null) {\r\n        return;\r\n      }\r\n\r\n      var offset = entity.cameraFollow.offset.clone();\r\n      offset = offset.applyMatrix4(entity.velocity.rotationMatrix);\r\n\r\n      entity.cameraFollow.object.position.x = entity.position.x + offset.x;\r\n      entity.cameraFollow.object.position.y = entity.position.y + offset.y;\r\n      entity.cameraFollow.object.position.z = entity.position.z + offset.z;\r\n\r\n      entity.drawable.mesh.rotation.x = entity.cameraFollow.object.rotation.x;\r\n      entity.drawable.mesh.rotation.y = entity.cameraFollow.object.rotation.y;\r\n      entity.drawable.mesh.rotation.z = entity.cameraFollow.object.rotation.z;\r\n    });\r\n  }\r\n});\r\n\r\nShootDelaySystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var shooters = this.entities.queryComponents([C.ShootDelay]);\r\n\r\n    shooters.forEach(function(entity) {\r\n      if (entity.shootDelay.canShoot === false) {\r\n        entity.shootDelay.timer += dt;\r\n\r\n        if (entity.shootDelay.timer > entity.shootDelay.delayTheshold) {\r\n          entity.shootDelay.canShoot = true;\r\n          entity.shootDelay.timer = 0;\r\n\r\n          Globals.instance.reloadImg.pause();\r\n          Globals.instance.reloadingElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nHurtSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var hurtables = this.entities.queryComponents([C.Hurt, C.Drawable]);\r\n\r\n    hurtables.forEach(function(entity) {\r\n      entity.hurt.timer += dt;\r\n\r\n      if (entity.hurt.timer < entity.hurt.invulnerabilityFrames) {\r\n        entity.drawable.mesh.material.color = entity.hurt.hurtColor;\r\n\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.backgroundColor = \"#bb0000\";\r\n          Globals.instance.overlayElement.style.visibility = \"visible\";\r\n        }\r\n      }\r\n      else {\r\n        entity.drawable.mesh.material.color = entity.hurt.originalColor;\r\n\r\n        entity.removeComponent(C.Hurt);\r\n\r\n        if (entity.hasTag(\"player\")) {\r\n          Globals.instance.overlayElement.style.visibility = \"hidden\";\r\n        }\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nPlayerHealthSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n\r\n    this.keyboard = new THREEx.KeyboardState();\r\n    this.jumped = false;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var players = this.entities.queryTag(\"player\");\r\n\r\n    players.forEach(function(entity) {\r\n      if (entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n      var percentRounded = Math.round(percent * 100);\r\n\r\n      var healthElement = Globals.instance.healthElement;\r\n      var color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      healthElement.innerHTML = percentRounded + \"%\";\r\n      healthElement.style.color = \"#\" + color.getHexString();\r\n    });\r\n  }\r\n});\r\n\r\nHealthBarSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.healthBar === null || entity.health.changed === false) {\r\n        return;\r\n      }\r\n\r\n      var percent = entity.health.hp / entity.health.maxHP;\r\n\r\n      entity.health.healthBar.scale.x = percent;\r\n      entity.health.healthBar.material.color = new THREE.Color(1 - percent, percent, 0);\r\n\r\n      entity.health.changed = false;\r\n    });\r\n  }\r\n});\r\n\r\nDeathSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var mortals = this.entities.queryComponents([C.Health]);\r\n\r\n    mortals.forEach(function(entity) {\r\n      if (entity.health.hp <= 0) {\r\n        if (entity.hasComponent(C.Drawable)) {\r\n          if (entity.drawable.mesh._physijs.collision_type === EntityFactory.COLLISION_TYPES.enemy) {\r\n            Globals.instance.score += 10;\r\n\r\n            Globals.instance.scoreElement.innerHTML = Globals.instance.score;\r\n          }\r\n\r\n          entity.drawable.scene.remove(entity.drawable.mesh);\r\n        }\r\n\r\n        entity.remove();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\nAISystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var singularities = this.entities.queryComponents([C.AI]);\r\n\r\n    singularities.forEach(function(entity) {\r\n      if (entity.ai.tree === null || entity.ai.target === null || entity.ai.blackboard === null) {\r\n        return;\r\n      }\r\n\r\n      entity.ai.tree.tick(entity.ai.target, entity.ai.blackboard);\r\n    });\r\n  }\r\n});\r\n\r\nPhysicsUpdateSystem = Class({\r\n  constructor: function(entities) {\r\n    this.entities = entities;\r\n  },\r\n\r\n  update: function(dt) {\r\n    var moveables = this.entities.queryComponents([C.Position, C.Velocity, C.Drawable]);\r\n\r\n    moveables.forEach(function(entity) {\r\n      entity.position.x = entity.drawable.mesh.position.x;\r\n      entity.position.y = entity.drawable.mesh.position.y;\r\n      entity.position.z = entity.drawable.mesh.position.z;\r\n\r\n      entity.velocity.x = entity.drawable.mesh.getLinearVelocity().x;\r\n      entity.velocity.y = entity.drawable.mesh.getLinearVelocity().y;\r\n      entity.velocity.z = entity.drawable.mesh.getLinearVelocity().z;\r\n    });\r\n  }\r\n});\r\n\r\n","MouseController = Class({\r\n  constructor: function() {\r\n    this.isDown = {\r\n      left: false,\r\n      right: false\r\n    };\r\n\r\n    this.wasPressed = {\r\n      left: false,\r\n      right: false\r\n    };\r\n  },\r\n\r\n  update: function(dt) {\r\n    this.wasPressed.left = false;\r\n    this.wasPressed.right = false;\r\n  }\r\n}, {\r\n  statics: {\r\n    get instance() {\r\n      if (!MouseController._instance) {\r\n        MouseController._instance = new MouseController();\r\n      }\r\n      return MouseController._instance;\r\n    }\r\n  }\r\n});\r\n\r\n","module.exports = function(THREE) {\n  'use strict';\n\n  var SUPPORT_TRANSFERABLE,\n    _is_simulating = false,\n    _Physijs = Physijs, // used for noConflict method\n    Physijs = {}, // object assigned to window.Physijs\n    Eventable, // class to provide simple event methods\n    getObjectId, // returns a unique ID for a Physijs mesh object\n    getEulerXYZFromQuaternion, getQuatertionFromEuler,\n    convertWorldPositionToObject, // Converts a world-space position to object-space\n    addObjectChildren,\n\n    _temp1, _temp2,\n    _temp_vector3_1 = new THREE.Vector3,\n    _temp_vector3_2 = new THREE.Vector3,\n    _temp_matrix4_1 = new THREE.Matrix4,\n    _quaternion_1 = new THREE.Quaternion,\n\n    // constants\n    MESSAGE_TYPES = {\n      WORLDREPORT: 0,\n      COLLISIONREPORT: 1,\n      VEHICLEREPORT: 2,\n      CONSTRAINTREPORT: 3\n    },\n    REPORT_ITEMSIZE = 14,\n    COLLISIONREPORT_ITEMSIZE = 5,\n    VEHICLEREPORT_ITEMSIZE = 9,\n    CONSTRAINTREPORT_ITEMSIZE = 6;\n\n  Physijs.scripts = {};\n\n  Eventable = function() {\n    this._eventListeners = {};\n  };\n  Eventable.prototype.addEventListener = function(event_name, callback) {\n    if (!this._eventListeners.hasOwnProperty(event_name)) {\n      this._eventListeners[event_name] = [];\n    }\n    this._eventListeners[event_name].push(callback);\n  };\n  Eventable.prototype.removeEventListener = function(event_name, callback) {\n    var index;\n\n    if (!this._eventListeners.hasOwnProperty(event_name)) return false;\n\n    if ((index = this._eventListeners[event_name].indexOf(callback)) >= 0) {\n      this._eventListeners[event_name].splice(index, 1);\n      return true;\n    }\n\n    return false;\n  };\n  Eventable.prototype.dispatchEvent = function(event_name) {\n    var i,\n      parameters = Array.prototype.splice.call(arguments, 1);\n\n    if (this._eventListeners.hasOwnProperty(event_name)) {\n      for (i = 0; i < this._eventListeners[event_name].length; i++) {\n        this._eventListeners[event_name][i].apply(this, parameters);\n      }\n    }\n  };\n  Eventable.make = function(obj) {\n    obj.prototype.addEventListener = Eventable.prototype.addEventListener;\n    obj.prototype.removeEventListener = Eventable.prototype.removeEventListener;\n    obj.prototype.dispatchEvent = Eventable.prototype.dispatchEvent;\n  };\n\n  getObjectId = (function() {\n    var _id = 1;\n    return function() {\n      return _id++;\n    };\n  })();\n\n  getEulerXYZFromQuaternion = function(x, y, z, w) {\n    return new THREE.Vector3(\n      Math.atan2(2 * (x * w - y * z), (w * w - x * x - y * y + z * z)),\n      Math.asin(2 * (x * z + y * w)),\n      Math.atan2(2 * (z * w - x * y), (w * w + x * x - y * y - z * z))\n    );\n  };\n\n  getQuatertionFromEuler = function(x, y, z) {\n    var c1, s1, c2, s2, c3, s3, c1c2, s1s2;\n    c1 = Math.cos(y);\n    s1 = Math.sin(y);\n    c2 = Math.cos(-z);\n    s2 = Math.sin(-z);\n    c3 = Math.cos(x);\n    s3 = Math.sin(x);\n\n    c1c2 = c1 * c2;\n    s1s2 = s1 * s2;\n\n    return {\n      w: c1c2 * c3 - s1s2 * s3,\n      x: c1c2 * s3 + s1s2 * c3,\n      y: s1 * c2 * c3 + c1 * s2 * s3,\n      z: c1 * s2 * c3 - s1 * c2 * s3\n    };\n  };\n\n  convertWorldPositionToObject = function(position, object) {\n    _temp_matrix4_1.identity(); // reset temp matrix\n\n    // Set the temp matrix's rotation to the object's rotation\n    _temp_matrix4_1.identity().makeRotationFromQuaternion(object.quaternion);\n\n    // Invert rotation matrix in order to \"unrotate\" a point back to object space\n    _temp_matrix4_1.getInverse(_temp_matrix4_1);\n\n    // Yay! Temp vars!\n    _temp_vector3_1.copy(position);\n    _temp_vector3_2.copy(object.position);\n\n    // Apply the rotation\n\n    return _temp_vector3_1.sub(_temp_vector3_2).applyMatrix4(_temp_matrix4_1);\n  };\n\n\n\n  // Physijs.noConflict\n  Physijs.noConflict = function() {\n    window.Physijs = _Physijs;\n    return Physijs;\n  };\n\n\n  // Physijs.createMaterial\n  Physijs.createMaterial = function(material, friction, restitution) {\n    var physijs_material = function() {};\n    physijs_material.prototype = material;\n    physijs_material = new physijs_material;\n\n    physijs_material._physijs = {\n      id: material.id,\n      friction: friction === undefined ? .8 : friction,\n      restitution: restitution === undefined ? .2 : restitution\n    };\n\n    return physijs_material;\n  };\n\n\n  // Constraints\n  Physijs.PointConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'point';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.PointConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb\n    };\n  };\n\n  Physijs.HingeConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'hinge';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.position = position.clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.HingeConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  /*\n   * low = minimum angle in radians\n   * high = maximum angle in radians\n   * bias_factor = applied as a factor to constraint error\n   * relaxation_factor = controls bounce (0.0 == no bounce)\n   */\n  Physijs.HingeConstraint.prototype.setLimits = function(low, high, bias_factor, relaxation_factor) {\n    this.scene.execute('hinge_setLimits', {\n      constraint: this.id,\n      low: low,\n      high: high,\n      bias_factor: bias_factor,\n      relaxation_factor: relaxation_factor\n    });\n  };\n  Physijs.HingeConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.HingeConstraint.prototype.disableMotor = function(velocity, acceleration) {\n    this.scene.execute('hinge_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.SliderConstraint = function(objecta, objectb, position, axis) {\n    if (axis === undefined) {\n      axis = position;\n      position = objectb;\n      objectb = undefined;\n    }\n\n    this.type = 'slider';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axis = axis;\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    }\n  };\n  Physijs.SliderConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axis: this.axis\n    };\n  };\n  Physijs.SliderConstraint.prototype.setLimits = function(lin_lower, lin_upper, ang_lower, ang_upper) {\n    this.scene.execute('slider_setLimits', {\n      constraint: this.id,\n      lin_lower: lin_lower,\n      lin_upper: lin_upper,\n      ang_lower: ang_lower,\n      ang_upper: ang_upper\n    });\n  };\n  Physijs.SliderConstraint.prototype.setRestitution = function(linear, angular) {\n    this.scene.execute(\n      'slider_setRestitution', {\n        constraint: this.id,\n        linear: linear,\n        angular: angular\n      }\n    );\n  };\n  Physijs.SliderConstraint.prototype.enableLinearMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableLinearMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableLinearMotor = function() {\n    this.scene.execute('slider_disableLinearMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.SliderConstraint.prototype.enableAngularMotor = function(velocity, acceleration) {\n    this.scene.execute('slider_enableAngularMotor', {\n      constraint: this.id,\n      velocity: velocity,\n      acceleration: acceleration\n    });\n  };\n  Physijs.SliderConstraint.prototype.disableAngularMotor = function() {\n    this.scene.execute('slider_disableAngularMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.ConeTwistConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      throw 'Both objects must be defined in a ConeTwistConstraint.';\n    }\n    this.type = 'conetwist';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.objectb = objectb._physijs.id;\n    this.positionb = convertWorldPositionToObject(position, objectb).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n    this.axisb = {\n      x: objectb.rotation.x,\n      y: objectb.rotation.y,\n      z: objectb.rotation.z\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.ConeTwistConstraint.prototype.setLimit = function(x, y, z) {\n    this.scene.execute('conetwist_setLimit', {\n      constraint: this.id,\n      x: x,\n      y: y,\n      z: z\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.enableMotor = function() {\n    this.scene.execute('conetwist_enableMotor', {\n      constraint: this.id\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMaxMotorImpulse = function(max_impulse) {\n    this.scene.execute('conetwist_setMaxMotorImpulse', {\n      constraint: this.id,\n      max_impulse: max_impulse\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.setMotorTarget = function(target) {\n    if (target instanceof THREE.Vector3) {\n      target = new THREE.Quaternion().setFromEuler(new THREE.Euler(target.x, target.y, target.z));\n    }\n    else if (target instanceof THREE.Euler) {\n      target = new THREE.Quaternion().setFromEuler(target);\n    }\n    else if (target instanceof THREE.Matrix4) {\n      target = new THREE.Quaternion().setFromRotationMatrix(target);\n    }\n    this.scene.execute('conetwist_setMotorTarget', {\n      constraint: this.id,\n      x: target.x,\n      y: target.y,\n      z: target.z,\n      w: target.w\n    });\n  };\n  Physijs.ConeTwistConstraint.prototype.disableMotor = function() {\n    this.scene.execute('conetwist_disableMotor', {\n      constraint: this.id\n    });\n  };\n\n  Physijs.DOFConstraint = function(objecta, objectb, position) {\n    if (position === undefined) {\n      position = objectb;\n      objectb = undefined;\n    }\n    this.type = 'dof';\n    this.appliedImpulse = 0;\n    this.id = getObjectId();\n    this.scene = objecta.parent;\n    this.objecta = objecta._physijs.id;\n    this.positiona = convertWorldPositionToObject(position, objecta).clone();\n    this.axisa = {\n      x: objecta.rotation.x,\n      y: objecta.rotation.y,\n      z: objecta.rotation.z\n    };\n\n    if (objectb) {\n      this.objectb = objectb._physijs.id;\n      this.positionb = convertWorldPositionToObject(position, objectb).clone();\n      this.axisb = {\n        x: objectb.rotation.x,\n        y: objectb.rotation.y,\n        z: objectb.rotation.z\n      };\n    }\n  };\n  Physijs.DOFConstraint.prototype.getDefinition = function() {\n    return {\n      type: this.type,\n      id: this.id,\n      objecta: this.objecta,\n      objectb: this.objectb,\n      positiona: this.positiona,\n      positionb: this.positionb,\n      axisa: this.axisa,\n      axisb: this.axisb\n    };\n  };\n  Physijs.DOFConstraint.prototype.setLinearLowerLimit = function(limit) {\n    this.scene.execute('dof_setLinearLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setLinearUpperLimit = function(limit) {\n    this.scene.execute('dof_setLinearUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularLowerLimit = function(limit) {\n    this.scene.execute('dof_setAngularLowerLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.setAngularUpperLimit = function(limit) {\n    this.scene.execute('dof_setAngularUpperLimit', {\n      constraint: this.id,\n      x: limit.x,\n      y: limit.y,\n      z: limit.z\n    });\n  };\n  Physijs.DOFConstraint.prototype.enableAngularMotor = function(which) {\n    this.scene.execute('dof_enableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n  Physijs.DOFConstraint.prototype.configureAngularMotor = function(which, low_angle, high_angle, velocity, max_force) {\n    this.scene.execute('dof_configureAngularMotor', {\n      constraint: this.id,\n      which: which,\n      low_angle: low_angle,\n      high_angle: high_angle,\n      velocity: velocity,\n      max_force: max_force\n    });\n  };\n  Physijs.DOFConstraint.prototype.disableAngularMotor = function(which) {\n    this.scene.execute('dof_disableAngularMotor', {\n      constraint: this.id,\n      which: which\n    });\n  };\n\n  // Physijs.Scene\n  Physijs.Scene = function(params) {\n    var self = this;\n\n    Eventable.call(this);\n    THREE.Scene.call(this);\n\n    this._worker = new Worker(Physijs.scripts.worker || 'physijsWorker.js');\n    this._worker.transferableMessage = this._worker.webkitPostMessage || this._worker.postMessage;\n    this._materials_ref_counts = {};\n    this._objects = {};\n    this._vehicles = {};\n    this._constraints = {};\n\n    var ab = new ArrayBuffer(1);\n    this._worker.transferableMessage(ab, [ab]);\n    SUPPORT_TRANSFERABLE = (ab.byteLength === 0);\n\n    this._worker.onerror = function(event) {\n      console.log(event.message);\n      console.log(event.filename);\n      console.log(event.lineno);\n    };\n\n    this._worker.onmessage = function(event) {\n      var _temp,\n        data = event.data;\n\n      if (data instanceof ArrayBuffer && data.byteLength !== 1) { // byteLength === 1 is the worker making a SUPPORT_TRANSFERABLE test\n        data = new Float32Array(data);\n      }\n\n      if (data instanceof Float32Array) {\n\n        // transferable object\n        switch (data[0]) {\n          case MESSAGE_TYPES.WORLDREPORT:\n            self._updateScene(data);\n            break;\n\n          case MESSAGE_TYPES.COLLISIONREPORT:\n            self._updateCollisions(data);\n            break;\n\n          case MESSAGE_TYPES.VEHICLEREPORT:\n            self._updateVehicles(data);\n            break;\n\n          case MESSAGE_TYPES.CONSTRAINTREPORT:\n            self._updateConstraints(data);\n            break;\n        }\n\n      }\n      else {\n\n        if (data.cmd) {\n\n          // non-transferable object\n          switch (data.cmd) {\n            case 'objectReady':\n              _temp = data.params;\n              if (self._objects[_temp]) {\n                self._objects[_temp].dispatchEvent('ready');\n              }\n              break;\n\n            case 'worldReady':\n              self.dispatchEvent('ready');\n              break;\n\n            case 'vehicle':\n              window.test = data;\n              break;\n\n            default:\n              // Do nothing, just show the message\n              console.debug('Received: ' + data.cmd);\n              console.dir(data.params);\n              break;\n          }\n\n        }\n        else {\n\n          switch (data[0]) {\n            case MESSAGE_TYPES.WORLDREPORT:\n              self._updateScene(data);\n              break;\n\n            case MESSAGE_TYPES.COLLISIONREPORT:\n              self._updateCollisions(data);\n              break;\n\n            case MESSAGE_TYPES.VEHICLEREPORT:\n              self._updateVehicles(data);\n              break;\n\n            case MESSAGE_TYPES.CONSTRAINTREPORT:\n              self._updateConstraints(data);\n              break;\n          }\n\n        }\n\n      }\n    };\n\n\n    params = params || {};\n    params.ammo = Physijs.scripts.ammo || 'ammo.js';\n    params.fixedTimeStep = params.fixedTimeStep || 1 / 60;\n    params.rateLimit = params.rateLimit || true;\n    this.execute('init', params);\n  };\n  Physijs.Scene.prototype = new THREE.Scene;\n  Physijs.Scene.prototype.constructor = Physijs.Scene;\n  Eventable.make(Physijs.Scene);\n\n  Physijs.Scene.prototype._updateScene = function(data) {\n    var num_objects = data[1],\n      object,\n      i, offset;\n\n    for (i = 0; i < num_objects; i++) {\n      offset = 2 + i * REPORT_ITEMSIZE;\n      object = this._objects[data[offset]];\n\n      if (object === undefined) {\n        continue;\n      }\n\n      if (object.__dirtyPosition === false) {\n        object.position.set(\n          data[offset + 1],\n          data[offset + 2],\n          data[offset + 3]\n        );\n      }\n\n      if (object.__dirtyRotation === false) {\n        object.quaternion.set(\n          data[offset + 4],\n          data[offset + 5],\n          data[offset + 6],\n          data[offset + 7]\n        );\n      }\n\n      object._physijs.linearVelocity.set(\n        data[offset + 8],\n        data[offset + 9],\n        data[offset + 10]\n      );\n\n      object._physijs.angularVelocity.set(\n        data[offset + 11],\n        data[offset + 12],\n        data[offset + 13]\n      );\n\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n\n    _is_simulating = false;\n    this.dispatchEvent('update');\n  };\n\n  Physijs.Scene.prototype._updateVehicles = function(data) {\n    var vehicle, wheel,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / VEHICLEREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * VEHICLEREPORT_ITEMSIZE;\n      vehicle = this._vehicles[data[offset]];\n\n      if (vehicle === undefined) {\n        continue;\n      }\n\n      wheel = vehicle.wheels[data[offset + 1]];\n\n      wheel.position.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n\n      wheel.quaternion.set(\n        data[offset + 5],\n        data[offset + 6],\n        data[offset + 7],\n        data[offset + 8]\n      );\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateConstraints = function(data) {\n    var constraint, object,\n      i, offset;\n\n    for (i = 0; i < (data.length - 1) / CONSTRAINTREPORT_ITEMSIZE; i++) {\n      offset = 1 + i * CONSTRAINTREPORT_ITEMSIZE;\n      constraint = this._constraints[data[offset]];\n      object = this._objects[data[offset + 1]];\n\n      if (constraint === undefined || object === undefined) {\n        continue;\n      }\n\n      _temp_vector3_1.set(\n        data[offset + 2],\n        data[offset + 3],\n        data[offset + 4]\n      );\n      _temp_matrix4_1.extractRotation(object.matrix);\n      _temp_vector3_1.applyMatrix4(_temp_matrix4_1);\n\n      constraint.positiona.addVectors(object.position, _temp_vector3_1);\n      constraint.appliedImpulse = data[offset + 5];\n    }\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype._updateCollisions = function(data) {\n    /**\n     * #TODO\n     * This is probably the worst way ever to handle collisions. The inherent evilness is a residual\n     * effect from the previous version's evilness which mutated when switching to transferable objects.\n     *\n     * If you feel inclined to make this better, please do so.\n     */\n\n    var i, j, offset, object, object2, id1, id2,\n      collisions = {},\n      normal_offsets = {};\n\n    // Build collision manifest\n    for (i = 0; i < data[1]; i++) {\n      offset = 2 + i * COLLISIONREPORT_ITEMSIZE;\n      object = data[offset];\n      object2 = data[offset + 1];\n\n      normal_offsets[object + '-' + object2] = offset + 2;\n      normal_offsets[object2 + '-' + object] = -1 * (offset + 2);\n\n      // Register collisions for both the object colliding and the object being collided with\n      if (!collisions[object]) collisions[object] = [];\n      collisions[object].push(object2);\n\n      if (!collisions[object2]) collisions[object2] = [];\n      collisions[object2].push(object);\n    }\n\n    // Deal with collisions\n    for (id1 in this._objects) {\n      if (!this._objects.hasOwnProperty(id1)) continue;\n      object = this._objects[id1];\n\n      // If object touches anything, ...\n      if (collisions[id1]) {\n\n        // Clean up touches array\n        for (j = 0; j < object._physijs.touches.length; j++) {\n          if (collisions[id1].indexOf(object._physijs.touches[j]) === -1) {\n            object._physijs.touches.splice(j--, 1);\n          }\n        }\n\n        // Handle each colliding object\n        for (j = 0; j < collisions[id1].length; j++) {\n          id2 = collisions[id1][j];\n          object2 = this._objects[id2];\n\n          if (object2) {\n            // If object was not already touching object2, notify object\n            if (object._physijs.touches.indexOf(id2) === -1) {\n              object._physijs.touches.push(id2);\n\n              _temp_vector3_1.subVectors(object.getLinearVelocity(), object2.getLinearVelocity());\n              _temp1 = _temp_vector3_1.clone();\n\n              _temp_vector3_1.subVectors(object.getAngularVelocity(), object2.getAngularVelocity());\n              _temp2 = _temp_vector3_1.clone();\n\n              var normal_offset = normal_offsets[object._physijs.id + '-' + object2._physijs.id];\n              if (normal_offset > 0) {\n                _temp_vector3_1.set(-data[normal_offset], -data[normal_offset + 1], -data[normal_offset + 2]);\n              }\n              else {\n                normal_offset *= -1;\n                _temp_vector3_1.set(\n                  data[normal_offset],\n                  data[normal_offset + 1],\n                  data[normal_offset + 2]\n                );\n              }\n\n              object.dispatchEvent('collision', object2, _temp1, _temp2, _temp_vector3_1);\n            }\n          }\n        }\n\n      }\n      else {\n\n        // not touching other objects\n        object._physijs.touches.length = 0;\n\n      }\n\n    }\n\n    this.collisions = collisions;\n\n    if (SUPPORT_TRANSFERABLE) {\n      // Give the typed array back to the worker\n      this._worker.transferableMessage(data.buffer, [data.buffer]);\n    }\n  };\n\n  Physijs.Scene.prototype.addConstraint = function(constraint, show_marker) {\n    this._constraints[constraint.id] = constraint;\n    this.execute('addConstraint', constraint.getDefinition());\n\n    if (show_marker) {\n      var marker;\n\n      switch (constraint.type) {\n        case 'point':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'hinge':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'slider':\n          marker = new THREE.Mesh(\n            new THREE.BoxGeometry(10, 1, 1),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          // This rotation isn't right if all three axis are non-0 values\n          // TODO: change marker's rotation order to ZYX\n          marker.rotation.set(\n            constraint.axis.y, // yes, y and\n            constraint.axis.x, // x axis are swapped\n            constraint.axis.z\n          );\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'conetwist':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n\n        case 'dof':\n          marker = new THREE.Mesh(\n            new THREE.SphereGeometry(1.5),\n            new THREE.MeshNormalMaterial\n          );\n          marker.position.copy(constraint.positiona);\n          this._objects[constraint.objecta].add(marker);\n          break;\n      }\n    }\n\n    return constraint;\n  };\n\n  Physijs.Scene.prototype.onSimulationResume = function() {\n    this.execute('onSimulationResume', {});\n  };\n\n  Physijs.Scene.prototype.removeConstraint = function(constraint) {\n    if (this._constraints[constraint.id] !== undefined) {\n      this.execute('removeConstraint', {\n        id: constraint.id\n      });\n      delete this._constraints[constraint.id];\n    }\n  };\n\n  Physijs.Scene.prototype.execute = function(cmd, params) {\n    this._worker.postMessage({\n      cmd: cmd,\n      params: params\n    });\n  };\n\n  addObjectChildren = function(parent, object) {\n    var i;\n\n    for (i = 0; i < object.children.length; i++) {\n      if (object.children[i]._physijs) {\n        object.children[i].updateMatrix();\n        object.children[i].updateMatrixWorld();\n\n        _temp_vector3_1.setFromMatrixPosition(object.children[i].matrixWorld);\n        _quaternion_1.setFromRotationMatrix(object.children[i].matrixWorld);\n\n        object.children[i]._physijs.position_offset = {\n          x: _temp_vector3_1.x,\n          y: _temp_vector3_1.y,\n          z: _temp_vector3_1.z\n        };\n\n        object.children[i]._physijs.rotation = {\n          x: _quaternion_1.x,\n          y: _quaternion_1.y,\n          z: _quaternion_1.z,\n          w: _quaternion_1.w\n        };\n\n        parent._physijs.children.push(object.children[i]._physijs);\n      }\n\n      addObjectChildren(parent, object.children[i]);\n    }\n  };\n\n  Physijs.Scene.prototype.add = function(object) {\n    THREE.Mesh.prototype.add.call(this, object);\n\n    if (object._physijs) {\n\n      object.world = this;\n\n      if (object instanceof Physijs.Vehicle) {\n\n        this.add(object.mesh);\n        this._vehicles[object._physijs.id] = object;\n        this.execute('addVehicle', object._physijs);\n\n      }\n      else {\n\n        object.__dirtyPosition = false;\n        object.__dirtyRotation = false;\n        this._objects[object._physijs.id] = object;\n\n        if (object.children.length) {\n          object._physijs.children = [];\n          addObjectChildren(object, object);\n        }\n\n        if (object.material._physijs) {\n          if (!this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n            this.execute('registerMaterial', object.material._physijs);\n            object._physijs.materialId = object.material._physijs.id;\n            this._materials_ref_counts[object.material._physijs.id] = 1;\n          }\n          else {\n            this._materials_ref_counts[object.material._physijs.id]++;\n          }\n        }\n\n        // Object starting position + rotation\n        object._physijs.position = {\n          x: object.position.x,\n          y: object.position.y,\n          z: object.position.z\n        };\n        object._physijs.rotation = {\n          x: object.quaternion.x,\n          y: object.quaternion.y,\n          z: object.quaternion.z,\n          w: object.quaternion.w\n        };\n\n        // Check for scaling\n        var mass_scaling = new THREE.Vector3(1, 1, 1);\n        if (object._physijs.width) {\n          object._physijs.width *= object.scale.x;\n        }\n        if (object._physijs.height) {\n          object._physijs.height *= object.scale.y;\n        }\n        if (object._physijs.depth) {\n          object._physijs.depth *= object.scale.z;\n        }\n\n        this.execute('addObject', object._physijs);\n\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.remove = function(object) {\n    if (object instanceof Physijs.Vehicle) {\n      this.execute('removeVehicle', {\n        id: object._physijs.id\n      });\n      while (object.wheels.length) {\n        this.remove(object.wheels.pop());\n      }\n      this.remove(object.mesh);\n      delete this._vehicles[object._physijs.id];\n    }\n    else {\n      THREE.Mesh.prototype.remove.call(this, object);\n      if (object._physijs) {\n        delete this._objects[object._physijs.id];\n        this.execute('removeObject', {\n          id: object._physijs.id\n        });\n      }\n    }\n    if (object.material && object.material._physijs && this._materials_ref_counts.hasOwnProperty(object.material._physijs.id)) {\n      this._materials_ref_counts[object.material._physijs.id]--;\n      if (this._materials_ref_counts[object.material._physijs.id] == 0) {\n        this.execute('unRegisterMaterial', object.material._physijs);\n        delete this._materials_ref_counts[object.material._physijs.id];\n      }\n    }\n  };\n\n  Physijs.Scene.prototype.setFixedTimeStep = function(fixedTimeStep) {\n    if (fixedTimeStep) {\n      this.execute('setFixedTimeStep', fixedTimeStep);\n    }\n  };\n\n  Physijs.Scene.prototype.setGravity = function(gravity) {\n    if (gravity) {\n      this.execute('setGravity', gravity);\n    }\n  };\n\n  Physijs.Scene.prototype.simulate = function(timeStep, maxSubSteps) {\n    var object_id, object, update;\n\n    if (_is_simulating) {\n      return false;\n    }\n\n    _is_simulating = true;\n\n    for (object_id in this._objects) {\n      if (!this._objects.hasOwnProperty(object_id)) continue;\n\n      object = this._objects[object_id];\n\n      if (object.__dirtyPosition || object.__dirtyRotation) {\n        update = {\n          id: object._physijs.id\n        };\n\n        if (object.__dirtyPosition) {\n          update.pos = {\n            x: object.position.x,\n            y: object.position.y,\n            z: object.position.z\n          };\n          object.__dirtyPosition = false;\n        }\n\n        if (object.__dirtyRotation) {\n          update.quat = {\n            x: object.quaternion.x,\n            y: object.quaternion.y,\n            z: object.quaternion.z,\n            w: object.quaternion.w\n          };\n          object.__dirtyRotation = false;\n        }\n\n        this.execute('updateTransform', update);\n      }\n    }\n\n    this.execute('simulate', {\n      timeStep: timeStep,\n      maxSubSteps: maxSubSteps\n    });\n\n    return true;\n  };\n\n\n  // Phsijs.Mesh\n  Physijs.Mesh = function(geometry, material, mass) {\n    var index;\n\n    if (!geometry) {\n      return;\n    }\n\n    Eventable.call(this);\n    THREE.Mesh.call(this, geometry, material);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    this._physijs = {\n      type: null,\n      id: getObjectId(),\n      mass: mass || 0,\n      touches: [],\n      linearVelocity: new THREE.Vector3,\n      angularVelocity: new THREE.Vector3\n    };\n  };\n  Physijs.Mesh.prototype = new THREE.Mesh;\n  Physijs.Mesh.prototype.constructor = Physijs.Mesh;\n  Eventable.make(Physijs.Mesh);\n\n  // Physijs.Mesh.mass\n  Physijs.Mesh.prototype.__defineGetter__('mass', function() {\n    return this._physijs.mass;\n  });\n  Physijs.Mesh.prototype.__defineSetter__('mass', function(mass) {\n    this._physijs.mass = mass;\n    if (this.world) {\n      this.world.execute('updateMass', {\n        id: this._physijs.id,\n        mass: mass\n      });\n    }\n  });\n\n  // Physijs.Mesh.applyCentralImpulse\n  Physijs.Mesh.prototype.applyCentralImpulse = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralImpulse', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyImpulse\n  Physijs.Mesh.prototype.applyImpulse = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyImpulse', {\n        id: this._physijs.id,\n        impulse_x: force.x,\n        impulse_y: force.y,\n        impulse_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyTorque\n  Physijs.Mesh.prototype.applyTorque = function(force) {\n    if (this.world) {\n      this.world.execute('applyTorque', {\n        id: this._physijs.id,\n        torque_x: force.x,\n        torque_y: force.y,\n        torque_z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyCentralForce\n  Physijs.Mesh.prototype.applyCentralForce = function(force) {\n    if (this.world) {\n      this.world.execute('applyCentralForce', {\n        id: this._physijs.id,\n        x: force.x,\n        y: force.y,\n        z: force.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.applyForce\n  Physijs.Mesh.prototype.applyForce = function(force, offset) {\n    if (this.world) {\n      this.world.execute('applyForce', {\n        id: this._physijs.id,\n        force_x: force.x,\n        force_y: force.y,\n        force_z: force.z,\n        x: offset.x,\n        y: offset.y,\n        z: offset.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getAngularVelocity\n  Physijs.Mesh.prototype.getAngularVelocity = function() {\n    return this._physijs.angularVelocity;\n  };\n\n  // Physijs.Mesh.setAngularVelocity\n  Physijs.Mesh.prototype.setAngularVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setAngularVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.getLinearVelocity\n  Physijs.Mesh.prototype.getLinearVelocity = function() {\n    return this._physijs.linearVelocity;\n  };\n\n  // Physijs.Mesh.setLinearVelocity\n  Physijs.Mesh.prototype.setLinearVelocity = function(velocity) {\n    if (this.world) {\n      this.world.execute('setLinearVelocity', {\n        id: this._physijs.id,\n        x: velocity.x,\n        y: velocity.y,\n        z: velocity.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setAngularFactor\n  Physijs.Mesh.prototype.setAngularFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setAngularFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setLinearFactor\n  Physijs.Mesh.prototype.setLinearFactor = function(factor) {\n    if (this.world) {\n      this.world.execute('setLinearFactor', {\n        id: this._physijs.id,\n        x: factor.x,\n        y: factor.y,\n        z: factor.z\n      });\n    }\n  };\n\n  // Physijs.Mesh.setDamping\n  Physijs.Mesh.prototype.setDamping = function(linear, angular) {\n    if (this.world) {\n      this.world.execute('setDamping', {\n        id: this._physijs.id,\n        linear: linear,\n        angular: angular\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdMotionThreshold\n  Physijs.Mesh.prototype.setCcdMotionThreshold = function(threshold) {\n    if (this.world) {\n      this.world.execute('setCcdMotionThreshold', {\n        id: this._physijs.id,\n        threshold: threshold\n      });\n    }\n  };\n\n  // Physijs.Mesh.setCcdSweptSphereRadius\n  Physijs.Mesh.prototype.setCcdSweptSphereRadius = function(radius) {\n    if (this.world) {\n      this.world.execute('setCcdSweptSphereRadius', {\n        id: this._physijs.id,\n        radius: radius\n      });\n    }\n  };\n\n\n  // Physijs.PlaneMesh\n  Physijs.PlaneMesh = function(geometry, material, mass) {\n    var width, height;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'plane';\n    this._physijs.normal = geometry.faces[0].normal.clone();\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.PlaneMesh.prototype = new Physijs.Mesh;\n  Physijs.PlaneMesh.prototype.constructor = Physijs.PlaneMesh;\n\n  // Physijs.HeightfieldMesh\n  Physijs.HeightfieldMesh = function(geometry, material, mass, xdiv, ydiv) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    this._physijs.type = 'heightfield';\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\n\n    var points = [];\n\n    var a, b;\n    for (var i = 0; i < geometry.vertices.length; i++) {\n\n      a = i % this._physijs.xpts;\n      b = Math.round((i / this._physijs.xpts) - ((i % this._physijs.xpts) / this._physijs.xpts));\n      points[i] = geometry.vertices[a + ((this._physijs.ypts - b - 1) * this._physijs.ypts)].z;\n\n      //points[i] = geometry.vertices[i];\n    }\n\n    this._physijs.points = points;\n  };\n  Physijs.HeightfieldMesh.prototype = new Physijs.Mesh;\n  Physijs.HeightfieldMesh.prototype.constructor = Physijs.HeightfieldMesh;\n\n  // Physijs.BoxMesh\n  Physijs.BoxMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'box';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.BoxMesh.prototype = new Physijs.Mesh;\n  Physijs.BoxMesh.prototype.constructor = Physijs.BoxMesh;\n\n\n  // Physijs.SphereMesh\n  Physijs.SphereMesh = function(geometry, material, mass) {\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingSphere) {\n      geometry.computeBoundingSphere();\n    }\n\n    this._physijs.type = 'sphere';\n    this._physijs.radius = geometry.boundingSphere.radius;\n    this._physijs.mass = (typeof mass === 'undefined') ? (4 / 3) * Math.PI * Math.pow(this._physijs.radius, 3) : mass;\n  };\n  Physijs.SphereMesh.prototype = new Physijs.Mesh;\n  Physijs.SphereMesh.prototype.constructor = Physijs.SphereMesh;\n\n\n  // Physijs.CylinderMesh\n  Physijs.CylinderMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'cylinder';\n    this._physijs.width = width;\n    this._physijs.height = height;\n    this._physijs.depth = depth;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CylinderMesh.prototype = new Physijs.Mesh;\n  Physijs.CylinderMesh.prototype.constructor = Physijs.CylinderMesh;\n\n\n  // Physijs.CapsuleMesh\n  Physijs.CapsuleMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'capsule';\n    this._physijs.radius = Math.max(width / 2, depth / 2);\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.CapsuleMesh.prototype = new Physijs.Mesh;\n  Physijs.CapsuleMesh.prototype.constructor = Physijs.CapsuleMesh;\n\n\n  // Physijs.ConeMesh\n  Physijs.ConeMesh = function(geometry, material, mass) {\n    var width, height, depth;\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n\n    this._physijs.type = 'cone';\n    this._physijs.radius = width / 2;\n    this._physijs.height = height;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height : mass;\n  };\n  Physijs.ConeMesh.prototype = new Physijs.Mesh;\n  Physijs.ConeMesh.prototype.constructor = Physijs.ConeMesh;\n\n\n  // Physijs.ConcaveMesh\n  Physijs.ConcaveMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      vertices, face, triangles = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    vertices = geometry.vertices;\n\n    for (i = 0; i < geometry.faces.length; i++) {\n      face = geometry.faces[i];\n      if (face instanceof THREE.Face3) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }]);\n\n      }\n      else if (face instanceof THREE.Face4) {\n\n        triangles.push([{\n          x: vertices[face.a].x,\n          y: vertices[face.a].y,\n          z: vertices[face.a].z\n        }, {\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n        triangles.push([{\n          x: vertices[face.b].x,\n          y: vertices[face.b].y,\n          z: vertices[face.b].z\n        }, {\n          x: vertices[face.c].x,\n          y: vertices[face.c].y,\n          z: vertices[face.c].z\n        }, {\n          x: vertices[face.d].x,\n          y: vertices[face.d].y,\n          z: vertices[face.d].z\n        }]);\n\n      }\n    }\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'concave';\n    this._physijs.triangles = triangles;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConcaveMesh.prototype = new Physijs.Mesh;\n  Physijs.ConcaveMesh.prototype.constructor = Physijs.ConcaveMesh;\n\n\n  // Physijs.ConvexMesh\n  Physijs.ConvexMesh = function(geometry, material, mass) {\n    var i,\n      width, height, depth,\n      points = [];\n\n    Physijs.Mesh.call(this, geometry, material, mass);\n\n    if (!geometry.boundingBox) {\n      geometry.computeBoundingBox();\n    }\n\n    for (i = 0; i < geometry.vertices.length; i++) {\n      points.push({\n        x: geometry.vertices[i].x,\n        y: geometry.vertices[i].y,\n        z: geometry.vertices[i].z\n      });\n    }\n\n\n    width = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    height = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    depth = geometry.boundingBox.max.z - geometry.boundingBox.min.z;\n\n    this._physijs.type = 'convex';\n    this._physijs.points = points;\n    this._physijs.mass = (typeof mass === 'undefined') ? width * height * depth : mass;\n  };\n  Physijs.ConvexMesh.prototype = new Physijs.Mesh;\n  Physijs.ConvexMesh.prototype.constructor = Physijs.ConvexMesh;\n\n\n  // Physijs.Vehicle\n  Physijs.Vehicle = function(mesh, tuning) {\n    tuning = tuning || new Physijs.VehicleTuning;\n    this.mesh = mesh;\n    this.wheels = [];\n    this._physijs = {\n      id: getObjectId(),\n      rigidBody: mesh._physijs.id,\n      suspension_stiffness: tuning.suspension_stiffness,\n      suspension_compression: tuning.suspension_compression,\n      suspension_damping: tuning.suspension_damping,\n      max_suspension_travel: tuning.max_suspension_travel,\n      friction_slip: tuning.friction_slip,\n      max_suspension_force: tuning.max_suspension_force\n    };\n  };\n  Physijs.Vehicle.prototype.addWheel = function(wheel_geometry, wheel_material, connection_point, wheel_direction, wheel_axle, suspension_rest_length, wheel_radius, is_front_wheel, tuning) {\n    var wheel = new THREE.Mesh(wheel_geometry, wheel_material);\n    wheel.castShadow = wheel.receiveShadow = true;\n    wheel.position.copy(wheel_direction).multiplyScalar(suspension_rest_length / 100).add(connection_point);\n    this.world.add(wheel);\n    this.wheels.push(wheel);\n\n    this.world.execute('addWheel', {\n      id: this._physijs.id,\n      connection_point: {\n        x: connection_point.x,\n        y: connection_point.y,\n        z: connection_point.z\n      },\n      wheel_direction: {\n        x: wheel_direction.x,\n        y: wheel_direction.y,\n        z: wheel_direction.z\n      },\n      wheel_axle: {\n        x: wheel_axle.x,\n        y: wheel_axle.y,\n        z: wheel_axle.z\n      },\n      suspension_rest_length: suspension_rest_length,\n      wheel_radius: wheel_radius,\n      is_front_wheel: is_front_wheel,\n      tuning: tuning\n    });\n  };\n  Physijs.Vehicle.prototype.setSteering = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setSteering', {\n        id: this._physijs.id,\n        wheel: wheel,\n        steering: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setSteering', {\n          id: this._physijs.id,\n          wheel: i,\n          steering: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.setBrake = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('setBrake', {\n        id: this._physijs.id,\n        wheel: wheel,\n        brake: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('setBrake', {\n          id: this._physijs.id,\n          wheel: i,\n          brake: amount\n        });\n      }\n    }\n  };\n  Physijs.Vehicle.prototype.applyEngineForce = function(amount, wheel) {\n    if (wheel !== undefined && this.wheels[wheel] !== undefined) {\n      this.world.execute('applyEngineForce', {\n        id: this._physijs.id,\n        wheel: wheel,\n        force: amount\n      });\n    }\n    else if (this.wheels.length > 0) {\n      for (var i = 0; i < this.wheels.length; i++) {\n        this.world.execute('applyEngineForce', {\n          id: this._physijs.id,\n          wheel: i,\n          force: amount\n        });\n      }\n    }\n  };\n\n  // Physijs.VehicleTuning\n  Physijs.VehicleTuning = function(suspension_stiffness, suspension_compression, suspension_damping, max_suspension_travel, friction_slip, max_suspension_force) {\n    this.suspension_stiffness = suspension_stiffness !== undefined ? suspension_stiffness : 5.88;\n    this.suspension_compression = suspension_compression !== undefined ? suspension_compression : 0.83;\n    this.suspension_damping = suspension_damping !== undefined ? suspension_damping : 0.88;\n    this.max_suspension_travel = max_suspension_travel !== undefined ? max_suspension_travel : 500;\n    this.friction_slip = friction_slip !== undefined ? friction_slip : 10.5;\n    this.max_suspension_force = max_suspension_force !== undefined ? max_suspension_force : 6000;\n  };\n\n  return Physijs;\n}\n\n","/** @preserve http://github.com/easeway/js-class */\n\n// Class Definition using ECMA5 prototype chain\n\nfunction inherit(dest, src, noParent) {\n    while (src && src !== Object.prototype) {\n        Object.getOwnPropertyNames(src).forEach(function (name) {\n            if (name != '.class' && !dest.hasOwnProperty(name)) {\n                var desc = Object.getOwnPropertyDescriptor(src, name);\n                Object.defineProperty(dest, name, desc);\n            }\n        });\n        if (noParent) {\n            break;\n        }\n        src = src.__proto__;\n    }\n    return dest;\n}\n\nvar Class = function (base, proto, options) {\n    if (typeof(base) != 'function') {\n        options = proto;\n        proto = base;\n        base = Object;\n    }\n    if (!proto) {\n        proto = {};\n    }\n    if (!options) {\n        options = {};\n    }\n    \n    var meta = {\n        name: options.name,\n        base: base,\n        implements: []\n    }\n    var classProto = Class.clone(proto);\n    if (options.implements) {\n        (Array.isArray(options.implements) ? options.implements : [options.implements])\n            .forEach(function (implementedType) {\n                if (typeof(implementedType) == 'function' && implementedType.prototype) {\n                    meta.implements.push(implementedType);\n                    Class.extend(classProto, implementedType.prototype);\n                }\n            });\n    }\n    classProto.__proto__ = base.prototype;\n    var theClass = function () {\n        if (typeof(this.constructor) == 'function') {\n            this.constructor.apply(this, arguments);\n        }\n    };\n    meta.type = theClass;\n    theClass.prototype = classProto;\n    Object.defineProperty(theClass, '.class.meta', { value: meta, enumerable: false, configurable: false, writable: false });\n    Object.defineProperty(classProto, '.class', { value: theClass, enumerable: false, configurable: false, writable: false });\n    if (options.statics) {\n        Class.extend(theClass, options.statics);\n    }\n    return theClass;\n};\n\nClass.extend = inherit;\n\nClass.clone = function (object) {\n    return inherit({}, object);\n};\n\nfunction findType(meta, type) {\n    while (meta) {\n        if (meta.type.prototype === type.prototype) {\n            return true;\n        }\n        for (var i in meta.implements) {\n            var implType = meta.implements[i];\n            var implMeta = implType['.class.meta'];\n            if (implMeta) {\n                if (findType(implMeta, type)) {\n                    return true;\n                }\n            } else {\n                for (var proto = implType.prototype; proto; proto = proto.__proto__) {\n                    if (proto === type.prototype) {\n                        return true;\n                    }\n                }\n            }\n        }\n        meta = meta.base ? meta.base['.class.meta'] : undefined;\n    }\n    return false;\n}\n\nvar Checker = Class({\n    constructor: function (object) {\n        this.object = object;\n    },\n    \n    typeOf: function (type) {\n        if (this.object instanceof type) {\n            return true;\n        }\n        var meta = Class.typeInfo(this.object);\n        return meta && findType(meta, type);\n    }\n});\n\n// aliases\nChecker.prototype.a = Checker.prototype.typeOf;\nChecker.prototype.an = Checker.prototype.typeOf;\n\nClass.is = function (object) {\n    return new Checker(object);\n};\n\nClass.typeInfo = function (object) {\n    var theClass = object.__proto__['.class'];\n    return theClass ? theClass['.class.meta'] : undefined;\n};\n\nClass.VERSION = [0, 0, 2];\n\nif (module) {\n    module.exports = Class;\n} else {\n    global.Class = Class;   // for browser\n}","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar Stats = function () {\n\n\tvar startTime = Date.now(), prevTime = startTime;\n\tvar ms = 0, msMin = Infinity, msMax = 0;\n\tvar fps = 0, fpsMin = Infinity, fpsMax = 0;\n\tvar frames = 0, mode = 0;\n\n\tvar container = document.createElement( 'div' );\n\tcontainer.id = 'stats';\n\tcontainer.addEventListener( 'mousedown', function ( event ) { event.preventDefault(); setMode( ++ mode % 2 ) }, false );\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar fpsDiv = document.createElement( 'div' );\n\tfpsDiv.id = 'fps';\n\tfpsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#002';\n\tcontainer.appendChild( fpsDiv );\n\n\tvar fpsText = document.createElement( 'div' );\n\tfpsText.id = 'fpsText';\n\tfpsText.style.cssText = 'color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tfpsText.innerHTML = 'FPS';\n\tfpsDiv.appendChild( fpsText );\n\n\tvar fpsGraph = document.createElement( 'div' );\n\tfpsGraph.id = 'fpsGraph';\n\tfpsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0ff';\n\tfpsDiv.appendChild( fpsGraph );\n\n\twhile ( fpsGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#113';\n\t\tfpsGraph.appendChild( bar );\n\n\t}\n\n\tvar msDiv = document.createElement( 'div' );\n\tmsDiv.id = 'ms';\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#020;display:none';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText = document.createElement( 'div' );\n\tmsText.id = 'msText';\n\tmsText.style.cssText = 'color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML = 'MS';\n\tmsDiv.appendChild( msText );\n\n\tvar msGraph = document.createElement( 'div' );\n\tmsGraph.id = 'msGraph';\n\tmsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0f0';\n\tmsDiv.appendChild( msGraph );\n\n\twhile ( msGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#131';\n\t\tmsGraph.appendChild( bar );\n\n\t}\n\n\tvar setMode = function ( value ) {\n\n\t\tmode = value;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 0:\n\t\t\t\tfpsDiv.style.display = 'block';\n\t\t\t\tmsDiv.style.display = 'none';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tfpsDiv.style.display = 'none';\n\t\t\t\tmsDiv.style.display = 'block';\n\t\t\t\tbreak;\n\t\t}\n\n\t};\n\n\tvar updateGraph = function ( dom, value ) {\n\n\t\tvar child = dom.appendChild( dom.firstChild );\n\t\tchild.style.height = value + 'px';\n\n\t};\n\n\treturn {\n\n\t\tREVISION: 12,\n\n\t\tdomElement: container,\n\n\t\tsetMode: setMode,\n\n\t\tbegin: function () {\n\n\t\t\tstartTime = Date.now();\n\n\t\t},\n\n\t\tend: function () {\n\n\t\t\tvar time = Date.now();\n\n\t\t\tms = time - startTime;\n\t\t\tmsMin = Math.min( msMin, ms );\n\t\t\tmsMax = Math.max( msMax, ms );\n\n\t\t\tmsText.textContent = ms + ' MS (' + msMin + '-' + msMax + ')';\n\t\t\tupdateGraph( msGraph, Math.min( 30, 30 - ( ms / 200 ) * 30 ) );\n\n\t\t\tframes ++;\n\n\t\t\tif ( time > prevTime + 1000 ) {\n\n\t\t\t\tfps = Math.round( ( frames * 1000 ) / ( time - prevTime ) );\n\t\t\t\tfpsMin = Math.min( fpsMin, fps );\n\t\t\t\tfpsMax = Math.max( fpsMax, fps );\n\n\t\t\t\tfpsText.textContent = fps + ' FPS (' + fpsMin + '-' + fpsMax + ')';\n\t\t\t\tupdateGraph( fpsGraph, Math.min( 30, 30 - ( fps / 100 ) * 30 ) );\n\n\t\t\t\tprevTime = time;\n\t\t\t\tframes = 0;\n\n\t\t\t}\n\n\t\t\treturn time;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tstartTime = this.end();\n\n\t\t}\n\n\t}\n\n};\n\nif ( typeof module === 'object' ) {\n\n\tmodule.exports = Stats;\n\n}","var self = self || {}; // File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = {\r\n  REVISION: '71'\r\n};\r\n\r\n// browserify support\r\n\r\nif (typeof module === 'object') {\r\n\r\n  module.exports = THREE;\r\n\r\n}\r\n\r\n// polyfills\r\n\r\nif (Math.sign === undefined) {\r\n\r\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n  Math.sign = function(x) {\r\n\r\n    return (x < 0) ? -1 : (x > 0) ? 1 : +x;\r\n\r\n  };\r\n\r\n}\r\n\r\n\r\n// set the default log handlers\r\nTHREE.log = function() {\r\n  console.log.apply(console, arguments);\r\n}\r\nTHREE.warn = function() {\r\n  console.warn.apply(console, arguments);\r\n}\r\nTHREE.error = function() {\r\n  console.error.apply(console, arguments);\r\n}\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\nTHREE.MOUSE = {\r\n  LEFT: 0,\r\n  MIDDLE: 1,\r\n  RIGHT: 2\r\n};\r\n\r\n// GL STATE CONSTANTS\r\n\r\nTHREE.CullFaceNone = 0;\r\nTHREE.CullFaceBack = 1;\r\nTHREE.CullFaceFront = 2;\r\nTHREE.CullFaceFrontBack = 3;\r\n\r\nTHREE.FrontFaceDirectionCW = 0;\r\nTHREE.FrontFaceDirectionCCW = 1;\r\n\r\n// SHADOWING TYPES\r\n\r\nTHREE.BasicShadowMap = 0;\r\nTHREE.PCFShadowMap = 1;\r\nTHREE.PCFSoftShadowMap = 2;\r\n\r\n// MATERIAL CONSTANTS\r\n\r\n// side\r\n\r\nTHREE.FrontSide = 0;\r\nTHREE.BackSide = 1;\r\nTHREE.DoubleSide = 2;\r\n\r\n// shading\r\n\r\nTHREE.NoShading = 0;\r\nTHREE.FlatShading = 1;\r\nTHREE.SmoothShading = 2;\r\n\r\n// colors\r\n\r\nTHREE.NoColors = 0;\r\nTHREE.FaceColors = 1;\r\nTHREE.VertexColors = 2;\r\n\r\n// blending modes\r\n\r\nTHREE.NoBlending = 0;\r\nTHREE.NormalBlending = 1;\r\nTHREE.AdditiveBlending = 2;\r\nTHREE.SubtractiveBlending = 3;\r\nTHREE.MultiplyBlending = 4;\r\nTHREE.CustomBlending = 5;\r\n\r\n// custom blending equations\r\n// (numbers start from 100 not to clash with other\r\n//  mappings to OpenGL constants defined in Texture.js)\r\n\r\nTHREE.AddEquation = 100;\r\nTHREE.SubtractEquation = 101;\r\nTHREE.ReverseSubtractEquation = 102;\r\nTHREE.MinEquation = 103;\r\nTHREE.MaxEquation = 104;\r\n\r\n// custom blending destination factors\r\n\r\nTHREE.ZeroFactor = 200;\r\nTHREE.OneFactor = 201;\r\nTHREE.SrcColorFactor = 202;\r\nTHREE.OneMinusSrcColorFactor = 203;\r\nTHREE.SrcAlphaFactor = 204;\r\nTHREE.OneMinusSrcAlphaFactor = 205;\r\nTHREE.DstAlphaFactor = 206;\r\nTHREE.OneMinusDstAlphaFactor = 207;\r\n\r\n// custom blending source factors\r\n\r\n//THREE.ZeroFactor = 200;\r\n//THREE.OneFactor = 201;\r\n//THREE.SrcAlphaFactor = 204;\r\n//THREE.OneMinusSrcAlphaFactor = 205;\r\n//THREE.DstAlphaFactor = 206;\r\n//THREE.OneMinusDstAlphaFactor = 207;\r\nTHREE.DstColorFactor = 208;\r\nTHREE.OneMinusDstColorFactor = 209;\r\nTHREE.SrcAlphaSaturateFactor = 210;\r\n\r\n\r\n// TEXTURE CONSTANTS\r\n\r\nTHREE.MultiplyOperation = 0;\r\nTHREE.MixOperation = 1;\r\nTHREE.AddOperation = 2;\r\n\r\n// Mapping modes\r\n\r\nTHREE.UVMapping = 300;\r\n\r\nTHREE.CubeReflectionMapping = 301;\r\nTHREE.CubeRefractionMapping = 302;\r\n\r\nTHREE.EquirectangularReflectionMapping = 303;\r\nTHREE.EquirectangularRefractionMapping = 304;\r\n\r\nTHREE.SphericalReflectionMapping = 305;\r\n\r\n// Wrapping modes\r\n\r\nTHREE.RepeatWrapping = 1000;\r\nTHREE.ClampToEdgeWrapping = 1001;\r\nTHREE.MirroredRepeatWrapping = 1002;\r\n\r\n// Filters\r\n\r\nTHREE.NearestFilter = 1003;\r\nTHREE.NearestMipMapNearestFilter = 1004;\r\nTHREE.NearestMipMapLinearFilter = 1005;\r\nTHREE.LinearFilter = 1006;\r\nTHREE.LinearMipMapNearestFilter = 1007;\r\nTHREE.LinearMipMapLinearFilter = 1008;\r\n\r\n// Data types\r\n\r\nTHREE.UnsignedByteType = 1009;\r\nTHREE.ByteType = 1010;\r\nTHREE.ShortType = 1011;\r\nTHREE.UnsignedShortType = 1012;\r\nTHREE.IntType = 1013;\r\nTHREE.UnsignedIntType = 1014;\r\nTHREE.FloatType = 1015;\r\nTHREE.HalfFloatType = 1025;\r\n\r\n// Pixel types\r\n\r\n//THREE.UnsignedByteType = 1009;\r\nTHREE.UnsignedShort4444Type = 1016;\r\nTHREE.UnsignedShort5551Type = 1017;\r\nTHREE.UnsignedShort565Type = 1018;\r\n\r\n// Pixel formats\r\n\r\nTHREE.AlphaFormat = 1019;\r\nTHREE.RGBFormat = 1020;\r\nTHREE.RGBAFormat = 1021;\r\nTHREE.LuminanceFormat = 1022;\r\nTHREE.LuminanceAlphaFormat = 1023;\r\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\r\n\r\n// DDS / ST3C Compressed texture formats\r\n\r\nTHREE.RGB_S3TC_DXT1_Format = 2001;\r\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\r\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\r\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\r\n\r\n\r\n// PVRTC compressed texture formats\r\n\r\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\r\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\r\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\r\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\r\n\r\n\r\n// DEPRECATED\r\n\r\nTHREE.Projector = function() {\r\n\r\n  THREE.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.');\r\n\r\n  this.projectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .projectVector() is now vector.project().');\r\n    vector.project(camera);\r\n\r\n  };\r\n\r\n  this.unprojectVector = function(vector, camera) {\r\n\r\n    THREE.warn('THREE.Projector: .unprojectVector() is now vector.unproject().');\r\n    vector.unproject(camera);\r\n\r\n  };\r\n\r\n  this.pickingRay = function(vector, camera) {\r\n\r\n    THREE.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().');\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CanvasRenderer = function() {\r\n\r\n  THREE.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js');\r\n\r\n  this.domElement = document.createElement('canvas');\r\n  this.clear = function() {};\r\n  this.render = function() {};\r\n  this.setClearColor = function() {};\r\n  this.setSize = function() {};\r\n\r\n};\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function(color) {\r\n\r\n  if (arguments.length === 3) {\r\n\r\n    return this.setRGB(arguments[0], arguments[1], arguments[2]);\r\n\r\n  }\r\n\r\n  return this.set(color)\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n  constructor: THREE.Color,\r\n\r\n  r: 1,\r\n  g: 1,\r\n  b: 1,\r\n\r\n  set: function(value) {\r\n\r\n    if (value instanceof THREE.Color) {\r\n\r\n      this.copy(value);\r\n\r\n    }\r\n    else if (typeof value === 'number') {\r\n\r\n      this.setHex(value);\r\n\r\n    }\r\n    else if (typeof value === 'string') {\r\n\r\n      this.setStyle(value);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHex: function(hex) {\r\n\r\n    hex = Math.floor(hex);\r\n\r\n    this.r = (hex >> 16 & 255) / 255;\r\n    this.g = (hex >> 8 & 255) / 255;\r\n    this.b = (hex & 255) / 255;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRGB: function(r, g, b) {\r\n\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setHSL: function(h, s, l) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    if (s === 0) {\r\n\r\n      this.r = this.g = this.b = l;\r\n\r\n    }\r\n    else {\r\n\r\n      var hue2rgb = function(p, q, t) {\r\n\r\n        if (t < 0) t += 1;\r\n        if (t > 1) t -= 1;\r\n        if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n        if (t < 1 / 2) return q;\r\n        if (t < 2 / 3) return p + (q - p) * 6 * (2 / 3 - t);\r\n        return p;\r\n\r\n      };\r\n\r\n      var p = l <= 0.5 ? l * (1 + s) : l + s - (l * s);\r\n      var q = (2 * l) - p;\r\n\r\n      this.r = hue2rgb(q, p, h + 1 / 3);\r\n      this.g = hue2rgb(q, p, h);\r\n      this.b = hue2rgb(q, p, h - 1 / 3);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setStyle: function(style) {\r\n\r\n    // rgb(255,0,0)\r\n\r\n    if (/^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+), ?(\\d+), ?(\\d+)\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(255, parseInt(color[1], 10)) / 255;\r\n      this.g = Math.min(255, parseInt(color[2], 10)) / 255;\r\n      this.b = Math.min(255, parseInt(color[3], 10)) / 255;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // rgb(100%,0%,0%)\r\n\r\n    if (/^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.test(style)) {\r\n\r\n      var color = /^rgb\\((\\d+)\\%, ?(\\d+)\\%, ?(\\d+)\\%\\)$/i.exec(style);\r\n\r\n      this.r = Math.min(100, parseInt(color[1], 10)) / 100;\r\n      this.g = Math.min(100, parseInt(color[2], 10)) / 100;\r\n      this.b = Math.min(100, parseInt(color[3], 10)) / 100;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #ff0000\r\n\r\n    if (/^\\#([0-9a-f]{6})$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f]{6})$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // #f00\r\n\r\n    if (/^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(style)) {\r\n\r\n      var color = /^\\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(style);\r\n\r\n      this.setHex(parseInt(color[1] + color[1] + color[2] + color[2] + color[3] + color[3], 16));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    // red\r\n\r\n    if (/^(\\w+)$/i.test(style)) {\r\n\r\n      this.setHex(THREE.ColorKeywords[style]);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n  },\r\n\r\n  copy: function(color) {\r\n\r\n    this.r = color.r;\r\n    this.g = color.g;\r\n    this.b = color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyGammaToLinear: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    this.r = Math.pow(color.r, gammaFactor);\r\n    this.g = Math.pow(color.g, gammaFactor);\r\n    this.b = Math.pow(color.b, gammaFactor);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copyLinearToGamma: function(color, gammaFactor) {\r\n\r\n    if (gammaFactor === undefined) gammaFactor = 2.0;\r\n\r\n    var safeInverse = (gammaFactor > 0) ? (1.0 / gammaFactor) : 1.0;\r\n\r\n    this.r = Math.pow(color.r, safeInverse);\r\n    this.g = Math.pow(color.g, safeInverse);\r\n    this.b = Math.pow(color.b, safeInverse);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertGammaToLinear: function() {\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    this.r = r * r;\r\n    this.g = g * g;\r\n    this.b = b * b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  convertLinearToGamma: function() {\r\n\r\n    this.r = Math.sqrt(this.r);\r\n    this.g = Math.sqrt(this.g);\r\n    this.b = Math.sqrt(this.b);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getHex: function() {\r\n\r\n    return (this.r * 255) << 16 ^ (this.g * 255) << 8 ^ (this.b * 255) << 0;\r\n\r\n  },\r\n\r\n  getHexString: function() {\r\n\r\n    return ('000000' + this.getHex().toString(16)).slice(-6);\r\n\r\n  },\r\n\r\n  getHSL: function(optionalTarget) {\r\n\r\n    // h,s,l ranges are in 0.0 - 1.0\r\n\r\n    var hsl = optionalTarget || {\r\n      h: 0,\r\n      s: 0,\r\n      l: 0\r\n    };\r\n\r\n    var r = this.r,\r\n      g = this.g,\r\n      b = this.b;\r\n\r\n    var max = Math.max(r, g, b);\r\n    var min = Math.min(r, g, b);\r\n\r\n    var hue, saturation;\r\n    var lightness = (min + max) / 2.0;\r\n\r\n    if (min === max) {\r\n\r\n      hue = 0;\r\n      saturation = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      var delta = max - min;\r\n\r\n      saturation = lightness <= 0.5 ? delta / (max + min) : delta / (2 - max - min);\r\n\r\n      switch (max) {\r\n\r\n        case r:\r\n          hue = (g - b) / delta + (g < b ? 6 : 0);\r\n          break;\r\n        case g:\r\n          hue = (b - r) / delta + 2;\r\n          break;\r\n        case b:\r\n          hue = (r - g) / delta + 4;\r\n          break;\r\n\r\n      }\r\n\r\n      hue /= 6;\r\n\r\n    }\r\n\r\n    hsl.h = hue;\r\n    hsl.s = saturation;\r\n    hsl.l = lightness;\r\n\r\n    return hsl;\r\n\r\n  },\r\n\r\n  getStyle: function() {\r\n\r\n    return 'rgb(' + ((this.r * 255) | 0) + ',' + ((this.g * 255) | 0) + ',' + ((this.b * 255) | 0) + ')';\r\n\r\n  },\r\n\r\n  offsetHSL: function(h, s, l) {\r\n\r\n    var hsl = this.getHSL();\r\n\r\n    hsl.h += h;\r\n    hsl.s += s;\r\n    hsl.l += l;\r\n\r\n    this.setHSL(hsl.h, hsl.s, hsl.l);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(color) {\r\n\r\n    this.r += color.r;\r\n    this.g += color.g;\r\n    this.b += color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addColors: function(color1, color2) {\r\n\r\n    this.r = color1.r + color2.r;\r\n    this.g = color1.g + color2.g;\r\n    this.b = color1.b + color2.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.r += s;\r\n    this.g += s;\r\n    this.b += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(color) {\r\n\r\n    this.r *= color.r;\r\n    this.g *= color.g;\r\n    this.b *= color.b;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.r *= s;\r\n    this.g *= s;\r\n    this.b *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(color, alpha) {\r\n\r\n    this.r += (color.r - this.r) * alpha;\r\n    this.g += (color.g - this.g) * alpha;\r\n    this.b += (color.b - this.b) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(c) {\r\n\r\n    return (c.r === this.r) && (c.g === this.g) && (c.b === this.b);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.r = array[0];\r\n    this.g = array[1];\r\n    this.b = array[2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.r;\r\n    array[offset + 1] = this.g;\r\n    array[offset + 2] = this.b;\r\n\r\n    return array;\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Color().setRGB(this.r, this.g, this.b);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = {\r\n  'aliceblue': 0xF0F8FF,\r\n  'antiquewhite': 0xFAEBD7,\r\n  'aqua': 0x00FFFF,\r\n  'aquamarine': 0x7FFFD4,\r\n  'azure': 0xF0FFFF,\r\n  'beige': 0xF5F5DC,\r\n  'bisque': 0xFFE4C4,\r\n  'black': 0x000000,\r\n  'blanchedalmond': 0xFFEBCD,\r\n  'blue': 0x0000FF,\r\n  'blueviolet': 0x8A2BE2,\r\n  'brown': 0xA52A2A,\r\n  'burlywood': 0xDEB887,\r\n  'cadetblue': 0x5F9EA0,\r\n  'chartreuse': 0x7FFF00,\r\n  'chocolate': 0xD2691E,\r\n  'coral': 0xFF7F50,\r\n  'cornflowerblue': 0x6495ED,\r\n  'cornsilk': 0xFFF8DC,\r\n  'crimson': 0xDC143C,\r\n  'cyan': 0x00FFFF,\r\n  'darkblue': 0x00008B,\r\n  'darkcyan': 0x008B8B,\r\n  'darkgoldenrod': 0xB8860B,\r\n  'darkgray': 0xA9A9A9,\r\n  'darkgreen': 0x006400,\r\n  'darkgrey': 0xA9A9A9,\r\n  'darkkhaki': 0xBDB76B,\r\n  'darkmagenta': 0x8B008B,\r\n  'darkolivegreen': 0x556B2F,\r\n  'darkorange': 0xFF8C00,\r\n  'darkorchid': 0x9932CC,\r\n  'darkred': 0x8B0000,\r\n  'darksalmon': 0xE9967A,\r\n  'darkseagreen': 0x8FBC8F,\r\n  'darkslateblue': 0x483D8B,\r\n  'darkslategray': 0x2F4F4F,\r\n  'darkslategrey': 0x2F4F4F,\r\n  'darkturquoise': 0x00CED1,\r\n  'darkviolet': 0x9400D3,\r\n  'deeppink': 0xFF1493,\r\n  'deepskyblue': 0x00BFFF,\r\n  'dimgray': 0x696969,\r\n  'dimgrey': 0x696969,\r\n  'dodgerblue': 0x1E90FF,\r\n  'firebrick': 0xB22222,\r\n  'floralwhite': 0xFFFAF0,\r\n  'forestgreen': 0x228B22,\r\n  'fuchsia': 0xFF00FF,\r\n  'gainsboro': 0xDCDCDC,\r\n  'ghostwhite': 0xF8F8FF,\r\n  'gold': 0xFFD700,\r\n  'goldenrod': 0xDAA520,\r\n  'gray': 0x808080,\r\n  'green': 0x008000,\r\n  'greenyellow': 0xADFF2F,\r\n  'grey': 0x808080,\r\n  'honeydew': 0xF0FFF0,\r\n  'hotpink': 0xFF69B4,\r\n  'indianred': 0xCD5C5C,\r\n  'indigo': 0x4B0082,\r\n  'ivory': 0xFFFFF0,\r\n  'khaki': 0xF0E68C,\r\n  'lavender': 0xE6E6FA,\r\n  'lavenderblush': 0xFFF0F5,\r\n  'lawngreen': 0x7CFC00,\r\n  'lemonchiffon': 0xFFFACD,\r\n  'lightblue': 0xADD8E6,\r\n  'lightcoral': 0xF08080,\r\n  'lightcyan': 0xE0FFFF,\r\n  'lightgoldenrodyellow': 0xFAFAD2,\r\n  'lightgray': 0xD3D3D3,\r\n  'lightgreen': 0x90EE90,\r\n  'lightgrey': 0xD3D3D3,\r\n  'lightpink': 0xFFB6C1,\r\n  'lightsalmon': 0xFFA07A,\r\n  'lightseagreen': 0x20B2AA,\r\n  'lightskyblue': 0x87CEFA,\r\n  'lightslategray': 0x778899,\r\n  'lightslategrey': 0x778899,\r\n  'lightsteelblue': 0xB0C4DE,\r\n  'lightyellow': 0xFFFFE0,\r\n  'lime': 0x00FF00,\r\n  'limegreen': 0x32CD32,\r\n  'linen': 0xFAF0E6,\r\n  'magenta': 0xFF00FF,\r\n  'maroon': 0x800000,\r\n  'mediumaquamarine': 0x66CDAA,\r\n  'mediumblue': 0x0000CD,\r\n  'mediumorchid': 0xBA55D3,\r\n  'mediumpurple': 0x9370DB,\r\n  'mediumseagreen': 0x3CB371,\r\n  'mediumslateblue': 0x7B68EE,\r\n  'mediumspringgreen': 0x00FA9A,\r\n  'mediumturquoise': 0x48D1CC,\r\n  'mediumvioletred': 0xC71585,\r\n  'midnightblue': 0x191970,\r\n  'mintcream': 0xF5FFFA,\r\n  'mistyrose': 0xFFE4E1,\r\n  'moccasin': 0xFFE4B5,\r\n  'navajowhite': 0xFFDEAD,\r\n  'navy': 0x000080,\r\n  'oldlace': 0xFDF5E6,\r\n  'olive': 0x808000,\r\n  'olivedrab': 0x6B8E23,\r\n  'orange': 0xFFA500,\r\n  'orangered': 0xFF4500,\r\n  'orchid': 0xDA70D6,\r\n  'palegoldenrod': 0xEEE8AA,\r\n  'palegreen': 0x98FB98,\r\n  'paleturquoise': 0xAFEEEE,\r\n  'palevioletred': 0xDB7093,\r\n  'papayawhip': 0xFFEFD5,\r\n  'peachpuff': 0xFFDAB9,\r\n  'peru': 0xCD853F,\r\n  'pink': 0xFFC0CB,\r\n  'plum': 0xDDA0DD,\r\n  'powderblue': 0xB0E0E6,\r\n  'purple': 0x800080,\r\n  'red': 0xFF0000,\r\n  'rosybrown': 0xBC8F8F,\r\n  'royalblue': 0x4169E1,\r\n  'saddlebrown': 0x8B4513,\r\n  'salmon': 0xFA8072,\r\n  'sandybrown': 0xF4A460,\r\n  'seagreen': 0x2E8B57,\r\n  'seashell': 0xFFF5EE,\r\n  'sienna': 0xA0522D,\r\n  'silver': 0xC0C0C0,\r\n  'skyblue': 0x87CEEB,\r\n  'slateblue': 0x6A5ACD,\r\n  'slategray': 0x708090,\r\n  'slategrey': 0x708090,\r\n  'snow': 0xFFFAFA,\r\n  'springgreen': 0x00FF7F,\r\n  'steelblue': 0x4682B4,\r\n  'tan': 0xD2B48C,\r\n  'teal': 0x008080,\r\n  'thistle': 0xD8BFD8,\r\n  'tomato': 0xFF6347,\r\n  'turquoise': 0x40E0D0,\r\n  'violet': 0xEE82EE,\r\n  'wheat': 0xF5DEB3,\r\n  'white': 0xFFFFFF,\r\n  'whitesmoke': 0xF5F5F5,\r\n  'yellow': 0xFFFF00,\r\n  'yellowgreen': 0x9ACD32\r\n};\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Quaternion = function(x, y, z, w) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n  constructor: THREE.Quaternion,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _w: 0,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get w() {\r\n\r\n    return this._w;\r\n\r\n  },\r\n\r\n  set w(value) {\r\n\r\n    this._w = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._w = w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(quaternion) {\r\n\r\n    this._x = quaternion.x;\r\n    this._y = quaternion.y;\r\n    this._z = quaternion.z;\r\n    this._w = quaternion.w;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromEuler: function(euler, update) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      throw new Error('THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n    }\r\n\r\n    // http://www.mathworks.com/matlabcentral/fileexchange/\r\n    // \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n    //\tcontent/SpinCalc.m\r\n\r\n    var c1 = Math.cos(euler._x / 2);\r\n    var c2 = Math.cos(euler._y / 2);\r\n    var c3 = Math.cos(euler._z / 2);\r\n    var s1 = Math.sin(euler._x / 2);\r\n    var s2 = Math.sin(euler._y / 2);\r\n    var s3 = Math.sin(euler._z / 2);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromAxisAngle: function(axis, angle) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n    // assumes axis is normalized\r\n\r\n    var halfAngle = angle / 2,\r\n      s = Math.sin(halfAngle);\r\n\r\n    this._x = axis.x * s;\r\n    this._y = axis.y * s;\r\n    this._z = axis.z * s;\r\n    this._w = Math.cos(halfAngle);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10],\r\n\r\n      trace = m11 + m22 + m33,\r\n      s;\r\n\r\n    if (trace > 0) {\r\n\r\n      s = 0.5 / Math.sqrt(trace + 1.0);\r\n\r\n      this._w = 0.25 / s;\r\n      this._x = (m32 - m23) * s;\r\n      this._y = (m13 - m31) * s;\r\n      this._z = (m21 - m12) * s;\r\n\r\n    }\r\n    else if (m11 > m22 && m11 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\r\n\r\n      this._w = (m32 - m23) / s;\r\n      this._x = 0.25 * s;\r\n      this._y = (m12 + m21) / s;\r\n      this._z = (m13 + m31) / s;\r\n\r\n    }\r\n    else if (m22 > m33) {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\r\n\r\n      this._w = (m13 - m31) / s;\r\n      this._x = (m12 + m21) / s;\r\n      this._y = 0.25 * s;\r\n      this._z = (m23 + m32) / s;\r\n\r\n    }\r\n    else {\r\n\r\n      s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\r\n\r\n      this._w = (m21 - m12) / s;\r\n      this._x = (m13 + m31) / s;\r\n      this._y = (m23 + m32) / s;\r\n      this._z = 0.25 * s;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromUnitVectors: function() {\r\n\r\n    // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n    // assumes direction vectors vFrom and vTo are normalized\r\n\r\n    var v1, r;\r\n\r\n    var EPS = 0.000001;\r\n\r\n    return function(vFrom, vTo) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      r = vFrom.dot(vTo) + 1;\r\n\r\n      if (r < EPS) {\r\n\r\n        r = 0;\r\n\r\n        if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\r\n\r\n          v1.set(-vFrom.y, vFrom.x, 0);\r\n\r\n        }\r\n        else {\r\n\r\n          v1.set(0, -vFrom.z, vFrom.y);\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        v1.crossVectors(vFrom, vTo);\r\n\r\n      }\r\n\r\n      this._x = v1.x;\r\n      this._y = v1.y;\r\n      this._z = v1.z;\r\n      this._w = r;\r\n\r\n      this.normalize();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  inverse: function() {\r\n\r\n    this.conjugate().normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  conjugate: function() {\r\n\r\n    this._x *= -1;\r\n    this._y *= -1;\r\n    this._z *= -1;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    var l = this.length();\r\n\r\n    if (l === 0) {\r\n\r\n      this._x = 0;\r\n      this._y = 0;\r\n      this._z = 0;\r\n      this._w = 1;\r\n\r\n    }\r\n    else {\r\n\r\n      l = 1 / l;\r\n\r\n      this._x = this._x * l;\r\n      this._y = this._y * l;\r\n      this._z = this._z * l;\r\n      this._w = this._w * l;\r\n\r\n    }\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(q, p) {\r\n\r\n    if (p !== undefined) {\r\n\r\n      THREE.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.');\r\n      return this.multiplyQuaternions(q, p);\r\n\r\n    }\r\n\r\n    return this.multiplyQuaternions(this, q);\r\n\r\n  },\r\n\r\n  multiplyQuaternions: function(a, b) {\r\n\r\n    // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n    var qax = a._x,\r\n      qay = a._y,\r\n      qaz = a._z,\r\n      qaw = a._w;\r\n    var qbx = b._x,\r\n      qby = b._y,\r\n      qbz = b._z,\r\n      qbw = b._w;\r\n\r\n    this._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n    this._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n    this._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n    this._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.');\r\n    return vector.applyQuaternion(this);\r\n\r\n  },\r\n\r\n  slerp: function(qb, t) {\r\n\r\n    if (t === 0) return this;\r\n    if (t === 1) return this.copy(qb);\r\n\r\n    var x = this._x,\r\n      y = this._y,\r\n      z = this._z,\r\n      w = this._w;\r\n\r\n    // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n    var cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n    if (cosHalfTheta < 0) {\r\n\r\n      this._w = -qb._w;\r\n      this._x = -qb._x;\r\n      this._y = -qb._y;\r\n      this._z = -qb._z;\r\n\r\n      cosHalfTheta = -cosHalfTheta;\r\n\r\n    }\r\n    else {\r\n\r\n      this.copy(qb);\r\n\r\n    }\r\n\r\n    if (cosHalfTheta >= 1.0) {\r\n\r\n      this._w = w;\r\n      this._x = x;\r\n      this._y = y;\r\n      this._z = z;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var halfTheta = Math.acos(cosHalfTheta);\r\n    var sinHalfTheta = Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);\r\n\r\n    if (Math.abs(sinHalfTheta) < 0.001) {\r\n\r\n      this._w = 0.5 * (w + this._w);\r\n      this._x = 0.5 * (x + this._x);\r\n      this._y = 0.5 * (y + this._y);\r\n      this._z = 0.5 * (z + this._z);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\r\n      ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n    this._w = (w * ratioA + this._w * ratioB);\r\n    this._x = (x * ratioA + this._x * ratioB);\r\n    this._y = (y * ratioA + this._y * ratioB);\r\n    this._z = (z * ratioA + this._z * ratioB);\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(quaternion) {\r\n\r\n    return (quaternion._x === this._x) && (quaternion._y === this._y) && (quaternion._z === this._z) && (quaternion._w === this._w);\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this._x = array[offset];\r\n    this._y = array[offset + 1];\r\n    this._z = array[offset + 2];\r\n    this._w = array[offset + 3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Quaternion(this._x, this._y, this._z, this._w);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Quaternion.slerp = function(qa, qb, qm, t) {\r\n\r\n  return qm.copy(qa).slerp(qb, t);\r\n\r\n}\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function(x, y) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n  constructor: THREE.Vector2,\r\n\r\n  set: function(x, y) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v) {\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    this.x *= s;\r\n    this.y *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector2();\r\n        max = new THREE.Vector2();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal);\r\n      max.set(maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x,\r\n      dy = this.y - v.y;\r\n    return dx * dx + dy * dy;\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector2(this.x, this.y);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function(x, y, z) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n  constructor: THREE.Vector3,\r\n\r\n  set: function(x, y, z) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiply: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.');\r\n      return this.multiplyVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n    this.z *= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVectors: function(a, b) {\r\n\r\n    this.x = a.x * b.x;\r\n    this.y = a.y * b.y;\r\n    this.z = a.z * b.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyEuler: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(euler) {\r\n\r\n      if (euler instanceof THREE.Euler === false) {\r\n\r\n        THREE.error('THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n      }\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromEuler(euler));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyAxisAngle: function() {\r\n\r\n    var quaternion;\r\n\r\n    return function(axis, angle) {\r\n\r\n      if (quaternion === undefined) quaternion = new THREE.Quaternion();\r\n\r\n      this.applyQuaternion(quaternion.setFromAxisAngle(axis, angle));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix3: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[3] * y + e[6] * z;\r\n    this.y = e[1] * x + e[4] * y + e[7] * z;\r\n    this.z = e[2] * x + e[5] * y + e[8] * z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12];\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13];\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyProjection: function(m) {\r\n\r\n    // input: THREE.Matrix4 projection matrix\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n    var d = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]); // perspective divide\r\n\r\n    this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * d;\r\n    this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * d;\r\n    this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * d;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyQuaternion: function(q) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n\r\n    var qx = q.x;\r\n    var qy = q.y;\r\n    var qz = q.z;\r\n    var qw = q.w;\r\n\r\n    // calculate quat * vector\r\n\r\n    var ix = qw * x + qy * z - qz * y;\r\n    var iy = qw * y + qz * x - qx * z;\r\n    var iz = qw * z + qx * y - qy * x;\r\n    var iw = -qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n\r\n    this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n    this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n    this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  project: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.projectionMatrix, matrix.getInverse(camera.matrixWorld));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  unproject: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(camera) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n\r\n      matrix.multiplyMatrices(camera.matrixWorld, matrix.getInverse(camera.projectionMatrix));\r\n      return this.applyProjection(matrix);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  transformDirection: function(m) {\r\n\r\n    // input: THREE.Matrix4 affine matrix\r\n    // vector interpreted as a direction\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z;\r\n\r\n    this.normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divide: function(v) {\r\n\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n    this.z /= v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector3();\r\n        max = new THREE.Vector3();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  cross: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.');\r\n      return this.crossVectors(v, w);\r\n\r\n    }\r\n\r\n    var x = this.x,\r\n      y = this.y,\r\n      z = this.z;\r\n\r\n    this.x = y * v.z - z * v.y;\r\n    this.y = z * v.x - x * v.z;\r\n    this.z = x * v.y - y * v.x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  crossVectors: function(a, b) {\r\n\r\n    var ax = a.x,\r\n      ay = a.y,\r\n      az = a.z;\r\n    var bx = b.x,\r\n      by = b.y,\r\n      bz = b.z;\r\n\r\n    this.x = ay * bz - az * by;\r\n    this.y = az * bx - ax * bz;\r\n    this.z = ax * by - ay * bx;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  projectOnVector: function() {\r\n\r\n    var v1, dot;\r\n\r\n    return function(vector) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(vector).normalize();\r\n\r\n      dot = this.dot(v1);\r\n\r\n      return this.copy(v1).multiplyScalar(dot);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  projectOnPlane: function() {\r\n\r\n    var v1;\r\n\r\n    return function(planeNormal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      v1.copy(this).projectOnVector(planeNormal);\r\n\r\n      return this.sub(v1);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  reflect: function() {\r\n\r\n    // reflect incident vector off plane orthogonal to normal\r\n    // normal is assumed to have unit length\r\n\r\n    var v1;\r\n\r\n    return function(normal) {\r\n\r\n      if (v1 === undefined) v1 = new THREE.Vector3();\r\n\r\n      return this.sub(v1.copy(normal).multiplyScalar(2 * this.dot(normal)));\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  angleTo: function(v) {\r\n\r\n    var theta = this.dot(v) / (this.length() * v.length());\r\n\r\n    // clamp, to handle numerical problems\r\n\r\n    return Math.acos(THREE.Math.clamp(theta, -1, 1));\r\n\r\n  },\r\n\r\n  distanceTo: function(v) {\r\n\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n\r\n  },\r\n\r\n  distanceToSquared: function(v) {\r\n\r\n    var dx = this.x - v.x;\r\n    var dy = this.y - v.y;\r\n    var dz = this.z - v.z;\r\n\r\n    return dx * dx + dy * dy + dz * dz;\r\n\r\n  },\r\n\r\n  setEulerFromRotationMatrix: function(m, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.');\r\n\r\n  },\r\n\r\n  setEulerFromQuaternion: function(q, order) {\r\n\r\n    THREE.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.');\r\n\r\n  },\r\n\r\n  getPositionFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().');\r\n\r\n    return this.setFromMatrixPosition(m);\r\n\r\n  },\r\n\r\n  getScaleFromMatrix: function(m) {\r\n\r\n    THREE.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().');\r\n\r\n    return this.setFromMatrixScale(m);\r\n  },\r\n\r\n  getColumnFromMatrix: function(index, matrix) {\r\n\r\n    THREE.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().');\r\n\r\n    return this.setFromMatrixColumn(index, matrix);\r\n\r\n  },\r\n\r\n  setFromMatrixPosition: function(m) {\r\n\r\n    this.x = m.elements[12];\r\n    this.y = m.elements[13];\r\n    this.z = m.elements[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrixScale: function(m) {\r\n\r\n    var sx = this.set(m.elements[0], m.elements[1], m.elements[2]).length();\r\n    var sy = this.set(m.elements[4], m.elements[5], m.elements[6]).length();\r\n    var sz = this.set(m.elements[8], m.elements[9], m.elements[10]).length();\r\n\r\n    this.x = sx;\r\n    this.y = sy;\r\n    this.z = sz;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromMatrixColumn: function(index, matrix) {\r\n\r\n    var offset = index * 4;\r\n\r\n    var me = matrix.elements;\r\n\r\n    this.x = me[offset];\r\n    this.y = me[offset + 1];\r\n    this.z = me[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector3(this.x, this.y, this.z);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function(x, y, z, w) {\r\n\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n  this.z = z || 0;\r\n  this.w = (w !== undefined) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n  constructor: THREE.Vector4,\r\n\r\n  set: function(x, y, z, w) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(x) {\r\n\r\n    this.x = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(y) {\r\n\r\n    this.y = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(z) {\r\n\r\n    this.z = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setW: function(w) {\r\n\r\n    this.w = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponent: function(index, value) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        this.x = value;\r\n        break;\r\n      case 1:\r\n        this.y = value;\r\n        break;\r\n      case 2:\r\n        this.z = value;\r\n        break;\r\n      case 3:\r\n        this.w = value;\r\n        break;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getComponent: function(index) {\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        return this.x;\r\n      case 1:\r\n        return this.y;\r\n      case 2:\r\n        return this.z;\r\n      case 3:\r\n        return this.w;\r\n      default:\r\n        throw new Error('index is out of range: ' + index);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  copy: function(v) {\r\n\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n    this.w = (v.w !== undefined) ? v.w : 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  add: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');\r\n      return this.addVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n    this.w += v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addScalar: function(s) {\r\n\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n    this.w += s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  addVectors: function(a, b) {\r\n\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n    this.w = a.w + b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  sub: function(v, w) {\r\n\r\n    if (w !== undefined) {\r\n\r\n      THREE.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');\r\n      return this.subVectors(v, w);\r\n\r\n    }\r\n\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n    this.w -= v.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subScalar: function(s) {\r\n\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n    this.w -= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  subVectors: function(a, b) {\r\n\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n    this.w = a.w - b.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(scalar) {\r\n\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n    this.w *= scalar;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(m) {\r\n\r\n    var x = this.x;\r\n    var y = this.y;\r\n    var z = this.z;\r\n    var w = this.w;\r\n\r\n    var e = m.elements;\r\n\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12] * w;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13] * w;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14] * w;\r\n    this.w = e[3] * x + e[7] * y + e[11] * z + e[15] * w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  divideScalar: function(scalar) {\r\n\r\n    if (scalar !== 0) {\r\n\r\n      var invScalar = 1 / scalar;\r\n\r\n      this.x *= invScalar;\r\n      this.y *= invScalar;\r\n      this.z *= invScalar;\r\n      this.w *= invScalar;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = 0;\r\n      this.y = 0;\r\n      this.z = 0;\r\n      this.w = 1;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromQuaternion: function(q) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n    // q is assumed to be normalized\r\n\r\n    this.w = 2 * Math.acos(q.w);\r\n\r\n    var s = Math.sqrt(1 - q.w * q.w);\r\n\r\n    if (s < 0.0001) {\r\n\r\n      this.x = 1;\r\n      this.y = 0;\r\n      this.z = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      this.x = q.x / s;\r\n      this.y = q.y / s;\r\n      this.z = q.z / s;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setAxisAngleFromRotationMatrix: function(m) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var angle, x, y, z, // variables for result\r\n      epsilon = 0.01, // margin to allow for rounding errors\r\n      epsilon2 = 0.1, // margin to distinguish between 0 and 180 degrees\r\n\r\n      te = m.elements,\r\n\r\n      m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8],\r\n      m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9],\r\n      m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    if ((Math.abs(m12 - m21) < epsilon) && (Math.abs(m13 - m31) < epsilon) && (Math.abs(m23 - m32) < epsilon)) {\r\n\r\n      // singularity found\r\n      // first check for identity matrix which must have +1 for all terms\r\n      // in leading diagonal and zero in other terms\r\n\r\n      if ((Math.abs(m12 + m21) < epsilon2) && (Math.abs(m13 + m31) < epsilon2) && (Math.abs(m23 + m32) < epsilon2) && (Math.abs(m11 + m22 + m33 - 3) < epsilon2)) {\r\n\r\n        // this singularity is identity matrix so angle = 0\r\n\r\n        this.set(1, 0, 0, 0);\r\n\r\n        return this; // zero angle, arbitrary axis\r\n\r\n      }\r\n\r\n      // otherwise this singularity is angle = 180\r\n\r\n      angle = Math.PI;\r\n\r\n      var xx = (m11 + 1) / 2;\r\n      var yy = (m22 + 1) / 2;\r\n      var zz = (m33 + 1) / 2;\r\n      var xy = (m12 + m21) / 4;\r\n      var xz = (m13 + m31) / 4;\r\n      var yz = (m23 + m32) / 4;\r\n\r\n      if ((xx > yy) && (xx > zz)) { // m11 is the largest diagonal term\r\n\r\n        if (xx < epsilon) {\r\n\r\n          x = 0;\r\n          y = 0.707106781;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          x = Math.sqrt(xx);\r\n          y = xy / x;\r\n          z = xz / x;\r\n\r\n        }\r\n\r\n      }\r\n      else if (yy > zz) { // m22 is the largest diagonal term\r\n\r\n        if (yy < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0;\r\n          z = 0.707106781;\r\n\r\n        }\r\n        else {\r\n\r\n          y = Math.sqrt(yy);\r\n          x = xy / y;\r\n          z = yz / y;\r\n\r\n        }\r\n\r\n      }\r\n      else { // m33 is the largest diagonal term so base result on this\r\n\r\n        if (zz < epsilon) {\r\n\r\n          x = 0.707106781;\r\n          y = 0.707106781;\r\n          z = 0;\r\n\r\n        }\r\n        else {\r\n\r\n          z = Math.sqrt(zz);\r\n          x = xz / z;\r\n          y = yz / z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.set(x, y, z, angle);\r\n\r\n      return this; // return 180 deg rotation\r\n\r\n    }\r\n\r\n    // as we have reached here there are no singularities so we can handle normally\r\n\r\n    var s = Math.sqrt((m32 - m23) * (m32 - m23) + (m13 - m31) * (m13 - m31) + (m21 - m12) * (m21 - m12)); // used to normalize\r\n\r\n    if (Math.abs(s) < 0.001) s = 1;\r\n\r\n    // prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n    // caught by singularity test above, but I've left it in just in case\r\n\r\n    this.x = (m32 - m23) / s;\r\n    this.y = (m13 - m31) / s;\r\n    this.z = (m21 - m12) / s;\r\n    this.w = Math.acos((m11 + m22 + m33 - 1) / 2);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  min: function(v) {\r\n\r\n    if (this.x > v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y > v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z > v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w > v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  max: function(v) {\r\n\r\n    if (this.x < v.x) {\r\n\r\n      this.x = v.x;\r\n\r\n    }\r\n\r\n    if (this.y < v.y) {\r\n\r\n      this.y = v.y;\r\n\r\n    }\r\n\r\n    if (this.z < v.z) {\r\n\r\n      this.z = v.z;\r\n\r\n    }\r\n\r\n    if (this.w < v.w) {\r\n\r\n      this.w = v.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clamp: function(min, max) {\r\n\r\n    // This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n    if (this.x < min.x) {\r\n\r\n      this.x = min.x;\r\n\r\n    }\r\n    else if (this.x > max.x) {\r\n\r\n      this.x = max.x;\r\n\r\n    }\r\n\r\n    if (this.y < min.y) {\r\n\r\n      this.y = min.y;\r\n\r\n    }\r\n    else if (this.y > max.y) {\r\n\r\n      this.y = max.y;\r\n\r\n    }\r\n\r\n    if (this.z < min.z) {\r\n\r\n      this.z = min.z;\r\n\r\n    }\r\n    else if (this.z > max.z) {\r\n\r\n      this.z = max.z;\r\n\r\n    }\r\n\r\n    if (this.w < min.w) {\r\n\r\n      this.w = min.w;\r\n\r\n    }\r\n    else if (this.w > max.w) {\r\n\r\n      this.w = max.w;\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clampScalar: (function() {\r\n\r\n    var min, max;\r\n\r\n    return function(minVal, maxVal) {\r\n\r\n      if (min === undefined) {\r\n\r\n        min = new THREE.Vector4();\r\n        max = new THREE.Vector4();\r\n\r\n      }\r\n\r\n      min.set(minVal, minVal, minVal, minVal);\r\n      max.set(maxVal, maxVal, maxVal, maxVal);\r\n\r\n      return this.clamp(min, max);\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  floor: function() {\r\n\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n    this.w = Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  ceil: function() {\r\n\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n    this.w = Math.ceil(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  round: function() {\r\n\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n    this.w = Math.round(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  roundToZero: function() {\r\n\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n    this.w = (this.w < 0) ? Math.ceil(this.w) : Math.floor(this.w);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n    this.z = -this.z;\r\n    this.w = -this.w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  dot: function(v) {\r\n\r\n    return this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n  },\r\n\r\n  lengthSq: function() {\r\n\r\n    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n  },\r\n\r\n  length: function() {\r\n\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\r\n\r\n  },\r\n\r\n  lengthManhattan: function() {\r\n\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    return this.divideScalar(this.length());\r\n\r\n  },\r\n\r\n  setLength: function(l) {\r\n\r\n    var oldLength = this.length();\r\n\r\n    if (oldLength !== 0 && l !== oldLength) {\r\n\r\n      this.multiplyScalar(l / oldLength);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerp: function(v, alpha) {\r\n\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n    this.w += (v.w - this.w) * alpha;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lerpVectors: function(v1, v2, alpha) {\r\n\r\n    this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(v) {\r\n\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z) && (v.w === this.w));\r\n\r\n  },\r\n\r\n  fromArray: function(array, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n    this.w = array[offset + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n    array[offset + 3] = this.w;\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  fromAttribute: function(attribute, index, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    index = index * attribute.itemSize + offset;\r\n\r\n    this.x = attribute.array[index];\r\n    this.y = attribute.array[index + 1];\r\n    this.z = attribute.array[index + 2];\r\n    this.w = attribute.array[index + 3];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Vector4(this.x, this.y, this.z, this.w);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Euler = function(x, y, z, order) {\r\n\r\n  this._x = x || 0;\r\n  this._y = y || 0;\r\n  this._z = z || 0;\r\n  this._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n  constructor: THREE.Euler,\r\n\r\n  _x: 0,\r\n  _y: 0,\r\n  _z: 0,\r\n  _order: THREE.Euler.DefaultOrder,\r\n\r\n  get x() {\r\n\r\n    return this._x;\r\n\r\n  },\r\n\r\n  set x(value) {\r\n\r\n    this._x = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get y() {\r\n\r\n    return this._y;\r\n\r\n  },\r\n\r\n  set y(value) {\r\n\r\n    this._y = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get z() {\r\n\r\n    return this._z;\r\n\r\n  },\r\n\r\n  set z(value) {\r\n\r\n    this._z = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  get order() {\r\n\r\n    return this._order;\r\n\r\n  },\r\n\r\n  set order(value) {\r\n\r\n    this._order = value;\r\n    this.onChangeCallback();\r\n\r\n  },\r\n\r\n  set: function(x, y, z, order) {\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._order = order || this._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(euler) {\r\n\r\n    this._x = euler._x;\r\n    this._y = euler._y;\r\n    this._z = euler._z;\r\n    this._order = euler._order;\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromRotationMatrix: function(m, order, update) {\r\n\r\n    var clamp = THREE.Math.clamp;\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements;\r\n    var m11 = te[0],\r\n      m12 = te[4],\r\n      m13 = te[8];\r\n    var m21 = te[1],\r\n      m22 = te[5],\r\n      m23 = te[9];\r\n    var m31 = te[2],\r\n      m32 = te[6],\r\n      m33 = te[10];\r\n\r\n    order = order || this._order;\r\n\r\n    if (order === 'XYZ') {\r\n\r\n      this._y = Math.asin(clamp(m13, -1, 1));\r\n\r\n      if (Math.abs(m13) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._z = Math.atan2(-m12, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YXZ') {\r\n\r\n      this._x = Math.asin(-clamp(m23, -1, 1));\r\n\r\n      if (Math.abs(m23) < 0.99999) {\r\n\r\n        this._y = Math.atan2(m13, m33);\r\n        this._z = Math.atan2(m21, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = Math.atan2(-m31, m11);\r\n        this._z = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZXY') {\r\n\r\n      this._x = Math.asin(clamp(m32, -1, 1));\r\n\r\n      if (Math.abs(m32) < 0.99999) {\r\n\r\n        this._y = Math.atan2(-m31, m33);\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n      else {\r\n\r\n        this._y = 0;\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'ZYX') {\r\n\r\n      this._y = Math.asin(-clamp(m31, -1, 1));\r\n\r\n      if (Math.abs(m31) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m33);\r\n        this._z = Math.atan2(m21, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._z = Math.atan2(-m12, m22);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'YZX') {\r\n\r\n      this._z = Math.asin(clamp(m21, -1, 1));\r\n\r\n      if (Math.abs(m21) < 0.99999) {\r\n\r\n        this._x = Math.atan2(-m23, m22);\r\n        this._y = Math.atan2(-m31, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = 0;\r\n        this._y = Math.atan2(m13, m33);\r\n\r\n      }\r\n\r\n    }\r\n    else if (order === 'XZY') {\r\n\r\n      this._z = Math.asin(-clamp(m12, -1, 1));\r\n\r\n      if (Math.abs(m12) < 0.99999) {\r\n\r\n        this._x = Math.atan2(m32, m22);\r\n        this._y = Math.atan2(m13, m11);\r\n\r\n      }\r\n      else {\r\n\r\n        this._x = Math.atan2(-m23, m33);\r\n        this._y = 0;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order)\r\n\r\n    }\r\n\r\n    this._order = order;\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromQuaternion: function() {\r\n\r\n    var matrix;\r\n\r\n    return function(q, order, update) {\r\n\r\n      if (matrix === undefined) matrix = new THREE.Matrix4();\r\n      matrix.makeRotationFromQuaternion(q);\r\n      this.setFromRotationMatrix(matrix, order, update);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromVector3: function(v, order) {\r\n\r\n    return this.set(v.x, v.y, v.z, order || this._order);\r\n\r\n  },\r\n\r\n  reorder: function() {\r\n\r\n    // WARNING: this discards revolution information -bhouston\r\n\r\n    var q = new THREE.Quaternion();\r\n\r\n    return function(newOrder) {\r\n\r\n      q.setFromEuler(this);\r\n      this.setFromQuaternion(q, newOrder);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  equals: function(euler) {\r\n\r\n    return (euler._x === this._x) && (euler._y === this._y) && (euler._z === this._z) && (euler._order === this._order);\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this._x = array[0];\r\n    this._y = array[1];\r\n    this._z = array[2];\r\n    if (array[3] !== undefined) this._order = array[3];\r\n\r\n    this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function(array, offset) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._order;\r\n\r\n    return array;\r\n  },\r\n\r\n  toVector3: function(optionalResult) {\r\n\r\n    if (optionalResult) {\r\n\r\n      return optionalResult.set(this._x, this._y, this._z);\r\n\r\n    }\r\n    else {\r\n\r\n      return new THREE.Vector3(this._x, this._y, this._z);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  onChange: function(callback) {\r\n\r\n    this.onChangeCallback = callback;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  onChangeCallback: function() {},\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Euler(this._x, this._y, this._z, this._order);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Line3 = function(start, end) {\r\n\r\n  this.start = (start !== undefined) ? start : new THREE.Vector3();\r\n  this.end = (end !== undefined) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n  constructor: THREE.Line3,\r\n\r\n  set: function(start, end) {\r\n\r\n    this.start.copy(start);\r\n    this.end.copy(end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(line) {\r\n\r\n    this.start.copy(line.start);\r\n    this.end.copy(line.end);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.start, this.end).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  delta: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.end, this.start);\r\n\r\n  },\r\n\r\n  distanceSq: function() {\r\n\r\n    return this.start.distanceToSquared(this.end);\r\n\r\n  },\r\n\r\n  distance: function() {\r\n\r\n    return this.start.distanceTo(this.end);\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  closestPointToPointParameter: function() {\r\n\r\n    var startP = new THREE.Vector3();\r\n    var startEnd = new THREE.Vector3();\r\n\r\n    return function(point, clampToLine) {\r\n\r\n      startP.subVectors(point, this.start);\r\n      startEnd.subVectors(this.end, this.start);\r\n\r\n      var startEnd2 = startEnd.dot(startEnd);\r\n      var startEnd_startP = startEnd.dot(startP);\r\n\r\n      var t = startEnd_startP / startEnd2;\r\n\r\n      if (clampToLine) {\r\n\r\n        t = THREE.Math.clamp(t, 0, 1);\r\n\r\n      }\r\n\r\n      return t;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, clampToLine, optionalTarget) {\r\n\r\n    var t = this.closestPointToPointParameter(point, clampToLine);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return this.delta(result).multiplyScalar(t).add(this.start);\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.start.applyMatrix4(matrix);\r\n    this.end.applyMatrix4(matrix);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(line) {\r\n\r\n    return line.start.equals(this.start) && line.end.equals(this.end);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Line3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Box2 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector2(Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector2(-Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n  constructor: THREE.Box2,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = Infinity;\r\n    this.max.x = this.max.y = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector2();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector2();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box2().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function(min, max) {\r\n\r\n  this.min = (min !== undefined) ? min : new THREE.Vector3(Infinity, Infinity, Infinity);\r\n  this.max = (max !== undefined) ? max : new THREE.Vector3(-Infinity, -Infinity, -Infinity);\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n  constructor: THREE.Box3,\r\n\r\n  set: function(min, max) {\r\n\r\n    this.min.copy(min);\r\n    this.max.copy(max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPoints: function(points) {\r\n\r\n    this.makeEmpty();\r\n\r\n    for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n      this.expandByPoint(points[i])\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCenterAndSize: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(center, size) {\r\n\r\n      var halfSize = v1.copy(size).multiplyScalar(0.5);\r\n\r\n      this.min.copy(center).sub(halfSize);\r\n      this.max.copy(center).add(halfSize);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setFromObject: function() {\r\n\r\n    // Computes the world-axis-aligned bounding box of an object (including its children),\r\n    // accounting for both the object's, and childrens', world transforms\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(object) {\r\n\r\n      var scope = this;\r\n\r\n      object.updateMatrixWorld(true);\r\n\r\n      this.makeEmpty();\r\n\r\n      object.traverse(function(node) {\r\n\r\n        var geometry = node.geometry;\r\n\r\n        if (geometry !== undefined) {\r\n\r\n          if (geometry instanceof THREE.Geometry) {\r\n\r\n            var vertices = geometry.vertices;\r\n\r\n            for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n              v1.copy(vertices[i]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n          else if (geometry instanceof THREE.BufferGeometry && geometry.attributes['position'] !== undefined) {\r\n\r\n            var positions = geometry.attributes['position'].array;\r\n\r\n            for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n              v1.set(positions[i], positions[i + 1], positions[i + 2]);\r\n\r\n              v1.applyMatrix4(node.matrixWorld);\r\n\r\n              scope.expandByPoint(v1);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      });\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(box) {\r\n\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeEmpty: function() {\r\n\r\n    this.min.x = this.min.y = this.min.z = Infinity;\r\n    this.max.x = this.max.y = this.max.z = -Infinity;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y) || (this.max.z < this.min.z);\r\n\r\n  },\r\n\r\n  center: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n\r\n  },\r\n\r\n  size: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.subVectors(this.max, this.min);\r\n\r\n  },\r\n\r\n  expandByPoint: function(point) {\r\n\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByVector: function(vector) {\r\n\r\n    this.min.sub(vector);\r\n    this.max.add(vector);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  expandByScalar: function(scalar) {\r\n\r\n    this.min.addScalar(-scalar);\r\n    this.max.addScalar(scalar);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    if (point.x < this.min.x || point.x > this.max.x ||\r\n      point.y < this.min.y || point.y > this.max.y ||\r\n      point.z < this.min.z || point.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  containsBox: function(box) {\r\n\r\n    if ((this.min.x <= box.min.x) && (box.max.x <= this.max.x) &&\r\n      (this.min.y <= box.min.y) && (box.max.y <= this.max.y) &&\r\n      (this.min.z <= box.min.z) && (box.max.z <= this.max.z)) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  getParameter: function(point, optionalTarget) {\r\n\r\n    // This can potentially have a divide by zero if the box\r\n    // has a size dimension of 0.\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.set(\r\n      (point.x - this.min.x) / (this.max.x - this.min.x), (point.y - this.min.y) / (this.max.y - this.min.y), (point.z - this.min.z) / (this.max.z - this.min.z)\r\n    );\r\n\r\n  },\r\n\r\n  isIntersectionBox: function(box) {\r\n\r\n    // using 6 splitting planes to rule out intersections.\r\n\r\n    if (box.max.x < this.min.x || box.min.x > this.max.x ||\r\n      box.max.y < this.min.y || box.min.y > this.max.y ||\r\n      box.max.z < this.min.z || box.min.z > this.max.z) {\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(point).clamp(this.min, this.max);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var clampedPoint = v1.copy(point).clamp(this.min, this.max);\r\n      return clampedPoint.sub(point).length();\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  getBoundingSphere: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Sphere();\r\n\r\n      result.center = this.center();\r\n      result.radius = this.size(v1).length() * 0.5;\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersect: function(box) {\r\n\r\n    this.min.max(box.min);\r\n    this.max.min(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  union: function(box) {\r\n\r\n    this.min.min(box.min);\r\n    this.max.max(box.max);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var points = [\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3(),\r\n      new THREE.Vector3()\r\n    ];\r\n\r\n    return function(matrix) {\r\n\r\n      // NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n      points[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(matrix); // 000\r\n      points[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(matrix); // 001\r\n      points[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(matrix); // 010\r\n      points[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(matrix); // 011\r\n      points[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(matrix); // 100\r\n      points[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(matrix); // 101\r\n      points[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(matrix); // 110\r\n      points[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(matrix); // 111\r\n\r\n      this.makeEmpty();\r\n      this.setFromPoints(points);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.min.add(offset);\r\n    this.max.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(box) {\r\n\r\n    return box.min.equals(this.min) && box.max.equals(this.max);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Box3().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Matrix3 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0,\r\n    0, 1, 0,\r\n    0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n  constructor: THREE.Matrix3,\r\n\r\n  set: function(n11, n12, n13, n21, n22, n23, n31, n32, n33) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[3] = n12;\r\n    te[6] = n13;\r\n    te[1] = n21;\r\n    te[4] = n22;\r\n    te[7] = n23;\r\n    te[2] = n31;\r\n    te[5] = n32;\r\n    te[8] = n33;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0,\r\n      0, 1, 0,\r\n      0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    var me = m.elements;\r\n\r\n    this.set(\r\n\r\n      me[0], me[3], me[6],\r\n      me[1], me[4], me[7],\r\n      me[2], me[5], me[8]\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.');\r\n    return vector.applyMatrix3(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix3(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[3] *= s;\r\n    te[6] *= s;\r\n    te[1] *= s;\r\n    te[4] *= s;\r\n    te[7] *= s;\r\n    te[2] *= s;\r\n    te[5] *= s;\r\n    te[8] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var a = te[0],\r\n      b = te[1],\r\n      c = te[2],\r\n      d = te[3],\r\n      e = te[4],\r\n      f = te[5],\r\n      g = te[6],\r\n      h = te[7],\r\n      i = te[8];\r\n\r\n    return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n  },\r\n\r\n  getInverse: function(matrix, throwOnInvertible) {\r\n\r\n    // input: THREE.Matrix4\r\n    // ( based on http://code.google.com/p/webgl-mjs/ )\r\n\r\n    var me = matrix.elements;\r\n    var te = this.elements;\r\n\r\n    te[0] = me[10] * me[5] - me[6] * me[9];\r\n    te[1] = -me[10] * me[1] + me[2] * me[9];\r\n    te[2] = me[6] * me[1] - me[2] * me[5];\r\n    te[3] = -me[10] * me[4] + me[6] * me[8];\r\n    te[4] = me[10] * me[0] - me[2] * me[8];\r\n    te[5] = -me[6] * me[0] + me[2] * me[4];\r\n    te[6] = me[9] * me[4] - me[5] * me[8];\r\n    te[7] = -me[9] * me[0] + me[1] * me[8];\r\n    te[8] = me[5] * me[0] - me[1] * me[4];\r\n\r\n    var det = me[0] * te[0] + me[1] * te[3] + me[2] * te[6];\r\n\r\n    // no inverse\r\n\r\n    if (det === 0) {\r\n\r\n      var msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    this.multiplyScalar(1.0 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var tmp, m = this.elements;\r\n\r\n    tmp = m[1];\r\n    m[1] = m[3];\r\n    m[3] = tmp;\r\n    tmp = m[2];\r\n    m[2] = m[6];\r\n    m[6] = tmp;\r\n    tmp = m[5];\r\n    m[5] = m[7];\r\n    m[7] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n\r\n    array[offset + 3] = te[3];\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n    array[offset + 8] = te[8];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getNormalMatrix: function(m) {\r\n\r\n    // input: THREE.Matrix4\r\n\r\n    this.getInverse(m).transpose();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  transposeIntoArray: function(r) {\r\n\r\n    var m = this.elements;\r\n\r\n    r[0] = m[0];\r\n    r[1] = m[3];\r\n    r[2] = m[6];\r\n    r[3] = m[1];\r\n    r[4] = m[4];\r\n    r[5] = m[7];\r\n    r[6] = m[2];\r\n    r[7] = m[5];\r\n    r[8] = m[8];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2],\r\n      te[3], te[4], te[5],\r\n      te[6], te[7], te[8]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix3().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://exocortex.com\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function() {\r\n\r\n  this.elements = new Float32Array([\r\n\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1\r\n\r\n  ]);\r\n\r\n  if (arguments.length > 0) {\r\n\r\n    THREE.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n  constructor: THREE.Matrix4,\r\n\r\n  set: function(n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] = n11;\r\n    te[4] = n12;\r\n    te[8] = n13;\r\n    te[12] = n14;\r\n    te[1] = n21;\r\n    te[5] = n22;\r\n    te[9] = n23;\r\n    te[13] = n24;\r\n    te[2] = n31;\r\n    te[6] = n32;\r\n    te[10] = n33;\r\n    te[14] = n34;\r\n    te[3] = n41;\r\n    te[7] = n42;\r\n    te[11] = n43;\r\n    te[15] = n44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  identity: function() {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, 1, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(m) {\r\n\r\n    this.elements.set(m.elements);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractPosition: function(m) {\r\n\r\n    THREE.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().');\r\n    return this.copyPosition(m);\r\n\r\n  },\r\n\r\n  copyPosition: function(m) {\r\n\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    te[12] = me[12];\r\n    te[13] = me[13];\r\n    te[14] = me[14];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    var te = this.elements;\r\n\r\n    xAxis.set(te[0], te[1], te[2]);\r\n    yAxis.set(te[4], te[5], te[6]);\r\n    zAxis.set(te[8], te[9], te[10]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeBasis: function(xAxis, yAxis, zAxis) {\r\n\r\n    this.set(\r\n      xAxis.x, yAxis.x, zAxis.x, 0,\r\n      xAxis.y, yAxis.y, zAxis.y, 0,\r\n      xAxis.z, yAxis.z, zAxis.z, 0,\r\n      0, 0, 0, 1\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  extractRotation: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(m) {\r\n\r\n      var te = this.elements;\r\n      var me = m.elements;\r\n\r\n      var scaleX = 1 / v1.set(me[0], me[1], me[2]).length();\r\n      var scaleY = 1 / v1.set(me[4], me[5], me[6]).length();\r\n      var scaleZ = 1 / v1.set(me[8], me[9], me[10]).length();\r\n\r\n      te[0] = me[0] * scaleX;\r\n      te[1] = me[1] * scaleX;\r\n      te[2] = me[2] * scaleX;\r\n\r\n      te[4] = me[4] * scaleY;\r\n      te[5] = me[5] * scaleY;\r\n      te[6] = me[6] * scaleY;\r\n\r\n      te[8] = me[8] * scaleZ;\r\n      te[9] = me[9] * scaleZ;\r\n      te[10] = me[10] * scaleZ;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeRotationFromEuler: function(euler) {\r\n\r\n    if (euler instanceof THREE.Euler === false) {\r\n\r\n      THREE.error('THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');\r\n\r\n    }\r\n\r\n    var te = this.elements;\r\n\r\n    var x = euler.x,\r\n      y = euler.y,\r\n      z = euler.z;\r\n    var a = Math.cos(x),\r\n      b = Math.sin(x);\r\n    var c = Math.cos(y),\r\n      d = Math.sin(y);\r\n    var e = Math.cos(z),\r\n      f = Math.sin(z);\r\n\r\n    if (euler.order === 'XYZ') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -c * f;\r\n      te[8] = d;\r\n\r\n      te[1] = af + be * d;\r\n      te[5] = ae - bf * d;\r\n      te[9] = -b * c;\r\n\r\n      te[2] = bf - ae * d;\r\n      te[6] = be + af * d;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YXZ') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce + df * b;\r\n      te[4] = de * b - cf;\r\n      te[8] = a * d;\r\n\r\n      te[1] = a * f;\r\n      te[5] = a * e;\r\n      te[9] = -b;\r\n\r\n      te[2] = cf * b - de;\r\n      te[6] = df + ce * b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZXY') {\r\n\r\n      var ce = c * e,\r\n        cf = c * f,\r\n        de = d * e,\r\n        df = d * f;\r\n\r\n      te[0] = ce - df * b;\r\n      te[4] = -a * f;\r\n      te[8] = de + cf * b;\r\n\r\n      te[1] = cf + de * b;\r\n      te[5] = a * e;\r\n      te[9] = df - ce * b;\r\n\r\n      te[2] = -a * d;\r\n      te[6] = b;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'ZYX') {\r\n\r\n      var ae = a * e,\r\n        af = a * f,\r\n        be = b * e,\r\n        bf = b * f;\r\n\r\n      te[0] = c * e;\r\n      te[4] = be * d - af;\r\n      te[8] = ae * d + bf;\r\n\r\n      te[1] = c * f;\r\n      te[5] = bf * d + ae;\r\n      te[9] = af * d - be;\r\n\r\n      te[2] = -d;\r\n      te[6] = b * c;\r\n      te[10] = a * c;\r\n\r\n    }\r\n    else if (euler.order === 'YZX') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = bd - ac * f;\r\n      te[8] = bc * f + ad;\r\n\r\n      te[1] = f;\r\n      te[5] = a * e;\r\n      te[9] = -b * e;\r\n\r\n      te[2] = -d * e;\r\n      te[6] = ad * f + bc;\r\n      te[10] = ac - bd * f;\r\n\r\n    }\r\n    else if (euler.order === 'XZY') {\r\n\r\n      var ac = a * c,\r\n        ad = a * d,\r\n        bc = b * c,\r\n        bd = b * d;\r\n\r\n      te[0] = c * e;\r\n      te[4] = -f;\r\n      te[8] = d * e;\r\n\r\n      te[1] = ac * f + bd;\r\n      te[5] = a * e;\r\n      te[9] = ad * f - bc;\r\n\r\n      te[2] = bc * f - ad;\r\n      te[6] = b * e;\r\n      te[10] = bd * f + ac;\r\n\r\n    }\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    THREE.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().');\r\n\r\n    return this.makeRotationFromQuaternion(q);\r\n\r\n  },\r\n\r\n  makeRotationFromQuaternion: function(q) {\r\n\r\n    var te = this.elements;\r\n\r\n    var x = q.x,\r\n      y = q.y,\r\n      z = q.z,\r\n      w = q.w;\r\n    var x2 = x + x,\r\n      y2 = y + y,\r\n      z2 = z + z;\r\n    var xx = x * x2,\r\n      xy = x * y2,\r\n      xz = x * z2;\r\n    var yy = y * y2,\r\n      yz = y * z2,\r\n      zz = z * z2;\r\n    var wx = w * x2,\r\n      wy = w * y2,\r\n      wz = w * z2;\r\n\r\n    te[0] = 1 - (yy + zz);\r\n    te[4] = xy - wz;\r\n    te[8] = xz + wy;\r\n\r\n    te[1] = xy + wz;\r\n    te[5] = 1 - (xx + zz);\r\n    te[9] = yz - wx;\r\n\r\n    te[2] = xz - wy;\r\n    te[6] = yz + wx;\r\n    te[10] = 1 - (xx + yy);\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  lookAt: function() {\r\n\r\n    var x = new THREE.Vector3();\r\n    var y = new THREE.Vector3();\r\n    var z = new THREE.Vector3();\r\n\r\n    return function(eye, target, up) {\r\n\r\n      var te = this.elements;\r\n\r\n      z.subVectors(eye, target).normalize();\r\n\r\n      if (z.length() === 0) {\r\n\r\n        z.z = 1;\r\n\r\n      }\r\n\r\n      x.crossVectors(up, z).normalize();\r\n\r\n      if (x.length() === 0) {\r\n\r\n        z.x += 0.0001;\r\n        x.crossVectors(up, z).normalize();\r\n\r\n      }\r\n\r\n      y.crossVectors(z, x);\r\n\r\n\r\n      te[0] = x.x;\r\n      te[4] = y.x;\r\n      te[8] = z.x;\r\n      te[1] = x.y;\r\n      te[5] = y.y;\r\n      te[9] = z.y;\r\n      te[2] = x.z;\r\n      te[6] = y.z;\r\n      te[10] = z.z;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  multiply: function(m, n) {\r\n\r\n    if (n !== undefined) {\r\n\r\n      THREE.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.');\r\n      return this.multiplyMatrices(m, n);\r\n\r\n    }\r\n\r\n    return this.multiplyMatrices(this, m);\r\n\r\n  },\r\n\r\n  multiplyMatrices: function(a, b) {\r\n\r\n    var ae = a.elements;\r\n    var be = b.elements;\r\n    var te = this.elements;\r\n\r\n    var a11 = ae[0],\r\n      a12 = ae[4],\r\n      a13 = ae[8],\r\n      a14 = ae[12];\r\n    var a21 = ae[1],\r\n      a22 = ae[5],\r\n      a23 = ae[9],\r\n      a24 = ae[13];\r\n    var a31 = ae[2],\r\n      a32 = ae[6],\r\n      a33 = ae[10],\r\n      a34 = ae[14];\r\n    var a41 = ae[3],\r\n      a42 = ae[7],\r\n      a43 = ae[11],\r\n      a44 = ae[15];\r\n\r\n    var b11 = be[0],\r\n      b12 = be[4],\r\n      b13 = be[8],\r\n      b14 = be[12];\r\n    var b21 = be[1],\r\n      b22 = be[5],\r\n      b23 = be[9],\r\n      b24 = be[13];\r\n    var b31 = be[2],\r\n      b32 = be[6],\r\n      b33 = be[10],\r\n      b34 = be[14];\r\n    var b41 = be[3],\r\n      b42 = be[7],\r\n      b43 = be[11],\r\n      b44 = be[15];\r\n\r\n    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyToArray: function(a, b, r) {\r\n\r\n    var te = this.elements;\r\n\r\n    this.multiplyMatrices(a, b);\r\n\r\n    r[0] = te[0];\r\n    r[1] = te[1];\r\n    r[2] = te[2];\r\n    r[3] = te[3];\r\n    r[4] = te[4];\r\n    r[5] = te[5];\r\n    r[6] = te[6];\r\n    r[7] = te[7];\r\n    r[8] = te[8];\r\n    r[9] = te[9];\r\n    r[10] = te[10];\r\n    r[11] = te[11];\r\n    r[12] = te[12];\r\n    r[13] = te[13];\r\n    r[14] = te[14];\r\n    r[15] = te[15];\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyScalar: function(s) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[0] *= s;\r\n    te[4] *= s;\r\n    te[8] *= s;\r\n    te[12] *= s;\r\n    te[1] *= s;\r\n    te[5] *= s;\r\n    te[9] *= s;\r\n    te[13] *= s;\r\n    te[2] *= s;\r\n    te[6] *= s;\r\n    te[10] *= s;\r\n    te[14] *= s;\r\n    te[3] *= s;\r\n    te[7] *= s;\r\n    te[11] *= s;\r\n    te[15] *= s;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  multiplyVector3: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.');\r\n    return vector.applyProjection(this);\r\n\r\n  },\r\n\r\n  multiplyVector4: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  multiplyVector3Array: function(a) {\r\n\r\n    THREE.warn('THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');\r\n    return this.applyToVector3Array(a);\r\n\r\n  },\r\n\r\n  applyToVector3Array: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(array, offset, length) {\r\n\r\n      if (offset === undefined) offset = 0;\r\n      if (length === undefined) length = array.length;\r\n\r\n      for (var i = 0, j = offset; i < length; i += 3, j += 3) {\r\n\r\n        v1.x = array[j];\r\n        v1.y = array[j + 1];\r\n        v1.z = array[j + 2];\r\n\r\n        v1.applyMatrix4(this);\r\n\r\n        array[j] = v1.x;\r\n        array[j + 1] = v1.y;\r\n        array[j + 2] = v1.z;\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateAxis: function(v) {\r\n\r\n    THREE.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.');\r\n\r\n    v.transformDirection(this);\r\n\r\n  },\r\n\r\n  crossVector: function(vector) {\r\n\r\n    THREE.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.');\r\n    return vector.applyMatrix4(this);\r\n\r\n  },\r\n\r\n  determinant: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var n11 = te[0],\r\n      n12 = te[4],\r\n      n13 = te[8],\r\n      n14 = te[12];\r\n    var n21 = te[1],\r\n      n22 = te[5],\r\n      n23 = te[9],\r\n      n24 = te[13];\r\n    var n31 = te[2],\r\n      n32 = te[6],\r\n      n33 = te[10],\r\n      n34 = te[14];\r\n    var n41 = te[3],\r\n      n42 = te[7],\r\n      n43 = te[11],\r\n      n44 = te[15];\r\n\r\n    //TODO: make this more efficient\r\n    //( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n    return (\r\n      n41 * (+n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34) +\r\n      n42 * (+n11 * n23 * n34 - n11 * n24 * n33 + n14 * n21 * n33 - n13 * n21 * n34 + n13 * n24 * n31 - n14 * n23 * n31) +\r\n      n43 * (+n11 * n24 * n32 - n11 * n22 * n34 - n14 * n21 * n32 + n12 * n21 * n34 + n14 * n22 * n31 - n12 * n24 * n31) +\r\n      n44 * (-n13 * n22 * n31 - n11 * n23 * n32 + n11 * n22 * n33 + n13 * n21 * n32 - n12 * n21 * n33 + n12 * n23 * n31)\r\n\r\n    );\r\n\r\n  },\r\n\r\n  transpose: function() {\r\n\r\n    var te = this.elements;\r\n    var tmp;\r\n\r\n    tmp = te[1];\r\n    te[1] = te[4];\r\n    te[4] = tmp;\r\n    tmp = te[2];\r\n    te[2] = te[8];\r\n    te[8] = tmp;\r\n    tmp = te[6];\r\n    te[6] = te[9];\r\n    te[9] = tmp;\r\n\r\n    tmp = te[3];\r\n    te[3] = te[12];\r\n    te[12] = tmp;\r\n    tmp = te[7];\r\n    te[7] = te[13];\r\n    te[13] = tmp;\r\n    tmp = te[11];\r\n    te[11] = te[14];\r\n    te[14] = tmp;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  flattenToArrayOffset: function(array, offset) {\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n    array[offset + 3] = te[3];\r\n\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n\r\n    array[offset + 8] = te[8];\r\n    array[offset + 9] = te[9];\r\n    array[offset + 10] = te[10];\r\n    array[offset + 11] = te[11];\r\n\r\n    array[offset + 12] = te[12];\r\n    array[offset + 13] = te[13];\r\n    array[offset + 14] = te[14];\r\n    array[offset + 15] = te[15];\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  getPosition: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      THREE.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.');\r\n\r\n      var te = this.elements;\r\n      return v1.set(te[12], te[13], te[14]);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  setPosition: function(v) {\r\n\r\n    var te = this.elements;\r\n\r\n    te[12] = v.x;\r\n    te[13] = v.y;\r\n    te[14] = v.z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getInverse: function(m, throwOnInvertible) {\r\n\r\n    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n\r\n    var n11 = me[0],\r\n      n12 = me[4],\r\n      n13 = me[8],\r\n      n14 = me[12];\r\n    var n21 = me[1],\r\n      n22 = me[5],\r\n      n23 = me[9],\r\n      n24 = me[13];\r\n    var n31 = me[2],\r\n      n32 = me[6],\r\n      n33 = me[10],\r\n      n34 = me[14];\r\n    var n41 = me[3],\r\n      n42 = me[7],\r\n      n43 = me[11],\r\n      n44 = me[15];\r\n\r\n    te[0] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\r\n    te[4] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\r\n    te[8] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\r\n    te[12] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n    te[1] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\r\n    te[5] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\r\n    te[9] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\r\n    te[13] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\r\n    te[2] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\r\n    te[6] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\r\n    te[10] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\r\n    te[14] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\r\n    te[3] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\r\n    te[7] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\r\n    te[11] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\r\n    te[15] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\r\n\r\n    var det = n11 * te[0] + n21 * te[4] + n31 * te[8] + n41 * te[12];\r\n\r\n    if (det == 0) {\r\n\r\n      var msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n      if (throwOnInvertible || false) {\r\n\r\n        throw new Error(msg);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.warn(msg);\r\n\r\n      }\r\n\r\n      this.identity();\r\n\r\n      return this;\r\n    }\r\n\r\n    this.multiplyScalar(1 / det);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(v) {\r\n\r\n    THREE.error('THREE.Matrix4: .translate() has been removed.');\r\n\r\n  },\r\n\r\n  rotateX: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateX() has been removed.');\r\n\r\n  },\r\n\r\n  rotateY: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateY() has been removed.');\r\n\r\n  },\r\n\r\n  rotateZ: function(angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateZ() has been removed.');\r\n\r\n  },\r\n\r\n  rotateByAxis: function(axis, angle) {\r\n\r\n    THREE.error('THREE.Matrix4: .rotateByAxis() has been removed.');\r\n\r\n  },\r\n\r\n  scale: function(v) {\r\n\r\n    var te = this.elements;\r\n    var x = v.x,\r\n      y = v.y,\r\n      z = v.z;\r\n\r\n    te[0] *= x;\r\n    te[4] *= y;\r\n    te[8] *= z;\r\n    te[1] *= x;\r\n    te[5] *= y;\r\n    te[9] *= z;\r\n    te[2] *= x;\r\n    te[6] *= y;\r\n    te[10] *= z;\r\n    te[3] *= x;\r\n    te[7] *= y;\r\n    te[11] *= z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  getMaxScaleOnAxis: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    var scaleXSq = te[0] * te[0] + te[1] * te[1] + te[2] * te[2];\r\n    var scaleYSq = te[4] * te[4] + te[5] * te[5] + te[6] * te[6];\r\n    var scaleZSq = te[8] * te[8] + te[9] * te[9] + te[10] * te[10];\r\n\r\n    return Math.sqrt(Math.max(scaleXSq, Math.max(scaleYSq, scaleZSq)));\r\n\r\n  },\r\n\r\n  makeTranslation: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, x,\r\n      0, 1, 0, y,\r\n      0, 0, 1, z,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationX: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      1, 0, 0, 0,\r\n      0, c, -s, 0,\r\n      0, s, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationY: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, 0, s, 0,\r\n      0, 1, 0, 0, -s, 0, c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationZ: function(theta) {\r\n\r\n    var c = Math.cos(theta),\r\n      s = Math.sin(theta);\r\n\r\n    this.set(\r\n\r\n      c, -s, 0, 0,\r\n      s, c, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeRotationAxis: function(axis, angle) {\r\n\r\n    // Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n    var c = Math.cos(angle);\r\n    var s = Math.sin(angle);\r\n    var t = 1 - c;\r\n    var x = axis.x,\r\n      y = axis.y,\r\n      z = axis.z;\r\n    var tx = t * x,\r\n      ty = t * y;\r\n\r\n    this.set(\r\n\r\n      tx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n      tx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n      tx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makeScale: function(x, y, z) {\r\n\r\n    this.set(\r\n\r\n      x, 0, 0, 0,\r\n      0, y, 0, 0,\r\n      0, 0, z, 0,\r\n      0, 0, 0, 1\r\n\r\n    );\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  compose: function(position, quaternion, scale) {\r\n\r\n    this.makeRotationFromQuaternion(quaternion);\r\n    this.scale(scale);\r\n    this.setPosition(position);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  decompose: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(position, quaternion, scale) {\r\n\r\n      var te = this.elements;\r\n\r\n      var sx = vector.set(te[0], te[1], te[2]).length();\r\n      var sy = vector.set(te[4], te[5], te[6]).length();\r\n      var sz = vector.set(te[8], te[9], te[10]).length();\r\n\r\n      // if determine is negative, we need to invert one scale\r\n      var det = this.determinant();\r\n      if (det < 0) {\r\n        sx = -sx;\r\n      }\r\n\r\n      position.x = te[12];\r\n      position.y = te[13];\r\n      position.z = te[14];\r\n\r\n      // scale the rotation part\r\n\r\n      matrix.elements.set(this.elements); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n      var invSX = 1 / sx;\r\n      var invSY = 1 / sy;\r\n      var invSZ = 1 / sz;\r\n\r\n      matrix.elements[0] *= invSX;\r\n      matrix.elements[1] *= invSX;\r\n      matrix.elements[2] *= invSX;\r\n\r\n      matrix.elements[4] *= invSY;\r\n      matrix.elements[5] *= invSY;\r\n      matrix.elements[6] *= invSY;\r\n\r\n      matrix.elements[8] *= invSZ;\r\n      matrix.elements[9] *= invSZ;\r\n      matrix.elements[10] *= invSZ;\r\n\r\n      quaternion.setFromRotationMatrix(matrix);\r\n\r\n      scale.x = sx;\r\n      scale.y = sy;\r\n      scale.z = sz;\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  makeFrustum: function(left, right, bottom, top, near, far) {\r\n\r\n    var te = this.elements;\r\n    var x = 2 * near / (right - left);\r\n    var y = 2 * near / (top - bottom);\r\n\r\n    var a = (right + left) / (right - left);\r\n    var b = (top + bottom) / (top - bottom);\r\n    var c = -(far + near) / (far - near);\r\n    var d = -2 * far * near / (far - near);\r\n\r\n    te[0] = x;\r\n    te[4] = 0;\r\n    te[8] = a;\r\n    te[12] = 0;\r\n    te[1] = 0;\r\n    te[5] = y;\r\n    te[9] = b;\r\n    te[13] = 0;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = c;\r\n    te[14] = d;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = -1;\r\n    te[15] = 0;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  makePerspective: function(fov, aspect, near, far) {\r\n\r\n    var ymax = near * Math.tan(THREE.Math.degToRad(fov * 0.5));\r\n    var ymin = -ymax;\r\n    var xmin = ymin * aspect;\r\n    var xmax = ymax * aspect;\r\n\r\n    return this.makeFrustum(xmin, xmax, ymin, ymax, near, far);\r\n\r\n  },\r\n\r\n  makeOrthographic: function(left, right, top, bottom, near, far) {\r\n\r\n    var te = this.elements;\r\n    var w = right - left;\r\n    var h = top - bottom;\r\n    var p = far - near;\r\n\r\n    var x = (right + left) / w;\r\n    var y = (top + bottom) / h;\r\n    var z = (far + near) / p;\r\n\r\n    te[0] = 2 / w;\r\n    te[4] = 0;\r\n    te[8] = 0;\r\n    te[12] = -x;\r\n    te[1] = 0;\r\n    te[5] = 2 / h;\r\n    te[9] = 0;\r\n    te[13] = -y;\r\n    te[2] = 0;\r\n    te[6] = 0;\r\n    te[10] = -2 / p;\r\n    te[14] = -z;\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n    te[15] = 1;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  fromArray: function(array) {\r\n\r\n    this.elements.set(array);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  toArray: function() {\r\n\r\n    var te = this.elements;\r\n\r\n    return [\r\n      te[0], te[1], te[2], te[3],\r\n      te[4], te[5], te[6], te[7],\r\n      te[8], te[9], te[10], te[11],\r\n      te[12], te[13], te[14], te[15]\r\n    ];\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Matrix4().fromArray(this.elements);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Ray = function(origin, direction) {\r\n\r\n  this.origin = (origin !== undefined) ? origin : new THREE.Vector3();\r\n  this.direction = (direction !== undefined) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n  constructor: THREE.Ray,\r\n\r\n  set: function(origin, direction) {\r\n\r\n    this.origin.copy(origin);\r\n    this.direction.copy(direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(ray) {\r\n\r\n    this.origin.copy(ray.origin);\r\n    this.direction.copy(ray.direction);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  at: function(t, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    return result.copy(this.direction).multiplyScalar(t).add(this.origin);\r\n\r\n  },\r\n\r\n  recast: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(t) {\r\n\r\n      this.origin.copy(this.at(t, v1));\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  closestPointToPoint: function(point, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.subVectors(point, this.origin);\r\n    var directionDistance = result.dot(this.direction);\r\n\r\n    if (directionDistance < 0) {\r\n\r\n      return result.copy(this.origin);\r\n\r\n    }\r\n\r\n    return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n  },\r\n\r\n  distanceToPoint: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(point) {\r\n\r\n      var directionDistance = v1.subVectors(point, this.origin).dot(this.direction);\r\n\r\n      // point behind the ray\r\n\r\n      if (directionDistance < 0) {\r\n\r\n        return this.origin.distanceTo(point);\r\n\r\n      }\r\n\r\n      v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n\r\n      return v1.distanceTo(point);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  distanceSqToSegment: function() {\r\n\r\n    var segCenter = new THREE.Vector3();\r\n    var segDir = new THREE.Vector3();\r\n    var diff = new THREE.Vector3();\r\n\r\n    return function(v0, v1, optionalPointOnRay, optionalPointOnSegment) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\r\n      // It returns the min distance between the ray and the segment\r\n      // defined by v0 and v1\r\n      // It can also set two optional targets :\r\n      // - The closest point on the ray\r\n      // - The closest point on the segment\r\n\r\n      segCenter.copy(v0).add(v1).multiplyScalar(0.5);\r\n      segDir.copy(v1).sub(v0).normalize();\r\n      diff.copy(this.origin).sub(segCenter);\r\n\r\n      var segExtent = v0.distanceTo(v1) * 0.5;\r\n      var a01 = -this.direction.dot(segDir);\r\n      var b0 = diff.dot(this.direction);\r\n      var b1 = -diff.dot(segDir);\r\n      var c = diff.lengthSq();\r\n      var det = Math.abs(1 - a01 * a01);\r\n      var s0, s1, sqrDist, extDet;\r\n\r\n      if (det > 0) {\r\n\r\n        // The ray and segment are not parallel.\r\n\r\n        s0 = a01 * b1 - b0;\r\n        s1 = a01 * b0 - b1;\r\n        extDet = segExtent * det;\r\n\r\n        if (s0 >= 0) {\r\n\r\n          if (s1 >= -extDet) {\r\n\r\n            if (s1 <= extDet) {\r\n\r\n              // region 0\r\n              // Minimum at interior points of ray and segment.\r\n\r\n              var invDet = 1 / det;\r\n              s0 *= invDet;\r\n              s1 *= invDet;\r\n              sqrDist = s0 * (s0 + a01 * s1 + 2 * b0) + s1 * (a01 * s0 + s1 + 2 * b1) + c;\r\n\r\n            }\r\n            else {\r\n\r\n              // region 1\r\n\r\n              s1 = segExtent;\r\n              s0 = Math.max(0, -(a01 * s1 + b0));\r\n              sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            // region 5\r\n\r\n            s1 = -segExtent;\r\n            s0 = Math.max(0, -(a01 * s1 + b0));\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          if (s1 <= -extDet) {\r\n\r\n            // region 4\r\n\r\n            s0 = Math.max(0, -(-a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? -segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else if (s1 <= extDet) {\r\n\r\n            // region 3\r\n\r\n            s0 = 0;\r\n            s1 = Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n          else {\r\n\r\n            // region 2\r\n\r\n            s0 = Math.max(0, -(a01 * segExtent + b0));\r\n            s1 = (s0 > 0) ? segExtent : Math.min(Math.max(-segExtent, -b1), segExtent);\r\n            sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // Ray and segment are parallel.\r\n\r\n        s1 = (a01 > 0) ? -segExtent : segExtent;\r\n        s0 = Math.max(0, -(a01 * s1 + b0));\r\n        sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;\r\n\r\n      }\r\n\r\n      if (optionalPointOnRay) {\r\n\r\n        optionalPointOnRay.copy(this.direction).multiplyScalar(s0).add(this.origin);\r\n\r\n      }\r\n\r\n      if (optionalPointOnSegment) {\r\n\r\n        optionalPointOnSegment.copy(segDir).multiplyScalar(s1).add(segCenter);\r\n\r\n      }\r\n\r\n      return sqrDist;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  isIntersectionSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) <= sphere.radius;\r\n\r\n  },\r\n\r\n  intersectSphere: function() {\r\n\r\n    // from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(sphere, optionalTarget) {\r\n\r\n      v1.subVectors(sphere.center, this.origin);\r\n\r\n      var tca = v1.dot(this.direction);\r\n\r\n      var d2 = v1.dot(v1) - tca * tca;\r\n\r\n      var radius2 = sphere.radius * sphere.radius;\r\n\r\n      if (d2 > radius2) return null;\r\n\r\n      var thc = Math.sqrt(radius2 - d2);\r\n\r\n      // t0 = first intersect point - entrance on front of sphere\r\n      var t0 = tca - thc;\r\n\r\n      // t1 = second intersect point - exit point on back of sphere\r\n      var t1 = tca + thc;\r\n\r\n      // test to see if both t0 and t1 are behind the ray - if so, return null\r\n      if (t0 < 0 && t1 < 0) return null;\r\n\r\n      // test to see if t0 is behind the ray:\r\n      // if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n      // in order to always return an intersect point that is in front of the ray.\r\n      if (t0 < 0) return this.at(t1, optionalTarget);\r\n\r\n      // else t0 is in front of the ray, so return the first collision point scaled by t0 \r\n      return this.at(t0, optionalTarget);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  isIntersectionPlane: function(plane) {\r\n\r\n    // check if the ray lies on the plane first\r\n\r\n    var distToPoint = plane.distanceToPoint(this.origin);\r\n\r\n    if (distToPoint === 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n\r\n    if (denominator * distToPoint < 0) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    // ray origin is behind the plane (and is pointing behind it)\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  distanceToPlane: function(plane) {\r\n\r\n    var denominator = plane.normal.dot(this.direction);\r\n    if (denominator == 0) {\r\n\r\n      // line is coplanar, return origin\r\n      if (plane.distanceToPoint(this.origin) == 0) {\r\n\r\n        return 0;\r\n\r\n      }\r\n\r\n      // Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n      return null;\r\n\r\n    }\r\n\r\n    var t = -(this.origin.dot(plane.normal) + plane.constant) / denominator;\r\n\r\n    // Return if the ray never intersects the plane\r\n\r\n    return t >= 0 ? t : null;\r\n\r\n  },\r\n\r\n  intersectPlane: function(plane, optionalTarget) {\r\n\r\n    var t = this.distanceToPlane(plane);\r\n\r\n    if (t === null) {\r\n\r\n      return null;\r\n    }\r\n\r\n    return this.at(t, optionalTarget);\r\n\r\n  },\r\n\r\n  isIntersectionBox: function() {\r\n\r\n    var v = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      return this.intersectBox(box, v) !== null;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectBox: function(box, optionalTarget) {\r\n\r\n    // http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\r\n\r\n    var tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n    var invdirx = 1 / this.direction.x,\r\n      invdiry = 1 / this.direction.y,\r\n      invdirz = 1 / this.direction.z;\r\n\r\n    var origin = this.origin;\r\n\r\n    if (invdirx >= 0) {\r\n\r\n      tmin = (box.min.x - origin.x) * invdirx;\r\n      tmax = (box.max.x - origin.x) * invdirx;\r\n\r\n    }\r\n    else {\r\n\r\n      tmin = (box.max.x - origin.x) * invdirx;\r\n      tmax = (box.min.x - origin.x) * invdirx;\r\n    }\r\n\r\n    if (invdiry >= 0) {\r\n\r\n      tymin = (box.min.y - origin.y) * invdiry;\r\n      tymax = (box.max.y - origin.y) * invdiry;\r\n\r\n    }\r\n    else {\r\n\r\n      tymin = (box.max.y - origin.y) * invdiry;\r\n      tymax = (box.min.y - origin.y) * invdiry;\r\n    }\r\n\r\n    if ((tmin > tymax) || (tymin > tmax)) return null;\r\n\r\n    // These lines also handle the case where tmin or tmax is NaN\r\n    // (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n    if (tymin > tmin || tmin !== tmin) tmin = tymin;\r\n\r\n    if (tymax < tmax || tmax !== tmax) tmax = tymax;\r\n\r\n    if (invdirz >= 0) {\r\n\r\n      tzmin = (box.min.z - origin.z) * invdirz;\r\n      tzmax = (box.max.z - origin.z) * invdirz;\r\n\r\n    }\r\n    else {\r\n\r\n      tzmin = (box.max.z - origin.z) * invdirz;\r\n      tzmax = (box.min.z - origin.z) * invdirz;\r\n    }\r\n\r\n    if ((tmin > tzmax) || (tzmin > tmax)) return null;\r\n\r\n    if (tzmin > tmin || tmin !== tmin) tmin = tzmin;\r\n\r\n    if (tzmax < tmax || tmax !== tmax) tmax = tzmax;\r\n\r\n    //return point closest to the ray (positive side)\r\n\r\n    if (tmax < 0) return null;\r\n\r\n    return this.at(tmin >= 0 ? tmin : tmax, optionalTarget);\r\n\r\n  },\r\n\r\n  intersectTriangle: function() {\r\n\r\n    // Compute the offset origin, edges, and normal.\r\n    var diff = new THREE.Vector3();\r\n    var edge1 = new THREE.Vector3();\r\n    var edge2 = new THREE.Vector3();\r\n    var normal = new THREE.Vector3();\r\n\r\n    return function(a, b, c, backfaceCulling, optionalTarget) {\r\n\r\n      // from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\r\n\r\n      edge1.subVectors(b, a);\r\n      edge2.subVectors(c, a);\r\n      normal.crossVectors(edge1, edge2);\r\n\r\n      // Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n      // E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n      //   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n      //   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n      //   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n      var DdN = this.direction.dot(normal);\r\n      var sign;\r\n\r\n      if (DdN > 0) {\r\n\r\n        if (backfaceCulling) return null;\r\n        sign = 1;\r\n\r\n      }\r\n      else if (DdN < 0) {\r\n\r\n        sign = -1;\r\n        DdN = -DdN;\r\n\r\n      }\r\n      else {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      diff.subVectors(this.origin, a);\r\n      var DdQxE2 = sign * this.direction.dot(edge2.crossVectors(diff, edge2));\r\n\r\n      // b1 < 0, no intersection\r\n      if (DdQxE2 < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      var DdE1xQ = sign * this.direction.dot(edge1.cross(diff));\r\n\r\n      // b2 < 0, no intersection\r\n      if (DdE1xQ < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // b1+b2 > 1, no intersection\r\n      if (DdQxE2 + DdE1xQ > DdN) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Line intersects triangle, check if ray does.\r\n      var QdN = -sign * diff.dot(normal);\r\n\r\n      // t < 0, no intersection\r\n      if (QdN < 0) {\r\n\r\n        return null;\r\n\r\n      }\r\n\r\n      // Ray intersects triangle.\r\n      return this.at(QdN / DdN, optionalTarget);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  applyMatrix4: function(matrix4) {\r\n\r\n    this.direction.add(this.origin).applyMatrix4(matrix4);\r\n    this.origin.applyMatrix4(matrix4);\r\n    this.direction.sub(this.origin);\r\n    this.direction.normalize();\r\n\r\n    return this;\r\n  },\r\n\r\n  equals: function(ray) {\r\n\r\n    return ray.origin.equals(this.origin) && ray.direction.equals(this.direction);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Ray().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function(center, radius) {\r\n\r\n  this.center = (center !== undefined) ? center : new THREE.Vector3();\r\n  this.radius = (radius !== undefined) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n  constructor: THREE.Sphere,\r\n\r\n  set: function(center, radius) {\r\n\r\n    this.center.copy(center);\r\n    this.radius = radius;\r\n\r\n    return this;\r\n  },\r\n\r\n  setFromPoints: function() {\r\n\r\n    var box = new THREE.Box3();\r\n\r\n    return function(points, optionalCenter) {\r\n\r\n      var center = this.center;\r\n\r\n      if (optionalCenter !== undefined) {\r\n\r\n        center.copy(optionalCenter);\r\n\r\n      }\r\n      else {\r\n\r\n        box.setFromPoints(points).center(center);\r\n\r\n      }\r\n\r\n      var maxRadiusSq = 0;\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(points[i]));\r\n\r\n      }\r\n\r\n      this.radius = Math.sqrt(maxRadiusSq);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  copy: function(sphere) {\r\n\r\n    this.center.copy(sphere.center);\r\n    this.radius = sphere.radius;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  empty: function() {\r\n\r\n    return (this.radius <= 0);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return (point.distanceToSquared(this.center) <= (this.radius * this.radius));\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return (point.distanceTo(this.center) - this.radius);\r\n\r\n  },\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var radiusSum = this.radius + sphere.radius;\r\n\r\n    return sphere.center.distanceToSquared(this.center) <= (radiusSum * radiusSum);\r\n\r\n  },\r\n\r\n  clampPoint: function(point, optionalTarget) {\r\n\r\n    var deltaLengthSq = this.center.distanceToSquared(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    result.copy(point);\r\n\r\n    if (deltaLengthSq > (this.radius * this.radius)) {\r\n\r\n      result.sub(this.center).normalize();\r\n      result.multiplyScalar(this.radius).add(this.center);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  },\r\n\r\n  getBoundingBox: function(optionalTarget) {\r\n\r\n    var box = optionalTarget || new THREE.Box3();\r\n\r\n    box.set(this.center, this.center);\r\n    box.expandByScalar(this.radius);\r\n\r\n    return box;\r\n\r\n  },\r\n\r\n  applyMatrix4: function(matrix) {\r\n\r\n    this.center.applyMatrix4(matrix);\r\n    this.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  translate: function(offset) {\r\n\r\n    this.center.add(offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(sphere) {\r\n\r\n    return sphere.center.equals(this.center) && (sphere.radius === this.radius);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Sphere().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Frustum = function(p0, p1, p2, p3, p4, p5) {\r\n\r\n  this.planes = [\r\n\r\n    (p0 !== undefined) ? p0 : new THREE.Plane(), (p1 !== undefined) ? p1 : new THREE.Plane(), (p2 !== undefined) ? p2 : new THREE.Plane(), (p3 !== undefined) ? p3 : new THREE.Plane(), (p4 !== undefined) ? p4 : new THREE.Plane(), (p5 !== undefined) ? p5 : new THREE.Plane()\r\n\r\n  ];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n  constructor: THREE.Frustum,\r\n\r\n  set: function(p0, p1, p2, p3, p4, p5) {\r\n\r\n    var planes = this.planes;\r\n\r\n    planes[0].copy(p0);\r\n    planes[1].copy(p1);\r\n    planes[2].copy(p2);\r\n    planes[3].copy(p3);\r\n    planes[4].copy(p4);\r\n    planes[5].copy(p5);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(frustum) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      planes[i].copy(frustum.planes[i]);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromMatrix: function(m) {\r\n\r\n    var planes = this.planes;\r\n    var me = m.elements;\r\n    var me0 = me[0],\r\n      me1 = me[1],\r\n      me2 = me[2],\r\n      me3 = me[3];\r\n    var me4 = me[4],\r\n      me5 = me[5],\r\n      me6 = me[6],\r\n      me7 = me[7];\r\n    var me8 = me[8],\r\n      me9 = me[9],\r\n      me10 = me[10],\r\n      me11 = me[11];\r\n    var me12 = me[12],\r\n      me13 = me[13],\r\n      me14 = me[14],\r\n      me15 = me[15];\r\n\r\n    planes[0].setComponents(me3 - me0, me7 - me4, me11 - me8, me15 - me12).normalize();\r\n    planes[1].setComponents(me3 + me0, me7 + me4, me11 + me8, me15 + me12).normalize();\r\n    planes[2].setComponents(me3 + me1, me7 + me5, me11 + me9, me15 + me13).normalize();\r\n    planes[3].setComponents(me3 - me1, me7 - me5, me11 - me9, me15 - me13).normalize();\r\n    planes[4].setComponents(me3 - me2, me7 - me6, me11 - me10, me15 - me14).normalize();\r\n    planes[5].setComponents(me3 + me2, me7 + me6, me11 + me10, me15 + me14).normalize();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  intersectsObject: function() {\r\n\r\n    var sphere = new THREE.Sphere();\r\n\r\n    return function(object) {\r\n\r\n      var geometry = object.geometry;\r\n\r\n      if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n      sphere.copy(geometry.boundingSphere);\r\n      sphere.applyMatrix4(object.matrixWorld);\r\n\r\n      return this.intersectsSphere(sphere);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  intersectsSphere: function(sphere) {\r\n\r\n    var planes = this.planes;\r\n    var center = sphere.center;\r\n    var negRadius = -sphere.radius;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      var distance = planes[i].distanceToPoint(center);\r\n\r\n      if (distance < negRadius) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  intersectsBox: function() {\r\n\r\n    var p1 = new THREE.Vector3(),\r\n      p2 = new THREE.Vector3();\r\n\r\n    return function(box) {\r\n\r\n      var planes = this.planes;\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        var plane = planes[i];\r\n\r\n        p1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n        p2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n        p1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n        p2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n        p1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n        p2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n        var d1 = plane.distanceToPoint(p1);\r\n        var d2 = plane.distanceToPoint(p2);\r\n\r\n        // if both outside plane, no intersection\r\n\r\n        if (d1 < 0 && d2 < 0) {\r\n\r\n          return false;\r\n\r\n        }\r\n      }\r\n\r\n      return true;\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  containsPoint: function(point) {\r\n\r\n    var planes = this.planes;\r\n\r\n    for (var i = 0; i < 6; i++) {\r\n\r\n      if (planes[i].distanceToPoint(point) < 0) {\r\n\r\n        return false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Frustum().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Plane = function(normal, constant) {\r\n\r\n  this.normal = (normal !== undefined) ? normal : new THREE.Vector3(1, 0, 0);\r\n  this.constant = (constant !== undefined) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n  constructor: THREE.Plane,\r\n\r\n  set: function(normal, constant) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setComponents: function(x, y, z, w) {\r\n\r\n    this.normal.set(x, y, z);\r\n    this.constant = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromNormalAndCoplanarPoint: function(normal, point) {\r\n\r\n    this.normal.copy(normal);\r\n    this.constant = -point.dot(this.normal); // must be this.normal, not normal, as this.normal is normalized\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromCoplanarPoints: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n\r\n    return function(a, b, c) {\r\n\r\n      var normal = v1.subVectors(c, b).cross(v2.subVectors(a, b)).normalize();\r\n\r\n      // Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n      this.setFromNormalAndCoplanarPoint(normal, a);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  copy: function(plane) {\r\n\r\n    this.normal.copy(plane.normal);\r\n    this.constant = plane.constant;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalize: function() {\r\n\r\n    // Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n    var inverseNormalLength = 1.0 / this.normal.length();\r\n    this.normal.multiplyScalar(inverseNormalLength);\r\n    this.constant *= inverseNormalLength;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  negate: function() {\r\n\r\n    this.constant *= -1;\r\n    this.normal.negate();\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  distanceToPoint: function(point) {\r\n\r\n    return this.normal.dot(point) + this.constant;\r\n\r\n  },\r\n\r\n  distanceToSphere: function(sphere) {\r\n\r\n    return this.distanceToPoint(sphere.center) - sphere.radius;\r\n\r\n  },\r\n\r\n  projectPoint: function(point, optionalTarget) {\r\n\r\n    return this.orthoPoint(point, optionalTarget).sub(point).negate();\r\n\r\n  },\r\n\r\n  orthoPoint: function(point, optionalTarget) {\r\n\r\n    var perpendicularMagnitude = this.distanceToPoint(point);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(perpendicularMagnitude);\r\n\r\n  },\r\n\r\n  isIntersectionLine: function(line) {\r\n\r\n    // Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n    var startSign = this.distanceToPoint(line.start);\r\n    var endSign = this.distanceToPoint(line.end);\r\n\r\n    return (startSign < 0 && endSign > 0) || (endSign < 0 && startSign > 0);\r\n\r\n  },\r\n\r\n  intersectLine: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(line, optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      var direction = line.delta(v1);\r\n\r\n      var denominator = this.normal.dot(direction);\r\n\r\n      if (denominator == 0) {\r\n\r\n        // line is coplanar, return origin\r\n        if (this.distanceToPoint(line.start) == 0) {\r\n\r\n          return result.copy(line.start);\r\n\r\n        }\r\n\r\n        // Unsure if this is the correct method to handle this case.\r\n        return undefined;\r\n\r\n      }\r\n\r\n      var t = -(line.start.dot(this.normal) + this.constant) / denominator;\r\n\r\n      if (t < 0 || t > 1) {\r\n\r\n        return undefined;\r\n\r\n      }\r\n\r\n      return result.copy(direction).multiplyScalar(t).add(line.start);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n\r\n  coplanarPoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.copy(this.normal).multiplyScalar(-this.constant);\r\n\r\n  },\r\n\r\n  applyMatrix4: function() {\r\n\r\n    var v1 = new THREE.Vector3();\r\n    var v2 = new THREE.Vector3();\r\n    var m1 = new THREE.Matrix3();\r\n\r\n    return function(matrix, optionalNormalMatrix) {\r\n\r\n      // compute new normal based on theory here:\r\n      // http://www.songho.ca/opengl/gl_normaltransform.html\r\n      var normalMatrix = optionalNormalMatrix || m1.getNormalMatrix(matrix);\r\n      var newNormal = v1.copy(this.normal).applyMatrix3(normalMatrix);\r\n\r\n      var newCoplanarPoint = this.coplanarPoint(v2);\r\n      newCoplanarPoint.applyMatrix4(matrix);\r\n\r\n      this.setFromNormalAndCoplanarPoint(newNormal, newCoplanarPoint);\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translate: function(offset) {\r\n\r\n    this.constant = this.constant - offset.dot(this.normal);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  equals: function(plane) {\r\n\r\n    return plane.normal.equals(this.normal) && (plane.constant == this.constant);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Plane().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n  generateUUID: function() {\r\n\r\n    // http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n    var uuid = new Array(36);\r\n    var rnd = 0,\r\n      r;\r\n\r\n    return function() {\r\n\r\n      for (var i = 0; i < 36; i++) {\r\n\r\n        if (i == 8 || i == 13 || i == 18 || i == 23) {\r\n\r\n          uuid[i] = '-';\r\n\r\n        }\r\n        else if (i == 14) {\r\n\r\n          uuid[i] = '4';\r\n\r\n        }\r\n        else {\r\n\r\n          if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;\r\n          r = rnd & 0xf;\r\n          rnd = rnd >> 4;\r\n          uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n\r\n        }\r\n      }\r\n\r\n      return uuid.join('');\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  // Clamp value to range <a, b>\r\n\r\n  clamp: function(x, a, b) {\r\n\r\n    return (x < a) ? a : ((x > b) ? b : x);\r\n\r\n  },\r\n\r\n  // Clamp value to range <a, inf)\r\n\r\n  clampBottom: function(x, a) {\r\n\r\n    return x < a ? a : x;\r\n\r\n  },\r\n\r\n  // Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n  mapLinear: function(x, a1, a2, b1, b2) {\r\n\r\n    return b1 + (x - a1) * (b2 - b1) / (a2 - a1);\r\n\r\n  },\r\n\r\n  // http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n  smoothstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * (3 - 2 * x);\r\n\r\n  },\r\n\r\n  smootherstep: function(x, min, max) {\r\n\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n\r\n    x = (x - min) / (max - min);\r\n\r\n    return x * x * x * (x * (x * 6 - 15) + 10);\r\n\r\n  },\r\n\r\n  // Random float from <0, 1> with 16 bits of randomness\r\n  // (standard Math.random() creates repetitive patterns when applied over larger space)\r\n\r\n  random16: function() {\r\n\r\n    return (65280 * Math.random() + 255 * Math.random()) / 65535;\r\n\r\n  },\r\n\r\n  // Random integer from <low, high> interval\r\n\r\n  randInt: function(low, high) {\r\n\r\n    return Math.floor(this.randFloat(low, high));\r\n\r\n  },\r\n\r\n  // Random float from <low, high> interval\r\n\r\n  randFloat: function(low, high) {\r\n\r\n    return low + Math.random() * (high - low);\r\n\r\n  },\r\n\r\n  // Random float from <-range/2, range/2> interval\r\n\r\n  randFloatSpread: function(range) {\r\n\r\n    return range * (0.5 - Math.random());\r\n\r\n  },\r\n\r\n  degToRad: function() {\r\n\r\n    var degreeToRadiansFactor = Math.PI / 180;\r\n\r\n    return function(degrees) {\r\n\r\n      return degrees * degreeToRadiansFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  radToDeg: function() {\r\n\r\n    var radianToDegreesFactor = 180 / Math.PI;\r\n\r\n    return function(radians) {\r\n\r\n      return radians * radianToDegreesFactor;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  isPowerOfTwo: function(value) {\r\n\r\n    return (value & (value - 1)) === 0 && value !== 0;\r\n\r\n  },\r\n\r\n  nextPowerOfTwo: function(value) {\r\n\r\n    value--;\r\n    value |= value >> 1;\r\n    value |= value >> 2;\r\n    value |= value >> 4;\r\n    value |= value >> 8;\r\n    value |= value >> 16;\r\n    value++;\r\n\r\n    return value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function(points) {\r\n\r\n  this.points = points;\r\n\r\n  var c = [],\r\n    v3 = {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n    },\r\n    point, intPoint, weight, w2, w3,\r\n    pa, pb, pc, pd;\r\n\r\n  this.initFromArray = function(a) {\r\n\r\n    this.points = [];\r\n\r\n    for (var i = 0; i < a.length; i++) {\r\n\r\n      this.points[i] = {\r\n        x: a[i][0],\r\n        y: a[i][1],\r\n        z: a[i][2]\r\n      };\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.getPoint = function(k) {\r\n\r\n    point = (this.points.length - 1) * k;\r\n    intPoint = Math.floor(point);\r\n    weight = point - intPoint;\r\n\r\n    c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n    c[1] = intPoint;\r\n    c[2] = intPoint > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n    c[3] = intPoint > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n    pa = this.points[c[0]];\r\n    pb = this.points[c[1]];\r\n    pc = this.points[c[2]];\r\n    pd = this.points[c[3]];\r\n\r\n    w2 = weight * weight;\r\n    w3 = weight * w2;\r\n\r\n    v3.x = interpolate(pa.x, pb.x, pc.x, pd.x, weight, w2, w3);\r\n    v3.y = interpolate(pa.y, pb.y, pc.y, pd.y, weight, w2, w3);\r\n    v3.z = interpolate(pa.z, pb.z, pc.z, pd.z, weight, w2, w3);\r\n\r\n    return v3;\r\n\r\n  };\r\n\r\n  this.getControlPointsArray = function() {\r\n\r\n    var i, p, l = this.points.length,\r\n      coords = [];\r\n\r\n    for (i = 0; i < l; i++) {\r\n\r\n      p = this.points[i];\r\n      coords[i] = [p.x, p.y, p.z];\r\n\r\n    }\r\n\r\n    return coords;\r\n\r\n  };\r\n\r\n  // approximate length by summing linear segments\r\n\r\n  this.getLength = function(nSubDivisions) {\r\n\r\n    var i, index, nSamples, position,\r\n      point = 0,\r\n      intPoint = 0,\r\n      oldIntPoint = 0,\r\n      oldPosition = new THREE.Vector3(),\r\n      tmpVec = new THREE.Vector3(),\r\n      chunkLengths = [],\r\n      totalLength = 0;\r\n\r\n    // first point has 0 length\r\n\r\n    chunkLengths[0] = 0;\r\n\r\n    if (!nSubDivisions) nSubDivisions = 100;\r\n\r\n    nSamples = this.points.length * nSubDivisions;\r\n\r\n    oldPosition.copy(this.points[0]);\r\n\r\n    for (i = 1; i < nSamples; i++) {\r\n\r\n      index = i / nSamples;\r\n\r\n      position = this.getPoint(index);\r\n      tmpVec.copy(position);\r\n\r\n      totalLength += tmpVec.distanceTo(oldPosition);\r\n\r\n      oldPosition.copy(position);\r\n\r\n      point = (this.points.length - 1) * index;\r\n      intPoint = Math.floor(point);\r\n\r\n      if (intPoint != oldIntPoint) {\r\n\r\n        chunkLengths[intPoint] = totalLength;\r\n        oldIntPoint = intPoint;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // last point ends with total length\r\n\r\n    chunkLengths[chunkLengths.length] = totalLength;\r\n\r\n    return {\r\n      chunks: chunkLengths,\r\n      total: totalLength\r\n    };\r\n\r\n  };\r\n\r\n  this.reparametrizeByArcLength = function(samplingCoef) {\r\n\r\n    var i, j,\r\n      index, indexCurrent, indexNext,\r\n      realDistance,\r\n      sampling, position,\r\n      newpoints = [],\r\n      tmpVec = new THREE.Vector3(),\r\n      sl = this.getLength();\r\n\r\n    newpoints.push(tmpVec.copy(this.points[0]).clone());\r\n\r\n    for (i = 1; i < this.points.length; i++) {\r\n\r\n      //tmpVec.copy( this.points[ i - 1 ] );\r\n      //linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n      realDistance = sl.chunks[i] - sl.chunks[i - 1];\r\n\r\n      sampling = Math.ceil(samplingCoef * realDistance / sl.total);\r\n\r\n      indexCurrent = (i - 1) / (this.points.length - 1);\r\n      indexNext = i / (this.points.length - 1);\r\n\r\n      for (j = 1; j < sampling - 1; j++) {\r\n\r\n        index = indexCurrent + j * (1 / sampling) * (indexNext - indexCurrent);\r\n\r\n        position = this.getPoint(index);\r\n        newpoints.push(tmpVec.copy(position).clone());\r\n\r\n      }\r\n\r\n      newpoints.push(tmpVec.copy(this.points[i]).clone());\r\n\r\n    }\r\n\r\n    this.points = newpoints;\r\n\r\n  };\r\n\r\n  // Catmull-Rom\r\n\r\n  function interpolate(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n    var v0 = (p2 - p0) * 0.5,\r\n      v1 = (p3 - p1) * 0.5;\r\n\r\n    return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://exocortex.com\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function(a, b, c) {\r\n\r\n  this.a = (a !== undefined) ? a : new THREE.Vector3();\r\n  this.b = (b !== undefined) ? b : new THREE.Vector3();\r\n  this.c = (c !== undefined) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n\r\n  return function(a, b, c, optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    result.subVectors(c, b);\r\n    v0.subVectors(a, b);\r\n    result.cross(v0);\r\n\r\n    var resultLengthSq = result.lengthSq();\r\n    if (resultLengthSq > 0) {\r\n\r\n      return result.multiplyScalar(1 / Math.sqrt(resultLengthSq));\r\n\r\n    }\r\n\r\n    return result.set(0, 0, 0);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycoordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function() {\r\n\r\n  var v0 = new THREE.Vector3();\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c, optionalTarget) {\r\n\r\n    v0.subVectors(c, a);\r\n    v1.subVectors(b, a);\r\n    v2.subVectors(point, a);\r\n\r\n    var dot00 = v0.dot(v0);\r\n    var dot01 = v0.dot(v1);\r\n    var dot02 = v0.dot(v2);\r\n    var dot11 = v1.dot(v1);\r\n    var dot12 = v1.dot(v2);\r\n\r\n    var denom = (dot00 * dot11 - dot01 * dot01);\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    // colinear or singular triangle\r\n    if (denom == 0) {\r\n      // arbitrary location outside of triangle?\r\n      // not sure if this is the best idea, maybe should be returning undefined\r\n      return result.set(-2, -1, -1);\r\n    }\r\n\r\n    var invDenom = 1 / denom;\r\n    var u = (dot11 * dot02 - dot01 * dot12) * invDenom;\r\n    var v = (dot00 * dot12 - dot01 * dot02) * invDenom;\r\n\r\n    // barycoordinates must always sum to 1\r\n    return result.set(1 - u - v, v, u);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(point, a, b, c) {\r\n\r\n    var result = THREE.Triangle.barycoordFromPoint(point, a, b, c, v1);\r\n\r\n    return (result.x >= 0) && (result.y >= 0) && ((result.x + result.y) <= 1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n  constructor: THREE.Triangle,\r\n\r\n  set: function(a, b, c) {\r\n\r\n    this.a.copy(a);\r\n    this.b.copy(b);\r\n    this.c.copy(c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setFromPointsAndIndices: function(points, i0, i1, i2) {\r\n\r\n    this.a.copy(points[i0]);\r\n    this.b.copy(points[i1]);\r\n    this.c.copy(points[i2]);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  copy: function(triangle) {\r\n\r\n    this.a.copy(triangle.a);\r\n    this.b.copy(triangle.b);\r\n    this.c.copy(triangle.c);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  area: function() {\r\n\r\n    var v0 = new THREE.Vector3();\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      v0.subVectors(this.c, this.b);\r\n      v1.subVectors(this.a, this.b);\r\n\r\n      return v0.cross(v1).length() * 0.5;\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  midpoint: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n    return result.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3);\r\n\r\n  },\r\n\r\n  normal: function(optionalTarget) {\r\n\r\n    return THREE.Triangle.normal(this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  plane: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Plane();\r\n\r\n    return result.setFromCoplanarPoints(this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  barycoordFromPoint: function(point, optionalTarget) {\r\n\r\n    return THREE.Triangle.barycoordFromPoint(point, this.a, this.b, this.c, optionalTarget);\r\n\r\n  },\r\n\r\n  containsPoint: function(point) {\r\n\r\n    return THREE.Triangle.containsPoint(point, this.a, this.b, this.c);\r\n\r\n  },\r\n\r\n  equals: function(triangle) {\r\n\r\n    return triangle.a.equals(this.a) && triangle.b.equals(this.b) && triangle.c.equals(this.c);\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.Triangle().copy(this);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function(autoStart) {\r\n\r\n  this.autoStart = (autoStart !== undefined) ? autoStart : true;\r\n\r\n  this.startTime = 0;\r\n  this.oldTime = 0;\r\n  this.elapsedTime = 0;\r\n\r\n  this.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n  constructor: THREE.Clock,\r\n\r\n  start: function() {\r\n\r\n    this.startTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n    this.oldTime = this.startTime;\r\n    this.running = true;\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.getElapsedTime();\r\n    this.running = false;\r\n\r\n  },\r\n\r\n  getElapsedTime: function() {\r\n\r\n    this.getDelta();\r\n    return this.elapsedTime;\r\n\r\n  },\r\n\r\n  getDelta: function() {\r\n\r\n    var diff = 0;\r\n\r\n    if (this.autoStart && !this.running) {\r\n\r\n      this.start();\r\n\r\n    }\r\n\r\n    if (this.running) {\r\n\r\n      var newTime = self.performance !== undefined && self.performance.now !== undefined ? self.performance.now() : Date.now();\r\n\r\n      diff = 0.001 * (newTime - this.oldTime);\r\n      this.oldTime = newTime;\r\n\r\n      this.elapsedTime += diff;\r\n\r\n    }\r\n\r\n    return diff;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function() {}\r\n\r\nTHREE.EventDispatcher.prototype = {\r\n\r\n  constructor: THREE.EventDispatcher,\r\n\r\n  apply: function(object) {\r\n\r\n    object.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\r\n    object.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\r\n    object.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\r\n    object.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\r\n\r\n  },\r\n\r\n  addEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) this._listeners = {};\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] === undefined) {\r\n\r\n      listeners[type] = [];\r\n\r\n    }\r\n\r\n    if (listeners[type].indexOf(listener) === -1) {\r\n\r\n      listeners[type].push(listener);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  hasEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return false;\r\n\r\n    var listeners = this._listeners;\r\n\r\n    if (listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  removeEventListener: function(type, listener) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      var index = listenerArray.indexOf(listener);\r\n\r\n      if (index !== -1) {\r\n\r\n        listenerArray.splice(index, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  dispatchEvent: function(event) {\r\n\r\n    if (this._listeners === undefined) return;\r\n\r\n    var listeners = this._listeners;\r\n    var listenerArray = listeners[event.type];\r\n\r\n    if (listenerArray !== undefined) {\r\n\r\n      event.target = this;\r\n\r\n      var array = [];\r\n      var length = listenerArray.length;\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i] = listenerArray[i];\r\n\r\n      }\r\n\r\n      for (var i = 0; i < length; i++) {\r\n\r\n        array[i].call(this, event);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://exocortex.com/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n(function(THREE) {\r\n\r\n  THREE.Raycaster = function(origin, direction, near, far) {\r\n\r\n    this.ray = new THREE.Ray(origin, direction);\r\n    // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n    this.near = near || 0;\r\n    this.far = far || Infinity;\r\n\r\n    this.params = {\r\n      Sprite: {},\r\n      Mesh: {},\r\n      PointCloud: {\r\n        threshold: 1\r\n      },\r\n      LOD: {},\r\n      Line: {}\r\n    };\r\n\r\n  };\r\n\r\n  var descSort = function(a, b) {\r\n\r\n    return a.distance - b.distance;\r\n\r\n  };\r\n\r\n  var intersectObject = function(object, raycaster, intersects, recursive) {\r\n\r\n    object.raycast(raycaster, intersects);\r\n\r\n    if (recursive === true) {\r\n\r\n      var children = object.children;\r\n\r\n      for (var i = 0, l = children.length; i < l; i++) {\r\n\r\n        intersectObject(children[i], raycaster, intersects, true);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  //\r\n\r\n  THREE.Raycaster.prototype = {\r\n\r\n    constructor: THREE.Raycaster,\r\n\r\n    precision: 0.0001,\r\n    linePrecision: 1,\r\n\r\n    set: function(origin, direction) {\r\n\r\n      // direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n      this.ray.set(origin, direction);\r\n\r\n    },\r\n\r\n    setFromCamera: function(coords, camera) {\r\n\r\n      // camera is assumed _not_ to be a child of a transformed object\r\n\r\n      if (camera instanceof THREE.PerspectiveCamera) {\r\n\r\n        this.ray.origin.copy(camera.position);\r\n        this.ray.direction.set(coords.x, coords.y, 0.5).unproject(camera).sub(camera.position).normalize();\r\n\r\n      }\r\n      else if (camera instanceof THREE.OrthographicCamera) {\r\n\r\n        this.ray.origin.set(coords.x, coords.y, -1).unproject(camera);\r\n        this.ray.direction.set(0, 0, -1).transformDirection(camera.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.Raycaster: Unsupported camera type.');\r\n\r\n      }\r\n\r\n    },\r\n\r\n    intersectObject: function(object, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      intersectObject(object, this, intersects, recursive);\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    },\r\n\r\n    intersectObjects: function(objects, recursive) {\r\n\r\n      var intersects = [];\r\n\r\n      if (objects instanceof Array === false) {\r\n\r\n        THREE.warn('THREE.Raycaster.intersectObjects: objects is not an Array.');\r\n        return intersects;\r\n\r\n      }\r\n\r\n      for (var i = 0, l = objects.length; i < l; i++) {\r\n\r\n        intersectObject(objects[i], this, intersects, recursive);\r\n\r\n      }\r\n\r\n      intersects.sort(descSort);\r\n\r\n      return intersects;\r\n\r\n    }\r\n\r\n  };\r\n\r\n}(THREE));\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Object3D = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.Object3DIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Object3D';\r\n\r\n  this.parent = undefined;\r\n  this.children = [];\r\n\r\n  this.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n  var position = new THREE.Vector3();\r\n  var rotation = new THREE.Euler();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3(1, 1, 1);\r\n\r\n  var onRotationChange = function() {\r\n    quaternion.setFromEuler(rotation, false);\r\n  };\r\n\r\n  var onQuaternionChange = function() {\r\n    rotation.setFromQuaternion(quaternion, undefined, false);\r\n  };\r\n\r\n  rotation.onChange(onRotationChange);\r\n  quaternion.onChange(onQuaternionChange);\r\n\r\n  Object.defineProperties(this, {\r\n    position: {\r\n      enumerable: true,\r\n      value: position\r\n    },\r\n    rotation: {\r\n      enumerable: true,\r\n      value: rotation\r\n    },\r\n    quaternion: {\r\n      enumerable: true,\r\n      value: quaternion\r\n    },\r\n    scale: {\r\n      enumerable: true,\r\n      value: scale\r\n    }\r\n  });\r\n\r\n  this.rotationAutoUpdate = true;\r\n\r\n  this.matrix = new THREE.Matrix4();\r\n  this.matrixWorld = new THREE.Matrix4();\r\n\r\n  this.matrixAutoUpdate = true;\r\n  this.matrixWorldNeedsUpdate = false;\r\n\r\n  this.visible = true;\r\n\r\n  this.castShadow = false;\r\n  this.receiveShadow = false;\r\n\r\n  this.frustumCulled = true;\r\n  this.renderOrder = 0;\r\n\r\n  this.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3(0, 1, 0);\r\n\r\nTHREE.Object3D.prototype = {\r\n\r\n  constructor: THREE.Object3D,\r\n\r\n  get eulerOrder() {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    return this.rotation.order;\r\n\r\n  },\r\n\r\n  set eulerOrder(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');\r\n\r\n    this.rotation.order = value;\r\n\r\n  },\r\n\r\n  get useQuaternion() {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  set useQuaternion(value) {\r\n\r\n    THREE.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    this.matrix.multiplyMatrices(matrix, this.matrix);\r\n\r\n    this.matrix.decompose(this.position, this.quaternion, this.scale);\r\n\r\n  },\r\n\r\n  setRotationFromAxisAngle: function(axis, angle) {\r\n\r\n    // assumes axis is normalized\r\n\r\n    this.quaternion.setFromAxisAngle(axis, angle);\r\n\r\n  },\r\n\r\n  setRotationFromEuler: function(euler) {\r\n\r\n    this.quaternion.setFromEuler(euler, true);\r\n\r\n  },\r\n\r\n  setRotationFromMatrix: function(m) {\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    this.quaternion.setFromRotationMatrix(m);\r\n\r\n  },\r\n\r\n  setRotationFromQuaternion: function(q) {\r\n\r\n    // assumes q is normalized\r\n\r\n    this.quaternion.copy(q);\r\n\r\n  },\r\n\r\n  rotateOnAxis: function() {\r\n\r\n    // rotate object on axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var q1 = new THREE.Quaternion();\r\n\r\n    return function(axis, angle) {\r\n\r\n      q1.setFromAxisAngle(axis, angle);\r\n\r\n      this.quaternion.multiply(q1);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  rotateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  rotateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(angle) {\r\n\r\n      return this.rotateOnAxis(v1, angle);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateOnAxis: function() {\r\n\r\n    // translate object by distance along axis in object space\r\n    // axis is assumed to be normalized\r\n\r\n    var v1 = new THREE.Vector3();\r\n\r\n    return function(axis, distance) {\r\n\r\n      v1.copy(axis).applyQuaternion(this.quaternion);\r\n\r\n      this.position.add(v1.multiplyScalar(distance));\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  translate: function(distance, axis) {\r\n\r\n    THREE.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.');\r\n    return this.translateOnAxis(axis, distance);\r\n\r\n  },\r\n\r\n  translateX: function() {\r\n\r\n    var v1 = new THREE.Vector3(1, 0, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateY: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 1, 0);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  translateZ: function() {\r\n\r\n    var v1 = new THREE.Vector3(0, 0, 1);\r\n\r\n    return function(distance) {\r\n\r\n      return this.translateOnAxis(v1, distance);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  localToWorld: function(vector) {\r\n\r\n    return vector.applyMatrix4(this.matrixWorld);\r\n\r\n  },\r\n\r\n  worldToLocal: function() {\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      return vector.applyMatrix4(m1.getInverse(this.matrixWorld));\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  lookAt: function() {\r\n\r\n    // This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n    var m1 = new THREE.Matrix4();\r\n\r\n    return function(vector) {\r\n\r\n      m1.lookAt(vector, this.position, this.up);\r\n\r\n      this.quaternion.setFromRotationMatrix(m1);\r\n\r\n    };\r\n\r\n  }(),\r\n\r\n  add: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.add(arguments[i]);\r\n\r\n      }\r\n\r\n      return this;\r\n\r\n    };\r\n\r\n    if (object === this) {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object can't be added as a child of itself.\", object);\r\n      return this;\r\n\r\n    }\r\n\r\n    if (object instanceof THREE.Object3D) {\r\n\r\n      if (object.parent !== undefined) {\r\n\r\n        object.parent.remove(object);\r\n\r\n      }\r\n\r\n      object.parent = this;\r\n      object.dispatchEvent({\r\n        type: 'added'\r\n      });\r\n\r\n      this.children.push(object);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.error(\"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object);\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  remove: function(object) {\r\n\r\n    if (arguments.length > 1) {\r\n\r\n      for (var i = 0; i < arguments.length; i++) {\r\n\r\n        this.remove(arguments[i]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    var index = this.children.indexOf(object);\r\n\r\n    if (index !== -1) {\r\n\r\n      object.parent = undefined;\r\n\r\n      object.dispatchEvent({\r\n        type: 'removed'\r\n      });\r\n\r\n      this.children.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getChildByName: function(name) {\r\n\r\n    THREE.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().');\r\n    return this.getObjectByName(name);\r\n\r\n  },\r\n\r\n  getObjectById: function(id) {\r\n\r\n    return this.getObjectByProperty('id', id);\r\n\r\n  },\r\n\r\n  getObjectByName: function(name) {\r\n\r\n    return this.getObjectByProperty('name', name);\r\n\r\n  },\r\n\r\n  getObjectByProperty: function(name, value) {\r\n\r\n    if (this[name] === value) return this;\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      var child = this.children[i];\r\n      var object = child.getObjectByProperty(name, value);\r\n\r\n      if (object !== undefined) {\r\n\r\n        return object;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return undefined;\r\n\r\n  },\r\n\r\n  getWorldPosition: function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    return result.setFromMatrixPosition(this.matrixWorld);\r\n\r\n  },\r\n\r\n  getWorldQuaternion: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var scale = new THREE.Vector3();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Quaternion();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, result, scale);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldRotation: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Euler();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.setFromQuaternion(quaternion, this.rotation.order, false);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldScale: function() {\r\n\r\n    var position = new THREE.Vector3();\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.updateMatrixWorld(true);\r\n\r\n      this.matrixWorld.decompose(position, quaternion, result);\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  getWorldDirection: function() {\r\n\r\n    var quaternion = new THREE.Quaternion();\r\n\r\n    return function(optionalTarget) {\r\n\r\n      var result = optionalTarget || new THREE.Vector3();\r\n\r\n      this.getWorldQuaternion(quaternion);\r\n\r\n      return result.set(0, 0, 1).applyQuaternion(quaternion);\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  raycast: function() {},\r\n\r\n  traverse: function(callback) {\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverse(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseVisible: function(callback) {\r\n\r\n    if (this.visible === false) return;\r\n\r\n    callback(this);\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].traverseVisible(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  traverseAncestors: function(callback) {\r\n\r\n    if (this.parent) {\r\n\r\n      callback(this.parent);\r\n\r\n      this.parent.traverseAncestors(callback);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  updateMatrix: function() {\r\n\r\n    this.matrix.compose(this.position, this.quaternion, this.scale);\r\n\r\n    this.matrixWorldNeedsUpdate = true;\r\n\r\n  },\r\n\r\n  updateMatrixWorld: function(force) {\r\n\r\n    if (this.matrixAutoUpdate === true) this.updateMatrix();\r\n\r\n    if (this.matrixWorldNeedsUpdate === true || force === true) {\r\n\r\n      if (this.parent === undefined) {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n      }\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.3,\r\n        type: 'Object',\r\n        generator: 'ObjectExporter'\r\n      }\r\n    };\r\n\r\n    //\r\n\r\n    var geometries = {};\r\n\r\n    var parseGeometry = function(geometry) {\r\n\r\n      if (output.geometries === undefined) {\r\n\r\n        output.geometries = [];\r\n\r\n      }\r\n\r\n      if (geometries[geometry.uuid] === undefined) {\r\n\r\n        var json = geometry.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        geometries[geometry.uuid] = json;\r\n\r\n        output.geometries.push(json);\r\n\r\n      }\r\n\r\n      return geometry.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var materials = {};\r\n\r\n    var parseMaterial = function(material) {\r\n\r\n      if (output.materials === undefined) {\r\n\r\n        output.materials = [];\r\n\r\n      }\r\n\r\n      if (materials[material.uuid] === undefined) {\r\n\r\n        var json = material.toJSON();\r\n\r\n        delete json.metadata;\r\n\r\n        materials[material.uuid] = json;\r\n\r\n        output.materials.push(json);\r\n\r\n      }\r\n\r\n      return material.uuid;\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var parseObject = function(object) {\r\n\r\n      var data = {};\r\n\r\n      data.uuid = object.uuid;\r\n      data.type = object.type;\r\n\r\n      if (object.name !== '') data.name = object.name;\r\n      if (JSON.stringify(object.userData) !== '{}') data.userData = object.userData;\r\n      if (object.visible !== true) data.visible = object.visible;\r\n\r\n      if (object instanceof THREE.PerspectiveCamera) {\r\n\r\n        data.fov = object.fov;\r\n        data.aspect = object.aspect;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.OrthographicCamera) {\r\n\r\n        data.left = object.left;\r\n        data.right = object.right;\r\n        data.top = object.top;\r\n        data.bottom = object.bottom;\r\n        data.near = object.near;\r\n        data.far = object.far;\r\n\r\n      }\r\n      else if (object instanceof THREE.AmbientLight) {\r\n\r\n        data.color = object.color.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.DirectionalLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n\r\n      }\r\n      else if (object instanceof THREE.PointLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.SpotLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.intensity = object.intensity;\r\n        data.distance = object.distance;\r\n        data.angle = object.angle;\r\n        data.exponent = object.exponent;\r\n        data.decay = object.decay;\r\n\r\n      }\r\n      else if (object instanceof THREE.HemisphereLight) {\r\n\r\n        data.color = object.color.getHex();\r\n        data.groundColor = object.groundColor.getHex();\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        data.geometry = parseGeometry(object.geometry);\r\n        data.material = parseMaterial(object.material);\r\n\r\n        if (object instanceof THREE.Line) data.mode = object.mode;\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        data.material = parseMaterial(object.material);\r\n\r\n      }\r\n\r\n      data.matrix = object.matrix.toArray();\r\n\r\n      if (object.children.length > 0) {\r\n\r\n        data.children = [];\r\n\r\n        for (var i = 0; i < object.children.length; i++) {\r\n\r\n          data.children.push(parseObject(object.children[i]));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return data;\r\n\r\n    }\r\n\r\n    output.object = parseObject(this);\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(object, recursive) {\r\n\r\n    if (object === undefined) object = new THREE.Object3D();\r\n    if (recursive === undefined) recursive = true;\r\n\r\n    object.name = this.name;\r\n\r\n    object.up.copy(this.up);\r\n\r\n    object.position.copy(this.position);\r\n    object.quaternion.copy(this.quaternion);\r\n    object.scale.copy(this.scale);\r\n\r\n    object.rotationAutoUpdate = this.rotationAutoUpdate;\r\n\r\n    object.matrix.copy(this.matrix);\r\n    object.matrixWorld.copy(this.matrixWorld);\r\n\r\n    object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n    object.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate;\r\n\r\n    object.visible = this.visible;\r\n\r\n    object.castShadow = this.castShadow;\r\n    object.receiveShadow = this.receiveShadow;\r\n\r\n    object.frustumCulled = this.frustumCulled;\r\n\r\n    object.userData = JSON.parse(JSON.stringify(this.userData));\r\n\r\n    if (recursive === true) {\r\n\r\n      for (var i = 0; i < this.children.length; i++) {\r\n\r\n        var child = this.children[i];\r\n        object.add(child.clone());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function(a, b, c, normal, color, materialIndex) {\r\n\r\n  this.a = a;\r\n  this.b = b;\r\n  this.c = c;\r\n\r\n  this.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n  this.vertexNormals = normal instanceof Array ? normal : [];\r\n\r\n  this.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n  this.vertexColors = color instanceof Array ? color : [];\r\n\r\n  this.vertexTangents = [];\r\n\r\n  this.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n  constructor: THREE.Face3,\r\n\r\n  clone: function() {\r\n\r\n    var face = new THREE.Face3(this.a, this.b, this.c);\r\n\r\n    face.normal.copy(this.normal);\r\n    face.color.copy(this.color);\r\n\r\n    face.materialIndex = this.materialIndex;\r\n\r\n    for (var i = 0, il = this.vertexNormals.length; i < il; i++) {\r\n\r\n      face.vertexNormals[i] = this.vertexNormals[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexColors.length; i < il; i++) {\r\n\r\n      face.vertexColors[i] = this.vertexColors[i].clone();\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.vertexTangents.length; i < il; i++) {\r\n\r\n      face.vertexTangents[i] = this.vertexTangents[i].clone();\r\n\r\n    }\r\n\r\n    return face;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/core/Face4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Face4 = function(a, b, c, d, normal, color, materialIndex) {\r\n\r\n  THREE.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.')\r\n  return new THREE.Face3(a, b, c, normal, color, materialIndex);\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function(array, itemSize) {\r\n\r\n  this.array = array;\r\n  this.itemSize = itemSize;\r\n\r\n  this.needsUpdate = false;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n  constructor: THREE.BufferAttribute,\r\n\r\n  get length() {\r\n\r\n    return this.array.length;\r\n\r\n  },\r\n\r\n  copyAt: function(index1, attribute, index2) {\r\n\r\n    index1 *= this.itemSize;\r\n    index2 *= attribute.itemSize;\r\n\r\n    for (var i = 0, l = this.itemSize; i < l; i++) {\r\n\r\n      this.array[index1 + i] = attribute.array[index2 + i];\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  set: function(value, offset) {\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    this.array.set(value, offset);\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setX: function(index, x) {\r\n\r\n    this.array[index * this.itemSize] = x;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setY: function(index, y) {\r\n\r\n    this.array[index * this.itemSize + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setZ: function(index, z) {\r\n\r\n    this.array[index * this.itemSize + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXY: function(index, x, y) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZ: function(index, x, y, z) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  setXYZW: function(index, x, y, z, w) {\r\n\r\n    index *= this.itemSize;\r\n\r\n    this.array[index] = x;\r\n    this.array[index + 1] = y;\r\n    this.array[index + 2] = z;\r\n    this.array[index + 3] = w;\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    return new THREE.BufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n  }\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function(data, itemSize) {\r\n\r\n  THREE.warn('THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.');\r\n  return new THREE.BufferAttribute(data, itemSize);\r\n\r\n};\r\n\r\n// File:src/core/DynamicBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DynamicBufferAttribute = function(array, itemSize) {\r\n\r\n  THREE.BufferAttribute.call(this, array, itemSize);\r\n\r\n  this.updateRange = {\r\n    offset: 0,\r\n    count: -1\r\n  };\r\n\r\n};\r\n\r\nTHREE.DynamicBufferAttribute.prototype = Object.create(THREE.BufferAttribute.prototype);\r\nTHREE.DynamicBufferAttribute.prototype.constructor = THREE.DynamicBufferAttribute;\r\n\r\nTHREE.DynamicBufferAttribute.prototype.clone = function() {\r\n\r\n  return new THREE.DynamicBufferAttribute(new this.array.constructor(this.array), this.itemSize);\r\n\r\n};\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'BufferGeometry';\r\n\r\n  this.attributes = {};\r\n  this.attributesKeys = [];\r\n\r\n  this.drawcalls = [];\r\n  this.offsets = this.drawcalls; // backwards compatibility\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n};\r\n\r\nTHREE.BufferGeometry.prototype = {\r\n\r\n  constructor: THREE.BufferGeometry,\r\n\r\n  addAttribute: function(name, attribute) {\r\n\r\n    if (attribute instanceof THREE.BufferAttribute === false) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).');\r\n\r\n      this.attributes[name] = {\r\n        array: arguments[1],\r\n        itemSize: arguments[2]\r\n      };\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    this.attributes[name] = attribute;\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n  },\r\n\r\n  getAttribute: function(name) {\r\n\r\n    return this.attributes[name];\r\n\r\n  },\r\n\r\n  addDrawCall: function(start, count, indexOffset) {\r\n\r\n    this.drawcalls.push({\r\n\r\n      start: start,\r\n      count: count,\r\n      index: indexOffset !== undefined ? indexOffset : 0\r\n\r\n    });\r\n\r\n  },\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var position = this.attributes.position;\r\n\r\n    if (position !== undefined) {\r\n\r\n      matrix.applyToVector3Array(position.array);\r\n      position.needsUpdate = true;\r\n\r\n    }\r\n\r\n    var normal = this.attributes.normal;\r\n\r\n    if (normal !== undefined) {\r\n\r\n      var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n      normalMatrix.applyToVector3Array(normal.array);\r\n      normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  fromGeometry: function(geometry, settings) {\r\n\r\n    settings = settings || {\r\n      'vertexColors': THREE.NoColors\r\n    };\r\n\r\n    var vertices = geometry.vertices;\r\n    var faces = geometry.faces;\r\n    var faceVertexUvs = geometry.faceVertexUvs;\r\n    var vertexColors = settings.vertexColors;\r\n    var hasFaceVertexUv = faceVertexUvs[0].length > 0;\r\n    var hasFaceVertexNormals = faces[0].vertexNormals.length == 3;\r\n\r\n    var positions = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('position', new THREE.BufferAttribute(positions, 3));\r\n\r\n    var normals = new Float32Array(faces.length * 3 * 3);\r\n    this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n\r\n    if (vertexColors !== THREE.NoColors) {\r\n\r\n      var colors = new Float32Array(faces.length * 3 * 3);\r\n      this.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n    }\r\n\r\n    if (hasFaceVertexUv === true) {\r\n\r\n      var uvs = new Float32Array(faces.length * 3 * 2);\r\n      this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n    }\r\n\r\n    for (var i = 0, i2 = 0, i3 = 0; i < faces.length; i++, i2 += 6, i3 += 9) {\r\n\r\n      var face = faces[i];\r\n\r\n      var a = vertices[face.a];\r\n      var b = vertices[face.b];\r\n      var c = vertices[face.c];\r\n\r\n      positions[i3] = a.x;\r\n      positions[i3 + 1] = a.y;\r\n      positions[i3 + 2] = a.z;\r\n\r\n      positions[i3 + 3] = b.x;\r\n      positions[i3 + 4] = b.y;\r\n      positions[i3 + 5] = b.z;\r\n\r\n      positions[i3 + 6] = c.x;\r\n      positions[i3 + 7] = c.y;\r\n      positions[i3 + 8] = c.z;\r\n\r\n      if (hasFaceVertexNormals === true) {\r\n\r\n        var na = face.vertexNormals[0];\r\n        var nb = face.vertexNormals[1];\r\n        var nc = face.vertexNormals[2];\r\n\r\n        normals[i3] = na.x;\r\n        normals[i3 + 1] = na.y;\r\n        normals[i3 + 2] = na.z;\r\n\r\n        normals[i3 + 3] = nb.x;\r\n        normals[i3 + 4] = nb.y;\r\n        normals[i3 + 5] = nb.z;\r\n\r\n        normals[i3 + 6] = nc.x;\r\n        normals[i3 + 7] = nc.y;\r\n        normals[i3 + 8] = nc.z;\r\n\r\n      }\r\n      else {\r\n\r\n        var n = face.normal;\r\n\r\n        normals[i3] = n.x;\r\n        normals[i3 + 1] = n.y;\r\n        normals[i3 + 2] = n.z;\r\n\r\n        normals[i3 + 3] = n.x;\r\n        normals[i3 + 4] = n.y;\r\n        normals[i3 + 5] = n.z;\r\n\r\n        normals[i3 + 6] = n.x;\r\n        normals[i3 + 7] = n.y;\r\n        normals[i3 + 8] = n.z;\r\n\r\n      }\r\n\r\n      if (vertexColors === THREE.FaceColors) {\r\n\r\n        var fc = face.color;\r\n\r\n        colors[i3] = fc.r;\r\n        colors[i3 + 1] = fc.g;\r\n        colors[i3 + 2] = fc.b;\r\n\r\n        colors[i3 + 3] = fc.r;\r\n        colors[i3 + 4] = fc.g;\r\n        colors[i3 + 5] = fc.b;\r\n\r\n        colors[i3 + 6] = fc.r;\r\n        colors[i3 + 7] = fc.g;\r\n        colors[i3 + 8] = fc.b;\r\n\r\n      }\r\n      else if (vertexColors === THREE.VertexColors) {\r\n\r\n        var vca = face.vertexColors[0];\r\n        var vcb = face.vertexColors[1];\r\n        var vcc = face.vertexColors[2];\r\n\r\n        colors[i3] = vca.r;\r\n        colors[i3 + 1] = vca.g;\r\n        colors[i3 + 2] = vca.b;\r\n\r\n        colors[i3 + 3] = vcb.r;\r\n        colors[i3 + 4] = vcb.g;\r\n        colors[i3 + 5] = vcb.b;\r\n\r\n        colors[i3 + 6] = vcc.r;\r\n        colors[i3 + 7] = vcc.g;\r\n        colors[i3 + 8] = vcc.b;\r\n\r\n      }\r\n\r\n      if (hasFaceVertexUv === true) {\r\n\r\n        var uva = faceVertexUvs[0][i][0];\r\n        var uvb = faceVertexUvs[0][i][1];\r\n        var uvc = faceVertexUvs[0][i][2];\r\n\r\n        uvs[i2] = uva.x;\r\n        uvs[i2 + 1] = uva.y;\r\n\r\n        uvs[i2 + 2] = uvb.x;\r\n        uvs[i2 + 3] = uvb.y;\r\n\r\n        uvs[i2 + 4] = uvc.x;\r\n        uvs[i2 + 5] = uvc.y;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeBoundingSphere()\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingBox === null) {\r\n\r\n        this.boundingBox = new THREE.Box3();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        var bb = this.boundingBox;\r\n        bb.makeEmpty();\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          bb.expandByPoint(vector);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (positions === undefined || positions.length === 0) {\r\n\r\n        this.boundingBox.min.set(0, 0, 0);\r\n        this.boundingBox.max.set(0, 0, 0);\r\n\r\n      }\r\n\r\n      if (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) {\r\n\r\n        THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    var box = new THREE.Box3();\r\n    var vector = new THREE.Vector3();\r\n\r\n    return function() {\r\n\r\n      if (this.boundingSphere === null) {\r\n\r\n        this.boundingSphere = new THREE.Sphere();\r\n\r\n      }\r\n\r\n      var positions = this.attributes.position.array;\r\n\r\n      if (positions) {\r\n\r\n        box.makeEmpty();\r\n\r\n        var center = this.boundingSphere.center;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          box.expandByPoint(vector);\r\n\r\n        }\r\n\r\n        box.center(center);\r\n\r\n        // hoping to find a boundingSphere with a radius smaller than the\r\n        // boundingSphere of the boundingBox:  sqrt(3) smaller in the best case\r\n\r\n        var maxRadiusSq = 0;\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 3) {\r\n\r\n          vector.set(positions[i], positions[i + 1], positions[i + 2]);\r\n          maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n\r\n        }\r\n\r\n        this.boundingSphere.radius = Math.sqrt(maxRadiusSq);\r\n\r\n        if (isNaN(this.boundingSphere.radius)) {\r\n\r\n          THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.');\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }(),\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    // backwards compatibility\r\n\r\n  },\r\n\r\n  computeVertexNormals: function() {\r\n\r\n    var attributes = this.attributes;\r\n\r\n    if (attributes.position) {\r\n\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.normal === undefined) {\r\n\r\n        this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(positions.length), 3));\r\n\r\n      }\r\n      else {\r\n\r\n        // reset existing normals to zero\r\n\r\n        var normals = attributes.normal.array;\r\n\r\n        for (var i = 0, il = normals.length; i < il; i++) {\r\n\r\n          normals[i] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var normals = attributes.normal.array;\r\n\r\n      var vA, vB, vC,\r\n\r\n        pA = new THREE.Vector3(),\r\n        pB = new THREE.Vector3(),\r\n        pC = new THREE.Vector3(),\r\n\r\n        cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      // indexed elements\r\n\r\n      if (attributes.index) {\r\n\r\n        var indices = attributes.index.array;\r\n\r\n        var offsets = (this.offsets.length > 0 ? this.offsets : [{\r\n          start: 0,\r\n          count: indices.length,\r\n          index: 0\r\n        }]);\r\n\r\n        for (var j = 0, jl = offsets.length; j < jl; ++j) {\r\n\r\n          var start = offsets[j].start;\r\n          var count = offsets[j].count;\r\n          var index = offsets[j].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            vA = (index + indices[i]) * 3;\r\n            vB = (index + indices[i + 1]) * 3;\r\n            vC = (index + indices[i + 2]) * 3;\r\n\r\n            pA.fromArray(positions, vA);\r\n            pB.fromArray(positions, vB);\r\n            pC.fromArray(positions, vC);\r\n\r\n            cb.subVectors(pC, pB);\r\n            ab.subVectors(pA, pB);\r\n            cb.cross(ab);\r\n\r\n            normals[vA] += cb.x;\r\n            normals[vA + 1] += cb.y;\r\n            normals[vA + 2] += cb.z;\r\n\r\n            normals[vB] += cb.x;\r\n            normals[vB + 1] += cb.y;\r\n            normals[vB + 2] += cb.z;\r\n\r\n            normals[vC] += cb.x;\r\n            normals[vC + 1] += cb.y;\r\n            normals[vC + 2] += cb.z;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed elements (unconnected triangle soup)\r\n\r\n        for (var i = 0, il = positions.length; i < il; i += 9) {\r\n\r\n          pA.fromArray(positions, i);\r\n          pB.fromArray(positions, i + 3);\r\n          pC.fromArray(positions, i + 6);\r\n\r\n          cb.subVectors(pC, pB);\r\n          ab.subVectors(pA, pB);\r\n          cb.cross(ab);\r\n\r\n          normals[i] = cb.x;\r\n          normals[i + 1] = cb.y;\r\n          normals[i + 2] = cb.z;\r\n\r\n          normals[i + 3] = cb.x;\r\n          normals[i + 4] = cb.y;\r\n          normals[i + 5] = cb.z;\r\n\r\n          normals[i + 6] = cb.x;\r\n          normals[i + 7] = cb.y;\r\n          normals[i + 8] = cb.z;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.normalizeNormals();\r\n\r\n      attributes.normal.needsUpdate = true;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // (per vertex tangents)\r\n\r\n    if (this.attributes.index === undefined ||\r\n      this.attributes.position === undefined ||\r\n      this.attributes.normal === undefined ||\r\n      this.attributes.uv === undefined) {\r\n\r\n      THREE.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');\r\n      return;\r\n\r\n    }\r\n\r\n    var indices = this.attributes.index.array;\r\n    var positions = this.attributes.position.array;\r\n    var normals = this.attributes.normal.array;\r\n    var uvs = this.attributes.uv.array;\r\n\r\n    var nVertices = positions.length / 3;\r\n\r\n    if (this.attributes.tangent === undefined) {\r\n\r\n      this.addAttribute('tangent', new THREE.BufferAttribute(new Float32Array(4 * nVertices), 4));\r\n\r\n    }\r\n\r\n    var tangents = this.attributes.tangent.array;\r\n\r\n    var tan1 = [],\r\n      tan2 = [];\r\n\r\n    for (var k = 0; k < nVertices; k++) {\r\n\r\n      tan1[k] = new THREE.Vector3();\r\n      tan2[k] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var vA = new THREE.Vector3(),\r\n      vB = new THREE.Vector3(),\r\n      vC = new THREE.Vector3(),\r\n\r\n      uvA = new THREE.Vector2(),\r\n      uvB = new THREE.Vector2(),\r\n      uvC = new THREE.Vector2(),\r\n\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r;\r\n\r\n    var sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3();\r\n\r\n    function handleTriangle(a, b, c) {\r\n\r\n      vA.fromArray(positions, a * 3);\r\n      vB.fromArray(positions, b * 3);\r\n      vC.fromArray(positions, c * 3);\r\n\r\n      uvA.fromArray(uvs, a * 2);\r\n      uvB.fromArray(uvs, b * 2);\r\n      uvC.fromArray(uvs, c * 2);\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n\r\n      sdir.set(\r\n        (t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r\r\n      );\r\n\r\n      tdir.set(\r\n        (s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r\r\n      );\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    var i, il;\r\n    var j, jl;\r\n    var iA, iB, iC;\r\n\r\n    if (this.drawcalls.length === 0) {\r\n\r\n      this.addDrawCall(0, indices.length, 0);\r\n\r\n    }\r\n\r\n    var drawcalls = this.drawcalls;\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleTriangle(iA, iB, iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3();\r\n    var n = new THREE.Vector3(),\r\n      n2 = new THREE.Vector3();\r\n    var w, t, test;\r\n\r\n    function handleVertex(v) {\r\n\r\n      n.fromArray(normals, v * 3);\r\n      n2.copy(n);\r\n\r\n      t = tan1[v];\r\n\r\n      // Gram-Schmidt orthogonalize\r\n\r\n      tmp.copy(t);\r\n      tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n      // Calculate handedness\r\n\r\n      tmp2.crossVectors(n2, t);\r\n      test = tmp2.dot(tan2[v]);\r\n      w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n      tangents[v * 4] = tmp.x;\r\n      tangents[v * 4 + 1] = tmp.y;\r\n      tangents[v * 4 + 2] = tmp.z;\r\n      tangents[v * 4 + 3] = w;\r\n\r\n    }\r\n\r\n    for (j = 0, jl = drawcalls.length; j < jl; ++j) {\r\n\r\n      var start = drawcalls[j].start;\r\n      var count = drawcalls[j].count;\r\n      var index = drawcalls[j].index;\r\n\r\n      for (i = start, il = start + count; i < il; i += 3) {\r\n\r\n        iA = index + indices[i];\r\n        iB = index + indices[i + 1];\r\n        iC = index + indices[i + 2];\r\n\r\n        handleVertex(iA);\r\n        handleVertex(iB);\r\n        handleVertex(iC);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  Compute the draw offset for large models by chunking the index buffer into chunks of 65k addressable vertices.\r\n  This method will effectively rewrite the index buffer and remap all attributes to match the new indices.\r\n  WARNING: This method will also expand the vertex count to prevent sprawled triangles across draw offsets.\r\n  size - Defaults to 65535, but allows for larger or smaller chunks.\r\n  */\r\n  computeOffsets: function(size) {\r\n\r\n    if (size === undefined) size = 65535; // WebGL limits type of index buffer values to 16-bit.\r\n\r\n    var indices = this.attributes.index.array;\r\n    var vertices = this.attributes.position.array;\r\n\r\n    var facesCount = (indices.length / 3);\r\n\r\n    /*\r\n    console.log(\"Computing buffers in offsets of \"+size+\" -> indices:\"+indices.length+\" vertices:\"+vertices.length);\r\n    console.log(\"Faces to process: \"+(indices.length/3));\r\n    console.log(\"Reordering \"+verticesCount+\" vertices.\");\r\n    */\r\n\r\n    var sortedIndices = new Uint16Array(indices.length); //16-bit buffers\r\n    var indexPtr = 0;\r\n    var vertexPtr = 0;\r\n\r\n    var offsets = [{\r\n      start: 0,\r\n      count: 0,\r\n      index: 0\r\n    }];\r\n    var offset = offsets[0];\r\n\r\n    var duplicatedVertices = 0;\r\n    var newVerticeMaps = 0;\r\n    var faceVertices = new Int32Array(6);\r\n    var vertexMap = new Int32Array(vertices.length);\r\n    var revVertexMap = new Int32Array(vertices.length);\r\n    for (var j = 0; j < vertices.length; j++) {\r\n      vertexMap[j] = -1;\r\n      revVertexMap[j] = -1;\r\n    }\r\n\r\n    /*\r\n    \tTraverse every face and reorder vertices in the proper offsets of 65k.\r\n    \tWe can have more than 65k entries in the index buffer per offset, but only reference 65k values.\r\n    */\r\n    for (var findex = 0; findex < facesCount; findex++) {\r\n      newVerticeMaps = 0;\r\n\r\n      for (var vo = 0; vo < 3; vo++) {\r\n        var vid = indices[findex * 3 + vo];\r\n        if (vertexMap[vid] == -1) {\r\n          //Unmapped vertice\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          newVerticeMaps++;\r\n        }\r\n        else if (vertexMap[vid] < offset.index) {\r\n          //Reused vertices from previous block (duplicate)\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = -1;\r\n          duplicatedVertices++;\r\n        }\r\n        else {\r\n          //Reused vertice in the current block\r\n          faceVertices[vo * 2] = vid;\r\n          faceVertices[vo * 2 + 1] = vertexMap[vid];\r\n        }\r\n      }\r\n\r\n      var faceMax = vertexPtr + newVerticeMaps;\r\n      if (faceMax > (offset.index + size)) {\r\n        var new_offset = {\r\n          start: indexPtr,\r\n          count: 0,\r\n          index: vertexPtr\r\n        };\r\n        offsets.push(new_offset);\r\n        offset = new_offset;\r\n\r\n        //Re-evaluate reused vertices in light of new offset.\r\n        for (var v = 0; v < 6; v += 2) {\r\n          var new_vid = faceVertices[v + 1];\r\n          if (new_vid > -1 && new_vid < offset.index)\r\n            faceVertices[v + 1] = -1;\r\n        }\r\n      }\r\n\r\n      //Reindex the face.\r\n      for (var v = 0; v < 6; v += 2) {\r\n        var vid = faceVertices[v];\r\n        var new_vid = faceVertices[v + 1];\r\n\r\n        if (new_vid === -1)\r\n          new_vid = vertexPtr++;\r\n\r\n        vertexMap[vid] = new_vid;\r\n        revVertexMap[new_vid] = vid;\r\n        sortedIndices[indexPtr++] = new_vid - offset.index; //XXX overflows at 16bit\r\n        offset.count++;\r\n      }\r\n    }\r\n\r\n    /* Move all attribute values to map to the new computed indices , also expand the vertice stack to match our new vertexPtr. */\r\n    this.reorderBuffers(sortedIndices, revVertexMap, vertexPtr);\r\n    this.offsets = offsets; // TODO: Deprecate\r\n    this.drawcalls = offsets;\r\n\r\n    /*\r\n    var orderTime = Date.now();\r\n    console.log(\"Reorder time: \"+(orderTime-s)+\"ms\");\r\n    console.log(\"Duplicated \"+duplicatedVertices+\" vertices.\");\r\n    console.log(\"Compute Buffers time: \"+(Date.now()-s)+\"ms\");\r\n    console.log(\"Draw offsets: \"+offsets.length);\r\n    */\r\n\r\n    return offsets;\r\n\r\n  },\r\n\r\n  merge: function(geometry, offset) {\r\n\r\n    if (geometry instanceof THREE.BufferGeometry === false) {\r\n\r\n      THREE.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    if (offset === undefined) offset = 0;\r\n\r\n    var attributes = this.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      if (geometry.attributes[key] === undefined) continue;\r\n\r\n      var attribute1 = attributes[key];\r\n      var attributeArray1 = attribute1.array;\r\n\r\n      var attribute2 = geometry.attributes[key];\r\n      var attributeArray2 = attribute2.array;\r\n\r\n      var attributeSize = attribute2.itemSize;\r\n\r\n      for (var i = 0, j = attributeSize * offset; i < attributeArray2.length; i++, j++) {\r\n\r\n        attributeArray1[j] = attributeArray2[i];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  normalizeNormals: function() {\r\n\r\n    var normals = this.attributes.normal.array;\r\n\r\n    var x, y, z, n;\r\n\r\n    for (var i = 0, il = normals.length; i < il; i += 3) {\r\n\r\n      x = normals[i];\r\n      y = normals[i + 1];\r\n      z = normals[i + 2];\r\n\r\n      n = 1.0 / Math.sqrt(x * x + y * y + z * z);\r\n\r\n      normals[i] *= n;\r\n      normals[i + 1] *= n;\r\n      normals[i + 2] *= n;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n  \treoderBuffers:\r\n  \tReorder attributes based on a new indexBuffer and indexMap.\r\n  \tindexBuffer - Uint16Array of the new ordered indices.\r\n  \tindexMap - Int32Array where the position is the new vertex ID and the value the old vertex ID for each vertex.\r\n  \tvertexCount - Amount of total vertices considered in this reordering (in case you want to grow the vertice stack).\r\n  */\r\n  reorderBuffers: function(indexBuffer, indexMap, vertexCount) {\r\n\r\n    /* Create a copy of all attributes for reordering. */\r\n    var sortedAttributes = {};\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      var sourceArray = this.attributes[attr].array;\r\n      sortedAttributes[attr] = new sourceArray.constructor(this.attributes[attr].itemSize * vertexCount);\r\n    }\r\n\r\n    /* Move attribute positions based on the new index map */\r\n    for (var new_vid = 0; new_vid < vertexCount; new_vid++) {\r\n      var vid = indexMap[new_vid];\r\n      for (var attr in this.attributes) {\r\n        if (attr == 'index')\r\n          continue;\r\n        var attrArray = this.attributes[attr].array;\r\n        var attrSize = this.attributes[attr].itemSize;\r\n        var sortedAttr = sortedAttributes[attr];\r\n        for (var k = 0; k < attrSize; k++)\r\n          sortedAttr[new_vid * attrSize + k] = attrArray[vid * attrSize + k];\r\n      }\r\n    }\r\n\r\n    /* Carry the new sorted buffers locally */\r\n    this.attributes['index'].array = indexBuffer;\r\n    for (var attr in this.attributes) {\r\n      if (attr == 'index')\r\n        continue;\r\n      this.attributes[attr].array = sortedAttributes[attr];\r\n      this.attributes[attr].numItems = this.attributes[attr].itemSize * vertexCount;\r\n    }\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      data: {\r\n        attributes: {}\r\n      }\r\n    };\r\n\r\n    var attributes = this.attributes;\r\n    var offsets = this.offsets;\r\n    var boundingSphere = this.boundingSphere;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n\r\n      var array = Array.prototype.slice.call(attribute.array);\r\n\r\n      output.data.attributes[key] = {\r\n        itemSize: attribute.itemSize,\r\n        type: attribute.array.constructor.name,\r\n        array: array\r\n      }\r\n\r\n    }\r\n\r\n    if (offsets.length > 0) {\r\n\r\n      output.data.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    if (boundingSphere !== null) {\r\n\r\n      output.data.boundingSphere = {\r\n        center: boundingSphere.center.toArray(),\r\n        radius: boundingSphere.radius\r\n      }\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    for (var attr in this.attributes) {\r\n\r\n      var sourceAttr = this.attributes[attr];\r\n      geometry.addAttribute(attr, sourceAttr.clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.offsets.length; i < il; i++) {\r\n\r\n      var offset = this.offsets[i];\r\n\r\n      geometry.offsets.push({\r\n\r\n        start: offset.start,\r\n        index: offset.index,\r\n        count: offset.count\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\nTHREE.Geometry = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.GeometryIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Geometry';\r\n\r\n  this.vertices = [];\r\n  this.colors = []; // one-to-one vertex colors, used in Points and Line\r\n\r\n  this.faces = [];\r\n\r\n  this.faceVertexUvs = [\r\n    []\r\n  ];\r\n\r\n  this.morphTargets = [];\r\n  this.morphColors = [];\r\n  this.morphNormals = [];\r\n\r\n  this.skinWeights = [];\r\n  this.skinIndices = [];\r\n\r\n  this.lineDistances = [];\r\n\r\n  this.boundingBox = null;\r\n  this.boundingSphere = null;\r\n\r\n  this.hasTangents = false;\r\n\r\n  this.dynamic = true; // the intermediate typed arrays will be deleted when set to false\r\n\r\n  // update flags\r\n\r\n  this.verticesNeedUpdate = false;\r\n  this.elementsNeedUpdate = false;\r\n  this.uvsNeedUpdate = false;\r\n  this.normalsNeedUpdate = false;\r\n  this.tangentsNeedUpdate = false;\r\n  this.colorsNeedUpdate = false;\r\n  this.lineDistancesNeedUpdate = false;\r\n\r\n  this.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nTHREE.Geometry.prototype = {\r\n\r\n  constructor: THREE.Geometry,\r\n\r\n  applyMatrix: function(matrix) {\r\n\r\n    var normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    for (var i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertex.applyMatrix4(matrix);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      var face = this.faces[i];\r\n      face.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        face.vertexNormals[j].applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (this.boundingBox !== null) {\r\n\r\n      this.computeBoundingBox();\r\n\r\n    }\r\n\r\n    if (this.boundingSphere !== null) {\r\n\r\n      this.computeBoundingSphere();\r\n\r\n    }\r\n\r\n    this.verticesNeedUpdate = true;\r\n    this.normalsNeedUpdate = true;\r\n\r\n  },\r\n\r\n  fromBufferGeometry: function(geometry) {\r\n\r\n    var scope = this;\r\n\r\n    var attributes = geometry.attributes;\r\n\r\n    var vertices = attributes.position.array;\r\n    var indices = attributes.index !== undefined ? attributes.index.array : undefined;\r\n    var normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n    var colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n    var uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\r\n    var tempNormals = [];\r\n    var tempUVs = [];\r\n\r\n    for (var i = 0, j = 0; i < vertices.length; i += 3, j += 2) {\r\n\r\n      scope.vertices.push(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n      if (normals !== undefined) {\r\n\r\n        tempNormals.push(new THREE.Vector3(normals[i], normals[i + 1], normals[i + 2]));\r\n\r\n      }\r\n\r\n      if (colors !== undefined) {\r\n\r\n        scope.colors.push(new THREE.Color(colors[i], colors[i + 1], colors[i + 2]));\r\n\r\n      }\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        tempUVs.push(new THREE.Vector2(uvs[j], uvs[j + 1]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var addFace = function(a, b, c) {\r\n\r\n      var vertexNormals = normals !== undefined ? [tempNormals[a].clone(), tempNormals[b].clone(), tempNormals[c].clone()] : [];\r\n      var vertexColors = colors !== undefined ? [scope.colors[a].clone(), scope.colors[b].clone(), scope.colors[c].clone()] : [];\r\n\r\n      scope.faces.push(new THREE.Face3(a, b, c, vertexNormals, vertexColors));\r\n\r\n      if (uvs !== undefined) {\r\n\r\n        scope.faceVertexUvs[0].push([tempUVs[a].clone(), tempUVs[b].clone(), tempUVs[c].clone()]);\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (indices !== undefined) {\r\n\r\n      var drawcalls = geometry.drawcalls;\r\n\r\n      if (drawcalls.length > 0) {\r\n\r\n        for (var i = 0; i < drawcalls.length; i++) {\r\n\r\n          var drawcall = drawcalls[i];\r\n\r\n          var start = drawcall.start;\r\n          var count = drawcall.count;\r\n          var index = drawcall.index;\r\n\r\n          for (var j = start, jl = start + count; j < jl; j += 3) {\r\n\r\n            addFace(index + indices[j], index + indices[j + 1], index + indices[j + 2]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        for (var i = 0; i < indices.length; i += 3) {\r\n\r\n          addFace(indices[i], indices[i + 1], indices[i + 2]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (var i = 0; i < vertices.length / 3; i += 3) {\r\n\r\n        addFace(i, i + 1, i + 2);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.computeFaceNormals();\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      this.boundingBox = geometry.boundingBox.clone();\r\n\r\n    }\r\n\r\n    if (geometry.boundingSphere !== null) {\r\n\r\n      this.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n    }\r\n\r\n    return this;\r\n\r\n  },\r\n\r\n  center: function() {\r\n\r\n    this.computeBoundingBox();\r\n\r\n    var offset = this.boundingBox.center().negate();\r\n\r\n    this.applyMatrix(new THREE.Matrix4().setPosition(offset));\r\n\r\n    return offset;\r\n\r\n  },\r\n\r\n  computeFaceNormals: function() {\r\n\r\n    var cb = new THREE.Vector3(),\r\n      ab = new THREE.Vector3();\r\n\r\n    for (var f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      var face = this.faces[f];\r\n\r\n      var vA = this.vertices[face.a];\r\n      var vB = this.vertices[face.b];\r\n      var vC = this.vertices[face.c];\r\n\r\n      cb.subVectors(vC, vB);\r\n      ab.subVectors(vA, vB);\r\n      cb.cross(ab);\r\n\r\n      cb.normalize();\r\n\r\n      face.normal.copy(cb);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeVertexNormals: function(areaWeighted) {\r\n\r\n    var v, vl, f, fl, face, vertices;\r\n\r\n    vertices = new Array(this.vertices.length);\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    if (areaWeighted) {\r\n\r\n      // vertex normals weighted by triangle areas\r\n      // http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n      var vA, vB, vC;\r\n      var cb = new THREE.Vector3(),\r\n        ab = new THREE.Vector3();\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vA = this.vertices[face.a];\r\n        vB = this.vertices[face.b];\r\n        vC = this.vertices[face.c];\r\n\r\n        cb.subVectors(vC, vB);\r\n        ab.subVectors(vA, vB);\r\n        cb.cross(ab);\r\n\r\n        vertices[face.a].add(cb);\r\n        vertices[face.b].add(cb);\r\n        vertices[face.c].add(cb);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        vertices[face.a].add(face.normal);\r\n        vertices[face.b].add(face.normal);\r\n        vertices[face.c].add(face.normal);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      vertices[v].normalize();\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.vertexNormals[0] = vertices[face.a].clone();\r\n      face.vertexNormals[1] = vertices[face.b].clone();\r\n      face.vertexNormals[2] = vertices[face.c].clone();\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeMorphNormals: function() {\r\n\r\n    var i, il, f, fl, face;\r\n\r\n    // save original normals\r\n    // - create temp variables on first access\r\n    //   otherwise just copy (for faster repeated calls)\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      if (!face.__originalFaceNormal) {\r\n\r\n        face.__originalFaceNormal = face.normal.clone();\r\n\r\n      }\r\n      else {\r\n\r\n        face.__originalFaceNormal.copy(face.normal);\r\n\r\n      }\r\n\r\n      if (!face.__originalVertexNormals) face.__originalVertexNormals = [];\r\n\r\n      for (i = 0, il = face.vertexNormals.length; i < il; i++) {\r\n\r\n        if (!face.__originalVertexNormals[i]) {\r\n\r\n          face.__originalVertexNormals[i] = face.vertexNormals[i].clone();\r\n\r\n        }\r\n        else {\r\n\r\n          face.__originalVertexNormals[i].copy(face.vertexNormals[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // use temp geometry to compute face and vertex normals for each morph\r\n\r\n    var tmpGeo = new THREE.Geometry();\r\n    tmpGeo.faces = this.faces;\r\n\r\n    for (i = 0, il = this.morphTargets.length; i < il; i++) {\r\n\r\n      // create on first access\r\n\r\n      if (!this.morphNormals[i]) {\r\n\r\n        this.morphNormals[i] = {};\r\n        this.morphNormals[i].faceNormals = [];\r\n        this.morphNormals[i].vertexNormals = [];\r\n\r\n        var dstNormalsFace = this.morphNormals[i].faceNormals;\r\n        var dstNormalsVertex = this.morphNormals[i].vertexNormals;\r\n\r\n        var faceNormal, vertexNormals;\r\n\r\n        for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n          faceNormal = new THREE.Vector3();\r\n          vertexNormals = {\r\n            a: new THREE.Vector3(),\r\n            b: new THREE.Vector3(),\r\n            c: new THREE.Vector3()\r\n          };\r\n\r\n          dstNormalsFace.push(faceNormal);\r\n          dstNormalsVertex.push(vertexNormals);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var morphNormals = this.morphNormals[i];\r\n\r\n      // set vertices to morph target\r\n\r\n      tmpGeo.vertices = this.morphTargets[i].vertices;\r\n\r\n      // compute morph normals\r\n\r\n      tmpGeo.computeFaceNormals();\r\n      tmpGeo.computeVertexNormals();\r\n\r\n      // store morph normals\r\n\r\n      var faceNormal, vertexNormals;\r\n\r\n      for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n        face = this.faces[f];\r\n\r\n        faceNormal = morphNormals.faceNormals[f];\r\n        vertexNormals = morphNormals.vertexNormals[f];\r\n\r\n        faceNormal.copy(face.normal);\r\n\r\n        vertexNormals.a.copy(face.vertexNormals[0]);\r\n        vertexNormals.b.copy(face.vertexNormals[1]);\r\n        vertexNormals.c.copy(face.vertexNormals[2]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore original normals\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      face.normal = face.__originalFaceNormal;\r\n      face.vertexNormals = face.__originalVertexNormals;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeTangents: function() {\r\n\r\n    // based on http://www.terathon.com/code/tangent.html\r\n    // tangents go to vertices\r\n\r\n    var f, fl, v, vl, i, vertexIndex,\r\n      face, uv, vA, vB, vC, uvA, uvB, uvC,\r\n      x1, x2, y1, y2, z1, z2,\r\n      s1, s2, t1, t2, r, t, test,\r\n      tan1 = [],\r\n      tan2 = [],\r\n      sdir = new THREE.Vector3(),\r\n      tdir = new THREE.Vector3(),\r\n      tmp = new THREE.Vector3(),\r\n      tmp2 = new THREE.Vector3(),\r\n      n = new THREE.Vector3(),\r\n      w;\r\n\r\n    for (v = 0, vl = this.vertices.length; v < vl; v++) {\r\n\r\n      tan1[v] = new THREE.Vector3();\r\n      tan2[v] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    function handleTriangle(context, a, b, c, ua, ub, uc) {\r\n\r\n      vA = context.vertices[a];\r\n      vB = context.vertices[b];\r\n      vC = context.vertices[c];\r\n\r\n      uvA = uv[ua];\r\n      uvB = uv[ub];\r\n      uvC = uv[uc];\r\n\r\n      x1 = vB.x - vA.x;\r\n      x2 = vC.x - vA.x;\r\n      y1 = vB.y - vA.y;\r\n      y2 = vC.y - vA.y;\r\n      z1 = vB.z - vA.z;\r\n      z2 = vC.z - vA.z;\r\n\r\n      s1 = uvB.x - uvA.x;\r\n      s2 = uvC.x - uvA.x;\r\n      t1 = uvB.y - uvA.y;\r\n      t2 = uvC.y - uvA.y;\r\n\r\n      r = 1.0 / (s1 * t2 - s2 * t1);\r\n      sdir.set((t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r);\r\n      tdir.set((s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r);\r\n\r\n      tan1[a].add(sdir);\r\n      tan1[b].add(sdir);\r\n      tan1[c].add(sdir);\r\n\r\n      tan2[a].add(tdir);\r\n      tan2[b].add(tdir);\r\n      tan2[c].add(tdir);\r\n\r\n    }\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n      uv = this.faceVertexUvs[0][f]; // use UV layer 0 for tangents\r\n\r\n      handleTriangle(this, face.a, face.b, face.c, 0, 1, 2);\r\n\r\n    }\r\n\r\n    var faceIndex = ['a', 'b', 'c', 'd'];\r\n\r\n    for (f = 0, fl = this.faces.length; f < fl; f++) {\r\n\r\n      face = this.faces[f];\r\n\r\n      for (i = 0; i < Math.min(face.vertexNormals.length, 3); i++) {\r\n\r\n        n.copy(face.vertexNormals[i]);\r\n\r\n        vertexIndex = face[faceIndex[i]];\r\n\r\n        t = tan1[vertexIndex];\r\n\r\n        // Gram-Schmidt orthogonalize\r\n\r\n        tmp.copy(t);\r\n        tmp.sub(n.multiplyScalar(n.dot(t))).normalize();\r\n\r\n        // Calculate handedness\r\n\r\n        tmp2.crossVectors(face.vertexNormals[i], t);\r\n        test = tmp2.dot(tan2[vertexIndex]);\r\n        w = (test < 0.0) ? -1.0 : 1.0;\r\n\r\n        face.vertexTangents[i] = new THREE.Vector4(tmp.x, tmp.y, tmp.z, w);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.hasTangents = true;\r\n\r\n  },\r\n\r\n  computeLineDistances: function() {\r\n\r\n    var d = 0;\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      if (i > 0) {\r\n\r\n        d += vertices[i].distanceTo(vertices[i - 1]);\r\n\r\n      }\r\n\r\n      this.lineDistances[i] = d;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  computeBoundingBox: function() {\r\n\r\n    if (this.boundingBox === null) {\r\n\r\n      this.boundingBox = new THREE.Box3();\r\n\r\n    }\r\n\r\n    this.boundingBox.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  computeBoundingSphere: function() {\r\n\r\n    if (this.boundingSphere === null) {\r\n\r\n      this.boundingSphere = new THREE.Sphere();\r\n\r\n    }\r\n\r\n    this.boundingSphere.setFromPoints(this.vertices);\r\n\r\n  },\r\n\r\n  merge: function(geometry, matrix, materialIndexOffset) {\r\n\r\n    if (geometry instanceof THREE.Geometry === false) {\r\n\r\n      THREE.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry);\r\n      return;\r\n\r\n    }\r\n\r\n    var normalMatrix,\r\n      vertexOffset = this.vertices.length,\r\n      vertices1 = this.vertices,\r\n      vertices2 = geometry.vertices,\r\n      faces1 = this.faces,\r\n      faces2 = geometry.faces,\r\n      uvs1 = this.faceVertexUvs[0],\r\n      uvs2 = geometry.faceVertexUvs[0];\r\n\r\n    if (materialIndexOffset === undefined) materialIndexOffset = 0;\r\n\r\n    if (matrix !== undefined) {\r\n\r\n      normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    for (var i = 0, il = vertices2.length; i < il; i++) {\r\n\r\n      var vertex = vertices2[i];\r\n\r\n      var vertexCopy = vertex.clone();\r\n\r\n      if (matrix !== undefined) vertexCopy.applyMatrix4(matrix);\r\n\r\n      vertices1.push(vertexCopy);\r\n\r\n    }\r\n\r\n    // faces\r\n\r\n    for (i = 0, il = faces2.length; i < il; i++) {\r\n\r\n      var face = faces2[i],\r\n        faceCopy, normal, color,\r\n        faceVertexNormals = face.vertexNormals,\r\n        faceVertexColors = face.vertexColors;\r\n\r\n      faceCopy = new THREE.Face3(face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset);\r\n      faceCopy.normal.copy(face.normal);\r\n\r\n      if (normalMatrix !== undefined) {\r\n\r\n        faceCopy.normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexNormals.length; j < jl; j++) {\r\n\r\n        normal = faceVertexNormals[j].clone();\r\n\r\n        if (normalMatrix !== undefined) {\r\n\r\n          normal.applyMatrix3(normalMatrix).normalize();\r\n\r\n        }\r\n\r\n        faceCopy.vertexNormals.push(normal);\r\n\r\n      }\r\n\r\n      faceCopy.color.copy(face.color);\r\n\r\n      for (var j = 0, jl = faceVertexColors.length; j < jl; j++) {\r\n\r\n        color = faceVertexColors[j];\r\n        faceCopy.vertexColors.push(color.clone());\r\n\r\n      }\r\n\r\n      faceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n      faces1.push(faceCopy);\r\n\r\n    }\r\n\r\n    // uvs\r\n\r\n    for (i = 0, il = uvs2.length; i < il; i++) {\r\n\r\n      var uv = uvs2[i],\r\n        uvCopy = [];\r\n\r\n      if (uv === undefined) {\r\n\r\n        continue;\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = uv.length; j < jl; j++) {\r\n\r\n        uvCopy.push(uv[j].clone());\r\n\r\n      }\r\n\r\n      uvs1.push(uvCopy);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  mergeMesh: function(mesh) {\r\n\r\n    if (mesh instanceof THREE.Mesh === false) {\r\n\r\n      THREE.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh);\r\n      return;\r\n\r\n    }\r\n\r\n    mesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n    this.merge(mesh.geometry, mesh.matrix);\r\n\r\n  },\r\n\r\n  /*\r\n   * Checks for duplicate vertices with hashmap.\r\n   * Duplicated vertices are removed\r\n   * and faces' vertices are updated.\r\n   */\r\n\r\n  mergeVertices: function() {\r\n\r\n    var verticesMap = {}; // Hashmap for looking up vertice by position coordinates (and making sure they are unique)\r\n    var unique = [],\r\n      changes = [];\r\n\r\n    var v, key;\r\n    var precisionPoints = 4; // number of decimal points, eg. 4 for epsilon of 0.0001\r\n    var precision = Math.pow(10, precisionPoints);\r\n    var i, il, face;\r\n    var indices, j, jl;\r\n\r\n    for (i = 0, il = this.vertices.length; i < il; i++) {\r\n\r\n      v = this.vertices[i];\r\n      key = Math.round(v.x * precision) + '_' + Math.round(v.y * precision) + '_' + Math.round(v.z * precision);\r\n\r\n      if (verticesMap[key] === undefined) {\r\n\r\n        verticesMap[key] = i;\r\n        unique.push(this.vertices[i]);\r\n        changes[i] = unique.length - 1;\r\n\r\n      }\r\n      else {\r\n\r\n        //console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n        changes[i] = changes[verticesMap[key]];\r\n\r\n      }\r\n\r\n    };\r\n\r\n\r\n    // if faces are completely degenerate after merging vertices, we\r\n    // have to remove them from the geometry.\r\n    var faceIndicesToRemove = [];\r\n\r\n    for (i = 0, il = this.faces.length; i < il; i++) {\r\n\r\n      face = this.faces[i];\r\n\r\n      face.a = changes[face.a];\r\n      face.b = changes[face.b];\r\n      face.c = changes[face.c];\r\n\r\n      indices = [face.a, face.b, face.c];\r\n\r\n      var dupIndex = -1;\r\n\r\n      // if any duplicate vertices are found in a Face3\r\n      // we have to remove the face as nothing can be saved\r\n      for (var n = 0; n < 3; n++) {\r\n        if (indices[n] == indices[(n + 1) % 3]) {\r\n\r\n          dupIndex = n;\r\n          faceIndicesToRemove.push(i);\r\n          break;\r\n\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    for (i = faceIndicesToRemove.length - 1; i >= 0; i--) {\r\n      var idx = faceIndicesToRemove[i];\r\n\r\n      this.faces.splice(idx, 1);\r\n\r\n      for (j = 0, jl = this.faceVertexUvs.length; j < jl; j++) {\r\n\r\n        this.faceVertexUvs[j].splice(idx, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Use unique set of vertices\r\n\r\n    var diff = this.vertices.length - unique.length;\r\n    this.vertices = unique;\r\n    return diff;\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.0,\r\n        type: 'BufferGeometry',\r\n        generator: 'BufferGeometryExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this.parameters !== undefined) {\r\n\r\n      var parameters = this.parameters;\r\n\r\n      for (var key in parameters) {\r\n\r\n        if (parameters[key] !== undefined) output[key] = parameters[key];\r\n\r\n      }\r\n\r\n      return output;\r\n\r\n    }\r\n\r\n    var vertices = [];\r\n\r\n    for (var i = 0; i < this.vertices.length; i++) {\r\n\r\n      var vertex = this.vertices[i];\r\n      vertices.push(vertex.x, vertex.y, vertex.z);\r\n\r\n    }\r\n\r\n    var faces = [];\r\n    var normals = [];\r\n    var normalsHash = {};\r\n    var colors = [];\r\n    var colorsHash = {};\r\n    var uvs = [];\r\n    var uvsHash = {};\r\n\r\n    for (var i = 0; i < this.faces.length; i++) {\r\n\r\n      var face = this.faces[i];\r\n\r\n      var hasMaterial = false; // face.materialIndex !== undefined;\r\n      var hasFaceUv = false; // deprecated\r\n      var hasFaceVertexUv = this.faceVertexUvs[0][i] !== undefined;\r\n      var hasFaceNormal = face.normal.length() > 0;\r\n      var hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n      var hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n      var hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n      var faceType = 0;\r\n\r\n      faceType = setBit(faceType, 0, 0);\r\n      faceType = setBit(faceType, 1, hasMaterial);\r\n      faceType = setBit(faceType, 2, hasFaceUv);\r\n      faceType = setBit(faceType, 3, hasFaceVertexUv);\r\n      faceType = setBit(faceType, 4, hasFaceNormal);\r\n      faceType = setBit(faceType, 5, hasFaceVertexNormal);\r\n      faceType = setBit(faceType, 6, hasFaceColor);\r\n      faceType = setBit(faceType, 7, hasFaceVertexColor);\r\n\r\n      faces.push(faceType);\r\n      faces.push(face.a, face.b, face.c);\r\n\r\n\r\n      /*\r\n      if ( hasMaterial ) {\r\n\r\n      \tfaces.push( face.materialIndex );\r\n\r\n      }\r\n      */\r\n\r\n      if (hasFaceVertexUv) {\r\n\r\n        var faceVertexUvs = this.faceVertexUvs[0][i];\r\n\r\n        faces.push(\r\n          getUvIndex(faceVertexUvs[0]),\r\n          getUvIndex(faceVertexUvs[1]),\r\n          getUvIndex(faceVertexUvs[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceNormal) {\r\n\r\n        faces.push(getNormalIndex(face.normal));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexNormal) {\r\n\r\n        var vertexNormals = face.vertexNormals;\r\n\r\n        faces.push(\r\n          getNormalIndex(vertexNormals[0]),\r\n          getNormalIndex(vertexNormals[1]),\r\n          getNormalIndex(vertexNormals[2])\r\n        );\r\n\r\n      }\r\n\r\n      if (hasFaceColor) {\r\n\r\n        faces.push(getColorIndex(face.color));\r\n\r\n      }\r\n\r\n      if (hasFaceVertexColor) {\r\n\r\n        var vertexColors = face.vertexColors;\r\n\r\n        faces.push(\r\n          getColorIndex(vertexColors[0]),\r\n          getColorIndex(vertexColors[1]),\r\n          getColorIndex(vertexColors[2])\r\n        );\r\n\r\n      }\r\n\r\n    }\r\n\r\n    function setBit(value, position, enabled) {\r\n\r\n      return enabled ? value | (1 << position) : value & (~(1 << position));\r\n\r\n    }\r\n\r\n    function getNormalIndex(normal) {\r\n\r\n      var hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n      if (normalsHash[hash] !== undefined) {\r\n\r\n        return normalsHash[hash];\r\n\r\n      }\r\n\r\n      normalsHash[hash] = normals.length / 3;\r\n      normals.push(normal.x, normal.y, normal.z);\r\n\r\n      return normalsHash[hash];\r\n\r\n    }\r\n\r\n    function getColorIndex(color) {\r\n\r\n      var hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n      if (colorsHash[hash] !== undefined) {\r\n\r\n        return colorsHash[hash];\r\n\r\n      }\r\n\r\n      colorsHash[hash] = colors.length;\r\n      colors.push(color.getHex());\r\n\r\n      return colorsHash[hash];\r\n\r\n    }\r\n\r\n    function getUvIndex(uv) {\r\n\r\n      var hash = uv.x.toString() + uv.y.toString();\r\n\r\n      if (uvsHash[hash] !== undefined) {\r\n\r\n        return uvsHash[hash];\r\n\r\n      }\r\n\r\n      uvsHash[hash] = uvs.length / 2;\r\n      uvs.push(uv.x, uv.y);\r\n\r\n      return uvsHash[hash];\r\n\r\n    }\r\n\r\n    output.data = {};\r\n\r\n    output.data.vertices = vertices;\r\n    output.data.normals = normals;\r\n    if (colors.length > 0) output.data.colors = colors;\r\n    if (uvs.length > 0) output.data.uvs = [uvs]; // temporal backward compatibility\r\n    output.data.faces = faces;\r\n\r\n    //\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var geometry = new THREE.Geometry();\r\n\r\n    var vertices = this.vertices;\r\n\r\n    for (var i = 0, il = vertices.length; i < il; i++) {\r\n\r\n      geometry.vertices.push(vertices[i].clone());\r\n\r\n    }\r\n\r\n    var faces = this.faces;\r\n\r\n    for (var i = 0, il = faces.length; i < il; i++) {\r\n\r\n      geometry.faces.push(faces[i].clone());\r\n\r\n    }\r\n\r\n    for (var i = 0, il = this.faceVertexUvs.length; i < il; i++) {\r\n\r\n      var faceVertexUvs = this.faceVertexUvs[i];\r\n\r\n      if (geometry.faceVertexUvs[i] === undefined) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n      for (var j = 0, jl = faceVertexUvs.length; j < jl; j++) {\r\n\r\n        var uvs = faceVertexUvs[j],\r\n          uvsCopy = [];\r\n\r\n        for (var k = 0, kl = uvs.length; k < kl; k++) {\r\n\r\n          var uv = uvs[k];\r\n\r\n          uvsCopy.push(uv.clone());\r\n\r\n        }\r\n\r\n        geometry.faceVertexUvs[i].push(uvsCopy);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Camera = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Camera';\r\n\r\n  this.matrixWorldInverse = new THREE.Matrix4();\r\n  this.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function() {\r\n\r\n  var quaternion = new THREE.Quaternion();\r\n\r\n  return function(optionalTarget) {\r\n\r\n    var result = optionalTarget || new THREE.Vector3();\r\n\r\n    this.getWorldQuaternion(quaternion);\r\n\r\n    return result.set(0, 0, -1).applyQuaternion(quaternion);\r\n\r\n  }\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function() {\r\n\r\n  // This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n  var m1 = new THREE.Matrix4();\r\n\r\n  return function(vector) {\r\n\r\n    m1.lookAt(this.position, vector, this.up);\r\n\r\n    this.quaternion.setFromRotationMatrix(m1);\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function(camera) {\r\n\r\n  if (camera === undefined) camera = new THREE.Camera();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, camera);\r\n\r\n  camera.matrixWorldInverse.copy(this.matrixWorldInverse);\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function(near, far, cubeResolution) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'CubeCamera';\r\n\r\n  var fov = 90,\r\n    aspect = 1;\r\n\r\n  var cameraPX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPX.up.set(0, -1, 0);\r\n  cameraPX.lookAt(new THREE.Vector3(1, 0, 0));\r\n  this.add(cameraPX);\r\n\r\n  var cameraNX = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNX.up.set(0, -1, 0);\r\n  cameraNX.lookAt(new THREE.Vector3(-1, 0, 0));\r\n  this.add(cameraNX);\r\n\r\n  var cameraPY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPY.up.set(0, 0, 1);\r\n  cameraPY.lookAt(new THREE.Vector3(0, 1, 0));\r\n  this.add(cameraPY);\r\n\r\n  var cameraNY = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNY.up.set(0, 0, -1);\r\n  cameraNY.lookAt(new THREE.Vector3(0, -1, 0));\r\n  this.add(cameraNY);\r\n\r\n  var cameraPZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraPZ.up.set(0, -1, 0);\r\n  cameraPZ.lookAt(new THREE.Vector3(0, 0, 1));\r\n  this.add(cameraPZ);\r\n\r\n  var cameraNZ = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n  cameraNZ.up.set(0, -1, 0);\r\n  cameraNZ.lookAt(new THREE.Vector3(0, 0, -1));\r\n  this.add(cameraNZ);\r\n\r\n  this.renderTarget = new THREE.WebGLRenderTargetCube(cubeResolution, cubeResolution, {\r\n    format: THREE.RGBFormat,\r\n    magFilter: THREE.LinearFilter,\r\n    minFilter: THREE.LinearFilter\r\n  });\r\n\r\n  this.updateCubeMap = function(renderer, scene) {\r\n\r\n    var renderTarget = this.renderTarget;\r\n    var generateMipmaps = renderTarget.generateMipmaps;\r\n\r\n    renderTarget.generateMipmaps = false;\r\n\r\n    renderTarget.activeCubeFace = 0;\r\n    renderer.render(scene, cameraPX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 1;\r\n    renderer.render(scene, cameraNX, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 2;\r\n    renderer.render(scene, cameraPY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 3;\r\n    renderer.render(scene, cameraNY, renderTarget);\r\n\r\n    renderTarget.activeCubeFace = 4;\r\n    renderer.render(scene, cameraPZ, renderTarget);\r\n\r\n    renderTarget.generateMipmaps = generateMipmaps;\r\n\r\n    renderTarget.activeCubeFace = 5;\r\n    renderer.render(scene, cameraNZ, renderTarget);\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function(left, right, top, bottom, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'OrthographicCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.left = left;\r\n  this.right = right;\r\n  this.top = top;\r\n  this.bottom = bottom;\r\n\r\n  this.near = (near !== undefined) ? near : 0.1;\r\n  this.far = (far !== undefined) ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\r\n\r\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var dx = (this.right - this.left) / (2 * this.zoom);\r\n  var dy = (this.top - this.bottom) / (2 * this.zoom);\r\n  var cx = (this.right + this.left) / 2;\r\n  var cy = (this.top + this.bottom) / 2;\r\n\r\n  this.projectionMatrix.makeOrthographic(cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far);\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.OrthographicCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.left = this.left;\r\n  camera.right = this.right;\r\n  camera.top = this.top;\r\n  camera.bottom = this.bottom;\r\n\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n};\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.PerspectiveCamera = function(fov, aspect, near, far) {\r\n\r\n  THREE.Camera.call(this);\r\n\r\n  this.type = 'PerspectiveCamera';\r\n\r\n  this.zoom = 1;\r\n\r\n  this.fov = fov !== undefined ? fov : 50;\r\n  this.aspect = aspect !== undefined ? aspect : 1;\r\n  this.near = near !== undefined ? near : 0.1;\r\n  this.far = far !== undefined ? far : 2000;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.create(THREE.Camera.prototype);\r\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\r\n\r\n\r\n/**\r\n * Uses Focal Length (in mm) to estimate and set FOV\r\n * 35mm (fullframe) camera is used if frame size is not specified;\r\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function(focalLength, frameHeight) {\r\n\r\n  if (frameHeight === undefined) frameHeight = 24;\r\n\r\n  this.fov = 2 * THREE.Math.radToDeg(Math.atan(frameHeight / (focalLength * 2)));\r\n  this.updateProjectionMatrix();\r\n\r\n}\r\n\r\n\r\n/**\r\n * Sets an offset in a larger frustum. This is useful for multi-window or\r\n * multi-monitor/multi-machine setups.\r\n *\r\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n * the monitors are in grid like this\r\n *\r\n *   +---+---+---+\r\n *   | A | B | C |\r\n *   +---+---+---+\r\n *   | D | E | F |\r\n *   +---+---+---+\r\n *\r\n * then for each monitor you would call it like this\r\n *\r\n *   var w = 1920;\r\n *   var h = 1080;\r\n *   var fullWidth = w * 3;\r\n *   var fullHeight = h * 2;\r\n *\r\n *   --A--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n *   --B--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n *   --C--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n *   --D--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n *   --E--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n *   --F--\r\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n *\r\n *   Note there is no reason monitors have to be the same size or in a grid.\r\n */\r\n\r\nTHREE.PerspectiveCamera.prototype.setViewOffset = function(fullWidth, fullHeight, x, y, width, height) {\r\n\r\n  this.fullWidth = fullWidth;\r\n  this.fullHeight = fullHeight;\r\n  this.x = x;\r\n  this.y = y;\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  this.updateProjectionMatrix();\r\n\r\n};\r\n\r\n\r\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function() {\r\n\r\n  var fov = THREE.Math.radToDeg(2 * Math.atan(Math.tan(THREE.Math.degToRad(this.fov) * 0.5) / this.zoom));\r\n\r\n  if (this.fullWidth) {\r\n\r\n    var aspect = this.fullWidth / this.fullHeight;\r\n    var top = Math.tan(THREE.Math.degToRad(fov * 0.5)) * this.near;\r\n    var bottom = -top;\r\n    var left = aspect * bottom;\r\n    var right = aspect * top;\r\n    var width = Math.abs(right - left);\r\n    var height = Math.abs(top - bottom);\r\n\r\n    this.projectionMatrix.makeFrustum(\r\n      left + this.x * width / this.fullWidth,\r\n      left + (this.x + this.width) * width / this.fullWidth,\r\n      top - (this.y + this.height) * height / this.fullHeight,\r\n      top - this.y * height / this.fullHeight,\r\n      this.near,\r\n      this.far\r\n    );\r\n\r\n  }\r\n  else {\r\n\r\n    this.projectionMatrix.makePerspective(fov, this.aspect, this.near, this.far);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype.clone = function() {\r\n\r\n  var camera = new THREE.PerspectiveCamera();\r\n\r\n  THREE.Camera.prototype.clone.call(this, camera);\r\n\r\n  camera.zoom = this.zoom;\r\n\r\n  camera.fov = this.fov;\r\n  camera.aspect = this.aspect;\r\n  camera.near = this.near;\r\n  camera.far = this.far;\r\n\r\n  camera.projectionMatrix.copy(this.projectionMatrix);\r\n\r\n  return camera;\r\n\r\n};\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function(color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Light';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Light.prototype.constructor = THREE.Light;\r\n\r\nTHREE.Light.prototype.clone = function(light) {\r\n\r\n  if (light === undefined) light = new THREE.Light();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, light);\r\n\r\n  light.color.copy(this.color);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function(color) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AmbientLight';\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\r\n\r\nTHREE.AmbientLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.AmbientLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/AreaLight.js\r\n\r\n/**\r\n * @author MPanknin / http://www.redplant.de/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.AreaLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'AreaLight';\r\n\r\n  this.normal = new THREE.Vector3(0, -1, 0);\r\n  this.right = new THREE.Vector3(1, 0, 0);\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.width = 1.0;\r\n  this.height = 1.0;\r\n\r\n  this.constantAttenuation = 1.5;\r\n  this.linearAttenuation = 0.5;\r\n  this.quadraticAttenuation = 0.1;\r\n\r\n};\r\n\r\nTHREE.AreaLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.AreaLight.prototype.constructor = THREE.AreaLight;\r\n\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function(color, intensity) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'DirectionalLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n\r\n  this.shadowCameraLeft = -500;\r\n  this.shadowCameraRight = 500;\r\n  this.shadowCameraTop = 500;\r\n  this.shadowCameraBottom = -500;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowCascade = false;\r\n\r\n  this.shadowCascadeOffset = new THREE.Vector3(0, 0, -1000);\r\n  this.shadowCascadeCount = 2;\r\n\r\n  this.shadowCascadeBias = [0, 0, 0];\r\n  this.shadowCascadeWidth = [512, 512, 512];\r\n  this.shadowCascadeHeight = [512, 512, 512];\r\n\r\n  this.shadowCascadeNearZ = [-1.000, 0.990, 0.998];\r\n  this.shadowCascadeFarZ = [0.990, 0.998, 1.000];\r\n\r\n  this.shadowCascadeArray = [];\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\r\n\r\nTHREE.DirectionalLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.DirectionalLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n\r\n  light.shadowCameraLeft = this.shadowCameraLeft;\r\n  light.shadowCameraRight = this.shadowCameraRight;\r\n  light.shadowCameraTop = this.shadowCameraTop;\r\n  light.shadowCameraBottom = this.shadowCameraBottom;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  //\r\n\r\n  light.shadowCascade = this.shadowCascade;\r\n\r\n  light.shadowCascadeOffset.copy(this.shadowCascadeOffset);\r\n  light.shadowCascadeCount = this.shadowCascadeCount;\r\n\r\n  light.shadowCascadeBias = this.shadowCascadeBias.slice(0);\r\n  light.shadowCascadeWidth = this.shadowCascadeWidth.slice(0);\r\n  light.shadowCascadeHeight = this.shadowCascadeHeight.slice(0);\r\n\r\n  light.shadowCascadeNearZ = this.shadowCascadeNearZ.slice(0);\r\n  light.shadowCascadeFarZ = this.shadowCascadeFarZ.slice(0);\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function(skyColor, groundColor, intensity) {\r\n\r\n  THREE.Light.call(this, skyColor);\r\n\r\n  this.type = 'HemisphereLight';\r\n\r\n  this.position.set(0, 100, 0);\r\n\r\n  this.groundColor = new THREE.Color(groundColor);\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\r\n\r\nTHREE.HemisphereLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.HemisphereLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.groundColor.copy(this.groundColor);\r\n  light.intensity = this.intensity;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLight = function(color, intensity, distance, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'PointLight';\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\r\n\r\nTHREE.PointLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.PointLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.decay = this.decay;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function(color, intensity, distance, angle, exponent, decay) {\r\n\r\n  THREE.Light.call(this, color);\r\n\r\n  this.type = 'SpotLight';\r\n\r\n  this.position.set(0, 1, 0);\r\n  this.target = new THREE.Object3D();\r\n\r\n  this.intensity = (intensity !== undefined) ? intensity : 1;\r\n  this.distance = (distance !== undefined) ? distance : 0;\r\n  this.angle = (angle !== undefined) ? angle : Math.PI / 3;\r\n  this.exponent = (exponent !== undefined) ? exponent : 10;\r\n  this.decay = (decay !== undefined) ? decay : 1; // for physically correct lights, should be 2.\r\n\r\n  this.castShadow = false;\r\n  this.onlyShadow = false;\r\n\r\n  //\r\n\r\n  this.shadowCameraNear = 50;\r\n  this.shadowCameraFar = 5000;\r\n  this.shadowCameraFov = 50;\r\n\r\n  this.shadowCameraVisible = false;\r\n\r\n  this.shadowBias = 0;\r\n  this.shadowDarkness = 0.5;\r\n\r\n  this.shadowMapWidth = 512;\r\n  this.shadowMapHeight = 512;\r\n\r\n  //\r\n\r\n  this.shadowMap = null;\r\n  this.shadowMapSize = null;\r\n  this.shadowCamera = null;\r\n  this.shadowMatrix = null;\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.create(THREE.Light.prototype);\r\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\r\n\r\nTHREE.SpotLight.prototype.clone = function() {\r\n\r\n  var light = new THREE.SpotLight();\r\n\r\n  THREE.Light.prototype.clone.call(this, light);\r\n\r\n  light.target = this.target.clone();\r\n\r\n  light.intensity = this.intensity;\r\n  light.distance = this.distance;\r\n  light.angle = this.angle;\r\n  light.exponent = this.exponent;\r\n  light.decay = this.decay;\r\n\r\n  light.castShadow = this.castShadow;\r\n  light.onlyShadow = this.onlyShadow;\r\n\r\n  //\r\n\r\n  light.shadowCameraNear = this.shadowCameraNear;\r\n  light.shadowCameraFar = this.shadowCameraFar;\r\n  light.shadowCameraFov = this.shadowCameraFov;\r\n\r\n  light.shadowCameraVisible = this.shadowCameraVisible;\r\n\r\n  light.shadowBias = this.shadowBias;\r\n  light.shadowDarkness = this.shadowDarkness;\r\n\r\n  light.shadowMapWidth = this.shadowMapWidth;\r\n  light.shadowMapHeight = this.shadowMapHeight;\r\n\r\n  return light;\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n  files: {},\r\n\r\n  add: function(key, file) {\r\n\r\n    // console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n    this.files[key] = file;\r\n\r\n  },\r\n\r\n  get: function(key) {\r\n\r\n    // console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n    return this.files[key];\r\n\r\n  },\r\n\r\n  remove: function(key) {\r\n\r\n    delete this.files[key];\r\n\r\n  },\r\n\r\n  clear: function() {\r\n\r\n    this.files = {}\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function(showStatus) {\r\n\r\n  this.showStatus = showStatus;\r\n  this.statusDomElement = showStatus ? THREE.Loader.prototype.addStatusElement() : null;\r\n\r\n  this.imageLoader = new THREE.ImageLoader();\r\n\r\n  this.onLoadStart = function() {};\r\n  this.onLoadProgress = function() {};\r\n  this.onLoadComplete = function() {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n  constructor: THREE.Loader,\r\n\r\n  crossOrigin: undefined,\r\n\r\n  addStatusElement: function() {\r\n\r\n    var e = document.createElement('div');\r\n\r\n    e.style.position = 'absolute';\r\n    e.style.right = '0px';\r\n    e.style.top = '0px';\r\n    e.style.fontSize = '0.8em';\r\n    e.style.textAlign = 'left';\r\n    e.style.background = 'rgba(0,0,0,0.25)';\r\n    e.style.color = '#fff';\r\n    e.style.width = '120px';\r\n    e.style.padding = '0.5em 0.5em 0.5em 0.5em';\r\n    e.style.zIndex = 1000;\r\n\r\n    e.innerHTML = 'Loading ...';\r\n\r\n    return e;\r\n\r\n  },\r\n\r\n  updateProgress: function(progress) {\r\n\r\n    var message = 'Loaded ';\r\n\r\n    if (progress.total) {\r\n\r\n      message += (100 * progress.loaded / progress.total).toFixed(0) + '%';\r\n\r\n\r\n    }\r\n    else {\r\n\r\n      message += (progress.loaded / 1024).toFixed(2) + ' KB';\r\n\r\n    }\r\n\r\n    this.statusDomElement.innerHTML = message;\r\n\r\n  },\r\n\r\n  extractUrlBase: function(url) {\r\n\r\n    var parts = url.split('/');\r\n\r\n    if (parts.length === 1) return './';\r\n\r\n    parts.pop();\r\n\r\n    return parts.join('/') + '/';\r\n\r\n  },\r\n\r\n  initMaterials: function(materials, texturePath) {\r\n\r\n    var array = [];\r\n\r\n    for (var i = 0; i < materials.length; ++i) {\r\n\r\n      array[i] = this.createMaterial(materials[i], texturePath);\r\n\r\n    }\r\n\r\n    return array;\r\n\r\n  },\r\n\r\n  needsTangents: function(materials) {\r\n\r\n    for (var i = 0, il = materials.length; i < il; i++) {\r\n\r\n      var m = materials[i];\r\n\r\n      if (m instanceof THREE.ShaderMaterial) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  },\r\n\r\n  createMaterial: function(m, texturePath) {\r\n\r\n    var scope = this;\r\n\r\n    function nearest_pow2(n) {\r\n\r\n      var l = Math.log(n) / Math.LN2;\r\n      return Math.pow(2, Math.round(l));\r\n\r\n    }\r\n\r\n    function create_texture(where, name, sourceFile, repeat, offset, wrap, anisotropy) {\r\n\r\n      var fullPath = texturePath + sourceFile;\r\n\r\n      var texture;\r\n\r\n      var loader = THREE.Loader.Handlers.get(fullPath);\r\n\r\n      if (loader !== null) {\r\n\r\n        texture = loader.load(fullPath);\r\n\r\n      }\r\n      else {\r\n\r\n        texture = new THREE.Texture();\r\n\r\n        loader = scope.imageLoader;\r\n        loader.crossOrigin = scope.crossOrigin;\r\n        loader.load(fullPath, function(image) {\r\n\r\n          if (THREE.Math.isPowerOfTwo(image.width) === false ||\r\n            THREE.Math.isPowerOfTwo(image.height) === false) {\r\n\r\n            var width = nearest_pow2(image.width);\r\n            var height = nearest_pow2(image.height);\r\n\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n\r\n            var context = canvas.getContext('2d');\r\n            context.drawImage(image, 0, 0, width, height);\r\n\r\n            texture.image = canvas;\r\n\r\n          }\r\n          else {\r\n\r\n            texture.image = image;\r\n\r\n          }\r\n\r\n          texture.needsUpdate = true;\r\n\r\n        });\r\n\r\n      }\r\n\r\n      texture.sourceFile = sourceFile;\r\n\r\n      if (repeat) {\r\n\r\n        texture.repeat.set(repeat[0], repeat[1]);\r\n\r\n        if (repeat[0] !== 1) texture.wrapS = THREE.RepeatWrapping;\r\n        if (repeat[1] !== 1) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n      }\r\n\r\n      if (offset) {\r\n\r\n        texture.offset.set(offset[0], offset[1]);\r\n\r\n      }\r\n\r\n      if (wrap) {\r\n\r\n        var wrapMap = {\r\n          'repeat': THREE.RepeatWrapping,\r\n          'mirror': THREE.MirroredRepeatWrapping\r\n        }\r\n\r\n        if (wrapMap[wrap[0]] !== undefined) texture.wrapS = wrapMap[wrap[0]];\r\n        if (wrapMap[wrap[1]] !== undefined) texture.wrapT = wrapMap[wrap[1]];\r\n\r\n      }\r\n\r\n      if (anisotropy) {\r\n\r\n        texture.anisotropy = anisotropy;\r\n\r\n      }\r\n\r\n      where[name] = texture;\r\n\r\n    }\r\n\r\n    function rgb2hex(rgb) {\r\n\r\n      return (rgb[0] * 255 << 16) + (rgb[1] * 255 << 8) + rgb[2] * 255;\r\n\r\n    }\r\n\r\n    // defaults\r\n\r\n    var mtype = 'MeshLambertMaterial';\r\n    var mpars = {\r\n      color: 0xeeeeee,\r\n      opacity: 1.0,\r\n      map: null,\r\n      lightMap: null,\r\n      normalMap: null,\r\n      bumpMap: null,\r\n      wireframe: false\r\n    };\r\n\r\n    // parameters from model file\r\n\r\n    if (m.shading) {\r\n\r\n      var shading = m.shading.toLowerCase();\r\n\r\n      if (shading === 'phong') mtype = 'MeshPhongMaterial';\r\n      else if (shading === 'basic') mtype = 'MeshBasicMaterial';\r\n\r\n    }\r\n\r\n    if (m.blending !== undefined && THREE[m.blending] !== undefined) {\r\n\r\n      mpars.blending = THREE[m.blending];\r\n\r\n    }\r\n\r\n    if (m.transparent !== undefined) {\r\n\r\n      mpars.transparent = m.transparent;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined && m.opacity < 1.0) {\r\n\r\n      mpars.transparent = true;\r\n\r\n    }\r\n\r\n    if (m.depthTest !== undefined) {\r\n\r\n      mpars.depthTest = m.depthTest;\r\n\r\n    }\r\n\r\n    if (m.depthWrite !== undefined) {\r\n\r\n      mpars.depthWrite = m.depthWrite;\r\n\r\n    }\r\n\r\n    if (m.visible !== undefined) {\r\n\r\n      mpars.visible = m.visible;\r\n\r\n    }\r\n\r\n    if (m.flipSided !== undefined) {\r\n\r\n      mpars.side = THREE.BackSide;\r\n\r\n    }\r\n\r\n    if (m.doubleSided !== undefined) {\r\n\r\n      mpars.side = THREE.DoubleSide;\r\n\r\n    }\r\n\r\n    if (m.wireframe !== undefined) {\r\n\r\n      mpars.wireframe = m.wireframe;\r\n\r\n    }\r\n\r\n    if (m.vertexColors !== undefined) {\r\n\r\n      if (m.vertexColors === 'face') {\r\n\r\n        mpars.vertexColors = THREE.FaceColors;\r\n\r\n      }\r\n      else if (m.vertexColors) {\r\n\r\n        mpars.vertexColors = THREE.VertexColors;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // colors\r\n\r\n    if (m.colorDiffuse) {\r\n\r\n      mpars.color = rgb2hex(m.colorDiffuse);\r\n\r\n    }\r\n    else if (m.DbgColor) {\r\n\r\n      mpars.color = m.DbgColor;\r\n\r\n    }\r\n\r\n    if (m.colorSpecular) {\r\n\r\n      mpars.specular = rgb2hex(m.colorSpecular);\r\n\r\n    }\r\n\r\n    if (m.colorEmissive) {\r\n\r\n      mpars.emissive = rgb2hex(m.colorEmissive);\r\n\r\n    }\r\n\r\n    // modifiers\r\n\r\n    if (m.transparency !== undefined) {\r\n\r\n      console.warn('THREE.Loader: transparency has been renamed to opacity');\r\n      m.opacity = m.transparency;\r\n\r\n    }\r\n\r\n    if (m.opacity !== undefined) {\r\n\r\n      mpars.opacity = m.opacity;\r\n\r\n    }\r\n\r\n    if (m.specularCoef) {\r\n\r\n      mpars.shininess = m.specularCoef;\r\n\r\n    }\r\n\r\n    // textures\r\n\r\n    if (m.mapDiffuse && texturePath) {\r\n\r\n      create_texture(mpars, 'map', m.mapDiffuse, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapLight && texturePath) {\r\n\r\n      create_texture(mpars, 'lightMap', m.mapLight, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapBump && texturePath) {\r\n\r\n      create_texture(mpars, 'bumpMap', m.mapBump, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapNormal && texturePath) {\r\n\r\n      create_texture(mpars, 'normalMap', m.mapNormal, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapSpecular && texturePath) {\r\n\r\n      create_texture(mpars, 'specularMap', m.mapSpecular, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy);\r\n\r\n    }\r\n\r\n    if (m.mapAlpha && texturePath) {\r\n\r\n      create_texture(mpars, 'alphaMap', m.mapAlpha, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy);\r\n\r\n    }\r\n\r\n    //\r\n\r\n    if (m.mapBumpScale) {\r\n\r\n      mpars.bumpScale = m.mapBumpScale;\r\n\r\n    }\r\n\r\n    if (m.mapNormalFactor) {\r\n\r\n      mpars.normalScale = new THREE.Vector2(m.mapNormalFactor, m.mapNormalFactor);\r\n\r\n    }\r\n\r\n    var material = new THREE[mtype](mpars);\r\n\r\n    if (m.DbgName !== undefined) material.name = m.DbgName;\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n  handlers: [],\r\n\r\n  add: function(regex, loader) {\r\n\r\n    this.handlers.push(regex, loader);\r\n\r\n  },\r\n\r\n  get: function(file) {\r\n\r\n    for (var i = 0, l = this.handlers.length; i < l; i += 2) {\r\n\r\n      var regex = this.handlers[i];\r\n      var loader = this.handlers[i + 1];\r\n\r\n      if (regex.test(file)) {\r\n\r\n        return loader;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return null;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n  constructor: THREE.XHRLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      if (onLoad) onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open('GET', url, true);\r\n\r\n    request.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this.response);\r\n\r\n      if (onLoad) onLoad(this.response);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      request.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      request.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) request.crossOrigin = this.crossOrigin;\r\n    if (this.responseType !== undefined) request.responseType = this.responseType;\r\n\r\n    request.send(null);\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n  },\r\n\r\n  setResponseType: function(value) {\r\n\r\n    this.responseType = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n  constructor: THREE.ImageLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var cached = THREE.Cache.get(url);\r\n\r\n    if (cached !== undefined) {\r\n\r\n      onLoad(cached);\r\n      return;\r\n\r\n    }\r\n\r\n    var image = document.createElement('img');\r\n\r\n    image.addEventListener('load', function(event) {\r\n\r\n      THREE.Cache.add(url, this);\r\n\r\n      if (onLoad) onLoad(this);\r\n\r\n      scope.manager.itemEnd(url);\r\n\r\n    }, false);\r\n\r\n    if (onProgress !== undefined) {\r\n\r\n      image.addEventListener('progress', function(event) {\r\n\r\n        onProgress(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (onError !== undefined) {\r\n\r\n      image.addEventListener('error', function(event) {\r\n\r\n        onError(event);\r\n\r\n      }, false);\r\n\r\n    }\r\n\r\n    if (this.crossOrigin !== undefined) image.crossOrigin = this.crossOrigin;\r\n\r\n    image.src = url;\r\n\r\n    scope.manager.itemStart(url);\r\n\r\n    return image;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n}\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function(showStatus) {\r\n\r\n  THREE.Loader.call(this, showStatus);\r\n\r\n  this.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = Object.create(THREE.Loader.prototype);\r\nTHREE.JSONLoader.prototype.constructor = THREE.JSONLoader;\r\n\r\nTHREE.JSONLoader.prototype.load = function(url, callback, texturePath) {\r\n\r\n  // todo: unify load API to for easier SceneLoader use\r\n\r\n  texturePath = texturePath && (typeof texturePath === 'string') ? texturePath : this.extractUrlBase(url);\r\n\r\n  this.onLoadStart();\r\n  this.loadAjaxJSON(this, url, callback, texturePath);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.loadAjaxJSON = function(context, url, callback, texturePath, callbackProgress) {\r\n\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  var length = 0;\r\n\r\n  xhr.onreadystatechange = function() {\r\n\r\n    if (xhr.readyState === xhr.DONE) {\r\n\r\n      if (xhr.status === 200 || xhr.status === 0) {\r\n\r\n        if (xhr.responseText) {\r\n\r\n          var json = JSON.parse(xhr.responseText);\r\n          var metadata = json.metadata;\r\n\r\n          if (metadata !== undefined) {\r\n\r\n            if (metadata.type === 'object') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n            if (metadata.type === 'scene') {\r\n\r\n              THREE.error('THREE.JSONLoader: ' + url + ' seems to be a Scene. Use THREE.SceneLoader instead.');\r\n              return;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          var result = context.parse(json, texturePath);\r\n          callback(result.geometry, result.materials);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error('THREE.JSONLoader: ' + url + ' seems to be unreachable or the file is empty.');\r\n\r\n        }\r\n\r\n        // in context of more complex asset initialization\r\n        // do not block on single failed file\r\n        // maybe should go even one more level up\r\n\r\n        context.onLoadComplete();\r\n\r\n      }\r\n      else {\r\n\r\n        THREE.error('THREE.JSONLoader: Couldn\\'t load ' + url + ' (' + xhr.status + ')');\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.LOADING) {\r\n\r\n      if (callbackProgress) {\r\n\r\n        if (length === 0) {\r\n\r\n          length = xhr.getResponseHeader('Content-Length');\r\n\r\n        }\r\n\r\n        callbackProgress({\r\n          total: length,\r\n          loaded: xhr.responseText.length\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n    else if (xhr.readyState === xhr.HEADERS_RECEIVED) {\r\n\r\n      if (callbackProgress !== undefined) {\r\n\r\n        length = xhr.getResponseHeader('Content-Length');\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  xhr.open('GET', url, true);\r\n  xhr.withCredentials = this.withCredentials;\r\n  xhr.send(null);\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype.parse = function(json, texturePath) {\r\n\r\n  var geometry = new THREE.Geometry(),\r\n    scale = (json.scale !== undefined) ? 1.0 / json.scale : 1.0;\r\n\r\n  parseModel(scale);\r\n\r\n  parseSkin();\r\n  parseMorphing(scale);\r\n\r\n  geometry.computeFaceNormals();\r\n  geometry.computeBoundingSphere();\r\n\r\n  function parseModel(scale) {\r\n\r\n    function isBitSet(value, position) {\r\n\r\n      return value & (1 << position);\r\n\r\n    }\r\n\r\n    var i, j, fi,\r\n\r\n      offset, zLength,\r\n\r\n      colorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n      type,\r\n      isQuad,\r\n      hasMaterial,\r\n      hasFaceVertexUv,\r\n      hasFaceNormal, hasFaceVertexNormal,\r\n      hasFaceColor, hasFaceVertexColor,\r\n\r\n      vertex, face, faceA, faceB, hex, normal,\r\n\r\n      uvLayer, uv, u, v,\r\n\r\n      faces = json.faces,\r\n      vertices = json.vertices,\r\n      normals = json.normals,\r\n      colors = json.colors,\r\n\r\n      nUvLayers = 0;\r\n\r\n    if (json.uvs !== undefined) {\r\n\r\n      // disregard empty arrays\r\n\r\n      for (i = 0; i < json.uvs.length; i++) {\r\n\r\n        if (json.uvs[i].length) nUvLayers++;\r\n\r\n      }\r\n\r\n      for (i = 0; i < nUvLayers; i++) {\r\n\r\n        geometry.faceVertexUvs[i] = [];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = vertices.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      vertex = new THREE.Vector3();\r\n\r\n      vertex.x = vertices[offset++] * scale;\r\n      vertex.y = vertices[offset++] * scale;\r\n      vertex.z = vertices[offset++] * scale;\r\n\r\n      geometry.vertices.push(vertex);\r\n\r\n    }\r\n\r\n    offset = 0;\r\n    zLength = faces.length;\r\n\r\n    while (offset < zLength) {\r\n\r\n      type = faces[offset++];\r\n\r\n\r\n      isQuad = isBitSet(type, 0);\r\n      hasMaterial = isBitSet(type, 1);\r\n      hasFaceVertexUv = isBitSet(type, 3);\r\n      hasFaceNormal = isBitSet(type, 4);\r\n      hasFaceVertexNormal = isBitSet(type, 5);\r\n      hasFaceColor = isBitSet(type, 6);\r\n      hasFaceVertexColor = isBitSet(type, 7);\r\n\r\n      // console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n      if (isQuad) {\r\n\r\n        faceA = new THREE.Face3();\r\n        faceA.a = faces[offset];\r\n        faceA.b = faces[offset + 1];\r\n        faceA.c = faces[offset + 3];\r\n\r\n        faceB = new THREE.Face3();\r\n        faceB.a = faces[offset + 1];\r\n        faceB.b = faces[offset + 2];\r\n        faceB.c = faces[offset + 3];\r\n\r\n        offset += 4;\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          faceA.materialIndex = materialIndex;\r\n          faceB.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n            geometry.faceVertexUvs[i][fi + 1] = []\r\n\r\n            for (j = 0; j < 4; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              if (j !== 2) geometry.faceVertexUvs[i][fi].push(uv);\r\n              if (j !== 0) geometry.faceVertexUvs[i][fi + 1].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          faceA.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n          faceB.normal.copy(faceA.normal);\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n\r\n            if (i !== 2) faceA.vertexNormals.push(normal);\r\n            if (i !== 0) faceB.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          hex = colors[colorIndex];\r\n\r\n          faceA.color.setHex(hex);\r\n          faceB.color.setHex(hex);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 4; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            hex = colors[colorIndex];\r\n\r\n            if (i !== 2) faceA.vertexColors.push(new THREE.Color(hex));\r\n            if (i !== 0) faceB.vertexColors.push(new THREE.Color(hex));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(faceA);\r\n        geometry.faces.push(faceB);\r\n\r\n      }\r\n      else {\r\n\r\n        face = new THREE.Face3();\r\n        face.a = faces[offset++];\r\n        face.b = faces[offset++];\r\n        face.c = faces[offset++];\r\n\r\n        if (hasMaterial) {\r\n\r\n          materialIndex = faces[offset++];\r\n          face.materialIndex = materialIndex;\r\n\r\n        }\r\n\r\n        // to get face <=> uv index correspondence\r\n\r\n        fi = geometry.faces.length;\r\n\r\n        if (hasFaceVertexUv) {\r\n\r\n          for (i = 0; i < nUvLayers; i++) {\r\n\r\n            uvLayer = json.uvs[i];\r\n\r\n            geometry.faceVertexUvs[i][fi] = [];\r\n\r\n            for (j = 0; j < 3; j++) {\r\n\r\n              uvIndex = faces[offset++];\r\n\r\n              u = uvLayer[uvIndex * 2];\r\n              v = uvLayer[uvIndex * 2 + 1];\r\n\r\n              uv = new THREE.Vector2(u, v);\r\n\r\n              geometry.faceVertexUvs[i][fi].push(uv);\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (hasFaceNormal) {\r\n\r\n          normalIndex = faces[offset++] * 3;\r\n\r\n          face.normal.set(\r\n            normals[normalIndex++],\r\n            normals[normalIndex++],\r\n            normals[normalIndex]\r\n          );\r\n\r\n        }\r\n\r\n        if (hasFaceVertexNormal) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalIndex = faces[offset++] * 3;\r\n\r\n            normal = new THREE.Vector3(\r\n              normals[normalIndex++],\r\n              normals[normalIndex++],\r\n              normals[normalIndex]\r\n            );\r\n\r\n            face.vertexNormals.push(normal);\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceColor) {\r\n\r\n          colorIndex = faces[offset++];\r\n          face.color.setHex(colors[colorIndex]);\r\n\r\n        }\r\n\r\n\r\n        if (hasFaceVertexColor) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            colorIndex = faces[offset++];\r\n            face.vertexColors.push(new THREE.Color(colors[colorIndex]));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        geometry.faces.push(face);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function parseSkin() {\r\n    var influencesPerVertex = (json.influencesPerVertex !== undefined) ? json.influencesPerVertex : 2;\r\n\r\n    if (json.skinWeights) {\r\n\r\n      for (var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex) {\r\n\r\n        var x = json.skinWeights[i];\r\n        var y = (influencesPerVertex > 1) ? json.skinWeights[i + 1] : 0;\r\n        var z = (influencesPerVertex > 2) ? json.skinWeights[i + 2] : 0;\r\n        var w = (influencesPerVertex > 3) ? json.skinWeights[i + 3] : 0;\r\n\r\n        geometry.skinWeights.push(new THREE.Vector4(x, y, z, w));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.skinIndices) {\r\n\r\n      for (var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex) {\r\n\r\n        var a = json.skinIndices[i];\r\n        var b = (influencesPerVertex > 1) ? json.skinIndices[i + 1] : 0;\r\n        var c = (influencesPerVertex > 2) ? json.skinIndices[i + 2] : 0;\r\n        var d = (influencesPerVertex > 3) ? json.skinIndices[i + 3] : 0;\r\n\r\n        geometry.skinIndices.push(new THREE.Vector4(a, b, c, d));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.bones = json.bones;\r\n\r\n    if (geometry.bones && geometry.bones.length > 0 && (geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length)) {\r\n\r\n      THREE.warn('THREE.JSONLoader: When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n        geometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.');\r\n\r\n    }\r\n\r\n\r\n    // could change this to json.animations[0] or remove completely\r\n\r\n    geometry.animation = json.animation;\r\n    geometry.animations = json.animations;\r\n\r\n  };\r\n\r\n  function parseMorphing(scale) {\r\n\r\n    if (json.morphTargets !== undefined) {\r\n\r\n      var i, l, v, vl, dstVertices, srcVertices;\r\n\r\n      for (i = 0, l = json.morphTargets.length; i < l; i++) {\r\n\r\n        geometry.morphTargets[i] = {};\r\n        geometry.morphTargets[i].name = json.morphTargets[i].name;\r\n        geometry.morphTargets[i].vertices = [];\r\n\r\n        dstVertices = geometry.morphTargets[i].vertices;\r\n        srcVertices = json.morphTargets[i].vertices;\r\n\r\n        for (v = 0, vl = srcVertices.length; v < vl; v += 3) {\r\n\r\n          var vertex = new THREE.Vector3();\r\n          vertex.x = srcVertices[v] * scale;\r\n          vertex.y = srcVertices[v + 1] * scale;\r\n          vertex.z = srcVertices[v + 2] * scale;\r\n\r\n          dstVertices.push(vertex);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (json.morphColors !== undefined) {\r\n\r\n      var i, l, c, cl, dstColors, srcColors, color;\r\n\r\n      for (i = 0, l = json.morphColors.length; i < l; i++) {\r\n\r\n        geometry.morphColors[i] = {};\r\n        geometry.morphColors[i].name = json.morphColors[i].name;\r\n        geometry.morphColors[i].colors = [];\r\n\r\n        dstColors = geometry.morphColors[i].colors;\r\n        srcColors = json.morphColors[i].colors;\r\n\r\n        for (c = 0, cl = srcColors.length; c < cl; c += 3) {\r\n\r\n          color = new THREE.Color(0xffaa00);\r\n          color.setRGB(srcColors[c], srcColors[c + 1], srcColors[c + 2]);\r\n          dstColors.push(color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  if (json.materials === undefined || json.materials.length === 0) {\r\n\r\n    return {\r\n      geometry: geometry\r\n    };\r\n\r\n  }\r\n  else {\r\n\r\n    var materials = this.initMaterials(json.materials, texturePath);\r\n\r\n    if (this.needsTangents(materials)) {\r\n\r\n      geometry.computeTangents();\r\n\r\n    }\r\n\r\n    return {\r\n      geometry: geometry,\r\n      materials: materials\r\n    };\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function(onLoad, onProgress, onError) {\r\n\r\n  var scope = this;\r\n\r\n  var loaded = 0,\r\n    total = 0;\r\n\r\n  this.onLoad = onLoad;\r\n  this.onProgress = onProgress;\r\n  this.onError = onError;\r\n\r\n  this.itemStart = function(url) {\r\n\r\n    total++;\r\n\r\n  };\r\n\r\n  this.itemEnd = function(url) {\r\n\r\n    loaded++;\r\n\r\n    if (scope.onProgress !== undefined) {\r\n\r\n      scope.onProgress(url, loaded, total);\r\n\r\n    }\r\n\r\n    if (loaded === total && scope.onLoad !== undefined) {\r\n\r\n      scope.onLoad();\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n  constructor: THREE.BufferGeometryLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var geometry = new THREE.BufferGeometry();\r\n\r\n    var attributes = json.data.attributes;\r\n\r\n    for (var key in attributes) {\r\n\r\n      var attribute = attributes[key];\r\n      var typedArray = new self[attribute.type](attribute.array);\r\n\r\n      geometry.addAttribute(key, new THREE.BufferAttribute(typedArray, attribute.itemSize));\r\n\r\n    }\r\n\r\n    var offsets = json.data.offsets;\r\n\r\n    if (offsets !== undefined) {\r\n\r\n      geometry.offsets = JSON.parse(JSON.stringify(offsets));\r\n\r\n    }\r\n\r\n    var boundingSphere = json.data.boundingSphere;\r\n\r\n    if (boundingSphere !== undefined) {\r\n\r\n      var center = new THREE.Vector3();\r\n\r\n      if (boundingSphere.center !== undefined) {\r\n\r\n        center.fromArray(boundingSphere.center);\r\n\r\n      }\r\n\r\n      geometry.boundingSphere = new THREE.Sphere(center, boundingSphere.radius);\r\n\r\n    }\r\n\r\n    return geometry;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n  constructor: THREE.MaterialLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      onLoad(scope.parse(JSON.parse(text)));\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json) {\r\n\r\n    var material = new THREE[json.type];\r\n\r\n    if (json.color !== undefined) material.color.setHex(json.color);\r\n    if (json.emissive !== undefined) material.emissive.setHex(json.emissive);\r\n    if (json.specular !== undefined) material.specular.setHex(json.specular);\r\n    if (json.shininess !== undefined) material.shininess = json.shininess;\r\n    if (json.uniforms !== undefined) material.uniforms = json.uniforms;\r\n    if (json.vertexShader !== undefined) material.vertexShader = json.vertexShader;\r\n    if (json.fragmentShader !== undefined) material.fragmentShader = json.fragmentShader;\r\n    if (json.vertexColors !== undefined) material.vertexColors = json.vertexColors;\r\n    if (json.shading !== undefined) material.shading = json.shading;\r\n    if (json.blending !== undefined) material.blending = json.blending;\r\n    if (json.side !== undefined) material.side = json.side;\r\n    if (json.opacity !== undefined) material.opacity = json.opacity;\r\n    if (json.transparent !== undefined) material.transparent = json.transparent;\r\n    if (json.wireframe !== undefined) material.wireframe = json.wireframe;\r\n\r\n    // for PointCloudMaterial\r\n    if (json.size !== undefined) material.size = json.size;\r\n    if (json.sizeAttenuation !== undefined) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n    if (json.materials !== undefined) {\r\n\r\n      for (var i = 0, l = json.materials.length; i < l; i++) {\r\n\r\n        material.materials.push(this.parse(json.materials[i]));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n  this.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n  constructor: THREE.ObjectLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    if (this.texturePath === '') {\r\n\r\n      this.texturePath = url.substring(0, url.lastIndexOf('/') + 1);\r\n\r\n    }\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.XHRLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(text) {\r\n\r\n      scope.parse(JSON.parse(text), onLoad);\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setTexturePath: function(value) {\r\n\r\n    this.texturePath = value;\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  },\r\n\r\n  parse: function(json, onLoad) {\r\n\r\n    var geometries = this.parseGeometries(json.geometries);\r\n\r\n    var images = this.parseImages(json.images, function() {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    });\r\n    var textures = this.parseTextures(json.textures, images);\r\n    var materials = this.parseMaterials(json.materials, textures);\r\n    var object = this.parseObject(json.object, geometries, materials);\r\n\r\n    if (json.images === undefined || json.images.length === 0) {\r\n\r\n      if (onLoad !== undefined) onLoad(object);\r\n\r\n    }\r\n\r\n    return object;\r\n\r\n  },\r\n\r\n  parseGeometries: function(json) {\r\n\r\n    var geometries = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var geometryLoader = new THREE.JSONLoader();\r\n      var bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var geometry;\r\n        var data = json[i];\r\n\r\n        switch (data.type) {\r\n\r\n          case 'PlaneGeometry':\r\n          case 'PlaneBufferGeometry':\r\n\r\n            geometry = new THREE[data.type](\r\n              data.width,\r\n              data.height,\r\n              data.widthSegments,\r\n              data.heightSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BoxGeometry':\r\n          case 'CubeGeometry': // backwards compatible\r\n\r\n            geometry = new THREE.BoxGeometry(\r\n              data.width,\r\n              data.height,\r\n              data.depth,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.depthSegments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CircleGeometry':\r\n\r\n            geometry = new THREE.CircleGeometry(\r\n              data.radius,\r\n              data.segments\r\n            );\r\n\r\n            break;\r\n\r\n          case 'CylinderGeometry':\r\n\r\n            geometry = new THREE.CylinderGeometry(\r\n              data.radiusTop,\r\n              data.radiusBottom,\r\n              data.height,\r\n              data.radialSegments,\r\n              data.heightSegments,\r\n              data.openEnded\r\n            );\r\n\r\n            break;\r\n\r\n          case 'SphereGeometry':\r\n\r\n            geometry = new THREE.SphereGeometry(\r\n              data.radius,\r\n              data.widthSegments,\r\n              data.heightSegments,\r\n              data.phiStart,\r\n              data.phiLength,\r\n              data.thetaStart,\r\n              data.thetaLength\r\n            );\r\n\r\n            break;\r\n\r\n          case 'IcosahedronGeometry':\r\n\r\n            geometry = new THREE.IcosahedronGeometry(\r\n              data.radius,\r\n              data.detail\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusGeometry':\r\n\r\n            geometry = new THREE.TorusGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.arc\r\n            );\r\n\r\n            break;\r\n\r\n          case 'TorusKnotGeometry':\r\n\r\n            geometry = new THREE.TorusKnotGeometry(\r\n              data.radius,\r\n              data.tube,\r\n              data.radialSegments,\r\n              data.tubularSegments,\r\n              data.p,\r\n              data.q,\r\n              data.heightScale\r\n            );\r\n\r\n            break;\r\n\r\n          case 'BufferGeometry':\r\n\r\n            geometry = bufferGeometryLoader.parse(data);\r\n\r\n            break;\r\n\r\n          case 'Geometry':\r\n\r\n            geometry = geometryLoader.parse(data.data).geometry;\r\n\r\n            break;\r\n\r\n        }\r\n\r\n        geometry.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) geometry.name = data.name;\r\n\r\n        geometries[data.uuid] = geometry;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return geometries;\r\n\r\n  },\r\n\r\n  parseMaterials: function(json, textures) {\r\n\r\n    var materials = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      var getTexture = function(name) {\r\n\r\n        if (textures[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined texture', name);\r\n\r\n        }\r\n\r\n        return textures[name];\r\n\r\n      };\r\n\r\n      var loader = new THREE.MaterialLoader();\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n        var material = loader.parse(data);\r\n\r\n        material.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) material.name = data.name;\r\n\r\n        if (data.map !== undefined) {\r\n\r\n          material.map = getTexture(data.map);\r\n\r\n        }\r\n\r\n        if (data.bumpMap !== undefined) {\r\n\r\n          material.bumpMap = getTexture(data.bumpMap);\r\n          if (data.bumpScale) {\r\n            material.bumpScale = new THREE.Vector2(data.bumpScale, data.bumpScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.alphaMap !== undefined) {\r\n\r\n          material.alphaMap = getTexture(data.alphaMap);\r\n\r\n        }\r\n\r\n        if (data.envMap !== undefined) {\r\n\r\n          material.envMap = getTexture(data.envMap);\r\n\r\n        }\r\n\r\n        if (data.normalMap !== undefined) {\r\n\r\n          material.normalMap = getTexture(data.normalMap);\r\n          if (data.normalScale) {\r\n            material.normalScale = new THREE.Vector2(data.normalScale, data.normalScale);\r\n          }\r\n\r\n        }\r\n\r\n        if (data.lightMap !== undefined) {\r\n\r\n          material.lightMap = getTexture(data.lightMap);\r\n\r\n        }\r\n\r\n        if (data.specularMap !== undefined) {\r\n\r\n          material.specularMap = getTexture(data.specularMap);\r\n\r\n        }\r\n\r\n        materials[data.uuid] = material;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return materials;\r\n\r\n  },\r\n\r\n  parseImages: function(json, onLoad) {\r\n\r\n    var scope = this;\r\n    var images = {};\r\n\r\n    if (json !== undefined && json.length > 0) {\r\n\r\n      var manager = new THREE.LoadingManager(onLoad);\r\n\r\n      var loader = new THREE.ImageLoader(manager);\r\n      loader.setCrossOrigin(this.crossOrigin);\r\n\r\n      var loadImage = function(url) {\r\n\r\n        scope.manager.itemStart(url);\r\n\r\n        return loader.load(url, function() {\r\n\r\n          scope.manager.itemEnd(url);\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var image = json[i];\r\n        var path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(image.url) ? image.url : scope.texturePath + image.url;\r\n\r\n        images[image.uuid] = loadImage(path);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return images;\r\n\r\n  },\r\n\r\n  parseTextures: function(json, images) {\r\n\r\n    var textures = {};\r\n\r\n    if (json !== undefined) {\r\n\r\n      for (var i = 0, l = json.length; i < l; i++) {\r\n\r\n        var data = json[i];\r\n\r\n        if (data.image === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: No \"image\" speficied for', data.uuid);\r\n\r\n        }\r\n\r\n        if (images[data.image] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined image', data.image);\r\n\r\n        }\r\n\r\n        var texture = new THREE.Texture(images[data.image]);\r\n        texture.needsUpdate = true;\r\n\r\n        texture.uuid = data.uuid;\r\n\r\n        if (data.name !== undefined) texture.name = data.name;\r\n        if (data.repeat !== undefined) texture.repeat = new THREE.Vector2(data.repeat[0], data.repeat[1]);\r\n        if (data.minFilter !== undefined) texture.minFilter = THREE[data.minFilter];\r\n        if (data.magFilter !== undefined) texture.magFilter = THREE[data.magFilter];\r\n        if (data.anisotropy !== undefined) texture.anisotropy = data.anisotropy;\r\n        if (data.wrap instanceof Array) {\r\n\r\n          texture.wrapS = THREE[data.wrap[0]];\r\n          texture.wrapT = THREE[data.wrap[1]];\r\n\r\n        }\r\n\r\n        textures[data.uuid] = texture;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return textures;\r\n\r\n  },\r\n\r\n  parseObject: function() {\r\n\r\n    var matrix = new THREE.Matrix4();\r\n\r\n    return function(data, geometries, materials) {\r\n\r\n      var object;\r\n\r\n      var getGeometry = function(name) {\r\n\r\n        if (geometries[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined geometry', name);\r\n\r\n        }\r\n\r\n        return geometries[name];\r\n\r\n      };\r\n\r\n      var getMaterial = function(name) {\r\n\r\n        if (materials[name] === undefined) {\r\n\r\n          THREE.warn('THREE.ObjectLoader: Undefined material', name);\r\n\r\n        }\r\n\r\n        return materials[name];\r\n\r\n      };\r\n\r\n      switch (data.type) {\r\n\r\n        case 'Scene':\r\n\r\n          object = new THREE.Scene();\r\n\r\n          break;\r\n\r\n        case 'PerspectiveCamera':\r\n\r\n          object = new THREE.PerspectiveCamera(data.fov, data.aspect, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'OrthographicCamera':\r\n\r\n          object = new THREE.OrthographicCamera(data.left, data.right, data.top, data.bottom, data.near, data.far);\r\n\r\n          break;\r\n\r\n        case 'AmbientLight':\r\n\r\n          object = new THREE.AmbientLight(data.color);\r\n\r\n          break;\r\n\r\n        case 'DirectionalLight':\r\n\r\n          object = new THREE.DirectionalLight(data.color, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'PointLight':\r\n\r\n          object = new THREE.PointLight(data.color, data.intensity, data.distance, data.decay);\r\n\r\n          break;\r\n\r\n        case 'SpotLight':\r\n\r\n          object = new THREE.SpotLight(data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay);\r\n\r\n          break;\r\n\r\n        case 'HemisphereLight':\r\n\r\n          object = new THREE.HemisphereLight(data.color, data.groundColor, data.intensity);\r\n\r\n          break;\r\n\r\n        case 'Mesh':\r\n\r\n          object = new THREE.Mesh(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Line':\r\n\r\n          object = new THREE.Line(getGeometry(data.geometry), getMaterial(data.material), data.mode);\r\n\r\n          break;\r\n\r\n        case 'PointCloud':\r\n\r\n          object = new THREE.PointCloud(getGeometry(data.geometry), getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Sprite':\r\n\r\n          object = new THREE.Sprite(getMaterial(data.material));\r\n\r\n          break;\r\n\r\n        case 'Group':\r\n\r\n          object = new THREE.Group();\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          object = new THREE.Object3D();\r\n\r\n      }\r\n\r\n      object.uuid = data.uuid;\r\n\r\n      if (data.name !== undefined) object.name = data.name;\r\n      if (data.matrix !== undefined) {\r\n\r\n        matrix.fromArray(data.matrix);\r\n        matrix.decompose(object.position, object.quaternion, object.scale);\r\n\r\n      }\r\n      else {\r\n\r\n        if (data.position !== undefined) object.position.fromArray(data.position);\r\n        if (data.rotation !== undefined) object.rotation.fromArray(data.rotation);\r\n        if (data.scale !== undefined) object.scale.fromArray(data.scale);\r\n\r\n      }\r\n\r\n      if (data.visible !== undefined) object.visible = data.visible;\r\n      if (data.userData !== undefined) object.userData = data.userData;\r\n\r\n      if (data.children !== undefined) {\r\n\r\n        for (var child in data.children) {\r\n\r\n          object.add(this.parseObject(data.children[child], geometries, materials));\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return object;\r\n\r\n    }\r\n\r\n  }()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function(manager) {\r\n\r\n  this.manager = (manager !== undefined) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n  constructor: THREE.TextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var loader = new THREE.ImageLoader(scope.manager);\r\n    loader.setCrossOrigin(this.crossOrigin);\r\n    loader.load(url, function(image) {\r\n\r\n      var texture = new THREE.Texture(image);\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad !== undefined) {\r\n\r\n        onLoad(texture);\r\n\r\n      }\r\n\r\n    }, onProgress, onError);\r\n\r\n  },\r\n\r\n  setCrossOrigin: function(value) {\r\n\r\n    this.crossOrigin = value;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n  constructor: THREE.BinaryTextureLoader,\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var texture = new THREE.DataTexture();\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    loader.load(url, function(buffer) {\r\n\r\n      var texData = scope._parser(buffer);\r\n\r\n      if (!texData) return;\r\n\r\n      if (undefined !== texData.image) {\r\n\r\n        texture.image = texData.image;\r\n\r\n      }\r\n      else if (undefined !== texData.data) {\r\n\r\n        texture.image.width = texData.width;\r\n        texture.image.height = texData.height;\r\n        texture.image.data = texData.data;\r\n\r\n      }\r\n\r\n      texture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n      texture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n      texture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n      texture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n      texture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n      if (undefined !== texData.format) {\r\n\r\n        texture.format = texData.format;\r\n\r\n      }\r\n      if (undefined !== texData.type) {\r\n\r\n        texture.type = texData.type;\r\n\r\n      }\r\n\r\n      if (undefined !== texData.mipmaps) {\r\n\r\n        texture.mipmaps = texData.mipmaps;\r\n\r\n      }\r\n\r\n      if (1 === texData.mipmapCount) {\r\n\r\n        texture.minFilter = THREE.LinearFilter;\r\n\r\n      }\r\n\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture, texData);\r\n\r\n    }, onProgress, onError);\r\n\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function() {\r\n\r\n  // override in sub classes\r\n  this._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n  constructor: THREE.CompressedTextureLoader,\r\n\r\n  load: function(url, onLoad, onError) {\r\n\r\n    var scope = this;\r\n\r\n    var images = [];\r\n\r\n    var texture = new THREE.CompressedTexture();\r\n    texture.image = images;\r\n\r\n    var loader = new THREE.XHRLoader();\r\n    loader.setResponseType('arraybuffer');\r\n\r\n    if (url instanceof Array) {\r\n\r\n      var loaded = 0;\r\n\r\n      var loadTexture = function(i) {\r\n\r\n        loader.load(url[i], function(buffer) {\r\n\r\n          var texDatas = scope._parser(buffer, true);\r\n\r\n          images[i] = {\r\n            width: texDatas.width,\r\n            height: texDatas.height,\r\n            format: texDatas.format,\r\n            mipmaps: texDatas.mipmaps\r\n          };\r\n\r\n          loaded += 1;\r\n\r\n          if (loaded === 6) {\r\n\r\n            if (texDatas.mipmapCount == 1)\r\n              texture.minFilter = THREE.LinearFilter;\r\n\r\n            texture.format = texDatas.format;\r\n            texture.needsUpdate = true;\r\n\r\n            if (onLoad) onLoad(texture);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      };\r\n\r\n      for (var i = 0, il = url.length; i < il; ++i) {\r\n\r\n        loadTexture(i);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // compressed cubemap texture stored in a single DDS file\r\n\r\n      loader.load(url, function(buffer) {\r\n\r\n        var texDatas = scope._parser(buffer, true);\r\n\r\n        if (texDatas.isCubemap) {\r\n\r\n          var faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n          for (var f = 0; f < faces; f++) {\r\n\r\n            images[f] = {\r\n              mipmaps: []\r\n            };\r\n\r\n            for (var i = 0; i < texDatas.mipmapCount; i++) {\r\n\r\n              images[f].mipmaps.push(texDatas.mipmaps[f * texDatas.mipmapCount + i]);\r\n              images[f].format = texDatas.format;\r\n              images[f].width = texDatas.width;\r\n              images[f].height = texDatas.height;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          texture.image.width = texDatas.width;\r\n          texture.image.height = texDatas.height;\r\n          texture.mipmaps = texDatas.mipmaps;\r\n\r\n        }\r\n\r\n        if (texDatas.mipmapCount === 1) {\r\n\r\n          texture.minFilter = THREE.LinearFilter;\r\n\r\n        }\r\n\r\n        texture.format = texDatas.format;\r\n        texture.needsUpdate = true;\r\n\r\n        if (onLoad) onLoad(texture);\r\n\r\n      });\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function() {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.MaterialIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.type = 'Material';\r\n\r\n  this.side = THREE.FrontSide;\r\n\r\n  this.opacity = 1;\r\n  this.transparent = false;\r\n\r\n  this.blending = THREE.NormalBlending;\r\n\r\n  this.blendSrc = THREE.SrcAlphaFactor;\r\n  this.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n  this.blendEquation = THREE.AddEquation;\r\n  this.blendSrcAlpha = null;\r\n  this.blendDstAlpha = null;\r\n  this.blendEquationAlpha = null;\r\n\r\n  this.depthTest = true;\r\n  this.depthWrite = true;\r\n\r\n  this.colorWrite = true;\r\n\r\n  this.polygonOffset = false;\r\n  this.polygonOffsetFactor = 0;\r\n  this.polygonOffsetUnits = 0;\r\n\r\n  this.alphaTest = 0;\r\n\r\n  this.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n  this.visible = true;\r\n\r\n  this._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n  constructor: THREE.Material,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  setValues: function(values) {\r\n\r\n    if (values === undefined) return;\r\n\r\n    for (var key in values) {\r\n\r\n      var newValue = values[key];\r\n\r\n      if (newValue === undefined) {\r\n\r\n        THREE.warn(\"THREE.Material: '\" + key + \"' parameter is undefined.\");\r\n        continue;\r\n\r\n      }\r\n\r\n      if (key in this) {\r\n\r\n        var currentValue = this[key];\r\n\r\n        if (currentValue instanceof THREE.Color) {\r\n\r\n          currentValue.set(newValue);\r\n\r\n        }\r\n        else if (currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3) {\r\n\r\n          currentValue.copy(newValue);\r\n\r\n        }\r\n        else if (key == 'overdraw') {\r\n\r\n          // ensure overdraw is backwards-compatable with legacy boolean type\r\n          this[key] = Number(newValue);\r\n\r\n        }\r\n        else {\r\n\r\n          this[key] = newValue;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type\r\n    };\r\n\r\n    if (this.name !== \"\") output.name = this.name;\r\n\r\n    if (this instanceof THREE.MeshBasicMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshLambertMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshPhongMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n      output.emissive = this.emissive.getHex();\r\n      output.specular = this.specular.getHex();\r\n      output.shininess = this.shininess;\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.shading !== THREE.SmoothShading) output.shading = this.shading;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshNormalMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.MeshDepthMaterial) {\r\n\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n      if (this.side !== THREE.FrontSide) output.side = this.side;\r\n\r\n    }\r\n    else if (this instanceof THREE.PointCloudMaterial) {\r\n\r\n      output.size = this.size;\r\n      output.sizeAttenuation = this.sizeAttenuation;\r\n      output.color = this.color.getHex();\r\n\r\n      if (this.vertexColors !== THREE.NoColors) output.vertexColors = this.vertexColors;\r\n      if (this.blending !== THREE.NormalBlending) output.blending = this.blending;\r\n\r\n    }\r\n    else if (this instanceof THREE.ShaderMaterial) {\r\n\r\n      output.uniforms = this.uniforms;\r\n      output.vertexShader = this.vertexShader;\r\n      output.fragmentShader = this.fragmentShader;\r\n\r\n    }\r\n    else if (this instanceof THREE.SpriteMaterial) {\r\n\r\n      output.color = this.color.getHex();\r\n\r\n    }\r\n\r\n    if (this.opacity < 1) output.opacity = this.opacity;\r\n    if (this.transparent !== false) output.transparent = this.transparent;\r\n    if (this.wireframe !== false) output.wireframe = this.wireframe;\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function(material) {\r\n\r\n    if (material === undefined) material = new THREE.Material();\r\n\r\n    material.name = this.name;\r\n\r\n    material.side = this.side;\r\n\r\n    material.opacity = this.opacity;\r\n    material.transparent = this.transparent;\r\n\r\n    material.blending = this.blending;\r\n\r\n    material.blendSrc = this.blendSrc;\r\n    material.blendDst = this.blendDst;\r\n    material.blendEquation = this.blendEquation;\r\n    material.blendSrcAlpha = this.blendSrcAlpha;\r\n    material.blendDstAlpha = this.blendDstAlpha;\r\n    material.blendEquationAlpha = this.blendEquationAlpha;\r\n\r\n    material.depthTest = this.depthTest;\r\n    material.depthWrite = this.depthWrite;\r\n\r\n    material.polygonOffset = this.polygonOffset;\r\n    material.polygonOffsetFactor = this.polygonOffsetFactor;\r\n    material.polygonOffsetUnits = this.polygonOffsetUnits;\r\n\r\n    material.alphaTest = this.alphaTest;\r\n\r\n    material.overdraw = this.overdraw;\r\n\r\n    material.visible = this.visible;\r\n\r\n    return material;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Material.prototype);\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\",\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n  this.linecap = 'round';\r\n  this.linejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n  material.linecap = this.linecap;\r\n  material.linejoin = this.linejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>,\r\n *\r\n *  vertexColors: <bool>\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'LineDashedMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.scale = 1;\r\n  this.dashSize = 3;\r\n  this.gapSize = 1;\r\n\r\n  this.vertexColors = false;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.LineDashedMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.linewidth = this.linewidth;\r\n\r\n  material.scale = this.scale;\r\n  material.dashSize = this.dashSize;\r\n  material.gapSize = this.gapSize;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshBasicMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // emissive\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshBasicMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshLambertMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshLambertMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  emissive: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshPhongMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff); // diffuse\r\n  this.emissive = new THREE.Color(0x000000);\r\n  this.specular = new THREE.Color(0x111111);\r\n  this.shininess = 30;\r\n\r\n  this.metal = false;\r\n\r\n  this.wrapAround = false;\r\n  this.wrapRGB = new THREE.Vector3(1, 1, 1);\r\n\r\n  this.map = null;\r\n\r\n  this.lightMap = null;\r\n\r\n  this.bumpMap = null;\r\n  this.bumpScale = 1;\r\n\r\n  this.normalMap = null;\r\n  this.normalScale = new THREE.Vector2(1, 1);\r\n\r\n  this.specularMap = null;\r\n\r\n  this.alphaMap = null;\r\n\r\n  this.envMap = null;\r\n  this.combine = THREE.MultiplyOperation;\r\n  this.reflectivity = 1;\r\n  this.refractionRatio = 0.98;\r\n\r\n  this.fog = true;\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n  this.wireframeLinecap = 'round';\r\n  this.wireframeLinejoin = 'round';\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.skinning = false;\r\n  this.morphTargets = false;\r\n  this.morphNormals = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshPhongMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.emissive.copy(this.emissive);\r\n  material.specular.copy(this.specular);\r\n  material.shininess = this.shininess;\r\n\r\n  material.metal = this.metal;\r\n\r\n  material.wrapAround = this.wrapAround;\r\n  material.wrapRGB.copy(this.wrapRGB);\r\n\r\n  material.map = this.map;\r\n\r\n  material.lightMap = this.lightMap;\r\n\r\n  material.bumpMap = this.bumpMap;\r\n  material.bumpScale = this.bumpScale;\r\n\r\n  material.normalMap = this.normalMap;\r\n  material.normalScale.copy(this.normalScale);\r\n\r\n  material.specularMap = this.specularMap;\r\n\r\n  material.alphaMap = this.alphaMap;\r\n\r\n  material.envMap = this.envMap;\r\n  material.combine = this.combine;\r\n  material.reflectivity = this.reflectivity;\r\n  material.refractionRatio = this.refractionRatio;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n  material.wireframeLinecap = this.wireframeLinecap;\r\n  material.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'MeshDepthMaterial';\r\n\r\n  this.morphTargets = false;\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshDepthMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  shading: THREE.FlatShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this, parameters);\r\n\r\n  this.type = 'MeshNormalMaterial';\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.morphTargets = false;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.MeshNormalMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/MeshFaceMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MeshFaceMaterial = function(materials) {\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.type = 'MeshFaceMaterial';\r\n\r\n  this.materials = materials instanceof Array ? materials : [];\r\n\r\n};\r\n\r\nTHREE.MeshFaceMaterial.prototype = {\r\n\r\n  constructor: THREE.MeshFaceMaterial,\r\n\r\n  toJSON: function() {\r\n\r\n    var output = {\r\n      metadata: {\r\n        version: 4.2,\r\n        type: 'material',\r\n        generator: 'MaterialExporter'\r\n      },\r\n      uuid: this.uuid,\r\n      type: this.type,\r\n      materials: []\r\n    };\r\n\r\n    for (var i = 0, l = this.materials.length; i < l; i++) {\r\n\r\n      output.materials.push(this.materials[i].toJSON());\r\n\r\n    }\r\n\r\n    return output;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var material = new THREE.MeshFaceMaterial();\r\n\r\n    for (var i = 0; i < this.materials.length; i++) {\r\n\r\n      material.materials.push(this.materials[i].clone());\r\n\r\n    }\r\n\r\n    return material;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/materials/PointCloudMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>,\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  vertexColors: <bool>,\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointCloudMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'PointCloudMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n\r\n  this.map = null;\r\n\r\n  this.size = 1;\r\n  this.sizeAttenuation = true;\r\n\r\n  this.vertexColors = THREE.NoColors;\r\n\r\n  this.fog = true;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.PointCloudMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.PointCloudMaterial.prototype.constructor = THREE.PointCloudMaterial;\r\n\r\nTHREE.PointCloudMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.PointCloudMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n\r\n  material.map = this.map;\r\n\r\n  material.size = this.size;\r\n  material.sizeAttenuation = this.sizeAttenuation;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// backwards compatibility\r\n\r\nTHREE.ParticleBasicMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\nTHREE.ParticleSystemMaterial = function(parameters) {\r\n\r\n  THREE.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.');\r\n  return new THREE.PointCloudMaterial(parameters);\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>,\r\n *\r\n *\tfog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'ShaderMaterial';\r\n\r\n  this.defines = {};\r\n  this.uniforms = {};\r\n  this.attributes = null;\r\n\r\n  this.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n  this.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n  this.shading = THREE.SmoothShading;\r\n\r\n  this.linewidth = 1;\r\n\r\n  this.wireframe = false;\r\n  this.wireframeLinewidth = 1;\r\n\r\n  this.fog = false; // set to use scene fog\r\n\r\n  this.lights = false; // set to use scene lights\r\n\r\n  this.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\r\n\r\n  this.skinning = false; // set to use skinning attribute streams\r\n\r\n  this.morphTargets = false; // set to use morph targets\r\n  this.morphNormals = false; // set to use morph normals\r\n\r\n  // When rendered geometry doesn't include these attributes but the material does,\r\n  // use these default values in WebGL. This avoids errors when buffer data is missing.\r\n  this.defaultAttributeValues = {\r\n    'color': [1, 1, 1],\r\n    'uv': [0, 0],\r\n    'uv2': [0, 0]\r\n  };\r\n\r\n  this.index0AttributeName = undefined;\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.ShaderMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.fragmentShader = this.fragmentShader;\r\n  material.vertexShader = this.vertexShader;\r\n\r\n  material.uniforms = THREE.UniformsUtils.clone(this.uniforms);\r\n\r\n  material.attributes = this.attributes;\r\n  material.defines = this.defines;\r\n\r\n  material.shading = this.shading;\r\n\r\n  material.wireframe = this.wireframe;\r\n  material.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n  material.fog = this.fog;\r\n\r\n  material.lights = this.lights;\r\n\r\n  material.vertexColors = this.vertexColors;\r\n\r\n  material.skinning = this.skinning;\r\n\r\n  material.morphTargets = this.morphTargets;\r\n  material.morphNormals = this.morphNormals;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function(parameters) {\r\n\r\n  THREE.ShaderMaterial.call(this, parameters);\r\n\r\n  this.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype);\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\nTHREE.RawShaderMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.RawShaderMaterial();\r\n\r\n  THREE.ShaderMaterial.prototype.clone.call(this, material);\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  blending: THREE.NormalBlending,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2(),\r\n *\r\n *  fog: <bool>\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function(parameters) {\r\n\r\n  THREE.Material.call(this);\r\n\r\n  this.type = 'SpriteMaterial';\r\n\r\n  this.color = new THREE.Color(0xffffff);\r\n  this.map = null;\r\n\r\n  this.rotation = 0;\r\n\r\n  this.fog = false;\r\n\r\n  // set parameters\r\n\r\n  this.setValues(parameters);\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create(THREE.Material.prototype);\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.clone = function() {\r\n\r\n  var material = new THREE.SpriteMaterial();\r\n\r\n  THREE.Material.prototype.clone.call(this, material);\r\n\r\n  material.color.copy(this.color);\r\n  material.map = this.map;\r\n\r\n  material.rotation = this.rotation;\r\n\r\n  material.fog = this.fog;\r\n\r\n  return material;\r\n\r\n};\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function(image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  Object.defineProperty(this, 'id', {\r\n    value: THREE.TextureIdCount++\r\n  });\r\n\r\n  this.uuid = THREE.Math.generateUUID();\r\n\r\n  this.name = '';\r\n  this.sourceFile = '';\r\n\r\n  this.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n  this.mipmaps = [];\r\n\r\n  this.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n  this.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n  this.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n  this.format = format !== undefined ? format : THREE.RGBAFormat;\r\n  this.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.generateMipmaps = true;\r\n  this.premultiplyAlpha = false;\r\n  this.flipY = true;\r\n  this.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n  this._needsUpdate = false;\r\n  this.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n  constructor: THREE.Texture,\r\n\r\n  get needsUpdate() {\r\n\r\n    return this._needsUpdate;\r\n\r\n  },\r\n\r\n  set needsUpdate(value) {\r\n\r\n    if (value === true) this.update();\r\n\r\n    this._needsUpdate = value;\r\n\r\n  },\r\n\r\n  clone: function(texture) {\r\n\r\n    if (texture === undefined) texture = new THREE.Texture();\r\n\r\n    texture.image = this.image;\r\n    texture.mipmaps = this.mipmaps.slice(0);\r\n\r\n    texture.mapping = this.mapping;\r\n\r\n    texture.wrapS = this.wrapS;\r\n    texture.wrapT = this.wrapT;\r\n\r\n    texture.magFilter = this.magFilter;\r\n    texture.minFilter = this.minFilter;\r\n\r\n    texture.anisotropy = this.anisotropy;\r\n\r\n    texture.format = this.format;\r\n    texture.type = this.type;\r\n\r\n    texture.offset.copy(this.offset);\r\n    texture.repeat.copy(this.repeat);\r\n\r\n    texture.generateMipmaps = this.generateMipmaps;\r\n    texture.premultiplyAlpha = this.premultiplyAlpha;\r\n    texture.flipY = this.flipY;\r\n    texture.unpackAlignment = this.unpackAlignment;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  update: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'update'\r\n    });\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function(images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  mapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n  THREE.Texture.call(this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.images = images;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nTHREE.CubeTexture.clone = function(texture) {\r\n\r\n  if (texture === undefined) texture = new THREE.CubeTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  texture.images = this.images;\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function(mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    width: width,\r\n    height: height\r\n  };\r\n  this.mipmaps = mipmaps;\r\n\r\n  // no flipping for cube textures\r\n  // (also flipping doesn't work for compressed textures )\r\n\r\n  this.flipY = false;\r\n\r\n  // can't generate mipmaps for compressed textures\r\n  // mips must be embedded in DDS files\r\n\r\n  this.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\nTHREE.CompressedTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.CompressedTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function(data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy) {\r\n\r\n  THREE.Texture.call(this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.image = {\r\n    data: data,\r\n    width: width,\r\n    height: height\r\n  };\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\nTHREE.DataTexture.prototype.clone = function() {\r\n\r\n  var texture = new THREE.DataTexture();\r\n\r\n  THREE.Texture.prototype.clone.call(this, texture);\r\n\r\n  return texture;\r\n\r\n};\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function(video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy) {\r\n\r\n  THREE.Texture.call(this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy);\r\n\r\n  this.generateMipmaps = false;\r\n\r\n  var scope = this;\r\n\r\n  var update = function() {\r\n\r\n    requestAnimationFrame(update);\r\n\r\n    if (video.readyState === video.HAVE_ENOUGH_DATA) {\r\n\r\n      scope.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  update();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create(THREE.Texture.prototype);\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Group.prototype.constructor = THREE.Group;\r\n\r\n// File:src/objects/PointCloud.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.PointCloud = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'PointCloud';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.PointCloudMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n};\r\n\r\nTHREE.PointCloud.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.PointCloud.prototype.constructor = THREE.PointCloud;\r\n\r\nTHREE.PointCloud.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var object = this;\r\n    var geometry = object.geometry;\r\n    var threshold = raycaster.params.PointCloud.threshold;\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var localThreshold = threshold / ((this.scale.x + this.scale.y + this.scale.z) / 3);\r\n    var position = new THREE.Vector3();\r\n\r\n    var testPoint = function(point, index) {\r\n\r\n      var rayPointDistance = ray.distanceToPoint(point);\r\n\r\n      if (rayPointDistance < localThreshold) {\r\n\r\n        var intersectPoint = ray.closestPointToPoint(point);\r\n        intersectPoint.applyMatrix4(object.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectPoint);\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          distanceToRay: rayPointDistance,\r\n          point: intersectPoint.clone(),\r\n          index: index,\r\n          face: null,\r\n          object: object\r\n\r\n        });\r\n\r\n      }\r\n\r\n    };\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var positions = attributes.position.array;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          var offset = {\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          };\r\n\r\n          offsets = [offset];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i++) {\r\n\r\n            var a = index + indices[i];\r\n\r\n            position.fromArray(positions, a * 3);\r\n\r\n            testPoint(position, a);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var pointCount = positions.length / 3;\r\n\r\n        for (var i = 0; i < pointCount; i++) {\r\n\r\n          position.set(\r\n            positions[3 * i],\r\n            positions[3 * i + 1],\r\n            positions[3 * i + 2]\r\n          );\r\n\r\n          testPoint(position, i);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      var vertices = this.geometry.vertices;\r\n\r\n      for (var i = 0; i < vertices.length; i++) {\r\n\r\n        testPoint(vertices[i], i);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.PointCloud.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.PointCloud(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.ParticleSystem = function(geometry, material) {\r\n\r\n  THREE.warn('THREE.ParticleSystem has been renamed to THREE.PointCloud.');\r\n  return new THREE.PointCloud(geometry, material);\r\n\r\n};\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function(geometry, material, mode) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Line';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.LineBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.mode = mode !== undefined ? mode : THREE.LineStrip;\r\n\r\n};\r\n\r\nTHREE.LineStrip = 0;\r\nTHREE.LinePieces = 1;\r\n\r\nTHREE.Line.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Line.prototype.constructor = THREE.Line;\r\n\r\nTHREE.Line.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var precision = raycaster.linePrecision;\r\n    var precisionSq = precision * precision;\r\n\r\n    var geometry = this.geometry;\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    var vStart = new THREE.Vector3();\r\n    var vEnd = new THREE.Vector3();\r\n    var interSegment = new THREE.Vector3();\r\n    var interRay = new THREE.Vector3();\r\n    var step = this.mode === THREE.LineStrip ? 1 : 2;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0; oi < offsets.length; oi++) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start; i < start + count - 1; i += step) {\r\n\r\n            var a = index + indices[i];\r\n            var b = index + indices[i + 1];\r\n\r\n            vStart.fromArray(positions, a * 3);\r\n            vEnd.fromArray(positions, b * 3);\r\n\r\n            var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n            if (distSq > precisionSq) continue;\r\n\r\n            var distance = ray.origin.distanceTo(interRay);\r\n\r\n            if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              // What do we want? intersection point on the ray or on the segment??\r\n              // point: raycaster.ray.at( distance ),\r\n              point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n              index: i,\r\n              offsetIndex: oi,\r\n              face: null,\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0; i < positions.length / 3 - 1; i += step) {\r\n\r\n          vStart.fromArray(positions, 3 * i);\r\n          vEnd.fromArray(positions, 3 * i + 3);\r\n\r\n          var distSq = ray.distanceSqToSegment(vStart, vEnd, interRay, interSegment);\r\n\r\n          if (distSq > precisionSq) continue;\r\n\r\n          var distance = ray.origin.distanceTo(interRay);\r\n\r\n          if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            // What do we want? intersection point on the ray or on the segment??\r\n            // point: raycaster.ray.at( distance ),\r\n            point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n            index: i,\r\n            face: null,\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var vertices = geometry.vertices;\r\n      var nbVertices = vertices.length;\r\n\r\n      for (var i = 0; i < nbVertices - 1; i += step) {\r\n\r\n        var distSq = ray.distanceSqToSegment(vertices[i], vertices[i + 1], interRay, interSegment);\r\n\r\n        if (distSq > precisionSq) continue;\r\n\r\n        var distance = ray.origin.distanceTo(interRay);\r\n\r\n        if (distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          // What do we want? intersection point on the ray or on the segment??\r\n          // point: raycaster.ray.at( distance ),\r\n          point: interSegment.clone().applyMatrix4(this.matrixWorld),\r\n          index: i,\r\n          face: null,\r\n          faceIndex: null,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Line.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Line(this.geometry, this.material, this.mode);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function(geometry, material) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Mesh';\r\n\r\n  this.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\r\n  this.material = material !== undefined ? material : new THREE.MeshBasicMaterial({\r\n    color: Math.random() * 0xffffff\r\n  });\r\n\r\n  this.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\r\n\r\nTHREE.Mesh.prototype.updateMorphTargets = function() {\r\n\r\n  if (this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0) {\r\n\r\n    this.morphTargetBase = -1;\r\n    this.morphTargetForcedOrder = [];\r\n    this.morphTargetInfluences = [];\r\n    this.morphTargetDictionary = {};\r\n\r\n    for (var m = 0, ml = this.geometry.morphTargets.length; m < ml; m++) {\r\n\r\n      this.morphTargetInfluences.push(0);\r\n      this.morphTargetDictionary[this.geometry.morphTargets[m].name] = m;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function(name) {\r\n\r\n  if (this.morphTargetDictionary[name] !== undefined) {\r\n\r\n    return this.morphTargetDictionary[name];\r\n\r\n  }\r\n\r\n  THREE.warn('THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.');\r\n\r\n  return 0;\r\n\r\n};\r\n\r\n\r\nTHREE.Mesh.prototype.raycast = (function() {\r\n\r\n  var inverseMatrix = new THREE.Matrix4();\r\n  var ray = new THREE.Ray();\r\n  var sphere = new THREE.Sphere();\r\n\r\n  var vA = new THREE.Vector3();\r\n  var vB = new THREE.Vector3();\r\n  var vC = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    var geometry = this.geometry;\r\n\r\n    // Checking boundingSphere distance to ray\r\n\r\n    if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\r\n\r\n    sphere.copy(geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.matrixWorld);\r\n\r\n    if (raycaster.ray.isIntersectionSphere(sphere) === false) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    // Check boundingBox before continuing\r\n\r\n    inverseMatrix.getInverse(this.matrixWorld);\r\n    ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);\r\n\r\n    if (geometry.boundingBox !== null) {\r\n\r\n      if (ray.isIntersectionBox(geometry.boundingBox) === false) {\r\n\r\n        return;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var material = this.material;\r\n\r\n      if (material === undefined) return;\r\n\r\n      var attributes = geometry.attributes;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      if (attributes.index !== undefined) {\r\n\r\n        var indices = attributes.index.array;\r\n        var positions = attributes.position.array;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          offsets = [{\r\n            start: 0,\r\n            count: indices.length,\r\n            index: 0\r\n          }];\r\n\r\n        }\r\n\r\n        for (var oi = 0, ol = offsets.length; oi < ol; ++oi) {\r\n\r\n          var start = offsets[oi].start;\r\n          var count = offsets[oi].count;\r\n          var index = offsets[oi].index;\r\n\r\n          for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n            a = index + indices[i];\r\n            b = index + indices[i + 1];\r\n            c = index + indices[i + 2];\r\n\r\n            vA.fromArray(positions, a * 3);\r\n            vB.fromArray(positions, b * 3);\r\n            vC.fromArray(positions, c * 3);\r\n\r\n            if (material.side === THREE.BackSide) {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n            }\r\n            else {\r\n\r\n              var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n            }\r\n\r\n            if (intersectionPoint === null) continue;\r\n\r\n            intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n            var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n            if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n            intersects.push({\r\n\r\n              distance: distance,\r\n              point: intersectionPoint,\r\n              face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n              faceIndex: null,\r\n              object: this\r\n\r\n            });\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        var positions = attributes.position.array;\r\n\r\n        for (var i = 0, j = 0, il = positions.length; i < il; i += 3, j += 9) {\r\n\r\n          a = i;\r\n          b = i + 1;\r\n          c = i + 2;\r\n\r\n          vA.fromArray(positions, j);\r\n          vB.fromArray(positions, j + 3);\r\n          vC.fromArray(positions, j + 6);\r\n\r\n          if (material.side === THREE.BackSide) {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vC, vB, vA, true);\r\n\r\n          }\r\n          else {\r\n\r\n            var intersectionPoint = ray.intersectTriangle(vA, vB, vC, material.side !== THREE.DoubleSide);\r\n\r\n          }\r\n\r\n          if (intersectionPoint === null) continue;\r\n\r\n          intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n          var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n          if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n          intersects.push({\r\n\r\n            distance: distance,\r\n            point: intersectionPoint,\r\n            face: new THREE.Face3(a, b, c, THREE.Triangle.normal(vA, vB, vC)),\r\n            faceIndex: null,\r\n            object: this\r\n\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (geometry instanceof THREE.Geometry) {\r\n\r\n      var isFaceMaterial = this.material instanceof THREE.MeshFaceMaterial;\r\n      var objectMaterials = isFaceMaterial === true ? this.material.materials : null;\r\n\r\n      var a, b, c;\r\n      var precision = raycaster.precision;\r\n\r\n      var vertices = geometry.vertices;\r\n\r\n      for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n        var face = geometry.faces[f];\r\n\r\n        var material = isFaceMaterial === true ? objectMaterials[face.materialIndex] : this.material;\r\n\r\n        if (material === undefined) continue;\r\n\r\n        a = vertices[face.a];\r\n        b = vertices[face.b];\r\n        c = vertices[face.c];\r\n\r\n        if (material.morphTargets === true) {\r\n\r\n          var morphTargets = geometry.morphTargets;\r\n          var morphInfluences = this.morphTargetInfluences;\r\n\r\n          vA.set(0, 0, 0);\r\n          vB.set(0, 0, 0);\r\n          vC.set(0, 0, 0);\r\n\r\n          for (var t = 0, tl = morphTargets.length; t < tl; t++) {\r\n\r\n            var influence = morphInfluences[t];\r\n\r\n            if (influence === 0) continue;\r\n\r\n            var targets = morphTargets[t].vertices;\r\n\r\n            vA.x += (targets[face.a].x - a.x) * influence;\r\n            vA.y += (targets[face.a].y - a.y) * influence;\r\n            vA.z += (targets[face.a].z - a.z) * influence;\r\n\r\n            vB.x += (targets[face.b].x - b.x) * influence;\r\n            vB.y += (targets[face.b].y - b.y) * influence;\r\n            vB.z += (targets[face.b].z - b.z) * influence;\r\n\r\n            vC.x += (targets[face.c].x - c.x) * influence;\r\n            vC.y += (targets[face.c].y - c.y) * influence;\r\n            vC.z += (targets[face.c].z - c.z) * influence;\r\n\r\n          }\r\n\r\n          vA.add(a);\r\n          vB.add(b);\r\n          vC.add(c);\r\n\r\n          a = vA;\r\n          b = vB;\r\n          c = vC;\r\n\r\n        }\r\n\r\n        if (material.side === THREE.BackSide) {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(c, b, a, true);\r\n\r\n        }\r\n        else {\r\n\r\n          var intersectionPoint = ray.intersectTriangle(a, b, c, material.side !== THREE.DoubleSide);\r\n\r\n        }\r\n\r\n        if (intersectionPoint === null) continue;\r\n\r\n        intersectionPoint.applyMatrix4(this.matrixWorld);\r\n\r\n        var distance = raycaster.ray.origin.distanceTo(intersectionPoint);\r\n\r\n        if (distance < precision || distance < raycaster.near || distance > raycaster.far) continue;\r\n\r\n        intersects.push({\r\n\r\n          distance: distance,\r\n          point: intersectionPoint,\r\n          face: face,\r\n          faceIndex: f,\r\n          object: this\r\n\r\n        });\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Mesh.prototype.clone = function(object, recursive) {\r\n\r\n  if (object === undefined) object = new THREE.Mesh(this.geometry, this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object, recursive);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function(skin) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Bone';\r\n\r\n  this.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Bone.prototype.constructor = THREE.Bone;\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function(bones, boneInverses, useVertexTexture) {\r\n\r\n  this.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n  this.identityMatrix = new THREE.Matrix4();\r\n\r\n  // copy the bone array\r\n\r\n  bones = bones || [];\r\n\r\n  this.bones = bones.slice(0);\r\n\r\n  // create a bone texture or an array of floats\r\n\r\n  if (this.useVertexTexture) {\r\n\r\n    // layout (1 matrix = 4 pixels)\r\n    //      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n    //  with  8x8  pixel texture max   16 bones  (8 * 8  / 4)\r\n    //       16x16 pixel texture max   64 bones (16 * 16 / 4)\r\n    //       32x32 pixel texture max  256 bones (32 * 32 / 4)\r\n    //       64x64 pixel texture max 1024 bones (64 * 64 / 4)\r\n\r\n    var size;\r\n\r\n    if (this.bones.length > 256)\r\n      size = 64;\r\n    else if (this.bones.length > 64)\r\n      size = 32;\r\n    else if (this.bones.length > 16)\r\n      size = 16;\r\n    else\r\n      size = 8;\r\n\r\n    this.boneTextureWidth = size;\r\n    this.boneTextureHeight = size;\r\n\r\n    this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4); // 4 floats per RGBA pixel\r\n    this.boneTexture = new THREE.DataTexture(this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType);\r\n    this.boneTexture.minFilter = THREE.NearestFilter;\r\n    this.boneTexture.magFilter = THREE.NearestFilter;\r\n    this.boneTexture.generateMipmaps = false;\r\n    this.boneTexture.flipY = false;\r\n\r\n  }\r\n  else {\r\n\r\n    this.boneMatrices = new Float32Array(16 * this.bones.length);\r\n\r\n  }\r\n\r\n  // use the supplied bone inverses or calculate the inverses\r\n\r\n  if (boneInverses === undefined) {\r\n\r\n    this.calculateInverses();\r\n\r\n  }\r\n  else {\r\n\r\n    if (this.bones.length === boneInverses.length) {\r\n\r\n      this.boneInverses = boneInverses.slice(0);\r\n\r\n    }\r\n    else {\r\n\r\n      THREE.warn('THREE.Skeleton bonInverses is the wrong length.');\r\n\r\n      this.boneInverses = [];\r\n\r\n      for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n        this.boneInverses.push(new THREE.Matrix4());\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.calculateInverses = function() {\r\n\r\n  this.boneInverses = [];\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    var inverse = new THREE.Matrix4();\r\n\r\n    if (this.bones[b]) {\r\n\r\n      inverse.getInverse(this.bones[b].matrixWorld);\r\n\r\n    }\r\n\r\n    this.boneInverses.push(inverse);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.pose = function() {\r\n\r\n  var bone;\r\n\r\n  // recover the bind-time world matrices\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      bone.matrixWorld.getInverse(this.boneInverses[b]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // compute the local matrices, positions, rotations and scales\r\n\r\n  for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n    bone = this.bones[b];\r\n\r\n    if (bone) {\r\n\r\n      if (bone.parent) {\r\n\r\n        bone.matrix.getInverse(bone.parent.matrixWorld);\r\n        bone.matrix.multiply(bone.matrixWorld);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.matrix.copy(bone.matrixWorld);\r\n\r\n      }\r\n\r\n      bone.matrix.decompose(bone.position, bone.quaternion, bone.scale);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Skeleton.prototype.update = (function() {\r\n\r\n  var offsetMatrix = new THREE.Matrix4();\r\n\r\n  return function() {\r\n\r\n    // flatten bone matrices to array\r\n\r\n    for (var b = 0, bl = this.bones.length; b < bl; b++) {\r\n\r\n      // compute the offset between the current and the original transform\r\n\r\n      var matrix = this.bones[b] ? this.bones[b].matrixWorld : this.identityMatrix;\r\n\r\n      offsetMatrix.multiplyMatrices(matrix, this.boneInverses[b]);\r\n      offsetMatrix.flattenToArrayOffset(this.boneMatrices, b * 16);\r\n\r\n    }\r\n\r\n    if (this.useVertexTexture) {\r\n\r\n      this.boneTexture.needsUpdate = true;\r\n\r\n    }\r\n\r\n  };\r\n\r\n})();\r\n\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function(geometry, material, useVertexTexture) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'SkinnedMesh';\r\n\r\n  this.bindMode = \"attached\";\r\n  this.bindMatrix = new THREE.Matrix4();\r\n  this.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n  // init bones\r\n\r\n  // TODO: remove bone creation as there is no reason (other than\r\n  // convenience) for THREE.SkinnedMesh to do this.\r\n\r\n  var bones = [];\r\n\r\n  if (this.geometry && this.geometry.bones !== undefined) {\r\n\r\n    var bone, gbone, p, q, s;\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      p = gbone.pos;\r\n      q = gbone.rotq;\r\n      s = gbone.scl;\r\n\r\n      bone = new THREE.Bone(this);\r\n      bones.push(bone);\r\n\r\n      bone.name = gbone.name;\r\n      bone.position.set(p[0], p[1], p[2]);\r\n      bone.quaternion.set(q[0], q[1], q[2], q[3]);\r\n\r\n      if (s !== undefined) {\r\n\r\n        bone.scale.set(s[0], s[1], s[2]);\r\n\r\n      }\r\n      else {\r\n\r\n        bone.scale.set(1, 1, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var b = 0, bl = this.geometry.bones.length; b < bl; ++b) {\r\n\r\n      gbone = this.geometry.bones[b];\r\n\r\n      if (gbone.parent !== -1) {\r\n\r\n        bones[gbone.parent].add(bones[b]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.add(bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.normalizeSkinWeights();\r\n\r\n  this.updateMatrixWorld(true);\r\n  this.bind(new THREE.Skeleton(bones, undefined, useVertexTexture));\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\r\n\r\nTHREE.SkinnedMesh.prototype.bind = function(skeleton, bindMatrix) {\r\n\r\n  this.skeleton = skeleton;\r\n\r\n  if (bindMatrix === undefined) {\r\n\r\n    this.updateMatrixWorld(true);\r\n\r\n    bindMatrix = this.matrixWorld;\r\n\r\n  }\r\n\r\n  this.bindMatrix.copy(bindMatrix);\r\n  this.bindMatrixInverse.getInverse(bindMatrix);\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.pose = function() {\r\n\r\n  this.skeleton.pose();\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function() {\r\n\r\n  if (this.geometry instanceof THREE.Geometry) {\r\n\r\n    for (var i = 0; i < this.geometry.skinIndices.length; i++) {\r\n\r\n      var sw = this.geometry.skinWeights[i];\r\n\r\n      var scale = 1.0 / sw.lengthManhattan();\r\n\r\n      if (scale !== Infinity) {\r\n\r\n        sw.multiplyScalar(scale);\r\n\r\n      }\r\n      else {\r\n\r\n        sw.set(1); // this will be normalized by the shader anyway\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    // skinning weights assumed to be normalized for THREE.BufferGeometry\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function(force) {\r\n\r\n  THREE.Mesh.prototype.updateMatrixWorld.call(this, true);\r\n\r\n  if (this.bindMode === \"attached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.matrixWorld);\r\n\r\n  }\r\n  else if (this.bindMode === \"detached\") {\r\n\r\n    this.bindMatrixInverse.getInverse(this.bindMatrix);\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.SkinnedMesh unreckognized bindMode: ' + this.bindMode);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.SkinnedMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) {\r\n\r\n    object = new THREE.SkinnedMesh(this.geometry, this.material, this.useVertexTexture);\r\n\r\n  }\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n\r\n// File:src/objects/MorphAnimMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphAnimMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.type = 'MorphAnimMesh';\r\n\r\n  // API\r\n\r\n  this.duration = 1000; // milliseconds\r\n  this.mirroredLoop = false;\r\n  this.time = 0;\r\n\r\n  // internals\r\n\r\n  this.lastKeyframe = 0;\r\n  this.currentKeyframe = 0;\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n  this.setFrameRange(0, this.geometry.morphTargets.length - 1);\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;\r\n\r\nTHREE.MorphAnimMesh.prototype.setFrameRange = function(start, end) {\r\n\r\n  this.startKeyframe = start;\r\n  this.endKeyframe = end;\r\n\r\n  this.length = this.endKeyframe - this.startKeyframe + 1;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionForward = function() {\r\n\r\n  this.direction = 1;\r\n  this.directionBackwards = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setDirectionBackward = function() {\r\n\r\n  this.direction = -1;\r\n  this.directionBackwards = true;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.parseAnimations = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  if (!geometry.animations) geometry.animations = {};\r\n\r\n  var firstAnimation, animations = geometry.animations;\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var parts = morph.name.match(pattern);\r\n\r\n    if (parts && parts.length > 1) {\r\n\r\n      var label = parts[1];\r\n\r\n      if (!animations[label]) animations[label] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var animation = animations[label];\r\n\r\n      if (i < animation.start) animation.start = i;\r\n      if (i > animation.end) animation.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = label;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.setAnimationLabel = function(label, start, end) {\r\n\r\n  if (!this.geometry.animations) this.geometry.animations = {};\r\n\r\n  this.geometry.animations[label] = {\r\n    start: start,\r\n    end: end\r\n  };\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.playAnimation = function(label, fps) {\r\n\r\n  var animation = this.geometry.animations[label];\r\n\r\n  if (animation) {\r\n\r\n    this.setFrameRange(animation.start, animation.end);\r\n    this.duration = 1000 * ((animation.end - animation.start) / fps);\r\n    this.time = 0;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn('THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()');\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.updateAnimation = function(delta) {\r\n\r\n  var frameTime = this.duration / this.length;\r\n\r\n  this.time += this.direction * delta;\r\n\r\n  if (this.mirroredLoop) {\r\n\r\n    if (this.time > this.duration || this.time < 0) {\r\n\r\n      this.direction *= -1;\r\n\r\n      if (this.time > this.duration) {\r\n\r\n        this.time = this.duration;\r\n        this.directionBackwards = true;\r\n\r\n      }\r\n\r\n      if (this.time < 0) {\r\n\r\n        this.time = 0;\r\n        this.directionBackwards = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n  else {\r\n\r\n    this.time = this.time % this.duration;\r\n\r\n    if (this.time < 0) this.time += this.duration;\r\n\r\n  }\r\n\r\n  var keyframe = this.startKeyframe + THREE.Math.clamp(Math.floor(this.time / frameTime), 0, this.length - 1);\r\n\r\n  if (keyframe !== this.currentKeyframe) {\r\n\r\n    this.morphTargetInfluences[this.lastKeyframe] = 0;\r\n    this.morphTargetInfluences[this.currentKeyframe] = 1;\r\n\r\n    this.morphTargetInfluences[keyframe] = 0;\r\n\r\n    this.lastKeyframe = this.currentKeyframe;\r\n    this.currentKeyframe = keyframe;\r\n\r\n  }\r\n\r\n  var mix = (this.time % frameTime) / frameTime;\r\n\r\n  if (this.directionBackwards) {\r\n\r\n    mix = 1 - mix;\r\n\r\n  }\r\n\r\n  this.morphTargetInfluences[this.currentKeyframe] = mix;\r\n  this.morphTargetInfluences[this.lastKeyframe] = 1 - mix;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.interpolateTargets = function(a, b, t) {\r\n\r\n  var influences = this.morphTargetInfluences;\r\n\r\n  for (var i = 0, l = influences.length; i < l; i++) {\r\n\r\n    influences[i] = 0;\r\n\r\n  }\r\n\r\n  if (a > -1) influences[a] = 1 - t;\r\n  if (b > -1) influences[b] = t;\r\n\r\n};\r\n\r\nTHREE.MorphAnimMesh.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.MorphAnimMesh(this.geometry, this.material);\r\n\r\n  object.duration = this.duration;\r\n  object.mirroredLoop = this.mirroredLoop;\r\n  object.time = this.time;\r\n\r\n  object.lastKeyframe = this.lastKeyframe;\r\n  object.currentKeyframe = this.currentKeyframe;\r\n\r\n  object.direction = this.direction;\r\n  object.directionBackwards = this.directionBackwards;\r\n\r\n  THREE.Mesh.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.objects = [];\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LOD.prototype.constructor = THREE.LOD;\r\n\r\nTHREE.LOD.prototype.addLevel = function(object, distance) {\r\n\r\n  if (distance === undefined) distance = 0;\r\n\r\n  distance = Math.abs(distance);\r\n\r\n  for (var l = 0; l < this.objects.length; l++) {\r\n\r\n    if (distance < this.objects[l].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.objects.splice(l, 0, {\r\n    distance: distance,\r\n    object: object\r\n  });\r\n  this.add(object);\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.getObjectForDistance = function(distance) {\r\n\r\n  for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n    if (distance < this.objects[i].distance) {\r\n\r\n      break;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  return this.objects[i - 1].object;\r\n\r\n};\r\n\r\nTHREE.LOD.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.origin.distanceTo(matrixPosition);\r\n\r\n    this.getObjectForDistance(distance).raycast(raycaster, intersects);\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.LOD.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n\r\n  return function(camera) {\r\n\r\n    if (this.objects.length > 1) {\r\n\r\n      v1.setFromMatrixPosition(camera.matrixWorld);\r\n      v2.setFromMatrixPosition(this.matrixWorld);\r\n\r\n      var distance = v1.distanceTo(v2);\r\n\r\n      this.objects[0].object.visible = true;\r\n\r\n      for (var i = 1, l = this.objects.length; i < l; i++) {\r\n\r\n        if (distance >= this.objects[i].distance) {\r\n\r\n          this.objects[i - 1].object.visible = false;\r\n          this.objects[i].object.visible = true;\r\n\r\n        }\r\n        else {\r\n\r\n          break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (; i < l; i++) {\r\n\r\n        this.objects[i].object.visible = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n}();\r\n\r\nTHREE.LOD.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.LOD();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  for (var i = 0, l = this.objects.length; i < l; i++) {\r\n    var x = this.objects[i].object.clone();\r\n    x.visible = i === 0;\r\n    object.addLevel(x, this.objects[i].distance);\r\n  }\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = (function() {\r\n\r\n  var indices = new Uint16Array([0, 1, 2, 0, 2, 3]);\r\n  var vertices = new Float32Array([-0.5, -0.5, 0, 0.5, -0.5, 0, 0.5, 0.5, 0, -0.5, 0.5, 0]);\r\n  var uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n  return function(material) {\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    this.type = 'Sprite';\r\n\r\n    this.geometry = geometry;\r\n    this.material = (material !== undefined) ? material : new THREE.SpriteMaterial();\r\n\r\n  };\r\n\r\n})();\r\n\r\nTHREE.Sprite.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\r\n\r\nTHREE.Sprite.prototype.raycast = (function() {\r\n\r\n  var matrixPosition = new THREE.Vector3();\r\n\r\n  return function(raycaster, intersects) {\r\n\r\n    matrixPosition.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    var distance = raycaster.ray.distanceToPoint(matrixPosition);\r\n\r\n    if (distance > this.scale.x) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    intersects.push({\r\n\r\n      distance: distance,\r\n      point: this.position,\r\n      face: null,\r\n      object: this\r\n\r\n    });\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.Sprite.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Sprite(this.material);\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// Backwards compatibility\r\n\r\nTHREE.Particle = THREE.Sprite;\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function(texture, size, distance, blending, color) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.lensFlares = [];\r\n\r\n  this.positionScreen = new THREE.Vector3();\r\n  this.customUpdateCallback = undefined;\r\n\r\n  if (texture !== undefined) {\r\n\r\n    this.add(texture, size, distance, blending, color);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\r\n\r\n\r\n/*\r\n * Add: adds another flare\r\n */\r\n\r\nTHREE.LensFlare.prototype.add = function(texture, size, distance, blending, color, opacity) {\r\n\r\n  if (size === undefined) size = -1;\r\n  if (distance === undefined) distance = 0;\r\n  if (opacity === undefined) opacity = 1;\r\n  if (color === undefined) color = new THREE.Color(0xffffff);\r\n  if (blending === undefined) blending = THREE.NormalBlending;\r\n\r\n  distance = Math.min(distance, Math.max(0, distance));\r\n\r\n  this.lensFlares.push({\r\n    texture: texture, // THREE.Texture\r\n    size: size, // size in pixels (-1 = use texture.width)\r\n    distance: distance, // distance (0-1) from light source (0=at light source)\r\n    x: 0,\r\n    y: 0,\r\n    z: 0, // screen position (-1 => 1) z = 0 is ontop z = 1 is back\r\n    scale: 1, // scale\r\n    rotation: 1, // rotation\r\n    opacity: opacity, // opacity\r\n    color: color, // color\r\n    blending: blending // blending\r\n  });\r\n\r\n};\r\n\r\n/*\r\n * Update lens flares update positions on all flares based on the screen position\r\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n */\r\n\r\nTHREE.LensFlare.prototype.updateLensFlares = function() {\r\n\r\n  var f, fl = this.lensFlares.length;\r\n  var flare;\r\n  var vecX = -this.positionScreen.x * 2;\r\n  var vecY = -this.positionScreen.y * 2;\r\n\r\n  for (f = 0; f < fl; f++) {\r\n\r\n    flare = this.lensFlares[f];\r\n\r\n    flare.x = this.positionScreen.x + vecX * flare.distance;\r\n    flare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n    flare.wantedRotation = flare.x * Math.PI * 0.25;\r\n    flare.rotation += (flare.wantedRotation - flare.rotation) * 0.25;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Scene';\r\n\r\n  this.fog = null;\r\n  this.overrideMaterial = null;\r\n\r\n  this.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.clone = function(object) {\r\n\r\n  if (object === undefined) object = new THREE.Scene();\r\n\r\n  THREE.Object3D.prototype.clone.call(this, object);\r\n\r\n  if (this.fog !== null) object.fog = this.fog.clone();\r\n  if (this.overrideMaterial !== null) object.overrideMaterial = this.overrideMaterial.clone();\r\n\r\n  object.autoUpdate = this.autoUpdate;\r\n  object.matrixAutoUpdate = this.matrixAutoUpdate;\r\n\r\n  return object;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function(color, near, far) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n\r\n  this.near = (near !== undefined) ? near : 1;\r\n  this.far = (far !== undefined) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function() {\r\n\r\n  return new THREE.Fog(this.color.getHex(), this.near, this.far);\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function(color, density) {\r\n\r\n  this.name = '';\r\n\r\n  this.color = new THREE.Color(color);\r\n  this.density = (density !== undefined) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function() {\r\n\r\n  return new THREE.FogExp2(this.color.getHex(), this.density);\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk['common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\nfloat square( in float a ) { return a*a; }\\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\\nfloat average( in float a ) { return a; }\\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n}\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\\n\treturn point - distance * planeNormal;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\\n}\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\tif ( decayExponent > 0.0 ) {\\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\\n\t}\\n\treturn 1.0;\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n#ifdef GAMMA_INPUT\\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\nvec3 linearToOutput( in vec3 a ) {\\n#ifdef GAMMA_OUTPUT\\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n#else\\n\treturn a;\\n#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\ntransformedNormal = normalize( transformedNormal );\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\tfloat dotProduct = dot( transformedNormal, dirVector );\\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\t#ifdef WRAP_AROUND\\n\\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\\n\\n\t\t#endif\\n\\n\t#endif\\n\\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\\n\\n\t#endif\\n\\n}\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tlVector = normalize( lVector );\\n\\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\\n\\n\t\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\\n\\n\t\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\\n\\n\t\t\t\t#endif\\n\\n\t\t\t#endif\\n\\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/default_vertex.glsl\r\n\r\nTHREE.ShaderChunk['default_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#elif defined( USE_MORPHTARGETS )\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\\n\\n#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\t#ifdef USE_MORPHNORMALS\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\\n\\n\t#else\\n\\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\nvec3 viewPosition = normalize( vViewPosition );\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\\n\\n\t\t\t\t// specular\\n\\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\tlVector = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lVector );\\n\\n\t\t\t#ifdef WRAP_AROUND\\n\\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t\t#else\\n\\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t\t#endif\\n\\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, dirVector );\\n\\n\t\t#ifdef WRAP_AROUND\\n\\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\n\t\t#else\\n\\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\n\t\t#endif\\n\\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\\n\\n\t\t// specular\\n\\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\n\t\t/*\\n\t\t// fresnel term from skin shader\\n\t\tconst float F0 = 0.128;\\n\\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\\n\t\tfloat exponential = pow( base, 5.0 );\\n\\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\\n\t\t*/\\n\\n\t\t/*\\n\t\t// fresnel term from fresnel shader\\n\t\tconst float mFresnelBias = 0.08;\\n\t\tconst float mFresnelScale = 0.3;\\n\t\tconst float mFresnelPower = 5.0;\\n\\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\\n\t\t*/\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\\n\\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lVector );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += hemiColor;\\n\\n\t\t// specular (sky light)\\n\\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\\n\\n\t\t// specular (ground light)\\n\\n\t\tvec3 lVectorGround = -lVector;\\n\\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\\n\\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\\n\\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tvec3 morphedNormal = vec3( 0.0 );\\n\\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n\tmorphedNormal += normal;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvarying vec2 vUv2;\\n\tuniform sampler2D lightMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_vertex'] = \"#ifdef USE_LIGHTMAP\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk['map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = inputToLinear( color.xyz );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\t#ifdef USE_MORPHTARGETS\\n\\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\r\n\r\nTHREE.ShaderChunk['linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk['fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\\n\t\tfogFactor = whiteCompliment( fogFactor );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk['defaultnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec3 objectNormal = skinnedNormal.xyz;\\n\\n#elif defined( USE_MORPHNORMALS )\\n\\n\tvec3 objectNormal = morphedNormal;\\n\\n#else\\n\\n\tvec3 objectNormal = normal;\\n\\n#endif\\n\\n#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\n\tuniform vec3 wrapRGB;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_vertex.glsl\r\n\r\nTHREE.ShaderChunk['map_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk['color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk['morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\tvec3 morphed = vec3( 0.0 );\\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n\tmorphed += position;\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk['envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\tint inFrustumCount = 0;\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\t\t\t// don't shadow pixels outside of light frustum\\n\t\t\t\t// use just first frustum (for cascades)\\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\\n\\n\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\tinFrustumCount += int( inFrustum );\\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\\n\\n\t\t#else\\n\\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\t#endif\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\t#ifdef SHADOWMAP_CASCADE\\n\\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#else\\n\\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t\t#endif\\n\\n\t\t#endif\\n\\n\t}\\n\\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\\n\tshadowColor = inputToLinear( shadowColor );\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk['worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#elif defined( USE_MORPHTARGETS )\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk['skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\t#extension GL_EXT_frag_depth : enable\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk['alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n  merge: function(uniforms) {\r\n\r\n    var merged = {};\r\n\r\n    for (var u = 0; u < uniforms.length; u++) {\r\n\r\n      var tmp = this.clone(uniforms[u]);\r\n\r\n      for (var p in tmp) {\r\n\r\n        merged[p] = tmp[p];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return merged;\r\n\r\n  },\r\n\r\n  clone: function(uniforms_src) {\r\n\r\n    var uniforms_dst = {};\r\n\r\n    for (var u in uniforms_src) {\r\n\r\n      uniforms_dst[u] = {};\r\n\r\n      for (var p in uniforms_src[u]) {\r\n\r\n        var parameter_src = uniforms_src[u][p];\r\n\r\n        if (parameter_src instanceof THREE.Color ||\r\n          parameter_src instanceof THREE.Vector2 ||\r\n          parameter_src instanceof THREE.Vector3 ||\r\n          parameter_src instanceof THREE.Vector4 ||\r\n          parameter_src instanceof THREE.Matrix4 ||\r\n          parameter_src instanceof THREE.Texture) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.clone();\r\n\r\n        }\r\n        else if (parameter_src instanceof Array) {\r\n\r\n          uniforms_dst[u][p] = parameter_src.slice();\r\n\r\n        }\r\n        else {\r\n\r\n          uniforms_dst[u][p] = parameter_src;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return uniforms_dst;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n  common: {\r\n\r\n    \"diffuse\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"lightMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"specularMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"alphaMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n\r\n    \"envMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"flipEnvMap\": {\r\n      type: \"f\",\r\n      value: -1\r\n    },\r\n    \"reflectivity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"refractionRatio\": {\r\n      type: \"f\",\r\n      value: 0.98\r\n    },\r\n\r\n    \"morphTargetInfluences\": {\r\n      type: \"f\",\r\n      value: 0\r\n    }\r\n\r\n  },\r\n\r\n  bump: {\r\n\r\n    \"bumpMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"bumpScale\": {\r\n      type: \"f\",\r\n      value: 1\r\n    }\r\n\r\n  },\r\n\r\n  normalmap: {\r\n\r\n    \"normalMap\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"normalScale\": {\r\n      type: \"v2\",\r\n      value: new THREE.Vector2(1, 1)\r\n    }\r\n  },\r\n\r\n  fog: {\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  lights: {\r\n\r\n    \"ambientLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"directionalLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"directionalLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"hemisphereLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightSkyColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"hemisphereLightGroundColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n\r\n    \"pointLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"pointLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"pointLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"spotLightColor\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightPosition\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDirection\": {\r\n      type: \"fv\",\r\n      value: []\r\n    },\r\n    \"spotLightDistance\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightAngleCos\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightExponent\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"spotLightDecay\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    }\r\n\r\n  },\r\n\r\n  particle: {\r\n\r\n    \"psColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xeeeeee)\r\n    },\r\n    \"opacity\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"size\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"scale\": {\r\n      type: \"f\",\r\n      value: 1.0\r\n    },\r\n    \"map\": {\r\n      type: \"t\",\r\n      value: null\r\n    },\r\n    \"offsetRepeat\": {\r\n      type: \"v4\",\r\n      value: new THREE.Vector4(0, 0, 1, 1)\r\n    },\r\n\r\n    \"fogDensity\": {\r\n      type: \"f\",\r\n      value: 0.00025\r\n    },\r\n    \"fogNear\": {\r\n      type: \"f\",\r\n      value: 1\r\n    },\r\n    \"fogFar\": {\r\n      type: \"f\",\r\n      value: 2000\r\n    },\r\n    \"fogColor\": {\r\n      type: \"c\",\r\n      value: new THREE.Color(0xffffff)\r\n    }\r\n\r\n  },\r\n\r\n  shadowmap: {\r\n\r\n    \"shadowMap\": {\r\n      type: \"tv\",\r\n      value: []\r\n    },\r\n    \"shadowMapSize\": {\r\n      type: \"v2v\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowBias\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n    \"shadowDarkness\": {\r\n      type: \"fv1\",\r\n      value: []\r\n    },\r\n\r\n    \"shadowMatrix\": {\r\n      type: \"m4v\",\r\n      value: []\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n  'basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n\r\n      \"\t#ifdef USE_ENVMAP\",\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"], // TODO: Light map on an otherwise unlit surface doesn't make sense.\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"], // TODO: Shadows on an otherwise unlit surface doesn't make sense.\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'lambert': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define LAMBERT\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_lambert_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"varying vec3 vLightFront;\",\r\n\r\n      \"#ifdef DOUBLE_SIDED\",\r\n\r\n      \"\tvarying vec3 vLightBack;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      \"\t#ifdef DOUBLE_SIDED\",\r\n\r\n      //\"float isFront = float( gl_FrontFacing );\",\r\n      //\"gl_FragColor.xyz *= isFront * vLightFront + ( 1.0 - isFront ) * vLightBack;\",\r\n\r\n      \"\t\tif ( gl_FrontFacing )\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n      \"\t\telse\",\r\n      \"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'phong': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"bump\"],\r\n      THREE.UniformsLib[\"normalmap\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n      THREE.UniformsLib[\"lights\"],\r\n      THREE.UniformsLib[\"shadowmap\"],\r\n\r\n      {\r\n        \"emissive\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x000000)\r\n        },\r\n        \"specular\": {\r\n          type: \"c\",\r\n          value: new THREE.Color(0x111111)\r\n        },\r\n        \"shininess\": {\r\n          type: \"f\",\r\n          value: 30\r\n        },\r\n        \"wrapRGB\": {\r\n          type: \"v3\",\r\n          value: new THREE.Vector3(1, 1, 1)\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"varying vec3 vViewPosition;\",\r\n\r\n      \"#ifndef FLAT_SHADED\",\r\n\r\n      \"\tvarying vec3 vNormal;\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"map_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_vertex\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"map_vertex\"],\r\n      THREE.ShaderChunk[\"lightmap_vertex\"],\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      THREE.ShaderChunk[\"morphnormal_vertex\"],\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"skinnormal_vertex\"],\r\n      THREE.ShaderChunk[\"defaultnormal_vertex\"],\r\n\r\n      \"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n      \"\tvNormal = normalize( transformedNormal );\",\r\n\r\n      \"#endif\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"\tvViewPosition = -mvPosition.xyz;\",\r\n\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"envmap_vertex\"],\r\n      THREE.ShaderChunk[\"lights_phong_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"#define PHONG\",\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform vec3 emissive;\",\r\n      \"uniform vec3 specular;\",\r\n      \"uniform float shininess;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_pars_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lightmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"lights_phong_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"bumpmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"normalmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphamap_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n      THREE.ShaderChunk[\"specularmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lights_phong_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"lightmap_fragment\"],\r\n      THREE.ShaderChunk[\"envmap_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"linear_to_gamma_fragment\"],\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'particle_basic': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"particle\"],\r\n      THREE.UniformsLib[\"shadowmap\"]\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float size;\",\r\n      \"uniform float scale;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      \"\t#ifdef USE_SIZEATTENUATION\",\r\n      \"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\r\n      \"\t#else\",\r\n      \"\t\tgl_PointSize = size;\",\r\n      \"\t#endif\",\r\n\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n      THREE.ShaderChunk[\"worldpos_vertex\"],\r\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 psColor;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( psColor, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"map_particle_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n      THREE.ShaderChunk[\"alphatest_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"shadowmap_fragment\"],\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'dashed': {\r\n\r\n    uniforms: THREE.UniformsUtils.merge([\r\n\r\n      THREE.UniformsLib[\"common\"],\r\n      THREE.UniformsLib[\"fog\"],\r\n\r\n      {\r\n        \"scale\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"dashSize\": {\r\n          type: \"f\",\r\n          value: 1\r\n        },\r\n        \"totalSize\": {\r\n          type: \"f\",\r\n          value: 2\r\n        }\r\n      }\r\n\r\n    ]),\r\n\r\n    vertexShader: [\r\n\r\n      \"uniform float scale;\",\r\n      \"attribute float lineDistance;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"color_vertex\"],\r\n\r\n      \"\tvLineDistance = scale * lineDistance;\",\r\n\r\n      \"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\r\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform vec3 diffuse;\",\r\n      \"uniform float opacity;\",\r\n\r\n      \"uniform float dashSize;\",\r\n      \"uniform float totalSize;\",\r\n\r\n      \"varying float vLineDistance;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"color_pars_fragment\"],\r\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\r\n\r\n      \"\t\tdiscard;\",\r\n\r\n      \"\t}\",\r\n\r\n      \"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\r\n      \"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n      THREE.ShaderChunk[\"color_fragment\"],\r\n\r\n      \"\toutgoingLight = diffuseColor.rgb;\", // simple shader\r\n\r\n      THREE.ShaderChunk[\"fog_fragment\"],\r\n\r\n      \"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'depth': {\r\n\r\n    uniforms: {\r\n\r\n      \"mNear\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      },\r\n      \"mFar\": {\r\n        type: \"f\",\r\n        value: 2000.0\r\n      },\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float mNear;\",\r\n      \"uniform float mFar;\",\r\n      \"uniform float opacity;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n      \"\t#endif\",\r\n\r\n      \"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\r\n      \"\tgl_FragColor = vec4( vec3( color ), opacity );\", // TODO, this should be pre-multiplied to allow for bright highlights on very transparent objects\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  'normal': {\r\n\r\n    uniforms: {\r\n\r\n      \"opacity\": {\r\n        type: \"f\",\r\n        value: 1.0\r\n      }\r\n\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvNormal = normalize( normalMatrix * normal );\",\r\n\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform float opacity;\",\r\n      \"varying vec3 vNormal;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'cube': {\r\n\r\n    uniforms: {\r\n      \"tCube\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform samplerCube tCube;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* -------------------------------------------------------------------------\r\n  //\tCube map shader\r\n   ------------------------------------------------------------------------- */\r\n\r\n  'equirect': {\r\n\r\n    uniforms: {\r\n      \"tEquirect\": {\r\n        type: \"t\",\r\n        value: null\r\n      },\r\n      \"tFlip\": {\r\n        type: \"f\",\r\n        value: -1\r\n      }\r\n    },\r\n\r\n    vertexShader: [\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      \"\tvWorldPosition = transformDirection( position, modelMatrix );\",\r\n\r\n      \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      \"uniform sampler2D tEquirect;\",\r\n      \"uniform float tFlip;\",\r\n\r\n      \"varying vec3 vWorldPosition;\",\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"void main() {\",\r\n\r\n      // \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\r\n      \"vec3 direction = normalize( vWorldPosition );\",\r\n      \"vec2 sampleUV;\",\r\n      \"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\r\n      \"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n      \"gl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  },\r\n\r\n  /* Depth encoding into RGBA texture\r\n   *\r\n   * based on SpiderGL shadow map example\r\n   * http://spidergl.org/example.php?id=6\r\n   *\r\n   * originally from\r\n   * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\r\n   *\r\n   * see also\r\n   * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\r\n   */\r\n\r\n  'depthRGBA': {\r\n\r\n    uniforms: {},\r\n\r\n    vertexShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"morphtarget_pars_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_pars_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"skinbase_vertex\"],\r\n      THREE.ShaderChunk[\"morphtarget_vertex\"],\r\n      THREE.ShaderChunk[\"skinning_vertex\"],\r\n      THREE.ShaderChunk[\"default_vertex\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_vertex\"],\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\"),\r\n\r\n    fragmentShader: [\r\n\r\n      THREE.ShaderChunk[\"common\"],\r\n      THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\r\n\r\n      \"vec4 pack_depth( const in float depth ) {\",\r\n\r\n      \"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\r\n      \"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\r\n      \"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\r\n      \"\tres -= res.xxyz * bit_mask;\",\r\n      \"\treturn res;\",\r\n\r\n      \"}\",\r\n\r\n      \"void main() {\",\r\n\r\n      THREE.ShaderChunk[\"logdepthbuf_fragment\"],\r\n\r\n      \"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\r\n\r\n      \"\t#else\",\r\n\r\n      \"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\r\n\r\n      \"\t#endif\",\r\n\r\n      //\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\r\n      //\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\r\n      //\"gl_FragData[ 0 ] = pack_depth( z );\",\r\n      //\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\r\n\r\n      \"}\"\r\n\r\n    ].join(\"\\n\")\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.WebGLRenderer = function(parameters) {\r\n\r\n  console.log('THREE.WebGLRenderer', THREE.REVISION);\r\n\r\n  parameters = parameters || {};\r\n\r\n  var _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement('canvas'),\r\n    _context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n    pixelRatio = 1,\r\n\r\n    _precision = parameters.precision !== undefined ? parameters.precision : 'highp',\r\n\r\n    _alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n    _depth = parameters.depth !== undefined ? parameters.depth : true,\r\n    _stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n    _antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n    _premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n    _preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n    _logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false,\r\n\r\n    _clearColor = new THREE.Color(0x000000),\r\n    _clearAlpha = 0;\r\n\r\n  var lights = [];\r\n\r\n  var _webglObjects = {};\r\n  var _webglObjectsImmediate = [];\r\n\r\n  var opaqueObjects = [];\r\n  var transparentObjects = [];\r\n\r\n  var sprites = [];\r\n  var lensFlares = [];\r\n\r\n  // public properties\r\n\r\n  this.domElement = _canvas;\r\n  this.context = null;\r\n\r\n  // clearing\r\n\r\n  this.autoClear = true;\r\n  this.autoClearColor = true;\r\n  this.autoClearDepth = true;\r\n  this.autoClearStencil = true;\r\n\r\n  // scene graph\r\n\r\n  this.sortObjects = true;\r\n\r\n  // physically based shading\r\n\r\n  this.gammaFactor = 2.0; // for backwards compatibility\r\n  this.gammaInput = false;\r\n  this.gammaOutput = false;\r\n\r\n  // shadow map\r\n\r\n  this.shadowMapEnabled = false;\r\n  this.shadowMapType = THREE.PCFShadowMap;\r\n  this.shadowMapCullFace = THREE.CullFaceFront;\r\n  this.shadowMapDebug = false;\r\n  this.shadowMapCascade = false;\r\n\r\n  // morphs\r\n\r\n  this.maxMorphTargets = 8;\r\n  this.maxMorphNormals = 4;\r\n\r\n  // flags\r\n\r\n  this.autoScaleCubemaps = true;\r\n\r\n  // info\r\n\r\n  this.info = {\r\n\r\n    memory: {\r\n\r\n      programs: 0,\r\n      geometries: 0,\r\n      textures: 0\r\n\r\n    },\r\n\r\n    render: {\r\n\r\n      calls: 0,\r\n      vertices: 0,\r\n      faces: 0,\r\n      points: 0\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // internal properties\r\n\r\n  var _this = this,\r\n\r\n    _programs = [],\r\n\r\n    // internal state cache\r\n\r\n    _currentProgram = null,\r\n    _currentFramebuffer = null,\r\n    _currentMaterialId = -1,\r\n    _currentGeometryProgram = '',\r\n    _currentCamera = null,\r\n\r\n    _usedTextureUnits = 0,\r\n\r\n    _viewportX = 0,\r\n    _viewportY = 0,\r\n    _viewportWidth = _canvas.width,\r\n    _viewportHeight = _canvas.height,\r\n    _currentWidth = 0,\r\n    _currentHeight = 0,\r\n\r\n    // frustum\r\n\r\n    _frustum = new THREE.Frustum(),\r\n\r\n    // camera matrices cache\r\n\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _vector3 = new THREE.Vector3(),\r\n\r\n    // light arrays cache\r\n\r\n    _direction = new THREE.Vector3(),\r\n\r\n    _lightsNeedUpdate = true,\r\n\r\n    _lights = {\r\n\r\n      ambient: [0, 0, 0],\r\n      directional: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: []\r\n      },\r\n      point: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        decays: []\r\n      },\r\n      spot: {\r\n        length: 0,\r\n        colors: [],\r\n        positions: [],\r\n        distances: [],\r\n        directions: [],\r\n        anglesCos: [],\r\n        exponents: [],\r\n        decays: []\r\n      },\r\n      hemi: {\r\n        length: 0,\r\n        skyColors: [],\r\n        groundColors: [],\r\n        positions: []\r\n      }\r\n\r\n    };\r\n\r\n  // initialize\r\n\r\n  var _gl;\r\n\r\n  try {\r\n\r\n    var attributes = {\r\n      alpha: _alpha,\r\n      depth: _depth,\r\n      stencil: _stencil,\r\n      antialias: _antialias,\r\n      premultipliedAlpha: _premultipliedAlpha,\r\n      preserveDrawingBuffer: _preserveDrawingBuffer\r\n    };\r\n\r\n    _gl = _context || _canvas.getContext('webgl', attributes) || _canvas.getContext('experimental-webgl', attributes);\r\n\r\n    if (_gl === null) {\r\n\r\n      if (_canvas.getContext('webgl') !== null) {\r\n\r\n        throw 'Error creating WebGL context with your selected attributes.';\r\n\r\n      }\r\n      else {\r\n\r\n        throw 'Error creating WebGL context.';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _canvas.addEventListener('webglcontextlost', function(event) {\r\n\r\n      event.preventDefault();\r\n\r\n      resetGLState();\r\n      setDefaultGLState();\r\n\r\n      _webglObjects = {};\r\n\r\n    }, false);\r\n\r\n  }\r\n  catch (error) {\r\n\r\n    THREE.error('THREE.WebGLRenderer: ' + error);\r\n\r\n  }\r\n\r\n  var state = new THREE.WebGLState(_gl, paramThreeToGL);\r\n\r\n  if (_gl.getShaderPrecisionFormat === undefined) {\r\n\r\n    _gl.getShaderPrecisionFormat = function() {\r\n\r\n      return {\r\n        'rangeMin': 1,\r\n        'rangeMax': 1,\r\n        'precision': 1\r\n      };\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var extensions = new THREE.WebGLExtensions(_gl);\r\n\r\n  extensions.get('OES_texture_float');\r\n  extensions.get('OES_texture_float_linear');\r\n  extensions.get('OES_texture_half_float');\r\n  extensions.get('OES_texture_half_float_linear');\r\n  extensions.get('OES_standard_derivatives');\r\n\r\n  if (_logarithmicDepthBuffer) {\r\n\r\n    extensions.get('EXT_frag_depth');\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var glClearColor = function(r, g, b, a) {\r\n\r\n    if (_premultipliedAlpha === true) {\r\n\r\n      r *= a;\r\n      g *= a;\r\n      b *= a;\r\n\r\n    }\r\n\r\n    _gl.clearColor(r, g, b, a);\r\n\r\n  };\r\n\r\n  var setDefaultGLState = function() {\r\n\r\n    _gl.clearColor(0, 0, 0, 1);\r\n    _gl.clearDepth(1);\r\n    _gl.clearStencil(0);\r\n\r\n    _gl.enable(_gl.DEPTH_TEST);\r\n    _gl.depthFunc(_gl.LEQUAL);\r\n\r\n    _gl.frontFace(_gl.CCW);\r\n    _gl.cullFace(_gl.BACK);\r\n    _gl.enable(_gl.CULL_FACE);\r\n\r\n    _gl.enable(_gl.BLEND);\r\n    _gl.blendEquation(_gl.FUNC_ADD);\r\n    _gl.blendFunc(_gl.SRC_ALPHA, _gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  var resetGLState = function() {\r\n\r\n    _currentProgram = null;\r\n    _currentCamera = null;\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n\r\n    _lightsNeedUpdate = true;\r\n\r\n    state.reset();\r\n\r\n  };\r\n\r\n  setDefaultGLState();\r\n\r\n  this.context = _gl;\r\n  this.state = state;\r\n\r\n  // GPU capabilities\r\n\r\n  var _maxTextures = _gl.getParameter(_gl.MAX_TEXTURE_IMAGE_UNITS);\r\n  var _maxVertexTextures = _gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n  var _maxTextureSize = _gl.getParameter(_gl.MAX_TEXTURE_SIZE);\r\n  var _maxCubemapSize = _gl.getParameter(_gl.MAX_CUBE_MAP_TEXTURE_SIZE);\r\n\r\n  var _supportsVertexTextures = _maxVertexTextures > 0;\r\n  var _supportsBoneTextures = _supportsVertexTextures && extensions.get('OES_texture_float');\r\n\r\n  //\r\n\r\n  var _vertexShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.HIGH_FLOAT);\r\n  var _vertexShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var _fragmentShaderPrecisionHighpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.HIGH_FLOAT);\r\n  var _fragmentShaderPrecisionMediumpFloat = _gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER, _gl.MEDIUM_FLOAT);\r\n\r\n  var getCompressedTextureFormats = (function() {\r\n\r\n    var array;\r\n\r\n    return function() {\r\n\r\n      if (array !== undefined) {\r\n\r\n        return array;\r\n\r\n      }\r\n\r\n      array = [];\r\n\r\n      if (extensions.get('WEBGL_compressed_texture_pvrtc') || extensions.get('WEBGL_compressed_texture_s3tc')) {\r\n\r\n        var formats = _gl.getParameter(_gl.COMPRESSED_TEXTURE_FORMATS);\r\n\r\n        for (var i = 0; i < formats.length; i++) {\r\n\r\n          array.push(formats[i]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return array;\r\n\r\n    };\r\n\r\n  })();\r\n\r\n  // clamp precision to maximum available\r\n\r\n  var highpAvailable = _vertexShaderPrecisionHighpFloat.precision > 0 && _fragmentShaderPrecisionHighpFloat.precision > 0;\r\n  var mediumpAvailable = _vertexShaderPrecisionMediumpFloat.precision > 0 && _fragmentShaderPrecisionMediumpFloat.precision > 0;\r\n\r\n  if (_precision === 'highp' && !highpAvailable) {\r\n\r\n    if (mediumpAvailable) {\r\n\r\n      _precision = 'mediump';\r\n      THREE.warn('THREE.WebGLRenderer: highp not supported, using mediump.');\r\n\r\n    }\r\n    else {\r\n\r\n      _precision = 'lowp';\r\n      THREE.warn('THREE.WebGLRenderer: highp and mediump not supported, using lowp.');\r\n\r\n    }\r\n\r\n  }\r\n\r\n  if (_precision === 'mediump' && !mediumpAvailable) {\r\n\r\n    _precision = 'lowp';\r\n    THREE.warn('THREE.WebGLRenderer: mediump not supported, using lowp.');\r\n\r\n  }\r\n\r\n  // Plugins\r\n\r\n  var shadowMapPlugin = new THREE.ShadowMapPlugin(this, lights, _webglObjects, _webglObjectsImmediate);\r\n\r\n  var spritePlugin = new THREE.SpritePlugin(this, sprites);\r\n  var lensFlarePlugin = new THREE.LensFlarePlugin(this, lensFlares);\r\n\r\n  // API\r\n\r\n  this.getContext = function() {\r\n\r\n    return _gl;\r\n\r\n  };\r\n\r\n  this.forceContextLoss = function() {\r\n\r\n    extensions.get('WEBGL_lose_context').loseContext();\r\n\r\n  };\r\n\r\n  this.supportsVertexTextures = function() {\r\n\r\n    return _supportsVertexTextures;\r\n\r\n  };\r\n\r\n  this.supportsFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_float');\r\n\r\n  };\r\n\r\n  this.supportsHalfFloatTextures = function() {\r\n\r\n    return extensions.get('OES_texture_half_float');\r\n\r\n  };\r\n\r\n  this.supportsStandardDerivatives = function() {\r\n\r\n    return extensions.get('OES_standard_derivatives');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTextureS3TC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n  };\r\n\r\n  this.supportsCompressedTexturePVRTC = function() {\r\n\r\n    return extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n  };\r\n\r\n  this.supportsBlendMinMax = function() {\r\n\r\n    return extensions.get('EXT_blend_minmax');\r\n\r\n  };\r\n\r\n  this.getMaxAnisotropy = (function() {\r\n\r\n    var value;\r\n\r\n    return function() {\r\n\r\n      if (value !== undefined) {\r\n\r\n        return value;\r\n\r\n      }\r\n\r\n      var extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n      value = extension !== null ? _gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0;\r\n\r\n      return value;\r\n\r\n    }\r\n\r\n  })();\r\n\r\n  this.getPrecision = function() {\r\n\r\n    return _precision;\r\n\r\n  };\r\n\r\n  this.getPixelRatio = function() {\r\n\r\n    return pixelRatio;\r\n\r\n  };\r\n\r\n  this.setPixelRatio = function(value) {\r\n\r\n    pixelRatio = value;\r\n\r\n  };\r\n\r\n  this.setSize = function(width, height, updateStyle) {\r\n\r\n    _canvas.width = width * pixelRatio;\r\n    _canvas.height = height * pixelRatio;\r\n\r\n    if (updateStyle !== false) {\r\n\r\n      _canvas.style.width = width + 'px';\r\n      _canvas.style.height = height + 'px';\r\n\r\n    }\r\n\r\n    this.setViewport(0, 0, width, height);\r\n\r\n  };\r\n\r\n  this.setViewport = function(x, y, width, height) {\r\n\r\n    _viewportX = x * pixelRatio;\r\n    _viewportY = y * pixelRatio;\r\n\r\n    _viewportWidth = width * pixelRatio;\r\n    _viewportHeight = height * pixelRatio;\r\n\r\n    _gl.viewport(_viewportX, _viewportY, _viewportWidth, _viewportHeight);\r\n\r\n  };\r\n\r\n  this.setScissor = function(x, y, width, height) {\r\n\r\n    _gl.scissor(\r\n      x * pixelRatio,\r\n      y * pixelRatio,\r\n      width * pixelRatio,\r\n      height * pixelRatio\r\n    );\r\n\r\n  };\r\n\r\n  this.enableScissorTest = function(enable) {\r\n\r\n    enable ? _gl.enable(_gl.SCISSOR_TEST) : _gl.disable(_gl.SCISSOR_TEST);\r\n\r\n  };\r\n\r\n  // Clearing\r\n\r\n  this.getClearColor = function() {\r\n\r\n    return _clearColor;\r\n\r\n  };\r\n\r\n  this.setClearColor = function(color, alpha) {\r\n\r\n    _clearColor.set(color);\r\n\r\n    _clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.getClearAlpha = function() {\r\n\r\n    return _clearAlpha;\r\n\r\n  };\r\n\r\n  this.setClearAlpha = function(alpha) {\r\n\r\n    _clearAlpha = alpha;\r\n\r\n    glClearColor(_clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha);\r\n\r\n  };\r\n\r\n  this.clear = function(color, depth, stencil) {\r\n\r\n    var bits = 0;\r\n\r\n    if (color === undefined || color) bits |= _gl.COLOR_BUFFER_BIT;\r\n    if (depth === undefined || depth) bits |= _gl.DEPTH_BUFFER_BIT;\r\n    if (stencil === undefined || stencil) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n    _gl.clear(bits);\r\n\r\n  };\r\n\r\n  this.clearColor = function() {\r\n\r\n    _gl.clear(_gl.COLOR_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearDepth = function() {\r\n\r\n    _gl.clear(_gl.DEPTH_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearStencil = function() {\r\n\r\n    _gl.clear(_gl.STENCIL_BUFFER_BIT);\r\n\r\n  };\r\n\r\n  this.clearTarget = function(renderTarget, color, depth, stencil) {\r\n\r\n    this.setRenderTarget(renderTarget);\r\n    this.clear(color, depth, stencil);\r\n\r\n  };\r\n\r\n  // Reset\r\n\r\n  this.resetGLState = resetGLState;\r\n\r\n  // Buffer allocation\r\n\r\n  function createParticleBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createLineBuffers(geometry) {\r\n\r\n    geometry.__webglVertexBuffer = _gl.createBuffer();\r\n    geometry.__webglColorBuffer = _gl.createBuffer();\r\n    geometry.__webglLineDistanceBuffer = _gl.createBuffer();\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  function createMeshBuffers(geometryGroup) {\r\n\r\n    geometryGroup.__webglVertexBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglNormalBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglTangentBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglColorBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUVBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglUV2Buffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglSkinIndicesBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglSkinWeightsBuffer = _gl.createBuffer();\r\n\r\n    geometryGroup.__webglFaceBuffer = _gl.createBuffer();\r\n    geometryGroup.__webglLineBuffer = _gl.createBuffer();\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__webglMorphTargetsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphTargetsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__webglMorphNormalsBuffers = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__webglMorphNormalsBuffers.push(_gl.createBuffer());\r\n\r\n      }\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries++;\r\n\r\n  };\r\n\r\n  // Events\r\n\r\n  var onObjectRemoved = function(event) {\r\n\r\n    var object = event.target;\r\n\r\n    object.traverse(function(child) {\r\n\r\n      child.removeEventListener('remove', onObjectRemoved);\r\n\r\n      removeObject(child);\r\n\r\n    });\r\n\r\n  };\r\n\r\n  var onGeometryDispose = function(event) {\r\n\r\n    var geometry = event.target;\r\n\r\n    geometry.removeEventListener('dispose', onGeometryDispose);\r\n\r\n    deallocateGeometry(geometry);\r\n\r\n  };\r\n\r\n  var onTextureDispose = function(event) {\r\n\r\n    var texture = event.target;\r\n\r\n    texture.removeEventListener('dispose', onTextureDispose);\r\n\r\n    deallocateTexture(texture);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n\r\n  };\r\n\r\n  var onRenderTargetDispose = function(event) {\r\n\r\n    var renderTarget = event.target;\r\n\r\n    renderTarget.removeEventListener('dispose', onRenderTargetDispose);\r\n\r\n    deallocateRenderTarget(renderTarget);\r\n\r\n    _this.info.memory.textures--;\r\n\r\n  };\r\n\r\n  var onMaterialDispose = function(event) {\r\n\r\n    var material = event.target;\r\n\r\n    material.removeEventListener('dispose', onMaterialDispose);\r\n\r\n    deallocateMaterial(material);\r\n\r\n  };\r\n\r\n  // Buffer deallocation\r\n\r\n  var deleteBuffers = function(geometry) {\r\n\r\n    var buffers = [\r\n      '__webglVertexBuffer',\r\n      '__webglNormalBuffer',\r\n      '__webglTangentBuffer',\r\n      '__webglColorBuffer',\r\n      '__webglUVBuffer',\r\n      '__webglUV2Buffer',\r\n\r\n      '__webglSkinIndicesBuffer',\r\n      '__webglSkinWeightsBuffer',\r\n\r\n      '__webglFaceBuffer',\r\n      '__webglLineBuffer',\r\n\r\n      '__webglLineDistanceBuffer'\r\n    ];\r\n\r\n    for (var i = 0, l = buffers.length; i < l; i++) {\r\n\r\n      var name = buffers[i];\r\n\r\n      if (geometry[name] !== undefined) {\r\n\r\n        _gl.deleteBuffer(geometry[name]);\r\n\r\n        delete geometry[name];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // custom attributes\r\n\r\n    if (geometry.__webglCustomAttributesList !== undefined) {\r\n\r\n      for (var name in geometry.__webglCustomAttributesList) {\r\n\r\n        _gl.deleteBuffer(geometry.__webglCustomAttributesList[name].buffer);\r\n\r\n      }\r\n\r\n      delete geometry.__webglCustomAttributesList;\r\n\r\n    }\r\n\r\n    _this.info.memory.geometries--;\r\n\r\n  };\r\n\r\n  var deallocateGeometry = function(geometry) {\r\n\r\n    delete geometry.__webglInit;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      for (var name in geometry.attributes) {\r\n\r\n        var attribute = geometry.attributes[name];\r\n\r\n        if (attribute.buffer !== undefined) {\r\n\r\n          _gl.deleteBuffer(attribute.buffer);\r\n\r\n          delete attribute.buffer;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _this.info.memory.geometries--;\r\n\r\n    }\r\n    else {\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      if (geometryGroupsList !== undefined) {\r\n\r\n        for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n          var geometryGroup = geometryGroupsList[i];\r\n\r\n          if (geometryGroup.numMorphTargets !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphTargets; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphTargetsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphTargetsBuffers;\r\n\r\n          }\r\n\r\n          if (geometryGroup.numMorphNormals !== undefined) {\r\n\r\n            for (var m = 0, ml = geometryGroup.numMorphNormals; m < ml; m++) {\r\n\r\n              _gl.deleteBuffer(geometryGroup.__webglMorphNormalsBuffers[m]);\r\n\r\n            }\r\n\r\n            delete geometryGroup.__webglMorphNormalsBuffers;\r\n\r\n          }\r\n\r\n          deleteBuffers(geometryGroup);\r\n\r\n        }\r\n\r\n        delete geometryGroups[geometry.id];\r\n\r\n      }\r\n      else {\r\n\r\n        deleteBuffers(geometry);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // TOFIX: Workaround for deleted geometry being currently bound\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n  };\r\n\r\n  var deallocateTexture = function(texture) {\r\n\r\n    if (texture.image && texture.image.__webglTextureCube) {\r\n\r\n      // cube texture\r\n\r\n      _gl.deleteTexture(texture.image.__webglTextureCube);\r\n\r\n      delete texture.image.__webglTextureCube;\r\n\r\n    }\r\n    else {\r\n\r\n      // 2D texture\r\n\r\n      if (texture.__webglInit === undefined) return;\r\n\r\n      _gl.deleteTexture(texture.__webglTexture);\r\n\r\n      delete texture.__webglTexture;\r\n      delete texture.__webglInit;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  var deallocateRenderTarget = function(renderTarget) {\r\n\r\n    if (!renderTarget || renderTarget.__webglTexture === undefined) return;\r\n\r\n    _gl.deleteTexture(renderTarget.__webglTexture);\r\n\r\n    delete renderTarget.__webglTexture;\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      for (var i = 0; i < 6; i++) {\r\n\r\n        _gl.deleteFramebuffer(renderTarget.__webglFramebuffer[i]);\r\n        _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer[i]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.deleteFramebuffer(renderTarget.__webglFramebuffer);\r\n      _gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer);\r\n\r\n    }\r\n\r\n    delete renderTarget.__webglFramebuffer;\r\n    delete renderTarget.__webglRenderbuffer;\r\n\r\n  };\r\n\r\n  var deallocateMaterial = function(material) {\r\n\r\n    var program = material.program.program;\r\n\r\n    if (program === undefined) return;\r\n\r\n    material.program = undefined;\r\n\r\n    // only deallocate GL program if this was the last use of shared program\r\n    // assumed there is only single copy of any program in the _programs list\r\n    // (that's how it's constructed)\r\n\r\n    var i, il, programInfo;\r\n    var deleteProgram = false;\r\n\r\n    for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n      programInfo = _programs[i];\r\n\r\n      if (programInfo.program === program) {\r\n\r\n        programInfo.usedTimes--;\r\n\r\n        if (programInfo.usedTimes === 0) {\r\n\r\n          deleteProgram = true;\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (deleteProgram === true) {\r\n\r\n      // avoid using array.splice, this is costlier than creating new array from scratch\r\n\r\n      var newPrograms = [];\r\n\r\n      for (i = 0, il = _programs.length; i < il; i++) {\r\n\r\n        programInfo = _programs[i];\r\n\r\n        if (programInfo.program !== program) {\r\n\r\n          newPrograms.push(programInfo);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _programs = newPrograms;\r\n\r\n      _gl.deleteProgram(program);\r\n\r\n      _this.info.memory.programs--;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer initialization\r\n\r\n  function initCustomAttributes(object) {\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometry.__webglCustomAttributesList === undefined) {\r\n\r\n        geometry.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        var attribute = material.attributes[name];\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          attribute.needsUpdate = true;\r\n\r\n        }\r\n\r\n        geometry.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function initParticleBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n\r\n    geometry.__webglParticleCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initLineBuffers(geometry, object) {\r\n\r\n    var nvertices = geometry.vertices.length;\r\n\r\n    geometry.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometry.__colorArray = new Float32Array(nvertices * 3);\r\n    geometry.__lineDistanceArray = new Float32Array(nvertices * 1);\r\n\r\n    geometry.__webglLineCount = nvertices;\r\n\r\n    initCustomAttributes(object);\r\n\r\n  };\r\n\r\n  function initMeshBuffers(geometryGroup, object) {\r\n\r\n    var geometry = object.geometry,\r\n      faces3 = geometryGroup.faces3,\r\n\r\n      nvertices = faces3.length * 3,\r\n      ntris = faces3.length * 1,\r\n      nlines = faces3.length * 3,\r\n\r\n      material = getBufferMaterial(object, geometryGroup);\r\n\r\n    geometryGroup.__vertexArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__normalArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__colorArray = new Float32Array(nvertices * 3);\r\n    geometryGroup.__uvArray = new Float32Array(nvertices * 2);\r\n\r\n    if (geometry.faceVertexUvs.length > 1) {\r\n\r\n      geometryGroup.__uv2Array = new Float32Array(nvertices * 2);\r\n\r\n    }\r\n\r\n    if (geometry.hasTangents) {\r\n\r\n      geometryGroup.__tangentArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    if (object.geometry.skinWeights.length && object.geometry.skinIndices.length) {\r\n\r\n      geometryGroup.__skinIndexArray = new Float32Array(nvertices * 4);\r\n      geometryGroup.__skinWeightArray = new Float32Array(nvertices * 4);\r\n\r\n    }\r\n\r\n    var UintArray = extensions.get('OES_element_index_uint') !== null && ntris > 21845 ? Uint32Array : Uint16Array; // 65535 / 3\r\n\r\n    geometryGroup.__typeArray = UintArray;\r\n    geometryGroup.__faceArray = new UintArray(ntris * 3);\r\n    geometryGroup.__lineArray = new UintArray(nlines * 2);\r\n\r\n    var numMorphTargets = geometryGroup.numMorphTargets;\r\n\r\n    if (numMorphTargets) {\r\n\r\n      geometryGroup.__morphTargetsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphTargets; m < ml; m++) {\r\n\r\n        geometryGroup.__morphTargetsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var numMorphNormals = geometryGroup.numMorphNormals;\r\n\r\n    if (numMorphNormals) {\r\n\r\n      geometryGroup.__morphNormalsArrays = [];\r\n\r\n      for (var m = 0, ml = numMorphNormals; m < ml; m++) {\r\n\r\n        geometryGroup.__morphNormalsArrays.push(new Float32Array(nvertices * 3));\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__webglFaceCount = ntris * 3;\r\n    geometryGroup.__webglLineCount = nlines * 2;\r\n\r\n\r\n    // custom attributes\r\n\r\n    if (material.attributes) {\r\n\r\n      if (geometryGroup.__webglCustomAttributesList === undefined) {\r\n\r\n        geometryGroup.__webglCustomAttributesList = [];\r\n\r\n      }\r\n\r\n      for (var name in material.attributes) {\r\n\r\n        // Do a shallow copy of the attribute object so different geometryGroup chunks use different\r\n        // attribute buffers which are correctly indexed in the setMeshBuffers function\r\n\r\n        var originalAttribute = material.attributes[name];\r\n\r\n        var attribute = {};\r\n\r\n        for (var property in originalAttribute) {\r\n\r\n          attribute[property] = originalAttribute[property];\r\n\r\n        }\r\n\r\n        if (!attribute.__webglInitialized || attribute.createUniqueBuffers) {\r\n\r\n          attribute.__webglInitialized = true;\r\n\r\n          var size = 1; // \"f\" and \"i\"\r\n\r\n          if (attribute.type === 'v2') size = 2;\r\n          else if (attribute.type === 'v3') size = 3;\r\n          else if (attribute.type === 'v4') size = 4;\r\n          else if (attribute.type === 'c') size = 3;\r\n\r\n          attribute.size = size;\r\n\r\n          attribute.array = new Float32Array(nvertices * size);\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          attribute.buffer.belongsToAttribute = name;\r\n\r\n          originalAttribute.needsUpdate = true;\r\n          attribute.__original = originalAttribute;\r\n\r\n        }\r\n\r\n        geometryGroup.__webglCustomAttributesList.push(attribute);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometryGroup.__inittedArrays = true;\r\n\r\n  };\r\n\r\n  function getBufferMaterial(object, geometryGroup) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[geometryGroup.materialIndex] : object.material;\r\n\r\n  }\r\n\r\n  function materialNeedsFaceNormals(material) {\r\n\r\n    return material instanceof THREE.MeshPhongMaterial === false && material.shading === THREE.FlatShading;\r\n\r\n  }\r\n\r\n  // Buffer setting\r\n\r\n  function setParticleBuffers(geometry, hint, object) {\r\n\r\n    var v, c, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      vl = vertices.length,\r\n\r\n      colors = geometry.colors,\r\n      cl = colors.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          offset = 0;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n        customAttribute.needsUpdate = false;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setLineBuffers(geometry, hint) {\r\n\r\n    var v, c, d, vertex, offset, color,\r\n\r\n      vertices = geometry.vertices,\r\n      colors = geometry.colors,\r\n      lineDistances = geometry.lineDistances,\r\n\r\n      vl = vertices.length,\r\n      cl = colors.length,\r\n      dl = lineDistances.length,\r\n\r\n      vertexArray = geometry.__vertexArray,\r\n      colorArray = geometry.__colorArray,\r\n      lineDistanceArray = geometry.__lineDistanceArray,\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyLineDistances = geometry.lineDistancesNeedUpdate,\r\n\r\n      customAttributes = geometry.__webglCustomAttributesList,\r\n\r\n      i, il,\r\n      ca, cal, value,\r\n      customAttribute;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (v = 0; v < vl; v++) {\r\n\r\n        vertex = vertices[v];\r\n\r\n        offset = v * 3;\r\n\r\n        vertexArray[offset] = vertex.x;\r\n        vertexArray[offset + 1] = vertex.y;\r\n        vertexArray[offset + 2] = vertex.z;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (c = 0; c < cl; c++) {\r\n\r\n        color = colors[c];\r\n\r\n        offset = c * 3;\r\n\r\n        colorArray[offset] = color.r;\r\n        colorArray[offset + 1] = color.g;\r\n        colorArray[offset + 2] = color.b;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyLineDistances) {\r\n\r\n      for (d = 0; d < dl; d++) {\r\n\r\n        lineDistanceArray[d] = lineDistances[d];\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometry.__webglLineDistanceBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, lineDistanceArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (customAttribute.needsUpdate && (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices')) {\r\n\r\n          offset = 0;\r\n\r\n          cal = customAttribute.value.length;\r\n\r\n          if (customAttribute.size === 1) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              customAttribute.array[ca] = customAttribute.value[ca];\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 2) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n\r\n              offset += 2;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 3) {\r\n\r\n            if (customAttribute.type === 'c') {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.r;\r\n                customAttribute.array[offset + 1] = value.g;\r\n                customAttribute.array[offset + 2] = value.b;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n            else {\r\n\r\n              for (ca = 0; ca < cal; ca++) {\r\n\r\n                value = customAttribute.value[ca];\r\n\r\n                customAttribute.array[offset] = value.x;\r\n                customAttribute.array[offset + 1] = value.y;\r\n                customAttribute.array[offset + 2] = value.z;\r\n\r\n                offset += 3;\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.size === 4) {\r\n\r\n            for (ca = 0; ca < cal; ca++) {\r\n\r\n              value = customAttribute.value[ca];\r\n\r\n              customAttribute.array[offset] = value.x;\r\n              customAttribute.array[offset + 1] = value.y;\r\n              customAttribute.array[offset + 2] = value.z;\r\n              customAttribute.array[offset + 3] = value.w;\r\n\r\n              offset += 4;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n          customAttribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMeshBuffers(geometryGroup, object, hint, dispose, material) {\r\n\r\n    if (!geometryGroup.__inittedArrays) {\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    var needsFaceNormals = materialNeedsFaceNormals(material);\r\n\r\n    var f, fl, fi, face,\r\n      vertexNormals, faceNormal,\r\n      vertexColors, faceColor,\r\n      vertexTangents,\r\n      uv, uv2, v1, v2, v3, t1, t2, t3, n1, n2, n3,\r\n      c1, c2, c3,\r\n      sw1, sw2, sw3,\r\n      si1, si2, si3,\r\n      i, il,\r\n      vn, uvi, uv2i,\r\n      vk, vkl, vka,\r\n      nka, chf, faceVertexNormals,\r\n\r\n      vertexIndex = 0,\r\n\r\n      offset = 0,\r\n      offset_uv = 0,\r\n      offset_uv2 = 0,\r\n      offset_face = 0,\r\n      offset_normal = 0,\r\n      offset_tangent = 0,\r\n      offset_line = 0,\r\n      offset_color = 0,\r\n      offset_skin = 0,\r\n      offset_morphTarget = 0,\r\n      offset_custom = 0,\r\n\r\n      value,\r\n\r\n      vertexArray = geometryGroup.__vertexArray,\r\n      uvArray = geometryGroup.__uvArray,\r\n      uv2Array = geometryGroup.__uv2Array,\r\n      normalArray = geometryGroup.__normalArray,\r\n      tangentArray = geometryGroup.__tangentArray,\r\n      colorArray = geometryGroup.__colorArray,\r\n\r\n      skinIndexArray = geometryGroup.__skinIndexArray,\r\n      skinWeightArray = geometryGroup.__skinWeightArray,\r\n\r\n      morphTargetsArrays = geometryGroup.__morphTargetsArrays,\r\n      morphNormalsArrays = geometryGroup.__morphNormalsArrays,\r\n\r\n      customAttributes = geometryGroup.__webglCustomAttributesList,\r\n      customAttribute,\r\n\r\n      faceArray = geometryGroup.__faceArray,\r\n      lineArray = geometryGroup.__lineArray,\r\n\r\n      geometry = object.geometry, // this is shared for all chunks\r\n\r\n      dirtyVertices = geometry.verticesNeedUpdate,\r\n      dirtyElements = geometry.elementsNeedUpdate,\r\n      dirtyUvs = geometry.uvsNeedUpdate,\r\n      dirtyNormals = geometry.normalsNeedUpdate,\r\n      dirtyTangents = geometry.tangentsNeedUpdate,\r\n      dirtyColors = geometry.colorsNeedUpdate,\r\n      dirtyMorphTargets = geometry.morphTargetsNeedUpdate,\r\n\r\n      vertices = geometry.vertices,\r\n      chunk_faces3 = geometryGroup.faces3,\r\n      obj_faces = geometry.faces,\r\n\r\n      obj_uvs = geometry.faceVertexUvs[0],\r\n      obj_uvs2 = geometry.faceVertexUvs[1],\r\n\r\n      obj_skinIndices = geometry.skinIndices,\r\n      obj_skinWeights = geometry.skinWeights,\r\n\r\n      morphTargets = geometry.morphTargets,\r\n      morphNormals = geometry.morphNormals;\r\n\r\n    if (dirtyVertices) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        v1 = vertices[face.a];\r\n        v2 = vertices[face.b];\r\n        v3 = vertices[face.c];\r\n\r\n        vertexArray[offset] = v1.x;\r\n        vertexArray[offset + 1] = v1.y;\r\n        vertexArray[offset + 2] = v1.z;\r\n\r\n        vertexArray[offset + 3] = v2.x;\r\n        vertexArray[offset + 4] = v2.y;\r\n        vertexArray[offset + 5] = v2.z;\r\n\r\n        vertexArray[offset + 6] = v3.x;\r\n        vertexArray[offset + 7] = v3.y;\r\n        vertexArray[offset + 8] = v3.z;\r\n\r\n        offset += 9;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, vertexArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyMorphTargets) {\r\n\r\n      for (vk = 0, vkl = morphTargets.length; vk < vkl; vk++) {\r\n\r\n        offset_morphTarget = 0;\r\n\r\n        for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n          chf = chunk_faces3[f];\r\n          face = obj_faces[chf];\r\n\r\n          // morph positions\r\n\r\n          v1 = morphTargets[vk].vertices[face.a];\r\n          v2 = morphTargets[vk].vertices[face.b];\r\n          v3 = morphTargets[vk].vertices[face.c];\r\n\r\n          vka = morphTargetsArrays[vk];\r\n\r\n          vka[offset_morphTarget] = v1.x;\r\n          vka[offset_morphTarget + 1] = v1.y;\r\n          vka[offset_morphTarget + 2] = v1.z;\r\n\r\n          vka[offset_morphTarget + 3] = v2.x;\r\n          vka[offset_morphTarget + 4] = v2.y;\r\n          vka[offset_morphTarget + 5] = v2.z;\r\n\r\n          vka[offset_morphTarget + 6] = v3.x;\r\n          vka[offset_morphTarget + 7] = v3.y;\r\n          vka[offset_morphTarget + 8] = v3.z;\r\n\r\n          // morph normals\r\n\r\n          if (material.morphNormals) {\r\n\r\n            if (needsFaceNormals) {\r\n\r\n              n1 = morphNormals[vk].faceNormals[chf];\r\n              n2 = n1;\r\n              n3 = n1;\r\n\r\n            }\r\n            else {\r\n\r\n              faceVertexNormals = morphNormals[vk].vertexNormals[chf];\r\n\r\n              n1 = faceVertexNormals.a;\r\n              n2 = faceVertexNormals.b;\r\n              n3 = faceVertexNormals.c;\r\n\r\n            }\r\n\r\n            nka = morphNormalsArrays[vk];\r\n\r\n            nka[offset_morphTarget] = n1.x;\r\n            nka[offset_morphTarget + 1] = n1.y;\r\n            nka[offset_morphTarget + 2] = n1.z;\r\n\r\n            nka[offset_morphTarget + 3] = n2.x;\r\n            nka[offset_morphTarget + 4] = n2.y;\r\n            nka[offset_morphTarget + 5] = n2.z;\r\n\r\n            nka[offset_morphTarget + 6] = n3.x;\r\n            nka[offset_morphTarget + 7] = n3.y;\r\n            nka[offset_morphTarget + 8] = n3.z;\r\n\r\n          }\r\n\r\n          //\r\n\r\n          offset_morphTarget += 9;\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[vk]);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, morphTargetsArrays[vk], hint);\r\n\r\n        if (material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[vk]);\r\n          _gl.bufferData(_gl.ARRAY_BUFFER, morphNormalsArrays[vk], hint);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (obj_skinWeights.length) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        // weights\r\n\r\n        sw1 = obj_skinWeights[face.a];\r\n        sw2 = obj_skinWeights[face.b];\r\n        sw3 = obj_skinWeights[face.c];\r\n\r\n        skinWeightArray[offset_skin] = sw1.x;\r\n        skinWeightArray[offset_skin + 1] = sw1.y;\r\n        skinWeightArray[offset_skin + 2] = sw1.z;\r\n        skinWeightArray[offset_skin + 3] = sw1.w;\r\n\r\n        skinWeightArray[offset_skin + 4] = sw2.x;\r\n        skinWeightArray[offset_skin + 5] = sw2.y;\r\n        skinWeightArray[offset_skin + 6] = sw2.z;\r\n        skinWeightArray[offset_skin + 7] = sw2.w;\r\n\r\n        skinWeightArray[offset_skin + 8] = sw3.x;\r\n        skinWeightArray[offset_skin + 9] = sw3.y;\r\n        skinWeightArray[offset_skin + 10] = sw3.z;\r\n        skinWeightArray[offset_skin + 11] = sw3.w;\r\n\r\n        // indices\r\n\r\n        si1 = obj_skinIndices[face.a];\r\n        si2 = obj_skinIndices[face.b];\r\n        si3 = obj_skinIndices[face.c];\r\n\r\n        skinIndexArray[offset_skin] = si1.x;\r\n        skinIndexArray[offset_skin + 1] = si1.y;\r\n        skinIndexArray[offset_skin + 2] = si1.z;\r\n        skinIndexArray[offset_skin + 3] = si1.w;\r\n\r\n        skinIndexArray[offset_skin + 4] = si2.x;\r\n        skinIndexArray[offset_skin + 5] = si2.y;\r\n        skinIndexArray[offset_skin + 6] = si2.z;\r\n        skinIndexArray[offset_skin + 7] = si2.w;\r\n\r\n        skinIndexArray[offset_skin + 8] = si3.x;\r\n        skinIndexArray[offset_skin + 9] = si3.y;\r\n        skinIndexArray[offset_skin + 10] = si3.z;\r\n        skinIndexArray[offset_skin + 11] = si3.w;\r\n\r\n        offset_skin += 12;\r\n\r\n      }\r\n\r\n      if (offset_skin > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinIndexArray, hint);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, skinWeightArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyColors) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexColors = face.vertexColors;\r\n        faceColor = face.color;\r\n\r\n        if (vertexColors.length === 3 && material.vertexColors === THREE.VertexColors) {\r\n\r\n          c1 = vertexColors[0];\r\n          c2 = vertexColors[1];\r\n          c3 = vertexColors[2];\r\n\r\n        }\r\n        else {\r\n\r\n          c1 = faceColor;\r\n          c2 = faceColor;\r\n          c3 = faceColor;\r\n\r\n        }\r\n\r\n        colorArray[offset_color] = c1.r;\r\n        colorArray[offset_color + 1] = c1.g;\r\n        colorArray[offset_color + 2] = c1.b;\r\n\r\n        colorArray[offset_color + 3] = c2.r;\r\n        colorArray[offset_color + 4] = c2.g;\r\n        colorArray[offset_color + 5] = c2.b;\r\n\r\n        colorArray[offset_color + 6] = c3.r;\r\n        colorArray[offset_color + 7] = c3.g;\r\n        colorArray[offset_color + 8] = c3.b;\r\n\r\n        offset_color += 9;\r\n\r\n      }\r\n\r\n      if (offset_color > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, colorArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyTangents && geometry.hasTangents) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexTangents = face.vertexTangents;\r\n\r\n        t1 = vertexTangents[0];\r\n        t2 = vertexTangents[1];\r\n        t3 = vertexTangents[2];\r\n\r\n        tangentArray[offset_tangent] = t1.x;\r\n        tangentArray[offset_tangent + 1] = t1.y;\r\n        tangentArray[offset_tangent + 2] = t1.z;\r\n        tangentArray[offset_tangent + 3] = t1.w;\r\n\r\n        tangentArray[offset_tangent + 4] = t2.x;\r\n        tangentArray[offset_tangent + 5] = t2.y;\r\n        tangentArray[offset_tangent + 6] = t2.z;\r\n        tangentArray[offset_tangent + 7] = t2.w;\r\n\r\n        tangentArray[offset_tangent + 8] = t3.x;\r\n        tangentArray[offset_tangent + 9] = t3.y;\r\n        tangentArray[offset_tangent + 10] = t3.z;\r\n        tangentArray[offset_tangent + 11] = t3.w;\r\n\r\n        offset_tangent += 12;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, tangentArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyNormals) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        face = obj_faces[chunk_faces3[f]];\r\n\r\n        vertexNormals = face.vertexNormals;\r\n        faceNormal = face.normal;\r\n\r\n        if (vertexNormals.length === 3 && needsFaceNormals === false) {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            vn = vertexNormals[i];\r\n\r\n            normalArray[offset_normal] = vn.x;\r\n            normalArray[offset_normal + 1] = vn.y;\r\n            normalArray[offset_normal + 2] = vn.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          for (i = 0; i < 3; i++) {\r\n\r\n            normalArray[offset_normal] = faceNormal.x;\r\n            normalArray[offset_normal + 1] = faceNormal.y;\r\n            normalArray[offset_normal + 2] = faceNormal.z;\r\n\r\n            offset_normal += 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, normalArray, hint);\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv = obj_uvs[fi];\r\n\r\n        if (uv === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uvi = uv[i];\r\n\r\n          uvArray[offset_uv] = uvi.x;\r\n          uvArray[offset_uv + 1] = uvi.y;\r\n\r\n          offset_uv += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uvArray, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyUvs && obj_uvs2) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        fi = chunk_faces3[f];\r\n\r\n        uv2 = obj_uvs2[fi];\r\n\r\n        if (uv2 === undefined) continue;\r\n\r\n        for (i = 0; i < 3; i++) {\r\n\r\n          uv2i = uv2[i];\r\n\r\n          uv2Array[offset_uv2] = uv2i.x;\r\n          uv2Array[offset_uv2 + 1] = uv2i.y;\r\n\r\n          offset_uv2 += 2;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (offset_uv2 > 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, uv2Array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dirtyElements) {\r\n\r\n      for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n        faceArray[offset_face] = vertexIndex;\r\n        faceArray[offset_face + 1] = vertexIndex + 1;\r\n        faceArray[offset_face + 2] = vertexIndex + 2;\r\n\r\n        offset_face += 3;\r\n\r\n        lineArray[offset_line] = vertexIndex;\r\n        lineArray[offset_line + 1] = vertexIndex + 1;\r\n\r\n        lineArray[offset_line + 2] = vertexIndex;\r\n        lineArray[offset_line + 3] = vertexIndex + 2;\r\n\r\n        lineArray[offset_line + 4] = vertexIndex + 1;\r\n        lineArray[offset_line + 5] = vertexIndex + 2;\r\n\r\n        offset_line += 6;\r\n\r\n        vertexIndex += 3;\r\n\r\n      }\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, faceArray, hint);\r\n\r\n      _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n      _gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER, lineArray, hint);\r\n\r\n    }\r\n\r\n    if (customAttributes) {\r\n\r\n      for (i = 0, il = customAttributes.length; i < il; i++) {\r\n\r\n        customAttribute = customAttributes[i];\r\n\r\n        if (!customAttribute.__original.needsUpdate) continue;\r\n\r\n        offset_custom = 0;\r\n\r\n        if (customAttribute.size === 1) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = customAttribute.value[face.a];\r\n              customAttribute.array[offset_custom + 1] = customAttribute.value[face.b];\r\n              customAttribute.array[offset_custom + 2] = customAttribute.value[face.c];\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              customAttribute.array[offset_custom] = value;\r\n              customAttribute.array[offset_custom + 1] = value;\r\n              customAttribute.array[offset_custom + 2] = value;\r\n\r\n              offset_custom += 3;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 2) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n\r\n              customAttribute.array[offset_custom + 2] = v2.x;\r\n              customAttribute.array[offset_custom + 3] = v2.y;\r\n\r\n              customAttribute.array[offset_custom + 4] = v3.x;\r\n              customAttribute.array[offset_custom + 5] = v3.y;\r\n\r\n              offset_custom += 6;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 3) {\r\n\r\n          var pp;\r\n\r\n          if (customAttribute.type === 'c') {\r\n\r\n            pp = ['r', 'g', 'b'];\r\n\r\n          }\r\n          else {\r\n\r\n            pp = ['x', 'y', 'z'];\r\n\r\n          }\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1[pp[0]];\r\n              customAttribute.array[offset_custom + 1] = v1[pp[1]];\r\n              customAttribute.array[offset_custom + 2] = v1[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 3] = v2[pp[0]];\r\n              customAttribute.array[offset_custom + 4] = v2[pp[1]];\r\n              customAttribute.array[offset_custom + 5] = v2[pp[2]];\r\n\r\n              customAttribute.array[offset_custom + 6] = v3[pp[0]];\r\n              customAttribute.array[offset_custom + 7] = v3[pp[1]];\r\n              customAttribute.array[offset_custom + 8] = v3[pp[2]];\r\n\r\n              offset_custom += 9;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n        else if (customAttribute.size === 4) {\r\n\r\n          if (customAttribute.boundTo === undefined || customAttribute.boundTo === 'vertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              face = obj_faces[chunk_faces3[f]];\r\n\r\n              v1 = customAttribute.value[face.a];\r\n              v2 = customAttribute.value[face.b];\r\n              v3 = customAttribute.value[face.c];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faces') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value;\r\n              v2 = value;\r\n              v3 = value;\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n          else if (customAttribute.boundTo === 'faceVertices') {\r\n\r\n            for (f = 0, fl = chunk_faces3.length; f < fl; f++) {\r\n\r\n              value = customAttribute.value[chunk_faces3[f]];\r\n\r\n              v1 = value[0];\r\n              v2 = value[1];\r\n              v3 = value[2];\r\n\r\n              customAttribute.array[offset_custom] = v1.x;\r\n              customAttribute.array[offset_custom + 1] = v1.y;\r\n              customAttribute.array[offset_custom + 2] = v1.z;\r\n              customAttribute.array[offset_custom + 3] = v1.w;\r\n\r\n              customAttribute.array[offset_custom + 4] = v2.x;\r\n              customAttribute.array[offset_custom + 5] = v2.y;\r\n              customAttribute.array[offset_custom + 6] = v2.z;\r\n              customAttribute.array[offset_custom + 7] = v2.w;\r\n\r\n              customAttribute.array[offset_custom + 8] = v3.x;\r\n              customAttribute.array[offset_custom + 9] = v3.y;\r\n              customAttribute.array[offset_custom + 10] = v3.z;\r\n              customAttribute.array[offset_custom + 11] = v3.w;\r\n\r\n              offset_custom += 12;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, customAttribute.buffer);\r\n        _gl.bufferData(_gl.ARRAY_BUFFER, customAttribute.array, hint);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (dispose) {\r\n\r\n      delete geometryGroup.__inittedArrays;\r\n      delete geometryGroup.__colorArray;\r\n      delete geometryGroup.__normalArray;\r\n      delete geometryGroup.__tangentArray;\r\n      delete geometryGroup.__uvArray;\r\n      delete geometryGroup.__uv2Array;\r\n      delete geometryGroup.__faceArray;\r\n      delete geometryGroup.__vertexArray;\r\n      delete geometryGroup.__lineArray;\r\n      delete geometryGroup.__skinIndexArray;\r\n      delete geometryGroup.__skinWeightArray;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  // Buffer rendering\r\n\r\n  this.renderBufferImmediate = function(object, program, material) {\r\n\r\n    state.initAttributes();\r\n\r\n    if (object.hasPositions && !object.__webglVertexBuffer) object.__webglVertexBuffer = _gl.createBuffer();\r\n    if (object.hasNormals && !object.__webglNormalBuffer) object.__webglNormalBuffer = _gl.createBuffer();\r\n    if (object.hasUvs && !object.__webglUvBuffer) object.__webglUvBuffer = _gl.createBuffer();\r\n    if (object.hasColors && !object.__webglColorBuffer) object.__webglColorBuffer = _gl.createBuffer();\r\n\r\n    if (object.hasPositions) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglVertexBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.position);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasNormals) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglNormalBuffer);\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial === false &&\r\n        material.shading === THREE.FlatShading) {\r\n\r\n        var nx, ny, nz,\r\n          nax, nbx, ncx, nay, nby, ncy, naz, nbz, ncz,\r\n          normalArray,\r\n          i, il = object.count * 3;\r\n\r\n        for (i = 0; i < il; i += 9) {\r\n\r\n          normalArray = object.normalArray;\r\n\r\n          nax = normalArray[i];\r\n          nay = normalArray[i + 1];\r\n          naz = normalArray[i + 2];\r\n\r\n          nbx = normalArray[i + 3];\r\n          nby = normalArray[i + 4];\r\n          nbz = normalArray[i + 5];\r\n\r\n          ncx = normalArray[i + 6];\r\n          ncy = normalArray[i + 7];\r\n          ncz = normalArray[i + 8];\r\n\r\n          nx = (nax + nbx + ncx) / 3;\r\n          ny = (nay + nby + ncy) / 3;\r\n          nz = (naz + nbz + ncz) / 3;\r\n\r\n          normalArray[i] = nx;\r\n          normalArray[i + 1] = ny;\r\n          normalArray[i + 2] = nz;\r\n\r\n          normalArray[i + 3] = nx;\r\n          normalArray[i + 4] = ny;\r\n          normalArray[i + 5] = nz;\r\n\r\n          normalArray[i + 6] = nx;\r\n          normalArray[i + 7] = ny;\r\n          normalArray[i + 8] = nz;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.normal);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasUvs && material.map) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglUvBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.uv);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.hasColors && material.vertexColors !== THREE.NoColors) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, object.__webglColorBuffer);\r\n      _gl.bufferData(_gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW);\r\n\r\n      state.enableAttribute(program.attributes.color);\r\n\r\n      _gl.vertexAttribPointer(program.attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    _gl.drawArrays(_gl.TRIANGLES, 0, object.count);\r\n\r\n    object.count = 0;\r\n\r\n  };\r\n\r\n  function setupVertexAttributes(material, program, geometry, startIndex) {\r\n\r\n    var geometryAttributes = geometry.attributes;\r\n\r\n    var programAttributes = program.attributes;\r\n    var programAttributesKeys = program.attributesKeys;\r\n\r\n    for (var i = 0, l = programAttributesKeys.length; i < l; i++) {\r\n\r\n      var key = programAttributesKeys[i];\r\n      var programAttribute = programAttributes[key];\r\n\r\n      if (programAttribute >= 0) {\r\n\r\n        var geometryAttribute = geometryAttributes[key];\r\n\r\n        if (geometryAttribute !== undefined) {\r\n\r\n          var size = geometryAttribute.itemSize;\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryAttribute.buffer);\r\n\r\n          state.enableAttribute(programAttribute);\r\n\r\n          _gl.vertexAttribPointer(programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4); // 4 bytes per Float32\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n          if (material.defaultAttributeValues[key].length === 2) {\r\n\r\n            _gl.vertexAttrib2fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n          else if (material.defaultAttributeValues[key].length === 3) {\r\n\r\n            _gl.vertexAttrib3fv(programAttribute, material.defaultAttributeValues[key]);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n  }\r\n\r\n  this.renderBufferDirect = function(camera, lights, fog, material, geometry, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = 'direct_' + geometry.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var mode = material.wireframe === true ? _gl.LINES : _gl.TRIANGLES;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed triangles\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n          _this.info.render.faces += index.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed triangles\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n            _this.info.render.faces += offsets[i].count / 3;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed triangles\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes['position'];\r\n\r\n        // render non-indexed triangles\r\n\r\n        _gl.drawArrays(mode, 0, position.array.length / position.itemSize);\r\n\r\n        _this.info.render.calls++;\r\n        _this.info.render.vertices += position.array.length / position.itemSize;\r\n        _this.info.render.faces += position.array.length / (3 * position.itemSize);\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      // render particles\r\n\r\n      var mode = _gl.POINTS;\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed points\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += index.array.length;\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed points\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed points\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.points += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.points += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      var index = geometry.attributes.index;\r\n\r\n      if (index) {\r\n\r\n        // indexed lines\r\n\r\n        var type, size;\r\n\r\n        if (index.array instanceof Uint32Array) {\r\n\r\n          type = _gl.UNSIGNED_INT;\r\n          size = 4;\r\n\r\n        }\r\n        else {\r\n\r\n          type = _gl.UNSIGNED_SHORT;\r\n          size = 2;\r\n\r\n        }\r\n\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          if (updateBuffers) {\r\n\r\n            setupVertexAttributes(material, program, geometry, 0);\r\n            _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n          }\r\n\r\n          _gl.drawElements(mode, index.array.length, type, 0); // 2 bytes per Uint16Array\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += index.array.length; // not really true, here vertices can be shared\r\n\r\n        }\r\n        else {\r\n\r\n          // if there is more than 1 chunk\r\n          // must set attribute pointers to use new offsets for each chunk\r\n          // even if geometry and materials didn't change\r\n\r\n          if (offsets.length > 1) updateBuffers = true;\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            var startIndex = offsets[i].index;\r\n\r\n            if (updateBuffers) {\r\n\r\n              setupVertexAttributes(material, program, geometry, startIndex);\r\n              _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, index.buffer);\r\n\r\n            }\r\n\r\n            // render indexed lines\r\n\r\n            _gl.drawElements(mode, offsets[i].count, type, offsets[i].start * size); // 2 bytes per Uint16Array\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count; // not really true, here vertices can be shared\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        // non-indexed lines\r\n\r\n        if (updateBuffers) {\r\n\r\n          setupVertexAttributes(material, program, geometry, 0);\r\n\r\n        }\r\n\r\n        var position = geometry.attributes.position;\r\n        var offsets = geometry.offsets;\r\n\r\n        if (offsets.length === 0) {\r\n\r\n          _gl.drawArrays(mode, 0, position.array.length / 3);\r\n\r\n          _this.info.render.calls++;\r\n          _this.info.render.vertices += position.array.length / 3;\r\n\r\n        }\r\n        else {\r\n\r\n          for (var i = 0, il = offsets.length; i < il; i++) {\r\n\r\n            _gl.drawArrays(mode, offsets[i].index, offsets[i].count);\r\n\r\n            _this.info.render.calls++;\r\n            _this.info.render.vertices += offsets[i].count;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.renderBuffer = function(camera, lights, fog, material, geometryGroup, object) {\r\n\r\n    if (material.visible === false) return;\r\n\r\n    updateObject(object);\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    var attributes = program.attributes;\r\n\r\n    var updateBuffers = false,\r\n      wireframeBit = material.wireframe ? 1 : 0,\r\n      geometryProgram = geometryGroup.id + '_' + program.id + '_' + wireframeBit;\r\n\r\n    if (geometryProgram !== _currentGeometryProgram) {\r\n\r\n      _currentGeometryProgram = geometryProgram;\r\n      updateBuffers = true;\r\n\r\n    }\r\n\r\n    if (updateBuffers) {\r\n\r\n      state.initAttributes();\r\n\r\n    }\r\n\r\n    // vertices\r\n\r\n    if (!material.morphTargets && attributes.position >= 0) {\r\n\r\n      if (updateBuffers) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n        state.enableAttribute(attributes.position);\r\n\r\n        _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      if (object.morphTargetBase) {\r\n\r\n        setupMorphTargets(material, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n    if (updateBuffers) {\r\n\r\n      // custom attributes\r\n\r\n      // Use the per-geometryGroup custom attribute arrays which are setup in initMeshBuffers\r\n\r\n      if (geometryGroup.__webglCustomAttributesList) {\r\n\r\n        for (var i = 0, il = geometryGroup.__webglCustomAttributesList.length; i < il; i++) {\r\n\r\n          var attribute = geometryGroup.__webglCustomAttributesList[i];\r\n\r\n          if (attributes[attribute.buffer.belongsToAttribute] >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, attribute.buffer);\r\n\r\n            state.enableAttribute(attributes[attribute.buffer.belongsToAttribute]);\r\n\r\n            _gl.vertexAttribPointer(attributes[attribute.buffer.belongsToAttribute], attribute.size, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // colors\r\n\r\n      if (attributes.color >= 0) {\r\n\r\n        if (object.geometry.colors.length > 0 || object.geometry.faces.length > 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglColorBuffer);\r\n\r\n          state.enableAttribute(attributes.color);\r\n\r\n          _gl.vertexAttribPointer(attributes.color, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib3fv(attributes.color, material.defaultAttributeValues.color);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // normals\r\n\r\n      if (attributes.normal >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglNormalBuffer);\r\n\r\n        state.enableAttribute(attributes.normal);\r\n\r\n        _gl.vertexAttribPointer(attributes.normal, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // tangents\r\n\r\n      if (attributes.tangent >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglTangentBuffer);\r\n\r\n        state.enableAttribute(attributes.tangent);\r\n\r\n        _gl.vertexAttribPointer(attributes.tangent, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // uvs\r\n\r\n      if (attributes.uv >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[0]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUVBuffer);\r\n\r\n          state.enableAttribute(attributes.uv);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv, material.defaultAttributeValues.uv);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (attributes.uv2 >= 0) {\r\n\r\n        if (object.geometry.faceVertexUvs[1]) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglUV2Buffer);\r\n\r\n          state.enableAttribute(attributes.uv2);\r\n\r\n          _gl.vertexAttribPointer(attributes.uv2, 2, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n        else if (material.defaultAttributeValues !== undefined) {\r\n\r\n\r\n          _gl.vertexAttrib2fv(attributes.uv2, material.defaultAttributeValues.uv2);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material.skinning &&\r\n        attributes.skinIndex >= 0 && attributes.skinWeight >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinIndicesBuffer);\r\n\r\n        state.enableAttribute(attributes.skinIndex);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinIndex, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglSkinWeightsBuffer);\r\n\r\n        state.enableAttribute(attributes.skinWeight);\r\n\r\n        _gl.vertexAttribPointer(attributes.skinWeight, 4, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n      // line distances\r\n\r\n      if (attributes.lineDistance >= 0) {\r\n\r\n        _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglLineDistanceBuffer);\r\n\r\n        state.enableAttribute(attributes.lineDistance);\r\n\r\n        _gl.vertexAttribPointer(attributes.lineDistance, 1, _gl.FLOAT, false, 0, 0);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    state.disableUnusedAttributes();\r\n\r\n    // render mesh\r\n\r\n    if (object instanceof THREE.Mesh) {\r\n\r\n      var type = geometryGroup.__typeArray === Uint32Array ? _gl.UNSIGNED_INT : _gl.UNSIGNED_SHORT;\r\n\r\n      // wireframe\r\n\r\n      if (material.wireframe) {\r\n\r\n        state.setLineWidth(material.wireframeLinewidth * pixelRatio);\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglLineBuffer);\r\n        _gl.drawElements(_gl.LINES, geometryGroup.__webglLineCount, type, 0);\r\n\r\n        // triangles\r\n\r\n      }\r\n      else {\r\n\r\n        if (updateBuffers) _gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER, geometryGroup.__webglFaceBuffer);\r\n        _gl.drawElements(_gl.TRIANGLES, geometryGroup.__webglFaceCount, type, 0);\r\n\r\n      }\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.vertices += geometryGroup.__webglFaceCount;\r\n      _this.info.render.faces += geometryGroup.__webglFaceCount / 3;\r\n\r\n      // render lines\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var mode = (object.mode === THREE.LineStrip) ? _gl.LINE_STRIP : _gl.LINES;\r\n\r\n      state.setLineWidth(material.linewidth * pixelRatio);\r\n\r\n      _gl.drawArrays(mode, 0, geometryGroup.__webglLineCount);\r\n\r\n      _this.info.render.calls++;\r\n\r\n      // render particles\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      _gl.drawArrays(_gl.POINTS, 0, geometryGroup.__webglParticleCount);\r\n\r\n      _this.info.render.calls++;\r\n      _this.info.render.points += geometryGroup.__webglParticleCount;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function setupMorphTargets(material, geometryGroup, object) {\r\n\r\n    // set base\r\n\r\n    var attributes = material.program.attributes;\r\n\r\n    if (object.morphTargetBase !== -1 && attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[object.morphTargetBase]);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n    else if (attributes.position >= 0) {\r\n\r\n      _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglVertexBuffer);\r\n\r\n      state.enableAttribute(attributes.position);\r\n\r\n      _gl.vertexAttribPointer(attributes.position, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n    }\r\n\r\n    if (object.morphTargetForcedOrder.length) {\r\n\r\n      // set forced order\r\n\r\n      var m = 0;\r\n      var order = object.morphTargetForcedOrder;\r\n      var influences = object.morphTargetInfluences;\r\n\r\n      var attribute;\r\n\r\n      while (m < material.numSupportedMorphTargets && m < order.length) {\r\n\r\n        attribute = attributes['morphTarget' + m];\r\n\r\n        if (attribute >= 0) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        attribute = attributes['morphNormal' + m];\r\n\r\n        if (attribute >= 0 && material.morphNormals) {\r\n\r\n          _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[order[m]]);\r\n\r\n          state.enableAttribute(attribute);\r\n\r\n          _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n        }\r\n\r\n        object.__webglMorphTargetInfluences[m] = influences[order[m]];\r\n\r\n        m++;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // find the most influencing\r\n\r\n      var activeInfluenceIndices = [];\r\n      var influences = object.morphTargetInfluences;\r\n      var morphTargets = object.geometry.morphTargets;\r\n\r\n      if (influences.length > morphTargets.length) {\r\n\r\n        console.warn('THREE.WebGLRenderer: Influences array is bigger than morphTargets array.');\r\n        influences.length = morphTargets.length;\r\n\r\n      }\r\n\r\n      for (var i = 0, il = influences.length; i < il; i++) {\r\n\r\n        var influence = influences[i];\r\n\r\n        activeInfluenceIndices.push([influence, i]);\r\n\r\n      }\r\n\r\n      if (activeInfluenceIndices.length > material.numSupportedMorphTargets) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n        activeInfluenceIndices.length = material.numSupportedMorphTargets;\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length > material.numSupportedMorphNormals) {\r\n\r\n        activeInfluenceIndices.sort(numericalSort);\r\n\r\n      }\r\n      else if (activeInfluenceIndices.length === 0) {\r\n\r\n        activeInfluenceIndices.push([0, 0]);\r\n\r\n      }\r\n\r\n      var attribute;\r\n\r\n      for (var m = 0, ml = material.numSupportedMorphTargets; m < ml; m++) {\r\n\r\n        if (activeInfluenceIndices[m]) {\r\n\r\n          var influenceIndex = activeInfluenceIndices[m][1];\r\n\r\n          attribute = attributes['morphTarget' + m];\r\n\r\n          if (attribute >= 0) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphTargetsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          attribute = attributes['morphNormal' + m];\r\n\r\n          if (attribute >= 0 && material.morphNormals) {\r\n\r\n            _gl.bindBuffer(_gl.ARRAY_BUFFER, geometryGroup.__webglMorphNormalsBuffers[influenceIndex]);\r\n\r\n            state.enableAttribute(attribute);\r\n\r\n            _gl.vertexAttribPointer(attribute, 3, _gl.FLOAT, false, 0, 0);\r\n\r\n          }\r\n\r\n          object.__webglMorphTargetInfluences[m] = influences[influenceIndex];\r\n\r\n        }\r\n        else {\r\n\r\n          /*\r\n          _gl.vertexAttribPointer( attributes[ \"morphTarget\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          if ( material.morphNormals ) {\r\n\r\n          \t_gl.vertexAttribPointer( attributes[ \"morphNormal\" + m ], 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n          }\r\n          */\r\n\r\n          object.__webglMorphTargetInfluences[m] = 0;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // load updated influences uniform\r\n\r\n    if (material.program.uniforms.morphTargetInfluences !== null) {\r\n\r\n      _gl.uniform1fv(material.program.uniforms.morphTargetInfluences, object.__webglMorphTargetInfluences);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Sorting\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    else if (a.material.id !== b.material.id) {\r\n\r\n      return a.material.id - b.material.id;\r\n\r\n    }\r\n    else if (a.z !== b.z) {\r\n\r\n      return a.z - b.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function reversePainterSortStable(a, b) {\r\n\r\n    if (a.object.renderOrder !== b.object.renderOrder) {\r\n\r\n      return a.object.renderOrder - b.object.renderOrder;\r\n\r\n    }\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return a.id - b.id;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function numericalSort(a, b) {\r\n\r\n    return b[0] - a[0];\r\n\r\n  }\r\n\r\n  // Rendering\r\n\r\n  this.render = function(scene, camera, renderTarget, forceClear) {\r\n\r\n    if (camera instanceof THREE.Camera === false) {\r\n\r\n      THREE.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');\r\n      return;\r\n\r\n    }\r\n\r\n    var fog = scene.fog;\r\n\r\n    // reset caching for this frame\r\n\r\n    _currentGeometryProgram = '';\r\n    _currentMaterialId = -1;\r\n    _currentCamera = null;\r\n    _lightsNeedUpdate = true;\r\n\r\n    // update scene graph\r\n\r\n    if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n    // update camera matrices and frustum\r\n\r\n    if (camera.parent === undefined) camera.updateMatrixWorld();\r\n\r\n    // update Skeleton objects\r\n\r\n    scene.traverse(function(object) {\r\n\r\n      if (object instanceof THREE.SkinnedMesh) {\r\n\r\n        object.skeleton.update();\r\n\r\n      }\r\n\r\n    });\r\n\r\n    camera.matrixWorldInverse.getInverse(camera.matrixWorld);\r\n\r\n    _projScreenMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\r\n    _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n    lights.length = 0;\r\n    opaqueObjects.length = 0;\r\n    transparentObjects.length = 0;\r\n\r\n    sprites.length = 0;\r\n    lensFlares.length = 0;\r\n\r\n    projectObject(scene);\r\n\r\n    if (_this.sortObjects === true) {\r\n\r\n      opaqueObjects.sort(painterSortStable);\r\n      transparentObjects.sort(reversePainterSortStable);\r\n\r\n    }\r\n\r\n    // custom render plugins (pre pass)\r\n\r\n    shadowMapPlugin.render(scene, camera);\r\n\r\n    //\r\n\r\n    _this.info.render.calls = 0;\r\n    _this.info.render.vertices = 0;\r\n    _this.info.render.faces = 0;\r\n    _this.info.render.points = 0;\r\n\r\n    this.setRenderTarget(renderTarget);\r\n\r\n    if (this.autoClear || forceClear) {\r\n\r\n      this.clear(this.autoClearColor, this.autoClearDepth, this.autoClearStencil);\r\n\r\n    }\r\n\r\n    // set matrices for immediate objects\r\n\r\n    for (var i = 0, il = _webglObjectsImmediate.length; i < il; i++) {\r\n\r\n      var webglObject = _webglObjectsImmediate[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        setupMatrices(object, camera);\r\n\r\n        unrollImmediateBufferMaterial(webglObject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (scene.overrideMaterial) {\r\n\r\n      var overrideMaterial = scene.overrideMaterial;\r\n\r\n      setMaterial(overrideMaterial);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjects(transparentObjects, camera, lights, fog, overrideMaterial);\r\n      renderObjectsImmediate(_webglObjectsImmediate, '', camera, lights, fog, overrideMaterial);\r\n\r\n    }\r\n    else {\r\n\r\n      // opaque pass (front-to-back order)\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n      renderObjects(opaqueObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'opaque', camera, lights, fog, null);\r\n\r\n      // transparent pass (back-to-front order)\r\n\r\n      renderObjects(transparentObjects, camera, lights, fog, null);\r\n      renderObjectsImmediate(_webglObjectsImmediate, 'transparent', camera, lights, fog, null);\r\n\r\n    }\r\n\r\n    // custom render plugins (post pass)\r\n\r\n    spritePlugin.render(scene, camera);\r\n    lensFlarePlugin.render(scene, camera, _currentWidth, _currentHeight);\r\n\r\n    // Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n    if (renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter) {\r\n\r\n      updateRenderTargetMipmap(renderTarget);\r\n\r\n    }\r\n\r\n    // Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n    state.setDepthTest(true);\r\n    state.setDepthWrite(true);\r\n    state.setColorWrite(true);\r\n\r\n    // _gl.finish();\r\n\r\n  };\r\n\r\n  function projectObject(object) {\r\n\r\n    if (object.visible === false) return;\r\n\r\n    if (object instanceof THREE.Scene || object instanceof THREE.Group) {\r\n\r\n      // skip\r\n\r\n    }\r\n    else {\r\n\r\n      initObject(object);\r\n\r\n      if (object instanceof THREE.Light) {\r\n\r\n        lights.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.Sprite) {\r\n\r\n        sprites.push(object);\r\n\r\n      }\r\n      else if (object instanceof THREE.LensFlare) {\r\n\r\n        lensFlares.push(object);\r\n\r\n      }\r\n      else {\r\n\r\n        var webglObjects = _webglObjects[object.id];\r\n\r\n        if (webglObjects && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n          for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n            var webglObject = webglObjects[i];\r\n\r\n            unrollBufferMaterial(webglObject);\r\n\r\n            webglObject.render = true;\r\n\r\n            if (_this.sortObjects === true) {\r\n\r\n              _vector3.setFromMatrixPosition(object.matrixWorld);\r\n              _vector3.applyProjection(_projScreenMatrix);\r\n\r\n              webglObject.z = _vector3.z;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n      projectObject(object.children[i]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjects(renderList, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n\r\n      var object = webglObject.object;\r\n      var buffer = webglObject.buffer;\r\n\r\n      setupMatrices(object, camera);\r\n\r\n      if (overrideMaterial) {\r\n\r\n        material = overrideMaterial;\r\n\r\n      }\r\n      else {\r\n\r\n        material = webglObject.material;\r\n\r\n        if (!material) continue;\r\n\r\n        setMaterial(material);\r\n\r\n      }\r\n\r\n      _this.setMaterialFaces(material);\r\n\r\n      if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n        _this.renderBufferDirect(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n      else {\r\n\r\n        _this.renderBuffer(camera, lights, fog, material, buffer, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function renderObjectsImmediate(renderList, materialType, camera, lights, fog, overrideMaterial) {\r\n\r\n    var material;\r\n\r\n    for (var i = 0, l = renderList.length; i < l; i++) {\r\n\r\n      var webglObject = renderList[i];\r\n      var object = webglObject.object;\r\n\r\n      if (object.visible) {\r\n\r\n        if (overrideMaterial) {\r\n\r\n          material = overrideMaterial;\r\n\r\n        }\r\n        else {\r\n\r\n          material = webglObject[materialType];\r\n\r\n          if (!material) continue;\r\n\r\n          setMaterial(material);\r\n\r\n        }\r\n\r\n        _this.renderImmediateObject(camera, lights, fog, material, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.renderImmediateObject = function(camera, lights, fog, material, object) {\r\n\r\n    var program = setProgram(camera, lights, fog, material, object);\r\n\r\n    _currentGeometryProgram = '';\r\n\r\n    _this.setMaterialFaces(material);\r\n\r\n    if (object.immediateRenderCallback) {\r\n\r\n      object.immediateRenderCallback(program, _gl, _frustum);\r\n\r\n    }\r\n    else {\r\n\r\n      object.render(function(object) {\r\n        _this.renderBufferImmediate(object, program, material);\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function unrollImmediateBufferMaterial(globject) {\r\n\r\n    var object = globject.object,\r\n      material = object.material;\r\n\r\n    if (material.transparent) {\r\n\r\n      globject.transparent = material;\r\n      globject.opaque = null;\r\n\r\n    }\r\n    else {\r\n\r\n      globject.opaque = material;\r\n      globject.transparent = null;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function unrollBufferMaterial(globject) {\r\n\r\n    var object = globject.object;\r\n    var buffer = globject.buffer;\r\n\r\n    var geometry = object.geometry;\r\n    var material = object.material;\r\n\r\n    if (material instanceof THREE.MeshFaceMaterial) {\r\n\r\n      var materialIndex = geometry instanceof THREE.BufferGeometry ? 0 : buffer.materialIndex;\r\n\r\n      material = material.materials[materialIndex];\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n    else if (material) {\r\n\r\n      globject.material = material;\r\n\r\n      if (material.transparent) {\r\n\r\n        transparentObjects.push(globject);\r\n\r\n      }\r\n      else {\r\n\r\n        opaqueObjects.push(globject);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function initObject(object) {\r\n\r\n    if (object.__webglInit === undefined) {\r\n\r\n      object.__webglInit = true;\r\n      object._modelViewMatrix = new THREE.Matrix4();\r\n      object._normalMatrix = new THREE.Matrix3();\r\n\r\n      object.addEventListener('removed', onObjectRemoved);\r\n\r\n    }\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry === undefined) {\r\n\r\n      // ImmediateRenderObject\r\n\r\n    }\r\n    else if (geometry.__webglInit === undefined) {\r\n\r\n      geometry.__webglInit = true;\r\n      geometry.addEventListener('dispose', onGeometryDispose);\r\n\r\n      if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n        _this.info.memory.geometries++;\r\n\r\n      }\r\n      else if (object instanceof THREE.Mesh) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n      else if (object instanceof THREE.Line) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createLineBuffers(geometry);\r\n          initLineBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n          geometry.lineDistancesNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.PointCloud) {\r\n\r\n        if (geometry.__webglVertexBuffer === undefined) {\r\n\r\n          createParticleBuffers(geometry);\r\n          initParticleBuffers(geometry, object);\r\n\r\n          geometry.verticesNeedUpdate = true;\r\n          geometry.colorsNeedUpdate = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (object.__webglActive === undefined) {\r\n\r\n      object.__webglActive = true;\r\n\r\n      if (object instanceof THREE.Mesh) {\r\n\r\n        if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n          addBuffer(_webglObjects, geometry, object);\r\n\r\n        }\r\n        else if (geometry instanceof THREE.Geometry) {\r\n\r\n          var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n          for (var i = 0, l = geometryGroupsList.length; i < l; i++) {\r\n\r\n            addBuffer(_webglObjects, geometryGroupsList[i], object);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n      else if (object instanceof THREE.Line || object instanceof THREE.PointCloud) {\r\n\r\n        addBuffer(_webglObjects, geometry, object);\r\n\r\n      }\r\n      else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n        addBufferImmediate(_webglObjectsImmediate, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Geometry splitting\r\n\r\n  var geometryGroups = {};\r\n  var geometryGroupCounter = 0;\r\n\r\n  function makeGroups(geometry, usesFaceMaterial) {\r\n\r\n    var maxVerticesInGroup = extensions.get('OES_element_index_uint') ? 4294967296 : 65535;\r\n\r\n    var groupHash, hash_map = {};\r\n\r\n    var numMorphTargets = geometry.morphTargets.length;\r\n    var numMorphNormals = geometry.morphNormals.length;\r\n\r\n    var group;\r\n    var groups = {};\r\n    var groupsList = [];\r\n\r\n    for (var f = 0, fl = geometry.faces.length; f < fl; f++) {\r\n\r\n      var face = geometry.faces[f];\r\n      var materialIndex = usesFaceMaterial ? face.materialIndex : 0;\r\n\r\n      if (!(materialIndex in hash_map)) {\r\n\r\n        hash_map[materialIndex] = {\r\n          hash: materialIndex,\r\n          counter: 0\r\n        };\r\n\r\n      }\r\n\r\n      groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n      if (!(groupHash in groups)) {\r\n\r\n        group = {\r\n          id: geometryGroupCounter++,\r\n          faces3: [],\r\n          materialIndex: materialIndex,\r\n          vertices: 0,\r\n          numMorphTargets: numMorphTargets,\r\n          numMorphNormals: numMorphNormals\r\n        };\r\n\r\n        groups[groupHash] = group;\r\n        groupsList.push(group);\r\n\r\n      }\r\n\r\n      if (groups[groupHash].vertices + 3 > maxVerticesInGroup) {\r\n\r\n        hash_map[materialIndex].counter += 1;\r\n        groupHash = hash_map[materialIndex].hash + '_' + hash_map[materialIndex].counter;\r\n\r\n        if (!(groupHash in groups)) {\r\n\r\n          group = {\r\n            id: geometryGroupCounter++,\r\n            faces3: [],\r\n            materialIndex: materialIndex,\r\n            vertices: 0,\r\n            numMorphTargets: numMorphTargets,\r\n            numMorphNormals: numMorphNormals\r\n          };\r\n\r\n          groups[groupHash] = group;\r\n          groupsList.push(group);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      groups[groupHash].faces3.push(f);\r\n      groups[groupHash].vertices += 3;\r\n\r\n    }\r\n\r\n    return groupsList;\r\n\r\n  }\r\n\r\n  function initGeometryGroups(object, geometry) {\r\n\r\n    var material = object.material,\r\n      addBuffers = false;\r\n\r\n    if (geometryGroups[geometry.id] === undefined || geometry.groupsNeedUpdate === true) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n      geometryGroups[geometry.id] = makeGroups(geometry, material instanceof THREE.MeshFaceMaterial);\r\n\r\n      geometry.groupsNeedUpdate = false;\r\n\r\n    }\r\n\r\n    var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n    // create separate VBOs per geometry chunk\r\n\r\n    for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n      var geometryGroup = geometryGroupsList[i];\r\n\r\n      // initialise VBO on the first access\r\n\r\n      if (geometryGroup.__webglVertexBuffer === undefined) {\r\n\r\n        createMeshBuffers(geometryGroup);\r\n        initMeshBuffers(geometryGroup, object);\r\n\r\n        geometry.verticesNeedUpdate = true;\r\n        geometry.morphTargetsNeedUpdate = true;\r\n        geometry.elementsNeedUpdate = true;\r\n        geometry.uvsNeedUpdate = true;\r\n        geometry.normalsNeedUpdate = true;\r\n        geometry.tangentsNeedUpdate = true;\r\n        geometry.colorsNeedUpdate = true;\r\n\r\n        addBuffers = true;\r\n\r\n      }\r\n      else {\r\n\r\n        addBuffers = false;\r\n\r\n      }\r\n\r\n      if (addBuffers || object.__webglActive === undefined) {\r\n\r\n        addBuffer(_webglObjects, geometryGroup, object);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    object.__webglActive = true;\r\n\r\n  }\r\n\r\n  function addBuffer(objlist, buffer, object) {\r\n\r\n    var id = object.id;\r\n    objlist[id] = objlist[id] || [];\r\n    objlist[id].push({\r\n      id: id,\r\n      buffer: buffer,\r\n      object: object,\r\n      material: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  function addBufferImmediate(objlist, object) {\r\n\r\n    objlist.push({\r\n      id: null,\r\n      object: object,\r\n      opaque: null,\r\n      transparent: null,\r\n      z: 0\r\n    });\r\n\r\n  };\r\n\r\n  // Objects updates\r\n\r\n  function updateObject(object) {\r\n\r\n    var geometry = object.geometry;\r\n\r\n    if (geometry instanceof THREE.BufferGeometry) {\r\n\r\n      var attributes = geometry.attributes;\r\n      var attributesKeys = geometry.attributesKeys;\r\n\r\n      for (var i = 0, l = attributesKeys.length; i < l; i++) {\r\n\r\n        var key = attributesKeys[i];\r\n        var attribute = attributes[key];\r\n        var bufferType = (key === 'index') ? _gl.ELEMENT_ARRAY_BUFFER : _gl.ARRAY_BUFFER;\r\n\r\n        if (attribute.buffer === undefined) {\r\n\r\n          attribute.buffer = _gl.createBuffer();\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n          _gl.bufferData(bufferType, attribute.array, (attribute instanceof THREE.DynamicBufferAttribute) ? _gl.DYNAMIC_DRAW : _gl.STATIC_DRAW);\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n        else if (attribute.needsUpdate === true) {\r\n\r\n          _gl.bindBuffer(bufferType, attribute.buffer);\r\n\r\n          if (attribute.updateRange === undefined || attribute.updateRange.count === -1) { // Not using update ranges\r\n\r\n            _gl.bufferSubData(bufferType, 0, attribute.array);\r\n\r\n          }\r\n          else if (attribute.updateRange.count === 0) {\r\n\r\n            console.error('THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually.');\r\n\r\n          }\r\n          else {\r\n\r\n            _gl.bufferSubData(bufferType, attribute.updateRange.offset * attribute.array.BYTES_PER_ELEMENT,\r\n              attribute.array.subarray(attribute.updateRange.offset, attribute.updateRange.offset + attribute.updateRange.count));\r\n\r\n            attribute.updateRange.count = 0; // reset range\r\n\r\n          }\r\n\r\n          attribute.needsUpdate = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else if (object instanceof THREE.Mesh) {\r\n\r\n      // check all geometry groups\r\n\r\n      if (geometry.groupsNeedUpdate === true) {\r\n\r\n        initGeometryGroups(object, geometry);\r\n\r\n      }\r\n\r\n      var geometryGroupsList = geometryGroups[geometry.id];\r\n\r\n      for (var i = 0, il = geometryGroupsList.length; i < il; i++) {\r\n\r\n        var geometryGroup = geometryGroupsList[i];\r\n        var material = getBufferMaterial(object, geometryGroup);\r\n\r\n        var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n        if (geometry.verticesNeedUpdate || geometry.morphTargetsNeedUpdate || geometry.elementsNeedUpdate ||\r\n          geometry.uvsNeedUpdate || geometry.normalsNeedUpdate ||\r\n          geometry.colorsNeedUpdate || geometry.tangentsNeedUpdate || customAttributesDirty) {\r\n\r\n          setMeshBuffers(geometryGroup, object, _gl.DYNAMIC_DRAW, !geometry.dynamic, material);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.morphTargetsNeedUpdate = false;\r\n      geometry.elementsNeedUpdate = false;\r\n      geometry.uvsNeedUpdate = false;\r\n      geometry.normalsNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.tangentsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.Line) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || geometry.lineDistancesNeedUpdate || customAttributesDirty) {\r\n\r\n        setLineBuffers(geometry, _gl.DYNAMIC_DRAW);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n      geometry.lineDistancesNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n    else if (object instanceof THREE.PointCloud) {\r\n\r\n      var material = getBufferMaterial(object, geometry);\r\n      var customAttributesDirty = material.attributes && areCustomAttributesDirty(material);\r\n\r\n      if (geometry.verticesNeedUpdate || geometry.colorsNeedUpdate || customAttributesDirty) {\r\n\r\n        setParticleBuffers(geometry, _gl.DYNAMIC_DRAW, object);\r\n\r\n      }\r\n\r\n      geometry.verticesNeedUpdate = false;\r\n      geometry.colorsNeedUpdate = false;\r\n\r\n      material.attributes && clearCustomAttributes(material);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects updates - custom attributes check\r\n\r\n  function areCustomAttributesDirty(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      if (material.attributes[name].needsUpdate) return true;\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  function clearCustomAttributes(material) {\r\n\r\n    for (var name in material.attributes) {\r\n\r\n      material.attributes[name].needsUpdate = false;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Objects removal\r\n\r\n  function removeObject(object) {\r\n\r\n    if (object instanceof THREE.Mesh ||\r\n      object instanceof THREE.PointCloud ||\r\n      object instanceof THREE.Line) {\r\n\r\n      delete _webglObjects[object.id];\r\n\r\n    }\r\n    else if (object instanceof THREE.ImmediateRenderObject || object.immediateRenderCallback) {\r\n\r\n      removeInstances(_webglObjectsImmediate, object);\r\n\r\n    }\r\n\r\n    delete object.__webglInit;\r\n    delete object._modelViewMatrix;\r\n    delete object._normalMatrix;\r\n\r\n    delete object.__webglActive;\r\n\r\n  }\r\n\r\n  function removeInstances(objlist, object) {\r\n\r\n    for (var o = objlist.length - 1; o >= 0; o--) {\r\n\r\n      if (objlist[o].object === object) {\r\n\r\n        objlist.splice(o, 1);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Materials\r\n\r\n  var shaderIDs = {\r\n    MeshDepthMaterial: 'depth',\r\n    MeshNormalMaterial: 'normal',\r\n    MeshBasicMaterial: 'basic',\r\n    MeshLambertMaterial: 'lambert',\r\n    MeshPhongMaterial: 'phong',\r\n    LineBasicMaterial: 'basic',\r\n    LineDashedMaterial: 'dashed',\r\n    PointCloudMaterial: 'particle_basic'\r\n  };\r\n\r\n  function initMaterial(material, lights, fog, object) {\r\n\r\n    material.addEventListener('dispose', onMaterialDispose);\r\n\r\n    var shaderID = shaderIDs[material.type];\r\n\r\n    if (shaderID) {\r\n\r\n      var shader = THREE.ShaderLib[shaderID];\r\n\r\n      material.__webglShader = {\r\n        uniforms: THREE.UniformsUtils.clone(shader.uniforms),\r\n        vertexShader: shader.vertexShader,\r\n        fragmentShader: shader.fragmentShader\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      material.__webglShader = {\r\n        uniforms: material.uniforms,\r\n        vertexShader: material.vertexShader,\r\n        fragmentShader: material.fragmentShader\r\n      }\r\n\r\n    }\r\n\r\n    // heuristics to create shader parameters according to lights in the scene\r\n    // (not to blow over maxLights budget)\r\n\r\n    var maxLightCount = allocateLights(lights);\r\n    var maxShadows = allocateShadows(lights);\r\n    var maxBones = allocateBones(object);\r\n\r\n    var parameters = {\r\n\r\n      precision: _precision,\r\n      supportsVertexTextures: _supportsVertexTextures,\r\n\r\n      map: !!material.map,\r\n      envMap: !!material.envMap,\r\n      envMapMode: material.envMap && material.envMap.mapping,\r\n      lightMap: !!material.lightMap,\r\n      bumpMap: !!material.bumpMap,\r\n      normalMap: !!material.normalMap,\r\n      specularMap: !!material.specularMap,\r\n      alphaMap: !!material.alphaMap,\r\n\r\n      combine: material.combine,\r\n\r\n      vertexColors: material.vertexColors,\r\n\r\n      fog: fog,\r\n      useFog: material.fog,\r\n      fogExp: fog instanceof THREE.FogExp2,\r\n\r\n      flatShading: material.shading === THREE.FlatShading,\r\n\r\n      sizeAttenuation: material.sizeAttenuation,\r\n      logarithmicDepthBuffer: _logarithmicDepthBuffer,\r\n\r\n      skinning: material.skinning,\r\n      maxBones: maxBones,\r\n      useVertexTexture: _supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n      morphTargets: material.morphTargets,\r\n      morphNormals: material.morphNormals,\r\n      maxMorphTargets: _this.maxMorphTargets,\r\n      maxMorphNormals: _this.maxMorphNormals,\r\n\r\n      maxDirLights: maxLightCount.directional,\r\n      maxPointLights: maxLightCount.point,\r\n      maxSpotLights: maxLightCount.spot,\r\n      maxHemiLights: maxLightCount.hemi,\r\n\r\n      maxShadows: maxShadows,\r\n      shadowMapEnabled: _this.shadowMapEnabled && object.receiveShadow && maxShadows > 0,\r\n      shadowMapType: _this.shadowMapType,\r\n      shadowMapDebug: _this.shadowMapDebug,\r\n      shadowMapCascade: _this.shadowMapCascade,\r\n\r\n      alphaTest: material.alphaTest,\r\n      metal: material.metal,\r\n      wrapAround: material.wrapAround,\r\n      doubleSided: material.side === THREE.DoubleSide,\r\n      flipSided: material.side === THREE.BackSide\r\n\r\n    };\r\n\r\n    // Generate code\r\n\r\n    var chunks = [];\r\n\r\n    if (shaderID) {\r\n\r\n      chunks.push(shaderID);\r\n\r\n    }\r\n    else {\r\n\r\n      chunks.push(material.fragmentShader);\r\n      chunks.push(material.vertexShader);\r\n\r\n    }\r\n\r\n    if (material.defines !== undefined) {\r\n\r\n      for (var name in material.defines) {\r\n\r\n        chunks.push(name);\r\n        chunks.push(material.defines[name]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var name in parameters) {\r\n\r\n      chunks.push(name);\r\n      chunks.push(parameters[name]);\r\n\r\n    }\r\n\r\n    var code = chunks.join();\r\n\r\n    var program;\r\n\r\n    // Check if code has been already compiled\r\n\r\n    for (var p = 0, pl = _programs.length; p < pl; p++) {\r\n\r\n      var programInfo = _programs[p];\r\n\r\n      if (programInfo.code === code) {\r\n\r\n        program = programInfo;\r\n        program.usedTimes++;\r\n\r\n        break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (program === undefined) {\r\n\r\n      program = new THREE.WebGLProgram(_this, code, material, parameters);\r\n      _programs.push(program);\r\n\r\n      _this.info.memory.programs = _programs.length;\r\n\r\n    }\r\n\r\n    material.program = program;\r\n\r\n    var attributes = program.attributes;\r\n\r\n    if (material.morphTargets) {\r\n\r\n      material.numSupportedMorphTargets = 0;\r\n\r\n      var id, base = 'morphTarget';\r\n\r\n      for (var i = 0; i < _this.maxMorphTargets; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphTargets++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (material.morphNormals) {\r\n\r\n      material.numSupportedMorphNormals = 0;\r\n\r\n      var id, base = 'morphNormal';\r\n\r\n      for (i = 0; i < _this.maxMorphNormals; i++) {\r\n\r\n        id = base + i;\r\n\r\n        if (attributes[id] >= 0) {\r\n\r\n          material.numSupportedMorphNormals++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    material.uniformsList = [];\r\n\r\n    for (var u in material.__webglShader.uniforms) {\r\n\r\n      var location = material.program.uniforms[u];\r\n\r\n      if (location) {\r\n        material.uniformsList.push([material.__webglShader.uniforms[u], location]);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setMaterial(material) {\r\n\r\n    if (material.transparent === true) {\r\n\r\n      state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha);\r\n\r\n    }\r\n    else {\r\n\r\n      state.setBlending(THREE.NoBlending);\r\n\r\n    }\r\n\r\n    state.setDepthTest(material.depthTest);\r\n    state.setDepthWrite(material.depthWrite);\r\n    state.setColorWrite(material.colorWrite);\r\n    state.setPolygonOffset(material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits);\r\n\r\n  }\r\n\r\n  function setProgram(camera, lights, fog, material, object) {\r\n\r\n    _usedTextureUnits = 0;\r\n\r\n    if (material.needsUpdate) {\r\n\r\n      if (material.program) deallocateMaterial(material);\r\n\r\n      initMaterial(material, lights, fog, object);\r\n      material.needsUpdate = false;\r\n\r\n    }\r\n\r\n    if (material.morphTargets) {\r\n\r\n      if (!object.__webglMorphTargetInfluences) {\r\n\r\n        object.__webglMorphTargetInfluences = new Float32Array(_this.maxMorphTargets);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var refreshProgram = false;\r\n    var refreshMaterial = false;\r\n    var refreshLights = false;\r\n\r\n    var program = material.program,\r\n      p_uniforms = program.uniforms,\r\n      m_uniforms = material.__webglShader.uniforms;\r\n\r\n    if (program.id !== _currentProgram) {\r\n\r\n      _gl.useProgram(program.program);\r\n      _currentProgram = program.id;\r\n\r\n      refreshProgram = true;\r\n      refreshMaterial = true;\r\n      refreshLights = true;\r\n\r\n    }\r\n\r\n    if (material.id !== _currentMaterialId) {\r\n\r\n      if (_currentMaterialId === -1) refreshLights = true;\r\n      _currentMaterialId = material.id;\r\n\r\n      refreshMaterial = true;\r\n\r\n    }\r\n\r\n    if (refreshProgram || camera !== _currentCamera) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n      if (_logarithmicDepthBuffer) {\r\n\r\n        _gl.uniform1f(p_uniforms.logDepthBufFC, 2.0 / (Math.log(camera.far + 1.0) / Math.LN2));\r\n\r\n      }\r\n\r\n\r\n      if (camera !== _currentCamera) _currentCamera = camera;\r\n\r\n      // load material specific uniforms\r\n      // (shader material also gets them for the sake of genericity)\r\n\r\n      if (material instanceof THREE.ShaderMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial ||\r\n        material.envMap) {\r\n\r\n        if (p_uniforms.cameraPosition !== null) {\r\n\r\n          _vector3.setFromMatrixPosition(camera.matrixWorld);\r\n          _gl.uniform3f(p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.ShaderMaterial ||\r\n        material.skinning) {\r\n\r\n        if (p_uniforms.viewMatrix !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // skinning uniforms must be set even if material didn't change\r\n    // auto-setting of texture unit for bone texture must go before other textures\r\n    // not sure why, but otherwise weird things happen\r\n\r\n    if (material.skinning) {\r\n\r\n      if (object.bindMatrix && p_uniforms.bindMatrix !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrix, false, object.bindMatrix.elements);\r\n\r\n      }\r\n\r\n      if (object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== null) {\r\n\r\n        _gl.uniformMatrix4fv(p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements);\r\n\r\n      }\r\n\r\n      if (_supportsBoneTextures && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n        if (p_uniforms.boneTexture !== null) {\r\n\r\n          var textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(p_uniforms.boneTexture, textureUnit);\r\n          _this.setTexture(object.skeleton.boneTexture, textureUnit);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureWidth !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth);\r\n\r\n        }\r\n\r\n        if (p_uniforms.boneTextureHeight !== null) {\r\n\r\n          _gl.uniform1i(p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight);\r\n\r\n        }\r\n\r\n      }\r\n      else if (object.skeleton && object.skeleton.boneMatrices) {\r\n\r\n        if (p_uniforms.boneGlobalMatrices !== null) {\r\n\r\n          _gl.uniformMatrix4fv(p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (refreshMaterial) {\r\n\r\n      // refresh uniforms common to several materials\r\n\r\n      if (fog && material.fog) {\r\n\r\n        refreshUniformsFog(m_uniforms, fog);\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshPhongMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material.lights) {\r\n\r\n        if (_lightsNeedUpdate) {\r\n\r\n          refreshLights = true;\r\n          setupLights(lights);\r\n          _lightsNeedUpdate = false;\r\n        }\r\n\r\n        if (refreshLights) {\r\n          refreshUniformsLights(m_uniforms, _lights);\r\n          markUniformsLightsNeedsUpdate(m_uniforms, true);\r\n        }\r\n        else {\r\n          markUniformsLightsNeedsUpdate(m_uniforms, false);\r\n        }\r\n\r\n      }\r\n\r\n      if (material instanceof THREE.MeshBasicMaterial ||\r\n        material instanceof THREE.MeshLambertMaterial ||\r\n        material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsCommon(m_uniforms, material);\r\n\r\n      }\r\n\r\n      // refresh single material specific uniforms\r\n\r\n      if (material instanceof THREE.LineBasicMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.LineDashedMaterial) {\r\n\r\n        refreshUniformsLine(m_uniforms, material);\r\n        refreshUniformsDash(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.PointCloudMaterial) {\r\n\r\n        refreshUniformsParticle(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshPhongMaterial) {\r\n\r\n        refreshUniformsPhong(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshLambertMaterial) {\r\n\r\n        refreshUniformsLambert(m_uniforms, material);\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshDepthMaterial) {\r\n\r\n        m_uniforms.mNear.value = camera.near;\r\n        m_uniforms.mFar.value = camera.far;\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n      else if (material instanceof THREE.MeshNormalMaterial) {\r\n\r\n        m_uniforms.opacity.value = material.opacity;\r\n\r\n      }\r\n\r\n      if (object.receiveShadow && !material._shadowPass) {\r\n\r\n        refreshUniformsShadow(m_uniforms, lights);\r\n\r\n      }\r\n\r\n      // load common uniforms\r\n\r\n      loadUniformsGeneric(material.uniformsList);\r\n\r\n    }\r\n\r\n    loadUniformsMatrices(p_uniforms, object);\r\n\r\n    if (p_uniforms.modelMatrix !== null) {\r\n\r\n      _gl.uniformMatrix4fv(p_uniforms.modelMatrix, false, object.matrixWorld.elements);\r\n\r\n    }\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n  // Uniforms (refresh uniforms objects)\r\n\r\n  function refreshUniformsCommon(uniforms, material) {\r\n\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n    uniforms.diffuse.value = material.color;\r\n\r\n    uniforms.map.value = material.map;\r\n    uniforms.lightMap.value = material.lightMap;\r\n    uniforms.specularMap.value = material.specularMap;\r\n    uniforms.alphaMap.value = material.alphaMap;\r\n\r\n    if (material.bumpMap) {\r\n\r\n      uniforms.bumpMap.value = material.bumpMap;\r\n      uniforms.bumpScale.value = material.bumpScale;\r\n\r\n    }\r\n\r\n    if (material.normalMap) {\r\n\r\n      uniforms.normalMap.value = material.normalMap;\r\n      uniforms.normalScale.value.copy(material.normalScale);\r\n\r\n    }\r\n\r\n    // uv repeat and offset setting priorities\r\n    //  1. color map\r\n    //  2. specular map\r\n    //  3. normal map\r\n    //  4. bump map\r\n    //  5. alpha map\r\n\r\n    var uvScaleMap;\r\n\r\n    if (material.map) {\r\n\r\n      uvScaleMap = material.map;\r\n\r\n    }\r\n    else if (material.specularMap) {\r\n\r\n      uvScaleMap = material.specularMap;\r\n\r\n    }\r\n    else if (material.normalMap) {\r\n\r\n      uvScaleMap = material.normalMap;\r\n\r\n    }\r\n    else if (material.bumpMap) {\r\n\r\n      uvScaleMap = material.bumpMap;\r\n\r\n    }\r\n    else if (material.alphaMap) {\r\n\r\n      uvScaleMap = material.alphaMap;\r\n\r\n    }\r\n\r\n    if (uvScaleMap !== undefined) {\r\n\r\n      var offset = uvScaleMap.offset;\r\n      var repeat = uvScaleMap.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n    uniforms.envMap.value = material.envMap;\r\n    uniforms.flipEnvMap.value = (material.envMap instanceof THREE.WebGLRenderTargetCube) ? 1 : -1;\r\n\r\n    uniforms.reflectivity.value = material.reflectivity;\r\n    uniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n  }\r\n\r\n  function refreshUniformsLine(uniforms, material) {\r\n\r\n    uniforms.diffuse.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n\r\n  }\r\n\r\n  function refreshUniformsDash(uniforms, material) {\r\n\r\n    uniforms.dashSize.value = material.dashSize;\r\n    uniforms.totalSize.value = material.dashSize + material.gapSize;\r\n    uniforms.scale.value = material.scale;\r\n\r\n  }\r\n\r\n  function refreshUniformsParticle(uniforms, material) {\r\n\r\n    uniforms.psColor.value = material.color;\r\n    uniforms.opacity.value = material.opacity;\r\n    uniforms.size.value = material.size;\r\n    uniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\r\n\r\n    uniforms.map.value = material.map;\r\n\r\n    if (material.map !== null) {\r\n\r\n      var offset = material.map.offset;\r\n      var repeat = material.map.repeat;\r\n\r\n      uniforms.offsetRepeat.value.set(offset.x, offset.y, repeat.x, repeat.y);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsFog(uniforms, fog) {\r\n\r\n    uniforms.fogColor.value = fog.color;\r\n\r\n    if (fog instanceof THREE.Fog) {\r\n\r\n      uniforms.fogNear.value = fog.near;\r\n      uniforms.fogFar.value = fog.far;\r\n\r\n    }\r\n    else if (fog instanceof THREE.FogExp2) {\r\n\r\n      uniforms.fogDensity.value = fog.density;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsPhong(uniforms, material) {\r\n\r\n    uniforms.shininess.value = material.shininess;\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n    uniforms.specular.value = material.specular;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLambert(uniforms, material) {\r\n\r\n    uniforms.emissive.value = material.emissive;\r\n\r\n    if (material.wrapAround) {\r\n\r\n      uniforms.wrapRGB.value.copy(material.wrapRGB);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function refreshUniformsLights(uniforms, lights) {\r\n\r\n    uniforms.ambientLightColor.value = lights.ambient;\r\n\r\n    uniforms.directionalLightColor.value = lights.directional.colors;\r\n    uniforms.directionalLightDirection.value = lights.directional.positions;\r\n\r\n    uniforms.pointLightColor.value = lights.point.colors;\r\n    uniforms.pointLightPosition.value = lights.point.positions;\r\n    uniforms.pointLightDistance.value = lights.point.distances;\r\n    uniforms.pointLightDecay.value = lights.point.decays;\r\n\r\n    uniforms.spotLightColor.value = lights.spot.colors;\r\n    uniforms.spotLightPosition.value = lights.spot.positions;\r\n    uniforms.spotLightDistance.value = lights.spot.distances;\r\n    uniforms.spotLightDirection.value = lights.spot.directions;\r\n    uniforms.spotLightAngleCos.value = lights.spot.anglesCos;\r\n    uniforms.spotLightExponent.value = lights.spot.exponents;\r\n    uniforms.spotLightDecay.value = lights.spot.decays;\r\n\r\n    uniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\r\n    uniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\r\n    uniforms.hemisphereLightDirection.value = lights.hemi.positions;\r\n\r\n  }\r\n\r\n  // If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n  function markUniformsLightsNeedsUpdate(uniforms, value) {\r\n\r\n    uniforms.ambientLightColor.needsUpdate = value;\r\n\r\n    uniforms.directionalLightColor.needsUpdate = value;\r\n    uniforms.directionalLightDirection.needsUpdate = value;\r\n\r\n    uniforms.pointLightColor.needsUpdate = value;\r\n    uniforms.pointLightPosition.needsUpdate = value;\r\n    uniforms.pointLightDistance.needsUpdate = value;\r\n    uniforms.pointLightDecay.needsUpdate = value;\r\n\r\n    uniforms.spotLightColor.needsUpdate = value;\r\n    uniforms.spotLightPosition.needsUpdate = value;\r\n    uniforms.spotLightDistance.needsUpdate = value;\r\n    uniforms.spotLightDirection.needsUpdate = value;\r\n    uniforms.spotLightAngleCos.needsUpdate = value;\r\n    uniforms.spotLightExponent.needsUpdate = value;\r\n    uniforms.spotLightDecay.needsUpdate = value;\r\n\r\n    uniforms.hemisphereLightSkyColor.needsUpdate = value;\r\n    uniforms.hemisphereLightGroundColor.needsUpdate = value;\r\n    uniforms.hemisphereLightDirection.needsUpdate = value;\r\n\r\n  }\r\n\r\n  function refreshUniformsShadow(uniforms, lights) {\r\n\r\n    if (uniforms.shadowMatrix) {\r\n\r\n      var j = 0;\r\n\r\n      for (var i = 0, il = lights.length; i < il; i++) {\r\n\r\n        var light = lights[i];\r\n\r\n        if (!light.castShadow) continue;\r\n\r\n        if (light instanceof THREE.SpotLight || (light instanceof THREE.DirectionalLight && !light.shadowCascade)) {\r\n\r\n          uniforms.shadowMap.value[j] = light.shadowMap;\r\n          uniforms.shadowMapSize.value[j] = light.shadowMapSize;\r\n\r\n          uniforms.shadowMatrix.value[j] = light.shadowMatrix;\r\n\r\n          uniforms.shadowDarkness.value[j] = light.shadowDarkness;\r\n          uniforms.shadowBias.value[j] = light.shadowBias;\r\n\r\n          j++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Uniforms (load to GPU)\r\n\r\n  function loadUniformsMatrices(uniforms, object) {\r\n\r\n    _gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, object._modelViewMatrix.elements);\r\n\r\n    if (uniforms.normalMatrix) {\r\n\r\n      _gl.uniformMatrix3fv(uniforms.normalMatrix, false, object._normalMatrix.elements);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function getTextureUnit() {\r\n\r\n    var textureUnit = _usedTextureUnits;\r\n\r\n    if (textureUnit >= _maxTextures) {\r\n\r\n      THREE.warn('WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + _maxTextures);\r\n\r\n    }\r\n\r\n    _usedTextureUnits += 1;\r\n\r\n    return textureUnit;\r\n\r\n  }\r\n\r\n  function loadUniformsGeneric(uniforms) {\r\n\r\n    var texture, textureUnit, offset;\r\n\r\n    for (var j = 0, jl = uniforms.length; j < jl; j++) {\r\n\r\n      var uniform = uniforms[j][0];\r\n\r\n      // needsUpdate property is not added to all uniforms.\r\n      if (uniform.needsUpdate === false) continue;\r\n\r\n      var type = uniform.type;\r\n      var value = uniform.value;\r\n      var location = uniforms[j][1];\r\n\r\n      switch (type) {\r\n\r\n        case '1i':\r\n          _gl.uniform1i(location, value);\r\n          break;\r\n\r\n        case '1f':\r\n          _gl.uniform1f(location, value);\r\n          break;\r\n\r\n        case '2f':\r\n          _gl.uniform2f(location, value[0], value[1]);\r\n          break;\r\n\r\n        case '3f':\r\n          _gl.uniform3f(location, value[0], value[1], value[2]);\r\n          break;\r\n\r\n        case '4f':\r\n          _gl.uniform4f(location, value[0], value[1], value[2], value[3]);\r\n          break;\r\n\r\n        case '1iv':\r\n          _gl.uniform1iv(location, value);\r\n          break;\r\n\r\n        case '3iv':\r\n          _gl.uniform3iv(location, value);\r\n          break;\r\n\r\n        case '1fv':\r\n          _gl.uniform1fv(location, value);\r\n          break;\r\n\r\n        case '2fv':\r\n          _gl.uniform2fv(location, value);\r\n          break;\r\n\r\n        case '3fv':\r\n          _gl.uniform3fv(location, value);\r\n          break;\r\n\r\n        case '4fv':\r\n          _gl.uniform4fv(location, value);\r\n          break;\r\n\r\n        case 'Matrix3fv':\r\n          _gl.uniformMatrix3fv(location, false, value);\r\n          break;\r\n\r\n        case 'Matrix4fv':\r\n          _gl.uniformMatrix4fv(location, false, value);\r\n          break;\r\n\r\n          //\r\n\r\n        case 'i':\r\n\r\n          // single integer\r\n          _gl.uniform1i(location, value);\r\n\r\n          break;\r\n\r\n        case 'f':\r\n\r\n          // single float\r\n          _gl.uniform1f(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2':\r\n\r\n          // single THREE.Vector2\r\n          _gl.uniform2f(location, value.x, value.y);\r\n\r\n          break;\r\n\r\n        case 'v3':\r\n\r\n          // single THREE.Vector3\r\n          _gl.uniform3f(location, value.x, value.y, value.z);\r\n\r\n          break;\r\n\r\n        case 'v4':\r\n\r\n          // single THREE.Vector4\r\n          _gl.uniform4f(location, value.x, value.y, value.z, value.w);\r\n\r\n          break;\r\n\r\n        case 'c':\r\n\r\n          // single THREE.Color\r\n          _gl.uniform3f(location, value.r, value.g, value.b);\r\n\r\n          break;\r\n\r\n        case 'iv1':\r\n\r\n          // flat array of integers (JS or typed array)\r\n          _gl.uniform1iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'iv':\r\n\r\n          // flat array of integers with 3 x N size (JS or typed array)\r\n          _gl.uniform3iv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv1':\r\n\r\n          // flat array of floats (JS or typed array)\r\n          _gl.uniform1fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'fv':\r\n\r\n          // flat array of floats with 3 x N size (JS or typed array)\r\n          _gl.uniform3fv(location, value);\r\n\r\n          break;\r\n\r\n        case 'v2v':\r\n\r\n          // array of THREE.Vector2\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(2 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 2;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n\r\n          }\r\n\r\n          _gl.uniform2fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v3v':\r\n\r\n          // array of THREE.Vector3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(3 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 3;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n\r\n          }\r\n\r\n          _gl.uniform3fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'v4v':\r\n\r\n          // array of THREE.Vector4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(4 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            offset = i * 4;\r\n\r\n            uniform._array[offset] = value[i].x;\r\n            uniform._array[offset + 1] = value[i].y;\r\n            uniform._array[offset + 2] = value[i].z;\r\n            uniform._array[offset + 3] = value[i].w;\r\n\r\n          }\r\n\r\n          _gl.uniform4fv(location, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm3':\r\n\r\n          // single THREE.Matrix3\r\n          _gl.uniformMatrix3fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm3v':\r\n\r\n          // array of THREE.Matrix3\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(9 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 9);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix3fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 'm4':\r\n\r\n          // single THREE.Matrix4\r\n          _gl.uniformMatrix4fv(location, false, value.elements);\r\n\r\n          break;\r\n\r\n        case 'm4v':\r\n\r\n          // array of THREE.Matrix4\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = new Float32Array(16 * value.length);\r\n\r\n          }\r\n\r\n          for (var i = 0, il = value.length; i < il; i++) {\r\n\r\n            value[i].flattenToArrayOffset(uniform._array, i * 16);\r\n\r\n          }\r\n\r\n          _gl.uniformMatrix4fv(location, false, uniform._array);\r\n\r\n          break;\r\n\r\n        case 't':\r\n\r\n          // single THREE.Texture (2d or cube)\r\n\r\n          texture = value;\r\n          textureUnit = getTextureUnit();\r\n\r\n          _gl.uniform1i(location, textureUnit);\r\n\r\n          if (!texture) continue;\r\n\r\n          if (texture instanceof THREE.CubeTexture ||\r\n            (texture.image instanceof Array && texture.image.length === 6)) { // CompressedTexture can have Array in image :/\r\n\r\n            setCubeTexture(texture, textureUnit);\r\n\r\n          }\r\n          else if (texture instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n            setCubeTextureDynamic(texture, textureUnit);\r\n\r\n          }\r\n          else {\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        case 'tv':\r\n\r\n          // array of THREE.Texture (2d)\r\n\r\n          if (uniform._array === undefined) {\r\n\r\n            uniform._array = [];\r\n\r\n          }\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            uniform._array[i] = getTextureUnit();\r\n\r\n          }\r\n\r\n          _gl.uniform1iv(location, uniform._array);\r\n\r\n          for (var i = 0, il = uniform.value.length; i < il; i++) {\r\n\r\n            texture = uniform.value[i];\r\n            textureUnit = uniform._array[i];\r\n\r\n            if (!texture) continue;\r\n\r\n            _this.setTexture(texture, textureUnit);\r\n\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n\r\n          THREE.warn('THREE.WebGLRenderer: Unknown uniform type: ' + type);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setupMatrices(object, camera) {\r\n\r\n    object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, object.matrixWorld);\r\n    object._normalMatrix.getNormalMatrix(object._modelViewMatrix);\r\n\r\n  }\r\n\r\n  function setColorLinear(array, offset, color, intensity) {\r\n\r\n    array[offset] = color.r * intensity;\r\n    array[offset + 1] = color.g * intensity;\r\n    array[offset + 2] = color.b * intensity;\r\n\r\n  }\r\n\r\n  function setupLights(lights) {\r\n\r\n    var l, ll, light,\r\n      r = 0,\r\n      g = 0,\r\n      b = 0,\r\n      color, skyColor, groundColor,\r\n      intensity,\r\n      distance,\r\n\r\n      zlights = _lights,\r\n\r\n      dirColors = zlights.directional.colors,\r\n      dirPositions = zlights.directional.positions,\r\n\r\n      pointColors = zlights.point.colors,\r\n      pointPositions = zlights.point.positions,\r\n      pointDistances = zlights.point.distances,\r\n      pointDecays = zlights.point.decays,\r\n\r\n      spotColors = zlights.spot.colors,\r\n      spotPositions = zlights.spot.positions,\r\n      spotDistances = zlights.spot.distances,\r\n      spotDirections = zlights.spot.directions,\r\n      spotAnglesCos = zlights.spot.anglesCos,\r\n      spotExponents = zlights.spot.exponents,\r\n      spotDecays = zlights.spot.decays,\r\n\r\n      hemiSkyColors = zlights.hemi.skyColors,\r\n      hemiGroundColors = zlights.hemi.groundColors,\r\n      hemiPositions = zlights.hemi.positions,\r\n\r\n      dirLength = 0,\r\n      pointLength = 0,\r\n      spotLength = 0,\r\n      hemiLength = 0,\r\n\r\n      dirCount = 0,\r\n      pointCount = 0,\r\n      spotCount = 0,\r\n      hemiCount = 0,\r\n\r\n      dirOffset = 0,\r\n      pointOffset = 0,\r\n      spotOffset = 0,\r\n      hemiOffset = 0;\r\n\r\n    for (l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      light = lights[l];\r\n\r\n      if (light.onlyShadow) continue;\r\n\r\n      color = light.color;\r\n      intensity = light.intensity;\r\n      distance = light.distance;\r\n\r\n      if (light instanceof THREE.AmbientLight) {\r\n\r\n        if (!light.visible) continue;\r\n\r\n        r += color.r;\r\n        g += color.g;\r\n        b += color.b;\r\n\r\n      }\r\n      else if (light instanceof THREE.DirectionalLight) {\r\n\r\n        dirCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        dirOffset = dirLength * 3;\r\n\r\n        dirPositions[dirOffset] = _direction.x;\r\n        dirPositions[dirOffset + 1] = _direction.y;\r\n        dirPositions[dirOffset + 2] = _direction.z;\r\n\r\n        setColorLinear(dirColors, dirOffset, color, intensity);\r\n\r\n        dirLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.PointLight) {\r\n\r\n        pointCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        pointOffset = pointLength * 3;\r\n\r\n        setColorLinear(pointColors, pointOffset, color, intensity);\r\n\r\n        _vector3.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        pointPositions[pointOffset] = _vector3.x;\r\n        pointPositions[pointOffset + 1] = _vector3.y;\r\n        pointPositions[pointOffset + 2] = _vector3.z;\r\n\r\n        // distance is 0 if decay is 0, because there is no attenuation at all.\r\n        pointDistances[pointLength] = distance;\r\n        pointDecays[pointLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        pointLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.SpotLight) {\r\n\r\n        spotCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        spotOffset = spotLength * 3;\r\n\r\n        setColorLinear(spotColors, spotOffset, color, intensity);\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n\r\n        spotPositions[spotOffset] = _direction.x;\r\n        spotPositions[spotOffset + 1] = _direction.y;\r\n        spotPositions[spotOffset + 2] = _direction.z;\r\n\r\n        spotDistances[spotLength] = distance;\r\n\r\n        _vector3.setFromMatrixPosition(light.target.matrixWorld);\r\n        _direction.sub(_vector3);\r\n        _direction.normalize();\r\n\r\n        spotDirections[spotOffset] = _direction.x;\r\n        spotDirections[spotOffset + 1] = _direction.y;\r\n        spotDirections[spotOffset + 2] = _direction.z;\r\n\r\n        spotAnglesCos[spotLength] = Math.cos(light.angle);\r\n        spotExponents[spotLength] = light.exponent;\r\n        spotDecays[spotLength] = (light.distance === 0) ? 0.0 : light.decay;\r\n\r\n        spotLength += 1;\r\n\r\n      }\r\n      else if (light instanceof THREE.HemisphereLight) {\r\n\r\n        hemiCount += 1;\r\n\r\n        if (!light.visible) continue;\r\n\r\n        _direction.setFromMatrixPosition(light.matrixWorld);\r\n        _direction.normalize();\r\n\r\n        hemiOffset = hemiLength * 3;\r\n\r\n        hemiPositions[hemiOffset] = _direction.x;\r\n        hemiPositions[hemiOffset + 1] = _direction.y;\r\n        hemiPositions[hemiOffset + 2] = _direction.z;\r\n\r\n        skyColor = light.color;\r\n        groundColor = light.groundColor;\r\n\r\n        setColorLinear(hemiSkyColors, hemiOffset, skyColor, intensity);\r\n        setColorLinear(hemiGroundColors, hemiOffset, groundColor, intensity);\r\n\r\n        hemiLength += 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // null eventual remains from removed lights\r\n    // (this is to avoid if in shader)\r\n\r\n    for (l = dirLength * 3, ll = Math.max(dirColors.length, dirCount * 3); l < ll; l++) dirColors[l] = 0.0;\r\n    for (l = pointLength * 3, ll = Math.max(pointColors.length, pointCount * 3); l < ll; l++) pointColors[l] = 0.0;\r\n    for (l = spotLength * 3, ll = Math.max(spotColors.length, spotCount * 3); l < ll; l++) spotColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiSkyColors.length, hemiCount * 3); l < ll; l++) hemiSkyColors[l] = 0.0;\r\n    for (l = hemiLength * 3, ll = Math.max(hemiGroundColors.length, hemiCount * 3); l < ll; l++) hemiGroundColors[l] = 0.0;\r\n\r\n    zlights.directional.length = dirLength;\r\n    zlights.point.length = pointLength;\r\n    zlights.spot.length = spotLength;\r\n    zlights.hemi.length = hemiLength;\r\n\r\n    zlights.ambient[0] = r;\r\n    zlights.ambient[1] = g;\r\n    zlights.ambient[2] = b;\r\n\r\n  }\r\n\r\n  // GL state setting\r\n\r\n  this.setFaceCulling = function(cullFace, frontFaceDirection) {\r\n\r\n    if (cullFace === THREE.CullFaceNone) {\r\n\r\n      _gl.disable(_gl.CULL_FACE);\r\n\r\n    }\r\n    else {\r\n\r\n      if (frontFaceDirection === THREE.FrontFaceDirectionCW) {\r\n\r\n        _gl.frontFace(_gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.frontFace(_gl.CCW);\r\n\r\n      }\r\n\r\n      if (cullFace === THREE.CullFaceBack) {\r\n\r\n        _gl.cullFace(_gl.BACK);\r\n\r\n      }\r\n      else if (cullFace === THREE.CullFaceFront) {\r\n\r\n        _gl.cullFace(_gl.FRONT);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.cullFace(_gl.FRONT_AND_BACK);\r\n\r\n      }\r\n\r\n      _gl.enable(_gl.CULL_FACE);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setMaterialFaces = function(material) {\r\n\r\n    state.setDoubleSided(material.side === THREE.DoubleSide);\r\n    state.setFlipSided(material.side === THREE.BackSide);\r\n\r\n  };\r\n\r\n  // Textures\r\n\r\n  function setTextureParameters(textureType, texture, isImagePowerOfTwo) {\r\n\r\n    var extension;\r\n\r\n    if (isImagePowerOfTwo) {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL(texture.wrapS));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL(texture.wrapT));\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL(texture.minFilter));\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);\r\n\r\n      if (texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MAG_FILTER, filterFallback(texture.magFilter));\r\n      _gl.texParameteri(textureType, _gl.TEXTURE_MIN_FILTER, filterFallback(texture.minFilter));\r\n\r\n      if (texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter) {\r\n\r\n        THREE.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )');\r\n\r\n      }\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_texture_filter_anisotropic');\r\n\r\n    if (extension && texture.type !== THREE.FloatType && texture.type !== THREE.HalfFloatType) {\r\n\r\n      if (texture.anisotropy > 1 || texture.__currentAnisotropy) {\r\n\r\n        _gl.texParameterf(textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(texture.anisotropy, _this.getMaxAnisotropy()));\r\n        texture.__currentAnisotropy = texture.anisotropy;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.uploadTexture = function(texture) {\r\n\r\n    if (texture.__webglInit === undefined) {\r\n\r\n      texture.__webglInit = true;\r\n\r\n      texture.addEventListener('dispose', onTextureDispose);\r\n\r\n      texture.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n    }\r\n\r\n    _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n    _gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha);\r\n    _gl.pixelStorei(_gl.UNPACK_ALIGNMENT, texture.unpackAlignment);\r\n\r\n    texture.image = clampToMaxSize(texture.image, _maxTextureSize);\r\n\r\n    var image = texture.image,\r\n      isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n      glFormat = paramThreeToGL(texture.format),\r\n      glType = paramThreeToGL(texture.type);\r\n\r\n    setTextureParameters(_gl.TEXTURE_2D, texture, isImagePowerOfTwo);\r\n\r\n    var mipmap, mipmaps = texture.mipmaps;\r\n\r\n    if (texture instanceof THREE.DataTexture) {\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data);\r\n\r\n      }\r\n\r\n    }\r\n    else if (texture instanceof THREE.CompressedTexture) {\r\n\r\n      for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n        mipmap = mipmaps[i];\r\n\r\n        if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n          if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n            _gl.compressedTexImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n          }\r\n          else {\r\n\r\n            THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\");\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else { // regular Texture (image, video, canvas)\r\n\r\n      // use manually created mipmaps if available\r\n      // if there are no manual mipmaps\r\n      // set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n      if (mipmaps.length > 0 && isImagePowerOfTwo) {\r\n\r\n        for (var i = 0, il = mipmaps.length; i < il; i++) {\r\n\r\n          mipmap = mipmaps[i];\r\n          _gl.texImage2D(_gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap);\r\n\r\n        }\r\n\r\n        texture.generateMipmaps = false;\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (texture.generateMipmaps && isImagePowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n    texture.needsUpdate = false;\r\n\r\n    if (texture.onUpdate) texture.onUpdate();\r\n\r\n  };\r\n\r\n  this.setTexture = function(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n\r\n    if (texture.needsUpdate) {\r\n\r\n      _this.uploadTexture(texture);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, texture.__webglTexture);\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function clampToMaxSize(image, maxSize) {\r\n\r\n    if (image.width > maxSize || image.height > maxSize) {\r\n\r\n      // Warning: Scaling through the canvas will only work with images that use\r\n      // premultiplied alpha.\r\n\r\n      var scale = maxSize / Math.max(image.width, image.height);\r\n\r\n      var canvas = document.createElement('canvas');\r\n      canvas.width = Math.floor(image.width * scale);\r\n      canvas.height = Math.floor(image.height * scale);\r\n\r\n      var context = canvas.getContext('2d');\r\n      context.drawImage(image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height);\r\n\r\n      THREE.warn('THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image);\r\n\r\n      return canvas;\r\n\r\n    }\r\n\r\n    return image;\r\n\r\n  }\r\n\r\n  function setCubeTexture(texture, slot) {\r\n\r\n    if (texture.image.length === 6) {\r\n\r\n      if (texture.needsUpdate) {\r\n\r\n        if (!texture.image.__webglTextureCube) {\r\n\r\n          texture.addEventListener('dispose', onTextureDispose);\r\n\r\n          texture.image.__webglTextureCube = _gl.createTexture();\r\n\r\n          _this.info.memory.textures++;\r\n\r\n        }\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n        _gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\r\n\r\n        var isCompressed = texture instanceof THREE.CompressedTexture;\r\n        var isDataTexture = texture.image[0] instanceof THREE.DataTexture;\r\n\r\n        var cubeImage = [];\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (_this.autoScaleCubemaps && !isCompressed && !isDataTexture) {\r\n\r\n            cubeImage[i] = clampToMaxSize(texture.image[i], _maxCubemapSize);\r\n\r\n          }\r\n          else {\r\n\r\n            cubeImage[i] = isDataTexture ? texture.image[i].image : texture.image[i];\r\n\r\n          }\r\n\r\n        }\r\n\r\n        var image = cubeImage[0],\r\n          isImagePowerOfTwo = THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),\r\n          glFormat = paramThreeToGL(texture.format),\r\n          glType = paramThreeToGL(texture.type);\r\n\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          if (!isCompressed) {\r\n\r\n            if (isDataTexture) {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[i].width, cubeImage[i].height, 0, glFormat, glType, cubeImage[i].data);\r\n\r\n            }\r\n            else {\r\n\r\n              _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[i]);\r\n\r\n            }\r\n\r\n          }\r\n          else {\r\n\r\n            var mipmap, mipmaps = cubeImage[i].mipmaps;\r\n\r\n            for (var j = 0, jl = mipmaps.length; j < jl; j++) {\r\n\r\n              mipmap = mipmaps[j];\r\n\r\n              if (texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat) {\r\n\r\n                if (getCompressedTextureFormats().indexOf(glFormat) > -1) {\r\n\r\n                  _gl.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data);\r\n\r\n                }\r\n                else {\r\n\r\n                  THREE.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\");\r\n\r\n                }\r\n\r\n              }\r\n              else {\r\n\r\n                _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (texture.generateMipmaps && isImagePowerOfTwo) {\r\n\r\n          _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n        }\r\n\r\n        texture.needsUpdate = false;\r\n\r\n        if (texture.onUpdate) texture.onUpdate();\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.image.__webglTextureCube);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function setCubeTextureDynamic(texture, slot) {\r\n\r\n    _gl.activeTexture(_gl.TEXTURE0 + slot);\r\n    _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, texture.__webglTexture);\r\n\r\n  }\r\n\r\n  // Render targets\r\n\r\n  function setupFrameBuffer(framebuffer, renderTarget, textureTarget) {\r\n\r\n    _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n    _gl.framebufferTexture2D(_gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, renderTarget.__webglTexture, 0);\r\n\r\n  }\r\n\r\n  function setupRenderBuffer(renderbuffer, renderTarget) {\r\n\r\n    _gl.bindRenderbuffer(_gl.RENDERBUFFER, renderbuffer);\r\n\r\n    if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n      /* For some reason this is not working. Defaulting to RGBA4.\r\n      } else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n      \t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\r\n      \t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n      */\r\n    }\r\n    else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height);\r\n      _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.renderbufferStorage(_gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.setRenderTarget = function(renderTarget) {\r\n\r\n    var isCube = (renderTarget instanceof THREE.WebGLRenderTargetCube);\r\n\r\n    if (renderTarget && renderTarget.__webglFramebuffer === undefined) {\r\n\r\n      if (renderTarget.depthBuffer === undefined) renderTarget.depthBuffer = true;\r\n      if (renderTarget.stencilBuffer === undefined) renderTarget.stencilBuffer = true;\r\n\r\n      renderTarget.addEventListener('dispose', onRenderTargetDispose);\r\n\r\n      renderTarget.__webglTexture = _gl.createTexture();\r\n\r\n      _this.info.memory.textures++;\r\n\r\n      // Setup texture, create render and frame buffers\r\n\r\n      var isTargetPowerOfTwo = THREE.Math.isPowerOfTwo(renderTarget.width) && THREE.Math.isPowerOfTwo(renderTarget.height),\r\n        glFormat = paramThreeToGL(renderTarget.format),\r\n        glType = paramThreeToGL(renderTarget.type);\r\n\r\n      if (isCube) {\r\n\r\n        renderTarget.__webglFramebuffer = [];\r\n        renderTarget.__webglRenderbuffer = [];\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_CUBE_MAP, renderTarget, isTargetPowerOfTwo);\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n\r\n          renderTarget.__webglFramebuffer[i] = _gl.createFramebuffer();\r\n          renderTarget.__webglRenderbuffer[i] = _gl.createRenderbuffer();\r\n\r\n          _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n          setupFrameBuffer(renderTarget.__webglFramebuffer[i], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i);\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer[i], renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n\r\n      }\r\n      else {\r\n\r\n        renderTarget.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          renderTarget.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\r\n\r\n        }\r\n        else {\r\n\r\n          renderTarget.__webglRenderbuffer = _gl.createRenderbuffer();\r\n\r\n        }\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n        setTextureParameters(_gl.TEXTURE_2D, renderTarget, isTargetPowerOfTwo);\r\n\r\n        _gl.texImage2D(_gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null);\r\n\r\n        setupFrameBuffer(renderTarget.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D);\r\n\r\n        if (renderTarget.shareDepthFrom) {\r\n\r\n          if (renderTarget.depthBuffer && !renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n          else if (renderTarget.depthBuffer && renderTarget.stencilBuffer) {\r\n\r\n            _gl.framebufferRenderbuffer(_gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTarget.__webglRenderbuffer);\r\n\r\n          }\r\n\r\n        }\r\n        else {\r\n\r\n          setupRenderBuffer(renderTarget.__webglRenderbuffer, renderTarget);\r\n\r\n        }\r\n\r\n        if (isTargetPowerOfTwo) _gl.generateMipmap(_gl.TEXTURE_2D);\r\n\r\n      }\r\n\r\n      // Release everything\r\n\r\n      if (isCube) {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n      }\r\n      else {\r\n\r\n        _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n      }\r\n\r\n      _gl.bindRenderbuffer(_gl.RENDERBUFFER, null);\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, null);\r\n\r\n    }\r\n\r\n    var framebuffer, width, height, vx, vy;\r\n\r\n    if (renderTarget) {\r\n\r\n      if (isCube) {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer[renderTarget.activeCubeFace];\r\n\r\n      }\r\n      else {\r\n\r\n        framebuffer = renderTarget.__webglFramebuffer;\r\n\r\n      }\r\n\r\n      width = renderTarget.width;\r\n      height = renderTarget.height;\r\n\r\n      vx = 0;\r\n      vy = 0;\r\n\r\n    }\r\n    else {\r\n\r\n      framebuffer = null;\r\n\r\n      width = _viewportWidth;\r\n      height = _viewportHeight;\r\n\r\n      vx = _viewportX;\r\n      vy = _viewportY;\r\n\r\n    }\r\n\r\n    if (framebuffer !== _currentFramebuffer) {\r\n\r\n      _gl.bindFramebuffer(_gl.FRAMEBUFFER, framebuffer);\r\n      _gl.viewport(vx, vy, width, height);\r\n\r\n      _currentFramebuffer = framebuffer;\r\n\r\n    }\r\n\r\n    _currentWidth = width;\r\n    _currentHeight = height;\r\n\r\n  };\r\n\r\n  this.readRenderTargetPixels = function(renderTarget, x, y, width, height, buffer) {\r\n\r\n    if (!(renderTarget instanceof THREE.WebGLRenderTarget)) {\r\n\r\n      console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');\r\n      return;\r\n\r\n    }\r\n\r\n    if (renderTarget.__webglFramebuffer) {\r\n\r\n      if (renderTarget.format !== THREE.RGBAFormat) {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.');\r\n        return;\r\n\r\n      }\r\n\r\n      var restore = false;\r\n\r\n      if (renderTarget.__webglFramebuffer !== _currentFramebuffer) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, renderTarget.__webglFramebuffer);\r\n\r\n        restore = true;\r\n\r\n      }\r\n\r\n      if (_gl.checkFramebufferStatus(_gl.FRAMEBUFFER) === _gl.FRAMEBUFFER_COMPLETE) {\r\n\r\n        _gl.readPixels(x, y, width, height, _gl.RGBA, _gl.UNSIGNED_BYTE, buffer);\r\n\r\n      }\r\n      else {\r\n\r\n        console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.');\r\n\r\n      }\r\n\r\n      if (restore) {\r\n\r\n        _gl.bindFramebuffer(_gl.FRAMEBUFFER, _currentFramebuffer);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  function updateRenderTargetMipmap(renderTarget) {\r\n\r\n    if (renderTarget instanceof THREE.WebGLRenderTargetCube) {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);\r\n      _gl.bindTexture(_gl.TEXTURE_CUBE_MAP, null);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.bindTexture(_gl.TEXTURE_2D, renderTarget.__webglTexture);\r\n      _gl.generateMipmap(_gl.TEXTURE_2D);\r\n      _gl.bindTexture(_gl.TEXTURE_2D, null);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Fallback filters for non-power-of-2 textures\r\n\r\n  function filterFallback(f) {\r\n\r\n    if (f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter) {\r\n\r\n      return _gl.NEAREST;\r\n\r\n    }\r\n\r\n    return _gl.LINEAR;\r\n\r\n  }\r\n\r\n  // Map three.js constants to WebGL constants\r\n\r\n  function paramThreeToGL(p) {\r\n\r\n    var extension;\r\n\r\n    if (p === THREE.RepeatWrapping) return _gl.REPEAT;\r\n    if (p === THREE.ClampToEdgeWrapping) return _gl.CLAMP_TO_EDGE;\r\n    if (p === THREE.MirroredRepeatWrapping) return _gl.MIRRORED_REPEAT;\r\n\r\n    if (p === THREE.NearestFilter) return _gl.NEAREST;\r\n    if (p === THREE.NearestMipMapNearestFilter) return _gl.NEAREST_MIPMAP_NEAREST;\r\n    if (p === THREE.NearestMipMapLinearFilter) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.LinearFilter) return _gl.LINEAR;\r\n    if (p === THREE.LinearMipMapNearestFilter) return _gl.LINEAR_MIPMAP_NEAREST;\r\n    if (p === THREE.LinearMipMapLinearFilter) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n    if (p === THREE.UnsignedByteType) return _gl.UNSIGNED_BYTE;\r\n    if (p === THREE.UnsignedShort4444Type) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n    if (p === THREE.UnsignedShort5551Type) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n    if (p === THREE.UnsignedShort565Type) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n    if (p === THREE.ByteType) return _gl.BYTE;\r\n    if (p === THREE.ShortType) return _gl.SHORT;\r\n    if (p === THREE.UnsignedShortType) return _gl.UNSIGNED_SHORT;\r\n    if (p === THREE.IntType) return _gl.INT;\r\n    if (p === THREE.UnsignedIntType) return _gl.UNSIGNED_INT;\r\n    if (p === THREE.FloatType) return _gl.FLOAT;\r\n\r\n    extension = extensions.get('OES_texture_half_float');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.HalfFloatType) return extension.HALF_FLOAT_OES;\r\n\r\n    }\r\n\r\n    if (p === THREE.AlphaFormat) return _gl.ALPHA;\r\n    if (p === THREE.RGBFormat) return _gl.RGB;\r\n    if (p === THREE.RGBAFormat) return _gl.RGBA;\r\n    if (p === THREE.LuminanceFormat) return _gl.LUMINANCE;\r\n    if (p === THREE.LuminanceAlphaFormat) return _gl.LUMINANCE_ALPHA;\r\n\r\n    if (p === THREE.AddEquation) return _gl.FUNC_ADD;\r\n    if (p === THREE.SubtractEquation) return _gl.FUNC_SUBTRACT;\r\n    if (p === THREE.ReverseSubtractEquation) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n    if (p === THREE.ZeroFactor) return _gl.ZERO;\r\n    if (p === THREE.OneFactor) return _gl.ONE;\r\n    if (p === THREE.SrcColorFactor) return _gl.SRC_COLOR;\r\n    if (p === THREE.OneMinusSrcColorFactor) return _gl.ONE_MINUS_SRC_COLOR;\r\n    if (p === THREE.SrcAlphaFactor) return _gl.SRC_ALPHA;\r\n    if (p === THREE.OneMinusSrcAlphaFactor) return _gl.ONE_MINUS_SRC_ALPHA;\r\n    if (p === THREE.DstAlphaFactor) return _gl.DST_ALPHA;\r\n    if (p === THREE.OneMinusDstAlphaFactor) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n    if (p === THREE.DstColorFactor) return _gl.DST_COLOR;\r\n    if (p === THREE.OneMinusDstColorFactor) return _gl.ONE_MINUS_DST_COLOR;\r\n    if (p === THREE.SrcAlphaSaturateFactor) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_s3tc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_S3TC_DXT1_Format) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT1_Format) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT3_Format) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n      if (p === THREE.RGBA_S3TC_DXT5_Format) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n    }\r\n\r\n    extension = extensions.get('WEBGL_compressed_texture_pvrtc');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.RGB_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGB_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_4BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n      if (p === THREE.RGBA_PVRTC_2BPPV1_Format) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n    }\r\n\r\n    extension = extensions.get('EXT_blend_minmax');\r\n\r\n    if (extension !== null) {\r\n\r\n      if (p === THREE.MinEquation) return extension.MIN_EXT;\r\n      if (p === THREE.MaxEquation) return extension.MAX_EXT;\r\n\r\n    }\r\n\r\n    return 0;\r\n\r\n  }\r\n\r\n  // Allocations\r\n\r\n  function allocateBones(object) {\r\n\r\n    if (_supportsBoneTextures && object && object.skeleton && object.skeleton.useVertexTexture) {\r\n\r\n      return 1024;\r\n\r\n    }\r\n    else {\r\n\r\n      // default for when object is not specified\r\n      // ( for example when prebuilding shader\r\n      //   to be used with multiple objects )\r\n      //\r\n      //  - leave some extra space for other uniforms\r\n      //  - limit here is ANGLE's 254 max uniform vectors\r\n      //    (up to 54 should be safe)\r\n\r\n      var nVertexUniforms = _gl.getParameter(_gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n      var nVertexMatrices = Math.floor((nVertexUniforms - 20) / 4);\r\n\r\n      var maxBones = nVertexMatrices;\r\n\r\n      if (object !== undefined && object instanceof THREE.SkinnedMesh) {\r\n\r\n        maxBones = Math.min(object.skeleton.bones.length, maxBones);\r\n\r\n        if (maxBones < object.skeleton.bones.length) {\r\n\r\n          THREE.warn('WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return maxBones;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function allocateLights(lights) {\r\n\r\n    var dirLights = 0;\r\n    var pointLights = 0;\r\n    var spotLights = 0;\r\n    var hemiLights = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (light.onlyShadow || light.visible === false) continue;\r\n\r\n      if (light instanceof THREE.DirectionalLight) dirLights++;\r\n      if (light instanceof THREE.PointLight) pointLights++;\r\n      if (light instanceof THREE.SpotLight) spotLights++;\r\n      if (light instanceof THREE.HemisphereLight) hemiLights++;\r\n\r\n    }\r\n\r\n    return {\r\n      'directional': dirLights,\r\n      'point': pointLights,\r\n      'spot': spotLights,\r\n      'hemi': hemiLights\r\n    };\r\n\r\n  }\r\n\r\n  function allocateShadows(lights) {\r\n\r\n    var maxShadows = 0;\r\n\r\n    for (var l = 0, ll = lights.length; l < ll; l++) {\r\n\r\n      var light = lights[l];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if (light instanceof THREE.SpotLight) maxShadows++;\r\n      if (light instanceof THREE.DirectionalLight && !light.shadowCascade) maxShadows++;\r\n\r\n    }\r\n\r\n    return maxShadows;\r\n\r\n  }\r\n\r\n  // DEPRECATED\r\n\r\n  this.initMaterial = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .initMaterial() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPrePlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.addPostPlugin = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.');\r\n\r\n  };\r\n\r\n  this.updateShadowMap = function() {\r\n\r\n    THREE.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.');\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.WebGLRenderTarget = function(width, height, options) {\r\n\r\n  this.width = width;\r\n  this.height = height;\r\n\r\n  options = options || {};\r\n\r\n  this.wrapS = options.wrapS !== undefined ? options.wrapS : THREE.ClampToEdgeWrapping;\r\n  this.wrapT = options.wrapT !== undefined ? options.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n  this.magFilter = options.magFilter !== undefined ? options.magFilter : THREE.LinearFilter;\r\n  this.minFilter = options.minFilter !== undefined ? options.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n  this.anisotropy = options.anisotropy !== undefined ? options.anisotropy : 1;\r\n\r\n  this.offset = new THREE.Vector2(0, 0);\r\n  this.repeat = new THREE.Vector2(1, 1);\r\n\r\n  this.format = options.format !== undefined ? options.format : THREE.RGBAFormat;\r\n  this.type = options.type !== undefined ? options.type : THREE.UnsignedByteType;\r\n\r\n  this.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n  this.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\r\n  this.generateMipmaps = true;\r\n\r\n  this.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTarget.prototype = {\r\n\r\n  constructor: THREE.WebGLRenderTarget,\r\n\r\n  setSize: function(width, height) {\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n  },\r\n\r\n  clone: function() {\r\n\r\n    var tmp = new THREE.WebGLRenderTarget(this.width, this.height);\r\n\r\n    tmp.wrapS = this.wrapS;\r\n    tmp.wrapT = this.wrapT;\r\n\r\n    tmp.magFilter = this.magFilter;\r\n    tmp.minFilter = this.minFilter;\r\n\r\n    tmp.anisotropy = this.anisotropy;\r\n\r\n    tmp.offset.copy(this.offset);\r\n    tmp.repeat.copy(this.repeat);\r\n\r\n    tmp.format = this.format;\r\n    tmp.type = this.type;\r\n\r\n    tmp.depthBuffer = this.depthBuffer;\r\n    tmp.stencilBuffer = this.stencilBuffer;\r\n\r\n    tmp.generateMipmaps = this.generateMipmaps;\r\n\r\n    tmp.shareDepthFrom = this.shareDepthFrom;\r\n\r\n    return tmp;\r\n\r\n  },\r\n\r\n  dispose: function() {\r\n\r\n    this.dispatchEvent({\r\n      type: 'dispose'\r\n    });\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function(width, height, options) {\r\n\r\n  THREE.WebGLRenderTarget.call(this, width, height, options);\r\n\r\n  this.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create(THREE.WebGLRenderTarget.prototype);\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLExtensions = function(gl) {\r\n\r\n  var extensions = {};\r\n\r\n  this.get = function(name) {\r\n\r\n    if (extensions[name] !== undefined) {\r\n\r\n      return extensions[name];\r\n\r\n    }\r\n\r\n    var extension;\r\n\r\n    switch (name) {\r\n\r\n      case 'EXT_texture_filter_anisotropic':\r\n        extension = gl.getExtension('EXT_texture_filter_anisotropic') || gl.getExtension('MOZ_EXT_texture_filter_anisotropic') || gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_s3tc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_s3tc') || gl.getExtension('MOZ_WEBGL_compressed_texture_s3tc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');\r\n        break;\r\n\r\n      case 'WEBGL_compressed_texture_pvrtc':\r\n        extension = gl.getExtension('WEBGL_compressed_texture_pvrtc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');\r\n        break;\r\n\r\n      default:\r\n        extension = gl.getExtension(name);\r\n\r\n    }\r\n\r\n    if (extension === null) {\r\n\r\n      THREE.warn('THREE.WebGLRenderer: ' + name + ' extension not supported.');\r\n\r\n    }\r\n\r\n    extensions[name] = extension;\r\n\r\n    return extension;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = (function() {\r\n\r\n  var programIdCount = 0;\r\n\r\n  var generateDefines = function(defines) {\r\n\r\n    var value, chunk, chunks = [];\r\n\r\n    for (var d in defines) {\r\n\r\n      value = defines[d];\r\n      if (value === false) continue;\r\n\r\n      chunk = '#define ' + d + ' ' + value;\r\n      chunks.push(chunk);\r\n\r\n    }\r\n\r\n    return chunks.join('\\n');\r\n\r\n  };\r\n\r\n  var cacheUniformLocations = function(gl, program, identifiers) {\r\n\r\n    var uniforms = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      uniforms[id] = gl.getUniformLocation(program, id);\r\n\r\n    }\r\n\r\n    return uniforms;\r\n\r\n  };\r\n\r\n  var cacheAttributeLocations = function(gl, program, identifiers) {\r\n\r\n    var attributes = {};\r\n\r\n    for (var i = 0, l = identifiers.length; i < l; i++) {\r\n\r\n      var id = identifiers[i];\r\n      attributes[id] = gl.getAttribLocation(program, id);\r\n\r\n    }\r\n\r\n    return attributes;\r\n\r\n  };\r\n\r\n  return function(renderer, code, material, parameters) {\r\n\r\n    var _this = renderer;\r\n    var _gl = _this.context;\r\n\r\n    var defines = material.defines;\r\n    var uniforms = material.__webglShader.uniforms;\r\n    var attributes = material.attributes;\r\n\r\n    var vertexShader = material.__webglShader.vertexShader;\r\n    var fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n    var index0AttributeName = material.index0AttributeName;\r\n\r\n    if (index0AttributeName === undefined && parameters.morphTargets === true) {\r\n\r\n      // programs with morphTargets displace position out of attribute 0\r\n\r\n      index0AttributeName = 'position';\r\n\r\n    }\r\n\r\n    var shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n    if (parameters.shadowMapType === THREE.PCFShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n    }\r\n    else if (parameters.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n      shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n    }\r\n\r\n    var envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n    var envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n    var envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n    if (parameters.envMap) {\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeReflectionMapping:\r\n        case THREE.CubeRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n          break;\r\n\r\n        case THREE.EquirectangularReflectionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n          break;\r\n\r\n        case THREE.SphericalReflectionMapping:\r\n          envMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.envMap.mapping) {\r\n\r\n        case THREE.CubeRefractionMapping:\r\n        case THREE.EquirectangularRefractionMapping:\r\n          envMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n          break;\r\n\r\n      }\r\n\r\n      switch (material.combine) {\r\n\r\n        case THREE.MultiplyOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n          break;\r\n\r\n        case THREE.MixOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n          break;\r\n\r\n        case THREE.AddOperation:\r\n          envMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n          break;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var gammaFactorDefine = (renderer.gammaFactor > 0) ? renderer.gammaFactor : 1.0;\r\n\r\n    // console.log( 'building new program ' );\r\n\r\n    //\r\n\r\n    var customDefines = generateDefines(defines);\r\n\r\n    //\r\n\r\n    var program = _gl.createProgram();\r\n\r\n    var prefix_vertex, prefix_fragment;\r\n\r\n    if (material instanceof THREE.RawShaderMaterial) {\r\n\r\n      prefix_vertex = '';\r\n      prefix_fragment = '';\r\n\r\n    }\r\n    else {\r\n\r\n      prefix_vertex = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        customDefines,\r\n\r\n        parameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        '#define MAX_BONES ' + parameters.maxBones,\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.skinning ? '#define USE_SKINNING' : '',\r\n        parameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n        parameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n        parameters.morphNormals ? '#define USE_MORPHNORMALS' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\r\n        'uniform mat4 modelMatrix;',\r\n        'uniform mat4 modelViewMatrix;',\r\n        'uniform mat4 projectionMatrix;',\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform mat3 normalMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n\r\n        'attribute vec3 position;',\r\n        'attribute vec3 normal;',\r\n        'attribute vec2 uv;',\r\n        'attribute vec2 uv2;',\r\n\r\n        '#ifdef USE_COLOR',\r\n\r\n        '\tattribute vec3 color;',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_MORPHTARGETS',\r\n\r\n        '\tattribute vec3 morphTarget0;',\r\n        '\tattribute vec3 morphTarget1;',\r\n        '\tattribute vec3 morphTarget2;',\r\n        '\tattribute vec3 morphTarget3;',\r\n\r\n        '\t#ifdef USE_MORPHNORMALS',\r\n\r\n        '\t\tattribute vec3 morphNormal0;',\r\n        '\t\tattribute vec3 morphNormal1;',\r\n        '\t\tattribute vec3 morphNormal2;',\r\n        '\t\tattribute vec3 morphNormal3;',\r\n\r\n        '\t#else',\r\n\r\n        '\t\tattribute vec3 morphTarget4;',\r\n        '\t\tattribute vec3 morphTarget5;',\r\n        '\t\tattribute vec3 morphTarget6;',\r\n        '\t\tattribute vec3 morphTarget7;',\r\n\r\n        '\t#endif',\r\n\r\n        '#endif',\r\n\r\n        '#ifdef USE_SKINNING',\r\n\r\n        '\tattribute vec4 skinIndex;',\r\n        '\tattribute vec4 skinWeight;',\r\n\r\n        '#endif',\r\n\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n      prefix_fragment = [\r\n\r\n        'precision ' + parameters.precision + ' float;',\r\n        'precision ' + parameters.precision + ' int;',\r\n\r\n        (parameters.bumpMap || parameters.normalMap || parameters.flatShading) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\r\n        customDefines,\r\n\r\n        '#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\r\n        '#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\r\n        '#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\r\n        '#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\r\n\r\n        '#define MAX_SHADOWS ' + parameters.maxShadows,\r\n\r\n        parameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n        _this.gammaInput ? '#define GAMMA_INPUT' : '',\r\n        _this.gammaOutput ? '#define GAMMA_OUTPUT' : '',\r\n        '#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n        (parameters.useFog && parameters.fog) ? '#define USE_FOG' : '', (parameters.useFog && parameters.fogExp) ? '#define FOG_EXP2' : '',\r\n\r\n        parameters.map ? '#define USE_MAP' : '',\r\n        parameters.envMap ? '#define USE_ENVMAP' : '',\r\n        parameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapModeDefine : '',\r\n        parameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n        parameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n        parameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n        parameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n        parameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n        parameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n        parameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n        parameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n        parameters.metal ? '#define METAL' : '',\r\n        parameters.wrapAround ? '#define WRAP_AROUND' : '',\r\n        parameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n        parameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n        parameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n        parameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n        parameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\r\n        parameters.shadowMapCascade ? '#define SHADOWMAP_CASCADE' : '',\r\n\r\n        parameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n        //_this._glExtensionFragDepth ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n        'uniform mat4 viewMatrix;',\r\n        'uniform vec3 cameraPosition;',\r\n        ''\r\n\r\n      ].join('\\n');\r\n\r\n    }\r\n\r\n    var glVertexShader = new THREE.WebGLShader(_gl, _gl.VERTEX_SHADER, prefix_vertex + vertexShader);\r\n    var glFragmentShader = new THREE.WebGLShader(_gl, _gl.FRAGMENT_SHADER, prefix_fragment + fragmentShader);\r\n\r\n    _gl.attachShader(program, glVertexShader);\r\n    _gl.attachShader(program, glFragmentShader);\r\n\r\n    if (index0AttributeName !== undefined) {\r\n\r\n      // Force a particular attribute to index 0.\r\n      // because potentially expensive emulation is done by browser if attribute 0 is disabled.\r\n      // And, color, for example is often automatically bound to index 0 so disabling it\r\n\r\n      _gl.bindAttribLocation(program, 0, index0AttributeName);\r\n\r\n    }\r\n\r\n    _gl.linkProgram(program);\r\n\r\n    var programLogInfo = _gl.getProgramInfoLog(program);\r\n\r\n    if (_gl.getProgramParameter(program, _gl.LINK_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLProgram: shader error: ' + _gl.getError(), 'gl.VALIDATE_STATUS', _gl.getProgramParameter(program, _gl.VALIDATE_STATUS), 'gl.getPRogramInfoLog', programLogInfo);\r\n\r\n    }\r\n\r\n    if (programLogInfo !== '') {\r\n\r\n      THREE.warn('THREE.WebGLProgram: gl.getProgramInfoLog()' + programLogInfo);\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n      // THREE.warn( _gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n    }\r\n\r\n    // clean up\r\n\r\n    _gl.deleteShader(glVertexShader);\r\n    _gl.deleteShader(glFragmentShader);\r\n\r\n    // cache uniform locations\r\n\r\n    var identifiers = [\r\n\r\n      'viewMatrix',\r\n      'modelViewMatrix',\r\n      'projectionMatrix',\r\n      'normalMatrix',\r\n      'modelMatrix',\r\n      'cameraPosition',\r\n      'morphTargetInfluences',\r\n      'bindMatrix',\r\n      'bindMatrixInverse'\r\n\r\n    ];\r\n\r\n    if (parameters.useVertexTexture) {\r\n\r\n      identifiers.push('boneTexture');\r\n      identifiers.push('boneTextureWidth');\r\n      identifiers.push('boneTextureHeight');\r\n\r\n    }\r\n    else {\r\n\r\n      identifiers.push('boneGlobalMatrices');\r\n\r\n    }\r\n\r\n    if (parameters.logarithmicDepthBuffer) {\r\n\r\n      identifiers.push('logDepthBufFC');\r\n\r\n    }\r\n\r\n\r\n    for (var u in uniforms) {\r\n\r\n      identifiers.push(u);\r\n\r\n    }\r\n\r\n    this.uniforms = cacheUniformLocations(_gl, program, identifiers);\r\n\r\n    // cache attributes locations\r\n\r\n    identifiers = [\r\n\r\n      'position',\r\n      'normal',\r\n      'uv',\r\n      'uv2',\r\n      'tangent',\r\n      'color',\r\n      'skinIndex',\r\n      'skinWeight',\r\n      'lineDistance'\r\n\r\n    ];\r\n\r\n    for (var i = 0; i < parameters.maxMorphTargets; i++) {\r\n\r\n      identifiers.push('morphTarget' + i);\r\n\r\n    }\r\n\r\n    for (var i = 0; i < parameters.maxMorphNormals; i++) {\r\n\r\n      identifiers.push('morphNormal' + i);\r\n\r\n    }\r\n\r\n    for (var a in attributes) {\r\n\r\n      identifiers.push(a);\r\n\r\n    }\r\n\r\n    this.attributes = cacheAttributeLocations(_gl, program, identifiers);\r\n    this.attributesKeys = Object.keys(this.attributes);\r\n\r\n    //\r\n\r\n    this.id = programIdCount++;\r\n    this.code = code;\r\n    this.usedTimes = 1;\r\n    this.program = program;\r\n    this.vertexShader = glVertexShader;\r\n    this.fragmentShader = glFragmentShader;\r\n\r\n    return this;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = (function() {\r\n\r\n  var addLineNumbers = function(string) {\r\n\r\n    var lines = string.split('\\n');\r\n\r\n    for (var i = 0; i < lines.length; i++) {\r\n\r\n      lines[i] = (i + 1) + ': ' + lines[i];\r\n\r\n    }\r\n\r\n    return lines.join('\\n');\r\n\r\n  };\r\n\r\n  return function(gl, type, string) {\r\n\r\n    var shader = gl.createShader(type);\r\n\r\n    gl.shaderSource(shader, string);\r\n    gl.compileShader(shader);\r\n\r\n    if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) === false) {\r\n\r\n      THREE.error('THREE.WebGLShader: Shader couldn\\'t compile.');\r\n\r\n    }\r\n\r\n    if (gl.getShaderInfoLog(shader) !== '') {\r\n\r\n      THREE.warn('THREE.WebGLShader: gl.getShaderInfoLog()', gl.getShaderInfoLog(shader), addLineNumbers(string));\r\n\r\n    }\r\n\r\n    // --enable-privileged-webgl-extension\r\n    // console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n    return shader;\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLState = function(gl, paramThreeToGL) {\r\n\r\n  var newAttributes = new Uint8Array(16);\r\n  var enabledAttributes = new Uint8Array(16);\r\n\r\n  var currentBlending = null;\r\n  var currentBlendEquation = null;\r\n  var currentBlendSrc = null;\r\n  var currentBlendDst = null;\r\n  var currentBlendEquationAlpha = null;\r\n  var currentBlendSrcAlpha = null;\r\n  var currentBlendDstAlpha = null;\r\n\r\n  var currentDepthTest = null;\r\n  var currentDepthWrite = null;\r\n\r\n  var currentColorWrite = null;\r\n\r\n  var currentDoubleSided = null;\r\n  var currentFlipSided = null;\r\n\r\n  var currentLineWidth = null;\r\n\r\n  var currentPolygonOffset = null;\r\n  var currentPolygonOffsetFactor = null;\r\n  var currentPolygonOffsetUnits = null;\r\n\r\n  this.initAttributes = function() {\r\n\r\n    for (var i = 0, l = newAttributes.length; i < l; i++) {\r\n\r\n      newAttributes[i] = 0;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.enableAttribute = function(attribute) {\r\n\r\n    newAttributes[attribute] = 1;\r\n\r\n    if (enabledAttributes[attribute] === 0) {\r\n\r\n      gl.enableVertexAttribArray(attribute);\r\n      enabledAttributes[attribute] = 1;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.disableUnusedAttributes = function() {\r\n\r\n    for (var i = 0, l = enabledAttributes.length; i < l; i++) {\r\n\r\n      if (enabledAttributes[i] !== newAttributes[i]) {\r\n\r\n        gl.disableVertexAttribArray(i);\r\n        enabledAttributes[i] = 0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setBlending = function(blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha) {\r\n\r\n    if (blending !== currentBlending) {\r\n\r\n      if (blending === THREE.NoBlending) {\r\n\r\n        gl.disable(gl.BLEND);\r\n\r\n      }\r\n      else if (blending === THREE.AdditiveBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\r\n\r\n      }\r\n      else if (blending === THREE.SubtractiveBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.MultiplyBlending) {\r\n\r\n        // TODO: Find blendFuncSeparate() combination\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ZERO, gl.SRC_COLOR);\r\n\r\n      }\r\n      else if (blending === THREE.CustomBlending) {\r\n\r\n        gl.enable(gl.BLEND);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      }\r\n\r\n      currentBlending = blending;\r\n\r\n    }\r\n\r\n    if (blending === THREE.CustomBlending) {\r\n\r\n      blendEquationAlpha = blendEquationAlpha || blendEquation;\r\n      blendSrcAlpha = blendSrcAlpha || blendSrc;\r\n      blendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n      if (blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha) {\r\n\r\n        gl.blendEquationSeparate(paramThreeToGL(blendEquation), paramThreeToGL(blendEquationAlpha));\r\n\r\n        currentBlendEquation = blendEquation;\r\n        currentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n      }\r\n\r\n      if (blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha) {\r\n\r\n        gl.blendFuncSeparate(paramThreeToGL(blendSrc), paramThreeToGL(blendDst), paramThreeToGL(blendSrcAlpha), paramThreeToGL(blendDstAlpha));\r\n\r\n        currentBlendSrc = blendSrc;\r\n        currentBlendDst = blendDst;\r\n        currentBlendSrcAlpha = blendSrcAlpha;\r\n        currentBlendDstAlpha = blendDstAlpha;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      currentBlendEquation = null;\r\n      currentBlendSrc = null;\r\n      currentBlendDst = null;\r\n      currentBlendEquationAlpha = null;\r\n      currentBlendSrcAlpha = null;\r\n      currentBlendDstAlpha = null;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthTest = function(depthTest) {\r\n\r\n    if (currentDepthTest !== depthTest) {\r\n\r\n      if (depthTest) {\r\n\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n      }\r\n\r\n      currentDepthTest = depthTest;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDepthWrite = function(depthWrite) {\r\n\r\n    if (currentDepthWrite !== depthWrite) {\r\n\r\n      gl.depthMask(depthWrite);\r\n      currentDepthWrite = depthWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setColorWrite = function(colorWrite) {\r\n\r\n    if (currentColorWrite !== colorWrite) {\r\n\r\n      gl.colorMask(colorWrite, colorWrite, colorWrite, colorWrite);\r\n      currentColorWrite = colorWrite;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setDoubleSided = function(doubleSided) {\r\n\r\n    if (currentDoubleSided !== doubleSided) {\r\n\r\n      if (doubleSided) {\r\n\r\n        gl.disable(gl.CULL_FACE);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.enable(gl.CULL_FACE);\r\n\r\n      }\r\n\r\n      currentDoubleSided = doubleSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setFlipSided = function(flipSided) {\r\n\r\n    if (currentFlipSided !== flipSided) {\r\n\r\n      if (flipSided) {\r\n\r\n        gl.frontFace(gl.CW);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.frontFace(gl.CCW);\r\n\r\n      }\r\n\r\n      currentFlipSided = flipSided;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setLineWidth = function(width) {\r\n\r\n    if (width !== currentLineWidth) {\r\n\r\n      gl.lineWidth(width);\r\n\r\n      currentLineWidth = width;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.setPolygonOffset = function(polygonoffset, factor, units) {\r\n\r\n    if (currentPolygonOffset !== polygonoffset) {\r\n\r\n      if (polygonoffset) {\r\n\r\n        gl.enable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.disable(gl.POLYGON_OFFSET_FILL);\r\n\r\n      }\r\n\r\n      currentPolygonOffset = polygonoffset;\r\n\r\n    }\r\n\r\n    if (polygonoffset && (currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units)) {\r\n\r\n      gl.polygonOffset(factor, units);\r\n\r\n      currentPolygonOffsetFactor = factor;\r\n      currentPolygonOffsetUnits = units;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  this.reset = function() {\r\n\r\n    for (var i = 0; i < enabledAttributes.length; i++) {\r\n\r\n      enabledAttributes[i] = 0;\r\n\r\n    }\r\n\r\n    currentBlending = null;\r\n    currentDepthTest = null;\r\n    currentDepthWrite = null;\r\n    currentColorWrite = null;\r\n    currentDoubleSided = null;\r\n    currentFlipSided = null;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function(renderer, flares) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n  var hasVertexTexture;\r\n\r\n  var tempTexture, occlusionTexture;\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-1, -1, 0, 0,\r\n      1, -1, 1, 0,\r\n      1, 1, 1, 1, -1, 1, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    // buffers\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    // textures\r\n\r\n    tempTexture = gl.createTexture();\r\n    occlusionTexture = gl.createTexture();\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\r\n    hasVertexTexture = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;\r\n\r\n    var shader;\r\n\r\n    if (hasVertexTexture) {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"uniform sampler2D occlusionMap;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n          \"vVisibility =        visibility.r / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n          \"vVisibility *=       visibility.b / 9.0;\",\r\n          \"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n          \"varying float vVisibility;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * vVisibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n    else {\r\n\r\n      shader = {\r\n\r\n        vertexShader: [\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform vec3 screenPosition;\",\r\n          \"uniform vec2 scale;\",\r\n          \"uniform float rotation;\",\r\n\r\n          \"attribute vec2 position;\",\r\n          \"attribute vec2 uv;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          \"vUV = uv;\",\r\n\r\n          \"vec2 pos = position;\",\r\n\r\n          \"if( renderType == 2 ) {\",\r\n\r\n          \"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n          \"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n          \"}\",\r\n\r\n          \"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\"),\r\n\r\n        fragmentShader: [\r\n\r\n          \"precision mediump float;\",\r\n\r\n          \"uniform lowp int renderType;\",\r\n\r\n          \"uniform sampler2D map;\",\r\n          \"uniform sampler2D occlusionMap;\",\r\n          \"uniform float opacity;\",\r\n          \"uniform vec3 color;\",\r\n\r\n          \"varying vec2 vUV;\",\r\n\r\n          \"void main() {\",\r\n\r\n          // pink square\r\n\r\n          \"if( renderType == 0 ) {\",\r\n\r\n          \"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\r\n\r\n          // restore\r\n\r\n          \"} else if( renderType == 1 ) {\",\r\n\r\n          \"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n          // flare\r\n\r\n          \"} else {\",\r\n\r\n          \"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\r\n          \"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\r\n          \"visibility = ( 1.0 - visibility / 4.0 );\",\r\n\r\n          \"vec4 texture = texture2D( map, vUV );\",\r\n          \"texture.a *= opacity * visibility;\",\r\n          \"gl_FragColor = texture;\",\r\n          \"gl_FragColor.rgb *= color;\",\r\n\r\n          \"}\",\r\n\r\n          \"}\"\r\n\r\n        ].join(\"\\n\")\r\n\r\n      };\r\n\r\n    }\r\n\r\n    program = createProgram(shader);\r\n\r\n    attributes = {\r\n      vertex: gl.getAttribLocation(program, \"position\"),\r\n      uv: gl.getAttribLocation(program, \"uv\")\r\n    }\r\n\r\n    uniforms = {\r\n      renderType: gl.getUniformLocation(program, \"renderType\"),\r\n      map: gl.getUniformLocation(program, \"map\"),\r\n      occlusionMap: gl.getUniformLocation(program, \"occlusionMap\"),\r\n      opacity: gl.getUniformLocation(program, \"opacity\"),\r\n      color: gl.getUniformLocation(program, \"color\"),\r\n      scale: gl.getUniformLocation(program, \"scale\"),\r\n      rotation: gl.getUniformLocation(program, \"rotation\"),\r\n      screenPosition: gl.getUniformLocation(program, \"screenPosition\")\r\n    };\r\n\r\n  };\r\n\r\n  /*\r\n   * Render lens flares\r\n   * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n   *         reads these back and calculates occlusion.\r\n   */\r\n\r\n  this.render = function(scene, camera, viewportWidth, viewportHeight) {\r\n\r\n    if (flares.length === 0) return;\r\n\r\n    var tempPosition = new THREE.Vector3();\r\n\r\n    var invAspect = viewportHeight / viewportWidth,\r\n      halfViewportWidth = viewportWidth * 0.5,\r\n      halfViewportHeight = viewportHeight * 0.5;\r\n\r\n    var size = 16 / viewportHeight,\r\n      scale = new THREE.Vector2(size * invAspect, size);\r\n\r\n    var screenPosition = new THREE.Vector3(1, 1, 0),\r\n      screenPositionPixels = new THREE.Vector2(1, 1);\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.vertex);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    // loop through all lens flares to update their occlusion and positions\r\n    // setup gl and common used attribs/unforms\r\n\r\n    gl.uniform1i(uniforms.occlusionMap, 0);\r\n    gl.uniform1i(uniforms.map, 1);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.depthMask(false);\r\n\r\n    for (var i = 0, l = flares.length; i < l; i++) {\r\n\r\n      size = 16 / viewportHeight;\r\n      scale.set(size * invAspect, size);\r\n\r\n      // calc object screen position\r\n\r\n      var flare = flares[i];\r\n\r\n      tempPosition.set(flare.matrixWorld.elements[12], flare.matrixWorld.elements[13], flare.matrixWorld.elements[14]);\r\n\r\n      tempPosition.applyMatrix4(camera.matrixWorldInverse);\r\n      tempPosition.applyProjection(camera.projectionMatrix);\r\n\r\n      // setup arrays for gl programs\r\n\r\n      screenPosition.copy(tempPosition)\r\n\r\n      screenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\r\n      screenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\r\n\r\n      // screen cull\r\n\r\n      if (hasVertexTexture || (\r\n          screenPositionPixels.x > 0 &&\r\n          screenPositionPixels.x < viewportWidth &&\r\n          screenPositionPixels.y > 0 &&\r\n          screenPositionPixels.y < viewportHeight)) {\r\n\r\n        // save current RGB to temp texture\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // render pink quad\r\n\r\n        gl.uniform1i(uniforms.renderType, 0);\r\n        gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n        gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n\r\n        gl.disable(gl.BLEND);\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // copy result to occlusionMap\r\n\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, occlusionTexture);\r\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0);\r\n\r\n\r\n        // restore graphics\r\n\r\n        gl.uniform1i(uniforms.renderType, 1);\r\n        gl.disable(gl.DEPTH_TEST);\r\n\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, tempTexture);\r\n        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n\r\n        // update object positions\r\n\r\n        flare.positionScreen.copy(screenPosition)\r\n\r\n        if (flare.customUpdateCallback) {\r\n\r\n          flare.customUpdateCallback(flare);\r\n\r\n        }\r\n        else {\r\n\r\n          flare.updateLensFlares();\r\n\r\n        }\r\n\r\n        // render flares\r\n\r\n        gl.uniform1i(uniforms.renderType, 2);\r\n        gl.enable(gl.BLEND);\r\n\r\n        for (var j = 0, jl = flare.lensFlares.length; j < jl; j++) {\r\n\r\n          var sprite = flare.lensFlares[j];\r\n\r\n          if (sprite.opacity > 0.001 && sprite.scale > 0.001) {\r\n\r\n            screenPosition.x = sprite.x;\r\n            screenPosition.y = sprite.y;\r\n            screenPosition.z = sprite.z;\r\n\r\n            size = sprite.size * sprite.scale / viewportHeight;\r\n\r\n            scale.x = size * invAspect;\r\n            scale.y = size;\r\n\r\n            gl.uniform3f(uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z);\r\n            gl.uniform2f(uniforms.scale, scale.x, scale.y);\r\n            gl.uniform1f(uniforms.rotation, sprite.rotation);\r\n\r\n            gl.uniform1f(uniforms.opacity, sprite.opacity);\r\n            gl.uniform3f(uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b);\r\n\r\n            renderer.state.setBlending(sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst);\r\n            renderer.setTexture(sprite.texture, 1);\r\n\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.enable(gl.DEPTH_TEST);\r\n    gl.depthMask(true);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram(shader) {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n\r\n    var prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n    gl.shaderSource(fragmentShader, prefix + shader.fragmentShader);\r\n    gl.shaderSource(vertexShader, prefix + shader.vertexShader);\r\n\r\n    gl.compileShader(fragmentShader);\r\n    gl.compileShader(vertexShader);\r\n\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.attachShader(program, vertexShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/ShadowMapPlugin.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ShadowMapPlugin = function(_renderer, _lights, _webglObjects, _webglObjectsImmediate) {\r\n\r\n  var _gl = _renderer.context;\r\n\r\n  var _depthMaterial, _depthMaterialMorph, _depthMaterialSkin, _depthMaterialMorphSkin,\r\n\r\n    _frustum = new THREE.Frustum(),\r\n    _projScreenMatrix = new THREE.Matrix4(),\r\n\r\n    _min = new THREE.Vector3(),\r\n    _max = new THREE.Vector3(),\r\n\r\n    _matrixPosition = new THREE.Vector3(),\r\n\r\n    _renderList = [];\r\n\r\n  // init\r\n\r\n  var depthShader = THREE.ShaderLib[\"depthRGBA\"];\r\n  var depthUniforms = THREE.UniformsUtils.clone(depthShader.uniforms);\r\n\r\n  _depthMaterial = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader\r\n  });\r\n\r\n  _depthMaterialMorph = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true\r\n  });\r\n\r\n  _depthMaterialSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterialMorphSkin = new THREE.ShaderMaterial({\r\n    uniforms: depthUniforms,\r\n    vertexShader: depthShader.vertexShader,\r\n    fragmentShader: depthShader.fragmentShader,\r\n    morphTargets: true,\r\n    skinning: true\r\n  });\r\n\r\n  _depthMaterial._shadowPass = true;\r\n  _depthMaterialMorph._shadowPass = true;\r\n  _depthMaterialSkin._shadowPass = true;\r\n  _depthMaterialMorphSkin._shadowPass = true;\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (_renderer.shadowMapEnabled === false) return;\r\n\r\n    var i, il, j, jl, n,\r\n\r\n      shadowMap, shadowMatrix, shadowCamera,\r\n      buffer, material,\r\n      webglObject, object, light,\r\n\r\n      lights = [],\r\n      k = 0,\r\n\r\n      fog = null;\r\n\r\n    // set GL state for depth map\r\n\r\n    _gl.clearColor(1, 1, 1, 1);\r\n    _gl.disable(_gl.BLEND);\r\n\r\n    _gl.enable(_gl.CULL_FACE);\r\n    _gl.frontFace(_gl.CCW);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.FRONT);\r\n\r\n    }\r\n    else {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.state.setDepthTest(true);\r\n\r\n    // preprocess lights\r\n    // \t- skip lights that are not casting shadows\r\n    //\t- create virtual lights for cascaded shadow maps\r\n\r\n    for (i = 0, il = _lights.length; i < il; i++) {\r\n\r\n      light = _lights[i];\r\n\r\n      if (!light.castShadow) continue;\r\n\r\n      if ((light instanceof THREE.DirectionalLight) && light.shadowCascade) {\r\n\r\n        for (n = 0; n < light.shadowCascadeCount; n++) {\r\n\r\n          var virtualLight;\r\n\r\n          if (!light.shadowCascadeArray[n]) {\r\n\r\n            virtualLight = createVirtualLight(light, n);\r\n            virtualLight.originalCamera = camera;\r\n\r\n            var gyro = new THREE.Gyroscope();\r\n            gyro.position.copy(light.shadowCascadeOffset);\r\n\r\n            gyro.add(virtualLight);\r\n            gyro.add(virtualLight.target);\r\n\r\n            camera.add(gyro);\r\n\r\n            light.shadowCascadeArray[n] = virtualLight;\r\n\r\n            //console.log( \"Created virtualLight\", virtualLight );\r\n\r\n          }\r\n          else {\r\n\r\n            virtualLight = light.shadowCascadeArray[n];\r\n\r\n          }\r\n\r\n          updateVirtualLight(light, n);\r\n\r\n          lights[k] = virtualLight;\r\n          k++;\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n\r\n        lights[k] = light;\r\n        k++;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // render depth map\r\n\r\n    for (i = 0, il = lights.length; i < il; i++) {\r\n\r\n      light = lights[i];\r\n\r\n      if (!light.shadowMap) {\r\n\r\n        var shadowFilter = THREE.LinearFilter;\r\n\r\n        if (_renderer.shadowMapType === THREE.PCFSoftShadowMap) {\r\n\r\n          shadowFilter = THREE.NearestFilter;\r\n\r\n        }\r\n\r\n        var pars = {\r\n          minFilter: shadowFilter,\r\n          magFilter: shadowFilter,\r\n          format: THREE.RGBAFormat\r\n        };\r\n\r\n        light.shadowMap = new THREE.WebGLRenderTarget(light.shadowMapWidth, light.shadowMapHeight, pars);\r\n        light.shadowMapSize = new THREE.Vector2(light.shadowMapWidth, light.shadowMapHeight);\r\n\r\n        light.shadowMatrix = new THREE.Matrix4();\r\n\r\n      }\r\n\r\n      if (!light.shadowCamera) {\r\n\r\n        if (light instanceof THREE.SpotLight) {\r\n\r\n          light.shadowCamera = new THREE.PerspectiveCamera(light.shadowCameraFov, light.shadowMapWidth / light.shadowMapHeight, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else if (light instanceof THREE.DirectionalLight) {\r\n\r\n          light.shadowCamera = new THREE.OrthographicCamera(light.shadowCameraLeft, light.shadowCameraRight, light.shadowCameraTop, light.shadowCameraBottom, light.shadowCameraNear, light.shadowCameraFar);\r\n\r\n        }\r\n        else {\r\n\r\n          THREE.error(\"THREE.ShadowMapPlugin: Unsupported light type for shadow\", light);\r\n          continue;\r\n\r\n        }\r\n\r\n        scene.add(light.shadowCamera);\r\n\r\n        if (scene.autoUpdate === true) scene.updateMatrixWorld();\r\n\r\n      }\r\n\r\n      if (light.shadowCameraVisible && !light.cameraHelper) {\r\n\r\n        light.cameraHelper = new THREE.CameraHelper(light.shadowCamera);\r\n        scene.add(light.cameraHelper);\r\n\r\n      }\r\n\r\n      if (light.isVirtual && virtualLight.originalCamera == camera) {\r\n\r\n        updateShadowCamera(camera, light);\r\n\r\n      }\r\n\r\n      shadowMap = light.shadowMap;\r\n      shadowMatrix = light.shadowMatrix;\r\n      shadowCamera = light.shadowCamera;\r\n\r\n      //\r\n\r\n      shadowCamera.position.setFromMatrixPosition(light.matrixWorld);\r\n      _matrixPosition.setFromMatrixPosition(light.target.matrixWorld);\r\n      shadowCamera.lookAt(_matrixPosition);\r\n      shadowCamera.updateMatrixWorld();\r\n\r\n      shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld);\r\n\r\n      //\r\n\r\n      if (light.cameraHelper) light.cameraHelper.visible = light.shadowCameraVisible;\r\n      if (light.shadowCameraVisible) light.cameraHelper.update();\r\n\r\n      // compute shadow matrix\r\n\r\n      shadowMatrix.set(\r\n        0.5, 0.0, 0.0, 0.5,\r\n        0.0, 0.5, 0.0, 0.5,\r\n        0.0, 0.0, 0.5, 0.5,\r\n        0.0, 0.0, 0.0, 1.0\r\n      );\r\n\r\n      shadowMatrix.multiply(shadowCamera.projectionMatrix);\r\n      shadowMatrix.multiply(shadowCamera.matrixWorldInverse);\r\n\r\n      // update camera matrices and frustum\r\n\r\n      _projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse);\r\n      _frustum.setFromMatrix(_projScreenMatrix);\r\n\r\n      // render shadow map\r\n\r\n      _renderer.setRenderTarget(shadowMap);\r\n      _renderer.clear();\r\n\r\n      // set object matrices & frustum culling\r\n\r\n      _renderList.length = 0;\r\n\r\n      projectObject(scene, scene, shadowCamera);\r\n\r\n\r\n      // render regular objects\r\n\r\n      var objectMaterial, useMorphing, useSkinning;\r\n\r\n      for (j = 0, jl = _renderList.length; j < jl; j++) {\r\n\r\n        webglObject = _renderList[j];\r\n\r\n        object = webglObject.object;\r\n        buffer = webglObject.buffer;\r\n\r\n        // culling is overriden globally for all objects\r\n        // while rendering depth map\r\n\r\n        // need to deal with MeshFaceMaterial somehow\r\n        // in that case just use the first of material.materials for now\r\n        // (proper solution would require to break objects by materials\r\n        //  similarly to regular rendering and then set corresponding\r\n        //  depth materials per each chunk instead of just once per object)\r\n\r\n        objectMaterial = getObjectMaterial(object);\r\n\r\n        useMorphing = object.geometry.morphTargets !== undefined && object.geometry.morphTargets.length > 0 && objectMaterial.morphTargets;\r\n        useSkinning = object instanceof THREE.SkinnedMesh && objectMaterial.skinning;\r\n\r\n        if (object.customDepthMaterial) {\r\n\r\n          material = object.customDepthMaterial;\r\n\r\n        }\r\n        else if (useSkinning) {\r\n\r\n          material = useMorphing ? _depthMaterialMorphSkin : _depthMaterialSkin;\r\n\r\n        }\r\n        else if (useMorphing) {\r\n\r\n          material = _depthMaterialMorph;\r\n\r\n        }\r\n        else {\r\n\r\n          material = _depthMaterial;\r\n\r\n        }\r\n\r\n        _renderer.setMaterialFaces(objectMaterial);\r\n\r\n        if (buffer instanceof THREE.BufferGeometry) {\r\n\r\n          _renderer.renderBufferDirect(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n        else {\r\n\r\n          _renderer.renderBuffer(shadowCamera, _lights, fog, material, buffer, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // set matrices and render immediate objects\r\n\r\n      for (j = 0, jl = _webglObjectsImmediate.length; j < jl; j++) {\r\n\r\n        webglObject = _webglObjectsImmediate[j];\r\n        object = webglObject.object;\r\n\r\n        if (object.visible && object.castShadow) {\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n\r\n          _renderer.renderImmediateObject(shadowCamera, _lights, fog, _depthMaterial, object);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // restore GL state\r\n\r\n    var clearColor = _renderer.getClearColor(),\r\n      clearAlpha = _renderer.getClearAlpha();\r\n\r\n    _gl.clearColor(clearColor.r, clearColor.g, clearColor.b, clearAlpha);\r\n    _gl.enable(_gl.BLEND);\r\n\r\n    if (_renderer.shadowMapCullFace === THREE.CullFaceFront) {\r\n\r\n      _gl.cullFace(_gl.BACK);\r\n\r\n    }\r\n\r\n    _renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function projectObject(scene, object, shadowCamera) {\r\n\r\n    if (object.visible) {\r\n\r\n      var webglObjects = _webglObjects[object.id];\r\n\r\n      if (webglObjects && object.castShadow && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)) {\r\n\r\n        for (var i = 0, l = webglObjects.length; i < l; i++) {\r\n\r\n          var webglObject = webglObjects[i];\r\n\r\n          object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse, object.matrixWorld);\r\n          _renderList.push(webglObject);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var i = 0, l = object.children.length; i < l; i++) {\r\n\r\n        projectObject(scene, object.children[i], shadowCamera);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function createVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = new THREE.DirectionalLight();\r\n\r\n    virtualLight.isVirtual = true;\r\n\r\n    virtualLight.onlyShadow = true;\r\n    virtualLight.castShadow = true;\r\n\r\n    virtualLight.shadowCameraNear = light.shadowCameraNear;\r\n    virtualLight.shadowCameraFar = light.shadowCameraFar;\r\n\r\n    virtualLight.shadowCameraLeft = light.shadowCameraLeft;\r\n    virtualLight.shadowCameraRight = light.shadowCameraRight;\r\n    virtualLight.shadowCameraBottom = light.shadowCameraBottom;\r\n    virtualLight.shadowCameraTop = light.shadowCameraTop;\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n    virtualLight.shadowMapWidth = light.shadowCascadeWidth[cascade];\r\n    virtualLight.shadowMapHeight = light.shadowCascadeHeight[cascade];\r\n\r\n    virtualLight.pointsWorld = [];\r\n    virtualLight.pointsFrustum = [];\r\n\r\n    var pointsWorld = virtualLight.pointsWorld,\r\n      pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      pointsWorld[i] = new THREE.Vector3();\r\n      pointsFrustum[i] = new THREE.Vector3();\r\n\r\n    }\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    pointsFrustum[0].set(-1, -1, nearZ);\r\n    pointsFrustum[1].set(1, -1, nearZ);\r\n    pointsFrustum[2].set(-1, 1, nearZ);\r\n    pointsFrustum[3].set(1, 1, nearZ);\r\n\r\n    pointsFrustum[4].set(-1, -1, farZ);\r\n    pointsFrustum[5].set(1, -1, farZ);\r\n    pointsFrustum[6].set(-1, 1, farZ);\r\n    pointsFrustum[7].set(1, 1, farZ);\r\n\r\n    return virtualLight;\r\n\r\n  }\r\n\r\n  // Synchronize virtual light with the original light\r\n\r\n  function updateVirtualLight(light, cascade) {\r\n\r\n    var virtualLight = light.shadowCascadeArray[cascade];\r\n\r\n    virtualLight.position.copy(light.position);\r\n    virtualLight.target.position.copy(light.target.position);\r\n    virtualLight.lookAt(virtualLight.target);\r\n\r\n    virtualLight.shadowCameraVisible = light.shadowCameraVisible;\r\n    virtualLight.shadowDarkness = light.shadowDarkness;\r\n\r\n    virtualLight.shadowBias = light.shadowCascadeBias[cascade];\r\n\r\n    var nearZ = light.shadowCascadeNearZ[cascade];\r\n    var farZ = light.shadowCascadeFarZ[cascade];\r\n\r\n    var pointsFrustum = virtualLight.pointsFrustum;\r\n\r\n    pointsFrustum[0].z = nearZ;\r\n    pointsFrustum[1].z = nearZ;\r\n    pointsFrustum[2].z = nearZ;\r\n    pointsFrustum[3].z = nearZ;\r\n\r\n    pointsFrustum[4].z = farZ;\r\n    pointsFrustum[5].z = farZ;\r\n    pointsFrustum[6].z = farZ;\r\n    pointsFrustum[7].z = farZ;\r\n\r\n  }\r\n\r\n  // Fit shadow camera's ortho frustum to camera frustum\r\n\r\n  function updateShadowCamera(camera, light) {\r\n\r\n    var shadowCamera = light.shadowCamera,\r\n      pointsFrustum = light.pointsFrustum,\r\n      pointsWorld = light.pointsWorld;\r\n\r\n    _min.set(Infinity, Infinity, Infinity);\r\n    _max.set(-Infinity, -Infinity, -Infinity);\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n\r\n      var p = pointsWorld[i];\r\n\r\n      p.copy(pointsFrustum[i]);\r\n      p.unproject(camera);\r\n\r\n      p.applyMatrix4(shadowCamera.matrixWorldInverse);\r\n\r\n      if (p.x < _min.x) _min.x = p.x;\r\n      if (p.x > _max.x) _max.x = p.x;\r\n\r\n      if (p.y < _min.y) _min.y = p.y;\r\n      if (p.y > _max.y) _max.y = p.y;\r\n\r\n      if (p.z < _min.z) _min.z = p.z;\r\n      if (p.z > _max.z) _max.z = p.z;\r\n\r\n    }\r\n\r\n    shadowCamera.left = _min.x;\r\n    shadowCamera.right = _max.x;\r\n    shadowCamera.top = _max.y;\r\n    shadowCamera.bottom = _min.y;\r\n\r\n    // can't really fit near/far\r\n    //shadowCamera.near = _min.z;\r\n    //shadowCamera.far = _max.z;\r\n\r\n    shadowCamera.updateProjectionMatrix();\r\n\r\n  }\r\n\r\n  // For the moment just ignore objects that have multiple materials with different animation methods\r\n  // Only the first material will be taken into account for deciding which depth material to use for shadow maps\r\n\r\n  function getObjectMaterial(object) {\r\n\r\n    return object.material instanceof THREE.MeshFaceMaterial ? object.material.materials[0] : object.material;\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function(renderer, sprites) {\r\n\r\n  var gl = renderer.context;\r\n\r\n  var vertexBuffer, elementBuffer;\r\n  var program, attributes, uniforms;\r\n\r\n  var texture;\r\n\r\n  // decompose matrixWorld\r\n\r\n  var spritePosition = new THREE.Vector3();\r\n  var spriteRotation = new THREE.Quaternion();\r\n  var spriteScale = new THREE.Vector3();\r\n\r\n  var init = function() {\r\n\r\n    var vertices = new Float32Array([-0.5, -0.5, 0, 0,\r\n      0.5, -0.5, 1, 0,\r\n      0.5, 0.5, 1, 1, -0.5, 0.5, 0, 1\r\n    ]);\r\n\r\n    var faces = new Uint16Array([\r\n      0, 1, 2,\r\n      0, 2, 3\r\n    ]);\r\n\r\n    vertexBuffer = gl.createBuffer();\r\n    elementBuffer = gl.createBuffer();\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW);\r\n\r\n    program = createProgram();\r\n\r\n    attributes = {\r\n      position: gl.getAttribLocation(program, 'position'),\r\n      uv: gl.getAttribLocation(program, 'uv')\r\n    };\r\n\r\n    uniforms = {\r\n      uvOffset: gl.getUniformLocation(program, 'uvOffset'),\r\n      uvScale: gl.getUniformLocation(program, 'uvScale'),\r\n\r\n      rotation: gl.getUniformLocation(program, 'rotation'),\r\n      scale: gl.getUniformLocation(program, 'scale'),\r\n\r\n      color: gl.getUniformLocation(program, 'color'),\r\n      map: gl.getUniformLocation(program, 'map'),\r\n      opacity: gl.getUniformLocation(program, 'opacity'),\r\n\r\n      modelViewMatrix: gl.getUniformLocation(program, 'modelViewMatrix'),\r\n      projectionMatrix: gl.getUniformLocation(program, 'projectionMatrix'),\r\n\r\n      fogType: gl.getUniformLocation(program, 'fogType'),\r\n      fogDensity: gl.getUniformLocation(program, 'fogDensity'),\r\n      fogNear: gl.getUniformLocation(program, 'fogNear'),\r\n      fogFar: gl.getUniformLocation(program, 'fogFar'),\r\n      fogColor: gl.getUniformLocation(program, 'fogColor'),\r\n\r\n      alphaTest: gl.getUniformLocation(program, 'alphaTest')\r\n    };\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 8;\r\n    canvas.height = 8;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.fillStyle = 'white';\r\n    context.fillRect(0, 0, 8, 8);\r\n\r\n    texture = new THREE.Texture(canvas);\r\n    texture.needsUpdate = true;\r\n\r\n  };\r\n\r\n  this.render = function(scene, camera) {\r\n\r\n    if (sprites.length === 0) return;\r\n\r\n    // setup gl\r\n\r\n    if (program === undefined) {\r\n\r\n      init();\r\n\r\n    }\r\n\r\n    gl.useProgram(program);\r\n\r\n    gl.enableVertexAttribArray(attributes.position);\r\n    gl.enableVertexAttribArray(attributes.uv);\r\n\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.enable(gl.BLEND);\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.vertexAttribPointer(attributes.position, 2, gl.FLOAT, false, 2 * 8, 0);\r\n    gl.vertexAttribPointer(attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8);\r\n\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);\r\n\r\n    gl.uniformMatrix4fv(uniforms.projectionMatrix, false, camera.projectionMatrix.elements);\r\n\r\n    gl.activeTexture(gl.TEXTURE0);\r\n    gl.uniform1i(uniforms.map, 0);\r\n\r\n    var oldFogType = 0;\r\n    var sceneFogType = 0;\r\n    var fog = scene.fog;\r\n\r\n    if (fog) {\r\n\r\n      gl.uniform3f(uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b);\r\n\r\n      if (fog instanceof THREE.Fog) {\r\n\r\n        gl.uniform1f(uniforms.fogNear, fog.near);\r\n        gl.uniform1f(uniforms.fogFar, fog.far);\r\n\r\n        gl.uniform1i(uniforms.fogType, 1);\r\n        oldFogType = 1;\r\n        sceneFogType = 1;\r\n\r\n      }\r\n      else if (fog instanceof THREE.FogExp2) {\r\n\r\n        gl.uniform1f(uniforms.fogDensity, fog.density);\r\n\r\n        gl.uniform1i(uniforms.fogType, 2);\r\n        oldFogType = 2;\r\n        sceneFogType = 2;\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      gl.uniform1i(uniforms.fogType, 0);\r\n      oldFogType = 0;\r\n      sceneFogType = 0;\r\n\r\n    }\r\n\r\n\r\n    // update positions and sort\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n\r\n      sprite._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse, sprite.matrixWorld);\r\n      sprite.z = -sprite._modelViewMatrix.elements[14];\r\n\r\n    }\r\n\r\n    sprites.sort(painterSortStable);\r\n\r\n    // render all sprites\r\n\r\n    var scale = [];\r\n\r\n    for (var i = 0, l = sprites.length; i < l; i++) {\r\n\r\n      var sprite = sprites[i];\r\n      var material = sprite.material;\r\n\r\n      gl.uniform1f(uniforms.alphaTest, material.alphaTest);\r\n      gl.uniformMatrix4fv(uniforms.modelViewMatrix, false, sprite._modelViewMatrix.elements);\r\n\r\n      sprite.matrixWorld.decompose(spritePosition, spriteRotation, spriteScale);\r\n\r\n      scale[0] = spriteScale.x;\r\n      scale[1] = spriteScale.y;\r\n\r\n      var fogType = 0;\r\n\r\n      if (scene.fog && material.fog) {\r\n\r\n        fogType = sceneFogType;\r\n\r\n      }\r\n\r\n      if (oldFogType !== fogType) {\r\n\r\n        gl.uniform1i(uniforms.fogType, fogType);\r\n        oldFogType = fogType;\r\n\r\n      }\r\n\r\n      if (material.map !== null) {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, material.map.offset.x, material.map.offset.y);\r\n        gl.uniform2f(uniforms.uvScale, material.map.repeat.x, material.map.repeat.y);\r\n\r\n      }\r\n      else {\r\n\r\n        gl.uniform2f(uniforms.uvOffset, 0, 0);\r\n        gl.uniform2f(uniforms.uvScale, 1, 1);\r\n\r\n      }\r\n\r\n      gl.uniform1f(uniforms.opacity, material.opacity);\r\n      gl.uniform3f(uniforms.color, material.color.r, material.color.g, material.color.b);\r\n\r\n      gl.uniform1f(uniforms.rotation, material.rotation);\r\n      gl.uniform2fv(uniforms.scale, scale);\r\n\r\n      renderer.state.setBlending(material.blending, material.blendEquation, material.blendSrc, material.blendDst);\r\n      renderer.state.setDepthTest(material.depthTest);\r\n      renderer.state.setDepthWrite(material.depthWrite);\r\n\r\n      if (material.map && material.map.image && material.map.image.width) {\r\n\r\n        renderer.setTexture(material.map, 0);\r\n\r\n      }\r\n      else {\r\n\r\n        renderer.setTexture(texture, 0);\r\n\r\n      }\r\n\r\n      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n\r\n    }\r\n\r\n    // restore gl\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n\r\n    renderer.resetGLState();\r\n\r\n  };\r\n\r\n  function createProgram() {\r\n\r\n    var program = gl.createProgram();\r\n\r\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n\r\n    gl.shaderSource(vertexShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform mat4 modelViewMatrix;',\r\n      'uniform mat4 projectionMatrix;',\r\n      'uniform float rotation;',\r\n      'uniform vec2 scale;',\r\n      'uniform vec2 uvOffset;',\r\n      'uniform vec2 uvScale;',\r\n\r\n      'attribute vec2 position;',\r\n      'attribute vec2 uv;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vUV = uvOffset + uv * uvScale;',\r\n\r\n      'vec2 alignedPosition = position * scale;',\r\n\r\n      'vec2 rotatedPosition;',\r\n      'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n      'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n      'vec4 finalPosition;',\r\n\r\n      'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n      'finalPosition.xy += rotatedPosition;',\r\n      'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n      'gl_Position = finalPosition;',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.shaderSource(fragmentShader, [\r\n\r\n      'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n      'uniform vec3 color;',\r\n      'uniform sampler2D map;',\r\n      'uniform float opacity;',\r\n\r\n      'uniform int fogType;',\r\n      'uniform vec3 fogColor;',\r\n      'uniform float fogDensity;',\r\n      'uniform float fogNear;',\r\n      'uniform float fogFar;',\r\n      'uniform float alphaTest;',\r\n\r\n      'varying vec2 vUV;',\r\n\r\n      'void main() {',\r\n\r\n      'vec4 texture = texture2D( map, vUV );',\r\n\r\n      'if ( texture.a < alphaTest ) discard;',\r\n\r\n      'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n      'if ( fogType > 0 ) {',\r\n\r\n      'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n      'float fogFactor = 0.0;',\r\n\r\n      'if ( fogType == 1 ) {',\r\n\r\n      'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n      '} else {',\r\n\r\n      'const float LOG2 = 1.442695;',\r\n      'float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n      'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n      '}',\r\n\r\n      'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n      '}',\r\n\r\n      '}'\r\n\r\n    ].join('\\n'));\r\n\r\n    gl.compileShader(vertexShader);\r\n    gl.compileShader(fragmentShader);\r\n\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n\r\n    gl.linkProgram(program);\r\n\r\n    return program;\r\n\r\n  };\r\n\r\n  function painterSortStable(a, b) {\r\n\r\n    if (a.z !== b.z) {\r\n\r\n      return b.z - a.z;\r\n\r\n    }\r\n    else {\r\n\r\n      return b.id - a.id;\r\n\r\n    }\r\n\r\n  };\r\n\r\n};\r\n\r\n// File:src/extras/GeometryUtils.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n  merge: function(geometry1, geometry2, materialIndexOffset) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');\r\n\r\n    var matrix;\r\n\r\n    if (geometry2 instanceof THREE.Mesh) {\r\n\r\n      geometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n      matrix = geometry2.matrix;\r\n      geometry2 = geometry2.geometry;\r\n\r\n    }\r\n\r\n    geometry1.merge(geometry2, matrix, materialIndexOffset);\r\n\r\n  },\r\n\r\n  center: function(geometry) {\r\n\r\n    THREE.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.');\r\n    return geometry.center();\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/ImageUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Daosheng Mu / https://github.com/DaoshengMu/\r\n */\r\n\r\nTHREE.ImageUtils = {\r\n\r\n  crossOrigin: undefined,\r\n\r\n  loadTexture: function(url, mapping, onLoad, onError) {\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.Texture(undefined, mapping);\r\n\r\n    loader.load(url, function(image) {\r\n\r\n      texture.image = image;\r\n      texture.needsUpdate = true;\r\n\r\n      if (onLoad) onLoad(texture);\r\n\r\n    }, undefined, function(event) {\r\n\r\n      if (onError) onError(event);\r\n\r\n    });\r\n\r\n    texture.sourceFile = url;\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadTextureCube: function(array, mapping, onLoad, onError) {\r\n\r\n    var images = [];\r\n\r\n    var loader = new THREE.ImageLoader();\r\n    loader.crossOrigin = this.crossOrigin;\r\n\r\n    var texture = new THREE.CubeTexture(images, mapping);\r\n\r\n    // no flipping needed for cube textures\r\n\r\n    texture.flipY = false;\r\n\r\n    var loaded = 0;\r\n\r\n    var loadTexture = function(i) {\r\n\r\n      loader.load(array[i], function(image) {\r\n\r\n        texture.images[i] = image;\r\n\r\n        loaded += 1;\r\n\r\n        if (loaded === 6) {\r\n\r\n          texture.needsUpdate = true;\r\n\r\n          if (onLoad) onLoad(texture);\r\n\r\n        }\r\n\r\n      }, undefined, onError);\r\n\r\n    }\r\n\r\n    for (var i = 0, il = array.length; i < il; ++i) {\r\n\r\n      loadTexture(i);\r\n\r\n    }\r\n\r\n    return texture;\r\n\r\n  },\r\n\r\n  loadCompressedTexture: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  loadCompressedTextureCube: function() {\r\n\r\n    THREE.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')\r\n\r\n  },\r\n\r\n  getNormalMap: function(image, depth) {\r\n\r\n    // Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\r\n\r\n    var cross = function(a, b) {\r\n\r\n      return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\r\n\r\n    }\r\n\r\n    var subtract = function(a, b) {\r\n\r\n      return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\r\n\r\n    }\r\n\r\n    var normalize = function(a) {\r\n\r\n      var l = Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2]);\r\n      return [a[0] / l, a[1] / l, a[2] / l];\r\n\r\n    }\r\n\r\n    depth = depth | 1;\r\n\r\n    var width = image.width;\r\n    var height = image.height;\r\n\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    var context = canvas.getContext('2d');\r\n    context.drawImage(image, 0, 0);\r\n\r\n    var data = context.getImageData(0, 0, width, height).data;\r\n    var imageData = context.createImageData(width, height);\r\n    var output = imageData.data;\r\n\r\n    for (var x = 0; x < width; x++) {\r\n\r\n      for (var y = 0; y < height; y++) {\r\n\r\n        var ly = y - 1 < 0 ? 0 : y - 1;\r\n        var uy = y + 1 > height - 1 ? height - 1 : y + 1;\r\n        var lx = x - 1 < 0 ? 0 : x - 1;\r\n        var ux = x + 1 > width - 1 ? width - 1 : x + 1;\r\n\r\n        var points = [];\r\n        var origin = [0, 0, data[(y * width + x) * 4] / 255 * depth];\r\n        points.push([-1, 0, data[(y * width + lx) * 4] / 255 * depth]);\r\n        points.push([-1, -1, data[(ly * width + lx) * 4] / 255 * depth]);\r\n        points.push([0, -1, data[(ly * width + x) * 4] / 255 * depth]);\r\n        points.push([1, -1, data[(ly * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 0, data[(y * width + ux) * 4] / 255 * depth]);\r\n        points.push([1, 1, data[(uy * width + ux) * 4] / 255 * depth]);\r\n        points.push([0, 1, data[(uy * width + x) * 4] / 255 * depth]);\r\n        points.push([-1, 1, data[(uy * width + lx) * 4] / 255 * depth]);\r\n\r\n        var normals = [];\r\n        var num_points = points.length;\r\n\r\n        for (var i = 0; i < num_points; i++) {\r\n\r\n          var v1 = points[i];\r\n          var v2 = points[(i + 1) % num_points];\r\n          v1 = subtract(v1, origin);\r\n          v2 = subtract(v2, origin);\r\n          normals.push(normalize(cross(v1, v2)));\r\n\r\n        }\r\n\r\n        var normal = [0, 0, 0];\r\n\r\n        for (var i = 0; i < normals.length; i++) {\r\n\r\n          normal[0] += normals[i][0];\r\n          normal[1] += normals[i][1];\r\n          normal[2] += normals[i][2];\r\n\r\n        }\r\n\r\n        normal[0] /= normals.length;\r\n        normal[1] /= normals.length;\r\n        normal[2] /= normals.length;\r\n\r\n        var idx = (y * width + x) * 4;\r\n\r\n        output[idx] = ((normal[0] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 1] = ((normal[1] + 1.0) / 2.0 * 255) | 0;\r\n        output[idx + 2] = (normal[2] * 255) | 0;\r\n        output[idx + 3] = 255;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    return canvas;\r\n\r\n  },\r\n\r\n  generateDataTexture: function(width, height, color) {\r\n\r\n    var size = width * height;\r\n    var data = new Uint8Array(3 * size);\r\n\r\n    var r = Math.floor(color.r * 255);\r\n    var g = Math.floor(color.g * 255);\r\n    var b = Math.floor(color.b * 255);\r\n\r\n    for (var i = 0; i < size; i++) {\r\n\r\n      data[i * 3] = r;\r\n      data[i * 3 + 1] = g;\r\n      data[i * 3 + 2] = b;\r\n\r\n    }\r\n\r\n    var texture = new THREE.DataTexture(data, width, height, THREE.RGBFormat);\r\n    texture.needsUpdate = true;\r\n\r\n    return texture;\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n  createMultiMaterialObject: function(geometry, materials) {\r\n\r\n    var group = new THREE.Object3D();\r\n\r\n    for (var i = 0, l = materials.length; i < l; i++) {\r\n\r\n      group.add(new THREE.Mesh(geometry, materials[i]));\r\n\r\n    }\r\n\r\n    return group;\r\n\r\n  },\r\n\r\n  detach: function(child, parent, scene) {\r\n\r\n    child.applyMatrix(parent.matrixWorld);\r\n    parent.remove(child);\r\n    scene.add(child);\r\n\r\n  },\r\n\r\n  attach: function(child, scene, parent) {\r\n\r\n    var matrixWorldInverse = new THREE.Matrix4();\r\n    matrixWorldInverse.getInverse(parent.matrixWorld);\r\n    child.applyMatrix(matrixWorldInverse);\r\n\r\n    scene.remove(child);\r\n    parent.add(child);\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/FontUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For Text operations in three.js (See TextGeometry)\r\n *\r\n * It uses techniques used in:\r\n *\r\n * \ttypeface.js and canvastext\r\n * \t\tFor converting fonts and rendering with javascript\r\n *\t\thttp://typeface.neocracy.org\r\n *\r\n *\tTriangulation ported from AS3\r\n *\t\tSimple Polygon Triangulation\r\n *\t\thttp://actionsnippet.com/?p=1462\r\n *\r\n * \tA Method to triangulate shapes with holes\r\n *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\r\n *\r\n */\r\n\r\nTHREE.FontUtils = {\r\n\r\n  faces: {},\r\n\r\n  // Just for now. face[weight][style]\r\n\r\n  face: 'helvetiker',\r\n  weight: 'normal',\r\n  style: 'normal',\r\n  size: 150,\r\n  divisions: 10,\r\n\r\n  getFace: function() {\r\n\r\n    try {\r\n\r\n      return this.faces[this.face][this.weight][this.style];\r\n\r\n    }\r\n    catch (e) {\r\n\r\n      throw \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\"\r\n\r\n    };\r\n\r\n  },\r\n\r\n  loadFace: function(data) {\r\n\r\n    var family = data.familyName.toLowerCase();\r\n\r\n    var ThreeFont = this;\r\n\r\n    ThreeFont.faces[family] = ThreeFont.faces[family] || {};\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight] = ThreeFont.faces[family][data.cssFontWeight] || {};\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  drawText: function(text) {\r\n\r\n    // RenderText\r\n\r\n    var i,\r\n      face = this.getFace(),\r\n      scale = this.size / face.resolution,\r\n      offset = 0,\r\n      chars = String(text).split(''),\r\n      length = chars.length;\r\n\r\n    var fontPaths = [];\r\n\r\n    for (i = 0; i < length; i++) {\r\n\r\n      var path = new THREE.Path();\r\n\r\n      var ret = this.extractGlyphPoints(chars[i], face, scale, offset, path);\r\n      offset += ret.offset;\r\n\r\n      fontPaths.push(ret.path);\r\n\r\n    }\r\n\r\n    // get the width\r\n\r\n    var width = offset / 2;\r\n    //\r\n    // for ( p = 0; p < allPts.length; p++ ) {\r\n    //\r\n    // \tallPts[ p ].x -= width;\r\n    //\r\n    // }\r\n\r\n    //var extract = this.extractPoints( allPts, characterPts );\r\n    //extract.contour = allPts;\r\n\r\n    //extract.paths = fontPaths;\r\n    //extract.offset = width;\r\n\r\n    return {\r\n      paths: fontPaths,\r\n      offset: width\r\n    };\r\n\r\n  },\r\n\r\n\r\n\r\n\r\n  extractGlyphPoints: function(c, face, scale, offset, path) {\r\n\r\n    var pts = [];\r\n\r\n    var i, i2, divisions,\r\n      outline, action, length,\r\n      scaleX, scaleY,\r\n      x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2,\r\n      laste,\r\n      glyph = face.glyphs[c] || face.glyphs['?'];\r\n\r\n    if (!glyph) return;\r\n\r\n    if (glyph.o) {\r\n\r\n      outline = glyph._cachedOutline || (glyph._cachedOutline = glyph.o.split(' '));\r\n      length = outline.length;\r\n\r\n      scaleX = scale;\r\n      scaleY = scale;\r\n\r\n      for (i = 0; i < length;) {\r\n\r\n        action = outline[i++];\r\n\r\n        //console.log( action );\r\n\r\n        switch (action) {\r\n\r\n          case 'm':\r\n\r\n            // Move To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n\r\n            path.moveTo(x, y);\r\n            break;\r\n\r\n          case 'l':\r\n\r\n            // Line To\r\n\r\n            x = outline[i++] * scaleX + offset;\r\n            y = outline[i++] * scaleY;\r\n            path.lineTo(x, y);\r\n            break;\r\n\r\n          case 'q':\r\n\r\n            // QuadraticCurveTo\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n\r\n            path.quadraticCurveTo(cpx1, cpy1, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n                THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n          case 'b':\r\n\r\n            // Cubic Bezier Curve\r\n\r\n            cpx = outline[i++] * scaleX + offset;\r\n            cpy = outline[i++] * scaleY;\r\n            cpx1 = outline[i++] * scaleX + offset;\r\n            cpy1 = outline[i++] * scaleY;\r\n            cpx2 = outline[i++] * scaleX + offset;\r\n            cpy2 = outline[i++] * scaleY;\r\n\r\n            path.bezierCurveTo(cpx1, cpy1, cpx2, cpy2, cpx, cpy);\r\n\r\n            laste = pts[pts.length - 1];\r\n\r\n            if (laste) {\r\n\r\n              cpx0 = laste.x;\r\n              cpy0 = laste.y;\r\n\r\n              for (i2 = 1, divisions = this.divisions; i2 <= divisions; i2++) {\r\n\r\n                var t = i2 / divisions;\r\n                THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n                THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n              }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n\r\n\r\n    return {\r\n      offset: glyph.ha * scale,\r\n      path: path\r\n    };\r\n  }\r\n\r\n};\r\n\r\n\r\nTHREE.FontUtils.generateShapes = function(text, parameters) {\r\n\r\n  // Parameters \r\n\r\n  parameters = parameters || {};\r\n\r\n  var size = parameters.size !== undefined ? parameters.size : 100;\r\n  var curveSegments = parameters.curveSegments !== undefined ? parameters.curveSegments : 4;\r\n\r\n  var font = parameters.font !== undefined ? parameters.font : 'helvetiker';\r\n  var weight = parameters.weight !== undefined ? parameters.weight : 'normal';\r\n  var style = parameters.style !== undefined ? parameters.style : 'normal';\r\n\r\n  THREE.FontUtils.size = size;\r\n  THREE.FontUtils.divisions = curveSegments;\r\n\r\n  THREE.FontUtils.face = font;\r\n  THREE.FontUtils.weight = weight;\r\n  THREE.FontUtils.style = style;\r\n\r\n  // Get a Font data json object\r\n\r\n  var data = THREE.FontUtils.drawText(text);\r\n\r\n  var paths = data.paths;\r\n  var shapes = [];\r\n\r\n  for (var p = 0, pl = paths.length; p < pl; p++) {\r\n\r\n    Array.prototype.push.apply(shapes, paths[p].toShapes());\r\n\r\n  }\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n\r\n/**\r\n * This code is a quick port of code written in C++ which was submitted to\r\n * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n * See original code and more information here:\r\n * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n *\r\n * ported to actionscript by Zevan Rosser\r\n * www.actionsnippet.com\r\n *\r\n * ported to javascript by Joshua Koo\r\n * http://www.lab4games.net/zz85/blog\r\n *\r\n */\r\n\r\n\r\n(function(namespace) {\r\n\r\n  var EPSILON = 0.0000000001;\r\n\r\n  // takes in an contour array and returns\r\n\r\n  var process = function(contour, indices) {\r\n\r\n    var n = contour.length;\r\n\r\n    if (n < 3) return null;\r\n\r\n    var result = [],\r\n      verts = [],\r\n      vertIndices = [];\r\n\r\n    /* we want a counter-clockwise polygon in verts */\r\n\r\n    var u, v, w;\r\n\r\n    if (area(contour) > 0.0) {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = v;\r\n\r\n    }\r\n    else {\r\n\r\n      for (v = 0; v < n; v++) verts[v] = (n - 1) - v;\r\n\r\n    }\r\n\r\n    var nv = n;\r\n\r\n    /*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n    var count = 2 * nv; /* error detection */\r\n\r\n    for (v = nv - 1; nv > 2;) {\r\n\r\n      /* if we loop, it is probably a non-simple polygon */\r\n\r\n      if ((count--) <= 0) {\r\n\r\n        //** Triangulate: ERROR - probable bad polygon!\r\n\r\n        //throw ( \"Warning, unable to triangulate polygon!\" );\r\n        //return null;\r\n        // Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n        THREE.warn('THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()');\r\n\r\n        if (indices) return vertIndices;\r\n        return result;\r\n\r\n      }\r\n\r\n      /* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n      u = v;\r\n      if (nv <= u) u = 0; /* previous */\r\n      v = u + 1;\r\n      if (nv <= v) v = 0; /* new v    */\r\n      w = v + 1;\r\n      if (nv <= w) w = 0; /* next     */\r\n\r\n      if (snip(contour, u, v, w, nv, verts)) {\r\n\r\n        var a, b, c, s, t;\r\n\r\n        /* true names of the vertices */\r\n\r\n        a = verts[u];\r\n        b = verts[v];\r\n        c = verts[w];\r\n\r\n        /* output Triangle */\r\n\r\n        result.push([contour[a],\r\n          contour[b],\r\n          contour[c]\r\n        ]);\r\n\r\n\r\n        vertIndices.push([verts[u], verts[v], verts[w]]);\r\n\r\n        /* remove v from the remaining polygon */\r\n\r\n        for (s = v, t = v + 1; t < nv; s++, t++) {\r\n\r\n          verts[s] = verts[t];\r\n\r\n        }\r\n\r\n        nv--;\r\n\r\n        /* reset error detection counter */\r\n\r\n        count = 2 * nv;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (indices) return vertIndices;\r\n    return result;\r\n\r\n  };\r\n\r\n  // calculate area of the contour polygon\r\n\r\n  var area = function(contour) {\r\n\r\n    var n = contour.length;\r\n    var a = 0.0;\r\n\r\n    for (var p = n - 1, q = 0; q < n; p = q++) {\r\n\r\n      a += contour[p].x * contour[q].y - contour[q].x * contour[p].y;\r\n\r\n    }\r\n\r\n    return a * 0.5;\r\n\r\n  };\r\n\r\n  var snip = function(contour, u, v, w, n, verts) {\r\n\r\n    var p;\r\n    var ax, ay, bx, by;\r\n    var cx, cy, px, py;\r\n\r\n    ax = contour[verts[u]].x;\r\n    ay = contour[verts[u]].y;\r\n\r\n    bx = contour[verts[v]].x;\r\n    by = contour[verts[v]].y;\r\n\r\n    cx = contour[verts[w]].x;\r\n    cy = contour[verts[w]].y;\r\n\r\n    if (EPSILON > (((bx - ax) * (cy - ay)) - ((by - ay) * (cx - ax)))) return false;\r\n\r\n    var aX, aY, bX, bY, cX, cY;\r\n    var apx, apy, bpx, bpy, cpx, cpy;\r\n    var cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n    aX = cx - bx;\r\n    aY = cy - by;\r\n    bX = ax - cx;\r\n    bY = ay - cy;\r\n    cX = bx - ax;\r\n    cY = by - ay;\r\n\r\n    for (p = 0; p < n; p++) {\r\n\r\n      px = contour[verts[p]].x\r\n      py = contour[verts[p]].y\r\n\r\n      if (((px === ax) && (py === ay)) ||\r\n        ((px === bx) && (py === by)) ||\r\n        ((px === cx) && (py === cy))) continue;\r\n\r\n      apx = px - ax;\r\n      apy = py - ay;\r\n      bpx = px - bx;\r\n      bpy = py - by;\r\n      cpx = px - cx;\r\n      cpy = py - cy;\r\n\r\n      // see if p is inside triangle abc\r\n\r\n      aCROSSbp = aX * bpy - aY * bpx;\r\n      cCROSSap = cX * apy - cY * apx;\r\n      bCROSScp = bX * cpy - bY * cpx;\r\n\r\n      if ((aCROSSbp >= -EPSILON) && (bCROSScp >= -EPSILON) && (cCROSSap >= -EPSILON)) return false;\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n\r\n  namespace.Triangulate = process;\r\n  namespace.Triangulate.area = area;\r\n\r\n  return namespace;\r\n\r\n})(THREE.FontUtils);\r\n\r\n// To use the typeface.js face files, hook up the API\r\nself._typeface_js = {\r\n  faces: THREE.FontUtils.faces,\r\n  loadFace: THREE.FontUtils.loadFace\r\n};\r\nTHREE.typeface_js = self._typeface_js;\r\n\r\n// File:src/extras/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Audio = function(listener) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'Audio';\r\n\r\n  this.context = listener.context;\r\n  this.source = this.context.createBufferSource();\r\n  this.source.onended = this.onEnded.bind(this);\r\n\r\n  this.gain = this.context.createGain();\r\n  this.gain.connect(this.context.destination);\r\n\r\n  this.panner = this.context.createPanner();\r\n  this.panner.connect(this.gain);\r\n\r\n  this.autoplay = false;\r\n\r\n  this.startTime = 0;\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Audio.prototype.constructor = THREE.Audio;\r\n\r\nTHREE.Audio.prototype.load = function(file) {\r\n\r\n  var scope = this;\r\n\r\n  var request = new XMLHttpRequest();\r\n  request.open('GET', file, true);\r\n  request.responseType = 'arraybuffer';\r\n  request.onload = function(e) {\r\n\r\n    scope.context.decodeAudioData(this.response, function(buffer) {\r\n\r\n      scope.source.buffer = buffer;\r\n\r\n      if (scope.autoplay) scope.play();\r\n\r\n    });\r\n\r\n  };\r\n  request.send();\r\n\r\n  return this;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.play = function() {\r\n\r\n  if (this.isPlaying === true) {\r\n\r\n    THREE.warn('THREE.Audio: Audio is already playing.');\r\n    return;\r\n\r\n  }\r\n\r\n  var source = this.context.createBufferSource();\r\n\r\n  source.buffer = this.source.buffer;\r\n  source.loop = this.source.loop;\r\n  source.onended = this.source.onended;\r\n  source.connect(this.panner);\r\n  source.start(0, this.startTime);\r\n\r\n  this.isPlaying = true;\r\n\r\n  this.source = source;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.pause = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = this.context.currentTime;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.stop = function() {\r\n\r\n  this.source.stop();\r\n  this.startTime = 0;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.onEnded = function() {\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setLoop = function(value) {\r\n\r\n  this.source.loop = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRefDistance = function(value) {\r\n\r\n  this.panner.refDistance = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setRolloffFactor = function(value) {\r\n\r\n  this.panner.rolloffFactor = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.setVolume = function(value) {\r\n\r\n  this.gain.gain.value = value;\r\n\r\n};\r\n\r\nTHREE.Audio.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    position.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    this.panner.setPosition(position.x, position.y, position.z);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.type = 'AudioListener';\r\n\r\n  this.context = new(window.AudioContext || window.webkitAudioContext)();\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\r\n\r\nTHREE.AudioListener.prototype.updateMatrixWorld = (function() {\r\n\r\n  var position = new THREE.Vector3();\r\n  var quaternion = new THREE.Quaternion();\r\n  var scale = new THREE.Vector3();\r\n\r\n  var orientation = new THREE.Vector3();\r\n  var velocity = new THREE.Vector3();\r\n\r\n  var positionPrev = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    var listener = this.context.listener;\r\n    var up = this.up;\r\n\r\n    this.matrixWorld.decompose(position, quaternion, scale);\r\n\r\n    orientation.set(0, 0, -1).applyQuaternion(quaternion);\r\n    velocity.subVectors(position, positionPrev);\r\n\r\n    listener.setPosition(position.x, position.y, position.z);\r\n    listener.setOrientation(orientation.x, orientation.y, orientation.z, up.x, up.y, up.z);\r\n    listener.setVelocity(velocity.x, velocity.y, velocity.z);\r\n\r\n    positionPrev.copy(position);\r\n\r\n  };\r\n\r\n})();\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n * THREE.ClosedSplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function() {\r\n\r\n};\r\n\r\n// Virtual base class method to overwrite and implement in subclasses\r\n//\t- t [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPoint = function(t) {\r\n\r\n  THREE.warn(\"THREE.Curve: Warning, getPoint() not implemented!\");\r\n  return null;\r\n\r\n};\r\n\r\n// Get point at relative position in curve according to arc length\r\n// - u [0 .. 1]\r\n\r\nTHREE.Curve.prototype.getPointAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getPoint(t);\r\n\r\n};\r\n\r\n// Get sequence of points using getPoint( t )\r\n\r\nTHREE.Curve.prototype.getPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPoint(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get sequence of points using getPointAt( u )\r\n\r\nTHREE.Curve.prototype.getSpacedPoints = function(divisions) {\r\n\r\n  if (!divisions) divisions = 5;\r\n\r\n  var d, pts = [];\r\n\r\n  for (d = 0; d <= divisions; d++) {\r\n\r\n    pts.push(this.getPointAt(d / divisions));\r\n\r\n  }\r\n\r\n  return pts;\r\n\r\n};\r\n\r\n// Get total curve arc length\r\n\r\nTHREE.Curve.prototype.getLength = function() {\r\n\r\n  var lengths = this.getLengths();\r\n  return lengths[lengths.length - 1];\r\n\r\n};\r\n\r\n// Get list of cumulative segment lengths\r\n\r\nTHREE.Curve.prototype.getLengths = function(divisions) {\r\n\r\n  if (!divisions) divisions = (this.__arcLengthDivisions) ? (this.__arcLengthDivisions) : 200;\r\n\r\n  if (this.cacheArcLengths && (this.cacheArcLengths.length == divisions + 1) && !this.needsUpdate) {\r\n\r\n    //console.log( \"cached\", this.cacheArcLengths );\r\n    return this.cacheArcLengths;\r\n\r\n  }\r\n\r\n  this.needsUpdate = false;\r\n\r\n  var cache = [];\r\n  var current, last = this.getPoint(0);\r\n  var p, sum = 0;\r\n\r\n  cache.push(0);\r\n\r\n  for (p = 1; p <= divisions; p++) {\r\n\r\n    current = this.getPoint(p / divisions);\r\n    sum += current.distanceTo(last);\r\n    cache.push(sum);\r\n    last = current;\r\n\r\n  }\r\n\r\n  this.cacheArcLengths = cache;\r\n\r\n  return cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.updateArcLengths = function() {\r\n  this.needsUpdate = true;\r\n  this.getLengths();\r\n};\r\n\r\n// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equi distance\r\n\r\nTHREE.Curve.prototype.getUtoTmapping = function(u, distance) {\r\n\r\n  var arcLengths = this.getLengths();\r\n\r\n  var i = 0,\r\n    il = arcLengths.length;\r\n\r\n  var targetArcLength; // The targeted u distance value to get\r\n\r\n  if (distance) {\r\n\r\n    targetArcLength = distance;\r\n\r\n  }\r\n  else {\r\n\r\n    targetArcLength = u * arcLengths[il - 1];\r\n\r\n  }\r\n\r\n  //var time = Date.now();\r\n\r\n  // binary search for the index with largest value smaller than target u distance\r\n\r\n  var low = 0,\r\n    high = il - 1,\r\n    comparison;\r\n\r\n  while (low <= high) {\r\n\r\n    i = Math.floor(low + (high - low) / 2); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n    comparison = arcLengths[i] - targetArcLength;\r\n\r\n    if (comparison < 0) {\r\n\r\n      low = i + 1;\r\n\r\n    }\r\n    else if (comparison > 0) {\r\n\r\n      high = i - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      high = i;\r\n      break;\r\n\r\n      // DONE\r\n\r\n    }\r\n\r\n  }\r\n\r\n  i = high;\r\n\r\n  //console.log('b' , i, low, high, Date.now()- time);\r\n\r\n  if (arcLengths[i] == targetArcLength) {\r\n\r\n    var t = i / (il - 1);\r\n    return t;\r\n\r\n  }\r\n\r\n  // we could get finer grain at lengths, or use simple interpolatation between two points\r\n\r\n  var lengthBefore = arcLengths[i];\r\n  var lengthAfter = arcLengths[i + 1];\r\n\r\n  var segmentLength = lengthAfter - lengthBefore;\r\n\r\n  // determine where we are between the 'before' and 'after' points\r\n\r\n  var segmentFraction = (targetArcLength - lengthBefore) / segmentLength;\r\n\r\n  // add that fractional amount to t\r\n\r\n  var t = (i + segmentFraction) / (il - 1);\r\n\r\n  return t;\r\n\r\n};\r\n\r\n// Returns a unit vector tangent at t\r\n// In case any sub curve does not implement its tangent derivation,\r\n// 2 points a small delta apart will be used to find its gradient\r\n// which seems to give a reasonable approximation\r\n\r\nTHREE.Curve.prototype.getTangent = function(t) {\r\n\r\n  var delta = 0.0001;\r\n  var t1 = t - delta;\r\n  var t2 = t + delta;\r\n\r\n  // Capping in case of danger\r\n\r\n  if (t1 < 0) t1 = 0;\r\n  if (t2 > 1) t2 = 1;\r\n\r\n  var pt1 = this.getPoint(t1);\r\n  var pt2 = this.getPoint(t2);\r\n\r\n  var vec = pt2.clone().sub(pt1);\r\n  return vec.normalize();\r\n\r\n};\r\n\r\n\r\nTHREE.Curve.prototype.getTangentAt = function(u) {\r\n\r\n  var t = this.getUtoTmapping(u);\r\n  return this.getTangent(t);\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Curve.Utils = {\r\n\r\n  tangentQuadraticBezier: function(t, p0, p1, p2) {\r\n\r\n    return 2 * (1 - t) * (p1 - p0) + 2 * t * (p2 - p1);\r\n\r\n  },\r\n\r\n  // Puay Bing, thanks for helping with this derivative!\r\n\r\n  tangentCubicBezier: function(t, p0, p1, p2, p3) {\r\n\r\n    return -3 * p0 * (1 - t) * (1 - t) +\r\n      3 * p1 * (1 - t) * (1 - t) - 6 * t * p1 * (1 - t) +\r\n      6 * t * p2 * (1 - t) - 3 * t * t * p2 +\r\n      3 * t * t * p3;\r\n\r\n  },\r\n\r\n  tangentSpline: function(t, p0, p1, p2, p3) {\r\n\r\n    // To check if my formulas are correct\r\n\r\n    var h00 = 6 * t * t - 6 * t; // derived from 2t^3 − 3t^2 + 1\r\n    var h10 = 3 * t * t - 4 * t + 1; // t^3 − 2t^2 + t\r\n    var h01 = -6 * t * t + 6 * t; // − 2t3 + 3t2\r\n    var h11 = 3 * t * t - 2 * t; // t3 − t2\r\n\r\n    return h00 + h10 + h01 + h11;\r\n\r\n  },\r\n\r\n  // Catmull-Rom\r\n\r\n  interpolate: function(p0, p1, p2, p3, t) {\r\n\r\n    var v0 = (p2 - p0) * 0.5;\r\n    var v1 = (p3 - p1) * 0.5;\r\n    var t2 = t * t;\r\n    var t3 = t * t2;\r\n    return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function(constructor, getPointFunc) {\r\n\r\n  constructor.prototype = Object.create(THREE.Curve.prototype);\r\n  constructor.prototype.constructor = constructor;\r\n  constructor.prototype.getPoint = getPointFunc;\r\n\r\n  return constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function() {\r\n\r\n  this.curves = [];\r\n  this.bends = [];\r\n\r\n  this.autoClose = false; // Automatically closes the path\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\r\n\r\nTHREE.CurvePath.prototype.add = function(curve) {\r\n\r\n  this.curves.push(curve);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.checkConnection = function() {\r\n  // TODO\r\n  // If the ending of curve is not connected to the starting\r\n  // or the next curve, then, this is not a real path\r\n};\r\n\r\nTHREE.CurvePath.prototype.closePath = function() {\r\n  // TODO Test\r\n  // and verify for vector3 (needs to implement equals)\r\n  // Add a line curve if start and end of lines are not connected\r\n  var startPoint = this.curves[0].getPoint(0);\r\n  var endPoint = this.curves[this.curves.length - 1].getPoint(1);\r\n\r\n  if (!startPoint.equals(endPoint)) {\r\n    this.curves.push(new THREE.LineCurve(endPoint, startPoint));\r\n  }\r\n\r\n};\r\n\r\n// To get accurate point with reference to\r\n// entire path distance at time t,\r\n// following has to be done:\r\n\r\n// 1. Length of each sub path have to be known\r\n// 2. Locate and identify type of curve\r\n// 3. Get t for the curve\r\n// 4. Return curve.getPointAt(t')\r\n\r\nTHREE.CurvePath.prototype.getPoint = function(t) {\r\n\r\n  var d = t * this.getLength();\r\n  var curveLengths = this.getCurveLengths();\r\n  var i = 0,\r\n    diff, curve;\r\n\r\n  // To think about boundaries points.\r\n\r\n  while (i < curveLengths.length) {\r\n\r\n    if (curveLengths[i] >= d) {\r\n\r\n      diff = curveLengths[i] - d;\r\n      curve = this.curves[i];\r\n\r\n      var u = 1 - diff / curve.getLength();\r\n\r\n      return curve.getPointAt(u);\r\n\r\n    }\r\n\r\n    i++;\r\n\r\n  }\r\n\r\n  return null;\r\n\r\n  // loop where sum != 0, sum > d , sum+1 <d\r\n\r\n};\r\n\r\n/*\r\nTHREE.CurvePath.prototype.getTangent = function( t ) {\r\n};*/\r\n\r\n\r\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n// getPoint() depends on getLength\r\n\r\nTHREE.CurvePath.prototype.getLength = function() {\r\n\r\n  var lens = this.getCurveLengths();\r\n  return lens[lens.length - 1];\r\n\r\n};\r\n\r\n// Compute lengths and cache them\r\n// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\nTHREE.CurvePath.prototype.getCurveLengths = function() {\r\n\r\n  // We use cache values if curves and cache array are same length\r\n\r\n  if (this.cacheLengths && this.cacheLengths.length == this.curves.length) {\r\n\r\n    return this.cacheLengths;\r\n\r\n  };\r\n\r\n  // Get length of subsurve\r\n  // Push sums into cached array\r\n\r\n  var lengths = [],\r\n    sums = 0;\r\n  var i, il = this.curves.length;\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    sums += this.curves[i].getLength();\r\n    lengths.push(sums);\r\n\r\n  }\r\n\r\n  this.cacheLengths = lengths;\r\n\r\n  return lengths;\r\n\r\n};\r\n\r\n\r\n\r\n// Returns min and max coordinates\r\n\r\nTHREE.CurvePath.prototype.getBoundingBox = function() {\r\n\r\n  var points = this.getPoints();\r\n\r\n  var maxX, maxY, maxZ;\r\n  var minX, minY, minZ;\r\n\r\n  maxX = maxY = Number.NEGATIVE_INFINITY;\r\n  minX = minY = Number.POSITIVE_INFINITY;\r\n\r\n  var p, i, il, sum;\r\n\r\n  var v3 = points[0] instanceof THREE.Vector3;\r\n\r\n  sum = v3 ? new THREE.Vector3() : new THREE.Vector2();\r\n\r\n  for (i = 0, il = points.length; i < il; i++) {\r\n\r\n    p = points[i];\r\n\r\n    if (p.x > maxX) maxX = p.x;\r\n    else if (p.x < minX) minX = p.x;\r\n\r\n    if (p.y > maxY) maxY = p.y;\r\n    else if (p.y < minY) minY = p.y;\r\n\r\n    if (v3) {\r\n\r\n      if (p.z > maxZ) maxZ = p.z;\r\n      else if (p.z < minZ) minZ = p.z;\r\n\r\n    }\r\n\r\n    sum.add(p);\r\n\r\n  }\r\n\r\n  var ret = {\r\n\r\n    minX: minX,\r\n    minY: minY,\r\n    maxX: maxX,\r\n    maxY: maxY\r\n\r\n  };\r\n\r\n  if (v3) {\r\n\r\n    ret.maxZ = maxZ;\r\n    ret.minZ = minZ;\r\n\r\n  }\r\n\r\n  return ret;\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tCreate Geometries Helpers\r\n **************************************************************/\r\n\r\n/// Generate geometry from path points (for Line or Points objects)\r\n\r\nTHREE.CurvePath.prototype.createPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\n// Generate geometry from equidistance sampling along the path\r\n\r\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function(divisions) {\r\n\r\n  var pts = this.getSpacedPoints(divisions, true);\r\n  return this.createGeometry(pts);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.createGeometry = function(points) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < points.length; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(points[i].x, points[i].y, points[i].z || 0));\r\n\r\n  }\r\n\r\n  return geometry;\r\n\r\n};\r\n\r\n\r\n/**************************************************************\r\n *\tBend / Wrap Helper Methods\r\n **************************************************************/\r\n\r\n// Wrap path / Bend modifiers?\r\n\r\nTHREE.CurvePath.prototype.addWrapPath = function(bendpath) {\r\n\r\n  this.bends.push(bendpath);\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getPoints(segments); // getPoints getSpacedPoints\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype.getTransformedSpacedPoints = function(segments, bends) {\r\n\r\n  var oldPts = this.getSpacedPoints(segments);\r\n\r\n  var i, il;\r\n\r\n  if (!bends) {\r\n\r\n    bends = this.bends;\r\n\r\n  }\r\n\r\n  for (i = 0, il = bends.length; i < il; i++) {\r\n\r\n    oldPts = this.getWrapPoints(oldPts, bends[i]);\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n// This returns getPoints() bend/wrapped around the contour of a path.\r\n// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\r\n\r\nTHREE.CurvePath.prototype.getWrapPoints = function(oldPts, path) {\r\n\r\n  var bounds = this.getBoundingBox();\r\n\r\n  var i, il, p, oldX, oldY, xNorm;\r\n\r\n  for (i = 0, il = oldPts.length; i < il; i++) {\r\n\r\n    p = oldPts[i];\r\n\r\n    oldX = p.x;\r\n    oldY = p.y;\r\n\r\n    xNorm = oldX / bounds.maxX;\r\n\r\n    // If using actual distance, for length > path, requires line extrusions\r\n    //xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\r\n\r\n    xNorm = path.getUtoTmapping(xNorm, oldX);\r\n\r\n    // check for out of bounds?\r\n\r\n    var pathPt = path.getPoint(xNorm);\r\n    var normal = path.getTangent(xNorm);\r\n    normal.set(-normal.y, normal.x).multiplyScalar(oldY);\r\n\r\n    p.x = pathPt.x + normal.x;\r\n    p.y = pathPt.y + normal.y;\r\n\r\n  }\r\n\r\n  return oldPts;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/core/Gyroscope.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Gyroscope = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n};\r\n\r\nTHREE.Gyroscope.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.Gyroscope.prototype.constructor = THREE.Gyroscope;\r\n\r\nTHREE.Gyroscope.prototype.updateMatrixWorld = (function() {\r\n\r\n  var translationObject = new THREE.Vector3();\r\n  var quaternionObject = new THREE.Quaternion();\r\n  var scaleObject = new THREE.Vector3();\r\n\r\n  var translationWorld = new THREE.Vector3();\r\n  var quaternionWorld = new THREE.Quaternion();\r\n  var scaleWorld = new THREE.Vector3();\r\n\r\n  return function(force) {\r\n\r\n    this.matrixAutoUpdate && this.updateMatrix();\r\n\r\n    // update matrixWorld\r\n\r\n    if (this.matrixWorldNeedsUpdate || force) {\r\n\r\n      if (this.parent) {\r\n\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n\r\n        this.matrixWorld.decompose(translationWorld, quaternionWorld, scaleWorld);\r\n        this.matrix.decompose(translationObject, quaternionObject, scaleObject);\r\n\r\n        this.matrixWorld.compose(translationWorld, quaternionObject, scaleWorld);\r\n\r\n\r\n      }\r\n      else {\r\n\r\n        this.matrixWorld.copy(this.matrix);\r\n\r\n      }\r\n\r\n\r\n      this.matrixWorldNeedsUpdate = false;\r\n\r\n      force = true;\r\n\r\n    }\r\n\r\n    // update children\r\n\r\n    for (var i = 0, l = this.children.length; i < l; i++) {\r\n\r\n      this.children[i].updateMatrixWorld(force);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function(points) {\r\n\r\n  THREE.CurvePath.call(this);\r\n\r\n  this.actions = [];\r\n\r\n  if (points) {\r\n\r\n    this.fromPoints(points);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.create(THREE.CurvePath.prototype);\r\nTHREE.Path.prototype.constructor = THREE.Path;\r\n\r\nTHREE.PathActions = {\r\n\r\n  MOVE_TO: 'moveTo',\r\n  LINE_TO: 'lineTo',\r\n  QUADRATIC_CURVE_TO: 'quadraticCurveTo', // Bezier quadratic curve\r\n  BEZIER_CURVE_TO: 'bezierCurveTo', // Bezier cubic curve\r\n  CSPLINE_THRU: 'splineThru', // Catmull-rom spline\r\n  ARC: 'arc', // Circle\r\n  ELLIPSE: 'ellipse'\r\n};\r\n\r\n// TODO Clean up PATH API\r\n\r\n// Create path using straight lines to connect all points\r\n// - vectors: array of Vector2\r\n\r\nTHREE.Path.prototype.fromPoints = function(vectors) {\r\n\r\n  this.moveTo(vectors[0].x, vectors[0].y);\r\n\r\n  for (var v = 1, vlen = vectors.length; v < vlen; v++) {\r\n\r\n    this.lineTo(vectors[v].x, vectors[v].y);\r\n\r\n  };\r\n\r\n};\r\n\r\n// startPath() endPath()?\r\n\r\nTHREE.Path.prototype.moveTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  this.actions.push({\r\n    action: THREE.PathActions.MOVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.lineTo = function(x, y) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.LineCurve(new THREE.Vector2(x0, y0), new THREE.Vector2(x, y));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.LINE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.QuadraticBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCPx, aCPy),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.QUADRATIC_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.bezierCurveTo = function(aCP1x, aCP1y,\r\n  aCP2x, aCP2y,\r\n  aX, aY) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  var curve = new THREE.CubicBezierCurve(new THREE.Vector2(x0, y0),\r\n    new THREE.Vector2(aCP1x, aCP1y),\r\n    new THREE.Vector2(aCP2x, aCP2y),\r\n    new THREE.Vector2(aX, aY));\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.BEZIER_CURVE_TO,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.splineThru = function(pts /*Array of Vector*/ ) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n  //---\r\n  var npts = [new THREE.Vector2(x0, y0)];\r\n  Array.prototype.push.apply(npts, pts);\r\n\r\n  var curve = new THREE.SplineCurve(npts);\r\n  this.curves.push(curve);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.CSPLINE_THRU,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\n// FUTURE: Change the API or follow canvas API?\r\n\r\nTHREE.Path.prototype.arc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absarc(aX + x0, aY + y0, aRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\nTHREE.Path.prototype.absarc = function(aX, aY, aRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n  this.absellipse(aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.Path.prototype.ellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var lastargs = this.actions[this.actions.length - 1].args;\r\n  var x0 = lastargs[lastargs.length - 2];\r\n  var y0 = lastargs[lastargs.length - 1];\r\n\r\n  this.absellipse(aX + x0, aY + y0, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n\r\n};\r\n\r\n\r\nTHREE.Path.prototype.absellipse = function(aX, aY, xRadius, yRadius,\r\n  aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  var args = Array.prototype.slice.call(arguments);\r\n  var curve = new THREE.EllipseCurve(aX, aY, xRadius, yRadius,\r\n    aStartAngle, aEndAngle, aClockwise);\r\n  this.curves.push(curve);\r\n\r\n  var lastPoint = curve.getPoint(1);\r\n  args.push(lastPoint.x);\r\n  args.push(lastPoint.y);\r\n\r\n  this.actions.push({\r\n    action: THREE.PathActions.ELLIPSE,\r\n    args: args\r\n  });\r\n\r\n};\r\n\r\nTHREE.Path.prototype.getSpacedPoints = function(divisions, closedPath) {\r\n\r\n  if (!divisions) divisions = 40;\r\n\r\n  var points = [];\r\n\r\n  for (var i = 0; i < divisions; i++) {\r\n\r\n    points.push(this.getPoint(i / divisions));\r\n\r\n    //if( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n  }\r\n\r\n  // if ( closedPath ) {\r\n  //\r\n  // \tpoints.push( points[ 0 ] );\r\n  //\r\n  // }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n/* Return an array of vectors based on contour of the path */\r\n\r\nTHREE.Path.prototype.getPoints = function(divisions, closedPath) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    console.log('tata');\r\n    return this.getSpacedPoints(divisions, closedPath);\r\n  }\r\n\r\n  divisions = divisions || 12;\r\n\r\n  var points = [];\r\n\r\n  var i, il, item, action, args;\r\n  var cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n    laste, j,\r\n    t, tx, ty;\r\n\r\n  for (i = 0, il = this.actions.length; i < il; i++) {\r\n\r\n    item = this.actions[i];\r\n\r\n    action = item.action;\r\n    args = item.args;\r\n\r\n    switch (action) {\r\n\r\n      case THREE.PathActions.MOVE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.LINE_TO:\r\n\r\n        points.push(new THREE.Vector2(args[0], args[1]));\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.QUADRATIC_CURVE_TO:\r\n\r\n        cpx = args[2];\r\n        cpy = args[3];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b2(t, cpx0, cpx1, cpx);\r\n          ty = THREE.Shape.Utils.b2(t, cpy0, cpy1, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.BEZIER_CURVE_TO:\r\n\r\n        cpx = args[4];\r\n        cpy = args[5];\r\n\r\n        cpx1 = args[0];\r\n        cpy1 = args[1];\r\n\r\n        cpx2 = args[2];\r\n        cpy2 = args[3];\r\n\r\n        if (points.length > 0) {\r\n\r\n          laste = points[points.length - 1];\r\n\r\n          cpx0 = laste.x;\r\n          cpy0 = laste.y;\r\n\r\n        }\r\n        else {\r\n\r\n          laste = this.actions[i - 1].args;\r\n\r\n          cpx0 = laste[laste.length - 2];\r\n          cpy0 = laste[laste.length - 1];\r\n\r\n        }\r\n\r\n\r\n        for (j = 1; j <= divisions; j++) {\r\n\r\n          t = j / divisions;\r\n\r\n          tx = THREE.Shape.Utils.b3(t, cpx0, cpx1, cpx2, cpx);\r\n          ty = THREE.Shape.Utils.b3(t, cpy0, cpy1, cpy2, cpy);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.CSPLINE_THRU:\r\n\r\n        laste = this.actions[i - 1].args;\r\n\r\n        var last = new THREE.Vector2(laste[laste.length - 2], laste[laste.length - 1]);\r\n        var spts = [last];\r\n\r\n        var n = divisions * args[0].length;\r\n\r\n        spts = spts.concat(args[0]);\r\n\r\n        var spline = new THREE.SplineCurve(spts);\r\n\r\n        for (j = 1; j <= n; j++) {\r\n\r\n          points.push(spline.getPointAt(j / n));\r\n\r\n        }\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ARC:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          aRadius = args[2],\r\n          aStartAngle = args[3],\r\n          aEndAngle = args[4],\r\n          aClockwise = !!args[5];\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + aRadius * Math.cos(angle);\r\n          ty = aY + aRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n      case THREE.PathActions.ELLIPSE:\r\n\r\n        var aX = args[0],\r\n          aY = args[1],\r\n          xRadius = args[2],\r\n          yRadius = args[3],\r\n          aStartAngle = args[4],\r\n          aEndAngle = args[5],\r\n          aClockwise = !!args[6];\r\n\r\n\r\n        var deltaAngle = aEndAngle - aStartAngle;\r\n        var angle;\r\n        var tdivisions = divisions * 2;\r\n\r\n        for (j = 1; j <= tdivisions; j++) {\r\n\r\n          t = j / tdivisions;\r\n\r\n          if (!aClockwise) {\r\n\r\n            t = 1 - t;\r\n\r\n          }\r\n\r\n          angle = aStartAngle + t * deltaAngle;\r\n\r\n          tx = aX + xRadius * Math.cos(angle);\r\n          ty = aY + yRadius * Math.sin(angle);\r\n\r\n          //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n          points.push(new THREE.Vector2(tx, ty));\r\n\r\n        }\r\n\r\n        //console.log(points);\r\n\r\n        break;\r\n\r\n    } // end switch\r\n\r\n  }\r\n\r\n\r\n\r\n  // Normalize to remove the closing point by default.\r\n  var lastPoint = points[points.length - 1];\r\n  var EPSILON = 0.0000000001;\r\n  if (Math.abs(lastPoint.x - points[0].x) < EPSILON &&\r\n    Math.abs(lastPoint.y - points[0].y) < EPSILON)\r\n    points.splice(points.length - 1, 1);\r\n  if (closedPath) {\r\n\r\n    points.push(points[0]);\r\n\r\n  }\r\n\r\n  return points;\r\n\r\n};\r\n\r\n//\r\n// Breaks path into shapes\r\n//\r\n//\tAssumptions (if parameter isCCW==true the opposite holds):\r\n//\t- solid shapes are defined clockwise (CW)\r\n//\t- holes are defined counterclockwise (CCW)\r\n//\r\n//\tIf parameter noHoles==true:\r\n//  - all subPaths are regarded as solid shapes\r\n//  - definition order CW/CCW has no relevance\r\n//\r\n\r\nTHREE.Path.prototype.toShapes = function(isCCW, noHoles) {\r\n\r\n  function extractSubpaths(inActions) {\r\n\r\n    var i, il, item, action, args;\r\n\r\n    var subPaths = [],\r\n      lastPath = new THREE.Path();\r\n\r\n    for (i = 0, il = inActions.length; i < il; i++) {\r\n\r\n      item = inActions[i];\r\n\r\n      args = item.args;\r\n      action = item.action;\r\n\r\n      if (action == THREE.PathActions.MOVE_TO) {\r\n\r\n        if (lastPath.actions.length != 0) {\r\n\r\n          subPaths.push(lastPath);\r\n          lastPath = new THREE.Path();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      lastPath[action].apply(lastPath, args);\r\n\r\n    }\r\n\r\n    if (lastPath.actions.length != 0) {\r\n\r\n      subPaths.push(lastPath);\r\n\r\n    }\r\n\r\n    // console.log(subPaths);\r\n\r\n    return subPaths;\r\n  }\r\n\r\n  function toShapesNoHoles(inSubpaths) {\r\n\r\n    var shapes = [];\r\n\r\n    for (var i = 0, il = inSubpaths.length; i < il; i++) {\r\n\r\n      var tmpPath = inSubpaths[i];\r\n\r\n      var tmpShape = new THREE.Shape();\r\n      tmpShape.actions = tmpPath.actions;\r\n      tmpShape.curves = tmpPath.curves;\r\n\r\n      shapes.push(tmpShape);\r\n    }\r\n\r\n    //console.log(\"shape\", shapes);\r\n\r\n    return shapes;\r\n  };\r\n\r\n  function isPointInsidePolygon(inPt, inPolygon) {\r\n    var EPSILON = 0.0000000001;\r\n\r\n    var polyLen = inPolygon.length;\r\n\r\n    // inPt on polygon contour => immediate success    or\r\n    // toggling of inside/outside at every single! intersection point of an edge\r\n    //  with the horizontal line through inPt, left of inPt\r\n    //  not counting lowerY endpoints of edges and whole edges on that line\r\n    var inside = false;\r\n    for (var p = polyLen - 1, q = 0; q < polyLen; p = q++) {\r\n      var edgeLowPt = inPolygon[p];\r\n      var edgeHighPt = inPolygon[q];\r\n\r\n      var edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n      var edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n      if (Math.abs(edgeDy) > EPSILON) { // not parallel\r\n        if (edgeDy < 0) {\r\n          edgeLowPt = inPolygon[q];\r\n          edgeDx = -edgeDx;\r\n          edgeHighPt = inPolygon[p];\r\n          edgeDy = -edgeDy;\r\n        }\r\n        if ((inPt.y < edgeLowPt.y) || (inPt.y > edgeHighPt.y)) continue;\r\n\r\n        if (inPt.y == edgeLowPt.y) {\r\n          if (inPt.x == edgeLowPt.x) return true; // inPt is on contour ?\r\n          // continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n        }\r\n        else {\r\n          var perpEdge = edgeDy * (inPt.x - edgeLowPt.x) - edgeDx * (inPt.y - edgeLowPt.y);\r\n          if (perpEdge == 0) return true; // inPt is on contour ?\r\n          if (perpEdge < 0) continue;\r\n          inside = !inside; // true intersection left of inPt\r\n        }\r\n      }\r\n      else { // parallel or colinear\r\n        if (inPt.y != edgeLowPt.y) continue; // parallel\r\n        // egde lies on the same horizontal line as inPt\r\n        if (((edgeHighPt.x <= inPt.x) && (inPt.x <= edgeLowPt.x)) ||\r\n          ((edgeLowPt.x <= inPt.x) && (inPt.x <= edgeHighPt.x))) return true; // inPt: Point on contour !\r\n        // continue;\r\n      }\r\n    }\r\n\r\n    return inside;\r\n  }\r\n\r\n\r\n  var subPaths = extractSubpaths(this.actions);\r\n  if (subPaths.length == 0) return [];\r\n\r\n  if (noHoles === true) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  var solid, tmpPath, tmpShape, shapes = [];\r\n\r\n  if (subPaths.length == 1) {\r\n\r\n    tmpPath = subPaths[0];\r\n    tmpShape = new THREE.Shape();\r\n    tmpShape.actions = tmpPath.actions;\r\n    tmpShape.curves = tmpPath.curves;\r\n    shapes.push(tmpShape);\r\n    return shapes;\r\n\r\n  }\r\n\r\n  var holesFirst = !THREE.Shape.Utils.isClockWise(subPaths[0].getPoints());\r\n  holesFirst = isCCW ? !holesFirst : holesFirst;\r\n\r\n  // console.log(\"Holes first\", holesFirst);\r\n\r\n  var betterShapeHoles = [];\r\n  var newShapes = [];\r\n  var newShapeHoles = [];\r\n  var mainIdx = 0;\r\n  var tmpPoints;\r\n\r\n  newShapes[mainIdx] = undefined;\r\n  newShapeHoles[mainIdx] = [];\r\n\r\n  var i, il;\r\n\r\n  for (i = 0, il = subPaths.length; i < il; i++) {\r\n\r\n    tmpPath = subPaths[i];\r\n    tmpPoints = tmpPath.getPoints();\r\n    solid = THREE.Shape.Utils.isClockWise(tmpPoints);\r\n    solid = isCCW ? !solid : solid;\r\n\r\n    if (solid) {\r\n\r\n      if ((!holesFirst) && (newShapes[mainIdx])) mainIdx++;\r\n\r\n      newShapes[mainIdx] = {\r\n        s: new THREE.Shape(),\r\n        p: tmpPoints\r\n      };\r\n      newShapes[mainIdx].s.actions = tmpPath.actions;\r\n      newShapes[mainIdx].s.curves = tmpPath.curves;\r\n\r\n      if (holesFirst) mainIdx++;\r\n      newShapeHoles[mainIdx] = [];\r\n\r\n      //console.log('cw', i);\r\n\r\n    }\r\n    else {\r\n\r\n      newShapeHoles[mainIdx].push({\r\n        h: tmpPath,\r\n        p: tmpPoints[0]\r\n      });\r\n\r\n      //console.log('ccw', i);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // only Holes? -> probably all Shapes with wrong orientation\r\n  if (!newShapes[0]) return toShapesNoHoles(subPaths);\r\n\r\n\r\n  if (newShapes.length > 1) {\r\n    var ambigious = false;\r\n    var toChange = [];\r\n\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      betterShapeHoles[sIdx] = [];\r\n    }\r\n    for (var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx++) {\r\n      var sho = newShapeHoles[sIdx];\r\n      for (var hIdx = 0; hIdx < sho.length; hIdx++) {\r\n        var ho = sho[hIdx];\r\n        var hole_unassigned = true;\r\n        for (var s2Idx = 0; s2Idx < newShapes.length; s2Idx++) {\r\n          if (isPointInsidePolygon(ho.p, newShapes[s2Idx].p)) {\r\n            if (sIdx != s2Idx) toChange.push({\r\n              froms: sIdx,\r\n              tos: s2Idx,\r\n              hole: hIdx\r\n            });\r\n            if (hole_unassigned) {\r\n              hole_unassigned = false;\r\n              betterShapeHoles[s2Idx].push(ho);\r\n            }\r\n            else {\r\n              ambigious = true;\r\n            }\r\n          }\r\n        }\r\n        if (hole_unassigned) {\r\n          betterShapeHoles[sIdx].push(ho);\r\n        }\r\n      }\r\n    }\r\n    // console.log(\"ambigious: \", ambigious);\r\n    if (toChange.length > 0) {\r\n      // console.log(\"to change: \", toChange);\r\n      if (!ambigious) newShapeHoles = betterShapeHoles;\r\n    }\r\n  }\r\n\r\n  var tmpHoles, j, jl;\r\n  for (i = 0, il = newShapes.length; i < il; i++) {\r\n    tmpShape = newShapes[i].s;\r\n    shapes.push(tmpShape);\r\n    tmpHoles = newShapeHoles[i];\r\n    for (j = 0, jl = tmpHoles.length; j < jl; j++) {\r\n      tmpShape.holes.push(tmpHoles[j].h);\r\n    }\r\n  }\r\n\r\n  //console.log(\"shape\", shapes);\r\n\r\n  return shapes;\r\n\r\n};\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function() {\r\n\r\n  THREE.Path.apply(this, arguments);\r\n  this.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.create(THREE.Path.prototype);\r\nTHREE.Shape.prototype.constructor = THREE.Shape;\r\n\r\n// Convenience method to return ExtrudeGeometry\r\n\r\nTHREE.Shape.prototype.extrude = function(options) {\r\n\r\n  var extruded = new THREE.ExtrudeGeometry(this, options);\r\n  return extruded;\r\n\r\n};\r\n\r\n// Convenience method to return ShapeGeometry\r\n\r\nTHREE.Shape.prototype.makeGeometry = function(options) {\r\n\r\n  var geometry = new THREE.ShapeGeometry(this, options);\r\n  return geometry;\r\n\r\n};\r\n\r\n// Get points of holes\r\n\r\nTHREE.Shape.prototype.getPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n// Get points of holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.getSpacedPointsHoles = function(divisions) {\r\n\r\n  var i, il = this.holes.length,\r\n    holesPts = [];\r\n\r\n  for (i = 0; i < il; i++) {\r\n\r\n    holesPts[i] = this.holes[i].getTransformedSpacedPoints(divisions, this.bends);\r\n\r\n  }\r\n\r\n  return holesPts;\r\n\r\n};\r\n\r\n\r\n// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\nTHREE.Shape.prototype.extractAllPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedPoints(divisions),\r\n    holes: this.getPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\nTHREE.Shape.prototype.extractPoints = function(divisions) {\r\n\r\n  if (this.useSpacedPoints) {\r\n    return this.extractAllSpacedPoints(divisions);\r\n  }\r\n\r\n  return this.extractAllPoints(divisions);\r\n\r\n};\r\n\r\n//\r\n// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\r\n//\r\n// \treturn {\r\n//\r\n// \t\tshape: this.transform( bend, divisions ),\r\n// \t\tholes: this.getPointsHoles( divisions, bend )\r\n//\r\n// \t};\r\n//\r\n// };\r\n\r\n// Get points of shape and holes (spaced by regular distance)\r\n\r\nTHREE.Shape.prototype.extractAllSpacedPoints = function(divisions) {\r\n\r\n  return {\r\n\r\n    shape: this.getTransformedSpacedPoints(divisions),\r\n    holes: this.getSpacedPointsHoles(divisions)\r\n\r\n  };\r\n\r\n};\r\n\r\n/**************************************************************\r\n *\tUtils\r\n **************************************************************/\r\n\r\nTHREE.Shape.Utils = {\r\n\r\n  triangulateShape: function(contour, holes) {\r\n\r\n    function point_in_segment_2D_colin(inSegPt1, inSegPt2, inOtherPt) {\r\n      // inOtherPt needs to be colinear to the inSegment\r\n      if (inSegPt1.x != inSegPt2.x) {\r\n        if (inSegPt1.x < inSegPt2.x) {\r\n          return ((inSegPt1.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt2.x));\r\n        }\r\n        else {\r\n          return ((inSegPt2.x <= inOtherPt.x) && (inOtherPt.x <= inSegPt1.x));\r\n        }\r\n      }\r\n      else {\r\n        if (inSegPt1.y < inSegPt2.y) {\r\n          return ((inSegPt1.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt2.y));\r\n        }\r\n        else {\r\n          return ((inSegPt2.y <= inOtherPt.y) && (inOtherPt.y <= inSegPt1.y));\r\n        }\r\n      }\r\n    }\r\n\r\n    function intersect_segments_2D(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs) {\r\n      var EPSILON = 0.0000000001;\r\n\r\n      var seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,\r\n        seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n      var seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,\r\n        seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n      var seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n      var seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n      var limit = seg1dy * seg2dx - seg1dx * seg2dy;\r\n      var perpSeg1 = seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n      if (Math.abs(limit) > EPSILON) { // not parallel\r\n\r\n        var perpSeg2;\r\n        if (limit > 0) {\r\n          if ((perpSeg1 < 0) || (perpSeg1 > limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 < 0) || (perpSeg2 > limit)) return [];\r\n        }\r\n        else {\r\n          if ((perpSeg1 > 0) || (perpSeg1 < limit)) return [];\r\n          perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n          if ((perpSeg2 > 0) || (perpSeg2 < limit)) return [];\r\n        }\r\n\r\n        // i.e. to reduce rounding errors\r\n        // intersection at endpoint of segment#1?\r\n        if (perpSeg2 == 0) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt1];\r\n        }\r\n        if (perpSeg2 == limit) {\r\n          if ((inExcludeAdjacentSegs) &&\r\n            ((perpSeg1 == 0) || (perpSeg1 == limit))) return [];\r\n          return [inSeg1Pt2];\r\n        }\r\n        // intersection at endpoint of segment#2?\r\n        if (perpSeg1 == 0) return [inSeg2Pt1];\r\n        if (perpSeg1 == limit) return [inSeg2Pt2];\r\n\r\n        // return real intersection point\r\n        var factorSeg1 = perpSeg2 / limit;\r\n        return [{\r\n          x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n          y: inSeg1Pt1.y + factorSeg1 * seg1dy\r\n        }];\r\n\r\n      }\r\n      else { // parallel or colinear\r\n        if ((perpSeg1 != 0) ||\r\n          (seg2dy * seg1seg2dx != seg2dx * seg1seg2dy)) return [];\r\n\r\n        // they are collinear or degenerate\r\n        var seg1Pt = ((seg1dx == 0) && (seg1dy == 0)); // segment1 ist just a point?\r\n        var seg2Pt = ((seg2dx == 0) && (seg2dy == 0)); // segment2 ist just a point?\r\n        // both segments are points\r\n        if (seg1Pt && seg2Pt) {\r\n          if ((inSeg1Pt1.x != inSeg2Pt1.x) ||\r\n            (inSeg1Pt1.y != inSeg2Pt1.y)) return []; // they are distinct  points\r\n          return [inSeg1Pt1]; // they are the same point\r\n        }\r\n        // segment#1  is a single point\r\n        if (seg1Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg2Pt1, inSeg2Pt2, inSeg1Pt1)) return []; // but not in segment#2\r\n          return [inSeg1Pt1];\r\n        }\r\n        // segment#2  is a single point\r\n        if (seg2Pt) {\r\n          if (!point_in_segment_2D_colin(inSeg1Pt1, inSeg1Pt2, inSeg2Pt1)) return []; // but not in segment#1\r\n          return [inSeg2Pt1];\r\n        }\r\n\r\n        // they are collinear segments, which might overlap\r\n        var seg1min, seg1max, seg1minVal, seg1maxVal;\r\n        var seg2min, seg2max, seg2minVal, seg2maxVal;\r\n        if (seg1dx != 0) { // the segments are NOT on a vertical line\r\n          if (inSeg1Pt1.x < inSeg1Pt2.x) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.x;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.x;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.x;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.x;\r\n          }\r\n          if (inSeg2Pt1.x < inSeg2Pt2.x) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.x;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.x;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.x;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.x;\r\n          }\r\n        }\r\n        else { // the segments are on a vertical line\r\n          if (inSeg1Pt1.y < inSeg1Pt2.y) {\r\n            seg1min = inSeg1Pt1;\r\n            seg1minVal = inSeg1Pt1.y;\r\n            seg1max = inSeg1Pt2;\r\n            seg1maxVal = inSeg1Pt2.y;\r\n          }\r\n          else {\r\n            seg1min = inSeg1Pt2;\r\n            seg1minVal = inSeg1Pt2.y;\r\n            seg1max = inSeg1Pt1;\r\n            seg1maxVal = inSeg1Pt1.y;\r\n          }\r\n          if (inSeg2Pt1.y < inSeg2Pt2.y) {\r\n            seg2min = inSeg2Pt1;\r\n            seg2minVal = inSeg2Pt1.y;\r\n            seg2max = inSeg2Pt2;\r\n            seg2maxVal = inSeg2Pt2.y;\r\n          }\r\n          else {\r\n            seg2min = inSeg2Pt2;\r\n            seg2minVal = inSeg2Pt2.y;\r\n            seg2max = inSeg2Pt1;\r\n            seg2maxVal = inSeg2Pt1.y;\r\n          }\r\n        }\r\n        if (seg1minVal <= seg2minVal) {\r\n          if (seg1maxVal < seg2minVal) return [];\r\n          if (seg1maxVal == seg2minVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg2min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg2min, seg1max];\r\n          return [seg2min, seg2max];\r\n        }\r\n        else {\r\n          if (seg1minVal > seg2maxVal) return [];\r\n          if (seg1minVal == seg2maxVal) {\r\n            if (inExcludeAdjacentSegs) return [];\r\n            return [seg1min];\r\n          }\r\n          if (seg1maxVal <= seg2maxVal) return [seg1min, seg1max];\r\n          return [seg1min, seg2max];\r\n        }\r\n      }\r\n    }\r\n\r\n    function isPointInsideAngle(inVertex, inLegFromPt, inLegToPt, inOtherPt) {\r\n      // The order of legs is important\r\n\r\n      var EPSILON = 0.0000000001;\r\n\r\n      // translation of all points, so that Vertex is at (0,0)\r\n      var legFromPtX = inLegFromPt.x - inVertex.x,\r\n        legFromPtY = inLegFromPt.y - inVertex.y;\r\n      var legToPtX = inLegToPt.x - inVertex.x,\r\n        legToPtY = inLegToPt.y - inVertex.y;\r\n      var otherPtX = inOtherPt.x - inVertex.x,\r\n        otherPtY = inOtherPt.y - inVertex.y;\r\n\r\n      // main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n      var from2toAngle = legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n      var from2otherAngle = legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n      if (Math.abs(from2toAngle) > EPSILON) { // angle != 180 deg.\r\n\r\n        var other2toAngle = otherPtX * legToPtY - otherPtY * legToPtX;\r\n        // console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n        if (from2toAngle > 0) { // main angle < 180 deg.\r\n          return ((from2otherAngle >= 0) && (other2toAngle >= 0));\r\n        }\r\n        else { // main angle > 180 deg.\r\n          return ((from2otherAngle >= 0) || (other2toAngle >= 0));\r\n        }\r\n      }\r\n      else { // angle == 180 deg.\r\n        // console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n        return (from2otherAngle > 0);\r\n      }\r\n    }\r\n\r\n\r\n    function removeHoles(contour, holes) {\r\n\r\n      var shape = contour.concat(); // work on this shape\r\n      var hole;\r\n\r\n      function isCutLineInsideAngles(inShapeIdx, inHoleIdx) {\r\n        // Check if hole point lies within angle around shape point\r\n        var lastShapeIdx = shape.length - 1;\r\n\r\n        var prevShapeIdx = inShapeIdx - 1;\r\n        if (prevShapeIdx < 0) prevShapeIdx = lastShapeIdx;\r\n\r\n        var nextShapeIdx = inShapeIdx + 1;\r\n        if (nextShapeIdx > lastShapeIdx) nextShapeIdx = 0;\r\n\r\n        var insideAngle = isPointInsideAngle(shape[inShapeIdx], shape[prevShapeIdx], shape[nextShapeIdx], hole[inHoleIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n          return false;\r\n        }\r\n\r\n        // Check if shape point lies within angle around hole point\r\n        var lastHoleIdx = hole.length - 1;\r\n\r\n        var prevHoleIdx = inHoleIdx - 1;\r\n        if (prevHoleIdx < 0) prevHoleIdx = lastHoleIdx;\r\n\r\n        var nextHoleIdx = inHoleIdx + 1;\r\n        if (nextHoleIdx > lastHoleIdx) nextHoleIdx = 0;\r\n\r\n        insideAngle = isPointInsideAngle(hole[inHoleIdx], hole[prevHoleIdx], hole[nextHoleIdx], shape[inShapeIdx]);\r\n        if (!insideAngle) {\r\n          // console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n          return false;\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      function intersectsShapeEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with shape edges\r\n        var sIdx, nextIdx, intersection;\r\n        for (sIdx = 0; sIdx < shape.length; sIdx++) {\r\n          nextIdx = sIdx + 1;\r\n          nextIdx %= shape.length;\r\n          intersection = intersect_segments_2D(inShapePt, inHolePt, shape[sIdx], shape[nextIdx], true);\r\n          if (intersection.length > 0) return true;\r\n        }\r\n\r\n        return false;\r\n      }\r\n\r\n      var indepHoles = [];\r\n\r\n      function intersectsHoleEdge(inShapePt, inHolePt) {\r\n        // checks for intersections with hole edges\r\n        var ihIdx, chkHole,\r\n          hIdx, nextIdx, intersection;\r\n        for (ihIdx = 0; ihIdx < indepHoles.length; ihIdx++) {\r\n          chkHole = holes[indepHoles[ihIdx]];\r\n          for (hIdx = 0; hIdx < chkHole.length; hIdx++) {\r\n            nextIdx = hIdx + 1;\r\n            nextIdx %= chkHole.length;\r\n            intersection = intersect_segments_2D(inShapePt, inHolePt, chkHole[hIdx], chkHole[nextIdx], true);\r\n            if (intersection.length > 0) return true;\r\n          }\r\n        }\r\n        return false;\r\n      }\r\n\r\n      var holeIndex, shapeIndex,\r\n        shapePt, holePt,\r\n        holeIdx, cutKey, failedCuts = [],\r\n        tmpShape1, tmpShape2,\r\n        tmpHole1, tmpHole2;\r\n\r\n      for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n        indepHoles.push(h);\r\n\r\n      }\r\n\r\n      var minShapeIndex = 0;\r\n      var counter = indepHoles.length * 2;\r\n      while (indepHoles.length > 0) {\r\n        counter--;\r\n        if (counter < 0) {\r\n          console.log(\"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\");\r\n          break;\r\n        }\r\n\r\n        // search for shape-vertex and hole-vertex,\r\n        // which can be connected without intersections\r\n        for (shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex++) {\r\n\r\n          shapePt = shape[shapeIndex];\r\n          holeIndex = -1;\r\n\r\n          // search for hole which can be reached without intersections\r\n          for (var h = 0; h < indepHoles.length; h++) {\r\n            holeIdx = indepHoles[h];\r\n\r\n            // prevent multiple checks\r\n            cutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n            if (failedCuts[cutKey] !== undefined) continue;\r\n\r\n            hole = holes[holeIdx];\r\n            for (var h2 = 0; h2 < hole.length; h2++) {\r\n              holePt = hole[h2];\r\n              if (!isCutLineInsideAngles(shapeIndex, h2)) continue;\r\n              if (intersectsShapeEdge(shapePt, holePt)) continue;\r\n              if (intersectsHoleEdge(shapePt, holePt)) continue;\r\n\r\n              holeIndex = h2;\r\n              indepHoles.splice(h, 1);\r\n\r\n              tmpShape1 = shape.slice(0, shapeIndex + 1);\r\n              tmpShape2 = shape.slice(shapeIndex);\r\n              tmpHole1 = hole.slice(holeIndex);\r\n              tmpHole2 = hole.slice(0, holeIndex + 1);\r\n\r\n              shape = tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2);\r\n\r\n              minShapeIndex = shapeIndex;\r\n\r\n              // Debug only, to show the selected cuts\r\n              // glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n              break;\r\n            }\r\n            if (holeIndex >= 0) break; // hole-vertex found\r\n\r\n            failedCuts[cutKey] = true; // remember failure\r\n          }\r\n          if (holeIndex >= 0) break; // hole-vertex found\r\n        }\r\n      }\r\n\r\n      return shape; /* shape with no holes */\r\n    }\r\n\r\n\r\n    var i, il, f, face,\r\n      key, index,\r\n      allPointsMap = {};\r\n\r\n    // To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n    var allpoints = contour.concat();\r\n\r\n    for (var h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      Array.prototype.push.apply(allpoints, holes[h]);\r\n\r\n    }\r\n\r\n    //console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n    // prepare all points map\r\n\r\n    for (i = 0, il = allpoints.length; i < il; i++) {\r\n\r\n      key = allpoints[i].x + \":\" + allpoints[i].y;\r\n\r\n      if (allPointsMap[key] !== undefined) {\r\n\r\n        THREE.warn(\"THREE.Shape: Duplicate point\", key);\r\n\r\n      }\r\n\r\n      allPointsMap[key] = i;\r\n\r\n    }\r\n\r\n    // remove holes by cutting paths to holes and adding them to the shape\r\n    var shapeWithoutHoles = removeHoles(contour, holes);\r\n\r\n    var triangles = THREE.FontUtils.Triangulate(shapeWithoutHoles, false); // True returns indices for points of spooled shape\r\n    //console.log( \"triangles\",triangles, triangles.length );\r\n\r\n    // check all face vertices against all points map\r\n\r\n    for (i = 0, il = triangles.length; i < il; i++) {\r\n\r\n      face = triangles[i];\r\n\r\n      for (f = 0; f < 3; f++) {\r\n\r\n        key = face[f].x + \":\" + face[f].y;\r\n\r\n        index = allPointsMap[key];\r\n\r\n        if (index !== undefined) {\r\n\r\n          face[f] = index;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return triangles.concat();\r\n\r\n  },\r\n\r\n  isClockWise: function(pts) {\r\n\r\n    return THREE.FontUtils.Triangulate.area(pts) < 0;\r\n\r\n  },\r\n\r\n  // Bezier Curves formulas obtained from\r\n  // http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n  // Quad Bezier Functions\r\n\r\n  b2p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * p;\r\n\r\n  },\r\n\r\n  b2p1: function(t, p) {\r\n\r\n    return 2 * (1 - t) * t * p;\r\n\r\n  },\r\n\r\n  b2p2: function(t, p) {\r\n\r\n    return t * t * p;\r\n\r\n  },\r\n\r\n  b2: function(t, p0, p1, p2) {\r\n\r\n    return this.b2p0(t, p0) + this.b2p1(t, p1) + this.b2p2(t, p2);\r\n\r\n  },\r\n\r\n  // Cubic Bezier Functions\r\n\r\n  b3p0: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return k * k * k * p;\r\n\r\n  },\r\n\r\n  b3p1: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * k * t * p;\r\n\r\n  },\r\n\r\n  b3p2: function(t, p) {\r\n\r\n    var k = 1 - t;\r\n    return 3 * k * t * t * p;\r\n\r\n  },\r\n\r\n  b3p3: function(t, p) {\r\n\r\n    return t * t * t * p;\r\n\r\n  },\r\n\r\n  b3: function(t, p0, p1, p2, p3) {\r\n\r\n    return this.b3p0(t, p0) + this.b3p1(t, p1) + this.b3p2(t, p2) + this.b3p3(t, p3);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function(v1, v2) {\r\n\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function(t) {\r\n\r\n  var point = this.v2.clone().sub(this.v1);\r\n  point.multiplyScalar(t).add(this.v1);\r\n\r\n  return point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function(u) {\r\n\r\n  return this.getPoint(u);\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function(t) {\r\n\r\n  var tangent = this.v2.clone().sub(this.v1);\r\n\r\n  return tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function(v0, v1, v2) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.x, this.v1.x, this.v2.x);\r\n  vector.y = THREE.Curve.Utils.tangentQuadraticBezier(t, this.v0.y, this.v1.y, this.v2.y);\r\n\r\n  // returns unit vector\r\n\r\n  return vector.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function(v0, v1, v2, v3) {\r\n\r\n  this.v0 = v0;\r\n  this.v1 = v1;\r\n  this.v2 = v2;\r\n  this.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  return new THREE.Vector2(tx, ty);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function(t) {\r\n\r\n  var tx, ty;\r\n\r\n  tx = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n  ty = THREE.Curve.Utils.tangentCubicBezier(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n\r\n  var tangent = new THREE.Vector2(tx, ty);\r\n  tangent.normalize();\r\n\r\n  return tangent;\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function(points /* array of Vector2 */ ) {\r\n\r\n  this.points = (points == undefined) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function(t) {\r\n\r\n  var points = this.points;\r\n  var point = (points.length - 1) * t;\r\n\r\n  var intPoint = Math.floor(point);\r\n  var weight = point - intPoint;\r\n\r\n  var point0 = points[intPoint == 0 ? intPoint : intPoint - 1]\r\n  var point1 = points[intPoint]\r\n  var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1]\r\n  var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2]\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n  vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function(aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  this.aX = aX;\r\n  this.aY = aY;\r\n\r\n  this.xRadius = xRadius;\r\n  this.yRadius = yRadius;\r\n\r\n  this.aStartAngle = aStartAngle;\r\n  this.aEndAngle = aEndAngle;\r\n\r\n  this.aClockwise = aClockwise;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create(THREE.Curve.prototype);\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function(t) {\r\n\r\n  var deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n  if (deltaAngle < 0) deltaAngle += Math.PI * 2;\r\n  if (deltaAngle > Math.PI * 2) deltaAngle -= Math.PI * 2;\r\n\r\n  var angle;\r\n\r\n  if (this.aClockwise === true) {\r\n\r\n    angle = this.aEndAngle + (1 - t) * (Math.PI * 2 - deltaAngle);\r\n\r\n  }\r\n  else {\r\n\r\n    angle = this.aStartAngle + t * deltaAngle;\r\n\r\n  }\r\n\r\n  var vector = new THREE.Vector2();\r\n\r\n  vector.x = this.aX + this.xRadius * Math.cos(angle);\r\n  vector.y = this.aY + this.yRadius * Math.sin(angle);\r\n\r\n  return vector;\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function(aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise) {\r\n\r\n  THREE.EllipseCurve.call(this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise);\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create(THREE.EllipseCurve.prototype);\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n  function(v1, v2) {\r\n\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.subVectors(this.v2, this.v1); // diff\r\n    vector.multiplyScalar(t);\r\n    vector.add(this.v1);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b2(t, this.v0.x, this.v1.x, this.v2.x);\r\n    vector.y = THREE.Shape.Utils.b2(t, this.v0.y, this.v1.y, this.v2.y);\r\n    vector.z = THREE.Shape.Utils.b2(t, this.v0.z, this.v1.z, this.v2.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n  function(v0, v1, v2, v3) {\r\n\r\n    this.v0 = v0;\r\n    this.v1 = v1;\r\n    this.v2 = v2;\r\n    this.v3 = v3;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Shape.Utils.b3(t, this.v0.x, this.v1.x, this.v2.x, this.v3.x);\r\n    vector.y = THREE.Shape.Utils.b3(t, this.v0.y, this.v1.y, this.v2.y, this.v3.y);\r\n    vector.z = THREE.Shape.Utils.b3(t, this.v0.z, this.v1.z, this.v2.z, this.v3.z);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 1) * t;\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    var point0 = points[intPoint == 0 ? intPoint : intPoint - 1];\r\n    var point1 = points[intPoint];\r\n    var point2 = points[intPoint > points.length - 2 ? points.length - 1 : intPoint + 1];\r\n    var point3 = points[intPoint > points.length - 3 ? points.length - 1 : intPoint + 2];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\r\n\r\n  function(points /* array of Vector3 */ ) {\r\n\r\n    this.points = (points == undefined) ? [] : points;\r\n\r\n  },\r\n\r\n  function(t) {\r\n\r\n    var points = this.points;\r\n    var point = (points.length - 0) * t; // This needs to be from 0-length +1\r\n\r\n    var intPoint = Math.floor(point);\r\n    var weight = point - intPoint;\r\n\r\n    intPoint += intPoint > 0 ? 0 : (Math.floor(Math.abs(intPoint) / points.length) + 1) * points.length;\r\n\r\n    var point0 = points[(intPoint - 1) % points.length];\r\n    var point1 = points[(intPoint) % points.length];\r\n    var point2 = points[(intPoint + 1) % points.length];\r\n    var point3 = points[(intPoint + 2) % points.length];\r\n\r\n    var vector = new THREE.Vector3();\r\n\r\n    vector.x = THREE.Curve.Utils.interpolate(point0.x, point1.x, point2.x, point3.x, weight);\r\n    vector.y = THREE.Curve.Utils.interpolate(point0.y, point1.y, point2.y, point3.y, weight);\r\n    vector.z = THREE.Curve.Utils.interpolate(point0.z, point1.z, point2.z, point3.z, weight);\r\n\r\n    return vector;\r\n\r\n  }\r\n\r\n);\r\n\r\n// File:src/extras/animation/AnimationHandler.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\nTHREE.AnimationHandler = {\r\n\r\n  LINEAR: 0,\r\n  CATMULLROM: 1,\r\n  CATMULLROM_FORWARD: 2,\r\n\r\n  //\r\n\r\n  add: function() {\r\n    THREE.warn('THREE.AnimationHandler.add() has been deprecated.');\r\n  },\r\n  get: function() {\r\n    THREE.warn('THREE.AnimationHandler.get() has been deprecated.');\r\n  },\r\n  remove: function() {\r\n    THREE.warn('THREE.AnimationHandler.remove() has been deprecated.');\r\n  },\r\n\r\n  //\r\n\r\n  animations: [],\r\n\r\n  init: function(data) {\r\n\r\n    if (data.initialized === true) return data;\r\n\r\n    // loop through all keys\r\n\r\n    for (var h = 0; h < data.hierarchy.length; h++) {\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        // remove minus times\r\n\r\n        if (data.hierarchy[h].keys[k].time < 0) {\r\n\r\n          data.hierarchy[h].keys[k].time = 0;\r\n\r\n        }\r\n\r\n        // create quaternions\r\n\r\n        if (data.hierarchy[h].keys[k].rot !== undefined &&\r\n          !(data.hierarchy[h].keys[k].rot instanceof THREE.Quaternion)) {\r\n\r\n          var quat = data.hierarchy[h].keys[k].rot;\r\n          data.hierarchy[h].keys[k].rot = new THREE.Quaternion().fromArray(quat);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // prepare morph target keys\r\n\r\n      if (data.hierarchy[h].keys.length && data.hierarchy[h].keys[0].morphTargets !== undefined) {\r\n\r\n        // get all used\r\n\r\n        var usedMorphTargets = {};\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n            var morphTargetName = data.hierarchy[h].keys[k].morphTargets[m];\r\n            usedMorphTargets[morphTargetName] = -1;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        data.hierarchy[h].usedMorphTargets = usedMorphTargets;\r\n\r\n\r\n        // set all used on all frames\r\n\r\n        for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n          var influences = {};\r\n\r\n          for (var morphTargetName in usedMorphTargets) {\r\n\r\n            for (var m = 0; m < data.hierarchy[h].keys[k].morphTargets.length; m++) {\r\n\r\n              if (data.hierarchy[h].keys[k].morphTargets[m] === morphTargetName) {\r\n\r\n                influences[morphTargetName] = data.hierarchy[h].keys[k].morphTargetsInfluences[m];\r\n                break;\r\n\r\n              }\r\n\r\n            }\r\n\r\n            if (m === data.hierarchy[h].keys[k].morphTargets.length) {\r\n\r\n              influences[morphTargetName] = 0;\r\n\r\n            }\r\n\r\n          }\r\n\r\n          data.hierarchy[h].keys[k].morphTargetsInfluences = influences;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // remove all keys that are on the same time\r\n\r\n      for (var k = 1; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        if (data.hierarchy[h].keys[k].time === data.hierarchy[h].keys[k - 1].time) {\r\n\r\n          data.hierarchy[h].keys.splice(k, 1);\r\n          k--;\r\n\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // set index\r\n\r\n      for (var k = 0; k < data.hierarchy[h].keys.length; k++) {\r\n\r\n        data.hierarchy[h].keys[k].index = k;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    data.initialized = true;\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  parse: function(root) {\r\n\r\n    var parseRecurseHierarchy = function(root, hierarchy) {\r\n\r\n      hierarchy.push(root);\r\n\r\n      for (var c = 0; c < root.children.length; c++)\r\n        parseRecurseHierarchy(root.children[c], hierarchy);\r\n\r\n    };\r\n\r\n    // setup hierarchy\r\n\r\n    var hierarchy = [];\r\n\r\n    if (root instanceof THREE.SkinnedMesh) {\r\n\r\n      for (var b = 0; b < root.skeleton.bones.length; b++) {\r\n\r\n        hierarchy.push(root.skeleton.bones[b]);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      parseRecurseHierarchy(root, hierarchy);\r\n\r\n    }\r\n\r\n    return hierarchy;\r\n\r\n  },\r\n\r\n  play: function(animation) {\r\n\r\n    if (this.animations.indexOf(animation) === -1) {\r\n\r\n      this.animations.push(animation);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  stop: function(animation) {\r\n\r\n    var index = this.animations.indexOf(animation);\r\n\r\n    if (index !== -1) {\r\n\r\n      this.animations.splice(index, 1);\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(deltaTimeMS) {\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].resetBlendWeights();\r\n\r\n    }\r\n\r\n    for (var i = 0; i < this.animations.length; i++) {\r\n\r\n      this.animations[i].update(deltaTimeMS);\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/Animation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Animation = function(root, data) {\r\n\r\n  this.root = root;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(root);\r\n\r\n  this.currentTime = 0;\r\n  this.timeScale = 1;\r\n\r\n  this.isPlaying = false;\r\n  this.loop = true;\r\n  this.weight = 0;\r\n\r\n  this.interpolationType = THREE.AnimationHandler.LINEAR;\r\n\r\n};\r\n\r\nTHREE.Animation.prototype = {\r\n\r\n  constructor: THREE.Animation,\r\n\r\n  keyTypes: [\"pos\", \"rot\", \"scl\"],\r\n\r\n  play: function(startTime, weight) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n    this.weight = weight !== undefined ? weight : 1;\r\n\r\n    this.isPlaying = true;\r\n\r\n    this.reset();\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n  },\r\n\r\n  reset: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n\r\n      if (object.animationCache === undefined) {\r\n\r\n        object.animationCache = {\r\n          animations: {},\r\n          blending: {\r\n            positionWeight: 0.0,\r\n            quaternionWeight: 0.0,\r\n            scaleWeight: 0.0\r\n          }\r\n        };\r\n      }\r\n\r\n      var name = this.data.name;\r\n      var animations = object.animationCache.animations;\r\n      var animationCache = animations[name];\r\n\r\n      if (animationCache === undefined) {\r\n\r\n        animationCache = {\r\n          prevKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          nextKey: {\r\n            pos: 0,\r\n            rot: 0,\r\n            scl: 0\r\n          },\r\n          originalMatrix: object.matrix\r\n        };\r\n\r\n        animations[name] = animationCache;\r\n\r\n      }\r\n\r\n      // Get keys to match our current time\r\n\r\n      for (var t = 0; t < 3; t++) {\r\n\r\n        var type = this.keyTypes[t];\r\n\r\n        var prevKey = this.data.hierarchy[h].keys[0];\r\n        var nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n        while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n          prevKey = nextKey;\r\n          nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n        }\r\n\r\n        animationCache.prevKey[type] = prevKey;\r\n        animationCache.nextKey[type] = nextKey;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  resetBlendWeights: function() {\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var animationCache = object.animationCache;\r\n\r\n      if (animationCache !== undefined) {\r\n\r\n        var blending = animationCache.blending;\r\n\r\n        blending.positionWeight = 0.0;\r\n        blending.quaternionWeight = 0.0;\r\n        blending.scaleWeight = 0.0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: (function() {\r\n\r\n    var points = [];\r\n    var target = new THREE.Vector3();\r\n    var newVector = new THREE.Vector3();\r\n    var newQuat = new THREE.Quaternion();\r\n\r\n    // Catmull-Rom spline\r\n\r\n    var interpolateCatmullRom = function(points, scale) {\r\n\r\n      var c = [],\r\n        v3 = [],\r\n        point, intPoint, weight, w2, w3,\r\n        pa, pb, pc, pd;\r\n\r\n      point = (points.length - 1) * scale;\r\n      intPoint = Math.floor(point);\r\n      weight = point - intPoint;\r\n\r\n      c[0] = intPoint === 0 ? intPoint : intPoint - 1;\r\n      c[1] = intPoint;\r\n      c[2] = intPoint > points.length - 2 ? intPoint : intPoint + 1;\r\n      c[3] = intPoint > points.length - 3 ? intPoint : intPoint + 2;\r\n\r\n      pa = points[c[0]];\r\n      pb = points[c[1]];\r\n      pc = points[c[2]];\r\n      pd = points[c[3]];\r\n\r\n      w2 = weight * weight;\r\n      w3 = weight * w2;\r\n\r\n      v3[0] = interpolate(pa[0], pb[0], pc[0], pd[0], weight, w2, w3);\r\n      v3[1] = interpolate(pa[1], pb[1], pc[1], pd[1], weight, w2, w3);\r\n      v3[2] = interpolate(pa[2], pb[2], pc[2], pd[2], weight, w2, w3);\r\n\r\n      return v3;\r\n\r\n    };\r\n\r\n    var interpolate = function(p0, p1, p2, p3, t, t2, t3) {\r\n\r\n      var v0 = (p2 - p0) * 0.5,\r\n        v1 = (p3 - p1) * 0.5;\r\n\r\n      return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n    };\r\n\r\n    return function(delta) {\r\n\r\n      if (this.isPlaying === false) return;\r\n\r\n      this.currentTime += delta * this.timeScale;\r\n\r\n      if (this.weight === 0)\r\n        return;\r\n\r\n      //\r\n\r\n      var duration = this.data.length;\r\n\r\n      if (this.currentTime > duration || this.currentTime < 0) {\r\n\r\n        if (this.loop) {\r\n\r\n          this.currentTime %= duration;\r\n\r\n          if (this.currentTime < 0)\r\n            this.currentTime += duration;\r\n\r\n          this.reset();\r\n\r\n        }\r\n        else {\r\n\r\n          this.stop();\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n        var object = this.hierarchy[h];\r\n        var animationCache = object.animationCache.animations[this.data.name];\r\n        var blending = object.animationCache.blending;\r\n\r\n        // loop through pos/rot/scl\r\n\r\n        for (var t = 0; t < 3; t++) {\r\n\r\n          // get keys\r\n\r\n          var type = this.keyTypes[t];\r\n          var prevKey = animationCache.prevKey[type];\r\n          var nextKey = animationCache.nextKey[type];\r\n\r\n          if ((this.timeScale > 0 && nextKey.time <= this.currentTime) ||\r\n            (this.timeScale < 0 && prevKey.time >= this.currentTime)) {\r\n\r\n            prevKey = this.data.hierarchy[h].keys[0];\r\n            nextKey = this.getNextKeyWith(type, h, 1);\r\n\r\n            while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n              prevKey = nextKey;\r\n              nextKey = this.getNextKeyWith(type, h, nextKey.index + 1);\r\n\r\n            }\r\n\r\n            animationCache.prevKey[type] = prevKey;\r\n            animationCache.nextKey[type] = nextKey;\r\n\r\n          }\r\n\r\n          var scale = (this.currentTime - prevKey.time) / (nextKey.time - prevKey.time);\r\n\r\n          var prevXYZ = prevKey[type];\r\n          var nextXYZ = nextKey[type];\r\n\r\n          if (scale < 0) scale = 0;\r\n          if (scale > 1) scale = 1;\r\n\r\n          // interpolate\r\n\r\n          if (type === \"pos\") {\r\n\r\n            if (this.interpolationType === THREE.AnimationHandler.LINEAR) {\r\n\r\n              newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n              newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n              newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n              // blend\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              object.position.lerp(newVector, proportionalWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n            }\r\n            else if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n              this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n              points[0] = this.getPrevKeyWith(\"pos\", h, prevKey.index - 1)[\"pos\"];\r\n              points[1] = prevXYZ;\r\n              points[2] = nextXYZ;\r\n              points[3] = this.getNextKeyWith(\"pos\", h, nextKey.index + 1)[\"pos\"];\r\n\r\n              scale = scale * 0.33 + 0.33;\r\n\r\n              var currentPoint = interpolateCatmullRom(points, scale);\r\n              var proportionalWeight = this.weight / (this.weight + blending.positionWeight);\r\n              blending.positionWeight += this.weight;\r\n\r\n              // blend\r\n\r\n              var vector = object.position;\r\n\r\n              vector.x = vector.x + (currentPoint[0] - vector.x) * proportionalWeight;\r\n              vector.y = vector.y + (currentPoint[1] - vector.y) * proportionalWeight;\r\n              vector.z = vector.z + (currentPoint[2] - vector.z) * proportionalWeight;\r\n\r\n              if (this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n                var forwardPoint = interpolateCatmullRom(points, scale * 1.01);\r\n\r\n                target.set(forwardPoint[0], forwardPoint[1], forwardPoint[2]);\r\n                target.sub(vector);\r\n                target.y = 0;\r\n                target.normalize();\r\n\r\n                var angle = Math.atan2(target.x, target.z);\r\n                object.rotation.set(0, angle, 0);\r\n\r\n              }\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"rot\") {\r\n\r\n            THREE.Quaternion.slerp(prevXYZ, nextXYZ, newQuat, scale);\r\n\r\n            // Avoid paying the cost of an additional slerp if we don't have to\r\n            if (blending.quaternionWeight === 0) {\r\n\r\n              object.quaternion.copy(newQuat);\r\n              blending.quaternionWeight = this.weight;\r\n\r\n            }\r\n            else {\r\n\r\n              var proportionalWeight = this.weight / (this.weight + blending.quaternionWeight);\r\n              THREE.Quaternion.slerp(object.quaternion, newQuat, object.quaternion, proportionalWeight);\r\n              blending.quaternionWeight += this.weight;\r\n\r\n            }\r\n\r\n          }\r\n          else if (type === \"scl\") {\r\n\r\n            newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;\r\n            newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;\r\n            newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;\r\n\r\n            var proportionalWeight = this.weight / (this.weight + blending.scaleWeight);\r\n            object.scale.lerp(newVector, proportionalWeight);\r\n            blending.scaleWeight += this.weight;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n  })(),\r\n\r\n  getNextKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key < keys.length - 1 ? key : keys.length - 1;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key % keys.length;\r\n\r\n    }\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(type, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n\r\n    if (this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\r\n      this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD) {\r\n\r\n      key = key > 0 ? key : 0;\r\n\r\n    }\r\n    else {\r\n\r\n      key = key >= 0 ? key : key + keys.length;\r\n\r\n    }\r\n\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key][type] !== undefined) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return this.data.hierarchy[h].keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/KeyFrameAnimation.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author khang duong\r\n * @author erik kitson\r\n */\r\n\r\nTHREE.KeyFrameAnimation = function(data) {\r\n\r\n  this.root = data.node;\r\n  this.data = THREE.AnimationHandler.init(data);\r\n  this.hierarchy = THREE.AnimationHandler.parse(this.root);\r\n  this.currentTime = 0;\r\n  this.timeScale = 0.001;\r\n  this.isPlaying = false;\r\n  this.isPaused = true;\r\n  this.loop = true;\r\n\r\n  // initialize to first keyframes\r\n\r\n  for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n    var keys = this.data.hierarchy[h].keys,\r\n      sids = this.data.hierarchy[h].sids,\r\n      obj = this.hierarchy[h];\r\n\r\n    if (keys.length && sids) {\r\n\r\n      for (var s = 0; s < sids.length; s++) {\r\n\r\n        var sid = sids[s],\r\n          next = this.getNextKeyWith(sid, h, 0);\r\n\r\n        if (next) {\r\n\r\n          next.apply(sid);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      obj.matrixAutoUpdate = false;\r\n      this.data.hierarchy[h].node.updateMatrix();\r\n      obj.matrixWorldNeedsUpdate = true;\r\n\r\n    }\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.KeyFrameAnimation.prototype = {\r\n\r\n  constructor: THREE.KeyFrameAnimation,\r\n\r\n  play: function(startTime) {\r\n\r\n    this.currentTime = startTime !== undefined ? startTime : 0;\r\n\r\n    if (this.isPlaying === false) {\r\n\r\n      this.isPlaying = true;\r\n\r\n      // reset key cache\r\n\r\n      var h, hl = this.hierarchy.length,\r\n        object,\r\n        node;\r\n\r\n      for (h = 0; h < hl; h++) {\r\n\r\n        object = this.hierarchy[h];\r\n        node = this.data.hierarchy[h];\r\n\r\n        if (node.animationCache === undefined) {\r\n\r\n          node.animationCache = {};\r\n          node.animationCache.prevKey = null;\r\n          node.animationCache.nextKey = null;\r\n          node.animationCache.originalMatrix = object.matrix;\r\n\r\n        }\r\n\r\n        var keys = this.data.hierarchy[h].keys;\r\n\r\n        if (keys.length) {\r\n\r\n          node.animationCache.prevKey = keys[0];\r\n          node.animationCache.nextKey = keys[1];\r\n\r\n          this.startTime = Math.min(keys[0].time, this.startTime);\r\n          this.endTime = Math.max(keys[keys.length - 1].time, this.endTime);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.update(0);\r\n\r\n    }\r\n\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.play(this);\r\n\r\n  },\r\n\r\n  stop: function() {\r\n\r\n    this.isPlaying = false;\r\n    this.isPaused = false;\r\n\r\n    THREE.AnimationHandler.stop(this);\r\n\r\n    // reset JIT matrix and remove cache\r\n\r\n    for (var h = 0; h < this.data.hierarchy.length; h++) {\r\n\r\n      var obj = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      if (node.animationCache !== undefined) {\r\n\r\n        var original = node.animationCache.originalMatrix;\r\n\r\n        original.copy(obj.matrix);\r\n        obj.matrix = original;\r\n\r\n        delete node.animationCache;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta * this.timeScale;\r\n\r\n    //\r\n\r\n    var duration = this.data.length;\r\n\r\n    if (this.loop === true && this.currentTime > duration) {\r\n\r\n      this.currentTime %= duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, duration);\r\n\r\n    for (var h = 0, hl = this.hierarchy.length; h < hl; h++) {\r\n\r\n      var object = this.hierarchy[h];\r\n      var node = this.data.hierarchy[h];\r\n\r\n      var keys = node.keys,\r\n        animationCache = node.animationCache;\r\n\r\n\r\n      if (keys.length) {\r\n\r\n        var prevKey = animationCache.prevKey;\r\n        var nextKey = animationCache.nextKey;\r\n\r\n        if (nextKey.time <= this.currentTime) {\r\n\r\n          while (nextKey.time < this.currentTime && nextKey.index > prevKey.index) {\r\n\r\n            prevKey = nextKey;\r\n            nextKey = keys[prevKey.index + 1];\r\n\r\n          }\r\n\r\n          animationCache.prevKey = prevKey;\r\n          animationCache.nextKey = nextKey;\r\n\r\n        }\r\n\r\n        if (nextKey.time >= this.currentTime) {\r\n\r\n          prevKey.interpolate(nextKey, this.currentTime);\r\n\r\n        }\r\n        else {\r\n\r\n          prevKey.interpolate(nextKey, nextKey.time);\r\n\r\n        }\r\n\r\n        this.data.hierarchy[h].node.updateMatrix();\r\n        object.matrixWorldNeedsUpdate = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  getNextKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key % keys.length;\r\n\r\n    for (; key < keys.length; key++) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[0];\r\n\r\n  },\r\n\r\n  getPrevKeyWith: function(sid, h, key) {\r\n\r\n    var keys = this.data.hierarchy[h].keys;\r\n    key = key >= 0 ? key : key + keys.length;\r\n\r\n    for (; key >= 0; key--) {\r\n\r\n      if (keys[key].hasTarget(sid)) {\r\n\r\n        return keys[key];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return keys[keys.length - 1];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/animation/MorphAnimation.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com\r\n * @author willy-vvu / http://willy-vvu.github.io\r\n */\r\n\r\nTHREE.MorphAnimation = function(mesh) {\r\n\r\n  this.mesh = mesh;\r\n  this.frames = mesh.morphTargetInfluences.length;\r\n  this.currentTime = 0;\r\n  this.duration = 1000;\r\n  this.loop = true;\r\n  this.lastFrame = 0;\r\n  this.currentFrame = 0;\r\n\r\n  this.isPlaying = false;\r\n\r\n};\r\n\r\nTHREE.MorphAnimation.prototype = {\r\n\r\n  constructor: THREE.MorphAnimation,\r\n\r\n  play: function() {\r\n\r\n    this.isPlaying = true;\r\n\r\n  },\r\n\r\n  pause: function() {\r\n\r\n    this.isPlaying = false;\r\n\r\n  },\r\n\r\n  update: function(delta) {\r\n\r\n    if (this.isPlaying === false) return;\r\n\r\n    this.currentTime += delta;\r\n\r\n    if (this.loop === true && this.currentTime > this.duration) {\r\n\r\n      this.currentTime %= this.duration;\r\n\r\n    }\r\n\r\n    this.currentTime = Math.min(this.currentTime, this.duration);\r\n\r\n    var interpolation = this.duration / this.frames;\r\n    var frame = Math.floor(this.currentTime / interpolation);\r\n\r\n    var influences = this.mesh.morphTargetInfluences;\r\n\r\n    if (frame != this.currentFrame) {\r\n\r\n      influences[this.lastFrame] = 0;\r\n      influences[this.currentFrame] = 1;\r\n      influences[frame] = 0;\r\n\r\n      this.lastFrame = this.currentFrame;\r\n      this.currentFrame = frame;\r\n\r\n    }\r\n\r\n    influences[frame] = (this.currentTime % interpolation) / interpolation;\r\n    influences[this.lastFrame] = 1 - influences[frame];\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'BoxGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    depth: depth,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    depthSegments: depthSegments\r\n  };\r\n\r\n  this.widthSegments = widthSegments || 1;\r\n  this.heightSegments = heightSegments || 1;\r\n  this.depthSegments = depthSegments || 1;\r\n\r\n  var scope = this;\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n  var depth_half = depth / 2;\r\n\r\n  buildPlane('z', 'y', -1, -1, depth, height, width_half, 0); // px\r\n  buildPlane('z', 'y', 1, -1, depth, height, -width_half, 1); // nx\r\n  buildPlane('x', 'z', 1, 1, width, depth, height_half, 2); // py\r\n  buildPlane('x', 'z', 1, -1, width, depth, -height_half, 3); // ny\r\n  buildPlane('x', 'y', 1, -1, width, height, depth_half, 4); // pz\r\n  buildPlane('x', 'y', -1, -1, width, height, -depth_half, 5); // nz\r\n\r\n  function buildPlane(u, v, udir, vdir, width, height, depth, materialIndex) {\r\n\r\n    var w, ix, iy,\r\n      gridX = scope.widthSegments,\r\n      gridY = scope.heightSegments,\r\n      width_half = width / 2,\r\n      height_half = height / 2,\r\n      offset = scope.vertices.length;\r\n\r\n    if ((u === 'x' && v === 'y') || (u === 'y' && v === 'x')) {\r\n\r\n      w = 'z';\r\n\r\n    }\r\n    else if ((u === 'x' && v === 'z') || (u === 'z' && v === 'x')) {\r\n\r\n      w = 'y';\r\n      gridY = scope.depthSegments;\r\n\r\n    }\r\n    else if ((u === 'z' && v === 'y') || (u === 'y' && v === 'z')) {\r\n\r\n      w = 'x';\r\n      gridX = scope.depthSegments;\r\n\r\n    }\r\n\r\n    var gridX1 = gridX + 1,\r\n      gridY1 = gridY + 1,\r\n      segment_width = width / gridX,\r\n      segment_height = height / gridY,\r\n      normal = new THREE.Vector3();\r\n\r\n    normal[w] = depth > 0 ? 1 : -1;\r\n\r\n    for (iy = 0; iy < gridY1; iy++) {\r\n\r\n      for (ix = 0; ix < gridX1; ix++) {\r\n\r\n        var vector = new THREE.Vector3();\r\n        vector[u] = (ix * segment_width - width_half) * udir;\r\n        vector[v] = (iy * segment_height - height_half) * vdir;\r\n        vector[w] = depth;\r\n\r\n        scope.vertices.push(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (iy = 0; iy < gridY; iy++) {\r\n\r\n      for (ix = 0; ix < gridX; ix++) {\r\n\r\n        var a = ix + gridX1 * iy;\r\n        var b = ix + gridX1 * (iy + 1);\r\n        var c = (ix + 1) + gridX1 * (iy + 1);\r\n        var d = (ix + 1) + gridX1 * iy;\r\n\r\n        var uva = new THREE.Vector2(ix / gridX, 1 - iy / gridY);\r\n        var uvb = new THREE.Vector2(ix / gridX, 1 - (iy + 1) / gridY);\r\n        var uvc = new THREE.Vector2((ix + 1) / gridX, 1 - (iy + 1) / gridY);\r\n        var uvd = new THREE.Vector2((ix + 1) / gridX, 1 - iy / gridY);\r\n\r\n        var face = new THREE.Face3(a + offset, b + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n        face = new THREE.Face3(b + offset, c + offset, d + offset);\r\n        face.normal.copy(normal);\r\n        face.vertexNormals.push(normal.clone(), normal.clone(), normal.clone());\r\n        face.materialIndex = materialIndex;\r\n\r\n        scope.faces.push(face);\r\n        scope.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function(radius, segments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CircleGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    segments: segments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n  segments = segments !== undefined ? Math.max(3, segments) : 8;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  var i, uvs = [],\r\n    center = new THREE.Vector3(),\r\n    centerUV = new THREE.Vector2(0.5, 0.5);\r\n\r\n  this.vertices.push(center);\r\n  uvs.push(centerUV);\r\n\r\n  for (i = 0; i <= segments; i++) {\r\n\r\n    var vertex = new THREE.Vector3();\r\n    var segment = thetaStart + i / segments * thetaLength;\r\n\r\n    vertex.x = radius * Math.cos(segment);\r\n    vertex.y = radius * Math.sin(segment);\r\n\r\n    this.vertices.push(vertex);\r\n    uvs.push(new THREE.Vector2((vertex.x / radius + 1) / 2, (vertex.y / radius + 1) / 2));\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 1; i <= segments; i++) {\r\n\r\n    this.faces.push(new THREE.Face3(i, i + 1, 0, [n.clone(), n.clone(), n.clone()]));\r\n    this.faceVertexUvs[0].push([uvs[i].clone(), uvs[i + 1].clone(), centerUV.clone()]);\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CubeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.CubeGeometry = function(width, height, depth, widthSegments, heightSegments, depthSegments) {\r\n\r\n  THREE.warn('THREE.CubeGeometry has been renamed to THREE.BoxGeometry.');\r\n  return new THREE.BoxGeometry(width, height, depth, widthSegments, heightSegments, depthSegments);\r\n\r\n};\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function(radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'CylinderGeometry';\r\n\r\n  this.parameters = {\r\n    radiusTop: radiusTop,\r\n    radiusBottom: radiusBottom,\r\n    height: height,\r\n    radialSegments: radialSegments,\r\n    heightSegments: heightSegments,\r\n    openEnded: openEnded,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n  radiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n  height = height !== undefined ? height : 100;\r\n\r\n  radialSegments = radialSegments || 8;\r\n  heightSegments = heightSegments || 1;\r\n\r\n  openEnded = openEnded !== undefined ? openEnded : false;\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\r\n\r\n  var heightHalf = height / 2;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    var v = y / heightSegments;\r\n    var radius = v * (radiusBottom - radiusTop) + radiusTop;\r\n\r\n    for (x = 0; x <= radialSegments; x++) {\r\n\r\n      var u = x / radialSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = radius * Math.sin(u * thetaLength + thetaStart);\r\n      vertex.y = -v * height + heightHalf;\r\n      vertex.z = radius * Math.cos(u * thetaLength + thetaStart);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  var tanTheta = (radiusBottom - radiusTop) / height;\r\n  var na, nb;\r\n\r\n  for (x = 0; x < radialSegments; x++) {\r\n\r\n    if (radiusTop !== 0) {\r\n\r\n      na = this.vertices[vertices[0][x]].clone();\r\n      nb = this.vertices[vertices[0][x + 1]].clone();\r\n\r\n    }\r\n    else {\r\n\r\n      na = this.vertices[vertices[1][x]].clone();\r\n      nb = this.vertices[vertices[1][x + 1]].clone();\r\n\r\n    }\r\n\r\n    na.setY(Math.sqrt(na.x * na.x + na.z * na.z) * tanTheta).normalize();\r\n    nb.setY(Math.sqrt(nb.x * nb.x + nb.z * nb.z) * tanTheta).normalize();\r\n\r\n    for (y = 0; y < heightSegments; y++) {\r\n\r\n      var v1 = vertices[y][x];\r\n      var v2 = vertices[y + 1][x];\r\n      var v3 = vertices[y + 1][x + 1];\r\n      var v4 = vertices[y][x + 1];\r\n\r\n      var n1 = na.clone();\r\n      var n2 = na.clone();\r\n      var n3 = nb.clone();\r\n      var n4 = nb.clone();\r\n\r\n      var uv1 = uvs[y][x].clone();\r\n      var uv2 = uvs[y + 1][x].clone();\r\n      var uv3 = uvs[y + 1][x + 1].clone();\r\n      var uv4 = uvs[y][x + 1].clone();\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n      this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n      this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // top cap\r\n\r\n  if (openEnded === false && radiusTop > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[0][x];\r\n      var v2 = vertices[0][x + 1];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, 1, 0);\r\n      var n2 = new THREE.Vector3(0, 1, 0);\r\n      var n3 = new THREE.Vector3(0, 1, 0);\r\n\r\n      var uv1 = uvs[0][x].clone();\r\n      var uv2 = uvs[0][x + 1].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 0);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // bottom cap\r\n\r\n  if (openEnded === false && radiusBottom > 0) {\r\n\r\n    this.vertices.push(new THREE.Vector3(0, -heightHalf, 0));\r\n\r\n    for (x = 0; x < radialSegments; x++) {\r\n\r\n      var v1 = vertices[heightSegments][x + 1];\r\n      var v2 = vertices[heightSegments][x];\r\n      var v3 = this.vertices.length - 1;\r\n\r\n      var n1 = new THREE.Vector3(0, -1, 0);\r\n      var n2 = new THREE.Vector3(0, -1, 0);\r\n      var n3 = new THREE.Vector3(0, -1, 0);\r\n\r\n      var uv1 = uvs[heightSegments][x + 1].clone();\r\n      var uv2 = uvs[heightSegments][x].clone();\r\n      var uv3 = new THREE.Vector2(uv2.x, 1);\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n      this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segements of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  material: <int> // material index for front and back faces\r\n *  extrudeMaterial: <int> // material index for extrusion and beveled faces\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function(shapes, options) {\r\n\r\n  if (typeof(shapes) === \"undefined\") {\r\n    shapes = [];\r\n    return;\r\n  }\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ExtrudeGeometry';\r\n\r\n  shapes = shapes instanceof Array ? shapes : [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n  // can't really use automatic vertex normals\r\n  // as then front and back sides get smoothed too\r\n  // should do separate smoothing just for sides\r\n\r\n  //this.computeVertexNormals();\r\n\r\n  //console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function(shapes, options) {\r\n  var sl = shapes.length;\r\n\r\n  for (var s = 0; s < sl; s++) {\r\n    var shape = shapes[s];\r\n    this.addShape(shape, options);\r\n  }\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  var amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n  var bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n  var bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n  var bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n  var bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n  var extrudePath = options.extrudePath;\r\n  var extrudePts, extrudeByPath = false;\r\n\r\n  var material = options.material;\r\n  var extrudeMaterial = options.extrudeMaterial;\r\n\r\n  // Use default WorldUVGenerator if no UV generators are specified.\r\n  var uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n  var splineTube, binormal, normal, position2;\r\n  if (extrudePath) {\r\n\r\n    extrudePts = extrudePath.getSpacedPoints(steps);\r\n\r\n    extrudeByPath = true;\r\n    bevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n    // SETUP TNB variables\r\n\r\n    // Reuse TNB from TubeGeomtry for now.\r\n    // TODO1 - have a .isClosed in spline?\r\n\r\n    splineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames(extrudePath, steps, false);\r\n\r\n    // console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n    binormal = new THREE.Vector3();\r\n    normal = new THREE.Vector3();\r\n    position2 = new THREE.Vector3();\r\n\r\n  }\r\n\r\n  // Safeguards if bevels are not enabled\r\n\r\n  if (!bevelEnabled) {\r\n\r\n    bevelSegments = 0;\r\n    bevelThickness = 0;\r\n    bevelSize = 0;\r\n\r\n  }\r\n\r\n  // Variables initalization\r\n\r\n  var ahole, h, hl; // looping of holes\r\n  var scope = this;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(ahole)) {\r\n\r\n        holes[h] = ahole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n  }\r\n\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  /* Vertices */\r\n\r\n  var contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    vertices = vertices.concat(ahole);\r\n\r\n  }\r\n\r\n\r\n  function scalePt2(pt, vec, size) {\r\n\r\n    if (!vec) THREE.error(\"THREE.ExtrudeGeometry: vec does not exist\");\r\n\r\n    return vec.clone().multiplyScalar(size).add(pt);\r\n\r\n  }\r\n\r\n  var b, bs, t, z,\r\n    vert, vlen = vertices.length,\r\n    face, flen = faces.length;\r\n\r\n\r\n  // Find directions for point movement\r\n\r\n\r\n  function getBevelVec(inPt, inPrev, inNext) {\r\n\r\n    var EPSILON = 0.0000000001;\r\n\r\n    // computes for inPt the corresponding point inPt' on a new contour\r\n    //   shiftet by 1 unit (length of normalized vector) to the left\r\n    // if we walk along contour clockwise, this new contour is outside the old one\r\n    //\r\n    // inPt' is the intersection of the two lines parallel to the two\r\n    //  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n    var v_trans_x, v_trans_y, shrink_by = 1; // resulting translation vector for inPt\r\n\r\n    // good reading for geometry algorithms (here: line-line intersection)\r\n    // http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n    var v_prev_x = inPt.x - inPrev.x,\r\n      v_prev_y = inPt.y - inPrev.y;\r\n    var v_next_x = inNext.x - inPt.x,\r\n      v_next_y = inNext.y - inPt.y;\r\n\r\n    var v_prev_lensq = (v_prev_x * v_prev_x + v_prev_y * v_prev_y);\r\n\r\n    // check for colinear edges\r\n    var colinear0 = (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n    if (Math.abs(colinear0) > EPSILON) { // not colinear\r\n\r\n      // length of vectors for normalizing\r\n\r\n      var v_prev_len = Math.sqrt(v_prev_lensq);\r\n      var v_next_len = Math.sqrt(v_next_x * v_next_x + v_next_y * v_next_y);\r\n\r\n      // shift adjacent points by unit vectors to the left\r\n\r\n      var ptPrevShift_x = (inPrev.x - v_prev_y / v_prev_len);\r\n      var ptPrevShift_y = (inPrev.y + v_prev_x / v_prev_len);\r\n\r\n      var ptNextShift_x = (inNext.x - v_next_y / v_next_len);\r\n      var ptNextShift_y = (inNext.y + v_next_x / v_next_len);\r\n\r\n      // scaling factor for v_prev to intersection point\r\n\r\n      var sf = ((ptNextShift_x - ptPrevShift_x) * v_next_y -\r\n          (ptNextShift_y - ptPrevShift_y) * v_next_x) /\r\n        (v_prev_x * v_next_y - v_prev_y * v_next_x);\r\n\r\n      // vector from inPt to intersection point\r\n\r\n      v_trans_x = (ptPrevShift_x + v_prev_x * sf - inPt.x);\r\n      v_trans_y = (ptPrevShift_y + v_prev_y * sf - inPt.y);\r\n\r\n      // Don't normalize!, otherwise sharp corners become ugly\r\n      //  but prevent crazy spikes\r\n      var v_trans_lensq = (v_trans_x * v_trans_x + v_trans_y * v_trans_y)\r\n      if (v_trans_lensq <= 2) {\r\n        return new THREE.Vector2(v_trans_x, v_trans_y);\r\n      }\r\n      else {\r\n        shrink_by = Math.sqrt(v_trans_lensq / 2);\r\n      }\r\n\r\n    }\r\n    else { // handle special case of colinear edges\r\n\r\n      var direction_eq = false; // assumes: opposite\r\n      if (v_prev_x > EPSILON) {\r\n        if (v_next_x > EPSILON) {\r\n          direction_eq = true;\r\n        }\r\n      }\r\n      else {\r\n        if (v_prev_x < -EPSILON) {\r\n          if (v_next_x < -EPSILON) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n        else {\r\n          if (Math.sign(v_prev_y) == Math.sign(v_next_y)) {\r\n            direction_eq = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (direction_eq) {\r\n        // console.log(\"Warning: lines are a straight sequence\");\r\n        v_trans_x = -v_prev_y;\r\n        v_trans_y = v_prev_x;\r\n        shrink_by = Math.sqrt(v_prev_lensq);\r\n      }\r\n      else {\r\n        // console.log(\"Warning: lines are a straight spike\");\r\n        v_trans_x = v_prev_x;\r\n        v_trans_y = v_prev_y;\r\n        shrink_by = Math.sqrt(v_prev_lensq / 2);\r\n      }\r\n\r\n    }\r\n\r\n    return new THREE.Vector2(v_trans_x / shrink_by, v_trans_y / shrink_by);\r\n\r\n  }\r\n\r\n\r\n  var contourMovements = [];\r\n\r\n  for (var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n    if (j === il) j = 0;\r\n    if (k === il) k = 0;\r\n\r\n    //  (j)---(i)---(k)\r\n    // console.log('i,j,k', i, j , k)\r\n\r\n    contourMovements[i] = getBevelVec(contour[i], contour[j], contour[k]);\r\n\r\n  }\r\n\r\n  var holesMovements = [],\r\n    oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n  for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n    ahole = holes[h];\r\n\r\n    oneHoleMovements = [];\r\n\r\n    for (i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i++, j++, k++) {\r\n\r\n      if (j === il) j = 0;\r\n      if (k === il) k = 0;\r\n\r\n      //  (j)---(i)---(k)\r\n      oneHoleMovements[i] = getBevelVec(ahole[i], ahole[j], ahole[k]);\r\n\r\n    }\r\n\r\n    holesMovements.push(oneHoleMovements);\r\n    verticesMovements = verticesMovements.concat(oneHoleMovements);\r\n\r\n  }\r\n\r\n\r\n  // Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n  for (b = 0; b < bevelSegments; b++) {\r\n    //for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n\r\n    //z = bevelThickness * t;\r\n    bs = bevelSize * (Math.sin(t * Math.PI / 2)); // curved\r\n    //bs = bevelSize * t ; // linear\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n\r\n      v(vert.x, vert.y, -z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        v(vert.x, vert.y, -z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  bs = bevelSize;\r\n\r\n  // Back facing vertices\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n    if (!extrudeByPath) {\r\n\r\n      v(vert.x, vert.y, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      // v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n      normal.copy(splineTube.normals[0]).multiplyScalar(vert.x);\r\n      binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y);\r\n\r\n      position2.copy(extrudePts[0]).add(normal).add(binormal);\r\n\r\n      v(position2.x, position2.y, position2.z);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Add stepped vertices...\r\n  // Including front facing vertices\r\n\r\n  var s;\r\n\r\n  for (s = 1; s <= steps; s++) {\r\n\r\n    for (i = 0; i < vlen; i++) {\r\n\r\n      vert = bevelEnabled ? scalePt2(vertices[i], verticesMovements[i], bs) : vertices[i];\r\n\r\n      if (!extrudeByPath) {\r\n\r\n        v(vert.x, vert.y, amount / steps * s);\r\n\r\n      }\r\n      else {\r\n\r\n        // v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n        normal.copy(splineTube.normals[s]).multiplyScalar(vert.x);\r\n        binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y);\r\n\r\n        position2.copy(extrudePts[s]).add(normal).add(binormal);\r\n\r\n        v(position2.x, position2.y, position2.z);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Add bevel segments planes\r\n\r\n  //for ( b = 1; b <= bevelSegments; b ++ ) {\r\n  for (b = bevelSegments - 1; b >= 0; b--) {\r\n\r\n    t = b / bevelSegments;\r\n    z = bevelThickness * (1 - t);\r\n    //bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n    bs = bevelSize * Math.sin(t * Math.PI / 2);\r\n\r\n    // contract shape\r\n\r\n    for (i = 0, il = contour.length; i < il; i++) {\r\n\r\n      vert = scalePt2(contour[i], contourMovements[i], bs);\r\n      v(vert.x, vert.y, amount + z);\r\n\r\n    }\r\n\r\n    // expand holes\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      oneHoleMovements = holesMovements[h];\r\n\r\n      for (i = 0, il = ahole.length; i < il; i++) {\r\n\r\n        vert = scalePt2(ahole[i], oneHoleMovements[i], bs);\r\n\r\n        if (!extrudeByPath) {\r\n\r\n          v(vert.x, vert.y, amount + z);\r\n\r\n        }\r\n        else {\r\n\r\n          v(vert.x, vert.y + extrudePts[steps - 1].y, extrudePts[steps - 1].x + z);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  /* Faces */\r\n\r\n  // Top and bottom faces\r\n\r\n  buildLidFaces();\r\n\r\n  // Sides faces\r\n\r\n  buildSideFaces();\r\n\r\n\r\n  /////  Internal functions\r\n\r\n  function buildLidFaces() {\r\n\r\n    if (bevelEnabled) {\r\n\r\n      var layer = 0; // steps + 1\r\n      var offset = vlen * layer;\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2] + offset, face[1] + offset, face[0] + offset);\r\n\r\n      }\r\n\r\n      layer = steps + bevelSegments * 2;\r\n      offset = vlen * layer;\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + offset, face[1] + offset, face[2] + offset);\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      // Bottom faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[2], face[1], face[0]);\r\n\r\n      }\r\n\r\n      // Top faces\r\n\r\n      for (i = 0; i < flen; i++) {\r\n\r\n        face = faces[i];\r\n        f3(face[0] + vlen * steps, face[1] + vlen * steps, face[2] + vlen * steps);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  // Create faces for the z-sides of the shape\r\n\r\n  function buildSideFaces() {\r\n\r\n    var layeroffset = 0;\r\n    sidewalls(contour, layeroffset);\r\n    layeroffset += contour.length;\r\n\r\n    for (h = 0, hl = holes.length; h < hl; h++) {\r\n\r\n      ahole = holes[h];\r\n      sidewalls(ahole, layeroffset);\r\n\r\n      //, true\r\n      layeroffset += ahole.length;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  function sidewalls(contour, layeroffset) {\r\n\r\n    var j, k;\r\n    i = contour.length;\r\n\r\n    while (--i >= 0) {\r\n\r\n      j = i;\r\n      k = i - 1;\r\n      if (k < 0) k = contour.length - 1;\r\n\r\n      //console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n      var s = 0,\r\n        sl = steps + bevelSegments * 2;\r\n\r\n      for (s = 0; s < sl; s++) {\r\n\r\n        var slen1 = vlen * s;\r\n        var slen2 = vlen * (s + 1);\r\n\r\n        var a = layeroffset + j + slen1,\r\n          b = layeroffset + k + slen1,\r\n          c = layeroffset + k + slen2,\r\n          d = layeroffset + j + slen2;\r\n\r\n        f4(a, b, c, d, contour, s, sl, j, k);\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n\r\n  function v(x, y, z) {\r\n\r\n    scope.vertices.push(new THREE.Vector3(x, y, z));\r\n\r\n  }\r\n\r\n  function f3(a, b, c) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n\r\n    // normal, color, material\r\n    scope.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n\r\n    var uvs = uvgen.generateTopUV(scope, a, b, c);\r\n\r\n    scope.faceVertexUvs[0].push(uvs);\r\n\r\n  }\r\n\r\n  function f4(a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2) {\r\n\r\n    a += shapesOffset;\r\n    b += shapesOffset;\r\n    c += shapesOffset;\r\n    d += shapesOffset;\r\n\r\n    scope.faces.push(new THREE.Face3(a, b, d, null, null, extrudeMaterial));\r\n    scope.faces.push(new THREE.Face3(b, c, d, null, null, extrudeMaterial));\r\n\r\n    var uvs = uvgen.generateSideWallUV(scope, a, b, c, d);\r\n\r\n    scope.faceVertexUvs[0].push([uvs[0], uvs[1], uvs[3]]);\r\n    scope.faceVertexUvs[0].push([uvs[1], uvs[2], uvs[3]]);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n  generateTopUV: function(geometry, indexA, indexB, indexC) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n\r\n    return [\r\n      new THREE.Vector2(a.x, a.y),\r\n      new THREE.Vector2(b.x, b.y),\r\n      new THREE.Vector2(c.x, c.y)\r\n    ];\r\n\r\n  },\r\n\r\n  generateSideWallUV: function(geometry, indexA, indexB, indexC, indexD) {\r\n\r\n    var vertices = geometry.vertices;\r\n\r\n    var a = vertices[indexA];\r\n    var b = vertices[indexB];\r\n    var c = vertices[indexC];\r\n    var d = vertices[indexD];\r\n\r\n    if (Math.abs(a.y - b.y) < 0.01) {\r\n      return [\r\n        new THREE.Vector2(a.x, 1 - a.z),\r\n        new THREE.Vector2(b.x, 1 - b.z),\r\n        new THREE.Vector2(c.x, 1 - c.z),\r\n        new THREE.Vector2(d.x, 1 - d.z)\r\n      ];\r\n    }\r\n    else {\r\n      return [\r\n        new THREE.Vector2(a.y, 1 - a.z),\r\n        new THREE.Vector2(b.y, 1 - b.z),\r\n        new THREE.Vector2(c.y, 1 - c.z),\r\n        new THREE.Vector2(d.y, 1 - d.z)\r\n      ];\r\n    }\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function(shapes, options) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ShapeGeometry';\r\n\r\n  if (shapes instanceof Array === false) shapes = [shapes];\r\n\r\n  this.addShapeList(shapes, options);\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function(shapes, options) {\r\n\r\n  for (var i = 0, l = shapes.length; i < l; i++) {\r\n\r\n    this.addShape(shapes[i], options);\r\n\r\n  }\r\n\r\n  return this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function(shape, options) {\r\n\r\n  if (options === undefined) options = {};\r\n  var curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n  var material = options.material;\r\n  var uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n  //\r\n\r\n  var i, l, hole;\r\n\r\n  var shapesOffset = this.vertices.length;\r\n  var shapePoints = shape.extractPoints(curveSegments);\r\n\r\n  var vertices = shapePoints.shape;\r\n  var holes = shapePoints.holes;\r\n\r\n  var reverse = !THREE.Shape.Utils.isClockWise(vertices);\r\n\r\n  if (reverse) {\r\n\r\n    vertices = vertices.reverse();\r\n\r\n    // Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n    for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n      hole = holes[i];\r\n\r\n      if (THREE.Shape.Utils.isClockWise(hole)) {\r\n\r\n        holes[i] = hole.reverse();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    reverse = false;\r\n\r\n  }\r\n\r\n  var faces = THREE.Shape.Utils.triangulateShape(vertices, holes);\r\n\r\n  // Vertices\r\n\r\n  var contour = vertices;\r\n\r\n  for (i = 0, l = holes.length; i < l; i++) {\r\n\r\n    hole = holes[i];\r\n    vertices = vertices.concat(hole);\r\n\r\n  }\r\n\r\n  //\r\n\r\n  var vert, vlen = vertices.length;\r\n  var face, flen = faces.length;\r\n\r\n  for (i = 0; i < vlen; i++) {\r\n\r\n    vert = vertices[i];\r\n\r\n    this.vertices.push(new THREE.Vector3(vert.x, vert.y, 0));\r\n\r\n  }\r\n\r\n  for (i = 0; i < flen; i++) {\r\n\r\n    face = faces[i];\r\n\r\n    var a = face[0] + shapesOffset;\r\n    var b = face[1] + shapesOffset;\r\n    var c = face[2] + shapesOffset;\r\n\r\n    this.faces.push(new THREE.Face3(a, b, c, null, null, material));\r\n    this.faceVertexUvs[0].push(uvgen.generateTopUV(this, a, b, c));\r\n\r\n  }\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points \r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2*PI) range of the lathed section\r\n//    2*pi is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function(points, segments, phiStart, phiLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'LatheGeometry';\r\n\r\n  this.parameters = {\r\n    points: points,\r\n    segments: segments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength\r\n  };\r\n\r\n  segments = segments || 12;\r\n  phiStart = phiStart || 0;\r\n  phiLength = phiLength || 2 * Math.PI;\r\n\r\n  var inversePointLength = 1.0 / (points.length - 1);\r\n  var inverseSegments = 1.0 / segments;\r\n\r\n  for (var i = 0, il = segments; i <= il; i++) {\r\n\r\n    var phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n    var c = Math.cos(phi),\r\n      s = Math.sin(phi);\r\n\r\n    for (var j = 0, jl = points.length; j < jl; j++) {\r\n\r\n      var pt = points[j];\r\n\r\n      var vertex = new THREE.Vector3();\r\n\r\n      vertex.x = c * pt.x - s * pt.y;\r\n      vertex.y = s * pt.x + c * pt.y;\r\n      vertex.z = pt.z;\r\n\r\n      this.vertices.push(vertex);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var np = points.length;\r\n\r\n  for (var i = 0, il = segments; i < il; i++) {\r\n\r\n    for (var j = 0, jl = points.length - 1; j < jl; j++) {\r\n\r\n      var base = j + np * i;\r\n      var a = base;\r\n      var b = base + np;\r\n      var c = base + 1 + np;\r\n      var d = base + 1;\r\n\r\n      var u0 = i * inverseSegments;\r\n      var v0 = j * inversePointLength;\r\n      var u1 = u0 + inverseSegments;\r\n      var v1 = v0 + inversePointLength;\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u0, v0),\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n\r\n      this.faceVertexUvs[0].push([\r\n\r\n        new THREE.Vector2(u1, v0),\r\n        new THREE.Vector2(u1, v1),\r\n        new THREE.Vector2(u0, v1)\r\n\r\n      ]);\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.mergeVertices();\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  console.info('THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.');\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PlaneGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  this.fromBufferGeometry(new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments));\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function(width, height, widthSegments, heightSegments) {\r\n\r\n  THREE.BufferGeometry.call(this);\r\n\r\n  this.type = 'PlaneBufferGeometry';\r\n\r\n  this.parameters = {\r\n    width: width,\r\n    height: height,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments\r\n  };\r\n\r\n  var width_half = width / 2;\r\n  var height_half = height / 2;\r\n\r\n  var gridX = widthSegments || 1;\r\n  var gridY = heightSegments || 1;\r\n\r\n  var gridX1 = gridX + 1;\r\n  var gridY1 = gridY + 1;\r\n\r\n  var segment_width = width / gridX;\r\n  var segment_height = height / gridY;\r\n\r\n  var vertices = new Float32Array(gridX1 * gridY1 * 3);\r\n  var normals = new Float32Array(gridX1 * gridY1 * 3);\r\n  var uvs = new Float32Array(gridX1 * gridY1 * 2);\r\n\r\n  var offset = 0;\r\n  var offset2 = 0;\r\n\r\n  for (var iy = 0; iy < gridY1; iy++) {\r\n\r\n    var y = iy * segment_height - height_half;\r\n\r\n    for (var ix = 0; ix < gridX1; ix++) {\r\n\r\n      var x = ix * segment_width - width_half;\r\n\r\n      vertices[offset] = x;\r\n      vertices[offset + 1] = -y;\r\n\r\n      normals[offset + 2] = 1;\r\n\r\n      uvs[offset2] = ix / gridX;\r\n      uvs[offset2 + 1] = 1 - (iy / gridY);\r\n\r\n      offset += 3;\r\n      offset2 += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  offset = 0;\r\n\r\n  var indices = new((vertices.length / 3) > 65535 ? Uint32Array : Uint16Array)(gridX * gridY * 6);\r\n\r\n  for (var iy = 0; iy < gridY; iy++) {\r\n\r\n    for (var ix = 0; ix < gridX; ix++) {\r\n\r\n      var a = ix + gridX1 * iy;\r\n      var b = ix + gridX1 * (iy + 1);\r\n      var c = (ix + 1) + gridX1 * (iy + 1);\r\n      var d = (ix + 1) + gridX1 * iy;\r\n\r\n      indices[offset] = a;\r\n      indices[offset + 1] = b;\r\n      indices[offset + 2] = d;\r\n\r\n      indices[offset + 3] = b;\r\n      indices[offset + 4] = c;\r\n      indices[offset + 5] = d;\r\n\r\n      offset += 6;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.addAttribute('index', new THREE.BufferAttribute(indices, 1));\r\n  this.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  this.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\r\n  this.addAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function(innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'RingGeometry';\r\n\r\n  this.parameters = {\r\n    innerRadius: innerRadius,\r\n    outerRadius: outerRadius,\r\n    thetaSegments: thetaSegments,\r\n    phiSegments: phiSegments,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  innerRadius = innerRadius || 0;\r\n  outerRadius = outerRadius || 50;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n  thetaSegments = thetaSegments !== undefined ? Math.max(3, thetaSegments) : 8;\r\n  phiSegments = phiSegments !== undefined ? Math.max(1, phiSegments) : 8;\r\n\r\n  var i, o, uvs = [],\r\n    radius = innerRadius,\r\n    radiusStep = ((outerRadius - innerRadius) / phiSegments);\r\n\r\n  for (i = 0; i < phiSegments + 1; i++) { // concentric circles inside ring\r\n\r\n    for (o = 0; o < thetaSegments + 1; o++) { // number of segments per circle\r\n\r\n      var vertex = new THREE.Vector3();\r\n      var segment = thetaStart + o / thetaSegments * thetaLength;\r\n      vertex.x = radius * Math.cos(segment);\r\n      vertex.y = radius * Math.sin(segment);\r\n\r\n      this.vertices.push(vertex);\r\n      uvs.push(new THREE.Vector2((vertex.x / outerRadius + 1) / 2, (vertex.y / outerRadius + 1) / 2));\r\n    }\r\n\r\n    radius += radiusStep;\r\n\r\n  }\r\n\r\n  var n = new THREE.Vector3(0, 0, 1);\r\n\r\n  for (i = 0; i < phiSegments; i++) { // concentric circles inside ring\r\n\r\n    var thetaSegment = i * (thetaSegments + 1);\r\n\r\n    for (o = 0; o < thetaSegments; o++) { // number of segments per circle\r\n\r\n      var segment = o + thetaSegment;\r\n\r\n      var v1 = segment;\r\n      var v2 = segment + thetaSegments + 1;\r\n      var v3 = segment + thetaSegments + 2;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n      v1 = segment;\r\n      v2 = segment + thetaSegments + 2;\r\n      v3 = segment + 1;\r\n\r\n      this.faces.push(new THREE.Face3(v1, v2, v3, [n.clone(), n.clone(), n.clone()]));\r\n      this.faceVertexUvs[0].push([uvs[v1].clone(), uvs[v2].clone(), uvs[v3].clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'SphereGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    widthSegments: widthSegments,\r\n    heightSegments: heightSegments,\r\n    phiStart: phiStart,\r\n    phiLength: phiLength,\r\n    thetaStart: thetaStart,\r\n    thetaLength: thetaLength\r\n  };\r\n\r\n  radius = radius || 50;\r\n\r\n  widthSegments = Math.max(3, Math.floor(widthSegments) || 8);\r\n  heightSegments = Math.max(2, Math.floor(heightSegments) || 6);\r\n\r\n  phiStart = phiStart !== undefined ? phiStart : 0;\r\n  phiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n  thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n  thetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n  var x, y, vertices = [],\r\n    uvs = [];\r\n\r\n  for (y = 0; y <= heightSegments; y++) {\r\n\r\n    var verticesRow = [];\r\n    var uvsRow = [];\r\n\r\n    for (x = 0; x <= widthSegments; x++) {\r\n\r\n      var u = x / widthSegments;\r\n      var v = y / heightSegments;\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = -radius * Math.cos(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n      vertex.y = radius * Math.cos(thetaStart + v * thetaLength);\r\n      vertex.z = radius * Math.sin(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      verticesRow.push(this.vertices.length - 1);\r\n      uvsRow.push(new THREE.Vector2(u, 1 - v));\r\n\r\n    }\r\n\r\n    vertices.push(verticesRow);\r\n    uvs.push(uvsRow);\r\n\r\n  }\r\n\r\n  for (y = 0; y < heightSegments; y++) {\r\n\r\n    for (x = 0; x < widthSegments; x++) {\r\n\r\n      var v1 = vertices[y][x + 1];\r\n      var v2 = vertices[y][x];\r\n      var v3 = vertices[y + 1][x];\r\n      var v4 = vertices[y + 1][x + 1];\r\n\r\n      var n1 = this.vertices[v1].clone().normalize();\r\n      var n2 = this.vertices[v2].clone().normalize();\r\n      var n3 = this.vertices[v3].clone().normalize();\r\n      var n4 = this.vertices[v4].clone().normalize();\r\n\r\n      var uv1 = uvs[y][x + 1].clone();\r\n      var uv2 = uvs[y][x].clone();\r\n      var uv3 = uvs[y + 1][x].clone();\r\n      var uv4 = uvs[y + 1][x + 1].clone();\r\n\r\n      if (Math.abs(this.vertices[v1].y) === radius) {\r\n\r\n        uv1.x = (uv1.x + uv2.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v3, v4, [n1, n3, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv3, uv4]);\r\n\r\n      }\r\n      else if (Math.abs(this.vertices[v3].y) === radius) {\r\n\r\n        uv3.x = (uv3.x + uv4.x) / 2;\r\n        this.faces.push(new THREE.Face3(v1, v2, v3, [n1, n2, n3]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv3]);\r\n\r\n      }\r\n      else {\r\n\r\n        this.faces.push(new THREE.Face3(v1, v2, v4, [n1, n2, n4]));\r\n        this.faceVertexUvs[0].push([uv1, uv2, uv4]);\r\n\r\n        this.faces.push(new THREE.Face3(v2, v3, v4, [n2.clone(), n3, n4.clone()]));\r\n        this.faceVertexUvs[0].push([uv2.clone(), uv3, uv4.clone()]);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * For creating 3D text geometry in three.js\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  size: \t\t\t<float>, \t// size of the text\r\n *  height: \t\t<float>, \t// thickness to extrude text\r\n *  curveSegments: \t<int>,\t\t// number of points on the curves\r\n *\r\n *  font: \t\t\t<string>,\t\t// font name\r\n *  weight: \t\t<string>,\t\t// font weight (normal, bold)\r\n *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\r\n *\r\n *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\r\n *  bevelThickness: <float>, \t\t// how deep into text bevel goes\r\n *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\r\n *  }\r\n *\r\n */\r\n\r\n/*\tUsage Examples\r\n\r\n\t// TextGeometry wrapper\r\n\r\n\tvar text3d = new TextGeometry( text, options );\r\n\r\n\t// Complete manner\r\n\r\n\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\r\n\tvar text3d = new ExtrudeGeometry( textShapes, options );\r\n\r\n*/\r\n\r\n\r\nTHREE.TextGeometry = function(text, parameters) {\r\n\r\n  parameters = parameters || {};\r\n\r\n  var textShapes = THREE.FontUtils.generateShapes(text, parameters);\r\n\r\n  // translate parameters to ExtrudeGeometry API\r\n\r\n  parameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n  // defaults\r\n\r\n  if (parameters.bevelThickness === undefined) parameters.bevelThickness = 10;\r\n  if (parameters.bevelSize === undefined) parameters.bevelSize = 8;\r\n  if (parameters.bevelEnabled === undefined) parameters.bevelEnabled = false;\r\n\r\n  THREE.ExtrudeGeometry.call(this, textShapes, parameters);\r\n\r\n  this.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create(THREE.ExtrudeGeometry.prototype);\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function(radius, tube, radialSegments, tubularSegments, arc) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    arc: arc\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 8;\r\n  tubularSegments = tubularSegments || 6;\r\n  arc = arc || Math.PI * 2;\r\n\r\n  var center = new THREE.Vector3(),\r\n    uvs = [],\r\n    normals = [];\r\n\r\n  for (var j = 0; j <= radialSegments; j++) {\r\n\r\n    for (var i = 0; i <= tubularSegments; i++) {\r\n\r\n      var u = i / tubularSegments * arc;\r\n      var v = j / radialSegments * Math.PI * 2;\r\n\r\n      center.x = radius * Math.cos(u);\r\n      center.y = radius * Math.sin(u);\r\n\r\n      var vertex = new THREE.Vector3();\r\n      vertex.x = (radius + tube * Math.cos(v)) * Math.cos(u);\r\n      vertex.y = (radius + tube * Math.cos(v)) * Math.sin(u);\r\n      vertex.z = tube * Math.sin(v);\r\n\r\n      this.vertices.push(vertex);\r\n\r\n      uvs.push(new THREE.Vector2(i / tubularSegments, j / radialSegments));\r\n      normals.push(vertex.clone().sub(center).normalize());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var j = 1; j <= radialSegments; j++) {\r\n\r\n    for (var i = 1; i <= tubularSegments; i++) {\r\n\r\n      var a = (tubularSegments + 1) * j + i - 1;\r\n      var b = (tubularSegments + 1) * (j - 1) + i - 1;\r\n      var c = (tubularSegments + 1) * (j - 1) + i;\r\n      var d = (tubularSegments + 1) * j + i;\r\n\r\n      var face = new THREE.Face3(a, b, d, [normals[a].clone(), normals[b].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[a].clone(), uvs[b].clone(), uvs[d].clone()]);\r\n\r\n      face = new THREE.Face3(b, c, d, [normals[b].clone(), normals[c].clone(), normals[d].clone()]);\r\n      this.faces.push(face);\r\n      this.faceVertexUvs[0].push([uvs[b].clone(), uvs[c].clone(), uvs[d].clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function(radius, tube, radialSegments, tubularSegments, p, q, heightScale) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TorusKnotGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    tube: tube,\r\n    radialSegments: radialSegments,\r\n    tubularSegments: tubularSegments,\r\n    p: p,\r\n    q: q,\r\n    heightScale: heightScale\r\n  };\r\n\r\n  radius = radius || 100;\r\n  tube = tube || 40;\r\n  radialSegments = radialSegments || 64;\r\n  tubularSegments = tubularSegments || 8;\r\n  p = p || 2;\r\n  q = q || 3;\r\n  heightScale = heightScale || 1;\r\n\r\n  var grid = new Array(radialSegments);\r\n  var tang = new THREE.Vector3();\r\n  var n = new THREE.Vector3();\r\n  var bitan = new THREE.Vector3();\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    grid[i] = new Array(tubularSegments);\r\n    var u = i / radialSegments * 2 * p * Math.PI;\r\n    var p1 = getPos(u, q, p, radius, heightScale);\r\n    var p2 = getPos(u + 0.01, q, p, radius, heightScale);\r\n    tang.subVectors(p2, p1);\r\n    n.addVectors(p2, p1);\r\n\r\n    bitan.crossVectors(tang, n);\r\n    n.crossVectors(bitan, tang);\r\n    bitan.normalize();\r\n    n.normalize();\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var v = j / tubularSegments * 2 * Math.PI;\r\n      var cx = -tube * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      var cy = tube * Math.sin(v);\r\n\r\n      var pos = new THREE.Vector3();\r\n      pos.x = p1.x + cx * n.x + cy * bitan.x;\r\n      pos.y = p1.y + cx * n.y + cy * bitan.y;\r\n      pos.z = p1.z + cx * n.z + cy * bitan.z;\r\n\r\n      grid[i][j] = this.vertices.push(pos) - 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var i = 0; i < radialSegments; ++i) {\r\n\r\n    for (var j = 0; j < tubularSegments; ++j) {\r\n\r\n      var ip = (i + 1) % radialSegments;\r\n      var jp = (j + 1) % tubularSegments;\r\n\r\n      var a = grid[i][j];\r\n      var b = grid[ip][j];\r\n      var c = grid[ip][jp];\r\n      var d = grid[i][jp];\r\n\r\n      var uva = new THREE.Vector2(i / radialSegments, j / tubularSegments);\r\n      var uvb = new THREE.Vector2((i + 1) / radialSegments, j / tubularSegments);\r\n      var uvc = new THREE.Vector2((i + 1) / radialSegments, (j + 1) / tubularSegments);\r\n      var uvd = new THREE.Vector2(i / radialSegments, (j + 1) / tubularSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n  function getPos(u, in_q, in_p, radius, heightScale) {\r\n\r\n    var cu = Math.cos(u);\r\n    var su = Math.sin(u);\r\n    var quOverP = in_q / in_p * u;\r\n    var cs = Math.cos(quOverP);\r\n\r\n    var tx = radius * (2 + cs) * 0.5 * cu;\r\n    var ty = radius * (2 + cs) * su * 0.5;\r\n    var tz = heightScale * radius * Math.sin(quOverP) * 0.5;\r\n\r\n    return new THREE.Vector3(tx, ty, tz);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function(path, segments, radius, radialSegments, closed, taper) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'TubeGeometry';\r\n\r\n  this.parameters = {\r\n    path: path,\r\n    segments: segments,\r\n    radius: radius,\r\n    radialSegments: radialSegments,\r\n    closed: closed\r\n  };\r\n\r\n  segments = segments || 64;\r\n  radius = radius || 1;\r\n  radialSegments = radialSegments || 8;\r\n  closed = closed || false;\r\n  taper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n  var grid = [];\r\n\r\n  var scope = this,\r\n\r\n    tangent,\r\n    normal,\r\n    binormal,\r\n\r\n    numpoints = segments + 1,\r\n\r\n    u, v, r,\r\n\r\n    cx, cy,\r\n    pos, pos2 = new THREE.Vector3(),\r\n    i, j,\r\n    ip, jp,\r\n    a, b, c, d,\r\n    uva, uvb, uvc, uvd;\r\n\r\n  var frames = new THREE.TubeGeometry.FrenetFrames(path, segments, closed),\r\n    tangents = frames.tangents,\r\n    normals = frames.normals,\r\n    binormals = frames.binormals;\r\n\r\n  // proxy internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  function vert(x, y, z) {\r\n\r\n    return scope.vertices.push(new THREE.Vector3(x, y, z)) - 1;\r\n\r\n  }\r\n\r\n  // consruct the grid\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    grid[i] = [];\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    pos = path.getPointAt(u);\r\n\r\n    tangent = tangents[i];\r\n    normal = normals[i];\r\n    binormal = binormals[i];\r\n\r\n    r = radius * taper(u);\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      v = j / radialSegments * 2 * Math.PI;\r\n\r\n      cx = -r * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\r\n      cy = r * Math.sin(v);\r\n\r\n      pos2.copy(pos);\r\n      pos2.x += cx * normal.x + cy * binormal.x;\r\n      pos2.y += cx * normal.y + cy * binormal.y;\r\n      pos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n      grid[i][j] = vert(pos2.x, pos2.y, pos2.z);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  // construct the mesh\r\n\r\n  for (i = 0; i < segments; i++) {\r\n\r\n    for (j = 0; j < radialSegments; j++) {\r\n\r\n      ip = (closed) ? (i + 1) % segments : i + 1;\r\n      jp = (j + 1) % radialSegments;\r\n\r\n      a = grid[i][j]; // *** NOT NECESSARILY PLANAR ! ***\r\n      b = grid[ip][j];\r\n      c = grid[ip][jp];\r\n      d = grid[i][jp];\r\n\r\n      uva = new THREE.Vector2(i / segments, j / radialSegments);\r\n      uvb = new THREE.Vector2((i + 1) / segments, j / radialSegments);\r\n      uvc = new THREE.Vector2((i + 1) / segments, (j + 1) / radialSegments);\r\n      uvd = new THREE.Vector2(i / segments, (j + 1) / radialSegments);\r\n\r\n      this.faces.push(new THREE.Face3(a, b, d));\r\n      this.faceVertexUvs[0].push([uva, uvb, uvd]);\r\n\r\n      this.faces.push(new THREE.Face3(b, c, d));\r\n      this.faceVertexUvs[0].push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n  }\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function(u) {\r\n\r\n  return 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function(u) {\r\n\r\n  return Math.sin(Math.PI * u);\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function(path, segments, closed) {\r\n\r\n  var normal = new THREE.Vector3(),\r\n\r\n    tangents = [],\r\n    normals = [],\r\n    binormals = [],\r\n\r\n    vec = new THREE.Vector3(),\r\n    mat = new THREE.Matrix4(),\r\n\r\n    numpoints = segments + 1,\r\n    theta,\r\n    epsilon = 0.0001,\r\n    smallest,\r\n\r\n    tx, ty, tz,\r\n    i, u;\r\n\r\n\r\n  // expose internals\r\n  this.tangents = tangents;\r\n  this.normals = normals;\r\n  this.binormals = binormals;\r\n\r\n  // compute the tangent vectors for each segment on the path\r\n\r\n  for (i = 0; i < numpoints; i++) {\r\n\r\n    u = i / (numpoints - 1);\r\n\r\n    tangents[i] = path.getTangentAt(u);\r\n    tangents[i].normalize();\r\n\r\n  }\r\n\r\n  initialNormal3();\r\n\r\n  /*\r\n  function initialNormal1(lastBinormal) {\r\n  \t// fixed start binormal. Has dangers of 0 vectors\r\n  \tnormals[ 0 ] = new THREE.Vector3();\r\n  \tbinormals[ 0 ] = new THREE.Vector3();\r\n  \tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n  \tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n  }\r\n\r\n  function initialNormal2() {\r\n\r\n  \t// This uses the Frenet-Serret formula for deriving binormal\r\n  \tvar t2 = path.getTangentAt( epsilon );\r\n\r\n  \tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n  \tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n  \tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n  \tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n  }\r\n  */\r\n\r\n  function initialNormal3() {\r\n    // select an initial normal vector perpenicular to the first tangent vector,\r\n    // and in the direction of the smallest tangent xyz component\r\n\r\n    normals[0] = new THREE.Vector3();\r\n    binormals[0] = new THREE.Vector3();\r\n    smallest = Number.MAX_VALUE;\r\n    tx = Math.abs(tangents[0].x);\r\n    ty = Math.abs(tangents[0].y);\r\n    tz = Math.abs(tangents[0].z);\r\n\r\n    if (tx <= smallest) {\r\n      smallest = tx;\r\n      normal.set(1, 0, 0);\r\n    }\r\n\r\n    if (ty <= smallest) {\r\n      smallest = ty;\r\n      normal.set(0, 1, 0);\r\n    }\r\n\r\n    if (tz <= smallest) {\r\n      normal.set(0, 0, 1);\r\n    }\r\n\r\n    vec.crossVectors(tangents[0], normal).normalize();\r\n\r\n    normals[0].crossVectors(tangents[0], vec);\r\n    binormals[0].crossVectors(tangents[0], normals[0]);\r\n  }\r\n\r\n\r\n  // compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n  for (i = 1; i < numpoints; i++) {\r\n\r\n    normals[i] = normals[i - 1].clone();\r\n\r\n    binormals[i] = binormals[i - 1].clone();\r\n\r\n    vec.crossVectors(tangents[i - 1], tangents[i]);\r\n\r\n    if (vec.length() > epsilon) {\r\n\r\n      vec.normalize();\r\n\r\n      theta = Math.acos(THREE.Math.clamp(tangents[i - 1].dot(tangents[i]), -1, 1)); // clamp for floating pt errors\r\n\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(vec, theta));\r\n\r\n    }\r\n\r\n    binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n  }\r\n\r\n\r\n  // if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n  if (closed) {\r\n\r\n    theta = Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints - 1]), -1, 1));\r\n    theta /= (numpoints - 1);\r\n\r\n    if (tangents[0].dot(vec.crossVectors(normals[0], normals[numpoints - 1])) > 0) {\r\n\r\n      theta = -theta;\r\n\r\n    }\r\n\r\n    for (i = 1; i < numpoints; i++) {\r\n\r\n      // twist a little...\r\n      normals[i].applyMatrix4(mat.makeRotationAxis(tangents[i], theta * i));\r\n      binormals[i].crossVectors(tangents[i], normals[i]);\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.PolyhedronGeometry = function(vertices, indices, radius, detail) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'PolyhedronGeometry';\r\n\r\n  this.parameters = {\r\n    vertices: vertices,\r\n    indices: indices,\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  radius = radius || 1;\r\n  detail = detail || 0;\r\n\r\n  var that = this;\r\n\r\n  for (var i = 0, l = vertices.length; i < l; i += 3) {\r\n\r\n    prepare(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]));\r\n\r\n  }\r\n\r\n  var p = this.vertices;\r\n\r\n  var faces = [];\r\n\r\n  for (var i = 0, j = 0, l = indices.length; i < l; i += 3, j++) {\r\n\r\n    var v1 = p[indices[i]];\r\n    var v2 = p[indices[i + 1]];\r\n    var v3 = p[indices[i + 2]];\r\n\r\n    faces[j] = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n\r\n  }\r\n\r\n  var centroid = new THREE.Vector3();\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    subdivide(faces[i], detail);\r\n\r\n  }\r\n\r\n\r\n  // Handle case when face straddles the seam\r\n\r\n  for (var i = 0, l = this.faceVertexUvs[0].length; i < l; i++) {\r\n\r\n    var uvs = this.faceVertexUvs[0][i];\r\n\r\n    var x0 = uvs[0].x;\r\n    var x1 = uvs[1].x;\r\n    var x2 = uvs[2].x;\r\n\r\n    var max = Math.max(x0, Math.max(x1, x2));\r\n    var min = Math.min(x0, Math.min(x1, x2));\r\n\r\n    if (max > 0.9 && min < 0.1) { // 0.9 is somewhat arbitrary\r\n\r\n      if (x0 < 0.2) uvs[0].x += 1;\r\n      if (x1 < 0.2) uvs[1].x += 1;\r\n      if (x2 < 0.2) uvs[2].x += 1;\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Apply radius\r\n\r\n  for (var i = 0, l = this.vertices.length; i < l; i++) {\r\n\r\n    this.vertices[i].multiplyScalar(radius);\r\n\r\n  }\r\n\r\n\r\n  // Merge vertices\r\n\r\n  this.mergeVertices();\r\n\r\n  this.computeFaceNormals();\r\n\r\n  this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius);\r\n\r\n\r\n  // Project vector onto sphere's surface\r\n\r\n  function prepare(vector) {\r\n\r\n    var vertex = vector.normalize().clone();\r\n    vertex.index = that.vertices.push(vertex) - 1;\r\n\r\n    // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n    var u = azimuth(vector) / 2 / Math.PI + 0.5;\r\n    var v = inclination(vector) / Math.PI + 0.5;\r\n    vertex.uv = new THREE.Vector2(u, 1 - v);\r\n\r\n    return vertex;\r\n\r\n  }\r\n\r\n\r\n  // Approximate a curved face with recursively sub-divided triangles.\r\n\r\n  function make(v1, v2, v3) {\r\n\r\n    var face = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()]);\r\n    that.faces.push(face);\r\n\r\n    centroid.copy(v1).add(v2).add(v3).divideScalar(3);\r\n\r\n    var azi = azimuth(centroid);\r\n\r\n    that.faceVertexUvs[0].push([\r\n      correctUV(v1.uv, v1, azi),\r\n      correctUV(v2.uv, v2, azi),\r\n      correctUV(v3.uv, v3, azi)\r\n    ]);\r\n\r\n  }\r\n\r\n\r\n  // Analytically subdivide a face to the required detail level.\r\n\r\n  function subdivide(face, detail) {\r\n\r\n    var cols = Math.pow(2, detail);\r\n    var a = prepare(that.vertices[face.a]);\r\n    var b = prepare(that.vertices[face.b]);\r\n    var c = prepare(that.vertices[face.c]);\r\n    var v = [];\r\n\r\n    // Construct all of the vertices for this subdivision.\r\n\r\n    for (var i = 0; i <= cols; i++) {\r\n\r\n      v[i] = [];\r\n\r\n      var aj = prepare(a.clone().lerp(c, i / cols));\r\n      var bj = prepare(b.clone().lerp(c, i / cols));\r\n      var rows = cols - i;\r\n\r\n      for (var j = 0; j <= rows; j++) {\r\n\r\n        if (j == 0 && i == cols) {\r\n\r\n          v[i][j] = aj;\r\n\r\n        }\r\n        else {\r\n\r\n          v[i][j] = prepare(aj.clone().lerp(bj, j / rows));\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // Construct all of the faces.\r\n\r\n    for (var i = 0; i < cols; i++) {\r\n\r\n      for (var j = 0; j < 2 * (cols - i) - 1; j++) {\r\n\r\n        var k = Math.floor(j / 2);\r\n\r\n        if (j % 2 == 0) {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k],\r\n            v[i][k]\r\n          );\r\n\r\n        }\r\n        else {\r\n\r\n          make(\r\n            v[i][k + 1],\r\n            v[i + 1][k + 1],\r\n            v[i + 1][k]\r\n          );\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  // Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n  function azimuth(vector) {\r\n\r\n    return Math.atan2(vector.z, -vector.x);\r\n\r\n  }\r\n\r\n\r\n  // Angle above the XZ plane.\r\n\r\n  function inclination(vector) {\r\n\r\n    return Math.atan2(-vector.y, Math.sqrt((vector.x * vector.x) + (vector.z * vector.z)));\r\n\r\n  }\r\n\r\n\r\n  // Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n  function correctUV(uv, vector, azimuth) {\r\n\r\n    if ((azimuth < 0) && (uv.x === 1)) uv = new THREE.Vector2(uv.x - 1, uv.y);\r\n    if ((vector.x === 0) && (vector.z === 0)) uv = new THREE.Vector2(azimuth / 2 / Math.PI + 0.5, uv.y);\r\n    return uv.clone();\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n  var r = 1 / t;\r\n\r\n  var vertices = [\r\n\r\n    // (±1, ±1, ±1)\r\n    -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1,\r\n    1, -1, -1, 1, -1, 1,\r\n    1, 1, -1, 1, 1, 1,\r\n\r\n    // (0, ±1/φ, ±φ)\r\n    0, -r, -t, 0, -r, t,\r\n    0, r, -t, 0, r, t,\r\n\r\n    // (±1/φ, ±φ, 0)\r\n    -r, -t, 0, -r, t, 0,\r\n    r, -t, 0, r, t, 0,\r\n\r\n    // (±φ, 0, ±1/φ)\r\n    -t, 0, -r, t, 0, -r, -t, 0, r, t, 0, r\r\n  ];\r\n\r\n  var indices = [\r\n    3, 11, 7, 3, 7, 15, 3, 15, 13,\r\n    7, 19, 17, 7, 17, 6, 7, 6, 15,\r\n    17, 4, 8, 17, 8, 10, 17, 10, 6,\r\n    8, 0, 16, 8, 16, 2, 8, 2, 10,\r\n    0, 12, 1, 0, 1, 18, 0, 18, 16,\r\n    6, 10, 2, 6, 2, 13, 6, 13, 15,\r\n    2, 16, 18, 2, 18, 3, 2, 3, 13,\r\n    18, 1, 9, 18, 9, 11, 18, 11, 3,\r\n    4, 14, 12, 4, 12, 0, 4, 0, 8,\r\n    11, 9, 5, 11, 5, 19, 11, 19, 7,\r\n    19, 5, 14, 19, 14, 4, 19, 4, 17,\r\n    1, 12, 14, 1, 14, 5, 1, 5, 9\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function(radius, detail) {\r\n\r\n  var t = (1 + Math.sqrt(5)) / 2;\r\n\r\n  var vertices = [-1, t, 0, 1, t, 0, -1, -t, 0, 1, -t, 0,\r\n    0, -1, t, 0, 1, t, 0, -1, -t, 0, 1, -t,\r\n    t, 0, -1, t, 0, 1, -t, 0, -1, -t, 0, 1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11,\r\n    1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8,\r\n    3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9,\r\n    4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'IcosahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function(radius, detail) {\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n  var vertices = [\r\n    1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1\r\n  ];\r\n\r\n  var indices = [\r\n    0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'OctahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function(radius, detail) {\r\n\r\n  var vertices = [\r\n    1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1\r\n  ];\r\n\r\n  var indices = [\r\n    2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1\r\n  ];\r\n\r\n  THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail);\r\n\r\n  this.type = 'TetrahedronGeometry';\r\n\r\n  this.parameters = {\r\n    radius: radius,\r\n    detail: detail\r\n  };\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function(func, slices, stacks) {\r\n\r\n  THREE.Geometry.call(this);\r\n\r\n  this.type = 'ParametricGeometry';\r\n\r\n  this.parameters = {\r\n    func: func,\r\n    slices: slices,\r\n    stacks: stacks\r\n  };\r\n\r\n  var verts = this.vertices;\r\n  var faces = this.faces;\r\n  var uvs = this.faceVertexUvs[0];\r\n\r\n  var i, j, p;\r\n  var u, v;\r\n\r\n  var sliceCount = slices + 1;\r\n\r\n  for (i = 0; i <= stacks; i++) {\r\n\r\n    v = i / stacks;\r\n\r\n    for (j = 0; j <= slices; j++) {\r\n\r\n      u = j / slices;\r\n\r\n      p = func(u, v);\r\n      verts.push(p);\r\n\r\n    }\r\n  }\r\n\r\n  var a, b, c, d;\r\n  var uva, uvb, uvc, uvd;\r\n\r\n  for (i = 0; i < stacks; i++) {\r\n\r\n    for (j = 0; j < slices; j++) {\r\n\r\n      a = i * sliceCount + j;\r\n      b = i * sliceCount + j + 1;\r\n      c = (i + 1) * sliceCount + j + 1;\r\n      d = (i + 1) * sliceCount + j;\r\n\r\n      uva = new THREE.Vector2(j / slices, i / stacks);\r\n      uvb = new THREE.Vector2((j + 1) / slices, i / stacks);\r\n      uvc = new THREE.Vector2((j + 1) / slices, (i + 1) / stacks);\r\n      uvd = new THREE.Vector2(j / slices, (i + 1) / stacks);\r\n\r\n      faces.push(new THREE.Face3(a, b, d));\r\n      uvs.push([uva, uvb, uvd]);\r\n\r\n      faces.push(new THREE.Face3(b, c, d));\r\n      uvs.push([uvb.clone(), uvc, uvd.clone()]);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // console.log(this);\r\n\r\n  // magic bullet\r\n  // var diff = this.mergeVertices();\r\n  // console.log('removed ', diff, ' vertices by merging');\r\n\r\n  this.computeFaceNormals();\r\n  this.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create(THREE.Geometry.prototype);\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function(size) {\r\n\r\n  size = size || 1;\r\n\r\n  var vertices = new Float32Array([\r\n    0, 0, 0, size, 0, 0,\r\n    0, 0, 0, 0, size, 0,\r\n    0, 0, 0, 0, 0, size\r\n  ]);\r\n\r\n  var colors = new Float32Array([\r\n    1, 0, 0, 1, 0.6, 0,\r\n    0, 1, 0, 0.6, 1, 0,\r\n    0, 0, 1, 0, 0.6, 1\r\n  ]);\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\r\n  geometry.addAttribute('color', new THREE.BufferAttribute(colors, 3));\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://exocortex.com\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = (function() {\r\n\r\n  var lineGeometry = new THREE.Geometry();\r\n  lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0));\r\n\r\n  var coneGeometry = new THREE.CylinderGeometry(0, 0.5, 1, 5, 1);\r\n  coneGeometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n\r\n  return function(dir, origin, length, color, headLength, headWidth) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    THREE.Object3D.call(this);\r\n\r\n    if (color === undefined) color = 0xffff00;\r\n    if (length === undefined) length = 1;\r\n    if (headLength === undefined) headLength = 0.2 * length;\r\n    if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n    this.position.copy(origin);\r\n\r\n    this.line = new THREE.Line(lineGeometry, new THREE.LineBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.line.matrixAutoUpdate = false;\r\n    this.add(this.line);\r\n\r\n    this.cone = new THREE.Mesh(coneGeometry, new THREE.MeshBasicMaterial({\r\n      color: color\r\n    }));\r\n    this.cone.matrixAutoUpdate = false;\r\n    this.add(this.cone);\r\n\r\n    this.setDirection(dir);\r\n    this.setLength(length, headLength, headWidth);\r\n\r\n  }\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = (function() {\r\n\r\n  var axis = new THREE.Vector3();\r\n  var radians;\r\n\r\n  return function(dir) {\r\n\r\n    // dir is assumed to be normalized\r\n\r\n    if (dir.y > 0.99999) {\r\n\r\n      this.quaternion.set(0, 0, 0, 1);\r\n\r\n    }\r\n    else if (dir.y < -0.99999) {\r\n\r\n      this.quaternion.set(1, 0, 0, 0);\r\n\r\n    }\r\n    else {\r\n\r\n      axis.set(dir.z, 0, -dir.x).normalize();\r\n\r\n      radians = Math.acos(dir.y);\r\n\r\n      this.quaternion.setFromAxisAngle(axis, radians);\r\n\r\n    }\r\n\r\n  };\r\n\r\n}());\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function(length, headLength, headWidth) {\r\n\r\n  if (headLength === undefined) headLength = 0.2 * length;\r\n  if (headWidth === undefined) headWidth = 0.2 * headLength;\r\n\r\n  this.line.scale.set(1, length - headLength, 1);\r\n  this.line.updateMatrix();\r\n\r\n  this.cone.scale.set(headWidth, headLength, headWidth);\r\n  this.cone.position.y = length;\r\n  this.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function(color) {\r\n\r\n  this.line.material.color.set(color);\r\n  this.cone.material.color.set(color);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function(object) {\r\n\r\n  var geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(new Float32Array(72), 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: 0xffff00\r\n  }), THREE.LinePieces);\r\n\r\n  if (object !== undefined) {\r\n\r\n    this.update(object);\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = function(object) {\r\n\r\n  var geometry = object.geometry;\r\n\r\n  if (geometry.boundingBox === null) {\r\n\r\n    geometry.computeBoundingBox();\r\n\r\n  }\r\n\r\n  var min = geometry.boundingBox.min;\r\n  var max = geometry.boundingBox.max;\r\n\r\n  /*\r\n    5____4\r\n  1/___0/|\r\n  | 6__|_7\r\n  2/___3/\r\n\r\n  0: max.x, max.y, max.z\r\n  1: min.x, max.y, max.z\r\n  2: min.x, min.y, max.z\r\n  3: max.x, min.y, max.z\r\n  4: max.x, max.y, min.z\r\n  5: min.x, max.y, min.z\r\n  6: min.x, min.y, min.z\r\n  7: max.x, min.y, min.z\r\n  */\r\n\r\n  var vertices = this.geometry.attributes.position.array;\r\n\r\n  vertices[0] = max.x;\r\n  vertices[1] = max.y;\r\n  vertices[2] = max.z;\r\n  vertices[3] = min.x;\r\n  vertices[4] = max.y;\r\n  vertices[5] = max.z;\r\n\r\n  vertices[6] = min.x;\r\n  vertices[7] = max.y;\r\n  vertices[8] = max.z;\r\n  vertices[9] = min.x;\r\n  vertices[10] = min.y;\r\n  vertices[11] = max.z;\r\n\r\n  vertices[12] = min.x;\r\n  vertices[13] = min.y;\r\n  vertices[14] = max.z;\r\n  vertices[15] = max.x;\r\n  vertices[16] = min.y;\r\n  vertices[17] = max.z;\r\n\r\n  vertices[18] = max.x;\r\n  vertices[19] = min.y;\r\n  vertices[20] = max.z;\r\n  vertices[21] = max.x;\r\n  vertices[22] = max.y;\r\n  vertices[23] = max.z;\r\n\r\n  //\r\n\r\n  vertices[24] = max.x;\r\n  vertices[25] = max.y;\r\n  vertices[26] = min.z;\r\n  vertices[27] = min.x;\r\n  vertices[28] = max.y;\r\n  vertices[29] = min.z;\r\n\r\n  vertices[30] = min.x;\r\n  vertices[31] = max.y;\r\n  vertices[32] = min.z;\r\n  vertices[33] = min.x;\r\n  vertices[34] = min.y;\r\n  vertices[35] = min.z;\r\n\r\n  vertices[36] = min.x;\r\n  vertices[37] = min.y;\r\n  vertices[38] = min.z;\r\n  vertices[39] = max.x;\r\n  vertices[40] = min.y;\r\n  vertices[41] = min.z;\r\n\r\n  vertices[42] = max.x;\r\n  vertices[43] = min.y;\r\n  vertices[44] = min.z;\r\n  vertices[45] = max.x;\r\n  vertices[46] = max.y;\r\n  vertices[47] = min.z;\r\n\r\n  //\r\n\r\n  vertices[48] = max.x;\r\n  vertices[49] = max.y;\r\n  vertices[50] = max.z;\r\n  vertices[51] = max.x;\r\n  vertices[52] = max.y;\r\n  vertices[53] = min.z;\r\n\r\n  vertices[54] = min.x;\r\n  vertices[55] = max.y;\r\n  vertices[56] = max.z;\r\n  vertices[57] = min.x;\r\n  vertices[58] = max.y;\r\n  vertices[59] = min.z;\r\n\r\n  vertices[60] = min.x;\r\n  vertices[61] = min.y;\r\n  vertices[62] = max.z;\r\n  vertices[63] = min.x;\r\n  vertices[64] = min.y;\r\n  vertices[65] = min.z;\r\n\r\n  vertices[66] = max.x;\r\n  vertices[67] = min.y;\r\n  vertices[68] = max.z;\r\n  vertices[69] = max.x;\r\n  vertices[70] = min.y;\r\n  vertices[71] = min.z;\r\n\r\n  this.geometry.attributes.position.needsUpdate = true;\r\n\r\n  this.geometry.computeBoundingSphere();\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0x888888;\r\n\r\n  this.object = object;\r\n\r\n  this.box = new THREE.Box3();\r\n\r\n  THREE.Mesh.call(this, new THREE.BoxGeometry(1, 1, 1), new THREE.MeshBasicMaterial({\r\n    color: color,\r\n    wireframe: true\r\n  }));\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function() {\r\n\r\n  this.box.setFromObject(this.object);\r\n\r\n  this.box.size(this.scale);\r\n\r\n  this.box.center(this.position);\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function(camera) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    color: 0xffffff,\r\n    vertexColors: THREE.FaceColors\r\n  });\r\n\r\n  var pointMap = {};\r\n\r\n  // colors\r\n\r\n  var hexFrustum = 0xffaa00;\r\n  var hexCone = 0xff0000;\r\n  var hexUp = 0x00aaff;\r\n  var hexTarget = 0xffffff;\r\n  var hexCross = 0x333333;\r\n\r\n  // near\r\n\r\n  addLine(\"n1\", \"n2\", hexFrustum);\r\n  addLine(\"n2\", \"n4\", hexFrustum);\r\n  addLine(\"n4\", \"n3\", hexFrustum);\r\n  addLine(\"n3\", \"n1\", hexFrustum);\r\n\r\n  // far\r\n\r\n  addLine(\"f1\", \"f2\", hexFrustum);\r\n  addLine(\"f2\", \"f4\", hexFrustum);\r\n  addLine(\"f4\", \"f3\", hexFrustum);\r\n  addLine(\"f3\", \"f1\", hexFrustum);\r\n\r\n  // sides\r\n\r\n  addLine(\"n1\", \"f1\", hexFrustum);\r\n  addLine(\"n2\", \"f2\", hexFrustum);\r\n  addLine(\"n3\", \"f3\", hexFrustum);\r\n  addLine(\"n4\", \"f4\", hexFrustum);\r\n\r\n  // cone\r\n\r\n  addLine(\"p\", \"n1\", hexCone);\r\n  addLine(\"p\", \"n2\", hexCone);\r\n  addLine(\"p\", \"n3\", hexCone);\r\n  addLine(\"p\", \"n4\", hexCone);\r\n\r\n  // up\r\n\r\n  addLine(\"u1\", \"u2\", hexUp);\r\n  addLine(\"u2\", \"u3\", hexUp);\r\n  addLine(\"u3\", \"u1\", hexUp);\r\n\r\n  // target\r\n\r\n  addLine(\"c\", \"t\", hexTarget);\r\n  addLine(\"p\", \"c\", hexCross);\r\n\r\n  // cross\r\n\r\n  addLine(\"cn1\", \"cn2\", hexCross);\r\n  addLine(\"cn3\", \"cn4\", hexCross);\r\n\r\n  addLine(\"cf1\", \"cf2\", hexCross);\r\n  addLine(\"cf3\", \"cf4\", hexCross);\r\n\r\n  function addLine(a, b, hex) {\r\n\r\n    addPoint(a, hex);\r\n    addPoint(b, hex);\r\n\r\n  }\r\n\r\n  function addPoint(id, hex) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3());\r\n    geometry.colors.push(new THREE.Color(hex));\r\n\r\n    if (pointMap[id] === undefined) {\r\n\r\n      pointMap[id] = [];\r\n\r\n    }\r\n\r\n    pointMap[id].push(geometry.vertices.length - 1);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.camera = camera;\r\n  this.matrix = camera.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.pointMap = pointMap;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function() {\r\n\r\n  var geometry, pointMap;\r\n\r\n  var vector = new THREE.Vector3();\r\n  var camera = new THREE.Camera();\r\n\r\n  var setPoint = function(point, x, y, z) {\r\n\r\n    vector.set(x, y, z).unproject(camera);\r\n\r\n    var points = pointMap[point];\r\n\r\n    if (points !== undefined) {\r\n\r\n      for (var i = 0, il = points.length; i < il; i++) {\r\n\r\n        geometry.vertices[points[i]].copy(vector);\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  return function() {\r\n\r\n    geometry = this.geometry;\r\n    pointMap = this.pointMap;\r\n\r\n    var w = 1,\r\n      h = 1;\r\n\r\n    // we need just camera projection matrix\r\n    // world matrix must be identity\r\n\r\n    camera.projectionMatrix.copy(this.camera.projectionMatrix);\r\n\r\n    // center / target\r\n\r\n    setPoint(\"c\", 0, 0, -1);\r\n    setPoint(\"t\", 0, 0, 1);\r\n\r\n    // near\r\n\r\n    setPoint(\"n1\", -w, -h, -1);\r\n    setPoint(\"n2\", w, -h, -1);\r\n    setPoint(\"n3\", -w, h, -1);\r\n    setPoint(\"n4\", w, h, -1);\r\n\r\n    // far\r\n\r\n    setPoint(\"f1\", -w, -h, 1);\r\n    setPoint(\"f2\", w, -h, 1);\r\n    setPoint(\"f3\", -w, h, 1);\r\n    setPoint(\"f4\", w, h, 1);\r\n\r\n    // up\r\n\r\n    setPoint(\"u1\", w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u2\", -w * 0.7, h * 1.1, -1);\r\n    setPoint(\"u3\", 0, h * 2, -1);\r\n\r\n    // cross\r\n\r\n    setPoint(\"cf1\", -w, 0, 1);\r\n    setPoint(\"cf2\", w, 0, 1);\r\n    setPoint(\"cf3\", 0, -h, 1);\r\n    setPoint(\"cf4\", 0, h, 1);\r\n\r\n    setPoint(\"cn1\", -w, 0, -1);\r\n    setPoint(\"cn2\", w, 0, -1);\r\n    setPoint(\"cn3\", 0, -h, -1);\r\n    setPoint(\"cn4\", 0, h, -1);\r\n\r\n    geometry.verticesNeedUpdate = true;\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function(light, size) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  size = size || 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(-size, size, 0),\r\n    new THREE.Vector3(size, size, 0),\r\n    new THREE.Vector3(size, -size, 0),\r\n    new THREE.Vector3(-size, -size, 0),\r\n    new THREE.Vector3(-size, size, 0)\r\n  );\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.lightPlane = new THREE.Line(geometry, material);\r\n  this.add(this.lightPlane);\r\n\r\n  geometry = new THREE.Geometry();\r\n  geometry.vertices.push(\r\n    new THREE.Vector3(),\r\n    new THREE.Vector3()\r\n  );\r\n\r\n  material = new THREE.LineBasicMaterial({\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  this.targetLine = new THREE.Line(geometry, material);\r\n  this.add(this.targetLine);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function() {\r\n\r\n  this.lightPlane.geometry.dispose();\r\n  this.lightPlane.material.dispose();\r\n  this.targetLine.geometry.dispose();\r\n  this.targetLine.material.dispose();\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function() {\r\n\r\n  var v1 = new THREE.Vector3();\r\n  var v2 = new THREE.Vector3();\r\n  var v3 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    v1.setFromMatrixPosition(this.light.matrixWorld);\r\n    v2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n    v3.subVectors(v2, v1);\r\n\r\n    this.lightPlane.lookAt(v3);\r\n    this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n    this.targetLine.geometry.vertices[1].copy(v3);\r\n    this.targetLine.geometry.verticesNeedUpdate = true;\r\n    this.targetLine.material.color.copy(this.lightPlane.material.color);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimim angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function(object, hex, thresholdAngle) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n  thresholdAngle = (thresholdAngle !== undefined) ? thresholdAngle : 1;\r\n\r\n  var thresholdDot = Math.cos(THREE.Math.degToRad(thresholdAngle));\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  var geometry2;\r\n\r\n  if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    geometry2 = new THREE.Geometry();\r\n    geometry2.fromBufferGeometry(object.geometry);\r\n\r\n  }\r\n  else {\r\n\r\n    geometry2 = object.geometry.clone();\r\n\r\n  }\r\n\r\n  geometry2.mergeVertices();\r\n  geometry2.computeFaceNormals();\r\n\r\n  var vertices = geometry2.vertices;\r\n  var faces = geometry2.faces;\r\n  var numEdges = 0;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0; j < 3; j++) {\r\n\r\n      edge[0] = face[keys[j]];\r\n      edge[1] = face[keys[(j + 1) % 3]];\r\n      edge.sort(sortFunction);\r\n\r\n      var key = edge.toString();\r\n\r\n      if (hash[key] === undefined) {\r\n\r\n        hash[key] = {\r\n          vert1: edge[0],\r\n          vert2: edge[1],\r\n          face1: i,\r\n          face2: undefined\r\n        };\r\n        numEdges++;\r\n\r\n      }\r\n      else {\r\n\r\n        hash[key].face2 = i;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n  var index = 0;\r\n\r\n  for (var key in hash) {\r\n\r\n    var h = hash[key];\r\n\r\n    if (h.face2 === undefined || faces[h.face1].normal.dot(faces[h.face2].normal) <= thresholdDot) {\r\n\r\n      var vertex = vertices[h.vert1];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n      vertex = vertices[h.vert2];\r\n      coords[index++] = vertex.x;\r\n      coords[index++] = vertex.y;\r\n      coords[index++] = vertex.z;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.FaceNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffff00;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = this.object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = function() {\r\n\r\n  var vertices = this.geometry.vertices;\r\n\r\n  var object = this.object;\r\n  var objectVertices = object.geometry.vertices;\r\n  var objectFaces = object.geometry.faces;\r\n  var objectWorldMatrix = object.matrixWorld;\r\n\r\n  object.updateMatrixWorld(true);\r\n\r\n  this.normalMatrix.getNormalMatrix(objectWorldMatrix);\r\n\r\n  for (var i = 0, i2 = 0, l = objectFaces.length; i < l; i++, i2 += 2) {\r\n\r\n    var face = objectFaces[i];\r\n\r\n    vertices[i2].copy(objectVertices[face.a])\r\n      .add(objectVertices[face.b])\r\n      .add(objectVertices[face.c])\r\n      .divideScalar(3)\r\n      .applyMatrix4(objectWorldMatrix);\r\n\r\n    vertices[i2 + 1].copy(face.normal)\r\n      .applyMatrix3(this.normalMatrix)\r\n      .normalize()\r\n      .multiplyScalar(this.size)\r\n      .add(vertices[i2]);\r\n\r\n  }\r\n\r\n  this.geometry.verticesNeedUpdate = true;\r\n\r\n  return this;\r\n\r\n};\r\n\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function(size, step) {\r\n\r\n  var geometry = new THREE.Geometry();\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors\r\n  });\r\n\r\n  this.color1 = new THREE.Color(0x444444);\r\n  this.color2 = new THREE.Color(0x888888);\r\n\r\n  for (var i = -size; i <= size; i += step) {\r\n\r\n    geometry.vertices.push(\r\n      new THREE.Vector3(-size, 0, i), new THREE.Vector3(size, 0, i),\r\n      new THREE.Vector3(i, 0, -size), new THREE.Vector3(i, 0, size)\r\n    );\r\n\r\n    var color = i === 0 ? this.color1 : this.color2;\r\n\r\n    geometry.colors.push(color, color, color, color);\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function(colorCenterLine, colorGrid) {\r\n\r\n  this.color1.set(colorCenterLine);\r\n  this.color2.set(colorGrid);\r\n\r\n  this.geometry.colorsNeedUpdate = true;\r\n\r\n}\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function(light, sphereSize) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.colors = [new THREE.Color(), new THREE.Color()];\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  for (var i = 0, il = 8; i < il; i++) {\r\n\r\n    geometry.faces[i].color = this.colors[i < 4 ? 0 : 1];\r\n\r\n  }\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    vertexColors: THREE.FaceColors,\r\n    wireframe: true\r\n  });\r\n\r\n  this.lightSphere = new THREE.Mesh(geometry, material);\r\n  this.add(this.lightSphere);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function() {\r\n  this.lightSphere.geometry.dispose();\r\n  this.lightSphere.material.dispose();\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);\r\n    this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);\r\n\r\n    this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate());\r\n    this.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n  }\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function(light, sphereSize) {\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  var geometry = new THREE.SphereGeometry(sphereSize, 4, 2);\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n  material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.matrix = this.light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  /*\r\n  var distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n  var distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n  this.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n  this.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n  var d = light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n\r\n  this.add( this.lightDistance );\r\n  */\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function() {\r\n\r\n  this.geometry.dispose();\r\n  this.material.dispose();\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function() {\r\n\r\n  this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  /*\r\n  var d = this.light.distance;\r\n\r\n  if ( d === 0.0 ) {\r\n\r\n  \tthis.lightDistance.visible = false;\r\n\r\n  } else {\r\n\r\n  \tthis.lightDistance.visible = true;\r\n  \tthis.lightDistance.scale.set( d, d, d );\r\n\r\n  }\r\n  */\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function(object) {\r\n\r\n  this.bones = this.getBoneList(object);\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.colors.push(new THREE.Color(0, 0, 1));\r\n      geometry.colors.push(new THREE.Color(0, 1, 0));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  var material = new THREE.LineBasicMaterial({\r\n    vertexColors: THREE.VertexColors,\r\n    depthTest: false,\r\n    depthWrite: false,\r\n    transparent: true\r\n  });\r\n\r\n  THREE.Line.call(this, geometry, material, THREE.LinePieces);\r\n\r\n  this.root = object;\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function(object) {\r\n\r\n  var boneList = [];\r\n\r\n  if (object instanceof THREE.Bone) {\r\n\r\n    boneList.push(object);\r\n\r\n  }\r\n\r\n  for (var i = 0; i < object.children.length; i++) {\r\n\r\n    boneList.push.apply(boneList, this.getBoneList(object.children[i]));\r\n\r\n  }\r\n\r\n  return boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function() {\r\n\r\n  var geometry = this.geometry;\r\n\r\n  var matrixWorldInv = new THREE.Matrix4().getInverse(this.root.matrixWorld);\r\n\r\n  var boneMatrix = new THREE.Matrix4();\r\n\r\n  var j = 0;\r\n\r\n  for (var i = 0; i < this.bones.length; i++) {\r\n\r\n    var bone = this.bones[i];\r\n\r\n    if (bone.parent instanceof THREE.Bone) {\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.matrixWorld);\r\n      geometry.vertices[j].setFromMatrixPosition(boneMatrix);\r\n\r\n      boneMatrix.multiplyMatrices(matrixWorldInv, bone.parent.matrixWorld);\r\n      geometry.vertices[j + 1].setFromMatrixPosition(boneMatrix);\r\n\r\n      j += 2;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  geometry.verticesNeedUpdate = true;\r\n\r\n  geometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.SpotLightHelper = function(light) {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.light = light;\r\n  this.light.updateMatrixWorld();\r\n\r\n  this.matrix = light.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n  var geometry = new THREE.CylinderGeometry(0, 1, 1, 8, 1, true);\r\n\r\n  geometry.applyMatrix(new THREE.Matrix4().makeTranslation(0, -0.5, 0));\r\n  geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\r\n\r\n  var material = new THREE.MeshBasicMaterial({\r\n    wireframe: true,\r\n    fog: false\r\n  });\r\n\r\n  this.cone = new THREE.Mesh(geometry, material);\r\n  this.add(this.cone);\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function() {\r\n  this.cone.geometry.dispose();\r\n  this.cone.material.dispose();\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function() {\r\n\r\n  var vector = new THREE.Vector3();\r\n  var vector2 = new THREE.Vector3();\r\n\r\n  return function() {\r\n\r\n    var coneLength = this.light.distance ? this.light.distance : 10000;\r\n    var coneWidth = coneLength * Math.tan(this.light.angle);\r\n\r\n    this.cone.scale.set(coneWidth, coneWidth, coneLength);\r\n\r\n    vector.setFromMatrixPosition(this.light.matrixWorld);\r\n    vector2.setFromMatrixPosition(this.light.target.matrixWorld);\r\n\r\n    this.cone.lookAt(vector2.sub(vector));\r\n\r\n    this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);\r\n\r\n  };\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexNormalsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0xff0000;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3(), new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.normalMatrix = new THREE.Matrix3();\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    this.normalMatrix.getNormalMatrix(this.object.matrixWorld);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var normal = face.vertexNormals[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/VertexTangentsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.VertexTangentsHelper = function(object, size, hex, linewidth) {\r\n\r\n  this.object = object;\r\n\r\n  this.size = (size !== undefined) ? size : 1;\r\n\r\n  var color = (hex !== undefined) ? hex : 0x0000ff;\r\n\r\n  var width = (linewidth !== undefined) ? linewidth : 1;\r\n\r\n  var geometry = new THREE.Geometry();\r\n\r\n  var faces = object.geometry.faces;\r\n\r\n  for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n    var face = faces[i];\r\n\r\n    for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n      geometry.vertices.push(new THREE.Vector3());\r\n      geometry.vertices.push(new THREE.Vector3());\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color,\r\n    linewidth: width\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n\r\n};\r\n\r\nTHREE.VertexTangentsHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.VertexTangentsHelper.prototype.constructor = THREE.VertexTangentsHelper;\r\n\r\nTHREE.VertexTangentsHelper.prototype.update = (function(object) {\r\n\r\n  var v1 = new THREE.Vector3();\r\n\r\n  return function(object) {\r\n\r\n    var keys = ['a', 'b', 'c', 'd'];\r\n\r\n    this.object.updateMatrixWorld(true);\r\n\r\n    var vertices = this.geometry.vertices;\r\n\r\n    var verts = this.object.geometry.vertices;\r\n\r\n    var faces = this.object.geometry.faces;\r\n\r\n    var worldMatrix = this.object.matrixWorld;\r\n\r\n    var idx = 0;\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0, jl = face.vertexTangents.length; j < jl; j++) {\r\n\r\n        var vertexId = face[keys[j]];\r\n        var vertex = verts[vertexId];\r\n\r\n        var tangent = face.vertexTangents[j];\r\n\r\n        vertices[idx].copy(vertex).applyMatrix4(worldMatrix);\r\n\r\n        v1.copy(tangent).transformDirection(worldMatrix).multiplyScalar(this.size);\r\n\r\n        v1.add(vertices[idx]);\r\n        idx = idx + 1;\r\n\r\n        vertices[idx].copy(v1);\r\n        idx = idx + 1;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.geometry.verticesNeedUpdate = true;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}());\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function(object, hex) {\r\n\r\n  var color = (hex !== undefined) ? hex : 0xffffff;\r\n\r\n  var edge = [0, 0],\r\n    hash = {};\r\n  var sortFunction = function(a, b) {\r\n    return a - b\r\n  };\r\n\r\n  var keys = ['a', 'b', 'c'];\r\n  var geometry = new THREE.BufferGeometry();\r\n\r\n  if (object.geometry instanceof THREE.Geometry) {\r\n\r\n    var vertices = object.geometry.vertices;\r\n    var faces = object.geometry.faces;\r\n    var numEdges = 0;\r\n\r\n    // allocate maximal size\r\n    var edges = new Uint32Array(6 * faces.length);\r\n\r\n    for (var i = 0, l = faces.length; i < l; i++) {\r\n\r\n      var face = faces[i];\r\n\r\n      for (var j = 0; j < 3; j++) {\r\n\r\n        edge[0] = face[keys[j]];\r\n        edge[1] = face[keys[(j + 1) % 3]];\r\n        edge.sort(sortFunction);\r\n\r\n        var key = edge.toString();\r\n\r\n        if (hash[key] === undefined) {\r\n\r\n          edges[2 * numEdges] = edge[0];\r\n          edges[2 * numEdges + 1] = edge[1];\r\n          hash[key] = true;\r\n          numEdges++;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n    for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n      for (var j = 0; j < 2; j++) {\r\n\r\n        var vertex = vertices[edges[2 * i + j]];\r\n\r\n        var index = 6 * i + 3 * j;\r\n        coords[index + 0] = vertex.x;\r\n        coords[index + 1] = vertex.y;\r\n        coords[index + 2] = vertex.z;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n  }\r\n  else if (object.geometry instanceof THREE.BufferGeometry) {\r\n\r\n    if (object.geometry.attributes.index !== undefined) { // Indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var indices = object.geometry.attributes.index.array;\r\n      var drawcalls = object.geometry.drawcalls;\r\n      var numEdges = 0;\r\n\r\n      if (drawcalls.length === 0) {\r\n\r\n        drawcalls = [{\r\n          count: indices.length,\r\n          index: 0,\r\n          start: 0\r\n        }];\r\n\r\n      }\r\n\r\n      // allocate maximal size\r\n      var edges = new Uint32Array(2 * indices.length);\r\n\r\n      for (var o = 0, ol = drawcalls.length; o < ol; ++o) {\r\n\r\n        var start = drawcalls[o].start;\r\n        var count = drawcalls[o].count;\r\n        var index = drawcalls[o].index;\r\n\r\n        for (var i = start, il = start + count; i < il; i += 3) {\r\n\r\n          for (var j = 0; j < 3; j++) {\r\n\r\n            edge[0] = index + indices[i + j];\r\n            edge[1] = index + indices[i + (j + 1) % 3];\r\n            edge.sort(sortFunction);\r\n\r\n            var key = edge.toString();\r\n\r\n            if (hash[key] === undefined) {\r\n\r\n              edges[2 * numEdges] = edge[0];\r\n              edges[2 * numEdges + 1] = edge[1];\r\n              hash[key] = true;\r\n              numEdges++;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numEdges; i < l; i++) {\r\n\r\n        for (var j = 0; j < 2; j++) {\r\n\r\n          var index = 6 * i + 3 * j;\r\n          var index2 = 3 * edges[2 * i + j];\r\n          coords[index + 0] = vertices[index2];\r\n          coords[index + 1] = vertices[index2 + 1];\r\n          coords[index + 2] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n    else { // non-indexed BufferGeometry\r\n\r\n      var vertices = object.geometry.attributes.position.array;\r\n      var numEdges = vertices.length / 3;\r\n      var numTris = numEdges / 3;\r\n\r\n      var coords = new Float32Array(numEdges * 2 * 3);\r\n\r\n      for (var i = 0, l = numTris; i < l; i++) {\r\n\r\n        for (var j = 0; j < 3; j++) {\r\n\r\n          var index = 18 * i + 6 * j;\r\n\r\n          var index1 = 9 * i + 3 * j;\r\n          coords[index + 0] = vertices[index1];\r\n          coords[index + 1] = vertices[index1 + 1];\r\n          coords[index + 2] = vertices[index1 + 2];\r\n\r\n          var index2 = 9 * i + 3 * ((j + 1) % 3);\r\n          coords[index + 3] = vertices[index2];\r\n          coords[index + 4] = vertices[index2 + 1];\r\n          coords[index + 5] = vertices[index2 + 2];\r\n\r\n        }\r\n\r\n      }\r\n\r\n      geometry.addAttribute('position', new THREE.BufferAttribute(coords, 3));\r\n\r\n    }\r\n\r\n  }\r\n\r\n  THREE.Line.call(this, geometry, new THREE.LineBasicMaterial({\r\n    color: color\r\n  }), THREE.LinePieces);\r\n\r\n  this.matrix = object.matrixWorld;\r\n  this.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create(THREE.Line.prototype);\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function() {\r\n\r\n  THREE.Object3D.call(this);\r\n\r\n  this.render = function(renderCallback) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create(THREE.Object3D.prototype);\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function(geometry, material) {\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.animationsMap = {};\r\n  this.animationsList = [];\r\n\r\n  // prepare default animation\r\n  // (all frames played together in 1 second)\r\n\r\n  var numFrames = this.geometry.morphTargets.length;\r\n\r\n  var name = \"__default\";\r\n\r\n  var startFrame = 0;\r\n  var endFrame = numFrames - 1;\r\n\r\n  var fps = numFrames / 1;\r\n\r\n  this.createAnimation(name, startFrame, endFrame, fps);\r\n  this.setAnimationWeight(name, 1);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create(THREE.Mesh.prototype);\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function(name, start, end, fps) {\r\n\r\n  var animation = {\r\n\r\n    startFrame: start,\r\n    endFrame: end,\r\n\r\n    length: end - start + 1,\r\n\r\n    fps: fps,\r\n    duration: (end - start) / fps,\r\n\r\n    lastFrame: 0,\r\n    currentFrame: 0,\r\n\r\n    active: false,\r\n\r\n    time: 0,\r\n    direction: 1,\r\n    weight: 1,\r\n\r\n    directionBackwards: false,\r\n    mirroredLoop: false\r\n\r\n  };\r\n\r\n  this.animationsMap[name] = animation;\r\n  this.animationsList.push(animation);\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function(fps) {\r\n\r\n  var pattern = /([a-z]+)_?(\\d+)/;\r\n\r\n  var firstAnimation, frameRanges = {};\r\n\r\n  var geometry = this.geometry;\r\n\r\n  for (var i = 0, il = geometry.morphTargets.length; i < il; i++) {\r\n\r\n    var morph = geometry.morphTargets[i];\r\n    var chunks = morph.name.match(pattern);\r\n\r\n    if (chunks && chunks.length > 1) {\r\n\r\n      var name = chunks[1];\r\n\r\n      if (!frameRanges[name]) frameRanges[name] = {\r\n        start: Infinity,\r\n        end: -Infinity\r\n      };\r\n\r\n      var range = frameRanges[name];\r\n\r\n      if (i < range.start) range.start = i;\r\n      if (i > range.end) range.end = i;\r\n\r\n      if (!firstAnimation) firstAnimation = name;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  for (var name in frameRanges) {\r\n\r\n    var range = frameRanges[name];\r\n    this.createAnimation(name, range.start, range.end, fps);\r\n\r\n  }\r\n\r\n  this.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = 1;\r\n    animation.directionBackwards = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.direction = -1;\r\n    animation.directionBackwards = true;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function(name, fps) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.fps = fps;\r\n    animation.duration = (animation.end - animation.start) / animation.fps;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function(name, duration) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.duration = duration;\r\n    animation.fps = (animation.end - animation.start) / animation.duration;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function(name, weight) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.weight = weight;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function(name, time) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = time;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function(name) {\r\n\r\n  var time = 0;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    time = animation.time;\r\n\r\n  }\r\n\r\n  return time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function(name) {\r\n\r\n  var duration = -1;\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    duration = animation.duration;\r\n\r\n  }\r\n\r\n  return duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.time = 0;\r\n    animation.active = true;\r\n\r\n  }\r\n  else {\r\n\r\n    THREE.warn(\"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\");\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function(name) {\r\n\r\n  var animation = this.animationsMap[name];\r\n\r\n  if (animation) {\r\n\r\n    animation.active = false;\r\n\r\n  }\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function(delta) {\r\n\r\n  for (var i = 0, il = this.animationsList.length; i < il; i++) {\r\n\r\n    var animation = this.animationsList[i];\r\n\r\n    if (!animation.active) continue;\r\n\r\n    var frameTime = animation.duration / animation.length;\r\n\r\n    animation.time += animation.direction * delta;\r\n\r\n    if (animation.mirroredLoop) {\r\n\r\n      if (animation.time > animation.duration || animation.time < 0) {\r\n\r\n        animation.direction *= -1;\r\n\r\n        if (animation.time > animation.duration) {\r\n\r\n          animation.time = animation.duration;\r\n          animation.directionBackwards = true;\r\n\r\n        }\r\n\r\n        if (animation.time < 0) {\r\n\r\n          animation.time = 0;\r\n          animation.directionBackwards = false;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n    else {\r\n\r\n      animation.time = animation.time % animation.duration;\r\n\r\n      if (animation.time < 0) animation.time += animation.duration;\r\n\r\n    }\r\n\r\n    var keyframe = animation.startFrame + THREE.Math.clamp(Math.floor(animation.time / frameTime), 0, animation.length - 1);\r\n    var weight = animation.weight;\r\n\r\n    if (keyframe !== animation.currentFrame) {\r\n\r\n      this.morphTargetInfluences[animation.lastFrame] = 0;\r\n      this.morphTargetInfluences[animation.currentFrame] = 1 * weight;\r\n\r\n      this.morphTargetInfluences[keyframe] = 0;\r\n\r\n      animation.lastFrame = animation.currentFrame;\r\n      animation.currentFrame = keyframe;\r\n\r\n    }\r\n\r\n    var mix = (animation.time % frameTime) / frameTime;\r\n\r\n    if (animation.directionBackwards) mix = 1 - mix;\r\n\r\n    this.morphTargetInfluences[animation.currentFrame] = mix * weight;\r\n    this.morphTargetInfluences[animation.lastFrame] = (1 - mix) * weight;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n}\r\nelse {\r\n  this['THREE'] = THREE;\r\n}\r\n\r\n","module.exports = {\r\n  Identifier: require('./components/Identifier.js'),\r\n  Position: require('./components/Position.js'),\r\n  Velocity: require('./components/Velocity.js'),\r\n  Jump: require('./components/Jump.js'),\r\n  Drawable: require('./components/Drawable.js'),\r\n  Expirable: require('./components/Expirable.js'),\r\n  CameraFollow: require('./components/CameraFollow.js'),\r\n  ShootDelay: require('./components/ShootDelay.js'),\r\n  OneTimeHit: require('./components/OneTimeHit.js'),\r\n  Hurt: require('./components/Hurt.js'),\r\n  Health: require('./components/Health.js'),\r\n  Bullet: require('./components/Bullet.js'),\r\n  AI: require('./components/Ai.js')\r\n};\r\n\r\n","/**\r\n * b3\r\n * \r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\nvar b3 = b3 || {};\r\n\r\nmodule.exports = b3;\r\n\r\n/**\r\n * Behavior3JS\r\n * ===========\r\n *\r\n * * * *\r\n * \r\n * **Behavior3JS** is a Behavior Tree library written in JavaScript. It \r\n * provides structures and algorithms that assist you in the task of creating \r\n * intelligent agents for your game or application. Check it out some features \r\n * of Behavior3JS:\r\n * \r\n * - Based on the work of (Marzinotto et al., 2014), in which they propose a \r\n *   **formal**, **consistent** and **general** definition of Behavior Trees;\r\n * - **Optimized to control multiple agents**: you can use a single behavior \r\n *   tree instance to handle hundreds of agents;\r\n * - It was **designed to load and save trees in a JSON format**, in order to \r\n *   use, edit and test it in multiple environments, tools and languages;\r\n * - A **cool visual editor** which you can access online;\r\n * - Several **composite, decorator and action nodes** available within the \r\n *   library. You still can define your own nodes, including composites and \r\n *   decorators;\r\n * - **Completely free**, the core module and the visual editor are all published\r\n *   under the MIT License, which means that you can use them for your open source\r\n *   and commercial projects;\r\n * - **Lightweight**, only 11.5KB!\r\n * \r\n * Visit http://behavior3js.guineashots.com to know more!\r\n *\r\n * \r\n * Core Classes and Functions\r\n * --------------------------\r\n * \r\n * This library include the following core structures...\r\n *\r\n * **Public:**\r\n * \r\n * - **BehaviorTree**: the structure that represents a Behavior Tree;\r\n * - **Blackboard**: represents a \"memory\" in an agent and is required to to \r\n *   run a `BehaviorTree`;\r\n * - **Composite**: base class for all composite nodes;\r\n * - **Decorator**: base class for all decorator nodes;\r\n * - **Action**: base class for all action nodes;\r\n * - **Condition**: base class for all condition nodes;\r\n *\r\n * **Internal:**\r\n * \r\n * \r\n * - **Tick**: used as container and tracking object through the tree during \r\n *   the tick signal;\r\n * - **BaseNode**: the base class that provide all common node features;\r\n * \r\n * *Some classes are used internally on Behavior3JS, but you may need to access\r\n * its functionalities eventually, specially the `Tick` object.*\r\n *\r\n * \r\n * Nodes Included \r\n * --------------\r\n *\r\n * **Composite Nodes**: \r\n * \r\n * - Sequence;\r\n * - Priority;\r\n * - MemSequence;\r\n * - MemPriority;\r\n * \r\n * \r\n * **Decorators**: \r\n * \r\n * - Inverter;\r\n * - Limiter\r\n * - MaxTime;\r\n * - Repeater;\r\n * - RepeaterUntilFailure;\r\n * - RepeaterUntilSuccess;\r\n *\r\n * \r\n * **Actions**:\r\n * \r\n * - Succeeder;\r\n * - Failer;\r\n * - Error;\r\n * - Runner;\r\n * - Wait.\r\n * \r\n * @module Behavior3JS\r\n * @main Behavior3JS\r\n **/\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * List of all constants in Behavior3JS.\r\n   *\r\n   * @class Constants\r\n   **/\r\n\r\n  /**\r\n   * Version of the library.\r\n   * \r\n   * @property VERSION\r\n   * @type {String}\r\n   */\r\n  b3.VERSION = '0.1.0';\r\n\r\n  /**\r\n   * Returned when a criterion has been met by a condition node or an action node\r\n   * has been completed successfully.\r\n   * \r\n   * @property SUCCESS\r\n   * @type {Integer}\r\n   */\r\n  b3.SUCCESS = 1;\r\n\r\n  /**\r\n   * Returned when a criterion has not been met by a condition node or an action \r\n   * node could not finish its execution for any reason.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.FAILURE = 2;\r\n\r\n  /**\r\n   * Returned when an action node has been initialized but is still waiting the \r\n   * its resolution.\r\n   * \r\n   * @property FAILURE\r\n   * @type {Integer}\r\n   */\r\n  b3.RUNNING = 3;\r\n\r\n  /**\r\n   * Returned when some unexpected error happened in the tree, probably by a \r\n   * programming error (trying to verify an undefined variable). Its use depends \r\n   * on the final implementation of the leaf nodes.\r\n   * \r\n   * @property ERROR\r\n   * @type {Integer}\r\n   */\r\n  b3.ERROR = 4;\r\n\r\n\r\n  /**\r\n   * Describes the node category as Composite.\r\n   * \r\n   * @property COMPOSITE\r\n   * @type {String}\r\n   */\r\n  b3.COMPOSITE = 'composite';\r\n\r\n  /**\r\n   * Describes the node category as Decorator.\r\n   * \r\n   * @property DECORATOR\r\n   * @type {String}\r\n   */\r\n  b3.DECORATOR = 'decorator';\r\n\r\n  /**\r\n   * Describes the node category as Action.\r\n   * \r\n   * @property ACTION\r\n   * @type {String}\r\n   */\r\n  b3.ACTION = 'action';\r\n\r\n  /**\r\n   * Describes the node category as Condition.\r\n   * \r\n   * @property CONDITION\r\n   * @type {String}\r\n   */\r\n  b3.CONDITION = 'condition';\r\n\r\n\r\n  /**\r\n   * List of internal and helper functions in Behavior3JS.\r\n   * \r\n   * @class Utils\r\n   **/\r\n\r\n\r\n  /**\r\n   * This function is used to create unique IDs for trees and nodes.\r\n   * \r\n   * (consult http://www.ietf.org/rfc/rfc4122.txt).\r\n   *\r\n   * @method createUUID\r\n   * @return {String} A unique ID.\r\n   **/\r\n  b3.createUUID = function() {\r\n    var s = [];\r\n    var hexDigits = \"0123456789abcdef\";\r\n    for (var i = 0; i < 36; i++) {\r\n      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n    }\r\n    // bits 12-15 of the time_hi_and_version field to 0010\r\n    s[14] = \"4\";\r\n\r\n    // bits 6-7 of the clock_seq_hi_and_reserved to 01\r\n    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);\r\n\r\n    s[8] = s[13] = s[18] = s[23] = \"-\";\r\n\r\n    var uuid = s.join(\"\");\r\n    return uuid;\r\n  }\r\n\r\n  /**\r\n   * Class is a meta-factory function to create classes in JavaScript. It is a\r\n   * shortcut for the CreateJS syntax style. By default, the class created by \r\n   * this function have an initialize function (the constructor). Optionally, you\r\n   * can specify the inheritance by passing another class as parameter.\r\n   *\r\n   * By default, all classes created using this function, may receives only a\r\n   * settings parameter as argument. This pattern is commonly used by jQuery and \r\n   * its plugins.\r\n   *\r\n   * Usage\r\n   * -----\r\n   *\r\n   *     // Creating a simple class\r\n   *     var BaseClass = b3.Class();\r\n   *\r\n   *     // Using inheritance\r\n   *     var ChildClass = b3.Class(BaseClass);\r\n   *\r\n   *     // Defining the constructor\r\n   *     ChildClass.prototype.initialize = function(settings) { ... }\r\n   *\r\n   * @method Class\r\n   * @param {Object} [baseClass] The super class.\r\n   * @return {Object} A new class.\r\n   **/\r\n  b3.Class = function(baseClass) {\r\n    // create a new class\r\n    var cls = function(params) {\r\n      this.initialize(params);\r\n    }\r\n\r\n    // if base class is provided, inherit\r\n    if (baseClass) {\r\n      cls.prototype = new baseClass();\r\n      cls.prototype.constructor = cls;\r\n    }\r\n\r\n    // create initialize if does not exist on baseClass\r\n    cls.prototype.initialize = cls.prototype.initialize || function() {};\r\n\r\n    return cls;\r\n  }\r\n\r\n})();\r\n/**\r\n * Blackboard\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Blackboard is the memory structure required by `BehaviorTree` and its \r\n   * nodes. It only have 2 public methods: `set` and `get`. These methods works \r\n   * in 3 different contexts: global, per tree, and per node per tree.\r\n   * \r\n   * Suppose you have two different trees controlling a single object with a \r\n   * single blackboard, then:\r\n   *\r\n   * - In the global context, all nodes will access the stored information. \r\n   * - In per tree context, only nodes sharing the same tree share the stored \r\n   *   information.\r\n   * - In per node per tree context, the information stored in the blackboard can\r\n   *   only be accessed by the same node that wrote the data.\r\n   *   \r\n   * The context is selected indirectly by the parameters provided to these \r\n   * methods, for example:\r\n   * \r\n   *     // getting/setting variable in global context\r\n   *     blackboard.set('testKey', 'value');\r\n   *     var value = blackboard.get('testKey');\r\n   *     \r\n   *     // getting/setting variable in per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id);\r\n   *     var value = blackboard.get('testKey', tree.id);\r\n   *     \r\n   *     // getting/setting variable in per node per tree context\r\n   *     blackboard.set('testKey', 'value', tree.id, node.id);\r\n   *     var value = blackboard.get('testKey', tree.id, node.id);\r\n   * \r\n   * Note: Internally, the blackboard store these memories in different objects,\r\n   *  being the global on `_baseMemory`, the per tree on `_treeMemory` and the \r\n   *  per node per tree dynamically create inside the per tree memory (it is \r\n   *  accessed via `_treeMemory[id].nodeMemory`). Avoid to use these variables \r\n   *  manually, use `get` and `set` instead.\r\n   *  \r\n   * @class Blackboard\r\n   **/\r\n  var Blackboard = b3.Class();\r\n\r\n  var p = Blackboard.prototype;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this._baseMemory = {};\r\n    this._treeMemory = {};\r\n  }\r\n\r\n  /**\r\n   * Internal method to retrieve the tree context memory. If the memory does\r\n   * not exist, this method creates it.\r\n   *\r\n   * @method _getTreeMemory\r\n   * @param {string} treeScope The id of the tree in scope.\r\n   * @returns {Object} The tree memory.\r\n   * @protected\r\n   **/\r\n  p._getTreeMemory = function(treeScope) {\r\n    if (!this._treeMemory[treeScope]) {\r\n      this._treeMemory[treeScope] = {\r\n        'nodeMemory': {},\r\n        'openNodes': [],\r\n        'traversalDepth': 0,\r\n        'traversalCycle': 0,\r\n      };\r\n    }\r\n    return this._treeMemory[treeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the node context memory, given the tree \r\n   * memory. If the memory does not exist, this method creates is.\r\n   *\r\n   * @method _getNodeMemory\r\n   * @param {String} treeMemory the tree memory.\r\n   * @param {String} nodeScope The id of the node in scope.\r\n   * @returns {Object} The node memory.\r\n   * @protected\r\n   **/\r\n  p._getNodeMemory = function(treeMemory, nodeScope) {\r\n    var memory = treeMemory['nodeMemory'];\r\n    if (!memory[nodeScope]) {\r\n      memory[nodeScope] = {};\r\n    }\r\n\r\n    return memory[nodeScope];\r\n  };\r\n\r\n  /**\r\n   * Internal method to retrieve the context memory. If treeScope and \r\n   * nodeScope are provided, this method returns the per node per tree \r\n   * memory. If only the treeScope is provided, it returns the per tree \r\n   * memory. If no parameter is provided, it returns the global memory. \r\n   * Notice that, if only nodeScope is provided, this method will still \r\n   * return the global memory.\r\n   *\r\n   * @method _getMemory\r\n   * @param {String} treeScope The id of the tree scope.\r\n   * @param {String} nodeScope The id of the node scope.\r\n   * @returns {Object} A memory object.\r\n   * @protected\r\n   **/\r\n  p._getMemory = function(treeScope, nodeScope) {\r\n    var memory = this._baseMemory;\r\n\r\n    if (treeScope) {\r\n      memory = this._getTreeMemory(treeScope);\r\n\r\n      if (nodeScope) {\r\n        memory = this._getNodeMemory(memory, nodeScope);\r\n      }\r\n    }\r\n\r\n    return memory;\r\n  };\r\n\r\n  /**\r\n   * Stores a value in the blackboard. If treeScope and nodeScope are \r\n   * provided, this method will save the value into the per node per tree \r\n   * memory. If only the treeScope is provided, it will save the value into \r\n   * the per tree memory. If no parameter is provided, this method will save \r\n   * the value into the global memory. Notice that, if only nodeScope is \r\n   * provided (but treeScope not), this method will still save the value into\r\n   * the global memory.\r\n   *\r\n   * @method set\r\n   * @param {String} key The key to be stored.\r\n   * @param {String} value The value to be stored.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   **/\r\n  p.set = function(key, value, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    memory[key] = value;\r\n  };\r\n\r\n  /**\r\n   * Retrieves a value in the blackboard. If treeScope and nodeScope are\r\n   * provided, this method will retrieve the value from the per node per tree\r\n   * memory. If only the treeScope is provided, it will retrieve the value\r\n   * from the per tree memory. If no parameter is provided, this method will\r\n   * retrieve from the global memory. If only nodeScope is provided (but\r\n   * treeScope not), this method will still try to retrieve from the global\r\n   * memory.\r\n   *\r\n   * @method get\r\n   * @param {String} key The key to be retrieved.\r\n   * @param {String} treeScope The tree id if accessing the tree or node \r\n   *                           memory.\r\n   * @param {String} nodeScope The node id if accessing the node memory.\r\n   * @returns {Object} The value stored or undefined.\r\n   **/\r\n  p.get = function(key, treeScope, nodeScope) {\r\n    var memory = this._getMemory(treeScope, nodeScope);\r\n    return memory[key];\r\n  };\r\n\r\n  b3.Blackboard = Blackboard;\r\n\r\n})();\r\n/**\r\n * Tick\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * A new Tick object is instantiated every tick by BehaviorTree. It is passed \r\n   * as parameter to the nodes through the tree during the traversal.\r\n   * \r\n   * The role of the Tick class is to store the instances of tree, debug, target\r\n   * and blackboard. So, all nodes can access these informations.\r\n   * \r\n   * For internal uses, the Tick also is useful to store the open node after the \r\n   * tick signal, in order to let `BehaviorTree` to keep track and close them \r\n   * when necessary.\r\n   *\r\n   * This class also makes a bridge between nodes and the debug, passing the node\r\n   * state to the debug if the last is provided.\r\n   *\r\n   * @class Tick\r\n   **/\r\n  var Tick = b3.Class();\r\n\r\n  var p = Tick.prototype;\r\n\r\n  /**\r\n   * The tree reference.\r\n   * \r\n   * @property tree\r\n   * @type {b3.BehaviorTree}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The debug reference.\r\n   * \r\n   * @property debug\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The target object reference.\r\n   * \r\n   * @property target\r\n   * @type {Object}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The blackboard reference.\r\n   * \r\n   * @property blackboard\r\n   * @type {Blackboard}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The list of open nodes. Update during the tree traversal.\r\n   * \r\n   * @property _openNodes\r\n   * @type {Array}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The number of nodes entered during the tick. Update during the tree \r\n   * traversal.\r\n   * \r\n   * @property _nodeCount\r\n   * @type {Integer}\r\n   * @protected\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    // set by BehaviorTree\r\n    this.tree = null;\r\n    this.debug = null;\r\n    this.target = null;\r\n    this.blackboard = null;\r\n\r\n    // updated during the tick signal\r\n    this._openNodes = [];\r\n    this._nodeCount = 0;\r\n  }\r\n\r\n  /**\r\n   * Called when entering a node (called by BaseNode).\r\n   *\r\n   * @method _enterNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._enterNode = function(node) {\r\n    this._nodeCount++;\r\n    this._openNodes.push(node);\r\n\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when opening a node (called by BaseNode). \r\n   *\r\n   * @method _openNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._openNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when ticking a node (called by BaseNode).\r\n   *\r\n   * @method _tickNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._tickNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  /**\r\n   * Callback when closing a node (called by BaseNode).\r\n   *\r\n   * @method _closeNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._closeNode = function(node) {\r\n    // TODO: call debug here\r\n    this._openNodes.pop();\r\n  }\r\n\r\n  /**\r\n   * Callback when exiting a node (called by BaseNode).\r\n   *\r\n   * @method _exitNode\r\n   * @param {Object} node The node that called this method.\r\n   * @protected\r\n   **/\r\n  p._exitNode = function(node) {\r\n    // TODO: call debug here\r\n  }\r\n\r\n  b3.Tick = Tick;\r\n\r\n})();\r\n/**\r\n * BehaviorTree\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BehaviorTree class, as the name implies, represents the Behavior Tree \r\n   * structure.\r\n   * \r\n   * There are two ways to construct a Behavior Tree: by manually setting the \r\n   * root node, or by loading it from a data structure (which can be loaded from \r\n   * a JSON). Both methods are shown in the examples below and better explained \r\n   * in the user guide.\r\n   *\r\n   * The tick method must be called periodically, in order to send the tick \r\n   * signal to all nodes in the tree, starting from the root. The method \r\n   * `BehaviorTree.tick` receives a target object and a blackboard as parameters.\r\n   * The target object can be anything: a game agent, a system, a DOM object, \r\n   * etc. This target is not used by any piece of Behavior3JS, i.e., the target\r\n   * object will only be used by custom nodes.\r\n   * \r\n   * The blackboard is obligatory and must be an instance of `Blackboard`. This \r\n   * requirement is necessary due to the fact that neither `BehaviorTree` or any \r\n   * node will store the execution variables in its own object (e.g., the BT does\r\n   * not store the target, information about opened nodes or number of times the \r\n   * tree was called). But because of this, you only need a single tree instance \r\n   * to control multiple (maybe hundreds) objects.\r\n   * \r\n   * Manual construction of a Behavior Tree\r\n   * --------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *  \r\n   *     tree.root = new b3.Sequence({children:[\r\n   *         new b3.Priority({children:[\r\n   *             new MyCustomNode(),\r\n   *             new MyCustomNode()\r\n   *         ]}),\r\n   *         ...\r\n   *     ]});\r\n   *     \r\n   * \r\n   * Loading a Behavior Tree from data structure\r\n   * -------------------------------------------\r\n   * \r\n   *     var tree = new b3.BehaviorTree();\r\n   *\r\n   *     tree.load({\r\n   *         'title'       : 'Behavior Tree title'\r\n   *         'description' : 'My description'\r\n   *         'root'        : 'node-id-1'\r\n   *         'nodes'       : {\r\n   *             'node-id-1' : {\r\n   *                 'name'        : 'Priority', // this is the node type\r\n   *                 'title'       : 'Root Node', \r\n   *                 'description' : 'Description', \r\n   *                 'children'    : ['node-id-2', 'node-id-3'], \r\n   *             },\r\n   *             ...\r\n   *         }\r\n   *     })\r\n   *     \r\n   *\r\n   * @class BehaviorTree\r\n   **/\r\n  var BehaviorTree = b3.Class();\r\n\r\n  var p = BehaviorTree.prototype;\r\n\r\n  /**\r\n   * The tree id, must be unique. By default, created with `b3.createUUID`.\r\n   * \r\n   * @property id\r\n   * @type {String}\r\n   * @readOnly\r\n   */\r\n\r\n  /**\r\n   * The tree title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * Description of the tree.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   */\r\n\r\n  /**\r\n   * A dictionary with (key-value) properties. Useful to define custom \r\n   * variables in the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * The reference to the root node. Must be an instance of `b3.BaseNode`.\r\n   *\r\n   * @property root\r\n   * @type {BaseNode}\r\n   */\r\n\r\n  /**\r\n   * The reference to the debug instance.\r\n   *\r\n   * @property debug\r\n   * @type {Object}\r\n   */\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = 'The behavior tree';\r\n    this.description = 'Default description';\r\n    this.properties = {};\r\n    this.root = null;\r\n    this.debug = null;\r\n  }\r\n\r\n  /**\r\n   * This method loads a Behavior Tree from a data structure, populating this\r\n   * object with the provided data. Notice that, the data structure must \r\n   * follow the format specified by Behavior3JS. Consult the guide to know \r\n   * more about this format.\r\n   *\r\n   * You probably want to use custom nodes in your BTs, thus, you need to \r\n   * provide the `names` object, in which this method can find the nodes by \r\n   * `names[NODE_NAME]`. This variable can be a namespace or a dictionary, \r\n   * as long as this method can find the node by its name, for example:\r\n   *\r\n   *     //json\r\n   *     ...\r\n   *     'node1': {\r\n   *       'name': MyCustomNode,\r\n   *       'title': ...\r\n   *     }\r\n   *     ...\r\n   *     \r\n   *     //code\r\n   *     var bt = new b3.BehaviorTree();\r\n   *     bt.load(data, {'MyCustomNode':MyCustomNode})\r\n   *     \r\n   * \r\n   * @method load\r\n   * @param {Object} data The data structure representing a Behavior Tree.\r\n   * @param {Object} [names] A namespace or dict containing custom nodes.\r\n   **/\r\n  p.load = function(data, names) {\r\n    names = names || {};\r\n\r\n    this.title = data.title || this.title;\r\n    this.description = data.description || this.description;\r\n    this.properties = data.properties || this.properties;\r\n\r\n    var nodes = {};\r\n    // Create the node list (without connection between them)\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n\r\n      if (spec.name in names) {\r\n        // Look for the name in custom nodes\r\n        var cls = names[spec.name];\r\n      }\r\n      else if (spec.name in b3) {\r\n        // Look for the name in default nodes\r\n        var cls = b3[spec.name];\r\n      }\r\n      else {\r\n        // Invalid node name\r\n        throw EvalError('BehaviorTree.load: Invalid node name + \"' +\r\n          spec.name + '\".');\r\n      }\r\n\r\n      var node = new cls(spec.parameters);\r\n      node.id = spec.id || node.id;\r\n      node.title = spec.title || node.title;\r\n      node.description = spec.description || node.description;\r\n      node.properties = spec.properties || node.properties;\r\n      node.parameters = spec.parameters || node.parameters;\r\n\r\n      nodes[id] = node;\r\n    }\r\n\r\n    // Connect the nodes\r\n    for (var id in data.nodes) {\r\n      var spec = data.nodes[id];\r\n      var node = nodes[id];\r\n\r\n      if (node.category === b3.COMPOSITE && spec.children) {\r\n        for (var i = 0; i < spec.children.length; i++) {\r\n          var cid = spec.children[i];\r\n          node.children.push(nodes[cid]);\r\n        }\r\n      }\r\n      else if (node.category === b3.DECORATOR && spec.child) {\r\n        node.child = nodes[spec.child];\r\n      }\r\n    }\r\n\r\n    this.root = nodes[data.root];\r\n  };\r\n\r\n  /**\r\n   * This method dump the current BT into a data structure.\r\n   *\r\n   * Note: This method does not record the current node parameters. Thus, \r\n   * it may not be compatible with load for now.\r\n   * \r\n   * @method dump\r\n   * @returns {Object} A data object representing this tree.\r\n   **/\r\n  p.dump = function() {\r\n    var data = {};\r\n\r\n    data.title = this.title;\r\n    data.description = this.description;\r\n    data.root = (this.root) ? this.root.id : null;\r\n    data.properties = this.properties;\r\n    data.nodes = {};\r\n\r\n    if (!this.root) return data;\r\n\r\n    var stack = [this.root];\r\n    while (stack.length > 0) {\r\n      var node = stack.pop();\r\n\r\n      var spec = {};\r\n      spec.id = node.id;\r\n      spec.name = node.name;\r\n      spec.title = node.title;\r\n      spec.description = node.description;\r\n      spec.properties = node.properties;\r\n      spec.parameters = node.parameters;\r\n\r\n      if (node.category === b3.COMPOSITE && node.children) {\r\n        var children = []\r\n        for (var i = node.children.length - 1; i >= 0; i--) {\r\n          children.push(node.children[i].id);\r\n          stack.push(node.children[i]);\r\n        }\r\n        spec.children = children;\r\n      }\r\n      else if (node.category === b3.DECORATOR && node.child) {\r\n        stack.push(node.child);\r\n        spec.child = node.child.id;\r\n      }\r\n\r\n      data.nodes[node.id] = spec;\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  /**\r\n   * Propagates the tick signal through the tree, starting from the root.\r\n   * \r\n   * This method receives a target object of any type (Object, Array, \r\n   * DOMElement, whatever) and a `Blackboard` instance. The target object has\r\n   * no use at all for all Behavior3JS components, but surely is important \r\n   * for custom nodes. The blackboard instance is used by the tree and nodes \r\n   * to store execution variables (e.g., last node running) and is obligatory\r\n   * to be a `Blackboard` instance (or an object with the same interface).\r\n   * \r\n   * Internally, this method creates a Tick object, which will store the \r\n   * target and the blackboard objects.\r\n   * \r\n   * Note: BehaviorTree stores a list of open nodes from last tick, if these \r\n   * nodes weren't called after the current tick, this method will close them \r\n   * automatically.\r\n   * \r\n   * @method tick\r\n   * @param {Object} target A target object.\r\n   * @param {Blackboard} blackboard An instance of blackboard object.\r\n   * @returns {Constant} The tick signal state.\r\n   **/\r\n  p.tick = function(target, blackboard) {\r\n    if (!blackboard) {\r\n      throw 'The blackboard parameter is obligatory and must be an ' +\r\n      'instance of b3.Blackboard';\r\n    }\r\n\r\n    /* CREATE A TICK OBJECT */\r\n    var tick = new b3.Tick();\r\n    tick.debug = this.debug;\r\n    tick.target = target;\r\n    tick.blackboard = blackboard;\r\n    tick.tree = this;\r\n\r\n    /* TICK NODE */\r\n    var state = this.root._execute(tick);\r\n\r\n    /* CLOSE NODES FROM LAST TICK, IF NEEDED */\r\n    var lastOpenNodes = blackboard.get('openNodes', this.id);\r\n    var currOpenNodes = tick._openNodes.slice(0);\r\n\r\n    // does not close if it is still open in this tick\r\n    var start = 0;\r\n    for (var i = 0; i < Math.min(lastOpenNodes.length, currOpenNodes.length); i++) {\r\n      start = i + 1;\r\n      if (lastOpenNodes[i] !== currOpenNodes[i]) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    // close the nodes\r\n    for (var i = lastOpenNodes.length - 1; i >= start; i--) {\r\n      lastOpenNodes[i]._close(tick);\r\n    }\r\n\r\n    /* POPULATE BLACKBOARD */\r\n    blackboard.set('openNodes', currOpenNodes, this.id);\r\n    blackboard.set('nodeCount', tick._nodeCount, this.id);\r\n\r\n    return state;\r\n  };\r\n\r\n\r\n  b3.BehaviorTree = BehaviorTree;\r\n\r\n})();\r\n/**\r\n * BaseNode\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The BaseNode class is used as super class to all nodes in BehaviorJS. It \r\n   * comprises all common variables and methods that a node must have to execute.\r\n   *\r\n   * **IMPORTANT:** Do not inherit from this class, use `b3.Composite`, \r\n   * `b3.Decorator`, `b3.Action` or `b3.Condition`, instead.\r\n   *\r\n   * The attributes are specially designed to serialization of the node in a JSON\r\n   * format. In special, the `parameters` attribute can be set into the visual \r\n   * editor (thus, in the JSON file), and it will be used as parameter on the \r\n   * node initialization at `BehaviorTree.load`.\r\n   * \r\n   * BaseNode also provide 5 callback methods, which the node implementations can\r\n   * override. They are `enter`, `open`, `tick`, `close` and `exit`. See their \r\n   * documentation to know more. These callbacks are called inside the `_execute`\r\n   * method, which is called in the tree traversal.\r\n   * \r\n   * @class BaseNode\r\n   **/\r\n  var BaseNode = b3.Class();\r\n\r\n  var p = BaseNode.prototype;\r\n\r\n  /**\r\n   * Node ID.\r\n   *\r\n   * @property id\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n\r\n  /**\r\n   * Node name. Must be a unique identifier, preferable the same name of the \r\n   * class. You have to set the node name in the prototype.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = null;\r\n\r\n  /**\r\n   * Node category. Must be `b3.COMPOSITE`, `b3.DECORATOR`, `b3.ACTION` or \r\n   * `b3.CONDITION`. This is defined automatically be inheriting the \r\n   * correspondent class.\r\n   *\r\n   * @property category\r\n   * @type constant\r\n   * @readonly\r\n   **/\r\n  p.category = null;\r\n\r\n  /**\r\n   * Node title.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.title = null;\r\n\r\n  /**\r\n   * Node description.\r\n   *\r\n   * @property description\r\n   * @type {String}\r\n   * @optional\r\n   * @readonly\r\n   **/\r\n  p.description = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node parameters. Useful for \r\n   * defining parameter values in the visual editor. Note: this is only \r\n   * useful for nodes when loading trees from JSON files.\r\n   *\r\n   * @property parameters\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.parameters = null;\r\n\r\n  /**\r\n   * A dictionary (key, value) describing the node properties. Useful for \r\n   * defining custom variables inside the visual editor.\r\n   *\r\n   * @property properties\r\n   * @type {Object}\r\n   * @readonly\r\n   **/\r\n  p.properties = null;\r\n\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.id = b3.createUUID();\r\n    this.title = this.title || this.name;\r\n    this.description = '';\r\n    this.parameters = {};\r\n    this.properties = {};\r\n  }\r\n\r\n  /**\r\n   * This is the main method to propagate the tick signal to this node. This \r\n   * method calls all callbacks: `enter`, `open`, `tick`, `close`, and \r\n   * `exit`. It only opens a node if it is not already open. In the same \r\n   * way, this method only close a node if the node  returned a status \r\n   * different of `b3.RUNNING`.\r\n   *\r\n   * @method _execute\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} The tick state.\r\n   * @protected\r\n   **/\r\n  p._execute = function(tick) {\r\n    /* ENTER */\r\n    this._enter(tick);\r\n\r\n    /* OPEN */\r\n    if (!tick.blackboard.get('isOpen', tick.tree.id, this.id)) {\r\n      this._open(tick);\r\n    }\r\n\r\n    /* TICK */\r\n    var status = this._tick(tick);\r\n\r\n    /* CLOSE */\r\n    if (status !== b3.RUNNING) {\r\n      this._close(tick);\r\n    }\r\n\r\n    /* EXIT */\r\n    this._exit(tick);\r\n\r\n    return status;\r\n  }\r\n\r\n  /**\r\n   * Wrapper for enter method.\r\n   *\r\n   * @method _enter\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._enter = function(tick) {\r\n    tick._enterNode(this);\r\n    this.enter(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for open method.\r\n   *\r\n   * @method _open\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._open = function(tick) {\r\n    tick._openNode(this);\r\n    tick.blackboard.set('isOpen', true, tick.tree.id, this.id);\r\n    this.open(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for tick method.\r\n   *\r\n   * @method _tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   * @protected\r\n   **/\r\n  p._tick = function(tick) {\r\n    tick._tickNode(this);\r\n    return this.tick(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for close method.\r\n   *\r\n   * @method _close\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._close = function(tick) {\r\n    tick._closeNode(this);\r\n    tick.blackboard.set('isOpen', false, tick.tree.id, this.id);\r\n    this.close(tick);\r\n  }\r\n\r\n  /**\r\n   * Wrapper for exit method.\r\n   *\r\n   * @method _exit\r\n   * @param {Tick} tick A tick instance.\r\n   * @protected\r\n   **/\r\n  p._exit = function(tick) {\r\n    tick._exitNode(this);\r\n    this.exit(tick);\r\n  }\r\n\r\n  /**\r\n   * Enter method, override this to use. It is called every time a node is \r\n   * asked to execute, before the tick itself.\r\n   *\r\n   * @method enter\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.enter = function(tick) {}\r\n\r\n  /**\r\n   * Open method, override this to use. It is called only before the tick \r\n   * callback and only if the not isn't closed.\r\n   *\r\n   * Note: a node will be closed if it returned `b3.RUNNING` in the tick.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {}\r\n\r\n  /**\r\n   * Tick method, override this to use. This method must contain the real \r\n   * execution of node (perform a task, call children, etc.). It is called\r\n   * every time a node is asked to execute.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {}\r\n\r\n  /**\r\n   * Close method, override this to use. This method is called after the tick\r\n   * callback, and only if the tick return a state different from \r\n   * `b3.RUNNING`.\r\n   *\r\n   * @method close\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.close = function(tick) {}\r\n\r\n  /**\r\n   * Exit method, override this to use. Called every time in the end of the \r\n   * execution.\r\n   *\r\n   * @method exit\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.exit = function(tick) {}\r\n\r\n  b3.BaseNode = BaseNode;\r\n\r\n})();\r\n/**\r\n * Action\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Action is the base class for all action nodes. Thus, if you want to \r\n   * create new custom action nodes, you need to inherit from this class. \r\n   *\r\n   * For example, take a look at the Runner action:\r\n   * \r\n   *     var Runner = b3.Class(b3.Action);\r\n   *     var p = Runner.prototype;\r\n   *     \r\n   *         p.name = 'Runner';\r\n   *     \r\n   *         p.tick = function(tick) {\r\n   *             return b3.RUNNING;\r\n   *         }\r\n   *\r\n   * @class Action\r\n   * @extends BaseNode\r\n   **/\r\n  var Action = b3.Class(b3.BaseNode);\r\n\r\n  var p = Action.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.ACTION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.ACTION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Action = Action;\r\n\r\n})();\r\n/**\r\n * Composite\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Composite is the base class for all composite nodes. Thus, if you want to \r\n   * create new custom composite nodes, you need to inherit from this class. \r\n   * \r\n   * When creating composite nodes, you will need to propagate the tick signal to\r\n   * the children nodes manually. To do that, override the `tick` method and call \r\n   * the `_execute` method on all nodes. For instance, take a look at how the \r\n   * Sequence node inherit this class and how it call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Composite, using the util function Class.\r\n   *     var Sequence = b3.Class(b3.Composite);\r\n   *     var p = Sequence.prototype;\r\n   *\r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Sequence';\r\n   *         \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *\r\n   *             // Iterates over the children\r\n   *             for (var i=0; i<this.children.length; i++) {\r\n   *\r\n   *                 // Propagate the tick\r\n   *                 var status = this.children[i]._execute(tick);\r\n   * \r\n   *                 if (status !== b3.SUCCESS) {\r\n   *                     return status;\r\n   *                 }\r\n   *             }\r\n   *\r\n   *             return b3.SUCCESS;\r\n   *         }\r\n   *\r\n   * @class Composite\r\n   * @extends BaseNode\r\n   **/\r\n  var Composite = b3.Class(b3.BaseNode);\r\n\r\n  var p = Composite.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.COMPOSITE`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.COMPOSITE;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.children = (settings.children || []).slice(0);\r\n  };\r\n\r\n  b3.Composite = Composite;\r\n\r\n})();\r\n/**\r\n * Decorator\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Decorator is the base class for all decorator nodes. Thus, if you want to \r\n   * create new custom decorator nodes, you need to inherit from this class. \r\n   * \r\n   * When creating decorator nodes, you will need to propagate the tick signal to\r\n   * the child node manually, just like the composite nodes. To do that, override\r\n   * the `tick` method and call the `_execute` method on the child node. For \r\n   * instance, take a look at how the Inverter node inherit this class and how it\r\n   * call its children:\r\n   *\r\n   *\r\n   *     // Inherit from Decorator, using the util function Class.\r\n   *     var Inverter = b3.Class(b3.Decorator);\r\n   *     var p = Inverter.prototype;\r\n   *     \r\n   *         // Remember to set the name of the node. \r\n   *         p.name = 'Inverter';\r\n   *     \r\n   *         // Override the tick function\r\n   *         p.tick = function(tick) {\r\n   *             if (!this.child) {\r\n   *                 return b3.ERROR;\r\n   *             }\r\n   *     \r\n   *             // Propagate the tick\r\n   *             var status = this.child._execute(tick);\r\n   *     \r\n   *             if (status == b3.SUCCESS)\r\n   *                 status = b3.FAILURE;\r\n   *             else if (status == b3.FAILURE)\r\n   *                 status = b3.SUCCESS;\r\n   *     \r\n   *             return status;\r\n   *         };\r\n   *\r\n   * @class Decorator\r\n   * @extends BaseNode\r\n   **/\r\n  var Decorator = b3.Class(b3.BaseNode);\r\n\r\n  var p = Decorator.prototype;\r\n\r\n  /**\r\n   * Node category. Default to b3.DECORATOR.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.DECORATOR;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__BaseNode_initialize();\r\n\r\n    this.child = settings.child || null;\r\n  };\r\n\r\n  b3.Decorator = Decorator;\r\n\r\n})();\r\n/**\r\n * Condition\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Condition is the base class for all condition nodes. Thus, if you want to \r\n   * create new custom condition nodes, you need to inherit from this class. \r\n   *\r\n   * @class Condition\r\n   * @extends BaseNode\r\n   **/\r\n  var Condition = b3.Class(b3.BaseNode);\r\n\r\n  var p = Condition.prototype;\r\n\r\n  /**\r\n   * Node category. Default to `b3.CONDITION`.\r\n   *\r\n   * @property category\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.category = b3.CONDITION;\r\n\r\n  p.__BaseNode_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * @method initialize\r\n   * @constructor\r\n   **/\r\n  p.initialize = function() {\r\n    this.__BaseNode_initialize();\r\n  }\r\n\r\n  b3.Condition = Condition;\r\n\r\n})();\r\n/**\r\n * Sequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Sequence node ticks its children sequentially until one of them returns \r\n   * `FAILURE`, `RUNNING` or `ERROR`. If all children return the success state, \r\n   * the sequence also returns `SUCCESS`.\r\n   *\r\n   * @class Sequence\r\n   * @extends Composite\r\n   **/\r\n  var Sequence = b3.Class(b3.Composite);\r\n\r\n  var p = Sequence.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Sequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Sequence';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Sequence = Sequence;\r\n\r\n})();\r\n/**\r\n * Priority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Priority ticks its children sequentially until one of them returns \r\n   * `SUCCESS`, `RUNNING` or `ERROR`. If all children return the failure state, \r\n   * the priority also returns `FAILURE`.\r\n   *\r\n   * @class Priority\r\n   * @extends Composite\r\n   **/\r\n  var Priority = b3.Class(b3.Composite);\r\n\r\n  var p = Priority.prototype\r\n\r\n  /**\r\n   * Node name. Default to `Priority`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Priority';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    for (var i = 0; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Priority = Priority;\r\n\r\n})();\r\n/**\r\n * MemSequence\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemSequence is similar to Sequence node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the MemPriority \r\n   * call the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemSequence = b3.Class(b3.Composite);\r\n\r\n  var p = MemSequence.prototype\r\n\r\n  /**\r\n   * Node name. Default to `MemSequence`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemSequence';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.SUCCESS) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.MemSequence = MemSequence;\r\n\r\n})();\r\n/**\r\n * MemPriority\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * MemPriority is similar to Priority node, but when a child returns a \r\n   * `RUNNING` state, its index is recorded and in the next tick the, MemPriority \r\n   * calls the child recorded directly, without calling previous children again.\r\n   *\r\n   * @class MemPriority\r\n   * @extends Composite\r\n   **/\r\n  var MemPriority = b3.Class(b3.Composite);\r\n\r\n  var p = MemPriority.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MemPriority`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MemPriority';\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {b3.Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('runningChild', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var child = tick.blackboard.get('runningChild', tick.tree.id, this.id);\r\n    for (var i = child; i < this.children.length; i++) {\r\n      var status = this.children[i]._execute(tick);\r\n\r\n      if (status !== b3.FAILURE) {\r\n        if (status === b3.RUNNING) {\r\n          tick.blackboard.set('runningChild', i, tick.tree.id, this.id);\r\n        }\r\n        return status;\r\n      }\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.MemPriority = MemPriority;\r\n\r\n})();\r\n/**\r\n * Inverter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The Inverter decorator inverts the result of the child, returning `SUCCESS`\r\n   * for `FAILURE` and `FAILURE` for `SUCCESS`.\r\n   *\r\n   * @class Inverter\r\n   * @extends Decorator\r\n   **/\r\n  var Inverter = b3.Class(b3.Decorator);\r\n\r\n  var p = Inverter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Inverter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Inverter';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var status = this.child._execute(tick);\r\n\r\n    if (status == b3.SUCCESS)\r\n      status = b3.FAILURE;\r\n    else if (status == b3.FAILURE)\r\n      status = b3.SUCCESS;\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.Inverter = Inverter;\r\n\r\n})();\r\n/**\r\n * Limiter\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This decorator limit the number of times its child can be called. After a\r\n   * certain number of times, the Limiter decorator returns `FAILURE` without \r\n   * executing the child.\r\n   *\r\n   * @class Limiter\r\n   * @extends Decorator\r\n   **/\r\n  var Limiter = b3.Class(b3.Decorator);\r\n\r\n  var p = Limiter.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Limiter`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Limiter';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method. \r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxLoop) {\r\n      throw \"maxLoop parameter in Limiter decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxLoop = settings.maxLoop;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    if (i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        tick.blackboard.set('i', i + 1, tick.tree.id, this.id);\r\n\r\n      return status;\r\n    }\r\n\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Limiter = Limiter;\r\n\r\n})();\r\n/**\r\n * MaxTime\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * The MaxTime decorator limits the maximum time the node child can execute. \r\n   * Notice that it does not interrupt the execution itself (i.e., the child must\r\n   * be non-preemptive), it only interrupts the node after a `RUNNING` status.\r\n   *\r\n   * @class MaxTime\r\n   * @extends Decorator\r\n   **/\r\n  var MaxTime = b3.Class(b3.Decorator);\r\n\r\n  var p = MaxTime.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `MaxTime`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'MaxTime';\r\n\r\n  /**\r\n   * Node title. Default to `Max Time`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Max Time';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxTime': null\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxTime** (*Integer*) Maximum time a child can execute.\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    if (!settings.maxTime) {\r\n      throw \"maxTime parameter in MaxTime decorator is an obligatory \" +\r\n      \"parameter\";\r\n    }\r\n\r\n    this.maxTime = settings.maxTime;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    var status = this.child._execute(tick);\r\n    if (currTime - startTime > this.maxTime) {\r\n      return b3.FAILURE;\r\n    }\r\n\r\n    return status;\r\n  };\r\n\r\n  b3.MaxTime = MaxTime;\r\n\r\n})();\r\n/**\r\n * Repeater\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Repeater is a decorator that repeats the tick signal until the child node \r\n   * return `RUNNING` or `ERROR`. Optionally, a maximum number of repetitions \r\n   * can be defined.\r\n   *\r\n   * @class Repeater\r\n   * @extends Decorator\r\n   **/\r\n  var Repeater = b3.Class(b3.Decorator);\r\n\r\n  var p = Repeater.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Repeater`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Repeater';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   * \r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  };\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  };\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n    var status = b3.SUCCESS;\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS || status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  };\r\n\r\n  b3.Repeater = Repeater;\r\n\r\n})();\r\n/**\r\n * RepeatUntilFailure\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilFailure is a decorator that repeats the tick signal until the \r\n   * node child returns `FAILURE`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilFailure\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilFailure = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilFailure.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilFailure`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilFailure';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Failure`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Failure';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.SUCCESS)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilFailure = RepeatUntilFailure;\r\n\r\n})();\r\n/**\r\n * RepeatUntilSuccess\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * RepeatUntilSuccess is a decorator that repeats the tick signal until the \r\n   * node child returns `SUCCESS`, `RUNNING` or `ERROR`. Optionally, a maximum \r\n   * number of repetitions can be defined.\r\n   *\r\n   * @class RepeatUntilSuccess\r\n   * @extends Decorator\r\n   **/\r\n  var RepeatUntilSuccess = b3.Class(b3.Decorator);\r\n\r\n  var p = RepeatUntilSuccess.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `RepeatUntilSuccess`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'RepeatUntilSuccess';\r\n\r\n  /**\r\n   * Node title. Default to `Repeat Until Success`.\r\n   *\r\n   * @property title\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.title = 'Repeat Until Success';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'maxLoop': -1\r\n  };\r\n\r\n  p.__Decorator_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **maxLoop** (*Integer*) Maximum number of repetitions. Default to -1 \r\n   *                           (infinite).\r\n   * - **child** (*BaseNode*) The child node.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Decorator_initialize(settings);\r\n\r\n    this.maxLoop = settings.maxLoop || -1;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    tick.blackboard.set('i', 0, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    if (!this.child) {\r\n      return b3.ERROR;\r\n    }\r\n\r\n    var i = tick.blackboard.get('i', tick.tree.id, this.id);\r\n\r\n    while (this.maxLoop < 0 || i < this.maxLoop) {\r\n      var status = this.child._execute(tick);\r\n\r\n      if (status == b3.FAILURE)\r\n        i++;\r\n      else\r\n        break;\r\n    }\r\n\r\n    var i = tick.blackboard.set('i', i, tick.tree.id, this.id);\r\n    return status;\r\n  }\r\n\r\n  b3.RepeatUntilSuccess = RepeatUntilSuccess;\r\n\r\n})();\r\n/**\r\n * Error\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `ERROR` always.\r\n   *\r\n   * @class Error\r\n   * @extends Action\r\n   **/\r\n  var Error = b3.Class(b3.Action);\r\n\r\n  var p = Error.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Error`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Error';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.ERROR`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.ERROR;\r\n  }\r\n\r\n  b3.Error = Error;\r\n\r\n})();\r\n/**\r\n * Failer\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `FAILURE` always.\r\n   *\r\n   * @class Failer\r\n   * @extends Action\r\n   **/\r\n  var Failer = b3.Class(b3.Action);\r\n\r\n  var p = Failer.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Failer`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Failer';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.FAILURE`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.FAILURE;\r\n  }\r\n\r\n  b3.Failer = Failer;\r\n\r\n})();\r\n/**\r\n * Runner\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns RUNNING always.\r\n   *\r\n   * @class Runner\r\n   * @extends Action\r\n   **/\r\n  var Runner = b3.Class(b3.Action);\r\n\r\n  var p = Runner.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Runner`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Runner';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.RUNNING`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Runner = Runner;\r\n\r\n})();\r\n/**\r\n * Succeeder\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * This action node returns `SUCCESS` always.\r\n   *\r\n   * @class Succeeder\r\n   * @extends Action\r\n   **/\r\n  var Succeeder = b3.Class(b3.Action);\r\n\r\n  var p = Succeeder.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Succeeder`.\r\n   *\r\n   * @property name\r\n   * @type String\r\n   * @readonly\r\n   **/\r\n  p.name = 'Succeeder';\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {b3.Tick} tick A tick instance.\r\n   * @returns {Constant} Always return `b3.SUCCESS`.\r\n   **/\r\n  p.tick = function(tick) {\r\n    return b3.SUCCESS;\r\n  }\r\n\r\n  b3.Succeeder = Succeeder;\r\n\r\n})();\r\n/**\r\n * Wait\r\n *\r\n * Copyright (c) 2014 Renato de Pontes Pereira.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to \r\n * deal in the Software without restriction, including without limitation the \r\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\r\n * sell copies of the Software, and to permit persons to whom the Software is \r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\r\n * IN THE SOFTWARE.\r\n **/\r\n\r\n/**\r\n * @module Behavior3JS\r\n **/\r\n\r\n// namespace:\r\nthis.b3 = this.b3 || {};\r\n\r\n(function() {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Wait a few seconds.\r\n   *\r\n   * @class Wait\r\n   * @extends Action\r\n   **/\r\n  var Wait = b3.Class(b3.Action);\r\n\r\n  var p = Wait.prototype;\r\n\r\n  /**\r\n   * Node name. Default to `Wait`.\r\n   *\r\n   * @property name\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.name = 'Wait';\r\n\r\n  /**\r\n   * Node parameters.\r\n   *\r\n   * @property parameters\r\n   * @type {String}\r\n   * @readonly\r\n   **/\r\n  p.parameters = {\r\n    'milliseconds': 0\r\n  };\r\n\r\n  p.__Action_initialize = p.initialize;\r\n  /**\r\n   * Initialization method.\r\n   *\r\n   * Settings parameters:\r\n   *\r\n   * - **milliseconds** (*Integer*) Maximum time, in milliseconds, a child\r\n   *                                can execute.\r\n   *\r\n   * @method initialize\r\n   * @param {Object} settings Object with parameters.\r\n   * @constructor\r\n   **/\r\n  p.initialize = function(settings) {\r\n    settings = settings || {};\r\n\r\n    this.__Action_initialize();\r\n\r\n    this.endTime = settings.milliseconds || 0;\r\n  }\r\n\r\n  /**\r\n   * Open method.\r\n   *\r\n   * @method open\r\n   * @param {Tick} tick A tick instance.\r\n   **/\r\n  p.open = function(tick) {\r\n    var startTime = (new Date()).getTime();\r\n    tick.blackboard.set('startTime', startTime, tick.tree.id, this.id);\r\n  }\r\n\r\n  /**\r\n   * Tick method.\r\n   *\r\n   * @method tick\r\n   * @param {Tick} tick A tick instance.\r\n   * @returns {Constant} A state constant.\r\n   **/\r\n  p.tick = function(tick) {\r\n    var currTime = (new Date()).getTime();\r\n    var startTime = tick.blackboard.get('startTime', tick.tree.id, this.id);\r\n\r\n    if (currTime - startTime > this.endTime) {\r\n      return b3.SUCCESS;\r\n    }\r\n\r\n    return b3.RUNNING;\r\n  }\r\n\r\n  b3.Wait = Wait;\r\n\r\n})();\r\n\r\n","module.exports = {\n\n  Entity         : require('./lib/Entity.js'),\n  EntityManager  : require('./lib/EntityManager.js'),\n  Messanger      : require('./lib/Messanger.js'),\n  ObjectPool     : require('./lib/ObjectPool.js'),\n  QuadTree       : require('./lib/QuadTree.js'),\n  Spatial        : require('./lib/Spatial.js'),\n  Vec2           : require('./lib/Vec2.js')\n\n};\n","module.exports = Identifier;\r\n\r\nfunction Identifier() {\r\n  this.type = null;\r\n}\r\n\r\n","module.exports = Position;\r\n\r\nfunction Position() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n}\r\n\r\n","module.exports = Velocity;\r\n\r\nfunction Velocity() {\r\n  this.x = 0;\r\n  this.y = 0;\r\n  this.z = 0;\r\n\r\n  this.rotationMatrix = null;\r\n}\r\n\r\n","module.exports = Jump;\r\n\r\nfunction Jump() {\r\n  this.canJump = true;\r\n}\r\n\r\n","module.exports = Hurt;\r\n\r\nfunction Hurt() {\r\n  this.timer = 0;\r\n  this.invulnerabilityFrames = 1;\r\n\r\n  this.hurtColor = new THREE.Color(0xdd0000);\r\n  this.originalColor = 0xffffff;\r\n}\r\n\r\n","module.exports = Drawable;\r\n\r\nfunction Drawable() {\r\n  this.mesh = null;\r\n  this.scene = null;\r\n}\r\n\r\n","module.exports = ShootDelay;\r\n\r\nfunction ShootDelay() {\r\n  this.canShoot = true;\r\n\r\n  this.timer = 0;\r\n  this.delayTheshold = 0.2;\r\n}\r\n\r\n","module.exports = Expirable;\r\n\r\nfunction Expirable() {\r\n  this.age = 0;\r\n  this.maxAge = 5;\r\n}\r\n\r\n","module.exports = Bullet;\r\n\r\nfunction Bullet() {\r\n  this.isHot = true;\r\n  this.owner = null;\r\n}\r\n\r\n","module.exports = OneTimeHit;\r\n\r\nfunction OneTimeHit() {\r\n  this.alreadyHit = [];\r\n}\r\n\r\n","module.exports = CameraFollow;\r\n\r\nfunction CameraFollow() {\r\n  this.controls = null;\r\n  this.object = null;\r\n  this.offset = new THREE.Vector3();\r\n}\r\n\r\n","module.exports = Health;\r\n\r\nfunction Health() {\r\n  this.hp = 3;\r\n  this.maxHP = 3;\r\n\r\n  this.healthBar = null;\r\n\r\n  this.changed = false;\r\n}\r\n\r\n","module.exports = Ai;\r\n\r\nfunction Ai() {\r\n  this.tree = null;\r\n  this.target = null;\r\n  this.blackboard = null;\r\n}\r\n\r\n","module.exports = Entity;\n\n/**\n * Basic component-driven object with facade functions for interacting with the\n * injected EntityManager object.\n * @constructor\n */\nfunction Entity()\n{\n  // Injected by EntityManager\n  this._manager    = null;\n\n  /**\n   * @type {Array.<Function>}\n   * @private\n   */\n  this._Components = [];\n\n  /**\n   * @type {Array.<String>}\n   * @private\n   */\n  this._tags       = [];\n}\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.addComponent = function(TComponent)\n{\n  this._manager.entityAddComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {Entity} This entity.\n */\nEntity.prototype.removeComponent = function(TComponent)\n{\n  this._manager.entityRemoveComponent(this, TComponent);\n  return this;\n};\n\n/**\n * @param {Function} TComponent\n * @return {boolean} True if this entity has TComponent.\n */\nEntity.prototype.hasComponent = function(TComponent)\n{\n  return !!~this._Components.indexOf(TComponent);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {boolean} True if entity has all Components.\n */\nEntity.prototype.hasAllComponents = function(Components)\n{\n  var b = true;\n\n  for (var i = 0; i < Components.length; i++) {\n    var C = Components[i];\n    b &= !!~this._Components.indexOf(C);\n  }\n\n  return b;\n};\n\n/**\n * @param {String} tag\n * @return {boolean} True if entity has tag.\n */\nEntity.prototype.hasTag = function(tag)\n{\n  return !!~this._tags.indexOf(tag);\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.addTag = function(tag)\n{\n  this._manager.entityAddTag(this, tag);\n  return this;\n};\n\n/**\n * @param {String} tag\n * @return {Entity} This entity.\n */\nEntity.prototype.removeTag = function(tag)\n{\n  this._manager.entityRemoveTag(this, tag);\n  return this;\n};\n\n/**\n * @return {void}\n */\nEntity.prototype.remove = function()\n{\n  return this._manager.removeEntity(this);\n};\n\n","module.exports = Messanger;\n\nvar Event = require('./Event.js');\n\n/**\n * General event aggregation with filtering on components or tags.\n * @constructor\n */\nfunction Messanger()\n{\n  this._events = {};\n  this.fired   = 0;\n  this.handled = 0;\n}\n\n/**\n * @param {String} eventName\n * @param {Function} callback\n * @return {Event}\n */\nMessanger.prototype.listenTo = function(eventName, callback)\n{\n  if (!this._events[eventName])\n    this._events[eventName] = [];\n\n  var event = new Event(eventName, callback);\n\n  // Dump and chump\n  this._events[eventName].push(event);\n  return event;\n};\n\n/**\n * @param {String} eventName\n * @param {Object=} entity\n * @param {Option=} option\n */\nMessanger.prototype.trigger = function(eventName, entity, option)\n{\n  this.fired++;\n\n  var events = this._events[eventName];\n  if (!events) return;\n\n  // Try all events\n  for (var n = 0; n < events.length; n++) {\n    var event = events[n];\n    if (event.fire(eventName, entity, option))\n      this.handled++;\n  }\n};\n\n","module.exports = EntityManager;\n\nvar Entity     = require('./Entity.js');\nvar ObjectPool = require('./ObjectPool.js');\nvar Messanger  = require('./Messanger.js');\nvar getName    = require('typedef').getName;\n\n/**\n * Manage, create, and destroy entities. Can use methods to mutate entities\n * (tags, components) directly or via the facade on the Entity.\n * @param {Messanger} messanger\n * @constructor\n */\nfunction EntityManager(messanger)\n{\n  this.messanger = messanger;\n  this._tags = {};\n\n  /**\n   * @type {Array.<Entity>}\n   */\n  this._entities = [];\n\n  /**\n   * @type {Array.<Group>}\n   */\n  this._groups = {};\n\n  this._entityPool = new ObjectPool(Entity);\n\n  this._componentPools = {};\n}\n\n/**\n * Fired AFTER an entity has be created.\n * @event\n */\nEntityManager.ENTITY_CREATED = 'EntityManager#ENTITY_CREATED';\n\n/**\n * Fired BEFORE an entity has been removed.\n * @event\n */\nEntityManager.ENTITY_REMOVE = 'EntityManager#ENTITY_REMOVE';\n\n/**\n * Fired AFTER a component has been removed.\n * @event\n */\nEntityManager.COMPONENT_ADDED = 'EntityManager#COMPONENT_ADDED';\n\n/**\n * Fired BEFORE a component has been removedt\n * @event\n */\nEntityManager.COMPONENT_REMOVE = 'EntityManager#COMPONENT_REMOVE';\n\n/**\n * @constructor\n * @param {Array.<Function>} Components\n * @param {Array<Entity>} entities\n */\nfunction Group(Components, entities)\n{\n  this.Components = Components || [];\n  this.entities = entities || [];\n}\n\n/**\n * Get a new entity.\n * @return {Entity}\n */\nEntityManager.prototype.createEntity = function()\n{\n  var entity = this._entityPool.aquire();\n\n  this._entities.push(entity);\n  entity._manager = this;\n  this._trigger(EntityManager.ENTITY_CREATED, entity);\n  return entity;\n};\n\n/**\n * Cleanly remove entities based on tag. Avoids loop issues.\n * @param {String} tag\n */\nEntityManager.prototype.removeEntitiesByTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities) return;\n\n  for (var x = entities.length - 1; x >= 0; x--) {\n    var entity = entities[x];\n    entity.remove();\n  }\n};\n\n/**\n * Dump all entities out of the manager. Avoids loop issues.\n */\nEntityManager.prototype.removeAllEntities = function()\n{\n  for (var x = this._entities.length - 1; x >= 0; x--) {\n    this._entities[x].remove();\n  }\n};\n\n/**\n * Drop an entity. Returns it to the pool and fires all events for removing\n * components as well.\n * @param {Entity} entity\n */\nEntityManager.prototype.removeEntity = function(entity)\n{\n  var index = this._entities.indexOf(entity);\n\n  if (!~index)\n    throw new Error('Tried to remove entity not in list');\n\n  this.entityRemoveAllComponents(entity);\n\n  // Remove from entity list\n  this._trigger(EntityManager.ENTITY_REMOVE, entity);\n  this._entities.splice(index, 1);\n\n  // Remove entity from any tag groups\n  entity._tags = null;\n  for (var tag in this._tags) {\n    var entities = this._tags[tag];\n    var n = entities.indexOf(entity);\n    if (~n) entities.splice(n, 1);\n  }\n\n  // Prevent any acecss and free\n  entity._manager = null;\n  this._entityPool.release(entity);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityAddTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n\n  if (!entities)\n    entities = this._tags[tag] = [];\n\n  // Don't add if already there\n  if (~entities.indexOf(entity)) return;\n\n  entities.push(entity);\n  entity._tags.push(tag);\n};\n\n/**\n * @param {Entity} entity\n * @param {String} tag\n */\nEntityManager.prototype.entityRemoveTag = function(entity, tag)\n{\n  var entities = this._tags[tag];\n  if (!entities) return;\n\n  var index = entities.indexOf(entity);\n  if (!~index) return;\n\n  entities.splice(index, 1);\n  entity._tags.splice(entity._tags.indexOf(tag), 1);\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityAddComponent = function(entity, Component)\n{\n  if (~entity._Components.indexOf(Component)) return;\n\n  entity._Components.push(Component);\n\n  // Create the reference on the entity to this (aquired) component\n  var cName = componentPropertyName(Component);\n  var cPool = this._componentPools[cName];\n  if (!cPool)\n    cPool = this._componentPools[cName] = new ObjectPool(Component);\n  var component = cPool.aquire();\n  entity[cName] = component;\n\n  // Check each indexed group to see if we need to add this entity to the list\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n    if (~group.entities.indexOf(entity))\n      continue;\n\n    group.entities.push(entity);\n  }\n\n  this._trigger(EntityManager.COMPONENT_ADDED, entity, Component);\n};\n\n/**\n * Drop all components on an entity.\n * @param {Entity} entity\n */\nEntityManager.prototype.entityRemoveAllComponents = function(entity)\n{\n  var Cs = entity._Components;\n\n  for (var j = Cs.length - 1; j >= 0; j--) {\n    var C = Cs[j];\n    entity.removeComponent(C);\n  }\n};\n\n/**\n * @param {Entity} entity\n * @param {Function} Component\n */\nEntityManager.prototype.entityRemoveComponent = function(entity, Component)\n{\n  var index = entity._Components.indexOf(Component);\n  if (!~index) return;\n\n  this._trigger(EntityManager.COMPONENT_REMOVE, entity, Component);\n\n  // Check each indexed group to see if we need to remove it\n  for (var groupName in this._groups) {\n    var group = this._groups[groupName];\n\n    if (!~group.Components.indexOf(Component))\n      continue;\n    if (!entity.hasAllComponents(group.Components))\n      continue;\n\n    var loc = group.entities.indexOf(entity);\n    if (~loc) {\n      group.entities.splice(loc, 1);\n    }\n  }\n\n  // Remove T listing on entity and property ref, then free the component.\n  var propName = componentPropertyName(Component);\n  entity._Components.splice(index, 1);\n  var component = entity[propName];\n  delete entity[propName];\n  this._componentPools[propName].release(component);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryComponents = function(Components)\n{\n  var group = this._groups[groupKey(Components)];\n\n  if (!group) {\n    group = this._indexGroup(Components);\n  }\n\n  return group.entities;\n};\n\n/**\n * @param {String} tag\n * @return {Array.<Entity>}\n */\nEntityManager.prototype.queryTag = function(tag)\n{\n  var entities = this._tags[tag];\n\n  if (entities === undefined)\n    entities = this._tags[tag] = [];\n\n  return entities;\n};\n\n/**\n * @return {Number} Total number of entities.\n */\nEntityManager.prototype.count = function()\n{\n  return this._entities.length;\n};\n\n/**\n * Get information about the object pools of the entities and the various\n * components.\n * @return {Object}\n */\nEntityManager.prototype.poolStats = function()\n{\n  var stats = {};\n  var e = this._entityPool;\n  stats.entity = {\n    used: this._entityPool.totalUsed(),\n    size: this._entityPool.count\n  };\n\n  for (var cName in this._componentPools) {\n    var pool = this._componentPools[cName];\n    stats[cName] = {\n      used: pool.totalUsed(),\n      size: pool.count\n    };\n  }\n\n  return stats;\n};\n\n/**\n * Create an index of entities with a set of components.\n * @param {Array.<Function>} Components\n * @private\n */\nEntityManager.prototype._indexGroup = function(Components)\n{\n  var key = groupKey(Components);\n\n  if (this._groups[key]) return;\n\n  var group = this._groups[key] = new Group(Components);\n\n  for (var n = 0; n < this._entities.length; n++) {\n    var entity = this._entities[n];\n    if (entity.hasAllComponents(Components)) {\n      group.entities.push(entity);\n    }\n  }\n\n  return group;\n};\n\n/**\n * Trigger the messanger if we have one.\n * @param {String} event\n * @param {Object=} a\n * @param {Object=} b\n */\nEntityManager.prototype._trigger = function(event, a, b)\n{\n  if (this.messanger)\n    this.messanger.trigger(event, a, b);\n};\n\n/**\n * @param {Function} Component\n * @return {String}\n * @private\n */\nfunction componentPropertyName(Component)\n{\n  var name = getName(Component);\n  return name.charAt(0).toLowerCase() + name.slice(1);\n}\n\n/**\n * @param {Array.<Function>} Components\n * @return {String}\n * @private\n */\nfunction groupKey(Components)\n{\n  var names = [];\n  for (var n = 0; n < Components.length; n++) {\n    var T = Components[n];\n    names.push(getName(T));\n  }\n\n  return names\n    .map(function(x) { return x.toLowerCase(); })\n    .sort()\n    .join('-');\n}\n\n","module.exports = QuadTree;\n\nvar ObjectPool = require('./ObjectPool.js');\nvar Spatial    = require('./Spatial.js');\nvar Vec2       = require('./Vec2.js');\n\n/**\n * Effectively store positional and sized objects. Each tree has a position and\n * size, as well as up to 4 child nodes (other trees) and an array of entries.\n * @constructor\n */\nfunction QuadTree()\n{\n  this.level       = 0;\n  this.position    = new Vec2();\n  this.size        = new Vec2();\n  this.maxEntities = 15;\n  this.maxLevels   = 10;\n\n  /**\n   * Pool that is used for all internal quad trees. Only root node has one, all\n   * others have a refence.\n   */\n  this.pool = new ObjectPool(QuadTree);\n\n  /**\n   * @type {Array.<QuadTree>}\n   */\n  this.nodes = [];\n\n  /**\n   * @type {Array.<{spatial: Spatial}>}\n   */\n  this.entities = [];\n}\n\n/**\n * Reset for pool.\n * @private\n */\nQuadTree.prototype.__init = function()\n{\n  this.level = 0;\n  this.position.clear();\n  this.size.clear();\n  this.nodes.length = 0;\n  this.entities.length = 0;\n\n  // Only root node has actual ref to pool\n  this.pool = null;\n};\n\n/**\n * Add an entity to the tree\n * @param {{spatial: Spatial}} entity\n */\nQuadTree.prototype.insert = function(entity)\n{\n  // Recurse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].insert(entity);\n  }\n\n  // Actually add the entity\n  this.entities.push(entity);\n  this._splitAndRedistributeIfNeeded();\n  entity.spatial._node = this;\n  return entity;\n};\n\n/**\n * Remove an entity from this tree.\n * @param {{spatial: Spatial}} param\n */\nQuadTree.prototype.remove = function(entity)\n{\n  // Remove if we can\n  var n = this.entities.indexOf(entity);\n  if (~n) {\n    this.entities.splice(n, 1);\n    entity.spatial._node = null;\n    if (!this.totalSize())\n      this.clear();\n    return;\n  }\n\n  // Recuse if we can\n  if (this.nodes.length) {\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n    if (~index) return this.nodes[index].remove(entity);\n  }\n};\n\n/**\n * Total recursive size of this tree.\n * @return {Number}\n */\nQuadTree.prototype.totalSize = function()\n{\n  var size = this.entities.length;\n\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    size += node.totalSize();\n  }\n\n  return size;\n};\n\n/**\n * Empty the tree recursively.\n */\nQuadTree.prototype.clear = function()\n{\n  // Clear entity area\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n    entity.spatial._node = null;\n  }\n  this.entities.length = 0;\n\n  // Recurse, free the node, and wipe out our node length\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n    node.clear();\n    this.pool.release(node);\n  }\n  this.nodes.length = 0;\n};\n\n/**\n * Get all tree entries that are interesected by a rectangle defined with\n * position and hwidth.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @param {Array.<{spatial: Spatial}>=} out__objects Return objects.\n * @return {Array.<{spatial: Spatial}>} The out__objects parameter (filled up now)\n */\nQuadTree.prototype.queryArea = function(position, hwidth, out__entities)\n{\n  var entities = out__entities || [];\n\n  // If query belongs in ONLY a single node, then recurse\n  var index = this._getIndex(position, hwidth);\n  if (~index && this.nodes.length) {\n    this.nodes[index].queryArea(position, hwidth, entities);\n\n  // Otherwise, we have to add ALL of the nodes as it may be overlapping one\n  } else {\n    for (var j = 0; j < this.nodes.length; j++) {\n      var node = this.nodes[j];\n      node.queryArea(position, hwidth, entities);\n    }\n  }\n\n  // Also add everything from this node itself\n  for (var m = 0; m < this.entities.length; m++) {\n    var entity = this.entities[m];\n\n    var overlapping = Vec2.rectIntersect(\n      entity.spatial.absPosition(),\n      entity.spatial.absHwidth(),\n      position,\n      hwidth);\n\n    if (overlapping) {\n      entities.push(entity);\n    }\n  }\n\n  return entities;\n};\n\n/**\n * Do a complete reset of the tree.\n */\nQuadTree.prototype.reIndex = function()\n{\n  this._combine();\n  this._splitAndRedistributeIfNeeded();\n};\n\nvar tSize = new Vec2();\nvar tPos  = new Vec2();\n\n/**\n * Check to see if an entity is still valid.\n * @param {{spatial: Spatial}} entity\n * @return {Boolean} True if the entity is in this tree (non-recursive) in its\n * correct place. False implies we need to re-add it.\n */\nQuadTree.prototype.validateEntity = function(entity)\n{\n  var pos = entity.spatial.position;\n  var hw  = entity.spatial.hwidth;\n\n  // Check to see if we're still inside this node\n  tSize.assign(this.size).smult(0.5);\n  tPos.assign(tSize).add(this.position);\n  var inside = Vec2.rectContains(pos, hw, tPos, tSize);\n\n  if (!inside) return false;\n\n  // No children nodes, then we're good\n  if (!this.nodes.length)\n    return true;\n\n  // Or if children nodes and we overlap, still good\n  var index = this._getIndex(entity.spatial.absPosition(),\n    entity.spatial.absHwidth());\n  if (this.nodes.length && !~index)\n    return true;\n\n  // Didnt make it\n  return false;\n};\n\n/**\n * Return which of the 4 quandrants of this tree an object would go into.\n * @param {Vec2} position\n * @param {Vec2} hwidth\n * @return {Number} Which quandrant, or -1 if won't fit.\n * @private\n */\nQuadTree.prototype._getIndex = function(position, hwidth)\n{\n  var midX = this.position.x + this.size.x / 2;\n  var midY = this.position.y + this.size.y / 2;\n\n  var left   = position.x - hwidth.x < midX && position.x + hwidth.x < midX;\n  var right  = position.x - hwidth.x > midX && position.x + hwidth.x > midX;\n  var top    = position.y - hwidth.y < midY && position.y + hwidth.y < midY;\n  var bottom = position.y - hwidth.y > midY && position.y + hwidth.y > midY;\n\n  if (top && right) return 0;\n  if (top && left) return 1;\n  if (bottom && left) return 2;\n  if (bottom && right) return 3;\n\n  return -1;\n};\n\n/**\n * If we've overpacked this tree, then split into 4 smaller trees (if we\n * haven't already) and redistribute.\n * @private\n */\nQuadTree.prototype._splitAndRedistributeIfNeeded = function()\n{\n  if (this.entities.length > this.maxEntities &&\n    this.level < this.maxLevels)\n  {\n    this._split();\n    this._redistribute();\n  }\n};\n\n/**\n * Create a sub quad tree\n * @return {QuadTree}\n * @private\n */\nQuadTree.prototype._factory = function()\n{\n  var node = this.pool.aquire();\n\n  node.pool        = this.pool;\n  node.level       = this.level + 1;\n  node.maxEntities = this.maxEntities;\n  node.maxLevels   = this.maxLevels;\n\n  return node;\n};\n\n/**\n * Create 4 sub nodes for the tree (does not populate tho)\n * @private\n */\nQuadTree.prototype._split = function()\n{\n  if (this.nodes.length) return;\n\n  var x = this.position.x;\n  var y = this.position.y;\n\n  var w = this.size.x / 2;\n  var h = this.size.y / 2;\n\n  // Create the seperate nodes\n  for (var n = 0; n < 4; n++) {\n    var node = this._factory();\n    node.size.set(w, h);\n\n    switch(n) {\n      case 0:\n        node.position.set(x + w, y);\n        break;\n      case 1:\n        node.position.set(x, y);\n        break;\n      case 2:\n        node.position.set(x, y + h);\n        break;\n      case 3:\n        node.position.set(x + w, y + h);\n        break;\n    }\n\n    this.nodes.push(node);\n  }\n};\n\n/**\n * Distrubute all entities into child nodes if we can.\n * @private\n */\nQuadTree.prototype._redistribute = function()\n{\n  // Loop through all of our entries and if they can fit into a child node,\n  // move them there\n  var i = 0;\n  while (i < this.entities.length) {\n    var entity = this.entities[i];\n    var index = this._getIndex(entity.spatial.absPosition(),\n      entity.spatial.absHwidth());\n\n    // Insert into child, remove from our array if they belong in another node\n    if (~index) {\n      this.nodes[index].insert(entity);\n      this.entities.splice(i, 1);\n    } else {\n      i++;\n    }\n  }\n};\n\n/**\n * Unwinds this node. Move all child nodes into this node and remove child\n * nodes.\n * @private\n */\nQuadTree.prototype._combine = function()\n{\n  for (var n = 0; n < this.nodes.length; n++) {\n    var node = this.nodes[n];\n\n    // Combine all children first\n    node._combine();\n\n    // All entries combined on node, now add it to US\n    for (var m = 0; m < node.entities.length; m++) {\n      var entity = node.entities[m];\n      this.entities.push(entity);\n    }\n\n    // Clear out and ensure we release it\n    node.entities.length = 0;\n    node.clear();\n    this.pool.release(node);\n  }\n\n  // Clear nodes array\n  this.nodes.length = 0;\n};\n\n","module.exports = Vec2;\n\nvar ObjectPool = require('./ObjectPool.js');\n\n/**\n * 2-dimension Cartesian vector with built-in (optional) object pool.\n * @constructor\n * @param {Number} x\n * @param {Number} y\n */\nfunction Vec2(x, y)\n{\n  this.x = +x || 0.0;\n  this.y = +y || 0.0;\n}\n\n/**\n * Reset for pool.\n * @private\n */\nVec2.prototype.__init = function()\n{\n  this.clear();\n};\n\n// Interal static object pool\nvar pool = new ObjectPool(Vec2);\n\n/**\n * Get a vector from the pool.\n * @return {Vec2}\n */\nVec2.aquire = function()\n{\n  return pool.aquire();\n};\n\n/**\n * Return a vector to the pool.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.release = function(v)\n{\n  if (v) pool.release(v);\n  return pool.count - pool.freeList.length;\n};\n\n/**\n * Reset this vector to (0,0).\n * @return {Vec2} This vector.\n */\nVec2.prototype.clear = function()\n{\n  this.x = this.y = 0.0;\n  return this;\n};\n\n/**\n * Assign this vector the value of another.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.assign = function(v)\n{\n  this.x = v.x;\n  this.y = v.y;\n  return this;\n};\n\n/**\n * Determine if this vector is equal to another.\n * @param {Vec2} v\n * @return {Boolean} True if vectors are equal.\n */\nVec2.prototype.equals = function(v)\n{\n  return this.x === v.x && this.y === v.y;\n};\n\n/**\n * Set this vector to a set of coordinates.\n * @param {Number} x\n * @param {Number} y\n * @return {Vec2} This vector.\n */\nVec2.prototype.set = function(x, y)\n{\n  this.x = +x;\n  this.y = +y;\n  return this;\n};\n\n/**\n * Limit this vector to a specific magnitude.\n * @param {Number} size\n * @return {Vec2} This vector.\n */\nVec2.prototype.limit = function(size)\n{\n  size = +size;\n  if (!size)\n    return this;\n  else if (this.magnitude() > size)\n    return this.normalize(size);\n  else\n    return this;\n};\n\n/**\n * Normalize this vector.\n * @param {Number=} m Length.\n * @return {Vec2} This vector.\n */\nVec2.prototype.normalize = function(m)\n{\n  m = m || +1.0;\n  var length = Math.sqrt(this.x * this.x + this.y * this.y);\n  this.x = m * this.x / length;\n  this.y = m * this.y / length;\n  return this;\n};\n\n/**\n * Subtract some vector from this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.sub = function(v)\n{\n  this.x -= v.x;\n  this.y -= v.y;\n  return this;\n};\n\n/**\n * Add some vector to this one.\n * @param {Vec2} v\n * @return {Vec2} This vector.\n */\nVec2.prototype.add = function(v)\n{\n  this.x += v.x;\n  this.y += v.y;\n  return this;\n};\n\n/**\n * Scalar multiply this vector by a value.\n * @param {Number} n\n * @return {Vec2} This vector.\n */\nVec2.prototype.smult = function(n)\n{\n  n = +n;\n  this.x *= n;\n  this.y *= n;\n  return this;\n};\n\n/**\n * Rotate this vector clockwise about the origin by a certain angle.\n * @param {Number} theta\n * @return {Vec2} This vector.\n */\nVec2.prototype.rotate = function(theta)\n{\n  return this.set(\n    this.x * Math.cos(theta) - this.y * Math.sin(theta),\n    this.x * Math.sin(theta) + this.y * Math.cos(theta)\n  );\n};\n\n/**\n * Get the dot product of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.dot = function(v)\n{\n  return +(this.x * v.x + this.y * v.y);\n};\n\n/**\n * Get the determinate of this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.det = function(v)\n{\n  return +(this.x * v.y - this.y * v.x);\n};\n\n/**\n * Get the magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude = function()\n{\n  return Math.sqrt(this.x * this.x + this.y * this.y);\n};\n\n/**\n * Get the squared magnitude of this vector.\n * @return {Number}\n */\nVec2.prototype.magnitude2 = function()\n{\n  return this.x * this.x + this.y * this.y;\n};\n\n/**\n * Get the angle of this vector.\n * @return {Number}\n */\nVec2.prototype.angle = function()\n{\n  return Math.atan2(this.y, this.x);\n};\n\n/**\n * Get the angle between this vector and another.\n * @param {Vec2} v\n * @return {Number}\n */\nVec2.prototype.angleBetween = function(v)\n{\n  return Math.atan2(this.det(v), this.dot(v));\n};\n\n/**\n * Make a pooled copy of this vector\n * @return {Vec2} A new vector.\n */\nVec2.prototype.pcopy = function()\n{\n  return Vec2.aquire().assign(this);\n};\n\n/**\n * Make a copy of this vector.\n * @return {Vec2} A new vector.\n */\nVec2.prototype.copy = function()\n{\n  return new Vec2().assign(this);\n};\n\n/**\n * Create a vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number=} m\n * @return {Vec2} A new vector.\n */\nVec2.fromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return new Vec2(Math.cos(theta) * m, Math.sin(theta) * m);\n};\n\n/**\n * Create a pooled vector with a specific angle and magnitude.\n * @param {Number} theta\n * @param {Number} m\n * @return {Vec2} A new vector.\n */\nVec2.pfromAngle = function(theta, m)\n{\n  m = +m || 1.0;\n  return Vec2.aquire().set(\n    Math.cos(theta) * m,\n    Math.sin(theta) * m\n  );\n};\n\n/**\n * Determine if two rectangles, defined by a position and a halfwidth vector,\n * overlap.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they intersect\n */\nVec2.rectIntersect = function(p1, r1, p2, r2)\n{\n  // Basically, rectangles dont intersect if one's bottom is higher than ones\n  // top, ones left is more left than ones right, etc\n  var a = p1.x + r1.x < p2.x - r2.x;\n  var b = p1.x - r1.x > p2.x + r2.x;\n  var c = p1.y + r1.y < p2.y - r2.y;\n  var d = p1.y - r1.y > p2.y + r2.y;\n\n  // We want if they do\n  return !(a || b || c || d);\n};\n\n/**\n * Determines if rectangle 1 is entirely inside of rectangle 2.\n * @param {Vec2} p1 Position of rectangle 1\n * @param {Vec2} r1 Halfwidths of rectangle 1\n * @param {Vec2} p2 Position of rectangle 2\n * @param {Vec2} r2 Halfwidths of rectangle 2\n * @return {Boolean} True if they rectangle 1 is inside of rectangle 2\n */\nVec2.rectContains = function(p1, r1, p2, r2)\n{\n  if (p1.x - r1.x < p2.x - r2.x) return false;\n  if (p1.x + r1.x > p2.x + r2.x) return false;\n  if (p1.y - r1.y < p2.y - r2.y) return false;\n  if (p1.y + r1.y > p2.y + r2.y) return false;\n\n  return true;\n};\n\n/**\n * Convert a rectangle specified by top-left point + size into center location\n * + halfwidths.\n * @param {Vec2} position\n * @param {Vec2} size\n * @param {Vec2} out__position Output position\n * @param {Vec2} out__hwidth Output hwidths\n */\nVec2.sizeToHwidth = function(position, size, out__position, out__hwidth)\n{\n  out__hwidth.assign(size).smult(0.5);\n  out__position.assign(position).add(out__hwidth);\n};\n\n/**\n * Output this vector.\n */\nVec2.prototype.toString = function()\n{\n  return '' + (this.x.toFixed(2)) + ',' + (this.y.toFixed(2));\n};\n\n","module.exports = ObjectPool;\n\n/**\n * Minimize garbage collector thrashing by re-using existing objects instead of\n * creating new ones. Requires manually lifecycle management.\n * @constructor\n * @param {Function} T\n */\nfunction ObjectPool(T)\n{\n  this.freeList = [];\n  this.count    = 0;\n  this.T        = T;\n}\n\n/**\n * Get a pooled object\n */\nObjectPool.prototype.aquire = function()\n{\n  // Grow the list by 20%ish if we're out\n  if (this.freeList.length <= 0) {\n    this.expand(Math.round(this.count*0.2) + 1);\n  }\n\n  var item = this.freeList.pop();\n\n  // We can provide explicit initing, otherwise re-call constructor (hackish)\n  if (item.__init)\n    item.__init();\n  else\n    this.T.call(item);\n\n  return item;\n};\n\n/**\n * Return an object back to the pool.\n */\nObjectPool.prototype.release = function(item)\n{\n  this.freeList.push(item);\n};\n\n/**\n * @param {Number} Amount of new objects to allocate for this pool.\n */\nObjectPool.prototype.expand = function(count)\n{\n  for (var n = 0; n < count; n++)\n    this.freeList.push(new this.T());\n  this.count += count;\n};\n\n/**\n * @return {Number} Total amount of allocated objects (available and in-use).\n */\nObjectPool.prototype.totalSize = function()\n{\n  return this.count;\n};\n\n/**\n * @return {Number} Total number of objects currently available.\n */\nObjectPool.prototype.totalFree = function()\n{\n  return this.freeList.length;\n};\n\n/**\n * @return {Number} Total number of objects currently in-use.\n */\nObjectPool.prototype.totalUsed = function()\n{\n  return this.count - this.freeList.length;\n};\n\n","module.exports = Spatial;\n\nvar Vec2 = require('./Vec2.js');\n\n/**\n * Basic component giving an entity the concept of being located somewhere.\n * Creates basic spatial heirachy, positions, rotation, etc.\n * @constructor\n */\nfunction Spatial()\n{\n  // Alloc our types\n  this.position     = new Vec2();\n  this.scale        = new Vec2();\n  this.hwidth       = new Vec2();\n\n  this._absScale    = new Vec2();\n  this._absPosition = new Vec2();\n  this._absHwidth   = new Vec2();\n\n  // Setup\n  this.__init();\n}\n\n/**\n * Setup called by pool.\n * @private\n */\nSpatial.prototype.__init = function()\n{\n  this.rotation = 0;\n\n  // Ref to quad tree node this component is in\n  this._node = null;\n\n  // Parent component\n  this.parent = null;\n\n  this.position.clear();\n  this.scale.set(1, 1);\n  this.hwidth.clear();\n  this._absPosition.clear();\n  this._absScale.set(1, 1);\n  this._absHwidth.clear();\n};\n\n/**\n * Fired when spatials overlap.\n * @event\n */\nSpatial.COINCIDENT = 'Spatial#COINCIDENT';\n\n/**\n * Attach this component to another entity's Spatial.\n * @param {{spatial: Spatial}} entity An entity with a Spatial component\n */\nSpatial.prototype.attachTo = function(entity)\n{\n  if (this.parent)\n    throw new Error ('Entity already attached');\n\n  if (!entity || !entity.spatial)\n    throw new Error('Invalid / missing entity');\n\n  this.parent = entity.spatial;\n};\n\n/**\n * The absolute world position of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absPosition = function()\n{\n  var v = this._absPosition.assign(this.position);\n\n  // Trivial case, no parent\n  if (!this.parent) {\n    return v;\n  }\n\n  var parent = this.parent;\n\n  // Rotate our angle by parent's angle\n  var r = this.absRotation();\n  v.rotate(parent.absRotation());\n\n  // Scale by parents scale\n  var pScale = parent.absScale();\n  v.set(v.x * pScale.x, v.y * pScale.y);\n\n  // Add parent's position\n  return v.add(parent.absPosition());\n};\n\n/**\n * The absolute world rotation of this component.\n * @return {Number}\n */\nSpatial.prototype.absRotation = function()\n{\n  // Trivial case\n  if (!this.parent)\n    return this.rotation;\n\n  // This + parent\n  var r = this.rotation + this.parent.absRotation();\n\n  return r % (Math.PI*2);\n};\n\n/**\n * The absolute world hwidth for this component.\n * @return {Vec2}\n */\nSpatial.prototype.absHwidth = function()\n{\n  var h = this._absHwidth.assign(this.hwidth);\n\n  if (!this.parent)\n    return h;\n\n  var scale = this.absScale();\n\n  return h.set(h.x * scale.x, h.y * scale.y);\n};\n\n/**\n * The absolute world scale of this component.\n * @return {Vec2}\n */\nSpatial.prototype.absScale = function()\n{\n  var v = this._absScale.assign(this.scale);\n\n  // Trivial case\n  if (!this.parent) {\n    return v;\n  }\n\n  var pScale = this.parent.absScale();\n\n  return v.set(v.x * pScale.x, v.y * pScale.y);\n};\n\n","module.exports = Event;\n\n/**\n * @constructor\n */\nfunction Event(name, callback)\n{\n  this._name     = name || 'name';\n  this._callback = callback || null;\n\n  // Additional filters\n  this._Components = [];\n}\n\n/**\n * @param {String} eventName\n * @param {{hasAllComponents:Function}} entity\n * @param {Object=} option\n * @return {Boolean} True if fired.\n */\nEvent.prototype.fire = function(eventName, entity, option)\n{\n  // Name check\n  if (eventName !== this._name)\n    return false;\n\n  // Component filters\n  var Comps = this._Components;\n  if (entity && entity.hasAllComponents && Comps.length) {\n    if (!entity || !entity.hasAllComponents(Comps))\n      return false;\n  }\n\n  // Made it\n  this._callback(entity, option);\n  return true;\n};\n\n/**\n * @param {Function} T\n * @return {Event} This object.\n */\nEvent.prototype.whereComponent = function(T)\n{\n  this._Components.push(T);\n};\n\n/**\n * @param {Array.<Function>} Components\n * @return {Event} This object.\n */\nEvent.prototype.whereComponents = function(Components)\n{\n  this._Components = this._Components.concat(Components);\n  return this;\n};\n\n","module.exports = {\n\n  'extends'      : require('./lib/extends.js'),\n  'mixin'        : require('./lib/mixin.js'),\n  'getArguments' : require('./lib/getArguments.js'),\n  'getName'      : require('./lib/getName.js')\n\n};\n\n\n","module.exports = extends_;\n\n/**\n * The well documented, oft-used (Coffeescript, Typescript, ES6... etc) extends\n * pattern to get some sort of single-inheritance in Javascript.  Modify a\n * Child class to have inherited the static members via copying and link the\n * prototypes.\n * @param {Function} Child Child constructor function.\n * @param {Function} Parent Parent contrusctor function.\n * @return {Function} The Child constructor.\n */\nfunction extends_(Child, Parent)\n{\n  // Drop in statics\n  for (var key in Parent) {\n    if (!Child.hasOwnProperty(key) && Parent.hasOwnProperty(key)) {\n      Child[key] = Parent[key];\n    }\n  }\n\n  // Give static to access parent\n  Child.Super = Parent;\n\n  // Child's prototype property is an object with the parent's prototype\n  // property its [[prototype]] + constructor\n  if (Object.create instanceof Function) {\n    Child.prototype = Object.create(Parent.prototype, {\n      constructor: { value: Child }\n    });\n  } else {\n    // IE8 and below shim\n    var T = makeT(Child);\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n  }\n\n  return Child;\n}\n\n/**\n * @param {Function} Child\n * @return {Function}\n */\nfunction makeT(Child)\n{\n  return function T() { this.constructor = Child; };\n}\n\n","module.exports = mixin_;\n\n/**\n * Add all own properties of mixin to the prototype property of class T\n * @param {Function} T Class we want to mix into.\n * @param {Function|Object} mixin Mixin we want to mixt\n */\nfunction mixin_(T, mixin)\n{\n  // If we're mixing in a class (constructor function), then first mix in all\n  // things hanging directly off the mixin as \"statics\", then switch the mixin\n  // ref to point to the prototype\n  if (mixin instanceof Function) {\n    for (var k in mixin) {\n      T[k] = mixin[k];\n    }\n    mixin = mixin.prototype;\n  }\n\n  // Dump everything on the mixin into the prototype of our class\n  for (var key in mixin) {\n    if (mixin.hasOwnProperty(key)) {\n      T.prototype[key] = mixin[key];\n    }\n  }\n}\n\n","module.exports = getArguments;\n\nvar FUNCTION_ARGS = /^\\w*function[^\\(]*\\(([^\\)]+)/;\n\n/**\n * Get the parameter names of a function.\n * @param {Function} f A function.\n * @return {Array.<String>} An array of the argument names of a function.\n */\nfunction getArguments(f)\n{\n  var ret = [];\n  var args = f.toString().match(FUNCTION_ARGS);\n\n  if (args) {\n    args = args[1]\n      .replace(/[ ]*,[ ]*/, ',')\n      .split(',');\n    for (var n = 0; n < args.length; n++) {\n      var a = args[n].replace(/^\\s+|\\s+$/g, '');\n      if (a) ret.push(a);\n    }\n  }\n\n  return ret;\n}\n\n","module.exports = getName;\n\nvar FUNCTION_NAME = /function\\s+([^\\s(]+)/;\n\n/**\n * Get the name of a function (e.g. constructor)\n * @param {Function} f\n * @return {String} The function name.\n */\nfunction getName(f)\n{\n  var name = '';\n\n  if (f instanceof Function) {\n    if (f.name) {\n      return f.name;\n    }\n\n    var match = f.toString().match(FUNCTION_NAME);\n\n    if (match) {\n      name = match[1];\n    }\n  } else if (f && f.constructor instanceof Function) {\n    name = getName(f.constructor);\n  }\n\n  return name;\n}\n"]}